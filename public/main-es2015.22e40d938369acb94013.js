(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6Yf":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s}));var r=n("mrSG"),i=n("qOnz"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Object(r.a)({identifier:"[DEFAULT]",optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);try{var o=this.getOrInitializeService(i);if(!o){if(n)return null;throw Error("Service "+this.name+" is not available")}return o}catch(s){if(n)return null;throw s}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService("[DEFAULT]")}catch(l){}try{for(var i=Object(r.h)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=Object(r.e)(o.value,2),a=s[1],u=this.normalizeInstanceIdentifier(s[0]);try{var c=this.getOrInitializeService(u);a.resolve(c)}catch(l){}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Object(r.f)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}(),a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"3UD+":function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},4:function(t,e){},5:function(t,e){},6:function(t,e){},"6Uf2":function(t,e,n){"use strict";(function(t){var e,r=n("zIRd"),i=n("mrSG"),o=n("qOnz"),s=n("q/0M"),a=n("/6Yf"),u=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Object(o.J)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Object(o.D)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),c=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return Object(o.k)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new u(e)}}catch(n){}return new c},h=l("localStorage"),d=l("sessionStorage"),f=new s.b("@firebase/database"),p=(e=1,function(){return e++}),m=function(t){var e=Object(o.I)(t),n=new o.d;n.update(e);var r=n.digest();return o.h.encodeByteArray(r)},g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=g.apply(null,i):n+="object"==typeof i?Object(o.J)(i):i,n+=" "}return n},v=null,y=!0,b=function(t,e){Object(o.f)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(f.logLevel=s.a.VERBOSE,v=f.log.bind(f),e&&d.set("logging_enabled",!0)):"function"==typeof t?v=t:(v=null,d.remove("logging_enabled"))},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===y&&(y=!1,null===v&&!0===d.get("logging_enabled")&&b(!0)),v){var n=g.apply(null,t);v(n)}},_=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];w.apply(void 0,Object(i.f)([t],e))}},x=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+g.apply(void 0,Object(i.f)(t));f.error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+g.apply(void 0,Object(i.f)(t));throw f.error(n),new Error(n)},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+g.apply(void 0,Object(i.f)(t));f.warn(n)},S=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},I="[MIN_NAME]",k="[MAX_NAME]",T=function(t,e){if(t===e)return 0;if(t===I||e===k)return-1;if(e===I||t===k)return 1;var n=G(t),r=G(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},A=function(t,e){return t===e?0:t<e?-1:1},R=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Object(o.J)(e))},O=function(t){if("object"!=typeof t||null===t)return Object(o.J)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=Object(o.J)(e[i]),r+=":",r+=O(t[e[i]]);return r+"}"},N=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function D(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var P,M,F,L,B,j,V,U,z,W,q=function(t){var e,n,r,i,s;Object(o.f)(!S(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var u=a.join(""),c="";for(s=0;s<64;s+=8){var l=parseInt(u.substr(s,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},H=new RegExp("^-?(0*)\\d{1,10}$"),G=function(t){if(H.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},$=function(t){try{t()}catch(e){setTimeout((function(){throw E("Exception was thrown by user callback.",e.stack||""),e}),Math.floor(0))}},K=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},X=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=T(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Y=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(o.H)(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Object(o.H)(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Object(o.H)(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Q=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=h.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&h.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(Object(o.f)("string"==typeof t,"typeof type must == string"),Object(o.f)("object"==typeof e,"typeof params must == object"),"websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return D(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),J=function(t,e){var n=Z(t),r=n.namespace;return"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&E("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Q(n.host,n.secure,r,e,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new X(n.pathString)}},Z=function(t){var e="",n="",r="",o="",s="",a=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var d=t.indexOf("?");-1===d&&(d=t.length),e=t.substring(0,Math.min(h,d)),h<d&&(o=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(h,d)));var f=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var o=Object(i.h)(t.split("&")),s=o.next();!s.done;s=o.next()){var a=s.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):E("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,d)));(l=e.indexOf(":"))>=0?(a="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var m=e.indexOf(".");r=e.substring(0,m).toLowerCase(),n=e.substring(m+1),s=r}"ns"in f&&(s=f.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:a,scheme:u,pathString:o,namespace:s}},tt=/[\[\].#$\/\u0000-\u001F\u007F]/,et=/[\[\].#$\u0000-\u001F\u007F]/,nt=function(t){return"string"==typeof t&&0!==t.length&&!tt.test(t)},rt=function(t){return"string"==typeof t&&0!==t.length&&!et.test(t)},it=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!S(t)||t&&"object"==typeof t&&Object(o.k)(t,".sv")},ot=function(t,e,n,r,i){i&&void 0===n||st(Object(o.o)(t,e,i),n,r)},st=function(t,e,n){var r=n instanceof X?new Y(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(S(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>10485760/3&&Object(o.H)(e)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,s=!1;if(D(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!nt(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),st(t,n,r),r.pop()})),i&&s)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},at=function(t,e,n,r,i){if(!i||void 0!==n){var s=Object(o.o)(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(s+" must be an object containing the children to replace.");var a=[];D(n,(function(t,e){var n=new X(t);if(st(s,e,r.child(n)),".priority"===n.getBack()&&!it(e))throw new Error(s+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!nt(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(X.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(s,a)}},ut=function(t,e,n,r){if(!r||void 0!==n){if(S(n))throw new Error(Object(o.o)(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!it(n))throw new Error(Object(o.o)(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ct=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(o.o)(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},lt=function(t,e,n,r){if(!(r&&void 0===n||nt(n)))throw new Error(Object(o.o)(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ht=function(t,e,n,r){if(!(r&&void 0===n||rt(n)))throw new Error(Object(o.o)(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},dt=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ht(t,e,n,r)},ft=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},pt=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!nt(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),rt(t)}(r))throw new Error(Object(o.o)(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},mt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(o.o)(t,e,r)+"must be a boolean.")},gt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Object(o.K)("OnDisconnect.cancel",0,1,arguments.length),Object(o.L)("OnDisconnect.cancel",1,t,!0);var e=new o.a;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Object(o.K)("OnDisconnect.remove",0,1,arguments.length),ft("OnDisconnect.remove",this.path_),Object(o.L)("OnDisconnect.remove",1,t,!0);var e=new o.a;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Object(o.K)("OnDisconnect.set",1,2,arguments.length),ft("OnDisconnect.set",this.path_),ot("OnDisconnect.set",1,t,this.path_,!1),Object(o.L)("OnDisconnect.set",2,e,!0);var n=new o.a;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Object(o.K)("OnDisconnect.setWithPriority",2,3,arguments.length),ft("OnDisconnect.setWithPriority",this.path_),ot("OnDisconnect.setWithPriority",1,t,this.path_,!1),ut("OnDisconnect.setWithPriority",2,e,!1),Object(o.L)("OnDisconnect.setWithPriority",3,n,!0);var r=new o.a;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Object(o.K)("OnDisconnect.update",1,2,arguments.length),ft("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,E("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}at("OnDisconnect.update",1,t,this.path_,!1),Object(o.L)("OnDisconnect.update",2,e,!0);var i=new o.a;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),vt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Object(o.K)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),yt=(P="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",M=0,F=[],function(t){var e,n=t===M;M=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=P.charAt(t%64),t=Math.floor(t/64);Object(o.f)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===F[e];e--)F[e]=0;F[e]++}else for(e=0;e<12;e++)F[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=P.charAt(F[e]);return Object(o.f)(20===i.length,"nextPushId: Length should be 20."),i}),bt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),wt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new bt(I,t),r=new bt(I,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return bt.MIN},t}(),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return L},set:function(t){L=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return T(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Object(o.g)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return new bt(k,L)},e.prototype.makePost=function(t,e){return Object(o.f)("string"==typeof t,"KeyIndex indexValue must always be a string."),new bt(t,L)},e.prototype.toString=function(){return".key"},e}(wt),xt=new _t,Ct=function(t){return"number"==typeof t?"number:"+q(t):"string:"+t},Et=function(t){if(t.isLeafNode()){var e=t.val();Object(o.f)("string"==typeof e||"number"==typeof e||"object"==typeof e&&Object(o.k)(e,".sv"),"Priority must be a string or number.")}else Object(o.f)(t===B||t.isEmpty(),"priority of unexpected type.");Object(o.f)(t===B||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},St=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Object(o.f)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Et(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return j},set:function(t){j=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(o.f)(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ct(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?q(this.value_):this.value_,this.lazyHash_=m(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Object(o.f)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(r);return Object(o.f)(i>=0,"Unknown leaf type: "+n),Object(o.f)(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),It=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?T(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return new bt(k,new St("[PRIORITY-POST]",U))},e.prototype.makePost=function(t,e){var n=V(t);return new bt(e,new St("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(wt)),kt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Tt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Rt.EMPTY_NODE,this.right=null!=o?o:Rt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Rt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Rt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),At=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Tt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Rt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Tt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new kt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new kt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new At,t}(),Ot=Math.log(2),Nt=function(){function t(t){this.count=parseInt(Math.log(t+1)/Ot,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Dt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new Tt(s,o.node,Tt.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],s=n?n(o):o,new Tt(s,o.node,Tt.BLACK,c,l)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),l=t[o],h=n?n(l):l;u(new Tt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?a(h,Tt.BLACK):(a(h,Tt.BLACK),a(h,Tt.RED))}return o}(new Nt(t.length));return new Rt(r||e,o)},Pt={},Mt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Object(o.f)(Pt&&It,"ChildrenNode.ts has not been loaded"),z=z||new t({".priority":Pt},{".priority":It})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=Object(o.G)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Rt?e:null},t.prototype.hasIndex=function(t){return Object(o.k)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Object(o.f)(e!==xt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,s=[],a=!1,u=n.getIterator(bt.Wrap),c=u.getNext();c;)a=a||e.isDefinedOn(c.node),s.push(c),c=u.getNext();r=a?Dt(s,e.getCompare()):Pt;var l=e.toString(),h=Object(i.a)({},this.indexSet_);h[l]=e;var d=Object(i.a)({},this.indexes_);return d[l]=r,new t(d,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Object(o.E)(this.indexes_,(function(t,i){var s=Object(o.G)(r.indexSet_,i);if(Object(o.f)(s,"Missing index implementation for "+i),t===Pt){if(s.isDefinedOn(e.node)){for(var a=[],u=n.getIterator(bt.Wrap),c=u.getNext();c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Dt(a,s.getCompare())}return Pt}var l=n.get(e.name),h=t;return l&&(h=h.remove(new bt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Object(o.E)(this.indexes_,(function(t){if(t===Pt)return t;var r=n.get(e.name);return r?t.remove(new bt(e.name,r)):t})),this.indexSet_)},t}();function Ft(t,e){return T(t.name,e.name)}function Lt(t,e){return T(t,e)}var Bt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Et(this.priorityNode_),this.children_.isEmpty()&&Object(o.f)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return W||(W=new t(new Rt(Lt),null,Mt.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||W},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?W:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Object(o.f)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new bt(e,n),i=void 0,s=void 0;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?W:this.priorityNode_;return new t(i,a,s)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Object(o.f)(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(It,(function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1})),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Ct(this.getPriority().val())+":"),this.forEachChild(It,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":m(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new bt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new bt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new bt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,bt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,bt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===jt?-1:0},t.prototype.withIndex=function(e){if(e===xt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===xt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(It),r=e.getIterator(It),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===xt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),jt=new(function(t){function e(){return t.call(this,new Rt(Lt),Bt.EMPTY_NODE,Mt.Default)||this}return Object(i.c)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Bt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Bt));function Vt(t,e){if(void 0===e&&(e=null),null===t)return Bt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Object(o.f)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new St(t,Vt(e));if(t instanceof Array){var n=Bt.EMPTY_NODE;return D(t,(function(e,r){if(Object(o.k)(t,e)&&"."!==e.substring(0,1)){var i=Vt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(Vt(e))}var r=[],i=!1;if(D(t,(function(t,e){if("."!==t.substring(0,1)){var n=Vt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new bt(t,n)))}})),0===r.length)return Bt.EMPTY_NODE;var s=Dt(r,Ft,(function(t){return t.name}),Lt);if(i){var a=Dt(r,It.getCompare());return new Bt(s,Vt(e),new Mt({".priority":a},{".priority":It}))}return new Bt(s,Vt(e),Mt.Default)}Object.defineProperties(bt,{MIN:{value:new bt(I,Bt.EMPTY_NODE)},MAX:{value:new bt(k,jt)}}),_t.__EMPTY_NODE=Bt.EMPTY_NODE,St.__childrenNodeConstructor=Bt,B=jt,function(t){U=t}(jt),function(t){V=t}(Vt);var Ut,zt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?T(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return bt.MAX},e.prototype.makePost=function(t,e){var n=Vt(t);return new bt(e,n)},e.prototype.toString=function(){return".value"},e}(wt)),Wt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Object(o.f)(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return Object(i.c)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?T(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Vt(t),r=Bt.EMPTY_NODE.updateChild(this.indexPath_,n);return new bt(e,r)},e.prototype.maxPost=function(){var t=Bt.EMPTY_NODE.updateChild(this.indexPath_,jt);return new bt(k,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(wt),qt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Object(o.K)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Object(o.K)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Object(o.K)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Object(o.K)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Object(o.K)("DataSnapshot.child",0,1,arguments.length),e=String(e),ht("DataSnapshot.child",1,e,!1);var n=new X(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,It)},t.prototype.hasChild=function(t){Object(o.K)("DataSnapshot.hasChild",1,1,arguments.length),ht("DataSnapshot.hasChild",1,t,!1);var e=new X(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Object(o.K)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(Object(o.K)("DataSnapshot.forEach",1,1,arguments.length),Object(o.L)("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),It))}))},t.prototype.hasChildren=function(){return Object(o.K)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Object(o.K)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Object(o.K)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Ht=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(o.J)(this.snapshot.exportVal())},t}(),Gt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),$t=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Ht("value",this,new qt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.f)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Gt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Kt=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,Object(o.k)(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Gt(this,t,e):null},t.prototype.createEvent=function(t,e){Object(o.f)(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Ht(t.type,this,new qt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.f)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||e.callbacks_[s]&&this.callbacks_[a]&&e.callbacks_[s]!==this.callbacks_[a])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Xt=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.f)(Ut,"Reference.ts has not been loaded"),Ut},set:function(t){Ut=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===xt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==I)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==k)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===It){if(null!=e&&!it(e)||null!=n&&!it(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(o.f)(t.getIndex()instanceof Wt||t.getIndex()===zt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Object(o.K)("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Object(o.K)("Query.on",2,4,arguments.length),ct("Query.on",1,e,!1),Object(o.L)("Query.on",2,n,!1);var s=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,s.cancel,s.context);else{var a={};a[e]=n,this.onChildEvent(a,s.cancel,s.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new $t(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Kt(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Object(o.K)("Query.off",0,3,arguments.length),ct("Query.off",1,t,!0),Object(o.L)("Query.off",2,e,!0),Object(o.M)("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var s=e||null;r=new $t(s,null,n||null)}else t&&(e&&((i={})[t]=e),r=new Kt(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var s=this;Object(o.K)("Query.once",1,4,arguments.length),ct("Query.once",1,e,!1),Object(o.L)("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new o.a;c.promise.catch((function(){}));var l=function(t){u&&(u=!1,s.off(e,l),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,l,(function(t){s.off(e,l),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if(Object(o.K)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Object(o.K)("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Object(o.K)("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ht("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new X(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Wt(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Object(o.K)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(xt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Object(o.K)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(It);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Object(o.K)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(zt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Object(o.K)("Query.startAt",0,2,arguments.length),ot("Query.startAt",1,e,this.path,!0),lt("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Object(o.K)("Query.endAt",0,2,arguments.length),ot("Query.endAt",1,e,this.path,!0),lt("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Object(o.K)("Query.equalTo",1,2,arguments.length),ot("Query.equalTo",1,t,this.path,!1),lt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Object(o.K)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Object(o.K)("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=O(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Object(o.K)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),s=this.queryIdentifier()===e.queryIdentifier();return r&&i&&s},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,Object(o.L)(t,3,r.cancel,!0),r.context=n,Object(o.M)(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Object(o.o)(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Yt=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Qt=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),Jt=function(t,e,n){return t&&"object"==typeof t?(Object(o.f)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Zt(t[".sv"],e,n):"object"==typeof t[".sv"]?te(t[".sv"],e):void Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Zt=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Object(o.f)(!1,"Unexpected server value: "+t)}},te=function(t,e,n){t.hasOwnProperty("increment")||Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&Object(o.f)(!1,"Unexpected increment value: "+r);var i=e.node();if(Object(o.f)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var s=i.getValue();return"number"!=typeof s?r:s+r},ee=function(t,e,n,r){return re(e,new Qt(n,t),r)},ne=function(t,e,n){return re(t,new Yt(e),n)};function re(t,e,n){var r,i=t.getPriority().val(),o=Jt(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=Jt(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new St(a,Vt(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new St(o))),u.forEachChild(It,(function(t,i){var o=re(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var ie,oe,se=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(It,(function(t,e){n.remember(new X(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new X(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}(),ae=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}({}),ue=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Object(o.f)(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),ce=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=ae.ACK_USER_WRITE,this.source=ue.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Object(o.f)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new X(e));return new t(X.Empty,n,this.revert)}return Object(o.f)(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),le=function(){function t(t,e){void 0===e&&(ie||(ie=new Rt(A)),e=ie),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return D(e,(function(t,e){n=n.set(new X(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:X.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new X(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(X.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,X.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,X.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(X.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),he=function(){function t(t,e){this.source=t,this.path=e,this.type=ae.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,X.Empty):new t(this.source,this.path.popFront())},t}(),de=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=ae.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,X.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),fe=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=ae.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new X(e));return n.isEmpty()?null:n.value?new de(this.source,X.Empty,n.value):new t(this.source,X.Empty,n)}return Object(o.f)(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),pe=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),me=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new pe(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new pe(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new pe(Bt.EMPTY_NODE,!1,!1),new pe(Bt.EMPTY_NODE,!1,!1)),t}(),ge=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),ve=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,s){Object(o.f)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(ge.childRemovedChange(e,a)):Object(o.f)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ge.childAddedChange(e,n)):s.trackChildChange(ge.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(It,(function(t,r){e.hasChild(t)||n.trackChildChange(ge.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(It,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(ge.childChangedChange(e,r,i))}else n.trackChildChange(ge.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Bt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),ye=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Object(o.f)(e===ge.CHILD_ADDED||e===ge.CHILD_CHANGED||e===ge.CHILD_REMOVED,"Only child changes supported for tracking"),Object(o.f)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===ge.CHILD_ADDED&&i===ge.CHILD_REMOVED)this.changeMap.set(n,ge.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===ge.CHILD_REMOVED&&i===ge.CHILD_ADDED)this.changeMap.delete(n);else if(e===ge.CHILD_REMOVED&&i===ge.CHILD_CHANGED)this.changeMap.set(n,ge.childRemovedChange(n,r.oldSnap));else if(e===ge.CHILD_CHANGED&&i===ge.CHILD_ADDED)this.changeMap.set(n,ge.childAddedChange(n,t.snapshotNode));else{if(e!==ge.CHILD_CHANGED||i!==ge.CHILD_CHANGED)throw Object(o.g)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,ge.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),be=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),we=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new pe(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),_e=function(){return function(t,e){this.viewCache=t,this.changes=e}}(),xe=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){Object(o.f)(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Object(o.f)(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var s,a,u=new ye;if(n.type===ae.OVERWRITE){var c=n;c.source.fromUser?s=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(Object(o.f)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),s=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===ae.MERGE){var l=n;l.source.fromUser?s=this.applyUserMerge_(e,l.path,l.children,r,i,u):(Object(o.f)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.getServerCache().isFiltered(),s=this.applyServerMerge_(e,l.path,l.children,r,i,a,u))}else if(n.type===ae.ACK_USER_WRITE){var h=n;s=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==ae.LISTEN_COMPLETE)throw Object(o.g)("Unknown operation type: "+n.type);s=this.listenComplete_(e,n.path,r,u)}var d=u.getChanges();return t.maybeAddValueEvent_(e,s,d),new _e(s,d)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ge.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var s=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if(Object(o.f)(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=n.calcCompleteEventChildren(c instanceof Bt?c:Bt.EMPTY_NODE);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var d=e.getFront();if(".priority"===d){Object(o.f)(1===e.getLength(),"Can't have a priority with additional path components");var f=s.getNode();u=t.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(e,f,u);a=null!=p?this.filter_.updatePriority(f,p):s.getNode()}else{var m=e.popFront(),g=void 0;if(s.isCompleteForChild(d)){u=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,s.getNode(),u);g=null!=v?s.getNode().getImmediateChild(d).updateChild(m,v):s.getNode().getImmediateChild(d)}else g=n.calcCompleteChild(d,t.getServerCache());a=null!=g?this.filter_.updateChild(s.getNode(),d,g,m,r,i):s.getNode()}}return t.updateEventSnap(a,s.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var d=e.popFront(),f=u.getNode().getImmediateChild(h).updateChild(d,n);a=".priority"===h?c.updatePriority(u.getNode(),f):c.updateChild(u.getNode(),h,f,d,be,null)}var p=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),m=new we(r,p,i);return this.generateEventCacheAfterServerEvent_(p,e,r,m,s)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new we(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),d=u.getNode().getImmediateChild(l),f=void 0;if(h.isEmpty())f=n;else{var p=c.getCompleteChild(l);f=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):Bt.EMPTY_NODE}if(d.equals(f))s=t;else{var m=this.filter_.updateChild(u.getNode(),l,f,h,c,o);s=t.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,s){var a=this,u=e;return r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=a.applyUserOverwrite_(u,l,c,i,o,s))})),r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=a.applyUserOverwrite_(u,l,c,i,o,s))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,s){var a=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:le.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new X(e),h,r,i,o,s)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),d=a.applyMerge_(h,n);c=a.applyServerOverwrite_(c,new X(e),d,r,i,o,s)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,a.getNode().getChild(e),r,i,s,o);if(e.isEmpty()){var u=le.Empty;return a.getNode().forEachChild(xt,(function(t,e){u=u.set(new X(t),e)})),this.applyServerMerge_(t,e,u,r,i,s,o)}return t}var c=le.Empty;return n.foreach((function(t,n){var r=e.child(t);a.isCompleteForPath(r)&&(c=c.set(t,a.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,s,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,be,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var s;if(null!=n.shadowingWrite(e))return t;var a=new we(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Object(o.f)(h instanceof Bt,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}c=this.filter_.updateFullNode(u,l=l,i)}else{var d=e.getFront(),f=n.calcCompleteChild(d,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(d)&&(f=u.getImmediateChild(d)),(c=null!=f?this.filter_.updateChild(u,d,f,e.popFront(),a,i):t.getEventCache().getNode().hasChild(d)?this.filter_.updateChild(u,d,Bt.EMPTY_NODE,e.popFront(),a,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(s=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,s,i))}return s=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(X.Empty),t.updateEventSnap(c,s,this.filter_.filtersNodes())},t}(),Ce=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===ge.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(ge.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,ge.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,ge.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,ge.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,ge.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,ge.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,s=n.filter((function(t){return t.type===e}));s.sort(this.compareChanges_.bind(this)),s.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Object(o.g)("Should only compare child_ events.");var n=new bt(t.childName,t.snapshotNode),r=new bt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),Ee=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new ve(n.getIndex()),i=n.getNodeFilter();this.processor_=new xe(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(Bt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Bt.EMPTY_NODE,s.getNode(),null),c=new pe(a,o.isFullyInitialized(),r.filtersNodes()),l=new pe(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new me(l,c),this.eventGenerator_=new Ce(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){Object(o.f)(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){var i=t.createCancelEvent(e=e,r);i&&n.push(i)}))}if(t){for(var i=[],s=0;s<this.eventRegistrations_.length;++s){var a=this.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(s+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===ae.MERGE&&null!==t.source.queryId&&(Object(o.f)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Object(o.f)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Object(o.f)(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(It,(function(t,e){n.push(ge.childAddedChange(t,e))})),e.isFullyInitialized()&&n.push(ge.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){return this.eventGenerator_.generateEventsForChanges(t,e,n?[n]:this.eventRegistrations_)},t}(),Se=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.f)(oe,"Reference.ts has not been loaded"),oe},set:function(t){Object(o.f)(!oe,"__referenceConstructor has already been defined"),oe=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,s,a=t.source.queryId;if(null!==a){var u=this.views.get(a);return Object(o.f)(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var l=Object(i.h)(this.views.values()),h=l.next();!h.done;h=l.next())c=c.concat((u=h.value).applyOperation(t,e,n))}catch(d){r={error:d}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;a?u=!0:r instanceof Bt?(a=n.calcCompleteEventChildren(r),u=!1):(a=Bt.EMPTY_NODE,u=!1);var c=new me(new pe(a,u,!1),new pe(r,i,!1));s=new Ee(t,c),this.views.set(o,s)}return s.addEventRegistration(e),s.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var o,s,a=e.queryIdentifier(),u=[],c=[],l=this.hasCompleteView();if("default"===a)try{for(var h=Object(i.h)(this.views.entries()),d=h.next();!d.done;d=h.next()){var f,p=Object(i.e)(d.value,2),m=p[0];c=c.concat((f=p[1]).removeEventRegistration(n,r)),f.isEmpty()&&(this.views.delete(m),f.getQuery().getQueryParams().loadsAllData()||u.push(f.getQuery()))}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}else(f=this.views.get(a))&&(c=c.concat(f.removeEventRegistration(n,r)),f.isEmpty()&&(this.views.delete(a),f.getQuery().getQueryParams().loadsAllData()||u.push(f.getQuery())));return l&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=Object(i.h)(this.views.values()),o=r.next();!o.done;o=r.next()){var s=o.value;s.getQuery().getQueryParams().loadsAllData()||n.push(s)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var o=Object(i.h)(this.views.values()),s=o.next();!s.done;s=o.next())r=r||s.value.getCompleteServerCache(t)}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=Object(i.h)(this.views.values()),r=n.next();!r.done;r=n.next()){var o=r.value;if(o.getQuery().getQueryParams().loadsAllData())return o}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Ie=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new le(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=X.relativePath(i,e);return o=o.updateChild(s,n),new t(this.writeTree_.set(i,o))}var a=new le(n);return new t(this.writeTree_.setTree(e,a))},t.prototype.addWrites=function(t,e){var n=this;return D(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,le.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(X.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(It,(function(e,n){t.push(new bt(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new bt(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new le(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal((function(n,s){".priority"===n?(Object(o.f)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):r=t(e.child(n),s,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r}(X.Empty,this.writeTree_,t)},t.Empty=new t(new le(null)),t}(),ke=function(){function t(){this.visibleWrites_=Ie.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Te(t,this)},t.prototype.addOverwrite=function(t,e,n,r){Object(o.f)(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){Object(o.f)(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));Object(o.f)(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,s=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(s=!0)),a--}return!!i&&(s?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):D(r.children,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})),!0))},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);return!i&&o.isEmpty()?n:i||null!=n||o.hasCompleteWrite(X.Empty)?t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e).apply(n||Bt.EMPTY_NODE):null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var a=this.visibleWrites_.childCompoundWrite(e);return a.isEmpty()?n:null!=n||a.hasCompleteWrite(X.Empty)?a.apply(n||Bt.EMPTY_NODE):null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Bt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(It,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(It,(function(t,e){var r=i.childCompoundWrite(new X(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Object(o.f)(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var s=this.visibleWrites_.childCompoundWrite(i);return s.isEmpty()?r.getChild(e):s.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(t),u=a.getCompleteNode(X.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),d=h.getNext();d&&c.length<r;)0!==l(d,n)&&c.push(d),d=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,X.Empty),this.lastWriteId_=this.allWrites_.length>0?this.allWrites_[this.allWrites_.length-1].writeId:-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Ie.Empty,i=0;i<t.length;++i){var s=t[i];if(e(s)){var a=s.path,u=void 0;if(s.snap)n.contains(a)?(u=X.relativePath(n,a),r=r.addWrite(u,s.snap)):a.contains(n)&&(u=X.relativePath(a,n),r=r.addWrite(X.Empty,s.snap.getChild(u)));else{if(!s.children)throw Object(o.g)("WriteRecord should have .snap or .children");if(n.contains(a))u=X.relativePath(n,a),r=r.addWrites(u,s.children);else if(a.contains(n))if((u=X.relativePath(a,n)).isEmpty())r=r.addWrites(X.Empty,s.children);else{var c=Object(o.G)(s.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(X.Empty,l)}}}}}return r},t}(),Te=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Ae=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=le.Empty,this.pendingWriteTree_=new ke,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new de(ue.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=le.fromObject(e);return this.applyOperationToSyncPoints_(new fe(ue.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=le.Empty;return null!=n.snap?r=r.set(X.Empty,!0):D(n.children,(function(t,e){r=r.set(new X(t),e)})),this.applyOperationToSyncPoints_(new ce(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new de(ue.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=le.fromObject(e);return this.applyOperationToSyncPoints_(new fe(ue.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new he(ue.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=X.relativePath(s,e),c=new de(ue.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=X.relativePath(s,e),c=le.fromObject(n),l=new fe(ue.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,s=i.queryId,a=X.relativePath(o,e),u=new he(ue.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,s=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=X.relativePath(t,r);i=i||e.getCompleteServerCache(n),s=s||e.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);u?(s=s||u.hasCompleteView(),i=i||u.getCompleteServerCache(X.Empty)):(u=new Se,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?a=!0:(a=!1,i=Bt.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache(X.Empty);n&&(i=i.updateImmediateChild(t,n))})));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);Object(o.f)(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(l,h),this.tagToQueryMap.set(h,l)}var d=this.pendingWriteTree_.childWrites(r),f=u.addEventRegistration(e,n,d,i,a);if(!c&&!s){var p=u.viewForQuery(e);f=f.concat(this.setupListener_(e,p))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===e.queryIdentifier()||s.viewExistsForQuery(e))){var u=s.removeEventRegistration(e,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var l=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),h=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(l&&!h){var d=this.syncPointTree_.subtree(o);if(!d.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(d),p=0;p<f.length;++p){var m=f[p],g=m.getQuery(),v=this.createListenerForView_(m);this.listenProvider_.startListening(t.queryForListening_(g),this.tagForQuery_(g),v.hashFn,v.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}))),this.removeTags_(c)}return a},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=X.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),D(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),s=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,s.hashFn,s.onComplete),u=this.syncPointTree_.subtree(r);if(i)Object(o.f)(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),D(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Bt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return Object(o.f)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new X(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Object(o.f)(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(X.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(X.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(X.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,l=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(X.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(X.Empty));var s=[];return e.children.inorderTraversal((function(e,o){var a=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))})),o&&(s=s.concat(o.applyOperation(t,r,n))),s},t.nextQueryTag_=1,t}(),Re=function(){function t(){this.rootNode_=Bt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Oe=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),Object(o.k)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return Object(o.m)(this.counters_)},t}(),Ne=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Oe),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),De=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=Object(i.a)({},t);return this.last_&&D(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Pe=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new De(t);var n=1e4+2e4*Math.random();K(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;D(e,(function(e,i){i>0&&Object(o.k)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),K(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Me=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new Fe(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),Fe=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();v&&w("event: "+e.toString()),$(n)}}},t.prototype.getPath=function(){return this.path_},t}(),Le=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Object(o.f)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=Object(i.f)(this.listeners_[t]),o=0;o<r.length;o++)r[o].callback.apply(r[o].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Object(o.f)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Be=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.f)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Le),je=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(o.x)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.f)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Le),Ve=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&$((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Ue=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=_(t),this.stats_=Ne.getCollection(e),this.urlFn=function(t){return e.connectionURL("long_polling",t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Ve(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(Object(o.z)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new ze((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,5),o=r[0],s=r[1],a=r[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===o)n.id=s,n.password=a;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,2),o=r[0],s=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(o,s)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(Object(o.z)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=Object(o.J)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=Object(o.i)(e),r=N(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!Object(o.z)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=Object(o.J)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),ze=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(o.z)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=p(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(s='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(u){w("frame writing exception"),u.stack&&w(u.stack),w(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||w("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(e+=n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;Object(o.z)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){w("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),We="";function qe(t){We=t}var He=null;"undefined"!=typeof MozWebSocket?He=MozWebSocket:"undefined"!=typeof WebSocket&&(He=WebSocket);var Ge=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=_(this.connId),this.stats_=Ne.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!Object(o.z)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL("websocket",r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,h.set("previous_websocket_failure",!0);try{if(Object(o.z)()){var r={headers:{"User-Agent":"Firebase/5/"+We+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}},i=process.env,s=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;s&&(r.proxy={origin:s}),this.mySock=new He(this.connURL,[],r)}else this.mySock=new He(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||""}})}catch(u){this.log_("Error instantiating WebSocket.");var a=u.message||u.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==He&&!t.forceDisallow_},t.previouslyFailed=function(){return h.isInMemoryStorage||!0===h.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){h.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=Object(o.D)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Object(o.f)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=Object(o.J)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=N(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),$e=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Ue,Ge]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,o=Ge&&Ge.isAvailable(),s=o&&!Ge.previouslyFailed();if(e.webSocketOnly&&(o||E("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Ge];else{var a=this.transports_=[];try{for(var u=Object(i.h)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&a.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Ke=function(){function t(t,e,n,r,i,o,s,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=_("c:"+this.id+":"),this.transportManager_=new $e(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=K((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=R("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?x("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):x("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&E("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),K((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):K((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(h.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Xe=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),Ye=function(t){function e(n,r,i,s,a,u,c){var l=t.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=s,l.onServerInfoUpdate_=a,l.authTokenProvider_=u,l.authOverride_=c,l.id=e.nextPersistentConnectionId_++,l.log_=_("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingPutCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=1e3,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!Object(o.z)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),Be.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&je.getInstance().on("online",l.onOnline_,l),l}return Object(i.c)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_(Object(o.J)(i)),Object(o.f)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),s=t.path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Object(o.f)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Object(o.f)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r.queryObject(),s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&Object(o.k)(t,"w")){var n=Object(o.G)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();E("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||Object(o.q)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=Object(o.C)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Object(o.f)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){"ok"!==t.s&&e.log_("reportStats","Error sending stats: "+t.d)}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+Object(o.J)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):x("Unrecognized action received from server: "+Object(o.J)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Object(o.f)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,a=this,u=this.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,i())};this.realtime_={close:h,sendRequest:function(t){Object(o.f)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)}};var d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(d).then((function(t){c?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,l=new Ke(s,a.repoInfo_,a.applicationId_,n,r,i,(function(t){E(t+" ("+a.repoInfo_.toString()+")"),a.interrupt("server_kill")}),u))})).then(null,(function(e){a.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&E(e),h())}))}},e.prototype.interrupt=function(t){w("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){w("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Object(o.u)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return O(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new X(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){w("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var o=Object(i.h)(this.listens.values()),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(a.values())),c=u.next();!c.done;c=u.next())this.sendListen_(c.value)}catch(d){n={error:d}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(f){t={error:f}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";Object(o.z)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+We.replace(/\./g,"-")]=1,Object(o.x)()?t["framework.cordova"]=1:Object(o.A)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=je.getInstance().currentlyOnline();return Object(o.u)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Xe),Qe=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=_("p:rest:"),i.listens_={},i}return Object(i.c)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Object(o.f)(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var s=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&s.onDataUpdate_(a,n,!1,r),Object(o.G)(s.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var s=i&&i.accessToken;s&&(e.auth=s);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+Object(o.F)(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=Object(o.D)(u.responseText)}catch(e){E("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&E("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},e}(Xe),Je=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Me,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new se,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.start=function(){var t=this;if(this.stats_=Ne.getCollection(this.repoInfo_),this.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new Qe(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(o.J)(e)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}this.persistentConnection_=new Ye(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),this.statsReporter_=Ne.getOrCreateReporter(this.repoInfo_,(function(){return new Pe(t.stats_,t.server_)})),this.transactionsInit_(),this.infoData_=new Re,this.infoSyncTree_=new Ae({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e.path);return s.isEmpty()||(o=t.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Ae({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);t.eventQueue_.raiseEventsForChangedPath(e.path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})},t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new X(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new X(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(r)if(n){var a=Object(o.E)(e,(function(t){return Vt(t)}));s=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=Vt(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=Object(o.E)(e,(function(t){return Vt(t)}));s=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=Vt(e);s=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;s.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;D(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new X("/.info/"+t),r=Vt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),s=Vt(e,n),a=this.serverSyncTree_.calcCompleteEventCache(t),u=ne(s,a,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),s.val(!0),(function(e,n){var o="ok"===e;o||E("set at "+t+" failed: "+e);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,s),i.callOnCompleteCallback(r,e,n)}));var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),s={};if(D(e,(function(e,n){i=!1,s[e]=ee(t.child(e),Vt(n),r.serverSyncTree_,o)})),i)w("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||E("update at "+t+" failed: "+e);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,e,i)})),D(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new se;this.onDisconnect_.forEachTree(X.Empty,(function(r,i){var o=ee(r,i,t.serverSyncTree_,e);n.remember(r,o)}));var r=[];n.forEachTree(X.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new se,this.eventQueue_.raiseEventsForChangedPath(X.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Vt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Vt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(Object(o.u)(e))return w("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&D(e,(function(e,n){var i=Vt(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new De(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);D(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),w.apply(void 0,Object(i.f)([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&$((function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new hn(this))},enumerable:!1,configurable:!0}),t}(),Ze=function(){function t(e){this.indexedFilter_=new ve(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new bt(e,n))||(n=Bt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Bt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Bt.EMPTY_NODE);var i=this;return e.forEachChild(It,(function(t,e){i.matches(new bt(t,e))||(r=r.updateImmediateChild(t,Bt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),tn=function(){function t(t){this.rangedFilter_=new Ze(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new bt(e,n))||(n=Bt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Bt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Bt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Bt.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)s=i.getNext(),!h&&c(a,s)<=0&&(h=!0),h&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,Bt.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(t,e){return a(e,t)}}else s=this.index_.getCompare();var u=t;Object(o.f)(u.numChildren()===this.limit_,"");var c=new bt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var d=u.getImmediateChild(e),f=r.getChildAfterChild(this.index_,l,this.reverse_);null!=f&&(f.name===e||u.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:s(f,c);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(ge.childChangedChange(e,n,d)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(ge.childRemovedChange(e,d));var m=u.updateImmediateChild(e,Bt.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(ge.childAddedChange(f.name,f.node)),m.updateImmediateChild(f.name,f.node)):m}return n.isEmpty()?t:h&&s(l,c)>=0?(null!=i&&(i.trackChildChange(ge.childRemovedChange(l.name,l.node)),i.trackChildChange(ge.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,Bt.EMPTY_NODE)):t},t}(),en=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=It}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:I},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:k},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Object(o.f)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==It&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===It},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new ve(this.getIndex()):this.hasLimit()?new tn(this):new Ze(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===It?e=n.PRIORITY_INDEX:this.index_===zt?e=n.VALUE_INDEX:this.index_===xt?e=n.KEY_INDEX:(Object(o.f)(this.index_ instanceof Wt,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=Object(o.J)(e),this.startSet_&&(r[n.START_AT]=Object(o.J)(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+Object(o.J)(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=Object(o.J)(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+Object(o.J)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),nn=function(t){function e(e,n){if(!(e instanceof Je))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,en.DEFAULT,!1)||this}return Object(i.c)(e,t),e.prototype.getKey=function(){return Object(o.K)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return Object(o.K)("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof X||(null===this.path.getFront()?dt("Reference.child",1,t,!1):ht("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){Object(o.K)("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Object(o.K)("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Object(o.K)("Reference.set",1,2,arguments.length),ft("Reference.set",this.path),ot("Reference.set",1,t,this.path,!1),Object(o.L)("Reference.set",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Object(o.K)("Reference.update",1,2,arguments.length),ft("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,E("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}at("Reference.update",1,t,this.path,!1),Object(o.L)("Reference.update",2,e,!0);var i=new o.a;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Object(o.K)("Reference.setWithPriority",2,3,arguments.length),ft("Reference.setWithPriority",this.path),ot("Reference.setWithPriority",1,t,this.path,!1),ut("Reference.setWithPriority",2,e,!1),Object(o.L)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.a;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Object(o.K)("Reference.remove",0,1,arguments.length),ft("Reference.remove",this.path),Object(o.L)("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Object(o.K)("Reference.transaction",1,3,arguments.length),ft("Reference.transaction",this.path),Object(o.L)("Reference.transaction",1,t,!1),Object(o.L)("Reference.transaction",2,e,!0),mt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new o.a;"function"==typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new vt(n,i)),"function"==typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){Object(o.K)("Reference.setPriority",1,2,arguments.length),ft("Reference.setPriority",this.path),ut("Reference.setPriority",1,t,!1),Object(o.L)("Reference.setPriority",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Object(o.K)("Reference.push",0,2,arguments.length),ft("Reference.push",this.path),ot("Reference.push",1,t,this.path,!0),Object(o.L)("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=yt(r),s=this.child(i),a=this.child(i);return n=null!=t?s.set(t,e).then((function(){return a})):Promise.resolve(a),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),s},e.prototype.onDisconnect=function(){return ft("Reference.onDisconnect",this.path),new gt(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Xt);Xt.__referenceConstructor=nn,Se.__referenceConstructor=nn;var rn=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),on=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new rn),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof X?e:new X(e),r=this,i=n.getFront();null!==i;)r=new t(i,r,Object(o.G)(r.node_.children,i)||new rn),i=(n=n.popFront()).getFront();return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){Object(o.f)(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;D(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new X(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=Object(o.k)(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}(),sn=function(t){return t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT",t}({});Je.MAX_TRANSACTION_RETRIES_=25,Je.prototype.transactionsInit_=function(){this.transactionQueueTree_=new on},Je.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},s=new nn(this,t);s.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:p(),applyLocally:r,retryCount:0,unwatcher:function(){s.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new qt(a.currentInputSnapshot,new nn(this,a.path),It);a.onComplete(null,!1,l)}}else{st("transaction failed: Data returned ",c,a.path),a.status=sn.RUN;var h=this.transactionQueueTree_.subTree(t),d=h.getValue()||[];d.push(a),h.setValue(d);var f=void 0;"object"==typeof c&&null!==c&&Object(o.k)(c,".priority")?(f=Object(o.G)(c,".priority"),Object(o.f)(it(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(this.serverSyncTree_.calcCompleteEventCache(t)||Bt.EMPTY_NODE).getPriority().val(),f=f;var m=this.generateServerValues(),g=Vt(c,f),v=ne(g,u,m);a.currentOutputSnapshotRaw=g,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_();var y=this.serverSyncTree_.applyUserOverwrite(t,v,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,y),this.sendReadyTransactions_()}},Je.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Bt.EMPTY_NODE},Je.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Object(o.f)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===sn.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},Je.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),s=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];Object(o.f)(c.status===sn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=sn.SENT,c.retryCount++;var l=X.relativePath(t,c.path);s=s.updateChild(l,c.currentOutputSnapshotRaw)}var h=s.val(!0),d=t;this.server_.put(d.toString(),h,(function(r){n.log_("transaction put response",{path:d.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<e.length;s++){if(e[s].status=sn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[s].currentWriteId)),e[s].onComplete){var a=e[s].currentOutputSnapshotResolved,u=new nn(n,e[s].path),c=new qt(a,u,It);o.push(e[s].onComplete.bind(null,null,!0,c))}e[s].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),s=0;s<o.length;s++)$(o[s])}else{if("datastale"===r)for(s=0;s<e.length;s++)e[s].status=e[s].status===sn.SENT_NEEDS_ABORT?sn.NEEDS_ABORT:sn.RUN;else for(E("transaction at "+d.toString()+" failed: "+r),s=0;s<e.length;s++)e[s].status=sn.NEEDS_ABORT,e[s].abortReason=r;n.rerunTransactions_(t)}}),a)},Je.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},Je.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter((function(t){return t.status===sn.RUN})).map((function(t){return t.currentWriteId})),s=0;s<t.length;s++){var a=t[s],u=X.relativePath(e,a.path),c=!1,l=void 0;if(Object(o.f)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===sn.NEEDS_ABORT)c=!0,l=a.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===sn.RUN)if(a.retryCount>=Je.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var h=this.getLatestState_(a.path,i);a.currentInputSnapshot=h;var d=t[s].update(h.val());if(void 0!==d){st("transaction failed: Data returned ",d,a.path);var f=Vt(d);"object"==typeof d&&null!=d&&Object(o.k)(d,".priority")||(f=f.updatePriority(h.getPriority()));var p=a.currentWriteId,m=this.generateServerValues(),g=ne(f,h,m);a.currentOutputSnapshotRaw=f,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(p),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(a.path,g,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else c=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],c&&(t[s].status=sn.COMPLETED,setTimeout(t[s].unwatcher,Math.floor(0)),t[s].onComplete))if("nodata"===l){var v=new nn(this,t[s].path),y=new qt(t[s].currentInputSnapshot,v,It);n.push(t[s].onComplete.bind(null,null,!1,y))}else n.push(t[s].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),s=0;s<n.length;s++)$(n[s]);this.sendReadyTransactions_()}},Je.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},Je.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},Je.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},Je.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==sn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},Je.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},Je.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,s=0;s<e.length;s++)e[s].status===sn.SENT_NEEDS_ABORT||(e[s].status===sn.SENT?(Object(o.f)(i===s-1,"All SENT items should be at beginning of queue."),i=s,e[s].status=sn.SENT_NEEDS_ABORT,e[s].abortReason="set"):(Object(o.f)(e[s].status===sn.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete&&n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),s=0;s<n.length;s++)$(n[s])}};var an,un=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';E(t+="credential"in this.app_.options?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},t}(),cn=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),ln=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return an||(an=new t),an},t.prototype.interrupt=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next())this.repos_[a][c.value].interrupt()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next())this.repos_[a][c.value].resume()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.applyEmulatorSettings=function(t,e,n){t.repoInfo_=new Q(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new cn)},t.prototype.databaseFromApp=function(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),w("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,s=J(i,r),a=s.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,a=(s=J(i="http://"+u+"?ns="+a.namespace,r)).repoInfo):o=!s.repoInfo.secure;var c=r&&o?new cn:new un(t,e);return pt("Invalid Firebase Database URL",1,s),s.path.isEmpty()||C("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,t,c).database},t.prototype.deleteRepo=function(t){var e=Object(o.G)(this.repos_,t.app.name);e&&Object(o.G)(e,t.key)===t||C("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.key]},t.prototype.createRepo=function(t,e,n){var r=Object(o.G)(this.repos_,e.name);r||(this.repos_[e.name]=r={});var i=Object(o.G)(r,t.toURLString());return i&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Je(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),hn=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return Object(i.b)(e,void 0,void 0,(function(){return Object(i.d)(this,(function(t){return this.checkDeleted_("delete"),ln.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]}))}))}},t instanceof Je||C("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new nn(this.repo_,X.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?C("Cannot call useEmulator() after instance has already been initialized."):ln.getInstance().applyEmulatorSettings(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),Object(o.K)("database.ref",0,1,arguments.length),t instanceof nn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Object(o.K)(e,1,1,arguments.length);var n=J(t,this.repo_.repoInfo_.nodeAdmin);pt(e,1,n);var r=n.repoInfo;return r.isCustomHost()||r.host===this.repo_.repoInfo_.host||C(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&C("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Object(o.K)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Object(o.K)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),dn=Object.freeze({__proto__:null,forceLongPolling:function(){Ge.forceDisallow(),Ue.forceAllow()},forceWebSockets:function(){Ue.forceDisallow()},isWebSocketsAvailable:function(){return Ge.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.customAuthImpl,i=t.namespace,o=t.nodeAdmin,s=void 0!==o&&o;qe(t.version);var u=new a.c("auth-internal",new a.b("database-standalone"));return u.setComponent(new a.a("auth-internal",(function(){return r}),"PRIVATE")),{instance:ln.getInstance().databaseFromApp(e,u,n,s),namespace:i}}}),fn=Ye;Ye.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ye.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var pn=Object.freeze({__proto__:null,DataConnection:fn,RealTimeConnection:Ke,hijackHash:function(t){var e=Ye.prototype.put;return Ye.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Ye.prototype.put=e}},ConnectionTarget:Q,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){ln.getInstance().forceRestClient(t)}}),mn=hn.ServerValue;!function(e){qe(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new a.a("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return ln.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:nn,Query:Xt,Database:hn,DataSnapshot:qt,enableLogging:b,INTERNAL:dn,ServerValue:mn,TEST_ACCESS:pn}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.7.0"),Object(o.z)()&&(t.exports=n)}(r.a)}).call(this,n("3UD+")(t))},7:function(t,e){},mrSG:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"h",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return h}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}},nbvr:function(t,e,n){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,s){n(i=t[e].apply(t,r)).then(o,s)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function s(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function a(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function d(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function f(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new d(n)}function p(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),s(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),s(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),s(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new f(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var i;n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return f}));var o=[],s=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},u=s.INFO,c=((i={})[s.DEBUG]="log",i[s.VERBOSE]="log",i[s.INFO]="info",i[s.WARN]="warn",i[s.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.DEBUG],t)),this._logHandler.apply(this,r([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.VERBOSE],t)),this._logHandler.apply(this,r([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.INFO],t)),this._logHandler.apply(this,r([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.WARN],t)),this._logHandler.apply(this,r([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.ERROR],t)),this._logHandler.apply(this,r([this,s.ERROR],t))},t}();function d(t){o.forEach((function(e){e.setLogLevel(t)}))}function f(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:s[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return k})),n.d(e,"c",(function(){return I})),n.d(e,"d",(function(){return V})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"h",(function(){return a})),n.d(e,"i",(function(){return u})),n.d(e,"j",(function(){return Y})),n.d(e,"k",(function(){return M})),n.d(e,"l",(function(){return U})),n.d(e,"m",(function(){return l})),n.d(e,"n",(function(){return h})),n.d(e,"o",(function(){return H})),n.d(e,"p",(function(){return f})),n.d(e,"q",(function(){return P})),n.d(e,"r",(function(){return g})),n.d(e,"s",(function(){return v})),n.d(e,"t",(function(){return b})),n.d(e,"u",(function(){return L})),n.d(e,"v",(function(){return w})),n.d(e,"w",(function(){return C})),n.d(e,"x",(function(){return p})),n.d(e,"y",(function(){return m})),n.d(e,"z",(function(){return x})),n.d(e,"A",(function(){return y})),n.d(e,"B",(function(){return _})),n.d(e,"C",(function(){return D})),n.d(e,"D",(function(){return R})),n.d(e,"E",(function(){return B})),n.d(e,"F",(function(){return j})),n.d(e,"G",(function(){return F})),n.d(e,"H",(function(){return X})),n.d(e,"I",(function(){return K})),n.d(e,"J",(function(){return O})),n.d(e,"K",(function(){return q})),n.d(e,"L",(function(){return G})),n.d(e,"M",(function(){return $})),n.d(e,"N",(function(){return E}));var r=n("mrSG"),i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=(15&a)<<2|c>>6,h=63&c;u||(h=64,s||(l=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[l],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==u&&r.push(a<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){var e=s(t);return a.encodeByteArray(e,!0)},c=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())}function m(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function g(){return"object"==typeof self&&self.self===self}function v(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function b(){return f().indexOf("Electron/")>=0}function w(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _(){return f().indexOf("MSAppHost/")>=0}function x(){return!1}function C(){return"indexedDB"in self&&null!=indexedDB}function E(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))}function S(){return!(!navigator||!navigator.cookieEnabled)}var I=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,k.prototype.create),o}return Object(r.c)(e,t),e}(Error),k=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?T(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new I(i,a,r);return u},t}();function T(t,e){return t.replace(A,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var A=/\{\$([^}]+)}/g;function R(t){return JSON.parse(t)}function O(t){return JSON.stringify(t)}var N=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=R(c(o[0])||""),n=R(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:r,signature:i}},D=function(t){var e=N(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},P=function(t){var e=N(t).claims;return"object"==typeof e&&!0===e.admin};function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function L(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function B(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function j(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}var V=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^a&(u^c),o=1518500249):(i=a^u^c,o=1859775393):r<60?(i=a&u|c&(a|u),o=2400959708):(i=a^u^c,o=3395469782);var h=(s<<5|s>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(a<<30|a>>>2),a=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function U(t,e){var n=new z(t,e);return n.subscribe.bind(n)}var z=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=W),void 0===r.error&&(r.error=W),void 0===r.complete&&(r.complete=W);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function W(){}var q=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function H(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}function G(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(H(t,e,r)+"must be a valid function.")}function $(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(H(t,e,r)+"must be a valid context object.")}var K=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var s=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(s<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},X=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function Y(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}},zIRd:function(t,e,n){"use strict";var r,i,o=n("mrSG"),s=n("qOnz"),a=n("/6Yf"),u=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new s.b("app","Firebase",c),h=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),d=new u.b("@firebase/app"),f=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(s.m)(t),this.container=new a.b(e.name),this._addComponent(new a.a("app",(function(){return u}),"PUBLIC"));try{for(var c=Object(o.h)(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next())this._addComponent(l.value)}catch(h){r={error:h}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();f.prototype.name&&f.prototype.options||f.prototype.delete||console.log("dc");var p=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw l.create("bad-app-name",{appName:String(a)});if(Object(s.k)(e,a))throw l.create("duplicate-app",{appName:a});var u=new t(n,o,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=h[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(u.join(" "))}c(new a.a(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.c,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument",{appName:name});Object(u.d)(t,e)},apps:null,SDK_VERSION:"8.0.0",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||"[DEFAULT]",!Object(s.k)(e,t))throw l.create("no-app",{appName:t});return e[t]}function c(a){var u,c,h=a.name;if(n.has(h))return d.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===a.type?r[h]:null;if(n.set(h,a),"PUBLIC"===a.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw l.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==a.serviceProps&&Object(s.n)(f,a.serviceProps),r[h]=f,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,a.multipleInstances?t:[])}}try{for(var p=Object(o.h)(Object.keys(e)),m=p.next();!m.done;m=p.next())e[m.value]._addComponent(a)}catch(g){u={error:g}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===a.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(f);return e.INTERNAL=Object(o.a)(Object(o.a)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(s.n)(e,t)},createSubscribe:s.l,ErrorFactory:s.b,deepExtend:s.n}),e}(),m=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(Object(s.r)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var g=self.firebase.SDK_VERSION;g&&g.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var v=p.initializeApp;p.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(s.y)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),v.apply(void 0,t)};var y=p;!function(t,e){t.INTERNAL.registerComponent(new a.a("platform-logger",(function(t){return new m(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.12",void 0),t.registerVersion("fire-js","")}(y),e.a=y},zUnb:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"DrawBoxOptions",(function(){return JZ})),n.d(r,"DrawBox",(function(){return ZZ})),n.d(r,"AnchorPosition",(function(){return XZ})),n.d(r,"DrawTextFieldOptions",(function(){return YZ})),n.d(r,"DrawTextField",(function(){return QZ}));var i={};n.r(i),n.d(i,"getModelUris",(function(){return c0})),n.d(i,"convLayer",(function(){return t0})),n.d(i,"disposeUnusedWeightTensors",(function(){return e0})),n.d(i,"extractConvParamsFactory",(function(){return n0})),n.d(i,"extractFCParamsFactory",(function(){return r0})),n.d(i,"extractSeparableConvParamsFactory",(function(){return o0})),n.d(i,"loadSeparableConvParamsFactory",(function(){return s0})),n.d(i,"extractWeightEntryFactory",(function(){return a0})),n.d(i,"extractWeightsFactory",(function(){return u0})),n.d(i,"SeparableConvParams",(function(){return i0})),n.d(i,"TinyYolov2",(function(){return P0})),n.d(i,"TinyYolov2SizeType",(function(){return N0})),n.d(i,"TinyYolov2Options",(function(){return D0})),n.d(i,"validateConfig",(function(){return T0}));var o={};function s(t){return"function"==typeof t}n.r(o),n.d(o,"drawContour",(function(){return M0})),n.d(o,"drawDetections",(function(){return j0})),n.d(o,"drawFaceExpressions",(function(){return Z0})),n.d(o,"DrawFaceLandmarksOptions",(function(){return i1})),n.d(o,"DrawFaceLandmarks",(function(){return o1})),n.d(o,"drawFaceLandmarks",(function(){return s1}));let a=!1;const u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else a&&console.log("RxJS: Back to a better error behavior. Thank you. <3");a=t},get useDeprecatedSynchronousErrorHandling(){return a}};function c(t){setTimeout(()=>{throw t},0)}const l={closed:!0,next(t){},error(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete(){}},h=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function d(t){return null!==t&&"object"==typeof t}const f=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let p=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_unsubscribe:r,_subscriptions:i}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(s(r))try{r.call(this)}catch(o){e=o instanceof f?m(o.errors):[o]}if(h(i)){let t=-1,n=i.length;for(;++t<n;){const n=i[t];if(d(n))try{n.unsubscribe()}catch(o){e=e||[],o instanceof f?e=e.concat(m(o.errors)):e.push(o)}}}if(e)throw new f(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function m(t){return t.reduce((t,e)=>t.concat(e instanceof f?e.errors:e),[])}const g=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class v extends p{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=l;break;case 1:if(!t){this.destination=l;break}if("object"==typeof t){t instanceof v?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new y(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new y(this,t,e,n)}}[g](){return this}static create(t,e,n){const r=new v(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class y extends v{constructor(t,e,n,r){let i;super(),this._parentSubscriber=t;let o=this;s(e)?i=e:e&&(i=e.next,n=e.error,r=e.complete,e!==l&&(o=Object.create(e),s(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=i,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=u;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;c(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);u.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw n;c(n)}}__tryOrSetError(t,e,n){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(c(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const b=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function w(t){return t}function _(...t){return x(t)}function x(t){return 0===t.length?w:1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}}let C=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof v)return t;if(t[g])return t[g]()}return t||e||n?new v(t,e,n):new v(l)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||u.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),u.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof v?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=E(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[b](){return this}pipe(...t){return 0===t.length?this:x(t)(this)}toPromise(t){return new(t=E(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function E(t){if(t||(t=u.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const S=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class I extends p{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class k extends v{constructor(t){super(t),this.destination=t}}let T=(()=>{class t extends C{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[g](){return new k(this)}lift(t){const e=new A(this,this);return e.operator=t,e}next(t){if(this.closed)throw new S;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new S;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new S;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new S;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new S;return this.hasError?(t.error(this.thrownError),p.EMPTY):this.isStopped?(t.complete(),p.EMPTY):(this.observers.push(t),new I(this,t))}asObservable(){const t=new C;return t.source=this,t}}return t.create=(t,e)=>new A(t,e),t})();class A extends T{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):p.EMPTY}}function R(t){return t&&"function"==typeof t.schedule}class O extends v{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const N=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()};function D(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const P=D(),M=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function F(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const L=t=>{if(t&&"function"==typeof t[b])return r=t,t=>{const e=r[b]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(M(t))return N(t);if(F(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,c),t);if(t&&"function"==typeof t[P])return e=t,t=>{const n=e[P]();for(;;){const e=n.next();if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=d(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}var e,n,r};function B(t,e,n,r,i=new O(t,n,r)){if(!i.closed)return e instanceof C?e.subscribe(i):L(e)(i)}class j extends v{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function V(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new U(t,e))}}class U{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new z(t,this.project,this.thisArg))}}class z extends v{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function W(t,e){return new C(n=>{const r=new p;let i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r})}function q(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[b]}(t))return function(t,e){return new C(n=>{const r=new p;return r.add(e.schedule(()=>{const i=t[b]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(F(t))return function(t,e){return new C(n=>{const r=new p;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(M(t))return W(t,e);if(function(t){return t&&"function"==typeof t[P]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new C(n=>{const r=new p;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[P](),r.add(e.schedule((function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())})))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof C?t:new C(L(t))}function H(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(H((n,r)=>q(t(n,r)).pipe(V((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new G(t,n)))}class G{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new $(t,this.project,this.concurrent))}}class $ extends j{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new O(this,e,n),i=this.destination;i.add(r);const o=B(this,t,void 0,void 0,r);o!==r&&i.add(o)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function K(t=Number.POSITIVE_INFINITY){return H(w,t)}function X(t,e){return e?W(t,e):new C(N(t))}function Y(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return R(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof C?t[0]:K(e)(X(t,n))}function Q(){return function(t){return t.lift(new J(t))}}class J{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new Z(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Z extends v{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class tt extends C{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new p,t.add(this.source.subscribe(new nt(this.getSubject(),this))),t.closed&&(this._connection=null,t=p.EMPTY)),t}refCount(){return Q()(this)}}const et=(()=>{const t=tt.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class nt extends k{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function rt(){return new T}function it(){return t=>{return Q()((e=rt,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,et);return r.source=t,r.subjectFactory=n,r})(t));var e}}function ot(t){return{toString:t}.toString()}function st(t,e,n){return ot(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}const at=st("Inject",t=>({token:t})),ut=st("Optional"),ct=st("Self"),lt=st("SkipSelf");var ht=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function dt(t){for(let e in t)if(t[e]===dt)return e;throw Error("Could not find renamed property on target object.")}function ft(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function pt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function mt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function gt(t){return vt(t,t[bt])||vt(t,t[xt])}function vt(t,e){return e&&e.token===t?e:null}function yt(t){return t&&(t.hasOwnProperty(wt)||t.hasOwnProperty(Ct))?t[wt]:null}const bt=dt({"\u0275prov":dt}),wt=dt({"\u0275inj":dt}),_t=dt({"\u0275provFallback":dt}),xt=dt({ngInjectableDef:dt}),Ct=dt({ngInjectorDef:dt});function Et(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Et).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function St(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const It=dt({__forward_ref__:dt});function kt(t){return t.__forward_ref__=kt,t.toString=function(){return Et(this())},t}function Tt(t){return At(t)?t():t}function At(t){return"function"==typeof t&&t.hasOwnProperty(It)&&t.__forward_ref__===kt}const Rt="undefined"!=typeof globalThis&&globalThis,Ot="undefined"!=typeof window&&window,Nt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Dt="undefined"!=typeof global&&global,Pt=Rt||Dt||Ot||Nt,Mt=dt({"\u0275cmp":dt}),Ft=dt({"\u0275dir":dt}),Lt=dt({"\u0275pipe":dt}),Bt=dt({"\u0275mod":dt}),jt=dt({"\u0275loc":dt}),Vt=dt({"\u0275fac":dt}),Ut=dt({__NG_ELEMENT_ID__:dt});class zt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=pt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Wt=new zt("INJECTOR",-1),qt={},Ht=/\n/gm,Gt=dt({provide:String,useValue:dt});let $t,Kt=void 0;function Xt(t){const e=Kt;return Kt=t,e}function Yt(t){const e=$t;return $t=t,e}function Qt(t,e=ht.Default){if(void 0===Kt)throw new Error("inject() must be called from an injection context");return null===Kt?te(t,void 0,e):Kt.get(t,e&ht.Optional?null:void 0,e)}function Jt(t,e=ht.Default){return($t||Qt)(Tt(t),e)}const Zt=Jt;function te(t,e,n){const r=gt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ht.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${Et(t)}]`)}function ee(t){const e=[];for(let n=0;n<t.length;n++){const r=Tt(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=ht.Default;for(let e=0;e<r.length;e++){const i=r[e];i instanceof ut||"Optional"===i.ngMetadataName||i===ut?n|=ht.Optional:i instanceof lt||"SkipSelf"===i.ngMetadataName||i===lt?n|=ht.SkipSelf:i instanceof ct||"Self"===i.ngMetadataName||i===ct?n|=ht.Self:t=i instanceof at||i===at?i.token:i}e.push(Jt(t,n))}else e.push(Jt(r))}return e}class ne{get(t,e=qt){if(e===qt){const e=new Error(`NullInjectorError: No provider for ${Et(t)}!`);throw e.name="NullInjectorError",e}return e}}class re{}class ie{}function oe(t,e){t.forEach(t=>Array.isArray(t)?oe(t,e):e(t))}function se(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ae(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function ue(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function ce(t,e,n){let r=he(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function le(t,e){const n=he(t,e);if(n>=0)return t[1|n]}function he(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=t[n<<1];if(e===o)return n<<1;o>e?i=n:r=n+1}return~(i<<1)}(t,e)}const de=function(){var t={OnPush:0,Default:1};return t[t.OnPush]="OnPush",t[t.Default]="Default",t}(),fe=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),pe={},me=[];let ge=0;function ve(t){return ot(()=>{const e=t.type,n=e.prototype,r={},i={type:e,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:t.changeDetection===de.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||me,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||fe.Emulated,id:"c",styles:t.styles||me,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.directives,s=t.features,a=t.pipes;return i.id+=ge++,i.inputs=xe(t.inputs,r),i.outputs=xe(t.outputs),s&&s.forEach(t=>t(i)),i.directiveDefs=o?()=>("function"==typeof o?o():o).map(ye):null,i.pipeDefs=a?()=>("function"==typeof a?a():a).map(be):null,i})}function ye(t){return Se(t)||function(t){return t[Ft]||null}(t)}function be(t){return function(t){return t[Lt]||null}(t)}const we={};function _e(t){const e={type:t.type,bootstrap:t.bootstrap||me,declarations:t.declarations||me,imports:t.imports||me,exports:t.exports||me,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&ot(()=>{we[t.id]=t.type}),e}function xe(t,e){if(null==t)return pe;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const Ce=ve;function Ee(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function Se(t){return t[Mt]||null}function Ie(t,e){return t.hasOwnProperty(Vt)?t[Vt]:null}function ke(t,e){const n=t[Bt]||null;if(!n&&!0===e)throw new Error(`Type ${Et(t)} does not have '\u0275mod' property.`);return n}function Te(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ae(t){return Array.isArray(t)&&!0===t[1]}function Re(t){return 0!=(8&t.flags)}function Oe(t){return 2==(2&t.flags)}function Ne(t){return 1==(1&t.flags)}function De(t){return null!==t.template}function Pe(t){return 0!=(512&t[2])}let Me=void 0;function Fe(t){return!!t.listen}const Le={createRenderer:(t,e)=>void 0!==Me?Me:"undefined"!=typeof document?document:void 0};function Be(t){for(;Array.isArray(t);)t=t[0];return t}function je(t,e){return Be(e[t+19])}function Ve(t,e){return Be(e[t.index])}function Ue(t,e){return t.data[e+19]}function ze(t,e){return t[e+19]}function We(t,e){const n=e[t];return Te(n)?n:n[0]}function qe(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function He(t){return 4==(4&t[2])}function Ge(t){return 128==(128&t[2])}function $e(t,e){return null===t||null==e?null:t[e]}function Ke(t){t[18]=0}const Xe={lFrame:vn(null),bindingsEnabled:!0,checkNoChangesMode:!1};function Ye(){return Xe.bindingsEnabled}function Qe(){return Xe.lFrame.lView}function Je(){return Xe.lFrame.tView}function Ze(t){Xe.lFrame.contextLView=t}function tn(){return Xe.lFrame.previousOrParentTNode}function en(t,e){Xe.lFrame.previousOrParentTNode=t,Xe.lFrame.isParent=e}function nn(){return Xe.lFrame.isParent}function rn(){Xe.lFrame.isParent=!1}function on(){return Xe.checkNoChangesMode}function sn(t){Xe.checkNoChangesMode=t}function an(){const t=Xe.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function un(){return Xe.lFrame.bindingIndex}function cn(){return Xe.lFrame.bindingIndex++}function ln(t){const e=Xe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function hn(t,e){const n=Xe.lFrame;n.bindingIndex=n.bindingRootIndex=t,n.currentDirectiveIndex=e}function dn(){return Xe.lFrame.currentQueryIndex}function fn(t){Xe.lFrame.currentQueryIndex=t}function pn(t,e){const n=gn();Xe.lFrame=n,n.previousOrParentTNode=e,n.lView=t}function mn(t,e){const n=gn(),r=t[1];Xe.lFrame=n,n.previousOrParentTNode=e,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex}function gn(){const t=Xe.lFrame,e=null===t?null:t.child;return null===e?vn(t):e}function vn(t){const e={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function yn(){const t=Xe.lFrame;return Xe.lFrame=t.parent,t.previousOrParentTNode=null,t.lView=null,t}const bn=yn;function wn(){const t=yn();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.currentSanitizer=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function _n(){return Xe.lFrame.selectedIndex}function xn(t){Xe.lFrame.selectedIndex=t}function Cn(){const t=Xe.lFrame;return Ue(t.tView,t.selectedIndex)}function En(){Xe.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function Sn(){Xe.lFrame.currentNamespace=null}function In(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n];e.afterContentInit&&(t.contentHooks||(t.contentHooks=[])).push(-n,e.afterContentInit),e.afterContentChecked&&((t.contentHooks||(t.contentHooks=[])).push(n,e.afterContentChecked),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,e.afterContentChecked)),e.afterViewInit&&(t.viewHooks||(t.viewHooks=[])).push(-n,e.afterViewInit),e.afterViewChecked&&((t.viewHooks||(t.viewHooks=[])).push(n,e.afterViewChecked),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,e.afterViewChecked)),null!=e.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(n,e.onDestroy)}}function kn(t,e,n){Rn(t,e,3,n)}function Tn(t,e,n,r){(3&t[2])===n&&Rn(t,e,n,r)}function An(t,e){let n=t[2];(3&n)===e&&(n&=1023,n+=1,t[2]=n)}function Rn(t,e,n,r){const i=null!=r?r:-1;let o=0;for(let s=void 0!==r?65535&t[18]:0;s<e.length;s++)if("number"==typeof e[s+1]){if(o=e[s],null!=r&&o>=r)break}else e[s]<0&&(t[18]+=65536),(o<i||-1==i)&&(On(t,n,e,s),t[18]=(4294901760&t[18])+s+2),s++}function On(t,e,n,r){const i=n[r]<0,o=n[r+1],s=t[i?-n[r]:n[r]];i?t[2]>>10<t[18]>>16&&(3&t[2])===e&&(t[2]+=1024,o.call(s)):o.call(s)}class Nn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Dn(t,e,n){const r=Fe(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const s=n[i++],a=n[i++],u=n[i++];r?t.setAttribute(e,a,u,s):e.setAttributeNS(s,a,u)}else{const s=o,a=n[++i];Mn(s)?r&&t.setProperty(e,s,a):r?t.setAttribute(e,s,a):e.setAttribute(s,a),i++}}return i}function Pn(t){return 3===t||4===t||6===t}function Mn(t){return 64===t.charCodeAt(0)}function Fn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||Ln(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function Ln(t,e,n,r,i){let o=0,s=t.length;if(-1===e)s=-1;else for(;o<t.length;){const n=t[o++];if("number"==typeof n){if(n===e){s=-1;break}if(n>e){s=o-1;break}}}for(;o<t.length;){const e=t[o];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(t.splice(s,0,e),o=s+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function Bn(t){return-1!==t}function jn(t){return 32767&t}function Vn(t){return t>>16}function Un(t,e){let n=Vn(t),r=e;for(;n>0;)r=r[15],n--;return r}function zn(t){return"string"==typeof t?t:null==t?"":""+t}function Wn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():zn(t)}const qn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Pt))();function Hn(t){return{name:"body",target:t.ownerDocument.body}}function Gn(t){return t instanceof Function?t():t}let $n=!0;function Kn(t){const e=$n;return $n=t,e}let Xn=0;function Yn(t,e){const n=Jn(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Qn(r.data,t),Qn(e,null),Qn(r.blueprint,null));const i=Zn(t,e),o=t.injectorIndex;if(Bn(i)){const t=jn(i),n=Un(i,e),r=n[1].data;for(let i=0;i<8;i++)e[o+i]=n[t+i]|r[t+i]}return e[o+8]=i,o}function Qn(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Jn(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null==e[t.injectorIndex+8]?-1:t.injectorIndex}function Zn(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=e[6],r=1;for(;n&&-1===n.injectorIndex;)n=(e=e[15])?e[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function tr(t,e,n){!function(t,e,n){let r="string"!=typeof n?n[Ut]:n.charCodeAt(0)||0;null==r&&(r=n[Ut]=Xn++);const i=255&r,o=1<<i,s=64&i,a=32&i,u=e.data;128&i?s?a?u[t+7]|=o:u[t+6]|=o:a?u[t+5]|=o:u[t+4]|=o:s?a?u[t+3]|=o:u[t+2]|=o:a?u[t+1]|=o:u[t]|=o}(t,e,n)}function er(t,e,n,r=ht.Default,i){if(null!==t){const i=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t[Ut];return"number"==typeof e&&e>0?255&e:e}(n);if("function"==typeof i){pn(e,t);try{const t=i();if(null!=t||r&ht.Optional)return t;throw new Error(`No provider for ${Wn(n)}!`)}finally{bn()}}else if("number"==typeof i){if(-1===i)return new ur(t,e);let o=null,s=Jn(t,e),a=-1,u=r&ht.Host?e[16][6]:null;for((-1===s||r&ht.SkipSelf)&&(a=-1===s?Zn(t,e):e[s+8],ar(r,!1)?(o=e[1],s=jn(a),e=Un(a,e)):s=-1);-1!==s;){a=e[s+8];const t=e[1];if(sr(i,s,t.data)){const t=rr(s,e,n,o,r,u);if(t!==nr)return t}ar(r,e[1].data[s+8]===u)&&sr(i,s,e)?(o=t,s=jn(a),e=Un(a,e)):s=-1}}}if(r&ht.Optional&&void 0===i&&(i=null),0==(r&(ht.Self|ht.Host))){const t=e[9],o=Yt(void 0);try{return t?t.get(n,i,r&ht.Optional):te(n,i,r&ht.Optional)}finally{Yt(o)}}if(r&ht.Optional)return i;throw new Error(`NodeInjector: NOT_FOUND [${Wn(n)}]`)}const nr={};function rr(t,e,n,r,i,o){const s=e[1],a=s.data[t+8],u=ir(a,s,n,null==r?Oe(a)&&$n:r!=s&&3===a.type,i&ht.Host&&o===a);return null!==u?or(e,s,u,a):nr}function ir(t,e,n,r,i){const o=t.providerIndexes,s=e.data,a=65535&o,u=t.directiveStart,c=o>>16,l=i?a+c:t.directiveEnd;for(let h=r?a:a+c;h<l;h++){const t=s[h];if(h<u&&n===t||h>=u&&t.type===n)return h}if(i){const t=s[u];if(t&&De(t)&&t.type===n)return u}return null}function or(t,e,n,r){let i=t[n];const o=e.data;if(i instanceof Nn){const s=i;if(s.resolving)throw new Error(`Circular dep for ${Wn(o[n])}`);const a=Kn(s.canSeeViewProviders);let u;s.resolving=!0,s.injectImpl&&(u=Yt(s.injectImpl)),pn(t,r);try{i=t[n]=s.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{onChanges:r,onInit:i,doCheck:o}=e;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)),i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{s.injectImpl&&Yt(u),Kn(a),s.resolving=!1,bn()}}return i}function sr(t,e,n){const r=64&t,i=32&t;let o;return o=128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e],!!(o&1<<t)}function ar(t,e){return!(t&ht.Self||t&ht.Host&&e)}class ur{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return er(this._tNode,this._lView,t,void 0,e)}}function cr(t){return ot(()=>{const e=Object.getPrototypeOf(t.prototype).constructor,n=e[Vt]||function t(e){const n=e;if(At(e))return()=>{const e=t(Tt(n));return e?e():null};let r=Ie(n);if(null===r){const t=yt(n);r=t&&t.factory}return r||null}(e);return null!==n?n:t=>new t})}function lr(t){return t.ngDebugContext}function hr(t){return t.ngOriginalError}function dr(t,...e){t.error(...e)}class fr{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||dr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?lr(t)?lr(t):this._findContext(hr(t)):null}_findOriginalError(t){let e=hr(t);for(;e&&hr(e);)e=hr(e);return e}}class pr{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class mr extends pr{getTypeName(){return"HTML"}}class gr extends pr{getTypeName(){return"Style"}}class vr extends pr{getTypeName(){return"Script"}}class yr extends pr{getTypeName(){return"URL"}}class br extends pr{getTypeName(){return"ResourceURL"}}function wr(t){return t instanceof pr?t.changingThisBreaksApplicationSecurity:t}function _r(t,e){const n=xr(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see http://g.co/ng/security#xss)`)}return n===e}function xr(t){return t instanceof pr&&t.getTypeName()||null}let Cr=!0,Er=!1;function Sr(){return Er=!0,Cr}class Ir{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");let e=this.inertDocument.body;if(null==e){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t),e=this.inertDocument.createElement("body"),t.appendChild(e)}e.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!e.querySelector||e.querySelector("svg")?(e.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=e.querySelector&&e.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(r){return null}const e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);const n=e.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(t){t="<body><remove></remove>"+t+"</body>";try{const e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(e){return null}}getInertBodyElement_InertDocument(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=t,e;const n=this.inertDocument.createElement("body");return n.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const kr=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Tr=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ar(t){return(t=String(t)).match(kr)||t.match(Tr)?t:(Sr()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function Rr(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Or(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const Nr=Rr("area,br,col,hr,img,wbr"),Dr=Rr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Pr=Rr("rp,rt"),Mr=Or(Pr,Dr),Fr=Or(Nr,Or(Dr,Rr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Or(Pr,Rr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Mr),Lr=Rr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Br=Rr("srcset"),jr=Or(Lr,Br,Rr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Rr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Vr=Rr("script,style,template");class Ur{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Fr.hasOwnProperty(e))return this.sanitizedSomething=!0,!Vr.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,o=e.toLowerCase();if(!jr.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let s=t.value;Lr[o]&&(s=Ar(s)),Br[o]&&(r=s,s=(r=String(r)).split(",").map(t=>Ar(t.trim())).join(", ")),this.buf.push(" ",e,'="',qr(s),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Fr.hasOwnProperty(e)&&!Nr.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(qr(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const zr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Wr=/([^\#-~ |!])/g;function qr(t){return t.replace(/&/g,"&amp;").replace(zr,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(Wr,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Hr;function Gr(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}const $r=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}(),Kr=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Xr=/^url\(([^)]+)\)$/;function Yr(t){const e=function(){const t=Qe();return t&&t[12]}();return e?e.sanitize($r.URL,t)||"":_r(t,"URL")?wr(t):Ar(zn(t))}function Qr(t,e){t.__ngContext__=e}function Jr(t){throw new Error(`Multiple components match node with tagname ${t.tagName}`)}function Zr(){throw new Error("Cannot mix multi providers and regular providers")}function ti(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}function ei(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==ti(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function ni(t,e,n){return e===(0!==t.type||n?t.tagName:"ng-template")}function ri(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(Pn(t[e]))return e;return t.length}(i);let s=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!s)if(4&r){if(r=2|1&r,""!==u&&!ni(t,u,n)||""===u&&1===e.length){if(ii(r))return!1;s=!0}}else{const c=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!ei(t.attrs,c,n)){if(ii(r))return!1;s=!0}continue}const l=oi(8&r?"class":u,i,0==t.type&&"ng-template"!==t.tagName,n);if(-1===l){if(ii(r))return!1;s=!0;continue}if(""!==c){let t;t=l>o?"":i[l+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==ti(e,c,0)||2&r&&c!==t){if(ii(r))return!1;s=!0}}}}else{if(!s&&!ii(r)&&!ii(u))return!1;if(s&&ii(u))continue;s=!1,r=u|1&r}}return ii(r)||s}function ii(t){return 0==(1&t)}function oi(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){if(t[n]===e)return n;n++}return-1}(e,t)}function si(t,e,n=!1){for(let r=0;r<e.length;r++)if(ri(t,e[r],n))return!0;return!1}function ai(t,e){t:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let e=0;e<t.length;e++)if(t[e]!==r[e])continue t;return!0}}return!1}function ui(t,e){return t?":not("+e.trim()+")":e}function ci(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&r){const e=t[++n];i+="["+s+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""===i||ii(s)||(e+=ui(o,i),i=""),r=s,o=o||!ii(r);n++}return""!==i&&(e+=ui(o,i)),e}const li={};function hi(t){const e=t[3];return Ae(e)?e[3]:e}function di(t){fi(Je(),Qe(),_n()+t,on())}function fi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&kn(e,r,n)}else{const r=t.preOrderHooks;null!==r&&Tn(e,r,0,n)}xn(n)}function pi(t,e){return t<<17|e<<2}function mi(t){return t>>17&32767}function gi(t){return 2|t}function vi(t){return(131068&t)>>2}function yi(t,e){return-131069&t|e<<2}function bi(t){return 1|t}function wi(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=t.data[o];fn(i),n.contentQueries(2,e[o],o)}}}function _i(t,e,n){return Fe(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function xi(t,e,n,r,i,o,s,a,u,c){const l=e.blueprint.slice();return l[0]=i,l[2]=140|r,Ke(l),l[3]=l[15]=t,l[8]=n,l[10]=s||t&&t[10],l[11]=a||t&&t[11],l[12]=u||t&&t[12]||null,l[9]=c||t&&t[9]||null,l[6]=o,l[16]=2==e.type?t[16]:l,l}function Ci(t,e,n,r,i,o){const s=n+19,a=t.data[s]||function(t,e,n,r,i,o){const s=tn(),a=nn(),u=a?s:s&&s.parent,c=t.data[n]=Di(0,u&&u!==e?u:null,r,n,i,o);return null===t.firstChild&&(t.firstChild=c),s&&(!a||null!=s.child||null===c.parent&&2!==s.type?a||(s.next=c):s.child=c),c}(t,e,s,r,i,o);return en(a,!0),a}function Ei(t,e,n){mn(e,e[6]);try{const r=t.viewQuery;null!==r&&no(1,r,n);const i=t.template;null!==i&&ki(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&wi(t,e),t.staticViewQueries&&no(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)Qi(t,e[n])}(e,o)}finally{e[2]&=-5,wn()}}function Si(t,e,n,r){const i=e[2];if(256==(256&i))return;mn(e,e[6]);const o=on();try{Ke(e),Xe.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&ki(t,e,n,2,r);const s=3==(3&i);if(!o)if(s){const n=t.preOrderCheckHooks;null!==n&&kn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&Tn(e,n,0,null),An(e,0)}if(function(t){let e=t[13];for(;null!==e;){let n;if(Ae(e)&&(n=e[2])>>1==-1){for(let t=9;t<e.length;t++){const n=e[t],r=n[1];Ge(n)&&Si(r,n,r.template,n[8])}0!=(1&n)&&Xi(e,t[16])}e=e[4]}}(e),null!==t.contentQueries&&wi(t,e),!o)if(s){const n=t.contentCheckHooks;null!==n&&kn(e,n)}else{const n=t.contentHooks;null!==n&&Tn(e,n,1),An(e,1)}!function(t,e){try{const n=t.expandoInstructions;if(null!==n){let r=t.expandoStartIndex,i=-1,o=-1;for(let t=0;t<n.length;t++){const s=n[t];"number"==typeof s?s<=0?(o=0-s,xn(o),r+=9+n[++t],i=r):r+=s:(null!==s&&(hn(r,i),s(2,e[i])),i++)}}}finally{xn(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Yi(t,e[n])}(e,a);const u=t.viewQuery;if(null!==u&&no(2,u,r),!o)if(s){const n=t.viewCheckHooks;null!==n&&kn(e,n)}else{const n=t.viewHooks;null!==n&&Tn(e,n,2),An(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73)}finally{wn()}}function Ii(t,e,n,r){const i=e[10],o=!on(),s=He(e);try{o&&!s&&i.begin&&i.begin(),s&&Ei(t,e,r),Si(t,e,n,r)}finally{o&&!s&&i.end&&i.end()}}function ki(t,e,n,r,i){const o=_n();try{xn(-1),2&r&&e.length>19&&fi(t,e,0,on()),n(r,i)}finally{xn(o)}}function Ti(t,e,n){if(Re(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}function Ai(t,e,n){Ye()&&(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Yn(n,e),Qr(r,e);const s=n.initialInputs;for(let a=i;a<o;a++){const r=t.data[a],o=De(r);o&&Hi(e,n,r);const u=or(e,t,a,n);Qr(u,e),null!==s&&Gi(0,a-i,u,r,0,s),o&&(We(n.index,e)[8]=u)}}(t,e,n,Ve(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=t.expandoInstructions,s=t.firstCreatePass,a=n.index-19;try{xn(a);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs?ji(r,i):s&&o.push(null)}}finally{xn(-1)}}(t,e,n))}function Ri(t,e,n=Ve){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(e,t):t[s];t[i++]=a}}}function Oi(t){return t.tView||(t.tView=Ni(1,-1,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts))}function Ni(t,e,n,r,i,o,s,a,u,c){const l=19+r,h=l+i,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:li);return n}(l,h);return d[1]={type:t,id:e,blueprint:d,template:n,queries:null,viewQuery:a,node:null,data:d.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:c}}function Di(t,e,n,r,i,o){return{type:n,index:r,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Pi(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function Mi(t,e,n,r,i,o,s,a){const u=Ve(e,n);let c,l=e.inputs;!a&&null!=l&&(c=l[r])?(uo(t,n,c,r,i),Oe(e)&&function(t,e){const n=We(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3===e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=s?s(i,e.tagName||"",r):i,Fe(o)?o.setProperty(u,r,i):Mn(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function Fi(t,e,n,r){let i=!1;if(Ye()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];si(n,s.selectors,!1)&&(i||(i=[]),tr(Yn(n,e),t,s.type),De(s)?(2&n.flags&&Jr(n),Ui(t,n),i.unshift(s)):i.push(s))}return i}(t,e,n),s=null===r?null:{"":-1};if(null!==o){let r=0;i=!0,Wi(n,t.data.length,o.length);for(let t=0;t<o.length;t++){const e=o[t];e.providersResolver&&e.providersResolver(e)}Vi(t,n,o.length);let a=!1,u=!1;for(let i=0;i<o.length;i++){const c=o[i];n.mergedAttrs=Fn(n.mergedAttrs,c.hostAttrs),qi(t,e,c),zi(t.data.length-1,c,s),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128),!a&&(c.onChanges||c.onInit||c.doCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index-19),a=!0),u||!c.onChanges&&!c.doCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index-19),u=!0),Li(t,c),r+=c.hostVars}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,o=[];let s=null,a=null;for(let u=e.directiveStart;u<n;u++){const t=r[u],e=t.inputs;o.push(null!==i?$i(e,i):null),s=Pi(e,u,s),a=Pi(t.outputs,u,a)}null!==s&&(s.hasOwnProperty("class")&&(e.flags|=16),s.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=s,e.outputs=a}(t,n),Bi(t,e,r)}s&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new Error(`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,s)}return n.mergedAttrs=Fn(n.mergedAttrs,n.attrs),i}function Li(t,e){const n=t.expandoInstructions;n.push(e.hostBindings),0!==e.hostVars&&n.push(e.hostVars)}function Bi(t,e,n){for(let r=0;r<n;r++)e.push(li),t.blueprint.push(li),t.data.push(null)}function ji(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Vi(t,e,n){const r=19-e.index,i=t.data.length-(65535&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(r,i,n)}function Ui(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function zi(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;De(e)&&(n[""]=t)}}function Wi(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function qi(t,e,n){t.data.push(n);const r=n.factory||(n.factory=Ie(n.type)),i=new Nn(r,De(n),null);t.blueprint.push(i),e.push(i)}function Hi(t,e,n){const r=Ve(e,t),i=Oi(n),o=t[10],s=Ji(t,xi(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n)));t[e.index]=s}function Gi(t,e,n,r,i,o){const s=o[e];if(null!==s){const t=r.setInput;for(let e=0;e<s.length;){const i=s[e++],o=s[e++],a=s[e++];null!==t?r.setInput(n,a,i,o):n[o]=a}}}function $i(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Ki(t,e,n,r){return new Array(t,!0,-2,e,null,null,r,n,null)}function Xi(t,e){const n=t[5];for(let r=0;r<n.length;r++){const t=n[r],i=t[3][3][16];if(i!==e&&0==(16&i[2])){const e=t[1];Si(e,t,e.template,t[8])}}}function Yi(t,e){const n=We(e,t);if(Ge(n)&&80&n[2]){const t=n[1];Si(t,n,t.template,n[8])}}function Qi(t,e){const n=We(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Ei(r,n,n[8])}function Ji(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Zi(t){for(;t;){t[2]|=64;const e=hi(t);if(Pe(t)&&!e)return t;t=e}return null}function to(t,e,n){const r=e[10];r.begin&&r.begin();try{Si(t,e,t.template,n)}catch(i){throw ao(e,i),i}finally{r.end&&r.end()}}function eo(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=qe(n),i=r[1];Ii(i,r,i.template,n)}}(t[8])}function no(t,e,n){fn(0),e(t,n)}const ro=(()=>Promise.resolve(null))();function io(t){return t[7]||(t[7]=[])}function oo(t){return t.cleanup||(t.cleanup=[])}function so(t,e){return function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(e[t.index])[11]}function ao(t,e){const n=t[9],r=n?n.get(fr,null):null;r&&r.handleError(e)}function uo(t,e,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],u=e[s],c=t.data[s];null!==c.setInput?c.setInput(u,i,r,a):u[a]=i}}function co(t,e,n){const r=je(e,t),i=t[11];Fe(i)?i.setValue(r,n):r.textContent=n}function lo(t,e){const n=e[3];return-1===t.index?Ae(n)?n:null:n}function ho(t,e){const n=lo(t,e);return n?Eo(e[11],n[7]):null}function fo(t,e,n,r,i){if(null!=r){let o,s=!1;Ae(r)?o=r:Te(r)&&(s=!0,r=r[0]);const a=Be(r);0===t&&null!==n?null==i?xo(e,n,a):_o(e,n,a,i||null):1===t&&null!==n?_o(e,n,a,i||null):2===t?function(t,e,n){const r=Eo(t,e);r&&function(t,e,n,r){Fe(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,a,s):3===t&&e.destroyNode(a),null!=o&&function(t,e,n,r,i){const o=n[7];o!==Be(n)&&fo(e,t,r,o,i);for(let s=9;s<n.length;s++){const i=n[s];Ao(i[1],i,t,e,r,o)}}(e,t,o,n,i)}}function po(t,e,n,r){const i=ho(t.node,e);i&&Ao(t,e,e[11],n?1:2,i,r)}function mo(t,e){const n=t[5],r=n.indexOf(e);n.splice(r,1)}function go(t,e){if(t.length<=9)return;const n=9+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&mo(i,r),e>0&&(t[n-1][4]=r[4]);const o=ae(t,9+e);po(r[1],r,!1,null);const s=o[5];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function vo(t,e){if(!(256&e[2])){const n=e[11];Fe(n)&&n.destroyNode&&Ao(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return bo(t[1],t);for(;e;){let n=null;if(Te(e))n=e[13];else{const t=e[9];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)Te(e)&&bo(e[1],e),e=yo(e,t);null===e&&(e=t),Te(e)&&bo(e[1],e),n=e&&e[4]}e=n}}(e)}}function yo(t,e){let n;return Te(t)&&(n=t[6])&&2===n.type?lo(n,t):t[3]===e?null:t[3]}function bo(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];t instanceof Nn||n[r+1].call(t)}}(t,e),function(t,e){const n=t.cleanup;if(null!==n){const t=e[7];for(let r=0;r<n.length-1;r+=2)if("string"==typeof n[r]){const i=n[r+1],o="function"==typeof i?i(e):Be(e[i]),s=t[n[r+2]],a=n[r+3];"boolean"==typeof a?o.removeEventListener(n[r],s,a):a>=0?t[a]():t[-a].unsubscribe(),r+=2}else n[r].call(t[n[r+1]]);e[7]=null}}(t,e);const n=e[6];n&&3===n.type&&Fe(e[11])&&e[11].destroy();const r=e[17];if(null!==r&&Ae(e[3])){r!==e[3]&&mo(r,e);const n=e[5];null!==n&&n.detachView(t)}}}function wo(t,e,n){let r=e.parent;for(;null!=r&&(4===r.type||5===r.type);)r=(e=r).parent;if(null==r){const t=n[6];return 2===t.type?ho(t,n):n[0]}if(e&&5===e.type&&4&e.flags)return Ve(e,n).parentNode;if(2&r.flags){const e=t.data,n=e[e[r.index].directiveStart].encapsulation;if(n!==fe.ShadowDom&&n!==fe.Native)return null}return Ve(r,n)}function _o(t,e,n,r){Fe(t)?t.insertBefore(e,n,r):e.insertBefore(n,r,!0)}function xo(t,e,n){Fe(t)?t.appendChild(e,n):e.appendChild(n)}function Co(t,e,n,r){null!==r?_o(t,e,n,r):xo(t,e,n)}function Eo(t,e){return Fe(t)?t.parentNode(e):e.parentNode}function So(t,e){if(2===t.type){const n=lo(t,e);return null===n?null:ko(n.indexOf(e,9)-9,n)}return 4===t.type||5===t.type?Ve(t,e):null}function Io(t,e,n,r){const i=wo(t,r,e);if(null!=i){const t=e[11],o=So(r.parent||e[6],e);if(Array.isArray(n))for(let e=0;e<n.length;e++)Co(t,i,n[e],o);else Co(t,i,n,o)}}function ko(t,e){const n=9+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return function t(e,n){if(null!==n){const r=n.type;if(3===r)return Ve(n,e);if(0===r)return ko(-1,e[n.index]);if(4===r||5===r){const r=n.child;if(null!==r)return t(e,r);{const t=e[n.index];return Ae(t)?ko(-1,t):Be(t)}}{const r=e[16],i=r[6],o=hi(r),s=i.projection[n.projection];return null!=s?t(o,s):t(e,n.next)}}return null}(t,r)}return e[7]}function To(t,e,n,r,i,o,s){for(;null!=n;){const a=r[n.index],u=n.type;s&&0===e&&(a&&Qr(Be(a),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(To(t,e,n.child,r,i,o,!1),fo(e,t,i,a,o)):1===u?Ro(t,e,r,n,i,o):fo(e,t,i,a,o)),n=s?n.projectionNext:n.next}}function Ao(t,e,n,r,i,o){To(n,r,t.node.child,e,i,o,!1)}function Ro(t,e,n,r,i,o){const s=n[16],a=s[6].projection[r.projection];if(Array.isArray(a))for(let u=0;u<a.length;u++)fo(e,t,i,a[u],o);else To(t,e,a,s[3],i,o,!0)}function Oo(t,e,n){Fe(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function No(t,e,n){Fe(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}class Do{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}get rootNodes(){const t=this._lView;return null==t[0]?function t(e,n,r,i,o=!1){for(;null!==r;){const s=n[r.index];if(null!==s&&i.push(Be(s)),Ae(s))for(let e=9;e<s.length;e++){const n=s[e],r=n[1].firstChild;null!==r&&t(n[1],n,r,i)}const a=r.type;if(4===a||5===a)t(e,n,r.child,i);else if(1===a){const e=n[16],o=e[6],s=hi(e);let a=o.projection[r.projection];null!==a&&null!==s&&t(s[1],s,a,i,!0)}r=o?r.projectionNext:r.next}return i}(t[1],t,t[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}vo(this._lView[1],this._lView)}onDestroy(t){var e,n,r;e=this._lView[1],r=t,io(n=this._lView).push(r),e.firstCreatePass&&oo(e).push(n[7].length-1,null)}markForCheck(){Zi(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){to(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){sn(!0);try{to(t,e,n)}finally{sn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,Ao(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Po extends Do{constructor(t){super(t),this._view=t}detectChanges(){eo(this._view)}checkNoChanges(){!function(t){sn(!0);try{eo(t)}finally{sn(!1)}}(this._view)}get context(){return null}}let Mo,Fo,Lo;function Bo(t,e,n){return Mo||(Mo=class extends t{}),new Mo(Ve(e,n))}function jo(t,e,n,r){return Fo||(Fo=class extends t{constructor(t,e,n){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=xi(this._declarationView,e,t,16,null,e.node);n[17]=this._declarationView[this._declarationTContainer.index];const r=this._declarationView[5];null!==r&&(n[5]=r.createEmbeddedView(e)),Ei(e,n,t);const i=new Do(n);return i._tViewNode=n[6],i}}),0===n.type?new Fo(r,n,Bo(e,n,r)):null}function Vo(t,e,n,r){let i;Lo||(Lo=class extends t{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostView=n}get element(){return Bo(e,this._hostTNode,this._hostView)}get injector(){return new ur(this._hostTNode,this._hostView)}get parentInjector(){const t=Zn(this._hostTNode,this._hostView),e=Un(t,this._hostView),n=function(t,e,n){if(n.parent&&-1!==n.parent.injectorIndex){const t=n.parent.injectorIndex;let e=n.parent;for(;null!=e.parent&&t==e.parent.injectorIndex;)e=e.parent;return e}let r=Vn(t),i=e,o=e[6];for(;r>1;)i=i[15],o=i[6],r--;return o}(t,this._hostView,this._hostTNode);return Bn(t)&&null!=n?new ur(n,e):new ur(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-9}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;if(!i&&null==t.ngModule&&o){const t=o.get(re,null);t&&(i=t)}const s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){const n=t._lView,r=n[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Ae(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Lo(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e);return function(t,e,n,r){const i=9+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-9?(e[4]=n[i],se(n,9+r,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[17];null!==s&&n!==s&&function(t,e){const n=t[5],r=e[3][3][16];16!=(16&r[2])&&e[16]!==r&&(t[2]|=1),null===n?t[5]=[e]:n.push(e)}(s,e);const a=e[5];null!==a&&a.insertView(t),e[2]|=128}(r,n,this._lContainer,i),po(r,n,!0,ko(i,this._lContainer)),t.attachToViewContainerRef(this),se(this._lContainer[8],i,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1);(function(t,e){const n=go(t,e);n&&vo(n[1],n)})(this._lContainer,e),ae(this._lContainer[8],e)}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),n=go(this._lContainer,e);return n&&null!=ae(this._lContainer[8],e)?new Do(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const o=r[n.index];if(Ae(o))i=o,function(t,e){t[2]=-2}(i);else{let t;if(4===n.type)t=Be(o);else if(t=r[11].createComment(""),Pe(r)){const e=r[11],i=Ve(n,r);_o(e,Eo(e,i),t,function(t,e){return Fe(t)?t.nextSibling(e):e.nextSibling}(e,i))}else Io(r[1],r,t,n);r[n.index]=i=Ki(o,r,t,n),Ji(r,i)}return new Lo(i,n,r)}function Uo(t=!1){return function(t,e,n){if(!n&&Oe(t)){const n=We(t.index,e);return new Do(n,n)}return 3===t.type||0===t.type||4===t.type||5===t.type?new Do(e[16],e):null}(tn(),Qe(),t)}let zo=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Wo(),t})();const Wo=Uo,qo=new zt("Set Injector scope."),Ho={},Go={},$o=[];let Ko=void 0;function Xo(){return void 0===Ko&&(Ko=new ne),Ko}function Yo(t,e=null,n=null,r){return new Qo(t,n,e||Xo(),r)}class Qo{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&oe(e,n=>this.processProvider(n,t,e)),oe([t],t=>this.processInjectorType(t,[],i)),this.records.set(Wt,ts(void 0,this));const o=this.records.get(qo);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:Et(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=qt,n=ht.Default){this.assertNotDestroyed();const r=Xt(this);try{if(!(n&ht.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof zt)&&gt(t);e=n&&this.injectableDefInScope(n)?ts(Jo(t),Ho):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&ht.Self?Xo():this.parent).get(t,e=n&ht.Optional&&e===qt?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(Et(t)),r)throw o;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=Et(e);if(Array.isArray(e))i=e.map(Et).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):Et(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Ht,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{Xt(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(Et(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=Tt(t)))return!1;let r=yt(t);const i=null==r&&t.ngModule||void 0,o=void 0===i?t:i,s=-1!==n.indexOf(o);if(void 0!==i&&(r=yt(i)),null==r)return!1;if(null!=r.imports&&!s){let t;n.push(o);try{oe(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];oe(r,t=>this.processProvider(t,n,r||$o))}}this.injectorDefTypes.add(o),this.records.set(o,ts(r.factory,Ho));const a=r.providers;if(null!=a&&!s){const e=t;oe(a,t=>this.processProvider(t,e,a))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=ns(t=Tt(t))?t:Tt(t&&t.provide);const i=function(t,e,n){return es(t)?ts(void 0,t.useValue):ts(Zo(t,e,n),Ho)}(t,e,n);if(ns(t)||!0!==t.multi){const t=this.records.get(r);t&&void 0!==t.multi&&Zr()}else{let e=this.records.get(r);e?void 0===e.multi&&Zr():(e=ts(void 0,Ho,!0),e.factory=()=>ee(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===Go?function(t){throw new Error(`Cannot instantiate cyclic dependency! ${t}`)}(Et(t)):e.value===Ho&&(e.value=Go,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function Jo(t){const e=gt(t),n=null!==e?e.factory:Ie(t);if(null!==n)return n;const r=yt(t);if(null!==r)return r.factory;if(t instanceof zt)throw new Error(`Token ${Et(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=ue(e,"?");throw new Error(`Can't resolve all parameters for ${Et(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[bt]||t[xt]||t[_t]&&t[_t]());if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\n`+`This will become an error in v10. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Zo(t,e,n){let r=void 0;if(ns(t)){const e=Tt(t);return Ie(e)||Jo(e)}if(es(t))r=()=>Tt(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...ee(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Jt(Tt(t.useExisting));else{const i=Tt(t&&(t.useClass||t.provide));if(i||function(t,e,n){let r="";throw t&&e&&(r=` - only instances of Provider and Type are allowed, got: [${e.map(t=>t==n?"?"+n+"?":"...").join(", ")}]`),new Error(`Invalid provider for the NgModule '${Et(t)}'`+r)}(e,n,t),!function(t){return!!t.deps}(t))return Ie(i)||Jo(i);r=()=>new i(...ee(t.deps))}var i;return r}function ts(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function es(t){return null!==t&&"object"==typeof t&&Gt in t}function ns(t){return"function"==typeof t}const rs=function(t,e,n){return function(t,e=null,n=null,r){const i=Yo(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let is=(()=>{class t{static create(t,e){return Array.isArray(t)?rs(t,e,""):rs(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=qt,t.NULL=new ne,t.\u0275prov=pt({token:t,providedIn:"any",factory:()=>Jt(Wt)}),t.__NG_ELEMENT_ID__=-1,t})();const os=new zt("AnalyzeForEntryComponents");let ss=new Map;const as=new Set;function us(t){return"string"==typeof t?t:t.text()}function cs(t,e){let n=t.styles,r=t.classes,i=0;for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?i=t:1==i?r=St(r,t):2==i&&(n=St(n,t+": "+e[++o]+";"))}null!==n&&(t.styles=n),null!==r&&(t.classes=r)}let ls=null;function hs(){if(!ls){const t=Pt.Symbol;if(t&&t.iterator)ls=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(ls=n)}}}return ls}function ds(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}class fs{constructor(t){this.wrapped=t}static wrap(t){return new fs(t)}static unwrap(t){return fs.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof fs}}function ps(t){return!!ms(t)&&(Array.isArray(t)||!(t instanceof Map)&&hs()in t)}function ms(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function gs(t,e,n){return t[e]=n}function vs(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function ys(t,e,n,r){const i=Qe();return vs(i,cn(),e)&&(Je(),function(t,e,n,r,i,o){const s=Ve(t,e),a=e[11];if(null==r)Fe(a)?a.removeAttribute(s,n,o):s.removeAttribute(n);else{const e=null==i?zn(r):i(r,t.tagName||"",n);Fe(a)?a.setAttribute(s,n,e,o):o?s.setAttributeNS(o,n,e):s.setAttribute(n,e)}}(Cn(),i,t,e,n,r)),ys}function bs(t,e,n,r){return vs(t,cn(),n)?e+zn(n)+r:li}function ws(t,e,n,r,i,o,s,a){const u=Qe(),c=Je(),l=t+19,h=c.firstCreatePass?function(t,e,n,r,i,o,s,a,u){const c=e.consts,l=Ci(e,n[6],t,0,s||null,$e(c,a));Fi(e,n,l,$e(c,u)),In(e,l);const h=l.tViews=Ni(2,-1,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c),d=Di(0,null,2,-1,null,null);return d.injectorIndex=l.injectorIndex,h.node=d,null!==e.queries&&(e.queries.template(e,l),h.queries=e.queries.embeddedTView(l)),l}(t,c,u,e,n,r,i,o,s):c.data[l];en(h,!1);const d=u[11].createComment("");Io(c,u,d,h),Qr(d,u),Ji(u,u[l]=Ki(d,u,d,h)),Ne(h)&&Ai(c,u,h),null!=s&&Ri(u,h,a)}function _s(t){return ze(Xe.lFrame.contextLView,t)}function xs(t,e=ht.Default){const n=Qe();return null==n?Jt(t,e):er(tn(),n,Tt(t),e)}function Cs(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(Pn(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(tn(),t)}function Es(){throw new Error("invalid")}function Ss(t,e,n){const r=Qe();return vs(r,cn(),e)&&Mi(Je(),Cn(),r,t,e,r[11],n,!1),Ss}function Is(t,e,n,r,i){const o=i?"class":"style";uo(t,n,e.inputs[o],o,r)}function ks(t,e,n,r){const i=Qe(),o=Je(),s=19+t,a=i[11],u=i[s]=_i(e,a,Xe.lFrame.currentNamespace),c=o.firstCreatePass?function(t,e,n,r,i,o,s){const a=e.consts,u=$e(a,o),c=Ci(e,n[6],t,3,i,u);return Fi(e,n,c,$e(a,s)),null!==c.mergedAttrs&&cs(c,c.mergedAttrs),null!==e.queries&&e.queries.elementStart(e,c),c}(t,o,i,0,e,n,r):o.data[s];en(c,!0);const l=c.mergedAttrs;null!==l&&Dn(a,u,l);const h=c.classes;null!==h&&No(a,u,h);const d=c.styles;null!==d&&Oo(a,u,d),Io(o,i,u,c),0===Xe.lFrame.elementDepthCount&&Qr(u,i),Xe.lFrame.elementDepthCount++,Ne(c)&&(Ai(o,i,c),Ti(o,c,i)),null!==r&&Ri(i,c)}function Ts(){let t=tn();nn()?rn():(t=t.parent,en(t,!1));const e=t;Xe.lFrame.elementDepthCount--;const n=Je();n.firstCreatePass&&(In(n,t),Re(t)&&n.queries.elementEnd(t)),null!==e.classes&&function(t){return 0!=(16&t.flags)}(e)&&Is(n,e,Qe(),e.classes,!0),null!==e.styles&&function(t){return 0!=(32&t.flags)}(e)&&Is(n,e,Qe(),e.styles,!1)}function As(t,e,n,r){ks(t,e,n,r),Ts()}function Rs(t,e,n){const r=Qe(),i=Je(),o=t+19,s=i.firstCreatePass?function(t,e,n,r,i){const o=e.consts,s=$e(o,r),a=Ci(e,n[6],t,4,"ng-container",s);return null!==s&&cs(a,s),Fi(e,n,a,$e(o,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(t,i,r,e,n):i.data[o];en(s,!0);const a=r[o]=r[11].createComment("");Io(i,r,a,s),Qr(a,r),Ne(s)&&(Ai(i,r,s),Ti(i,s,r)),null!=n&&Ri(r,s)}function Os(){let t=tn();const e=Je();nn()?rn():(t=t.parent,en(t,!1)),e.firstCreatePass&&(In(e,t),Re(t)&&e.queries.elementEnd(t))}function Ns(t,e,n){Rs(t,e,n),Os()}function Ds(){return Qe()}function Ps(t){return!!t&&"function"==typeof t.then}function Ms(t){return!!t&&"function"==typeof t.subscribe}function Fs(t,e,n=!1,r){const i=Qe(),o=Je(),s=tn();return Bs(o,i,i[11],s,t,e,n,r),Fs}function Ls(t,e,n=!1,r){const i=tn(),o=Qe(),s=so(i,o);return Bs(Je(),o,s,i,t,e,n,r),Ls}function Bs(t,e,n,r,i,o,s=!1,a){const u=Ne(r),c=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),l=io(e);let h=!0;if(3===r.type){const d=Ve(r,e),f=a?a(d):pe,p=f.target||d,m=l.length,g=a?t=>a(Be(t[r.index])).target:r.index;if(Fe(n)){let s=null;if(!a&&u&&(s=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const t=i[o];if(t===n&&i[o+1]===r){const t=e[7],n=i[o+2];return t.length>n?t[n]:null}"string"==typeof t&&(o+=2)}return null}(t,e,i,r.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=o,s.__ngLastListenerFn__=o,h=!1;else{o=Vs(r,e,o,!1);const t=n.listen(f.name||p,i,o);l.push(o,t),c&&c.push(i,g,m,m+1)}}else o=Vs(r,e,o,!0),p.addEventListener(i,o,s),l.push(o),c&&c.push(i,g,m,s)}const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(o),s=l.length;l.push(o,t),c&&c.push(i,r.index,s,-(s+1))}}}function js(t,e,n){try{return!1!==e(n)}catch(r){return ao(t,r),!1}}function Vs(t,e,n,r){return function i(o){if(o===Function)return n;const s=2&t.flags?We(t.index,e):e;0==(32&e[2])&&Zi(s);let a=js(e,n,o),u=i.__ngNextListenerFn__;for(;u;)a=js(e,u,o)&&a,u=u.__ngNextListenerFn__;return r&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function Us(t=1){return function(t){return(Xe.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Xe.lFrame.contextLView))[8]}(t)}function zs(t,e){let n=null;const r=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===r?si(t,o,!0):ai(r,o))return i}else n=i}return n}function Ws(t){const e=Qe()[16][6];if(!e.projection){const n=e.projection=ue(t?t.length:1,null),r=n.slice();let i=e.child;for(;null!==i;){const e=t?zs(i,t):0;null!==e&&(r[e]?r[e].projectionNext=i:n[e]=i,r[e]=i),i=i.next}}}function qs(t,e=0,n){const r=Qe(),i=Je(),o=Ci(i,r[6],t,1,null,n||null);null===o.projection&&(o.projection=e),rn(),function(t,e,n){Ro(e[11],0,e,n,wo(t,n,e),So(n.parent||e[6],e))}(i,r,o)}function Hs(t,e,n){return Gs(t,"",e,"",n),Hs}function Gs(t,e,n,r,i){const o=Qe(),s=bs(o,e,n,r);return s!==li&&Mi(Je(),Cn(),o,t,s,o[11],i,!1),Gs}const $s=[];function Ks(t,e,n,r,i){const o=t[n+1],s=null===e;let a=r?mi(o):vi(o),u=!1;for(;0!==a&&(!1===u||s);){const n=t[a+1];Xs(t[a],e)&&(u=!0,t[a+1]=r?bi(n):gi(n)),a=r?mi(n):vi(n)}u&&(t[n+1]=r?gi(o):bi(o))}function Xs(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&he(t,e)>=0}const Ys={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Qs(t){return t.substring(Ys.key,Ys.keyEnd)}function Js(t,e){const n=Ys.textEnd;return n===e?-1:(e=Ys.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,Ys.key=e,n),Zs(t,e,n))}function Zs(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function ta(t,e,n){return ra(t,e,n,!1),ta}function ea(t,e){return ra(t,e,null,!0),ea}function na(t,e){for(let n=function(t){return function(t){Ys.key=0,Ys.keyEnd=0,Ys.value=0,Ys.valueEnd=0,Ys.textEnd=t.length}(t),Js(t,Zs(t,0,Ys.textEnd))}(e);n>=0;n=Js(e,n))ce(t,Qs(e),!0)}function ra(t,e,n,r){const i=Qe(),o=Je(),s=ln(2);if(o.firstUpdatePass&&sa(o,t,s,r),e!==li&&vs(i,s,e)){let a;null==n&&(a=function(){const t=Xe.lFrame;return null===t?null:t.currentSanitizer}())&&(n=a),ca(o,o.data[_n()+19],i,i[11],t,i[s+1]=function(t,e){return null==t||("function"==typeof e?t=e(t):"string"==typeof e?t+=e:"object"==typeof t&&(t=Et(wr(t)))),t}(e,n),r,s)}}function ia(t,e,n,r){const i=Je(),o=ln(2);i.firstUpdatePass&&sa(i,null,o,r);const s=Qe();if(n!==li&&vs(s,o,n)){const a=i.data[_n()+19];if(da(a,r)&&!oa(i,o)){let t=r?a.classes:a.styles;null!==t&&(n=St(t,n||"")),Is(i,a,s,n,r)}else!function(t,e,n,r,i,o,s,a){i===li&&(i=$s);let u=0,c=0,l=0<i.length?i[0]:null,h=0<o.length?o[0]:null;for(;null!==l||null!==h;){const d=u<i.length?i[u+1]:void 0,f=c<o.length?o[c+1]:void 0;let p=null,m=void 0;l===h?(u+=2,c+=2,d!==f&&(p=h,m=f)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,m=f),null!==p&&ca(t,e,n,r,p,m,s,a),l=u<i.length?i[u]:null,h=c<o.length?o[c]:null}}(i,a,s,s[11],s[o+1],s[o+1]=function(t,e,n){if(null==n||""===n)return $s;const r=[],i=wr(n);if(Array.isArray(i))for(let o=0;o<i.length;o++)t(r,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&t(r,o,i[o]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,o)}}function oa(t,e){return e>=t.expandoStartIndex}function sa(t,e,n,r){const i=t.data;if(null===i[n+1]){const o=i[_n()+19],s=oa(t,n);da(o,r)&&null===e&&!s&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=Xe.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let o=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=ua(n=aa(null,t,e,n,r),e.attrs,r),o=null);else{const s=e.directiveStylingLast;if(-1===s||t[s]!==i)if(n=aa(i,t,e,n,r),null===o){let n=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==vi(r))return t[mi(r)]}(t,e,r);void 0!==n&&Array.isArray(n)&&(n=aa(null,t,e,n[1],r),n=ua(n,e.attrs,r),function(t,e,n,r){t[mi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,n))}else o=function(t,e,n){let r=void 0;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=ua(r,t[o].hostAttrs,n);return ua(r,e.attrs,n)}(t,e,r)}return void 0!==o&&(r?e.residualClasses=o:e.residualStyles=o),n}(i,o,e,r),function(t,e,n,r,i,o){let s=o?e.classBindings:e.styleBindings,a=mi(s),u=vi(s);t[r]=n;let c,l=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||he(t,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){const e=mi(t[a+1]);t[r+1]=pi(e,a),0!==e&&(t[e+1]=yi(t[e+1],r)),t[a+1]=131071&t[a+1]|r<<17}else t[r+1]=pi(a,0),0!==a&&(t[a+1]=yi(t[a+1],r)),a=r;else t[r+1]=pi(u,0),0===a?a=r:t[u+1]=yi(t[u+1],r),u=r;l&&(t[r+1]=gi(t[r+1])),Ks(t,c,r,!0),Ks(t,c,r,!1),function(t,e,n,r,i){const o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof e&&he(o,e)>=0&&(n[r+1]=bi(n[r+1]))}(e,c,t,r,o),s=pi(a,u),o?e.classBindings=s:e.styleBindings=s}(i,o,e,n,s,r)}}function aa(t,e,n,r,i){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=e[a],r=ua(r,o.hostAttrs,i),o!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function ua(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ce(t,s,!!n||e[++o]))}return void 0===t?null:t}function ca(t,e,n,r,i,o,s,a){if(3!==e.type)return;const u=t.data,c=u[a+1];ha(1==(1&c)?la(u,e,n,i,vi(c),s):void 0)||(ha(o)||function(t){return 2==(2&t)}(c)&&(o=la(u,null,n,i,a,s)),function(t,e,n,r,i){const o=Fe(t);if(e)i?o?t.addClass(n,r):n.classList.add(r):o?t.removeClass(n,r):n.classList.remove(r);else{const e=-1==r.indexOf("-")?void 0:2;null==i?o?t.removeStyle(n,r,e):n.style.removeProperty(r):o?t.setStyle(n,r,i,e):n.style.setProperty(r,i)}}(r,s,je(_n(),n),i,o))}function la(t,e,n,r,i,o){const s=null===e;let a=void 0;for(;i>0;){const e=t[i],o=Array.isArray(e),u=o?e[1]:e,c=null===u;let l=n[i+1];l===li&&(l=c?$s:void 0);let h=c?le(l,r):u===r?l:void 0;if(o&&!ha(h)&&(h=le(e,r)),ha(h)&&(a=h,s))return a;const d=t[i+1];i=s?mi(d):vi(d)}if(null!==e){let t=o?e.residualClasses:e.residualStyles;null!=t&&(a=le(t,r))}return a}function ha(t){return void 0!==t}function da(t,e){return 0!=(t.flags&(e?16:32))}function fa(t,e=""){const n=Qe(),r=Je(),i=t+19,o=r.firstCreatePass?Ci(r,n[6],t,3,null,null):r.data[i],s=n[i]=function(t,e){return Fe(e)?e.createText(t):e.createTextNode(t)}(e,n[11]);Io(r,n,s,o),en(o,!1)}function pa(t){return ma("",t,""),pa}function ma(t,e,n){const r=Qe(),i=bs(r,t,e,n);return i!==li&&co(r,_n(),i),ma}function ga(t,e,n,r,i){const o=Qe(),s=function(t,e,n,r,i,o){const s=function(t,e,n,r){const i=vs(t,e,n);return vs(t,e+1,r)||i}(t,un(),n,i);return ln(2),s?e+zn(n)+r+zn(i)+o:li}(o,t,e,n,r,i);return s!==li&&co(o,_n(),s),ga}function va(t,e,n){const r=Qe();return vs(r,cn(),e)&&Mi(Je(),Cn(),r,t,e,r[11],n,!0),va}function ya(t,e,n){const r=Qe();if(vs(r,cn(),e)){const i=Je(),o=Cn();Mi(i,o,r,t,e,so(o,r),n,!0)}return ya}function ba(t,e){const n=qe(t)[1],r=n.data.length-1;In(n,{directiveStart:r,directiveEnd:r+1})}function wa(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i=void 0;if(De(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=_a(t.inputs),e.declaredInputs=_a(t.declaredInputs),e.outputs=_a(t.outputs);const n=i.hostBindings;n&&Ea(t,n);const o=i.viewQuery,s=i.contentQueries;if(o&&xa(t,o),s&&Ca(t,s),ft(t.inputs,i.inputs),ft(t.declaredInputs,i.declaredInputs),ft(t.outputs,i.outputs),De(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}e.afterContentChecked=e.afterContentChecked||i.afterContentChecked,e.afterContentInit=t.afterContentInit||i.afterContentInit,e.afterViewChecked=t.afterViewChecked||i.afterViewChecked,e.afterViewInit=t.afterViewInit||i.afterViewInit,e.doCheck=t.doCheck||i.doCheck,e.onDestroy=t.onDestroy||i.onDestroy,e.onInit=t.onInit||i.onInit}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===wa&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Fn(i.hostAttrs,n=Fn(n,i.hostAttrs))}}(r)}function _a(t){return t===pe?{}:t===me?[]:t}function xa(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function Ca(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function Ea(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}class Sa{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ia(t){t.type.prototype.ngOnChanges&&(t.setInput=ka,t.onChanges=function(){const t=Ta(this),e=t&&t.current;if(e){const n=t.previous;if(n===pe)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}})}function ka(t,e,n,r){const i=Ta(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:pe,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],u=s[a];o[a]=new Sa(u&&u.currentValue,e,s===pe),t[r]=e}function Ta(t){return t.__ngSimpleChanges__||null}function Aa(t,e,n,r,i){if(t=Tt(t),Array.isArray(t))for(let o=0;o<t.length;o++)Aa(t[o],e,n,r,i);else{const o=Je(),s=Qe();let a=ns(t)?t:Tt(t.provide),u=Zo(t);const c=tn(),l=65535&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>16;if(ns(t)||!t.multi){const r=new Nn(u,i,xs),f=Na(a,e,i?l:l+d,h);-1===f?(tr(Yn(c,s),o,a),Ra(o,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=65536),n.push(r),s.push(r)):(n[f]=r,s[f]=r)}else{const f=Na(a,e,l+d,h),p=Na(a,e,l,l+d),m=f>=0&&n[f],g=p>=0&&n[p];if(i&&!g||!i&&!m){tr(Yn(c,s),o,a);const l=function(t,e,n,r,i){const o=new Nn(t,n,xs);return o.multi=[],o.index=e,o.componentProviders=0,Oa(o,i,r&&!n),o}(i?Pa:Da,n.length,i,r,u);!i&&g&&(n[p].providerFactory=l),Ra(o,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=65536),n.push(l),s.push(l)}else Ra(o,t,f>-1?f:p),Oa(n[i?p:f],u,!i&&r);!i&&r&&g&&n[p].componentProviders++}}}function Ra(t,e,n){if(ns(e)||e.useClass){const r=(e.useClass||e).prototype.ngOnDestroy;r&&(t.destroyHooks||(t.destroyHooks=[])).push(n,r)}}function Oa(t,e,n){t.multi.push(e),n&&t.componentProviders++}function Na(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function Da(t,e,n,r){return Ma(this.multi,[])}function Pa(t,e,n,r){const i=this.multi;let o;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=or(n,n[1],this.providerFactory.index,r);o=e.slice(0,t),Ma(i,o);for(let n=t;n<e.length;n++)o.push(e[n])}else o=[],Ma(i,o);return o}function Ma(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Fa(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=Je();if(r.firstCreatePass){const i=De(t);Aa(n,r.data,r.blueprint,i,!0),Aa(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}Ia.ngInherit=!0;class La{}class Ba{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${Et(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let ja=(()=>{class t{}return t.NULL=new Ba,t})(),Va=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>Ua(t),t})();const Ua=function(t){return Bo(t,tn(),Qe())};class za{}const Wa=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();let qa=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Ha(),t})();const Ha=function(){const t=Qe(),e=We(tn().index,t);return function(t){const e=t[11];if(Fe(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Te(e)?e:t)};let Ga=(()=>{class t{}return t.\u0275prov=pt({token:t,providedIn:"root",factory:()=>null}),t})();class $a{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Ka=new $a("9.0.7");class Xa{constructor(){}supports(t){return ps(t)}create(t){return new Qa(t)}}const Ya=(t,e)=>e;class Qa{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Ya}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<eu(n,r,i)?e:n,s=eu(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=s-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ps(t))throw new Error(`Error trying to diff '${Et(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&ds(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),ds(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[hs()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&ds(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),ds(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(ds(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(ds(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Ja(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new tu),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new tu),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Ja{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Za{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&ds(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class tu{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Za,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function eu(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class nu{constructor(){}supports(t){return t instanceof Map||ms(t)}create(){return new ru}}class ru{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||ms(t)))throw new Error(`Error trying to diff '${Et(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new iu(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){ds(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class iu{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let ou=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new lt,new ut]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=pt({token:t,providedIn:"root",factory:()=>new t([new Xa])}),t})(),su=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new lt,new ut]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=pt({token:t,providedIn:"root",factory:()=>new t([new nu])}),t})();const au=[new nu],uu=new ou([new Xa]),cu=new su(au);let lu=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>hu(t,Va),t})();const hu=function(t,e){return jo(t,e,tn(),Qe())};let du=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>fu(t,Va),t})();const fu=function(t,e){return Vo(t,e,tn(),Qe())},pu={};class mu extends ja{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Se(t);return new yu(e,this.ngModule)}}function gu(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const vu=new zt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>qn});class yu extends La{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(ci).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return gu(this.componentDef.inputs)}get outputs(){return gu(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,pu,i);return o!==pu||r===pu?o:e.get(n,r,i)}}}(t,r.injector):t,o=i.get(za,Le),s=i.get(Ga,null),a=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(Fe(t))return t.selectRootElement(e,n===fe.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(a,n,this.componentDef.encapsulation):_i(u,o.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),l=this.componentDef.onPush?576:528,h="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),d={components:[],scheduler:qn,clean:ro,playerHandler:null,flags:0},f=Ni(0,-1,null,1,0,null,null,null,null,null),p=xi(null,f,d,l,null,null,o,a,s,i);let m,g;mn(p,null);try{const t=function(t,e,n,r,i,o){const s=n[1];n[19]=t;const a=Ci(s,null,0,3,null,null),u=a.mergedAttrs=e.hostAttrs;null!==u&&(cs(a,u),null!==t&&(Dn(i,t,u),null!==a.classes&&No(i,t,a.classes),null!==a.styles&&Oo(i,t,a.styles)));const c=r.createRenderer(t,e),l=xi(n,Oi(e),null,e.onPush?64:16,n[19],a,r,c,void 0);return s.firstCreatePass&&(tr(Yn(a,n),s,e.type),Ui(s,a),Wi(a,n.length,1)),Ji(n,l),n[19]=l}(c,this.componentDef,p,o,a);if(c)if(n)Dn(a,c,["ng-version",Ka.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!ii(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&Dn(a,c,t),e&&e.length>0&&No(a,c,e.join(" "))}g=Ue(p[1],0),e&&(g.projection=e.map(t=>Array.from(t))),m=function(t,e,n,r,i){const o=n[1],s=function(t,e,n){const r=tn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Vi(t,r,1),qi(t,e,n));const i=or(e,t,e.length-1,r);Qr(i,e);const o=Ve(r,e);return o&&Qr(o,e),i}(o,n,e);r.components.push(s),t[8]=s,i&&i.forEach(t=>t(s,e)),e.contentQueries&&e.contentQueries(1,s,n.length-1);const a=tn();if(o.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){xn(a.index-19);const t=n[1];Li(t,e),Bi(t,n,e.hostVars),ji(e,s)}return s}(t,this.componentDef,p,d,[ba]),Ei(f,p,null)}finally{wn()}const v=new bu(this.componentType,m,Bo(Va,g,p),p,g);return n&&!h||(v.hostView._tViewNode.child=g),v}}class bu extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new Po(r),this.hostView._tViewNode=function(t,e,n,r){let i=t.node;return null==i&&(t.node=i=Di(0,null,2,-1,null,null)),r[6]=i}(r[1],0,0,r),this.componentType=t}get injector(){return new ur(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}var wu=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let _u={};function xu(t){return t in _u||(_u[t]=Pt.ng&&Pt.ng.common&&Pt.ng.common.locales&&Pt.ng.common.locales[t]),_u[t]}const Cu=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencyCode]="CurrencyCode",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}();let Eu="en-US";function Su(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(Eu=t.toLowerCase().replace(/_/g,"-"))}const Iu=new Map;class ku extends re{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new mu(this);const n=ke(t),r=t[jt]||null;r&&Su(r),this._bootstrapComponents=Gn(n.bootstrap),this._r3Injector=Yo(t,e,[{provide:re,useValue:this},{provide:ja,useValue:this.componentFactoryResolver}],Et(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=is.THROW_IF_NOT_FOUND,n=ht.Default){return t===is||t===re||t===Wt?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Tu extends ie{constructor(t){super(),this.moduleType=t,null!==ke(t)&&function t(e){if(null!==e.\u0275mod.id){const t=e.\u0275mod.id;(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${Et(e)} vs ${Et(e.name)}`)})(t,Iu.get(t),e),Iu.set(t,e)}let n=e.\u0275mod.imports;n instanceof Function&&(n=n()),n&&n.forEach(e=>t(e))}(t)}create(t){return new ku(this.moduleType,t)}}function Au(t,e,n){const r=an()+t,i=Qe();return i[r]===li?gs(i,r,n?e.call(n):e()):function(t,e){return t[e]}(i,r)}function Ru(t,e){const n=Je();let r;const i=t+19;n.firstCreatePass?(r=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}throw new Error(`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const o=r.factory||(r.factory=Ie(r.type)),s=Yt(xs),a=o();return Yt(s),function(t,e,n,r){const i=n+19;i>=t.data.length&&(t.data[i]=null,t.blueprint[i]=null),e[i]=r}(n,Qe(),t,a),a}function Ou(t,e,n){const r=Qe(),i=ze(r,t);return function(t,e){return fs.isWrapped(e)&&(e=fs.unwrap(e),t[un()]=li),e}(r,function(t,e){return t[1].data[e+19].pure}(r,t)?function(t,e,n,r,i,o){const s=e+n;return vs(t,s,i)?gs(t,s+1,o?r.call(o,i):r(i)):function(t,e){const n=t[e];return n===li?void 0:n}(t,s+1)}(r,an(),e,i.transform,n,i):i.transform(n))}class Nu extends T{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const s=super.subscribe(r,i,o);return t instanceof p&&t.add(s),s}}function Du(){return this._results[hs()]()}class Pu{constructor(){this.dirty=!0,this._results=[],this.changes=new Nu,this.length=0;const t=hs(),e=Pu.prototype;e[t]||(e[t]=Du)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Mu{constructor(t){this.queryList=t,this.matches=null}clone(){return new Mu(this.queryList)}setDirty(){this.queryList.setDirty()}}class Fu{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new Fu(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Zu(t,e).matches&&this.queries[e].setDirty()}}class Lu{constructor(t,e,n,r=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=r}}class Bu{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new Bu(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class ju{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new ju(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&4===n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){if(Array.isArray(this.metadata.predicate)){const n=this.metadata.predicate;for(let r=0;r<n.length;r++)this.matchTNodeWithReadOption(t,e,Vu(e,n[r]))}else{const n=this.metadata.predicate;n===lu?0===e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,ir(e,t,n,!1,!1))}}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Va||r===du||r===lu&&0===e.type)this.addMatch(e.index,-2);else{const n=ir(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Vu(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Uu(t,e,n,r){return-1===n?function(t,e){return 3===t.type||4===t.type?Bo(Va,t,e):0===t.type?jo(lu,Va,t,e):null}(e,t):-2===n?function(t,e,n){return n===Va?Bo(Va,e,t):n===lu?jo(lu,Va,e,t):n===du?Vo(du,Va,e,t):void 0}(t,e,r):or(t,t[1],n,e)}function zu(t,e,n,r){const i=e[5].queries[r];if(null===i.matches){const r=t.data,o=n.matches,s=[];for(let t=0;t<o.length;t+=2){const i=o[t];s.push(i<0?null:Uu(e,r[i],o[t+1],n.metadata.read))}i.matches=s}return i.matches}function Wu(t){const e=Qe(),n=Je(),r=dn();fn(r+1);const i=Zu(n,r);if(t.dirty&&He(e)===i.metadata.isStatic){if(null===i.matches)t.reset([]);else{const o=i.crossesNgTemplate?function t(e,n,r,i){const o=e.queries.getByIndex(r),s=o.matches;if(null!==s){const a=zu(e,n,o,r);for(let e=0;e<s.length;e+=2){const r=s[e];if(r>0)i.push(a[e/2]);else{const o=s[e+1],a=n[-r];for(let e=9;e<a.length;e++){const n=a[e];n[17]===n[3]&&t(n[1],n,o,i)}if(null!==a[5]){const e=a[5];for(let n=0;n<e.length;n++){const r=e[n];t(r[1],r,o,i)}}}}}return i}(n,e,r,[]):zu(n,e,i,r);t.reset(o),t.notifyOnChanges()}return!0}return!1}function qu(t,e,n){Gu(Je(),Qe(),t,e,n,!0)}function Hu(t,e,n){Gu(Je(),Qe(),t,e,n,!1)}function Gu(t,e,n,r,i,o){t.firstCreatePass&&(Ju(t,new Lu(n,r,o,i),-1),o&&(t.staticViewQueries=!0)),Qu(t,e)}function $u(t,e,n,r){Xu(Je(),Qe(),e,n,r,!1,tn(),t)}function Ku(t,e,n,r){Xu(Je(),Qe(),e,n,r,!0,tn(),t)}function Xu(t,e,n,r,i,o,s,a){t.firstCreatePass&&(Ju(t,new Lu(n,r,o,i),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(t.contentQueries.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,a),o&&(t.staticContentQueries=!0)),Qu(t,e)}function Yu(){return t=Qe(),e=dn(),t[5].queries[e].queryList;var t,e}function Qu(t,e){const n=new Pu;!function(t,e,n,r){const i=io(e);i.push(n),t.firstCreatePass&&oo(t).push(r,i.length-1)}(t,e,n,n.destroy),null===e[5]&&(e[5]=new Fu),e[5].queries.push(new Mu(n))}function Ju(t,e,n){null===t.queries&&(t.queries=new Bu),t.queries.track(new ju(e,n))}function Zu(t,e){return t.queries.getByIndex(e)}const tc=new zt("Application Initializer");let ec=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Ps(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Jt(tc,8))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const nc=new zt("AppId"),rc={provide:nc,useFactory:function(){return`${ic()}${ic()}${ic()}`},deps:[]};function ic(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const oc=new zt("Platform Initializer"),sc=new zt("Platform ID"),ac=new zt("appBootstrapListener");let uc=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const cc=new zt("LocaleId"),lc=new zt("DefaultCurrencyCode");class hc{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const dc=function(t){return new Tu(t)},fc=dc,pc=function(t){return Promise.resolve(dc(t))},mc=function(t){const e=dc(t),n=Gn(ke(t).declarations).reduce((t,e)=>{const n=Se(e);return n&&t.push(new yu(n)),t},[]);return new hc(e,n)},gc=mc,vc=function(t){return Promise.resolve(mc(t))};let yc=(()=>{class t{constructor(){this.compileModuleSync=fc,this.compileModuleAsync=pc,this.compileModuleAndAllComponentsSync=gc,this.compileModuleAndAllComponentsAsync=vc}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const bc=new zt("compilerOptions"),wc=(()=>Promise.resolve(0))();function _c(t){"undefined"==typeof Zone?wc.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class xc{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Nu(!1),this.onMicrotaskEmpty=new Nu(!1),this.onStable=new Nu(!1),this.onError=new Nu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=Pt.requestAnimationFrame,e=Pt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Pt,()=>{t.lastRequestAnimationFrameId=-1,Ic(t),Sc(t)}),Ic(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,i,o,s,a)=>{try{return kc(t),n.invokeTask(i,o,s,a)}finally{e&&"eventTask"===o.type&&e(),Tc(t)}},onInvoke:(e,n,r,i,o,s,a)=>{try{return kc(t),e.invoke(r,i,o,s,a)}finally{Tc(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,Ic(t),Sc(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!xc.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(xc.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,Ec,Cc,Cc);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function Cc(){}const Ec={};function Sc(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Ic(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function kc(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Tc(t){t._nesting--,Sc(t)}class Ac{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Nu,this.onMicrotaskEmpty=new Nu,this.onStable=new Nu,this.onError=new Nu}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let Rc=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{xc.assertNotInAngularZone(),_c(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())_c(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(Jt(xc))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),Oc=(()=>{class t{constructor(){this._applications=new Map,Pc.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return Pc.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class Nc{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Dc,Pc=new Nc,Mc=function(t,e,n){const r=new Tu(n);if(0===ss.size)return Promise.resolve(r);const i=function(t){const e=[];return t.forEach(t=>t&&e.push(...t)),e}(t.get(bc,[]).concat(e).map(t=>t.providers));if(0===i.length)return Promise.resolve(r);const o=function(){const t=Pt.ng;if(!t||!t.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return t.\u0275compilerFacade}(),s=is.create({providers:i}).get(o.ResourceLoader);return function(t){const e=[],n=new Map;function r(t){let e=n.get(t);if(!e){const r=(t=>Promise.resolve(s.get(t)))(t);n.set(t,e=r.then(us))}return e}return ss.forEach((t,n)=>{const i=[];t.templateUrl&&i.push(r(t.templateUrl).then(e=>{t.template=e}));const o=t.styleUrls,s=t.styles||(t.styles=[]),a=t.styles.length;o&&o.forEach((e,n)=>{s.push(""),i.push(r(e).then(r=>{s[a+n]=r,o.splice(o.indexOf(e),1),0==o.length&&(t.styleUrls=void 0)}))});const u=Promise.all(i).then(()=>function(t){as.delete(t)}(n));e.push(u)}),ss=new Map,Promise.all(e).then(()=>{})}().then(()=>r)};const Fc=new zt("AllowMultipleToken");class Lc{constructor(t,e){this.name=t,this.token=e}}function Bc(t,e,n=[]){const r=`Platform: ${e}`,i=new zt(r);return(e=[])=>{let o=jc();if(!o||o.injector.get(Fc,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:qo,useValue:"platform"});!function(t){if(Dc&&!Dc.destroyed&&!Dc.injector.get(Fc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Dc=t.get(Vc);const e=t.get(oc,null);e&&e.forEach(t=>t())}(is.create({providers:t,name:r}))}return function(t){const e=jc();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function jc(){return Dc&&!Dc.destroyed?Dc:null}let Vc=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Ac:("zone.js"===t?void 0:t)||new xc({enableLongStackTrace:Sr(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:xc,useValue:n}];return n.run(()=>{const e=is.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(fr,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>Wc(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const r=n();return Ps(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,n,()=>{const t=i.injector.get(ec);return t.runInitializers(),t.donePromise.then(()=>(Su(i.injector.get(cc,"en-US")||"en-US"),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=Uc({},e);return Mc(this.injector,n,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(zc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${Et(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Jt(is))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();function Uc(t,e){return Array.isArray(e)?e.reduce(Uc,t):Object.assign(Object.assign({},t),e)}let zc=(()=>{class t{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Sr(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new C(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new C(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{xc.assertNotInAngularZone(),_c(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{xc.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=Y(s,a.pipe(it()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof La?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(re),i=n.create(is.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(Rc,null);return o&&i.injector.get(Oc).registerApplication(i.location.nativeElement,o),this._loadComponent(i),Sr()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Wc(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(ac,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),Wc(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Jt(xc),Jt(uc),Jt(is),Jt(fr),Jt(ja),Jt(ec))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();function Wc(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class qc{}class Hc{}const Gc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let $c=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Gc}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>Kc(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>Kc(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(Jt(yc),Jt(Hc,8))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();function Kc(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const Xc=Bc(null,"core",[{provide:sc,useValue:"unknown"},{provide:Vc,deps:[is]},{provide:Oc,deps:[]},{provide:uc,deps:[]}]),Yc=[{provide:zc,useClass:zc,deps:[xc,uc,is,fr,ja,ec]},{provide:vu,deps:[xc],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:ec,useClass:ec,deps:[[new ut,tc]]},{provide:yc,useClass:yc,deps:[]},rc,{provide:ou,useFactory:function(){return uu},deps:[]},{provide:su,useFactory:function(){return cu},deps:[]},{provide:cc,useFactory:function(t){return Su(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new at(cc),new ut,new lt]]},{provide:lc,useValue:"USD"}];let Qc=(()=>{class t{constructor(t){}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(zc))},providers:Yc}),t})();const Jc={apiKey:"AIzaSyB9Ss4JFnY0t9bjJ_KkNZUw2Df3Wfu19Uk",authDomain:"liga-futbol-8e1e6.firebaseapp.com",databaseURL:"https://liga-futbol-8e1e6.firebaseio.com",projectId:"liga-futbol-8e1e6",storageBucket:"liga-futbol-8e1e6.appspot.com",messagingSenderId:"118665138994",appId:"1:118665138994:web:9d05325e343288e633bd2b"};let Zc=null;function tl(){return Zc}const el=new zt("DocumentToken");let nl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:rl,token:t,providedIn:"platform"}),t})();function rl(){return Jt(ol)}const il=new zt("Location Initialized");let ol=(()=>{class t extends nl{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=tl().getLocation(),this._history=tl().getHistory()}getBaseHrefFromDOM(){return tl().getBaseHref(this._doc)}onPopState(t){tl().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){tl().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){sl()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){sl()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({factory:al,token:t,providedIn:"platform"}),t})();function sl(){return!!window.history.pushState}function al(){return new ol(Jt(el))}function ul(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function cl(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function ll(t){return t&&"?"!==t[0]?"?"+t:t}let hl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:dl,token:t,providedIn:"root"}),t})();function dl(t){const e=Jt(el).location;return new pl(Jt(nl),e&&e.origin||"")}const fl=new zt("appBaseHref");let pl=(()=>{class t extends hl{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ul(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+ll(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+ll(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+ll(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Jt(nl),Jt(fl,8))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),ml=(()=>{class t extends hl{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=ul(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+ll(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+ll(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Jt(nl),Jt(fl,8))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),gl=(()=>{class t{constructor(t,e){this._subject=new Nu,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=cl(yl(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+ll(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,yl(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ll(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ll(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)})}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(Jt(hl),Jt(nl))},t.normalizeQueryParams=ll,t.joinWithSlash=ul,t.stripTrailingSlash=cl,t.\u0275prov=pt({factory:vl,token:t,providedIn:"root"}),t})();function vl(){return new gl(Jt(hl),Jt(nl))}function yl(t){return t.replace(/\/index.html$/,"")}const bl=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}();class wl{}let _l=(()=>{class t extends wl{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=xu(e);if(n)return n;const r=e.split("-")[0];if(n=xu(r),n)return n;if("en"===r)return wu;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Cu.PluralCase]}(e||this.locale)(t)){case bl.Zero:return"zero";case bl.One:return"one";case bl.Two:return"two";case bl.Few:return"few";case bl.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Jt(cc))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();function xl(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}let Cl=(()=>{class t{constructor(t,e,n,r){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(ps(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Et(t.item)}`);this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(xs(ou),xs(su),xs(Va),xs(qa))},t.\u0275dir=Ce({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class El{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Sl=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){Sr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. `+"See https://angular.io/api/common/NgForOf#change-propagation for more information."),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new El(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new Il(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new Il(t,i);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(lu),xs(ou))},t.\u0275dir=Ce({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Il{constructor(t,e){this.record=t,this.view=e}}let kl=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new Tl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Al("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Al("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(lu))},t.\u0275dir=Ce({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Tl{constructor(){this.$implicit=null,this.ngIf=null}}function Al(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Et(e)}'.`)}class Rl{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let Ol=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),Nl=(()=>{class t{constructor(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new Rl(t,e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(lu),xs(Ol,1))},t.\u0275dir=Ce({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),Dl=(()=>{class t{constructor(t,e,n){n._addDefault(new Rl(t,e))}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(lu),xs(Ol,1))},t.\u0275dir=Ce({type:t,selectors:[["","ngSwitchDefault",""]]}),t})();class Pl{createSubscription(t,e){return t.subscribe({next:e,error:t=>{throw t}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class Ml{createSubscription(t,e){return t.then(e,t=>{throw t})}dispose(t){}onDestroy(t){}}const Fl=new Ml,Ll=new Pl;let Bl=(()=>{class t{constructor(t){this._ref=t,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):ds(this._latestValue,this._latestReturnedValue)?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,fs.wrap(this._latestValue)):(t&&this._subscribe(t),this._latestReturnedValue=this._latestValue,this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,e=>this._updateLatestValue(t,e))}_selectStrategy(e){if(Ps(e))return Fl;if(Ms(e))return Ll;throw Error(`InvalidPipeArgument: '${e}' for pipe '${Et(t)}'`)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,e){t===this._obj&&(this._latestValue=e,this._ref.markForCheck())}}return t.\u0275fac=function(e){return new(e||t)(function(t=ht.Default){const e=Uo(!0);if(null!=e||t&ht.Optional)return e;throw new Error("No provider for ChangeDetectorRef!")}())},t.\u0275pipe=Ee({name:"async",type:t,pure:!1}),t})(),jl=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[{provide:wl,useClass:_l}]}),t})();function Vl(t){return"browser"===t}function Ul(t){return"server"===t}let zl=(()=>{class t{}return t.\u0275prov=pt({token:t,providedIn:"root",factory:()=>new Wl(Jt(el),window,Jt(fr))}),t})();class Wl{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector(`#${t}`);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}class ql extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new ql,Zc||(Zc=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=Gl||(Gl=document.querySelector("base"),Gl)?Gl.getAttribute("href"):null;return null==e?null:(n=e,Hl||(Hl=document.createElement("a")),Hl.setAttribute("href",n),"/"===Hl.pathname.charAt(0)?Hl.pathname:"/"+Hl.pathname);var n}resetBaseElement(){Gl=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return xl(document.cookie,t)}}let Hl,Gl=null;const $l=new zt("TRANSITION_ID"),Kl=[{provide:tc,useFactory:function(t,e,n){return()=>{n.get(ec).donePromise.then(()=>{const n=tl();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[$l,el,is],multi:!0}];class Xl{static init(){var t;t=new Xl,Pc=t}addToWindow(t){Pt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Pt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Pt.getAllAngularRootElements=()=>t.getAllRootElements(),Pt.frameworkStabilizers||(Pt.frameworkStabilizers=[]),Pt.frameworkStabilizers.push(t=>{const e=Pt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach((function(t){t.whenStable(i)}))})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?tl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const Yl=new zt("EventManagerPlugins");let Ql=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Yl),Jt(xc))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class Jl{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=tl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let Zl=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),th=(()=>{class t extends Zl{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>tl().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const eh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},nh=/%COMP%/g;function rh(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?rh(t,i,n):(i=i.replace(nh,t),n.push(i))}return n}function ih(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let oh=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new sh(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case fe.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new ah(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case fe.Native:case fe.ShadowDom:return new uh(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=rh(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Jt(Ql),Jt(th),Jt(nc))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class sh{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(eh[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=eh[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=eh[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&Wa.DashCase?t.style.setProperty(e,n,r&Wa.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Wa.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,ih(n)):this.eventManager.addEventListener(t,e,ih(n))}}class ah extends sh{constructor(t,e,n,r){super(t),this.component=n;const i=rh(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(nh,r+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(nh,t)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class uh extends sh{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===fe.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=rh(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let ch=(()=>{class t extends Jl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const lh=["alt","control","meta","shift"],hh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},dh={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},fh={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let ph=(()=>{class t extends Jl{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tl().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let o="";if(lh.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=o,s}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&dh.hasOwnProperty(e)&&(e=dh[e]))}return hh[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),lh.forEach(r=>{r!=n&&(0,fh[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),mh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return Jt(gh)},token:t,providedIn:"root"}),t})(),gh=(()=>{class t extends mh{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case $r.NONE:return e;case $r.HTML:return _r(e,"HTML")?wr(e):function(t,e){let n=null;try{Hr=Hr||new Ir(t);let r=e?String(e):"";n=Hr.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Hr.getInertBodyElement(r)}while(r!==o);const s=new Ur,a=s.sanitizeChildren(Gr(n)||n);return Sr()&&s.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),a}finally{if(n){const t=Gr(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e));case $r.STYLE:return _r(e,"Style")?wr(e):function(t){if(!(t=String(t).trim()))return"";const e=t.match(Xr);return e&&Ar(e[1])===e[1]||t.match(Kr)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(Sr()&&console.warn(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}(e);case $r.SCRIPT:if(_r(e,"Script"))return wr(e);throw new Error("unsafe value used in a script context");case $r.URL:return xr(e),_r(e,"URL")?wr(e):Ar(String(e));case $r.RESOURCE_URL:if(_r(e,"ResourceURL"))return wr(e);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return new mr(t)}bypassSecurityTrustStyle(t){return new gr(t)}bypassSecurityTrustScript(t){return new vr(t)}bypassSecurityTrustUrl(t){return new yr(t)}bypassSecurityTrustResourceUrl(t){return new br(t)}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({factory:function(){return t=Jt(Wt),new gh(t.get(el));var t},token:t,providedIn:"root"}),t})();const vh=Bc(Xc,"browser",[{provide:sc,useValue:"browser"},{provide:oc,useValue:function(){ql.makeCurrent(),Xl.init()},multi:!0},{provide:el,useFactory:function(){return function(t){Me=t}(document),document},deps:[]}]),yh=[[],{provide:qo,useValue:"root"},{provide:fr,useFactory:function(){return new fr},deps:[]},{provide:Yl,useClass:ch,multi:!0,deps:[el,xc,sc]},{provide:Yl,useClass:ph,multi:!0,deps:[el]},[],{provide:oh,useClass:oh,deps:[Ql,th,nc]},{provide:za,useExisting:oh},{provide:Zl,useExisting:th},{provide:th,useClass:th,deps:[el]},{provide:Rc,useClass:Rc,deps:[xc]},{provide:Ql,useClass:Ql,deps:[Yl,xc]},[]];let bh=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:nc,useValue:e.appId},{provide:$l,useExisting:nc},Kl]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(t,12))},providers:yh,imports:[jl,Qc]}),t})();function wh(...t){if(1===t.length){const e=t[0];if(h(e))return _h(e,null);if(d(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return _h(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return _h(t=1===t.length&&h(t[0])?t[0]:t,null).pipe(V(t=>e(...t)))}return _h(t,null)}function _h(t,e){return new C(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,s=0;for(let a=0;a<r;a++){const u=q(t[a]);let c=!1;n.add(u.subscribe({next:t=>{c||(c=!0,s++),i[a]=t},error:t=>n.error(t),complete:()=>{o++,o!==r&&c||(s===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}"undefined"!=typeof window&&window;const xh=new zt("NgValueAccessor"),Ch={provide:xh,useExisting:kt(()=>Eh),multi:!0};let Eh=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[Fa([Ch])]}),t})();const Sh={provide:xh,useExisting:kt(()=>kh),multi:!0},Ih=new zt("CompositionEventMode");let kh=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=tl()?tl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va),xs(Ih,8))},t.\u0275dir=Ce({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&Fs("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[Fa([Sh])]}),t})(),Th=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t}),t})(),Ah=(()=>{class t extends Th{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Rh(e||t)},t.\u0275dir=Ce({type:t,features:[wa]}),t})();const Rh=cr(Ah);function Oh(){throw new Error("unimplemented")}class Nh extends Th{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Oh()}get asyncValidator(){return Oh()}}class Dh{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let Ph=(()=>{class t extends Dh{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(Nh,2))},t.\u0275dir=Ce({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&ea("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[wa]}),t})(),Mh=(()=>{class t extends Dh{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,2))},t.\u0275dir=Ce({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&ea("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[wa]}),t})();function Fh(t){return null==t||0===t.length}const Lh=new zt("NgValidators"),Bh=new zt("NgAsyncValidators"),jh=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Vh{static min(t){return e=>{if(Fh(e.value)||Fh(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Fh(e.value)||Fh(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Fh(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Fh(t.value)?null:jh.test(t.value)?null:{email:!0}}static minLength(t){return e=>{if(Fh(e.value))return null;const n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}static maxLength(t){return e=>{const n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}static pattern(t){if(!t)return Vh.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Fh(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(Uh);return 0==e.length?null:function(t){return Wh(function(t,e){return e.map(e=>e(t))}(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(Uh);return 0==e.length?null:function(t){return wh(function(t,e){return e.map(e=>e(t))}(t,e).map(zh)).pipe(V(Wh))}}}function Uh(t){return null!=t}function zh(t){const e=Ps(t)?q(t):t;if(!Ms(e))throw new Error("Expected validator to return Promise or Observable.");return e}function Wh(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function qh(t){return t.validate?e=>t.validate(e):t}function Hh(t){return t.validate?e=>t.validate(e):t}const Gh={provide:xh,useExisting:kt(()=>$h),multi:!0};let $h=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Fa([Gh])]}),t})();const Kh={provide:xh,useExisting:kt(()=>Yh),multi:!0};let Xh=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),Yh=(()=>{class t{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Nh),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va),xs(Xh),xs(is))},t.\u0275dir=Ce({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Fa([Kh])]}),t})();const Qh={provide:xh,useExisting:kt(()=>Jh),multi:!0};let Jh=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Fa([Qh])]}),t})();const Zh='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',td='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',ed='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>';class nd{static controlParentException(){throw new Error(`formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${Zh}`)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${td}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ${ed}`)}static missingFormException(){throw new Error(`formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ${Zh}`)}static groupParentException(){throw new Error(`formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${td}`)}static arrayParentException(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}static ngModelWarning(t){console.warn(`\n    It looks like you're using ngModel on the same form field as ${t}. \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/${"formControl"===t?"FormControlDirective":"FormControlName"}#use-with-ngmodel\n    `)}}const rd={provide:xh,useExisting:kt(()=>id),multi:!0};let id=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=ds}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Fa([rd])]}),t})();const od={provide:xh,useExisting:kt(()=>sd),multi:!0};let sd=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=ds}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(e.hasOwnProperty("selectedOptions")){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(xs(qa),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&Fs("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Fa([od])]}),t})();function ad(t,e){return[...e.path,t]}function ud(t,e){t||dd(e,"Cannot find control with"),e.valueAccessor||dd(e,"No value accessor for form control with"),t.validator=Vh.compose([t.validator,e.validator]),t.asyncValidator=Vh.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&cd(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&cd(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function cd(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function ld(t,e){null==t&&dd(e,"Cannot find control with"),t.validator=Vh.compose([t.validator,e.validator]),t.asyncValidator=Vh.composeAsync([t.asyncValidator,e.asyncValidator])}function hd(t){return dd(t,"There is no FormControl instance attached to form control element with")}function dd(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function fd(t){return null!=t?Vh.compose(t.map(qh)):null}function pd(t){return null!=t?Vh.composeAsync(t.map(Hh)):null}function md(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!ds(e,n.currentValue)}const gd=[Eh,Jh,$h,id,sd,Yh];function vd(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function yd(t,e){if(!e)return null;Array.isArray(e)||dd(t,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{var o;e.constructor===kh?n=e:(o=e,gd.some(t=>o.constructor===t)?(r&&dd(t,"More than one built-in value accessor matches form control with"),r=e):(i&&dd(t,"More than one custom value accessor matches form control with"),i=e))}),i||r||n||(dd(t,"No valid value accessor for form control with"),null)}function bd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function wd(t){const e=xd(t)?t.validators:t;return Array.isArray(e)?fd(e):e||null}function _d(t,e){const n=xd(e)?e.asyncValidators:t;return Array.isArray(n)?pd(n):n||null}function xd(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Cd{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=wd(t)}setAsyncValidators(t){this.asyncValidator=_d(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING";const e=zh(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof Sd?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof Id&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Nu,this.statusChanges=new Nu}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){xd(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class Ed extends Cd{constructor(t=null,e,n){super(wd(e),_d(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Sd extends Cd{constructor(t,e,n){super(wd(e),_d(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof Ed?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){let e=!1;return this._forEachChild((n,r)=>{e=e||this.contains(r)&&t(n)}),e}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class Id extends Cd{constructor(t,e,n){super(wd(e),_d(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Ed?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const kd={provide:Ah,useExisting:kt(()=>Ad)},Td=(()=>Promise.resolve(null))();let Ad=(()=>{class t extends Ah{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Nu,this.form=new Sd({},fd(t),pd(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Td.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),ud(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Td.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),bd(this._directives,t)})}addFormGroup(t){Td.then(()=>{const e=this._findContainer(t.path),n=new Sd({});ld(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Td.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){Td.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,vd(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(xs(Lh,10),xs(Bh,10))},t.\u0275dir=Ce({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&Fs("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fa([kd]),wa]}),t})(),Rd=(()=>{class t extends Ah{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return ad(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return fd(this._validators)}get asyncValidator(){return pd(this._asyncValidators)}_checkParentType(){}}return t.\u0275fac=function(e){return Od(e||t)},t.\u0275dir=Ce({type:t,features:[wa]}),t})();const Od=cr(Rd);class Nd{static modelParentException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup's partner directive "formControlName" instead.  Example:\n\n      ${Zh}\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  `)}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${td}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${ed}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${td}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${ed}`)}}const Dd={provide:Ah,useExisting:kt(()=>Pd)};let Pd=(()=>{class t extends Rd{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){this._parent instanceof t||this._parent instanceof Ad||Nd.modelGroupParentException()}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,5),xs(Lh,10),xs(Bh,10))},t.\u0275dir=Ce({type:t,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[Fa([Dd]),wa]}),t})();const Md={provide:Nh,useExisting:kt(()=>Ld)},Fd=(()=>Promise.resolve(null))();let Ld=(()=>{class t extends Nh{constructor(t,e,n,r){super(),this.control=new Ed,this._registered=!1,this.update=new Nu,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=yd(this,r)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),md(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?ad(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return fd(this._rawValidators)}get asyncValidator(){return pd(this._rawAsyncValidators)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ud(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof Pd)&&this._parent instanceof Rd?Nd.formGroupNameException():this._parent instanceof Pd||this._parent instanceof Ad||Nd.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Nd.missingNameException()}_updateValue(t){Fd.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;Fd.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,9),xs(Lh,10),xs(Bh,10),xs(xh,10))},t.\u0275dir=Ce({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fa([Md]),wa,Ia]}),t})(),Bd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const jd=new zt("NgModelWithFormControlWarning"),Vd={provide:Ah,useExisting:kt(()=>Ud)};let Ud=(()=>{class t extends Ah{constructor(t,e){super(),this._validators=t,this._asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new Nu}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return ud(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){bd(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);ld(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);ld(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,vd(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){e.valueAccessor.registerOnChange(()=>hd(e)),e.valueAccessor.registerOnTouched(()=>hd(e)),e._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),e._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),t&&t._clearChangeFns()}(t.control,t),e&&ud(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const t=fd(this._validators);this.form.validator=Vh.compose([this.form.validator,t]);const e=pd(this._asyncValidators);this.form.asyncValidator=Vh.composeAsync([this.form.asyncValidator,e])}_checkFormPresent(){this.form||nd.missingFormException()}}return t.\u0275fac=function(e){return new(e||t)(xs(Lh,10),xs(Bh,10))},t.\u0275dir=Ce({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&Fs("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fa([Vd]),wa,Ia]}),t})();const zd={provide:Ah,useExisting:kt(()=>Wd)};let Wd=(()=>{class t extends Rd{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){Gd(this._parent)&&nd.groupParentException()}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,13),xs(Lh,10),xs(Bh,10))},t.\u0275dir=Ce({type:t,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[Fa([zd]),wa]}),t})();const qd={provide:Ah,useExisting:kt(()=>Hd)};let Hd=(()=>{class t extends Ah{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return ad(null==this.name?this.name:this.name.toString(),this._parent)}get validator(){return fd(this._validators)}get asyncValidator(){return pd(this._asyncValidators)}_checkParentType(){Gd(this._parent)&&nd.arrayParentException()}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,13),xs(Lh,10),xs(Bh,10))},t.\u0275dir=Ce({type:t,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[Fa([qd]),wa]}),t})();function Gd(t){return!(t instanceof Wd||t instanceof Ud||t instanceof Hd)}const $d={provide:Nh,useExisting:kt(()=>Kd)};let Kd=(()=>{class t extends Nh{constructor(t,e,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new Nu,this._ngModelWarningSent=!1,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=yd(this,r)}set isDisabled(t){nd.disabledAttrWarning()}ngOnChanges(e){this._added||this._setUpControl(),md(e,this.viewModel)&&(function(t,e,n,r){Sr()&&"never"!==r&&((null!==r&&"once"!==r||e._ngModelWarningSentOnce)&&("always"!==r||n._ngModelWarningSent)||(nd.ngModelWarning("formControlName"),e._ngModelWarningSentOnce=!0,n._ngModelWarningSent=!0))}(0,t,this,this._ngModelWarningConfig),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return ad(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return fd(this._rawValidators)}get asyncValidator(){return pd(this._rawAsyncValidators)}_checkParentType(){!(this._parent instanceof Wd)&&this._parent instanceof Rd?nd.ngModelGroupException():this._parent instanceof Wd||this._parent instanceof Ud||this._parent instanceof Hd||nd.controlParentException()}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(xs(Ah,13),xs(Lh,10),xs(Bh,10),xs(xh,10),xs(jd,8))},t.\u0275dir=Ce({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Fa([$d]),wa,Ia]}),t._ngModelWarningSentOnce=!1,t})(),Xd=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})(),Yd=(()=>{class t{group(t,e=null){const n=this._reduceControls(t);let r=null,i=null,o=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,o=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new Sd(n,{asyncValidators:i,updateOn:o,validators:r})}control(t,e,n){return new Ed(t,e,n)}array(t,e,n){const r=t.map(t=>this._createControl(t));return new Id(r,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof Ed||t instanceof Sd||t instanceof Id?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),Qd=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Xh],imports:[Xd]}),t})(),Jd=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:jd,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Yd,Xh],imports:[Xd]}),t})();function Zd(...t){let e=t[t.length-1];return R(e)?(t.pop(),W(t,e)):X(t)}class tf extends T{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new S;return this._value}next(t){super.next(this._value=t)}}const ef=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),nf={};function rf(...t){let e=null,n=null;return R(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&h(t[0])&&(t=t[0]),X(t,n).lift(new of(e))}class of{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new sf(t,this.resultSelector))}}class sf extends j{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(nf),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(B(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const o=this.values,s=this.toRespond?o[n]===nf?--this.toRespond:this.toRespond:0;o[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const af=new C(t=>t.complete());function uf(t){return t?function(t){return new C(e=>t.schedule(()=>e.complete()))}(t):af}function cf(t){return new C(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?q(n):uf()).subscribe(e)})}function lf(){return K(1)}function hf(t,e){return function(n){return n.lift(new df(t,e))}}class df{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new ff(t,this.predicate,this.thisArg))}}class ff extends v{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}const pf=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function mf(t){return function(e){return 0===t?uf():e.lift(new gf(t))}}class gf{constructor(t){if(this.total=t,this.total<0)throw new pf}call(t,e){return e.subscribe(new vf(t,this.total))}}class vf extends v{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function yf(t=_f){return e=>e.lift(new bf(t))}class bf{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new wf(t,this.errorFactory))}}class wf extends v{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function _f(){return new ef}function xf(t=null){return e=>e.lift(new Cf(t))}class Cf{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Ef(t,this.defaultValue))}}class Ef extends v{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Sf(t,e){const n=arguments.length>=2;return r=>r.pipe(t?hf((e,n)=>t(e,n,r)):w,mf(1),n?xf(e):yf(()=>new ef))}function If(t){return function(e){const n=new kf(t),r=e.lift(n);return n.caught=r}}class kf{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Tf(t,this.selector,this.caught))}}class Tf extends j{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new O(this,void 0,void 0);this.add(r);const i=B(this,n,void 0,void 0,r);i!==r&&this.add(i)}}}function Af(t){return e=>0===t?uf():e.lift(new Rf(t))}class Rf{constructor(t){if(this.total=t,this.total<0)throw new pf}call(t,e){return e.subscribe(new Of(t,this.total))}}class Of extends v{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function Nf(t,e){const n=arguments.length>=2;return r=>r.pipe(t?hf((e,n)=>t(e,n,r)):w,Af(1),n?xf(e):yf(()=>new ef))}class Df{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new Pf(t,this.predicate,this.thisArg,this.source))}}class Pf extends v{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function Mf(t,e){return"function"==typeof e?n=>n.pipe(Mf((n,r)=>q(t(n,r)).pipe(V((t,i)=>e(n,t,r,i))))):e=>e.lift(new Ff(t))}class Ff{constructor(t){this.project=t}call(t,e){return e.subscribe(new Lf(t,this.project))}}class Lf extends j{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new O(this,e,n),o=this.destination;o.add(i),this.innerSubscription=B(this,t,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function Bf(...t){return lf()(Zd(...t))}function jf(...t){const e=t[t.length-1];return R(e)?(t.pop(),n=>Bf(t,n,e)):e=>Bf(t,e)}function Vf(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Uf(t,e,n))}}class Uf{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new zf(t,this.accumulator,this.seed,this.hasSeed))}}class zf extends v{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function Wf(t,e){return H(t,e,1)}function qf(){}function Hf(t,e,n){return function(r){return r.lift(new Gf(t,e,n))}}class Gf{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new $f(t,this.nextOrObserver,this.error,this.complete))}}class $f extends v{constructor(t,e,n,r){super(t),this._tapNext=qf,this._tapError=qf,this._tapComplete=qf,this._tapError=n||qf,this._tapComplete=r||qf,s(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||qf,this._tapError=e.error||qf,this._tapComplete=e.complete||qf)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}function Kf(t){return e=>e.lift(new Xf(t))}class Xf{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Yf(t,this.callback))}}class Yf extends v{constructor(t,e){super(t),this.add(new p(e))}}class Qf{constructor(t,e){this.id=t,this.url=e}}class Jf extends Qf{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Zf extends Qf{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class tp extends Qf{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ep extends Qf{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class np extends Qf{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rp extends Qf{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ip extends Qf{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class op extends Qf{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sp extends Qf{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ap{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class up{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class cp{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lp{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hp{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dp{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class fp{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let pp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&As(0,"router-outlet")},directives:function(){return[mg]},encapsulation:2}),t})();class mp{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function gp(t){return new mp(t)}function vp(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function yp(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class bp{constructor(t,e){this.routes=t,this.module=e}}function wp(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];_p(r,xp(e,r))}}function _p(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&wp(t.children,e)}function xp(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Cp(t){const e=t.children&&t.children.map(Cp),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=pp),n}function Ep(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!Sp(t[i],e[i]))return!1;return!0}function Sp(t,e){return Array.isArray(t)&&Array.isArray(e)?t.length==e.length&&t.every(t=>e.indexOf(t)>-1):t===e}function Ip(t){return Array.prototype.concat.apply([],t)}function kp(t){return t.length>0?t[t.length-1]:null}function Tp(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Ap(t){return Ms(t)?t:Ps(t)?q(Promise.resolve(t)):Zd(t)}function Rp(t,e,n){return n?function(t,e){return Ep(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!Pp(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>Sp(t[n],e[n]))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!Pp(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Pp(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!Pp(n.segments,t)&&!!n.children.primary&&e(n.children.primary,r,o)}}(e,n,n.segments)}(t.root,e.root)}class Op{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gp(this.queryParams)),this._queryParamMap}toString(){return Bp.serialize(this)}}class Np{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Tp(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jp(this)}}class Dp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=gp(this.parameters)),this._parameterMap}toString(){return Hp(this)}}function Pp(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function Mp(t,e){let n=[];return Tp(t.children,(t,r)=>{"primary"===r&&(n=n.concat(e(t,r)))}),Tp(t.children,(t,r)=>{"primary"!==r&&(n=n.concat(e(t,r)))}),n}class Fp{}class Lp{parse(t){const e=new Yp(t);return new Op(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`${`/${function t(e,n){if(!e.hasChildren())return jp(e);if(n){const n=e.children.primary?t(e.children.primary,!1):"",r=[];return Tp(e.children,(e,n)=>{"primary"!==n&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=Mp(e,(n,r)=>"primary"===r?[t(e.children.primary,!1)]:[`${r}:${t(n,!1)}`]);return`${jp(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Up(e)}=${Up(t)}`).join("&"):`${Up(e)}=${Up(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Bp=new Lp;function jp(t){return t.segments.map(t=>Hp(t)).join("/")}function Vp(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Up(t){return Vp(t).replace(/%3B/gi,";")}function zp(t){return Vp(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wp(t){return decodeURIComponent(t)}function qp(t){return Wp(t.replace(/\+/g,"%20"))}function Hp(t){return`${zp(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${zp(t)}=${zp(e[t])}`).join("")}`;var e}const Gp=/^[^\/()?;=#]+/;function $p(t){const e=t.match(Gp);return e?e[0]:""}const Kp=/^[^=?&#]+/,Xp=/^[^?&#]+/;class Yp{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Np([],{}):new Np([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Np(t,e)),n}parseSegment(){const t=$p(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Dp(Wp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=$p(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=$p(this.remaining);t&&(n=t,this.capture(n))}t[Wp(e)]=Wp(n)}parseQueryParam(t){const e=function(t){const e=t.match(Kp);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Xp);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=qp(e),i=qp(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=$p(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");const o=this.parseChildren();e[i]=1===Object.keys(o).length?o.primary:new Np([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Qp{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Jp(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Jp(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Zp(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Zp(t,this._root).map(t=>t.value)}}function Jp(t,e){if(t===e.value)return e;for(const n of e.children){const e=Jp(t,n);if(e)return e}return null}function Zp(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Zp(t,n);if(r.length)return r.unshift(e),r}return[]}class tm{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function em(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class nm extends Qp{constructor(t,e){super(t),this.snapshot=e,um(this,t)}toString(){return this.snapshot.toString()}}function rm(t,e){const n=function(t,e){const n=new sm([],{},{},"",{},"primary",e,null,t.root,-1,{});return new am("",new tm(n,[]))}(t,e),r=new tf([new Dp("",{})]),i=new tf({}),o=new tf({}),s=new tf({}),a=new tf(""),u=new im(r,i,s,a,o,"primary",e,n.root);return u.snapshot=n.root,new nm(new tm(u,[]),n)}class im{constructor(t,e,n,r,i,o,s,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(V(t=>gp(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(V(t=>gp(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function om(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class sm{constructor(t,e,n,r,i,o,s,a,u,c,l){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=u,this._lastPathIndex=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=gp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class am extends Qp{constructor(t,e){super(e),this.url=t,um(this,e)}toString(){return cm(this._root)}}function um(t,e){e.value._routerState=t,e.children.forEach(e=>um(t,e))}function cm(t){const e=t.children.length>0?` { ${t.children.map(cm).join(", ")} } `:"";return`${t.value}${e}`}function lm(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Ep(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Ep(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Ep(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Ep(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function hm(t,e){return Ep(t.params,e.params)&&function(t,e){return Pp(t,e)&&t.every((t,n)=>Ep(t.parameters,e[n].parameters))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||hm(t.parent,e.parent))}function dm(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function fm(t,e,n,r,i){let o={};return r&&Tp(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Op(n.root===t?e:function t(e,n,r){const i={};return Tp(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new Np(e.segments,i)}(n.root,t,e),o,i)}class pm{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&dm(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==kp(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class mm{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function gm(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:`${t}`}function vm(t,e,n){if(t||(t=new Np([],{})),0===t.segments.length&&t.hasChildren())return ym(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],s=gm(n[r]),a=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&a&&"object"==typeof a&&void 0===a.outlets){if(!xm(s,a,e))return o;r+=2}else{if(!xm(s,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new Np(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new Np(t.segments.slice(r.pathIndex),t.children),ym(e,0,i)}return r.match&&0===i.length?new Np(t.segments,{}):r.match&&!t.hasChildren()?bm(t,e,n):r.match?ym(t,0,i):bm(t,e,n)}function ym(t,e,n){if(0===n.length)return new Np(t.segments,{});{const r=function(t){return"object"!=typeof t[0]?{primary:t}:void 0===t[0].outlets?{primary:t}:t[0].outlets}(n),i={};return Tp(r,(n,r)=>{null!==n&&(i[r]=vm(t.children[r],e,n))}),Tp(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new Np(t.segments,i)}}function bm(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=wm(n[i].outlets);return new Np(r,t)}if(0===i&&dm(n[0])){r.push(new Dp(t.segments[e].path,n[0])),i++;continue}const o=gm(n[i]),s=i<n.length-1?n[i+1]:null;o&&s&&dm(s)?(r.push(new Dp(o,_m(s))),i+=2):(r.push(new Dp(o,{})),i++)}return new Np(r,{})}function wm(t){const e={};return Tp(t,(t,n)=>{null!==t&&(e[n]=bm(new Np([],{}),0,t))}),e}function _m(t){const e={};return Tp(t,(t,n)=>e[n]=`${t}`),e}function xm(t,e,n){return t==n.path&&Ep(e,n.parameters)}class Cm{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),lm(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=em(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),Tp(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=em(t),i=t.value.component?n.children:e;Tp(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=em(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new dp(t.value.snapshot))}),t.children.length&&this.forwardEvent(new lp(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(lm(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Em(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Em(t){lm(t.value),t.children.forEach(Em)}function Sm(t){return"function"==typeof t}function Im(t){return t instanceof Op}class km{constructor(t){this.segmentGroup=t||null}}class Tm{constructor(t){this.urlTree=t}}function Am(t){return new C(e=>e.error(new km(t)))}function Rm(t){return new C(e=>e.error(new Tm(t)))}function Om(t){return new C(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Nm{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(re)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(V(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(If(t=>{if(t instanceof Tm)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof km)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(V(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(If(t=>{if(t instanceof km)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new Np([],{primary:t}):t;return new Op(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(V(t=>new Np([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Zd({});const n=[],r=[],i={};return Tp(t,(t,o)=>{const s=e(o,t).pipe(V(t=>i[o]=t));"primary"===o?n.push(s):r.push(s)}),Zd.apply(null,n.concat(r)).pipe(lf(),Sf(),V(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){return Zd(...n).pipe(V(s=>this.expandSegmentAgainstRoute(t,e,n,s,r,i,o).pipe(If(t=>{if(t instanceof km)return Zd(null);throw t}))),lf(),Nf(t=>!!t),If((t,n)=>{if(t instanceof ef||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Zd(new Np([],{}));throw new km(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,s){return Fm(r)!==o?Am(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Am(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Rm(i):this.lineralizeSegments(n,i).pipe(H(n=>{const i=new Np(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:s,consumedSegments:a,lastChild:u,positionalParamSegments:c}=Dm(e,r,i);if(!s)return Am(e);const l=this.applyRedirectCommands(a,r.redirectTo,c);return r.redirectTo.startsWith("/")?Rm(l):this.lineralizeSegments(r,l).pipe(H(r=>this.expandSegment(t,e,n,r.concat(i.slice(u)),o,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(V(t=>(n._loadedConfig=t,new Np(r,{})))):Zd(new Np(r,{}));const{matched:i,consumedSegments:o,lastChild:s}=Dm(e,n,r);if(!i)return Am(e);const a=r.slice(s);return this.getChildConfig(t,n,r).pipe(H(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:s}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>Mm(t,e,n)&&"primary"!==Fm(n))}(t,n,r)?{segmentGroup:Pm(new Np(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&"primary"!==Fm(r)&&(n[Fm(r)]=new Np([],{}));return n}(r,new Np(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>Mm(t,e,n))}(t,n,r)?{segmentGroup:Pm(new Np(t.segments,function(t,e,n,r){const i={};for(const o of n)Mm(t,e,o)&&!r[Fm(o)]&&(i[Fm(o)]=new Np([],{}));return Object.assign(Object.assign({},r),i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,a,r);return 0===s.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(V(t=>new Np(o,t))):0===r.length&&0===s.length?Zd(new Np(o,{})):this.expandSegment(n,i,r,s,"primary",!0).pipe(V(t=>new Np(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Zd(new bp(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Zd(e._loadedConfig):function(t,e,n){const r=e.canLoad;return r&&0!==r.length?q(r).pipe(V(r=>{const i=t.get(r);let o;if(function(t){return t&&Sm(t.canLoad)}(i))o=i.canLoad(e,n);else{if(!Sm(i))throw new Error("Invalid CanLoad guard");o=i(e,n)}return Ap(o)})).pipe(lf(),(i=t=>!0===t,t=>t.lift(new Df(i,void 0,t)))):Zd(!0);var i}(t.injector,e,n).pipe(H(n=>n?this.configLoader.load(t.injector,e).pipe(V(t=>(e._loadedConfig=t,t))):function(t){return new C(e=>e.error(vp(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Zd(new bp([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Zd(n);if(r.numberOfChildren>1||!r.children.primary)return Om(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new Op(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Tp(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return Tp(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new Np(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function Dm(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||yp)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Pm(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new Np(t.segments.concat(e.segments),e.children)}return t}function Mm(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Fm(t){return t.outlet||"primary"}class Lm{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Bm{constructor(t,e){this.component=t,this.route=e}}function jm(t,e,n){const r=t._root;return function t(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=em(n);return e.children.forEach(e=>{!function(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,a=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const c=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Pp(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Pp(t.url,e.url)||!Ep(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hm(t,e)||!Ep(t.queryParams,e.queryParams);case"paramsChange":default:return!hm(t,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new Lm(i)):(s.data=a.data,s._resolvedData=a._resolvedData),t(e,n,s.component?u?u.children:null:r,i,o),c&&o.canDeactivateChecks.push(new Bm(u&&u.outlet&&u.outlet.component||null,a))}else a&&Um(n,u,o),o.canActivateChecks.push(new Lm(i)),t(e,null,s.component?u?u.children:null:r,i,o)}(e,s[e.value.outlet],r,i.concat([e.value]),o),delete s[e.value.outlet]}),Tp(s,(t,e)=>Um(t,r.getContext(e),o)),o}(r,e?e._root:null,n,[r.value])}function Vm(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Um(t,e,n){const r=em(t),i=t.value;Tp(r,(t,r)=>{Um(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new Bm(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const zm=Symbol("INITIAL_VALUE");function Wm(){return Mf(t=>rf(...t.map(t=>t.pipe(Af(1),jf(zm)))).pipe(Vf((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==zm)return t;if(r===zm&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Im(r))return r}return t},t)},zm),hf(t=>t!==zm),V(t=>Im(t)?t:!0===t),Af(1)))}function qm(t,e){return null!==t&&e&&e(new hp(t)),Zd(!0)}function Hm(t,e){return null!==t&&e&&e(new cp(t)),Zd(!0)}function Gm(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Zd(r.map(r=>cf(()=>{const i=Vm(r,e,n);let o;if(function(t){return t&&Sm(t.canActivate)}(i))o=Ap(i.canActivate(e,t));else{if(!Sm(i))throw new Error("Invalid CanActivate guard");o=Ap(i(e,t))}return o.pipe(Nf())}))).pipe(Wm()):Zd(!0)}function $m(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>cf(()=>Zd(e.guards.map(i=>{const o=Vm(i,e.node,n);let s;if(function(t){return t&&Sm(t.canActivateChild)}(o))s=Ap(o.canActivateChild(r,t));else{if(!Sm(o))throw new Error("Invalid CanActivateChild guard");s=Ap(o(r,t))}return s.pipe(Nf())})).pipe(Wm())));return Zd(i).pipe(Wm())}class Km{}class Xm{constructor(t,e,n,r,i,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){try{const t=Jm(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new sm([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new tm(n,e),i=new am(this.url,r);return this.inheritParamsAndData(i._root),Zd(i)}catch(t){return new C(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=om(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=Mp(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const o of t)try{return this.processSegmentAgainstRoute(o,e,n,r)}catch(i){if(!(i instanceof Km))throw i}if(this.noLeftoversInUrl(e,n,r))return[];throw new Km}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new Km;if((t.outlet||"primary")!==r)throw new Km;let i,o=[],s=[];if("**"===t.path){const o=n.length>0?kp(n).parameters:{};i=new sm(n,o,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eg(t),r,t.component,t,Ym(e),Qm(e)+n.length,ng(t))}else{const a=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new Km;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||yp)(n,t,e);if(!r)throw new Km;const i={};Tp(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},i),r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=a.consumedSegments,s=n.slice(a.lastChild),i=new sm(o,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eg(t),r,t.component,t,Ym(e),Qm(e)+o.length,ng(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:c}=Jm(e,o,s,a,this.relativeLinkResolution);if(0===c.length&&u.hasChildren()){const t=this.processChildren(a,u);return[new tm(i,t)]}if(0===a.length&&0===c.length)return[new tm(i,[])];const l=this.processSegment(a,u,c,"primary");return[new tm(i,l)]}}function Ym(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Qm(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function Jm(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some(n=>Zm(t,e,n)&&"primary"!==tg(n))}(t,n,r)){const i=new Np(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&"primary"!==tg(o)){const n=new Np([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[tg(o)]=n}return i}(t,e,r,new Np(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Zm(t,e,n))}(t,n,r)){const o=new Np(t.segments,function(t,e,n,r,i,o){const s={};for(const a of r)if(Zm(t,n,a)&&!i[tg(a)]){const n=new Np([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[tg(a)]=n}return Object.assign(Object.assign({},i),s)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new Np(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function Zm(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function tg(t){return t.outlet||"primary"}function eg(t){return t.data||{}}function ng(t){return t.resolve||{}}function rg(t,e,n,r){const i=Vm(t,e,r);return Ap(i.resolve?i.resolve(e,n):i(e,n))}function ig(t){return function(e){return e.pipe(Mf(e=>{const n=t(e);return n?q(n).pipe(V(()=>e)):q([e])}))}}class og{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const sg=new zt("ROUTES");class ag{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(V(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new bp(Ip(r.injector.get(sg)).map(Cp),r)}))}loadModuleFactory(t){return"string"==typeof t?q(this.loader.load(t)):Ap(t()).pipe(H(t=>t instanceof ie?Zd(t):q(this.compiler.compileModuleAsync(t))))}}class ug{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function cg(t){throw t}function lg(t,e,n){return e.parse("/")}function hg(t,e){return Zd(null)}let dg=(()=>{class t{constructor(t,e,n,r,i,o,s,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new T,this.errorHandler=cg,this.malformedUriErrorHandler=lg,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:hg,afterPreactivation:hg},this.urlHandlingStrategy=new ug,this.routeReuseStrategy=new og,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(re),this.console=i.get(uc);const u=i.get(xc);this.isNgZoneEnabled=u instanceof xc,this.resetConfig(a),this.currentUrlTree=new Op(new Np([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new ag(o,s,t=>this.triggerEvent(new ap(t)),t=>this.triggerEvent(new up(t))),this.routerState=rm(this.currentUrlTree,this.rootComponentType),this.transitions=new tf({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(hf(t=>0!==t.id),V(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Mf(t=>{let n=!1,r=!1;return Zd(t).pipe(Hf(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Mf(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Zd(t).pipe(Mf(t=>{const n=this.transitions.getValue();return e.next(new Jf(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?af:[t]}),Mf(t=>Promise.resolve(t)),(r=this.ngModule.injector,i=this.configLoader,o=this.urlSerializer,s=this.config,function(t){return t.pipe(Mf(t=>function(t,e,n,r,i){return new Nm(t,e,n,r,i).apply()}(r,i,o,t.extractedUrl,s).pipe(V(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),Hf(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(o){return o.pipe(H(o=>function(t,e,n,r,i="emptyOnly",o="legacy"){return new Xm(t,e,n,r,i,o).recognize()}(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(V(t=>Object.assign(Object.assign({},o),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),Hf(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),Hf(t=>{const n=new np(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,o,s;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:s}=t,a=new Jf(n,this.serializeUrl(r),i,o);e.next(a);const u=rm(r,this.rootComponentType).snapshot;return Zd(Object.assign(Object.assign({},t),{targetSnapshot:u,urlAfterRedirects:r,extras:Object.assign(Object.assign({},s),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),af}),ig(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),Hf(t=>{const e=new rp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),V(t=>Object.assign(Object.assign({},t),{guards:jm(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(H(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?Zd(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return q(t).pipe(H(t=>function(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Zd(o.map(o=>{const s=Vm(o,e,i);let a;if(function(t){return t&&Sm(t.canDeactivate)}(s))a=Ap(s.canDeactivate(t,e,n,r));else{if(!Sm(s))throw new Error("Invalid CanDeactivate guard");a=Ap(s(t,e,n,r))}return a.pipe(Nf())})).pipe(Wm()):Zd(!0)}(t.component,t.route,n,e,r)),Nf(t=>!0!==t,!0))}(s,r,i,t).pipe(H(n=>n&&"boolean"==typeof n?function(t,e,n,r){return q(e).pipe(Wf(e=>q([Hm(e.route.parent,r),qm(e.route,r),$m(t,e.path,n),Gm(t,e.route,n)]).pipe(lf(),Nf(t=>!0!==t,!0))),Nf(t=>!0!==t,!0))}(r,o,t,e):Zd(n)),V(t=>Object.assign(Object.assign({},n),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),Hf(t=>{if(Im(t.guardsResult)){const e=vp(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),Hf(t=>{const e=new ip(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),hf(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new tp(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),ig(t=>{if(t.guards.canActivateChecks.length)return Zd(t).pipe(Hf(t=>{const e=new op(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(e=this.paramsInheritanceStrategy,n=this.ngModule.injector,function(t){return t.pipe(H(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;return i.length?q(i).pipe(Wf(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Zd({});if(1===i.length){const o=i[0];return rg(t[o],e,n,r).pipe(V(t=>({[o]:t})))}const o={};return q(i).pipe(H(i=>rg(t[i],e,n,r).pipe(V(t=>(o[i]=t,t))))).pipe(Sf(),V(()=>o))}(t._resolve,t,e,r).pipe(V(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),om(t,n).resolve),null)))}(t.route,r,e,n)),function(t,e){return arguments.length>=2?function(n){return _(Vf(t,e),mf(1),xf(e))(n)}:function(e){return _(Vf((e,n,r)=>t(e,n,r+1)),mf(1))(e)}}((t,e)=>t),V(e=>t)):Zd(t)}))}),Hf(t=>{const e=new sp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}));var e,n}),ig(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),V(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new tm(i,o)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new im(new tf((i=n.value).url),new tf(i.params),new tf(i.queryParams),new tf(i.fragment),new tf(i.data),i.outlet,i.component,i),o=n.children.map(n=>t(e,n));return new tm(r,o)}}var i}(t,e._root,n?n._root:void 0);return new nm(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),Hf(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(i=this.rootContexts,o=this.routeReuseStrategy,s=t=>this.triggerEvent(t),V(t=>(new Cm(o,t.targetRouterState,t.currentRouterState,s).activate(i),t))),Hf({next(){n=!0},complete(){n=!0}}),Kf(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new tp(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),If(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=Im(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new tp(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new ep(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(o){t.reject(o)}}var i;return af}));var i,o,s}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){wp(t),this.config=t.map(Cp),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:s,preserveFragment:a}=e;Sr()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const u=n||this.routerState.root,c=a?this.currentUrlTree.fragment:i;let l=null;if(s)switch(s){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=o?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(t,e,n,r,i){if(0===n.length)return fm(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new pm(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return Tp(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new pm(n,e,r)}(n);if(o.toRoot())return fm(e.root,new Np([],{}),e,r,i);const s=function(t,e,n){if(t.isAbsolute)return new mm(e.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new mm(n.snapshot._urlSegment,!0,0);const r=dm(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new mm(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(o,e,t),a=s.processChildren?ym(s.segmentGroup,s.index,o.commands):vm(s.segmentGroup,s.index,o.commands);return fm(s.segmentGroup,a,e,r,i)}(u,this.currentUrlTree,t,l,c)}navigateByUrl(t,e={skipLocationChange:!1}){Sr()&&this.isNgZoneEnabled&&!xc.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=Im(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(Im(t))return Rp(this.currentUrlTree,t,e);const n=this.parseUrl(t);return Rp(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Zf(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,i){const o=this.getTransition();if(o&&"imperative"!==e&&"imperative"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"hashchange"==e&&"popstate"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"popstate"==e&&"hashchange"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);let s,a,u;i?(s=i.resolve,a=i.reject,u=i.promise):u=new Promise((t,e)=>{s=t,a=e});const c=++this.navigationId;return this.setTransition({id:c,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:s,reject:a,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(t){Es()},t.\u0275dir=Ce({type:t}),t})();class fg{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new pg,this.attachRef=null}}class pg{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new fg,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}let mg=(()=>{class t{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new Nu,this.deactivateEvents=new Nu,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new gg(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(xs(pg),xs(du),xs(ja),Cs("name"),xs(zo))},t.\u0275dir=Ce({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class gg{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===im?this.route:t===pg?this.childContexts:this.parent.get(t,e)}}class vg{}class yg{preload(t,e){return Zd(null)}}let bg=(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new ag(e,n,e=>t.triggerEvent(new ap(e)),e=>t.triggerEvent(new up(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(hf(t=>t instanceof Zf),Wf(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(re);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return q(n).pipe(K(),V(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(H(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Jt(dg),Jt(qc),Jt(yc),Jt(is),Jt(vg))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),wg=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Jf?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Zf&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof fp&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new fp(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(t){Es()},t.\u0275dir=Ce({type:t}),t})();const _g=new zt("ROUTER_CONFIGURATION"),xg=new zt("ROUTER_FORROOT_GUARD"),Cg=[gl,{provide:Fp,useClass:Lp},{provide:dg,useFactory:function(t,e,n,r,i,o,s,a={},u,c){const l=new dg(null,t,e,n,r,i,o,Ip(s));if(u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),a.errorHandler&&(l.errorHandler=a.errorHandler),a.malformedUriErrorHandler&&(l.malformedUriErrorHandler=a.malformedUriErrorHandler),a.enableTracing){const t=tl();l.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return a.onSameUrlNavigation&&(l.onSameUrlNavigation=a.onSameUrlNavigation),a.paramsInheritanceStrategy&&(l.paramsInheritanceStrategy=a.paramsInheritanceStrategy),a.urlUpdateStrategy&&(l.urlUpdateStrategy=a.urlUpdateStrategy),a.relativeLinkResolution&&(l.relativeLinkResolution=a.relativeLinkResolution),l},deps:[Fp,pg,gl,is,qc,yc,sg,_g,[class{},new ut],[class{},new ut]]},pg,{provide:im,useFactory:function(t){return t.routerState.root},deps:[dg]},{provide:qc,useClass:$c},bg,yg,class{preload(t,e){return e().pipe(If(()=>Zd(null)))}},{provide:_g,useValue:{enableTracing:!1}}];function Eg(){return new Lc("Router",dg)}let Sg=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Cg,Ag(e),{provide:xg,useFactory:Tg,deps:[[dg,new ut,new lt]]},{provide:_g,useValue:n||{}},{provide:hl,useFactory:kg,deps:[nl,[new at(fl),new ut],_g]},{provide:wg,useFactory:Ig,deps:[dg,zl,_g]},{provide:vg,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:yg},{provide:Lc,multi:!0,useFactory:Eg},[Rg,{provide:tc,multi:!0,useFactory:Og,deps:[Rg]},{provide:Dg,useFactory:Ng,deps:[Rg]},{provide:ac,multi:!0,useExisting:Dg}]]}}static forChild(e){return{ngModule:t,providers:[Ag(e)]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(xg,8),Jt(dg,8))}}),t})();function Ig(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new wg(t,e,n)}function kg(t,e,n={}){return n.useHash?new ml(t,e):new pl(t,e)}function Tg(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Ag(t){return[{provide:os,multi:!0,useValue:t},{provide:sg,multi:!0,useValue:t}]}let Rg=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new T}appInitializer(){return this.injector.get(il,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(dg),r=this.injector.get(_g);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Zd(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(_g),n=this.injector.get(bg),r=this.injector.get(wg),i=this.injector.get(dg),o=this.injector.get(zc);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(Jt(is))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();function Og(t){return t.appInitializer.bind(t)}function Ng(t){return t.bootstrapListener.bind(t)}const Dg=new zt("Router Initializer");let Pg=(()=>{class t{constructor(){this.title="liga-futbol"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&As(0,"router-outlet")},directives:[mg],styles:[""]}),t})();class Mg{}function Fg(t,e){return{type:7,name:t,definitions:e,options:{}}}function Lg(t,e=null){return{type:4,styles:e,timings:t}}function Bg(t,e=null){return{type:2,steps:t,options:e}}function jg(t){return{type:6,styles:t,offset:null}}function Vg(t,e,n){return{type:0,name:t,styles:e,options:n}}function Ug(t){return{type:5,steps:t}}function zg(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}function Wg(t=null){return{type:9,options:t}}function qg(t,e,n=null){return{type:11,selector:t,animation:e,options:n}}function Hg(t){Promise.resolve(null).then(t)}class Gg{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Hg(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class $g{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?Hg(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function Kg(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Xg(t){switch(t.length){case 0:return new Gg;case 1:return t[0];default:return new $g(t)}}function Yg(t,e,n,r,i={},o={}){const s=[],a=[];let u=-1,c=null;if(r.forEach(t=>{const n=t.offset,r=n==u,l=r&&c||{};Object.keys(t).forEach(n=>{let r=n,a=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,s),a){case"!":a=i[n];break;case"*":a=o[n];break;default:a=e.normalizeStyleValue(n,r,a,s)}l[r]=a}),r||a.push(l),c=l,u=n}),s.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${s.join(t)}`)}return a}function Qg(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&Jg(n,"start",t)));break;case"done":t.onDone(()=>r(n&&Jg(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&Jg(n,"destroy",t)))}}function Jg(t,e,n){const r=n.totalTime,i=Zg(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),o=t._data;return null!=o&&(i._data=o),i}function Zg(t,e,n,r,i="",o=0,s){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function tv(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function ev(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let nv=(t,e)=>!1,rv=(t,e)=>!1,iv=(t,e,n)=>[];const ov=Kg();(ov||"undefined"!=typeof Element)&&(nv=(t,e)=>t.contains(e),rv=(()=>{if(ov||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):rv}})(),iv=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let sv=null,av=!1;function uv(t){sv||(sv=("undefined"!=typeof document?document.body:null)||{},av=!!sv.style&&"WebkitAppearance"in sv.style);let e=!0;return sv.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in sv.style,!e&&av)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in sv.style),e}const cv=rv,lv=nv,hv=iv;function dv(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let fv=(()=>{class t{validateStyleProperty(t){return uv(t)}matchesElement(t,e){return cv(t,e)}containsElement(t,e){return lv(t,e)}query(t,e,n){return hv(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,o=[],s){return new Gg(n,r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),pv=(()=>{class t{}return t.NOOP=new fv,t})();function mv(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:gv(parseFloat(e[1]),e[2])}function gv(t,e){switch(e){case"s":return 1e3*t;default:return t}}function vv(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,o="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=gv(parseFloat(n[1]),n[2]);const s=n[3];null!=s&&(i=gv(parseFloat(s),n[4]));const a=n[5];a&&(o=a)}else r=t;if(!n){let n=!1,o=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(o,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:o}}(t,e,n)}function yv(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function bv(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else yv(t,n);return n}function wv(t,e,n){return n?e+":"+n+";":""}function _v(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=wv(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=wv(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function xv(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=Rv(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),Kg()&&_v(t))}function Cv(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=Rv(e);t.style[n]=""}),Kg()&&_v(t))}function Ev(t){return Array.isArray(t)?1==t.length?t[0]:Bg(t):t}const Sv=new RegExp("{{\\s*(.+?)\\s*}}","g");function Iv(t){let e=[];if("string"==typeof t){let n;for(;n=Sv.exec(t);)e.push(n[1]);Sv.lastIndex=0}return e}function kv(t,e,n){const r=t.toString(),i=r.replace(Sv,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function Tv(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const Av=/-+([a-z0-9])/g;function Rv(t){return t.replace(Av,(...t)=>t[1].toUpperCase())}function Ov(t,e){return 0===t||0===e}function Nv(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let o=e[0],s=[];if(r.forEach(t=>{o.hasOwnProperty(t)||s.push(t),o[t]=n[t]}),s.length)for(var i=1;i<e.length;i++){let n=e[i];s.forEach((function(e){n[e]=Pv(t,e)}))}}return e}function Dv(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function Pv(t,e){return window.getComputedStyle(t)[e]}function Mv(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],o=r[2],s=r[3];e.push(Bv(i,s)),"<"!=o[0]||"*"==i&&"*"==s||e.push(Bv(s,i))}(t,n,e)):n.push(t),n}const Fv=new Set(["true","1"]),Lv=new Set(["false","0"]);function Bv(t,e){const n=Fv.has(t)||Lv.has(t),r=Fv.has(e)||Lv.has(e);return(i,o)=>{let s="*"==t||t==i,a="*"==e||e==o;return!s&&n&&"boolean"==typeof i&&(s=i?Fv.has(t):Lv.has(t)),!a&&r&&"boolean"==typeof o&&(a=o?Fv.has(e):Lv.has(e)),s&&a}}const jv=new RegExp("s*:selfs*,?","g");function Vv(t,e,n){return new Uv(t).build(e,n)}class Uv{constructor(t){this._driver=t}build(t,e){const n=new zv(e);return this._resetContextStyleTimingState(n),Dv(this,Ev(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,o.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:o,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,o=r||{};if(n.styles.forEach(t=>{if(Wv(t)){const e=t;Object.keys(e).forEach(t=>{Iv(e[t]).forEach(t=>{o.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=Tv(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Dv(this,Ev(t.animation),e);return{type:1,matchers:Mv(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:qv(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>Dv(this,t,e)),options:qv(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=Dv(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:qv(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return Hv(vv(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=Hv(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||vv(r,e),Hv(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:jg({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,o=!1;if(!i){o=!0;const t={};n.easing&&(t.easing=n.easing),i=jg(t)}e.currentTime+=n.duration+n.delay;const s=this.visitStyle(i,e);s.isEmptyStep=o,r=s}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?"*"==t?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(Wv(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const o=e.collectedStyles[e.currentQuerySelector],s=o[n];let a=!0;s&&(i!=r&&i>=s.startTime&&r<=s.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${s.startTime}ms" and "${s.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=s.startTime),a&&(o[n]={startTime:i,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},i=Iv(t);i.length&&i.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let o=!1,s=!1,a=0;const u=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let u=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(Wv(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Wv(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),c=0;return null!=u&&(r++,c=n.offset=u),s=s||c<0||c>1,o=o||c<a,a=c,i.push(c),n});s&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&e.errors.push("Please ensure that all keyframe offsets are in order");const c=t.steps.length;let l=0;r>0&&r<c?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(l=1/(c-1));const h=c-1,d=e.currentTime,f=e.currentAnimateTimings,p=f.duration;return u.forEach((t,r)=>{const o=l>0?r==h?1:l*r:i[r],s=o*p;e.currentTime=d+f.delay+s,f.duration=s,this._validateStyleAst(t,e),t.offset=o,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:Dv(this,Ev(t.animation),e),options:qv(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:qv(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:qv(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(jv,"")),[t=t.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,".ng-animating"),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,tv(e.collectedStyles,e.currentQuerySelector,{});const s=Dv(this,Ev(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:t.selector,options:qv(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:vv(t.timings,e.errors,!0);return{type:12,animation:Dv(this,Ev(t.animation),e),timings:n,options:null}}}class zv{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Wv(t){return!Array.isArray(t)&&"object"==typeof t}function qv(t){var e;return t?(t=yv(t)).params&&(t.params=(e=t.params)?yv(e):null):t={},t}function Hv(t,e,n){return{duration:t,delay:e,easing:n}}function Gv(t,e,n,r,i,o,s=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class $v{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Kv=new RegExp(":enter","g"),Xv=new RegExp(":leave","g");function Yv(t,e,n,r,i,o={},s={},a,u,c=[]){return(new Qv).buildKeyframes(t,e,n,r,i,o,s,a,u,c)}class Qv{buildKeyframes(t,e,n,r,i,o,s,a,u,c=[]){u=u||new $v;const l=new Zv(t,e,u,r,i,c,[]);l.options=a,l.currentTimeline.setStyles([o],null,l.errors,a),Dv(this,n,l);const h=l.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(s).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([s],null,l.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[Gv(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?mv(n.duration):null,o=null!=n.delay?mv(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,o);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),Dv(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&(r=e.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Jv);const t=mv(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>Dv(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?mv(t.options.delay):0;t.steps.forEach(o=>{const s=e.createSubContext(t.options);i&&s.delayNextStep(i),Dv(this,o,s),r=Math.max(r,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return vv(e.params?kv(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,o=e.createSubContext().currentTimeline;o.easing=n.easing,t.styles.forEach(t=>{o.forwardTime((t.offset||0)*i),o.setStyles(t.styles,t.easing,e.errors,e.options),o.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(o),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?mv(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Jv);let o=n;const s=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=s.length;let a=null;s.forEach((n,r)=>{e.currentQueryIndex=r;const s=e.createSubContext(t.options,n);i&&s.delayNextStep(i),n===e.element&&(a=s.currentTimeline),Dv(this,t.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),s=o*(e.currentQueryTotal-1);let a=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=s-a;break;case"full":a=n.currentStaggerTime}const u=e.currentTimeline;a&&u.delayNextStep(a);const c=u.currentTime;Dv(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}const Jv={};class Zv{constructor(t,e,n,r,i,o,s,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Jv,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new ty(this._driver,e,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=mv(n.duration)),null!=n.delay&&(r.delay=mv(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=kv(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new Zv(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Jv,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new ey(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,o){let s=[];if(r&&s.push(this.element),t.length>0){t=(t=t.replace(Kv,"."+this._enterClassName)).replace(Xv,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),s.push(...e)}return i||0!=s.length||o.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),s}}class ty{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new ty(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||"*",this._currentKeyframe[t]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},o=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]="*"})):bv(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(t=>{const e=kv(o[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:"*"),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,o)=>{const s=bv(i,!0);Object.keys(s).forEach(n=>{const r=s[n];"!"==r?t.add(n):"*"==r&&e.add(n)}),n||(s.offset=o/this.duration),r.push(s)});const i=t.size?Tv(t.values()):[],o=e.size?Tv(e.values()):[];if(n){const t=r[0],e=yv(t);t.offset=0,e.offset=1,r=[t,e]}return Gv(this.element,r,i,o,this.duration,this.startTime,this.easing,!1)}}class ey extends ty{constructor(t,e,n,r,i,o,s=!1){super(t,e,o.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=n+e,s=e/o,a=bv(t[0],!1);a.offset=0,i.push(a);const u=bv(t[0],!1);u.offset=ny(s),i.push(u);const c=t.length-1;for(let r=1;r<=c;r++){let s=bv(t[r],!1);s.offset=ny((e+s.offset*n)/o),i.push(s)}n=o,e=0,r="",t=i}return Gv(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function ny(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class ry{}class iy extends ry{normalizePropertyName(t,e){return Rv(t)}normalizeStyleValue(t,e,n,r){let i="";const o=n.toString().trim();if(oy[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return o+i}}const oy=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function sy(t,e,n,r,i,o,s,a,u,c,l,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:d}}const ay={};class uy{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],o=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):o}build(t,e,n,r,i,o,s,a,u,c){const l=[],h=this.ast.options&&this.ast.options.params||ay,d=this.buildStyles(n,s&&s.params||ay,l),f=a&&a.params||ay,p=this.buildStyles(r,f,l),m=new Set,g=new Map,v=new Map,y="void"===r,b={params:Object.assign(Object.assign({},h),f)},w=c?[]:Yv(t,e,this.ast.animation,i,o,d,p,b,u,l);let _=0;if(w.forEach(t=>{_=Math.max(t.duration+t.delay,_)}),l.length)return sy(e,this._triggerName,n,r,y,d,p,[],[],g,v,_,l);w.forEach(t=>{const n=t.element,r=tv(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=tv(v,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const x=Tv(m.values());return sy(e,this._triggerName,n,r,y,d,p,w,x,g,v,_)}}class cy{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=yv(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let o=i[t];o.length>1&&(o=kv(o,r,e)),n[t]=o})}}),n}}class ly{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new cy(t.style,t.options&&t.options.params||{})}),hy(this.states,"true","1"),hy(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new uy(t,e,this.states))}),this.fallbackTransition=new uy(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function hy(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const dy=new $v;class fy{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=Vv(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=Yg(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let o;const s=new Map;if(i?(o=Yv(this._driver,e,i,"ng-enter","ng-leave",{},{},n,dy,r),o.forEach(t=>{const e=tv(s,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);s.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,"*")})});const a=Xg(o.map(t=>{const e=s.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=Zg(e,"","","");return Qg(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const py=[],my={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},gy={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class vy{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=yv(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const yy=new vy("void");class by{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Iy(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const o=tv(this._elementListeners,t,[]),s={name:e,phase:n,callback:r};o.push(s);const a=tv(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(Iy(t,"ng-trigger"),Iy(t,"ng-trigger-"+e),a[e]=yy),()=>{this._engine.afterFlush(()=>{const t=o.indexOf(s);t>=0&&o.splice(t,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),o=new _y(this.id,e,t);let s=this._engine.statesByElement.get(t);s||(Iy(t,"ng-trigger"),Iy(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,s={}));let a=s[e];const u=new vy(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&u.absorbOptions(a.options),s[e]=u,a||(a=yy),"void"!==u.value&&a.value===u.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(a.params,u.params)){const e=[],n=i.matchStyles(a.value,a.params,e),r=i.matchStyles(u.value,u.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{Cv(t,n),xv(t,r)})}return}const c=tv(this._engine.playersByElement,t,[]);c.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let l=i.matchTransition(a.value,u.value,t,u.params),h=!1;if(!l){if(!r)return;l=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:l,fromState:a,toState:u,player:o,isFallbackTransition:h}),h||(Iy(t,"ng-animate-queued"),o.onStart(()=>{ky(t,"ng-animate-queued")})),o.onDone(()=>{let e=this.players.indexOf(o);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(o);t>=0&&n.splice(t,1)}}),this.players.push(o),c.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,".ng-trigger",!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const o=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,"void",r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&Xg(o).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,o=this._engine.statesByElement.get(t)[r]||yy,s=new vy("void"),a=new _y(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:o,toState:s,player:a,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const r=t.__ng_removed;r&&r!==my||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Iy(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,o=this._elementListeners.get(i);o&&o.forEach(e=>{if(e.name==n.triggerName){const r=Zg(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,Qg(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class wy{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new by(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(xy(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!xy(e))return;const i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Iy(t,"ng-animate-disabled")):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),ky(t,"ng-animate-disabled"))}removeNode(t,e,n,r){if(xy(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return xy(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,".ng-trigger",!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,".ng-animating",!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Xg(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=my,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,".ng-animate-disabled")&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Iy(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?Xg(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new $v,r=[],i=new Map,o=[],s=new Map,a=new Map,u=new Map,c=new Set;this.disabledNodes.forEach(t=>{c.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)c.add(e[n])});const l=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Sy(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((t,e)=>{const n="ng-enter"+p++;f.set(e,n),t.forEach(t=>Iy(t,n))});const m=[],g=new Set,v=new Set;for(let R=0;R<this.collectedLeaveElements.length;R++){const t=this.collectedLeaveElements[R],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):v.add(t))}const y=new Map,b=Sy(h,Array.from(g));b.forEach((t,e)=>{const n="ng-leave"+p++;y.set(e,n),t.forEach(t=>Iy(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=f.get(e);t.forEach(t=>ky(t,n))}),b.forEach((t,e)=>{const n=y.get(e);t.forEach(t=>ky(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],_=[];for(let R=this._namespaceList.length-1;R>=0;R--)this._namespaceList[R].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(w.push(e),this.collectedEnterElements.length){const t=i.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const c=!l||!this.driver.containsElement(l,i),h=y.get(i),d=f.get(i),p=this._buildInstruction(t,n,d,h,c);if(!p.errors||!p.errors.length)return c?(e.onStart(()=>Cv(i,p.fromStyles)),e.onDestroy(()=>xv(i,p.toStyles)),void r.push(e)):t.isFallbackTransition?(e.onStart(()=>Cv(i,p.fromStyles)),e.onDestroy(()=>xv(i,p.toStyles)),void r.push(e)):(p.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,p.timelines),o.push({instruction:p,player:e,element:i}),p.queriedElements.forEach(t=>tv(s,t,[]).push(e)),p.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),void p.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=u.get(e);r||u.set(e,r=new Set),n.forEach(t=>r.add(t))}));_.push(p)});if(_.length){const t=[];_.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const x=new Map,C=new Map;o.forEach(t=>{const e=t.element;n.has(e)&&(C.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,x))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{tv(x,e,[]).push(t),t.destroy()})});const E=m.filter(t=>Ay(t,a,u)),S=new Map;Ey(S,this.driver,v,u,"*").forEach(t=>{Ay(t,a,u)&&E.push(t)});const I=new Map;d.forEach((t,e)=>{Ey(I,this.driver,new Set(t),a,"!")}),E.forEach(t=>{const e=S.get(t),n=I.get(t);S.set(t,Object.assign(Object.assign({},e),n))});const k=[],T=[],A={};o.forEach(t=>{const{element:e,player:o,instruction:s}=t;if(n.has(e)){if(c.has(e))return o.onDestroy(()=>xv(e,s.toStyles)),o.disabled=!0,o.overrideTotalTime(s.totalTime),void r.push(o);let t=A;if(C.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=C.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>C.set(e,t))}const n=this._buildAnimation(o.namespaceId,s,x,i,I,S);if(o.setRealPlayer(n),t===A)k.push(o);else{const e=this.playersByElement.get(t);e&&e.length&&(o.parentPlayer=Xg(e)),r.push(o)}}else Cv(e,s.fromStyles),o.onDestroy(()=>xv(e,s.toStyles)),T.push(o),c.has(e)&&r.push(o)}),T.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=Xg(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let R=0;R<m.length;R++){const t=m[R],e=t.__ng_removed;if(ky(t,"ng-leave"),e&&e.hasAnimation)continue;let n=[];if(s.size){let e=s.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,".ng-animating",!0);for(let t=0;t<r.length;t++){let e=s.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?Ty(this,t,r):this.processLeaveNode(t)}return m.length=0,k.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),k}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let o=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(o=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||"void"==i;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&o.push(e)})}}return(n||r)&&(o=o.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),o}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,o=e.isRemovalTransition?void 0:e.triggerName;for(const s of e.timelines){const t=s.element,a=t!==r,u=tv(n,t,[]);this._getPreviousPlayers(t,a,i,o,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),u.push(t)})}Cv(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,o){const s=e.triggerName,a=e.element,u=[],c=new Set,l=new Set,h=e.timelines.map(e=>{const h=e.element;c.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new Gg(e.duration,e.delay);const f=h!==a,p=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof $g?t(i.players,n):n.push(i)}}(t,e),e}((n.get(h)||py).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=i.get(h),g=o.get(h),v=Yg(0,this._normalizer,0,e.keyframes,m,g),y=this._buildPlayer(e,v,p);if(e.subTimeline&&r&&l.add(h),f){const e=new _y(t,s,h);e.setRealPlayer(y),u.push(e)}return y});u.forEach(t=>{tv(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),c.forEach(t=>Iy(t,"ng-animating"));const d=Xg(h);return d.onDestroy(()=>{c.forEach(t=>ky(t,"ng-animating")),xv(a,e.toStyles)}),l.forEach(t=>{tv(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new Gg(t.duration,t.delay)}}class _y{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new Gg,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>Qg(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){tv(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function xy(t){return t&&1===t.nodeType}function Cy(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function Ey(t,e,n,r,i){const o=[];n.forEach(t=>o.push(Cy(t)));const s=[];r.forEach((n,r)=>{const o={};n.forEach(t=>{const n=o[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=gy,s.push(r))}),t.set(r,o)});let a=0;return n.forEach(t=>Cy(t,o[a++])),s}function Sy(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let o=i.get(e);if(o)return o;const s=e.parentNode;return o=n.has(s)?s:r.has(s)?1:t(s),i.set(e,o),o}(t);1!==e&&n.get(e).push(t)}),n}function Iy(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function ky(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function Ty(t,e,n){Xg(n).onDone(()=>t.processLeaveNode(e))}function Ay(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class Ry{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new wy(t,e,n),this._timelineEngine=new fy(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const o=t+"-"+r;let s=this._triggerCache[o];if(!s){const t=[],e=Vv(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);s=function(t,e){return new ly(t,e)}(r,e),this._triggerCache[o]=s}this._transitionEngine.registerTrigger(e,r,s)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=ev(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=ev(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function Oy(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Dy(e[0]),e.length>1&&(r=Dy(e[e.length-1]))):e&&(n=Dy(e)),n||r?new Ny(t,n,r):null}let Ny=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&xv(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(xv(this._element,this._initialStyles),this._endStyles&&(xv(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Cv(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Cv(this._element,this._endStyles),this._endStyles=null),xv(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function Dy(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];Py(i)&&(e=e||{},e[i]=t[i])}return e}function Py(t){return"display"===t||"position"===t}class My{constructor(t,e,n,r,i,o,s){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=Uy(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),Vy(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),jy(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Fy(this._element,this._name,"paused")}resume(){Fy(this._element,this._name,"running")}setPosition(t){const e=Ly(this._element,this._name);this._position=t*this._duration,Vy(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),jy(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=Uy(t,"").split(","),r=By(n,e);r>=0&&(n.splice(r,1),Vy(t,"",n.join(",")))}(this._element,this._name))}}function Fy(t,e,n){Vy(t,"PlayState",n,Ly(t,e))}function Ly(t,e){const n=Uy(t,"");return n.indexOf(",")>0?By(n.split(","),e):By([n],e)}function By(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function jy(t,e,n){n?t.removeEventListener("animationend",e):t.addEventListener("animationend",e)}function Vy(t,e,n,r){const i="animation"+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function Uy(t,e){return t.style["animation"+e]}class zy{constructor(t,e,n,r,i,o,s,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=s,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new My(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:Pv(this.element,n))})}this.currentSnapshot=t}}class Wy extends Gg{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=dv(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class qy{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return uv(t)}matchesElement(t,e){return cv(t,e)}containsElement(t,e){return lv(t,e)}query(t,e,n){return hv(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>dv(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=" ";const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const o=document.createElement("style");return o.innerHTML=r,o}animate(t,e,n,r,i,o=[],s){s&&this._notifyFaultyScrubber();const a=o.filter(t=>t instanceof zy),u={};Ov(n,r)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const c=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=Nv(t,e,u));if(0==n)return new Wy(t,c);const l=`gen_css_kf_${this._count++}`,h=this.buildKeyframeElement(t,l,e);document.querySelector("head").appendChild(h);const d=Oy(t,e),f=new zy(t,e,l,n,r,i,c,d);return f.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),f}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class Hy{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:Pv(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class Gy{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test($y().toString()),this._cssKeyframesDriver=new qy}validateStyleProperty(t){return uv(t)}matchesElement(t,e){return cv(t,e)}containsElement(t,e){return lv(t,e)}query(t,e,n){return hv(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,o=[],s){if(!s&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,o);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const u={},c=o.filter(t=>t instanceof Hy);Ov(n,r)&&c.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const l=Oy(t,e=Nv(t,e=e.map(t=>bv(t,!1)),u));return new Hy(t,e,a,l)}}function $y(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let Ky=(()=>{class t extends Mg{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:fe.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?Bg(t):t;return Qy(this._renderer,null,e,"register",[n]),new Xy(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Jt(za),Jt(el))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class Xy extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Yy(this._id,t,e||{},this._renderer)}}class Yy{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Qy(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function Qy(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}let Jy=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new Zy("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,t);const o=e=>{Array.isArray(e)?e.forEach(o):this.engine.registerTrigger(r,i,t,e.name,e)};return e.data.animation.forEach(o),new tb(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Jt(za),Jt(Ry),Jt(xc))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class Zy{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&"@.disabled"==e?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class tb extends Zy{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&"@.disabled"==e?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),o="";return"@"!=i.charAt(0)&&([i,o]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,o,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let eb=(()=>{class t extends Ry{constructor(t,e,n){super(t.body,e,n)}}return t.\u0275fac=function(e){return new(e||t)(Jt(el),Jt(pv),Jt(ry))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const nb=new zt("AnimationModuleType"),rb=[{provide:pv,useFactory:function(){return"function"==typeof $y()?new Gy:new qy}},{provide:nb,useValue:"BrowserAnimations"},{provide:Mg,useClass:Ky},{provide:ry,useFactory:function(){return new iy}},{provide:Ry,useClass:eb},{provide:za,useFactory:function(t,e,n){return new Jy(t,e,n)},deps:[oh,Ry,xc]}];let ib=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:rb,imports:[bh]}),t})();function ob(t,...e){return e.length?e.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}class sb extends p{constructor(t,e){super()}schedule(t,e=0){return this}}class ab extends sb{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let ub=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class cb extends ub{constructor(t,e=ub.now){super(t,()=>cb.delegate&&cb.delegate!==this?cb.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return cb.delegate&&cb.delegate!==this?cb.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const lb=new cb(ab);function hb(t,e=lb){return n=>n.lift(new db(t,e))}class db{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new fb(t,this.dueTime,this.scheduler))}}class fb extends v{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(pb,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function pb(t){t.debouncedNext()}function mb(t){return null!=t&&"false"!==`${t}`}function gb(t,e=0){return vb(t)?Number(t):e}function vb(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function yb(t){return Array.isArray(t)?t:[t]}function bb(t){return null==t?"":"string"==typeof t?t:`${t}px`}function wb(t){return t instanceof Va?t.nativeElement:t}let _b;try{_b="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(Ult){_b=!1}let xb,Cb=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Vl(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!_b)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Jt(sc,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(sc,8))},token:t,providedIn:"root"}),t})(),Eb=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})();const Sb=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Ib(){if(xb)return xb;if("object"!=typeof document||!document)return xb=new Set(Sb),xb;let t=document.createElement("input");return xb=new Set(Sb.filter(e=>(t.setAttribute("type",e),t.type===e))),xb}let kb,Tb,Ab;function Rb(t){return function(){if(null==kb&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>kb=!0}))}finally{kb=kb||!1}return kb}()?t:!!t.capture}function Ob(){if("object"!=typeof document||!document)return 0;if(null==Tb){const t=document.createElement("div"),e=t.style;t.dir="rtl",e.height="1px",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",t.appendChild(n),document.body.appendChild(t),Tb=0,0===t.scrollLeft&&(t.scrollLeft=1,Tb=0===t.scrollLeft?1:2),t.parentNode.removeChild(t)}return Tb}function Nb(t){if(function(){if(null==Ab){const t="undefined"!=typeof document?document.head:null;Ab=!(!t||!t.createShadowRoot&&!t.attachShadow)}return Ab}()){const e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}let Db=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Pb=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=wb(t);return new C(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new T,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.\u0275fac=function(e){return new(e||t)(Jt(Db))},t.\u0275prov=pt({factory:function(){return new t(Jt(Db))},token:t,providedIn:"root"}),t})(),Mb=(()=>{class t{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new Nu,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=mb(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=gb(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(hb(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(xs(Pb),xs(Va),xs(xc))},t.\u0275dir=Ce({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),Fb=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Db]}),t})();function Lb(t,e){return(t.getAttribute(e)||"").match(/\S+/g)||[]}let Bb=0;const jb=new Map;let Vb=null,Ub=(()=>{class t{constructor(t){this._document=t}describe(t,e){this._canBeDescribed(t,e)&&("string"!=typeof e?(this._setMessageId(e),jb.set(e,{messageElement:e,referenceCount:0})):jb.has(e)||this._createMessageElement(e),this._isElementDescribedByMessage(t,e)||this._addMessageReference(t,e))}removeDescription(t,e){if(this._isElementNode(t)){if(this._isElementDescribedByMessage(t,e)&&this._removeMessageReference(t,e),"string"==typeof e){const t=jb.get(e);t&&0===t.referenceCount&&this._deleteMessageElement(e)}Vb&&0===Vb.childNodes.length&&this._deleteMessagesContainer()}}ngOnDestroy(){const t=this._document.querySelectorAll("[cdk-describedby-host]");for(let e=0;e<t.length;e++)this._removeCdkDescribedByReferenceIds(t[e]),t[e].removeAttribute("cdk-describedby-host");Vb&&this._deleteMessagesContainer(),jb.clear()}_createMessageElement(t){const e=this._document.createElement("div");this._setMessageId(e),e.textContent=t,this._createMessagesContainer(),Vb.appendChild(e),jb.set(t,{messageElement:e,referenceCount:0})}_setMessageId(t){t.id||(t.id=`cdk-describedby-message-${Bb++}`)}_deleteMessageElement(t){const e=jb.get(t),n=e&&e.messageElement;Vb&&n&&Vb.removeChild(n),jb.delete(t)}_createMessagesContainer(){if(!Vb){const t=this._document.getElementById("cdk-describedby-message-container");t&&t.parentNode.removeChild(t),Vb=this._document.createElement("div"),Vb.id="cdk-describedby-message-container",Vb.setAttribute("aria-hidden","true"),Vb.style.display="none",this._document.body.appendChild(Vb)}}_deleteMessagesContainer(){Vb&&Vb.parentNode&&(Vb.parentNode.removeChild(Vb),Vb=null)}_removeCdkDescribedByReferenceIds(t){const e=Lb(t,"aria-describedby").filter(t=>0!=t.indexOf("cdk-describedby-message"));t.setAttribute("aria-describedby",e.join(" "))}_addMessageReference(t,e){const n=jb.get(e);!function(t,e,n){const r=Lb(t,e);r.some(t=>t.trim()==n.trim())||(r.push(n.trim()),t.setAttribute(e,r.join(" ")))}(t,"aria-describedby",n.messageElement.id),t.setAttribute("cdk-describedby-host",""),n.referenceCount++}_removeMessageReference(t,e){const n=jb.get(e);n.referenceCount--,function(t,e,n){const r=Lb(t,e).filter(t=>t!=n.trim());r.length?t.setAttribute(e,r.join(" ")):t.removeAttribute(e)}(t,"aria-describedby",n.messageElement.id),t.removeAttribute("cdk-describedby-host")}_isElementDescribedByMessage(t,e){const n=Lb(t,"aria-describedby"),r=jb.get(e),i=r&&r.messageElement.id;return!!i&&-1!=n.indexOf(i)}_canBeDescribed(t,e){if(!this._isElementNode(t))return!1;if(e&&"object"==typeof e)return!0;const n=null==e?"":`${e}`.trim(),r=t.getAttribute("aria-label");return!(!n||r&&r.trim()===n)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(el))},token:t,providedIn:"root"}),t})();class zb extends class{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new T,this._typeaheadSubscription=p.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new T,this.change=new T,t instanceof Pu&&t.changes.subscribe(t=>{if(this._activeItem){const e=t.toArray().indexOf(this._activeItem);e>-1&&e!==this._activeItemIndex&&(this._activeItemIndex=e)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){if(this._items.length&&this._items.some(t=>"function"!=typeof t.getLabel))throw Error("ListKeyManager items in typeahead mode must implement the `getLabel` method.");return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Hf(t=>this._pressedLetters.push(t)),hb(t),hf(()=>this._pressedLetters.length>0),V(()=>this._pressedLetters.join(""))).subscribe(t=>{const e=this._getItemsArray();for(let n=1;n<e.length+1;n++){const r=(this._activeItemIndex+n)%e.length,i=e[r];if(!this._skipPredicateFn(i)&&0===i.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(r);break}}this._pressedLetters=[]}),this}setActiveItem(t){const e=this._activeItemIndex;this.updateActiveItem(t),this._activeItemIndex!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(e=>!t[e]||this._allowedModifierKeys.indexOf(e)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&n){this.setNextItemActive();break}return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&n){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&n){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;default:return void((n||ob(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t),r=e[n];this._activeItem=null==r?null:r,this._activeItemIndex=n}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof Pu?this._items.toArray():this._items}}{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}let Wb=(()=>{class t{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const e=function(t){try{return t.frameElement}catch(Ult){return null}}((n=t).ownerDocument&&n.ownerDocument.defaultView||window);var n;if(e){const t=e&&e.nodeName.toLowerCase();if(-1===Hb(e))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===t)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(e))return!1}let r=t.nodeName.toLowerCase(),i=Hb(t);if(t.hasAttribute("contenteditable"))return-1!==i;if("iframe"===r)return!1;if("audio"===r){if(!t.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===r){if(!t.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==r||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(t){let e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(t))&&t.tabIndex>=0}isFocusable(t){return function(t){return!function(t){return function(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function(t){let e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function(t){return function(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||qb(t))}(t)&&!this.isDisabled(t)&&this.isVisible(t)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cb))},t.\u0275prov=pt({factory:function(){return new t(Jt(Cb))},token:t,providedIn:"root"}),t})();function qb(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let e=t.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function Hb(t){if(!qb(t))return null;const e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class Gb{constructor(t,e,n,r,i=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,i||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),e&&(e.removeEventListener("focus",this.endAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),this._startAnchor=this._endAnchor=null}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement()))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], `+`[cdkFocusRegion${t}], `+`[cdk-focus-${t}]`);for(let n=0;n<e.length;n++)e[n].hasAttribute(`cdk-focus-${t}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${t}', `+`use 'cdkFocusRegion${t}' instead. The deprecated `+"attribute will be removed in 8.0.0.",e[n]):e[n].hasAttribute(`cdk-focus-region-${t}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${t}', `+`use 'cdkFocusRegion${t}' instead. The deprecated attribute `+"will be removed in 8.0.0.",e[n]);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return t?(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),Sr()&&!this._checker.isFocusable(t)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",t),t.focus(),!0):this.focusFirstTabbableElement()}focusFirstTabbableElement(){const t=this._getRegionBoundary("start");return t&&t.focus(),!!t}focusLastTabbableElement(){const t=this._getRegionBoundary("end");return t&&t.focus(),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=0;n<e.length;n++){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(t)return t}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=e.length-1;n>=0;n--){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(t)return t}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.asObservable().pipe(Af(1)).subscribe(t)}}let $b=(()=>{class t{constructor(t,e,n){this._checker=t,this._ngZone=e,this._document=n}create(t,e=!1){return new Gb(t,this._checker,this._ngZone,this._document,e)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Wb),Jt(xc),Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(Wb),Jt(xc),Jt(el))},token:t,providedIn:"root"}),t})();"undefined"!=typeof Element&&Element;const Kb=new zt("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),Xb=new zt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Yb=(()=>{class t{constructor(t,e,n,r){this._ngZone=e,this._defaultOptions=r,this._document=n,this._liveElement=t||this._createLiveElement()}announce(t,...e){const n=this._defaultOptions;let r,i;return 1===e.length&&"number"==typeof e[0]?i=e[0]:[r,i]=e,this.clear(),clearTimeout(this._previousTimeout),r||(r=n&&n.politeness?n.politeness:"polite"),null==i&&n&&(i=n.duration),this._liveElement.setAttribute("aria-live",r),this._ngZone.runOutsideAngular(()=>new Promise(e=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,e(),"number"==typeof i&&(this._previousTimeout=setTimeout(()=>this.clear(),i))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const t=this._document.getElementsByClassName("cdk-live-announcer-element"),e=this._document.createElement("div");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e.classList.add("cdk-live-announcer-element"),e.classList.add("cdk-visually-hidden"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),e}}return t.\u0275fac=function(e){return new(e||t)(Jt(Kb,8),Jt(xc),Jt(el),Jt(Xb,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(Kb,8),Jt(xc),Jt(el),Jt(Xb,8))},token:t,providedIn:"root"}),t})();function Qb(t){return 0===t.buttons}const Jb=new zt("cdk-focus-monitor-default-options"),Zb=Rb({passive:!0,capture:!0});let tw=(()=>{class t{constructor(t,e,n,r){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=t=>{if(!this._lastTouchTarget){const e=Qb(t)?"keyboard":"mouse";this._setOriginForCurrentEventQueue(e)}},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=ew(t),this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,650)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._rootNodeFocusAndBlurListener=t=>{const e=ew(t),n="focus"===t.type?this._onFocus:this._onBlur;for(let r=e;r;r=r.parentElement)n.call(this,t,r)},this._document=n,this._detectionMode=(null==r?void 0:r.detectionMode)||0}monitor(t,e=!1){if(!this._platform.isBrowser)return Zd(null);const n=wb(t),r=Nb(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return e&&(i.checkChildren=!0),i.subject.asObservable();const o={checkChildren:e,subject:new T,rootNode:r};return this._elementInfo.set(n,o),this._registerGlobalListeners(o),o.subject.asObservable()}stopMonitoring(t){const e=wb(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}focusVia(t,e,n){const r=wb(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_getFocusOrigin(t){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"}_setClasses(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,0===this._detectionMode&&(this._originTimeoutId=setTimeout(()=>this._origin=null,1))})}_wasCausedByTouch(t){const e=ew(t);return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);if(!n||!n.checkChildren&&e!==ew(t))return;const r=this._getFocusOrigin(t);this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const e=t.rootNode,n=this._rootNodeFocusListenerCount.get(e)||0;n||this._ngZone.runOutsideAngular(()=>{e.addEventListener("focus",this._rootNodeFocusAndBlurListener,Zb),e.addEventListener("blur",this._rootNodeFocusAndBlurListener,Zb)}),this._rootNodeFocusListenerCount.set(e,n+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular(()=>{const t=this._getDocument(),e=this._getWindow();t.addEventListener("keydown",this._documentKeydownListener,Zb),t.addEventListener("mousedown",this._documentMousedownListener,Zb),t.addEventListener("touchstart",this._documentTouchstartListener,Zb),e.addEventListener("focus",this._windowFocusListener)})}_removeGlobalListeners(t){const e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){const t=this._rootNodeFocusListenerCount.get(e);t>1?this._rootNodeFocusListenerCount.set(e,t-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Zb),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Zb),this._rootNodeFocusListenerCount.delete(e))}if(!--this._monitoredElementCount){const t=this._getDocument(),e=this._getWindow();t.removeEventListener("keydown",this._documentKeydownListener,Zb),t.removeEventListener("mousedown",this._documentMousedownListener,Zb),t.removeEventListener("touchstart",this._documentTouchstartListener,Zb),e.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}return t.\u0275fac=function(e){return new(e||t)(Jt(xc),Jt(Cb),Jt(el,8),Jt(Jb,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(xc),Jt(Cb),Jt(el,8),Jt(Jb,8))},token:t,providedIn:"root"}),t})();function ew(t){return t.composedPath?t.composedPath()[0]:t.target}let nw=(()=>{class t{constructor(t,e){this._platform=t,this._document=e}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove("cdk-high-contrast-active"),t.remove("cdk-high-contrast-black-on-white"),t.remove("cdk-high-contrast-white-on-black");const e=this.getHighContrastMode();1===e?(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-black-on-white")):2===e&&(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-white-on-black"))}}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cb),Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(Cb),Jt(el))},token:t,providedIn:"root"}),t})(),rw=(()=>{class t{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(nw))},imports:[[Eb,Fb]]}),t})();const iw=new zt("cdk-dir-doc",{providedIn:"root",factory:function(){return Zt(el)}});let ow=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new Nu,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Jt(iw,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(iw,8))},token:t,providedIn:"root"}),t})(),sw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})();const aw=new $a("9.2.4"),uw=["*",[["mat-option"],["ng-container"]]],cw=["*","mat-option, ng-container"];function lw(t,e){if(1&t&&As(0,"mat-pseudo-checkbox",3),2&t){const t=Us();Ss("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}const hw=["*"];let dw=(()=>{class t{}return t.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",t.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",t.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",t.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",t})(),fw=(()=>{class t{}return t.COMPLEX="375ms",t.ENTERING="225ms",t.EXITING="195ms",t})();const pw=new $a("9.2.4"),mw=new zt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let gw=(()=>{class t{constructor(t,e,n){this._hasDoneGlobalChecks=!1,this._document=n,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=e,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getDocument(){const t=this._document||document;return"object"==typeof t&&t?t:null}_getWindow(){const t=this._getDocument(),e=(null==t?void 0:t.defaultView)||window;return"object"==typeof e&&e?e:null}_checksAreEnabled(){return Sr()&&!this._isTestEnv()}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){const t=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),e=this._getDocument();t&&e&&!e.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){const t=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,e=this._getDocument();if(t||!e||!e.body||"function"!=typeof getComputedStyle)return;const n=e.createElement("div");n.classList.add("mat-theme-loaded-marker"),e.body.appendChild(n);const r=getComputedStyle(n);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),e.body.removeChild(n)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&pw.full!==aw.full&&console.warn("The Angular Material version ("+pw.full+") does not match the Angular CDK version ("+aw.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(nw),Jt(mw,8),Jt(el,8))},imports:[[sw],sw]}),t})();function vw(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=mb(t)}}}function yw(t,e){return class extends t{constructor(...t){super(...t),this.color=e}get color(){return this._color}set color(t){const n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function bw(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=mb(t)}}}function ww(t,e=0){return class extends t{constructor(...t){super(...t),this._tabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?t:e}}}function _w(t){return class extends t{constructor(...t){super(...t),this.errorState=!1,this.stateChanges=new T}updateErrorState(){const t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}}function xw(t){return class extends t{constructor(...t){super(...t),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new C(t=>{this._isInitialized?this._notifySubscriber(t):this._pendingSubscribers.push(t)})}_markInitialized(){if(this._isInitialized)throw Error("This directive has already been marked as initialized and should not be called twice.");this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(t){t.next(),t.complete()}}}const Cw=new zt("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return Zt(cc)}});class Ew{constructor(){this._localeChanges=new T}get localeChanges(){return this._localeChanges}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}}const Sw=new zt("mat-date-formats");let Iw;try{Iw="undefined"!=typeof Intl}catch(Ult){Iw=!1}const kw={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},Tw=Ow(31,t=>String(t+1)),Aw={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},Rw=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Ow(t,e){const n=Array(t);for(let r=0;r<t;r++)n[r]=e(r);return n}let Nw=(()=>{class t extends Ew{constructor(t,e){super(),this.useUtcForDisplay=!0,super.setLocale(t),this.useUtcForDisplay=!e.TRIDENT,this._clampDate=e.TRIDENT||e.EDGE}getYear(t){return t.getFullYear()}getMonth(t){return t.getMonth()}getDate(t){return t.getDate()}getDayOfWeek(t){return t.getDay()}getMonthNames(t){if(Iw){const e=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return Ow(12,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,t,1))))}return kw[t]}getDateNames(){if(Iw){const t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Ow(31,e=>this._stripDirectionalityCharacters(this._format(t,new Date(2017,0,e+1))))}return Tw}getDayOfWeekNames(t){if(Iw){const e=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return Ow(7,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,0,t+1))))}return Aw[t]}getYearName(t){if(Iw){const e=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(e,t))}return String(this.getYear(t))}getFirstDayOfWeek(){return 0}getNumDaysInMonth(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}clone(t){return new Date(t.getTime())}createDate(t,e,n){if(e<0||e>11)throw Error(`Invalid month index "${e}". Month index has to be between 0 and 11.`);if(n<1)throw Error(`Invalid date "${n}". Date has to be greater than 0.`);let r=this._createDateWithOverflow(t,e,n);if(r.getMonth()!=e)throw Error(`Invalid date "${n}" for month with index "${e}".`);return r}today(){return new Date}parse(t){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}format(t,e){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");if(Iw){this._clampDate&&(t.getFullYear()<1||t.getFullYear()>9999)&&(t=this.clone(t)).setFullYear(Math.max(1,Math.min(9999,t.getFullYear()))),e=Object.assign(Object.assign({},e),{timeZone:"utc"});const n=new Intl.DateTimeFormat(this.locale,e);return this._stripDirectionalityCharacters(this._format(n,t))}return this._stripDirectionalityCharacters(t.toDateString())}addCalendarYears(t,e){return this.addCalendarMonths(t,12*e)}addCalendarMonths(t,e){let n=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+e,this.getDate(t));return this.getMonth(n)!=((this.getMonth(t)+e)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}addCalendarDays(t,e){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+e)}toIso8601(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}deserialize(t){if("string"==typeof t){if(!t)return null;if(Rw.test(t)){let e=new Date(t);if(this.isValid(e))return e}}return super.deserialize(t)}isDateInstance(t){return t instanceof Date}isValid(t){return!isNaN(t.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(t,e,n){const r=new Date(t,e,n);return t>=0&&t<100&&r.setFullYear(this.getYear(r)-1900),r}_2digit(t){return("00"+t).slice(-2)}_stripDirectionalityCharacters(t){return t.replace(/[\u200e\u200f]/g,"")}_format(t,e){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.format(n)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cw,8),Jt(Cb))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),Dw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[{provide:Ew,useClass:Nw}],imports:[[Eb]]}),t})();const Pw={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let Mw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[{provide:Sw,useValue:Pw}],imports:[[Dw]]}),t})(),Fw=(()=>{class t{isErrorState(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Lw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw],gw]}),t})();class Bw{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const jw={enterDuration:450,exitDuration:400},Vw=Rb({passive:!0}),Uw=["mousedown","touchstart"],zw=["mouseup","mouseleave","touchend","touchcancel"];class Ww{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=wb(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign(Object.assign({},jw),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const o=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),s=t-r.left,a=e-r.top,u=i.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=`${s-o}px`,c.style.top=`${a-o}px`,c.style.height=`${2*o}px`,c.style.width=`${2*o}px`,null!=n.color&&(c.style.backgroundColor=n.color),c.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(c),window.getComputedStyle(c).getPropertyValue("opacity"),c.style.transform="scale(1)";const l=new Bw(this,c,n);return l.state=0,this._activeRipples.add(l),n.persistent||(this._mostRecentTransientRipple=l),this._runTimeoutOutsideZone(()=>{const t=l===this._mostRecentTransientRipple;l.state=1,n.persistent||t&&this._isPointerDown||l.fadeOut()},u),l}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},jw),t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){const e=wb(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(Uw))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(zw),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=Qb(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(t=>{this._triggerElement.addEventListener(t,this,Vw)})})}_removeTriggerEvents(){this._triggerElement&&(Uw.forEach(t=>{this._triggerElement.removeEventListener(t,this,Vw)}),this._pointerUpEventsRegistered&&zw.forEach(t=>{this._triggerElement.removeEventListener(t,this,Vw)}))}}const qw=new zt("mat-ripple-global-options");let Hw=(()=>{class t{constructor(t,e,n,r,i){this._elementRef=t,this._animationMode=i,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Ww(this,e,t,n)}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(xc),xs(Cb),xs(qw,8),xs(nb,8))},t.\u0275dir=Ce({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&ea("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),t})(),Gw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw,Eb],gw]}),t})(),$w=(()=>{class t{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1}}return t.\u0275fac=function(e){return new(e||t)(xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(t,e){2&t&&ea("mat-pseudo-checkbox-indeterminate","indeterminate"===e.state)("mat-pseudo-checkbox-checked","checked"===e.state)("mat-pseudo-checkbox-disabled",e.disabled)("_mat-animation-noopable","NoopAnimations"===e._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(t,e){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),t})(),Kw=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})();class Xw{}const Yw=vw(Xw);let Qw=0,Jw=(()=>{class t extends Yw{constructor(){super(...arguments),this._labelId=`mat-optgroup-label-${Qw++}`}}return t.\u0275fac=function(e){return Zw(e||t)},t.\u0275cmp=ve({type:t,selectors:[["mat-optgroup"]],hostAttrs:["role","group",1,"mat-optgroup"],hostVars:4,hostBindings:function(t,e){2&t&&(ys("aria-disabled",e.disabled.toString())("aria-labelledby",e._labelId),ea("mat-optgroup-disabled",e.disabled))},inputs:{disabled:"disabled",label:"label"},exportAs:["matOptgroup"],features:[wa],ngContentSelectors:cw,decls:4,vars:2,consts:[[1,"mat-optgroup-label",3,"id"]],template:function(t,e){1&t&&(Ws(uw),ks(0,"label",0),fa(1),qs(2),Ts(),qs(3,1)),2&t&&(Ss("id",e._labelId),di(1),ma("",e.label," "))},styles:[".mat-optgroup-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup-label[disabled]{cursor:default}[dir=rtl] .mat-optgroup-label{text-align:right}.mat-optgroup-label .mat-icon{margin-right:16px;vertical-align:middle}.mat-optgroup-label .mat-icon svg{vertical-align:top}[dir=rtl] .mat-optgroup-label .mat-icon{margin-left:16px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})();const Zw=cr(Jw);let t_=0;class e_{constructor(t,e=!1){this.source=t,this.isUserInput=e}}const n_=new zt("MAT_OPTION_PARENT_COMPONENT");let r_=(()=>{class t{constructor(t,e,n,r){this._element=t,this._changeDetectorRef=e,this._parent=n,this.group=r,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${t_++}`,this.onSelectionChange=new Nu,this._stateChanges=new T}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=mb(t)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(t,e){const n=this._getHostElement();"function"==typeof n.focus&&n.focus(e)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){13!==t.keyCode&&32!==t.keyCode||ob(t)||(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue=t,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new e_(this,t))}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(zo),xs(n_,8),xs(Jw,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(t,e){1&t&&Fs("click",(function(){return e._selectViaInteraction()}))("keydown",(function(t){return e._handleKeydown(t)})),2&t&&(va("id",e.id),ys("tabindex",e._getTabIndex())("aria-selected",e._getAriaSelected())("aria-disabled",e.disabled.toString()),ea("mat-selected",e.selected)("mat-option-multiple",e.multiple)("mat-active",e.active)("mat-option-disabled",e.disabled))},inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:hw,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(t,e){1&t&&(Ws(),ws(0,lw,1,2,"mat-pseudo-checkbox",0),ks(1,"span",1),qs(2),Ts(),As(3,"div",2)),2&t&&(Ss("ngIf",e.multiple),di(3),Ss("matRippleTrigger",e._getHostElement())("matRippleDisabled",e.disabled||e.disableRipple))},directives:[kl,Hw,$w],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})();function i_(t,e,n){if(n.length){let r=e.toArray(),i=n.toArray(),o=0;for(let e=0;e<t+1;e++)r[e].group&&r[e].group===i[o]&&o++;return o}return 0}let o_=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Gw,jl,Kw]]}),t})();const s_=new zt("mat-label-global-options"),a_=["*"],u_=new zt("MAT_GRID_LIST");let c_=(()=>{class t{constructor(t,e){this._element=t,this._gridList=e,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(t){this._rowspan=Math.round(gb(t))}get colspan(){return this._colspan}set colspan(t){this._colspan=Math.round(gb(t))}_setStyle(t,e){this._element.nativeElement.style[t]=e}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(u_,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(t,e){2&t&&ys("rowspan",e.rowspan)("colspan",e.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:a_,decls:2,vars:0,consts:[[1,"mat-figure"]],template:function(t,e){1&t&&(Ws(),ks(0,"figure",0),qs(1),Ts())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-figure{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}\n"],encapsulation:2,changeDetection:0}),t})();class l_{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(t=>this._trackTile(t))}_trackTile(t){const e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new h_(this.rowIndex,e)}_findMatchingGap(t){if(t>this.tracker.length)throw Error(`mat-grid-list: tile with colspan ${t} is wider than `+`grid with cols="${this.tracker.length}".`);let e=-1,n=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)):(e=this.tracker.indexOf(0,this.columnIndex),-1!=e?(n=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)))}while(n-e<t||0==n);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}_markTilePosition(t,e){for(let n=0;n<e.colspan;n++)this.tracker[t+n]=e.rowspan}}class h_{constructor(t,e){this.row=t,this.col=e}}const d_=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class f_{constructor(){this._rows=0,this._rowspan=0}init(t,e,n,r){this._gutterSize=y_(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=n,this._direction=r}getBaseTileSize(t,e){return`(${t}% - (${this._gutterSize} * ${e}))`}getTilePosition(t,e){return 0===e?"0":v_(`(${t} + ${this._gutterSize}) * ${e}`)}getTileSize(t,e){return`(${t} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(t,e,n){let r=100/this._cols,i=(this._cols-1)/this._cols;this.setColStyles(t,n,r,i),this.setRowStyles(t,e,r,i)}setColStyles(t,e,n,r){let i=this.getBaseTileSize(n,r);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(i,e)),t._setStyle("width",v_(this.getTileSize(i,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class p_ extends f_{constructor(t){super(),this.fixedRowHeight=t}init(t,e,n,r){if(super.init(t,e,n,r),this.fixedRowHeight=y_(this.fixedRowHeight),!d_.test(this.fixedRowHeight))throw Error(`Invalid value "${this.fixedRowHeight}" set as rowHeight.`)}setRowStyles(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",v_(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",v_(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}class m_ extends f_{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,e,n,r){this.baseTileHeight=this.getBaseTileSize(n/this.rowHeightRatio,r),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",v_(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",v_(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(t=>{t._setStyle("marginTop",null),t._setStyle("paddingTop",null)})}_parseRatio(t){const e=t.split(":");if(2!==e.length)throw Error(`mat-grid-list: invalid ratio given for row-height: "${t}"`);this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}class g_ extends f_{setRowStyles(t,e){let n=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(n,e)),t._setStyle("height",v_(this.getTileSize(n,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}function v_(t){return`calc(${t})`}function y_(t){return t.match(/([A-Za-z%]+)$/)?t:`${t}px`}let b_=(()=>{class t{constructor(t,e){this._element=t,this._dir=e,this._gutter="1px"}get cols(){return this._cols}set cols(t){this._cols=Math.max(1,Math.round(gb(t)))}get gutterSize(){return this._gutter}set gutterSize(t){this._gutter=`${null==t?"":t}`}get rowHeight(){return this._rowHeight}set rowHeight(t){const e=`${null==t?"":t}`;e!==this._rowHeight&&(this._rowHeight=e,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){if(!this.cols)throw Error('mat-grid-list: must pass in number of columns. Example: <mat-grid-list cols="3">')}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(t){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===t?new g_:t&&t.indexOf(":")>-1?new m_(t):new p_(t)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new l_);const t=this._tileCoordinator,e=this._tiles.filter(t=>!t._gridList||t._gridList===this),n=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,e),this._tileStyler.init(this.gutterSize,t,this.cols,n),e.forEach((e,n)=>{const r=t.positions[n];this._tileStyler.setStyle(e,r.row,r.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(t){t&&(this._element.nativeElement.style[t[0]]=t[1])}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(ow,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-grid-list"]],contentQueries:function(t,e,n){var r;1&t&&$u(n,c_,!0),2&t&&Wu(r=Yu())&&(e._tiles=r)},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(t,e){2&t&&ys("cols",e.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[Fa([{provide:u_,useExisting:t}])],ngContentSelectors:a_,decls:2,vars:0,template:function(t,e){1&t&&(Ws(),ks(0,"div"),qs(1),Ts())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-figure{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}\n"],encapsulation:2,changeDetection:0}),t})(),w_=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Lw,gw],Lw,gw]}),t})(),__=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,gw],gw]}),t})();const x_=["mat-button",""],C_=["*"],E_=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class S_{constructor(t){this._elementRef=t}}const I_=yw(vw(bw(S_)));let k_=(()=>{class t extends I_{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of E_)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);t.nativeElement.classList.add("mat-button-base"),this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color="accent")}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",e){this._focusMonitor.focusVia(this._getHostElement(),t,e)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(tw),xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,e){var n;1&t&&Hu(Hw,!0),2&t&&Wu(n=Yu())&&(e.ripple=n.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:3,hostBindings:function(t,e){2&t&&(ys("disabled",e.disabled||null),ea("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[wa],attrs:x_,ngContentSelectors:C_,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(Ws(),ks(0,"span",0),qs(1),Ts(),As(2,"div",1),As(3,"div",2)),2&t&&(di(2),ea("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Ss("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[Hw],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),t})(),T_=(()=>{class t extends k_{constructor(t,e,n){super(e,t,n)}_haltDisabledEvents(t){this.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}}return t.\u0275fac=function(e){return new(e||t)(xs(tw),xs(Va),xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,e){1&t&&Fs("click",(function(t){return e._haltDisabledEvents(t)})),2&t&&(ys("tabindex",e.disabled?-1:e.tabIndex||0)("disabled",e.disabled||null)("aria-disabled",e.disabled.toString()),ea("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[wa],attrs:x_,ngContentSelectors:C_,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(Ws(),ks(0,"span",0),qs(1),Ts(),As(2,"div",1),As(3,"div",2)),2&t&&(di(2),ea("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Ss("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[Hw],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),t})(),A_=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Gw,gw],gw]}),t})();function R_(t,e,n,r){return s(n)&&(r=n,n=void 0),r?R_(t,e,n).pipe(V(t=>h(t)?r(...t):r(t))):new C(r=>{!function t(e,n,r,i,o){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(n,r,o),s=()=>t.removeEventListener(n,r,o)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(n,r),s=()=>t.off(n,r)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(n,r),s=()=>t.removeListener(n,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let s=0,a=e.length;s<a;s++)t(e[s],n,r,i,o)}i.add(s)}(t,e,(function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),r,n)})}let O_=1;const N_=(()=>Promise.resolve())(),D_={};function P_(t){return t in D_&&(delete D_[t],!0)}const M_={setImmediate(t){const e=O_++;return D_[e]=!0,N_.then(()=>P_(e)&&t()),e},clearImmediate(t){P_(t)}};class F_ extends ab{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=M_.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(M_.clearImmediate(e),t.scheduled=void 0)}}class L_ extends cb{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}const B_=new L_(F_);function j_(t,e){return n=>n.lift(new V_(t,e))}class V_{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new U_(t,this.compare,this.keySelector))}}class U_ extends v{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}class z_{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new W_(t,this.durationSelector))}}class W_ extends j{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:e}=this;n=e(t)}catch(e){return this.destination.error(e)}const r=B(this,n);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}notifyNext(t,e,n,r){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function q_(t){return!h(t)&&t-parseFloat(t)+1>=0}function H_(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function G_(t,e=lb){return n=()=>function(t=0,e,n){let r=-1;return q_(e)?r=Number(e)<1?1:Number(e):R(e)&&(n=e),R(n)||(n=lb),new C(e=>{const i=q_(t)?t:+t-n.now();return n.schedule(H_,i,{index:0,period:r,subscriber:e})})}(t,e),function(t){return t.lift(new z_(n))};var n}function $_(t){return e=>e.lift(new K_(t))}class K_{constructor(t){this.notifier=t}call(t,e){const n=new X_(t),r=B(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class X_ extends j{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}class Y_ extends ab{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}class Q_ extends cb{}const J_=new Q_(Y_);function Z_(t,e){return new C(e?n=>e.schedule(tx,0,{error:t,subscriber:n}):e=>e.error(t))}function tx({error:t,subscriber:e}){e.error(t)}let ex=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return Zd(this.value);case"E":return Z_(this.error);case"C":return uf()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();function nx(t,e=0){return function(n){return n.lift(new rx(t,e))}}class rx{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new ix(t,this.scheduler,this.delay))}}class ix extends v{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(ix.dispatch,this.delay,new ox(t,this.destination)))}_next(t){this.scheduleMessage(ex.createNext(t))}_error(t){this.scheduleMessage(ex.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(ex.createComplete()),this.unsubscribe()}}class ox{constructor(t,e){this.notification=t,this.destination=e}}function sx(t){return t&&"function"==typeof t.connect}class ax{constructor(t=!1,e,n=!0){this._multiple=t,this._emitChanges=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new T,e&&e.length&&(t?e.forEach(t=>this._markSelected(t)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(t=>this._markSelected(t)),this._emitChangeEvent()}deselect(...t){this._verifyValueAssignment(t),t.forEach(t=>this._unmarkSelected(t)),this._emitChangeEvent()}toggle(t){this.isSelected(t)?this.deselect(t):this.select(t)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(t){return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){if(t.length>1&&!this._multiple)throw Error("Cannot pass multiple values into SelectionModel with single-value mode.")}}let ux=(()=>{class t{constructor(t,e,n){this._ngZone=t,this._platform=e,this._scrolled=new T,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new C(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(G_(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Zd()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(hf(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>R_(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Jt(xc),Jt(Cb),Jt(el,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(xc),Jt(Cb),Jt(el,8))},token:t,providedIn:"root"}),t})(),cx=(()=>{class t{constructor(t,e,n,r){this.elementRef=t,this.scrollDispatcher=e,this.ngZone=n,this.dir=r,this._destroyed=new T,this._elementScrolled=new C(t=>this.ngZone.runOutsideAngular(()=>R_(this.elementRef.nativeElement,"scroll").pipe($_(this._destroyed)).subscribe(t)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const e=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=n?t.end:t.start),null==t.right&&(t.right=n?t.start:t.end),null!=t.bottom&&(t.top=e.scrollHeight-e.clientHeight-t.bottom),n&&0!=Ob()?(null!=t.left&&(t.right=e.scrollWidth-e.clientWidth-t.left),2==Ob()?t.left=t.right:1==Ob()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=e.scrollWidth-e.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const e=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?e.scrollTo(t):(null!=t.top&&(e.scrollTop=t.top),null!=t.left&&(e.scrollLeft=t.left))}measureScrollOffset(t){const e=this.elementRef.nativeElement;if("top"==t)return e.scrollTop;if("bottom"==t)return e.scrollHeight-e.clientHeight-e.scrollTop;const n=this.dir&&"rtl"==this.dir.value;return"start"==t?t=n?"right":"left":"end"==t&&(t=n?"left":"right"),n&&2==Ob()?"left"==t?e.scrollWidth-e.clientWidth-e.scrollLeft:e.scrollLeft:n&&1==Ob()?"left"==t?e.scrollLeft+e.scrollWidth-e.clientWidth:-e.scrollLeft:"left"==t?e.scrollLeft:e.scrollWidth-e.clientWidth-e.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(ux),xs(xc),xs(ow,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),lx=(()=>{class t{constructor(t,e,n){this._platform=t,this._document=n,e.runOutsideAngular(()=>{const e=this._getWindow();this._change=t.isBrowser?Y(R_(e,"resize"),R_(e,"orientationchange")):Zd(),this._invalidateCache=this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){this._invalidateCache.unsubscribe()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._getDocument(),e=this._getWindow(),n=t.documentElement,r=n.getBoundingClientRect();return{top:-r.top||t.body.scrollTop||e.scrollY||n.scrollTop||0,left:-r.left||t.body.scrollLeft||e.scrollX||n.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(G_(t)):this._change}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cb),Jt(xc),Jt(el,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(Cb),Jt(xc),Jt(el,8))},token:t,providedIn:"root"}),t})(),hx=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})(),dx=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[sw,Eb,hx],sw,hx]}),t})();function fx(){throw Error("Host already has a portal attached")}class px{attach(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&fx(),this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class mx extends px{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class gx extends px{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class vx extends px{constructor(t){super(),this.element=t instanceof Va?t.nativeElement:t}}class yx{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&fx(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof mx?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof gx?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof vx?(this._attachedPortal=t,this.attachDomPortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class bx extends yx{constructor(t,e,n,r,i){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=i}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.detectChanges(),n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let wx=(()=>{class t extends yx{constructor(t,e,n){super(),this._componentFactoryResolver=t,this._viewContainerRef=e,this._isInitialized=!1,this.attached=new Nu,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");t.setAttachedHost(this),e.parentNode.insertBefore(n,e),this._getRootNode().appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=n}get portal(){return this._attachedPortal}set portal(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),r=e.createComponent(n,e.length,t.injector||e.injector);return e!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const e=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=e,this.attached.emit(e),e}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return t.\u0275fac=function(e){return new(e||t)(xs(ja),xs(du),xs(el))},t.\u0275dir=Ce({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[wa]}),t})(),_x=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})();class xx{constructor(t,e){this._parentInjector=t,this._customTokens=e}get(t,e){const n=this._customTokens.get(t);return void 0!==n?n:this._parentInjector.get(t,e)}}class Cx{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=bb(-this._previousScrollPosition.left),t.style.top=bb(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}function Ex(){return Error("Scroll strategy has already been attached.")}class Sx{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){if(this._overlayRef)throw Ex();this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Ix{enable(){}disable(){}attach(){}}function kx(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function Tx(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class Ax{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){if(this._overlayRef)throw Ex();this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();kx(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Rx=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new Ix,this.close=t=>new Sx(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new Cx(this._viewportRuler,this._document),this.reposition=t=>new Ax(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.\u0275fac=function(e){return new(e||t)(Jt(ux),Jt(lx),Jt(xc),Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(ux),Jt(lx),Jt(xc),Jt(el))},token:t,providedIn:"root"}),t})();class Ox{constructor(t){if(this.scrollStrategy=new Ix,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Nx{constructor(t,e,n,r,i){this.offsetX=n,this.offsetY=r,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class Dx{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}function Px(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "top", "bottom" or "center".')}function Mx(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "start", "end" or "center".')}let Fx=(()=>{class t{constructor(t){this._attachedOverlays=[],this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEvents.observers.length>0){e[n]._keydownEvents.next(t);break}},this._document=t}ngOnDestroy(){this._detach()}add(t){this.remove(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this._detach()}_detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(el))},token:t,providedIn:"root"}),t})();const Lx=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine);let Bx=(()=>{class t{constructor(t,e){this._platform=e,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(t||Lx){const t=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]');for(let e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])}const e=this._document.createElement("div");e.classList.add("cdk-overlay-container"),Lx?e.setAttribute("platform","test"):t||e.setAttribute("platform","server"),this._document.body.appendChild(e),this._containerElement=e}}return t.\u0275fac=function(e){return new(e||t)(Jt(el),Jt(Cb))},t.\u0275prov=pt({factory:function(){return new t(Jt(el),Jt(Cb))},token:t,providedIn:"root"}),t})();class jx{constructor(t,e,n,r,i,o,s,a){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=i,this._keyboardDispatcher=o,this._document=s,this._location=a,this._backdropElement=null,this._backdropClick=new T,this._attachments=new T,this._detachments=new T,this._locationChanges=p.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEvents=new T,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(Af(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEvents.asObservable()}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=bb(this._config.width),t.height=bb(this._config.height),t.minWidth=bb(this._config.minWidth),t.minHeight=bb(this._config.minHeight),t.maxWidth=bb(this._config.maxWidth),t.maxHeight=bb(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;yb(e).forEach(t=>{t&&(n?r.add(t):r.remove(t))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.asObservable().pipe($_(Y(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const Vx=/([A-Za-z%]+)$/;class Ux{constructor(t,e,n,r,i){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new T,this._resizeSubscription=p.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let i;for(let o of this._preferredPositions){let s=this._getOriginPoint(t,o),a=this._getOverlayPoint(s,e,o),u=this._getOverlayFit(a,e,n,o);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,s);this._canFitWithFlexibleDimensions(u,a,n)?r.push({position:o,origin:s,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(s,o)}):(!i||i.overlayFit.visibleArea<u.visibleArea)&&(i={overlayFit:u,overlayPoint:a,originPoint:s,position:o,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(i.position,i.originPoint);this._applyPosition(i.position,i.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&zx(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom,{x:n,y:r}}_getOverlayPoint(t,e,n){let r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+i}}_getOverlayFit(t,e,n,r){let{x:i,y:o}=t,s=this._getOffset(r,"x"),a=this._getOffset(r,"y");s&&(i+=s),a&&(o+=a);let u=0-o,c=o+e.height-n.height,l=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,u,c),d=l*h;return{visibleArea:d,isCompletelyWithinViewport:e.width*e.height===d,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:l==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,i=n.right-e.x,o=Wx(this._overlayRef.getConfig().minHeight),s=Wx(this._overlayRef.getConfig().minWidth),a=t.fitsInViewportHorizontally||null!=s&&s<=i;return(t.fitsInViewportVertically||null!=o&&o<=r)&&a}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,i=Math.max(t.x+e.width-r.right,0),o=Math.max(t.y+e.height-r.bottom,0),s=Math.max(r.top-n.top-t.y,0),a=Math.max(r.left-n.left-t.x,0);let u=0,c=0;return u=e.width<=r.width?a||-i:t.x<this._viewportMargin?r.left-n.left-t.x:0,c=e.height<=r.height?s||-o:t.y<this._viewportMargin?r.top-n.top-t.y:0,this._previousPushAmount={x:u,y:c},{x:t.x+u,y:t.y+c}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new Dx(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let i,o,s,a,u,c;if("top"===e.overlayY)o=t.y,i=n.height-o+this._viewportMargin;else if("bottom"===e.overlayY)s=n.height-t.y+2*this._viewportMargin,i=n.height-s+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;i=2*e,o=t.y-e,i>r&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)c=n.width-t.x+this._viewportMargin,a=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)u=t.x,a=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;a=2*e,u=t.x-e,a>r&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-r/2)}return{top:o,left:u,bottom:s,right:c,width:a,height:i}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=bb(n.height),r.top=bb(n.top),r.bottom=bb(n.bottom),r.width=bb(n.width),r.left=bb(n.left),r.right=bb(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=bb(t)),i&&(r.maxWidth=bb(i))}this._lastBoundingBoxSize=n,zx(this._boundingBox.style,r)}_resetBoundingBoxStyles(){zx(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){zx(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),i=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const r=this._viewportRuler.getViewportScrollPosition();zx(n,this._getExactOverlayY(e,t,r)),zx(n,this._getExactOverlayX(e,t,r))}else n.position="static";let s="",a=this._getOffset(e,"x"),u=this._getOffset(e,"y");a&&(s+=`translateX(${a}px) `),u&&(s+=`translateY(${u}px)`),n.transform=s.trim(),o.maxHeight&&(r?n.maxHeight=bb(o.maxHeight):i&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=bb(o.maxWidth):i&&(n.maxWidth="")),zx(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=o,"bottom"===t.overlayY?r.bottom=`${this._document.documentElement.clientHeight-(i.y+this._overlayRect.height)}px`:r.top=bb(i.y),r}_getExactOverlayX(t,e,n){let r,i={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===r?i.right=`${this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)}px`:i.left=bb(o.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Tx(t,n),isOriginOutsideView:kx(t,n),isOverlayClipped:Tx(e,n),isOverlayOutsideView:kx(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(t=>{Mx("originX",t.originX),Px("originY",t.originY),Mx("overlayX",t.overlayX),Px("overlayY",t.overlayY)})}_addPanelClasses(t){this._pane&&yb(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof Va)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function zx(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Wx(t){if("number"!=typeof t&&null!=t){const[e,n]=t.split(Vx);return n&&"px"!==n?null:parseFloat(e)}return t||null}class qx{constructor(t,e,n,r,i,o,s){this._preferredPositions=[],this._positionStrategy=new Ux(n,r,i,o,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e)}get _isRtl(){return"rtl"===this._overlayRef.getDirection()}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const i=new Nx(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}class Hx{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:i,maxWidth:o,maxHeight:s}=n,a=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==i&&"100vh"!==i||s&&"100%"!==s&&"100vh"!==s);t.position=this._cssPosition,t.marginLeft=a?"0":this._leftOffset,t.marginTop=u?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,a?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let Gx=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new Hx}connectedTo(t,e,n){return new qx(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new Ux(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.\u0275fac=function(e){return new(e||t)(Jt(lx),Jt(el),Jt(Cb),Jt(Bx))},t.\u0275prov=pt({factory:function(){return new t(Jt(lx),Jt(el),Jt(Cb),Jt(Bx))},token:t,providedIn:"root"}),t})(),$x=0,Kx=(()=>{class t{constructor(t,e,n,r,i,o,s,a,u,c){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=i,this._injector=o,this._ngZone=s,this._document=a,this._directionality=u,this._location=c}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new Ox(t);return i.direction=i.direction||this._directionality.value,new jx(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id=`cdk-overlay-${$x++}`,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(zc)),new bx(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Rx),Jt(Bx),Jt(ja),Jt(Gx),Jt(Fx),Jt(is),Jt(xc),Jt(el),Jt(ow),Jt(gl,8))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const Xx=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Yx=new zt("cdk-connected-overlay-scroll-strategy");let Qx=(()=>{class t{constructor(t){this.elementRef=t}}return t.\u0275fac=function(e){return new(e||t)(xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),t})(),Jx=(()=>{class t{constructor(t,e,n,r,i){this._overlay=t,this._dir=i,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=p.EMPTY,this.viewportMargin=0,this.open=!1,this.backdropClick=new Nu,this.positionChange=new Nu,this.attach=new Nu,this.detach=new Nu,this.overlayKeydown=new Nu,this._templatePortal=new gx(e,n),this._scrollStrategyFactory=r,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=mb(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=mb(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=mb(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=mb(t)}get push(){return this._push}set push(t){this._push=mb(t)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._overlayRef&&this._overlayRef.dispose(),this._backdropSubscription.unsubscribe()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){this.positions&&this.positions.length||(this.positions=Xx),this._overlayRef=this._overlay.create(this._buildConfig()),this._overlayRef.keydownEvents().subscribe(t=>{this.overlayKeydown.next(t),27!==t.keyCode||ob(t)||(t.preventDefault(),this._detachOverlay())})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),e=new Ox({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(e.width=this.width),(this.height||0===this.height)&&(e.height=this.height),(this.minWidth||0===this.minWidth)&&(e.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(e.minHeight=this.minHeight),this.backdropClass&&(e.backdropClass=this.backdropClass),this.panelClass&&(e.panelClass=this.panelClass),e}_updatePositionStrategy(t){const e=this.positions.map(t=>({originX:t.originX,originY:t.originY,overlayX:t.overlayX,overlayY:t.overlayY,offsetX:t.offsetX||this.offsetX,offsetY:t.offsetY||this.offsetY,panelClass:t.panelClass||void 0}));return t.setOrigin(this.origin.elementRef).withPositions(e).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(t),t.positionChanges.subscribe(t=>this.positionChange.emit(t)),t}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||(this._overlayRef.attach(this._templatePortal),this.attach.emit()),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe()}_detachOverlay(){this._overlayRef&&(this._overlayRef.detach(),this.detach.emit()),this._backdropSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(xs(Kx),xs(lu),xs(du),xs(Yx),xs(ow,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown"},exportAs:["cdkConnectedOverlay"],features:[Ia]}),t})();const Zx={provide:Yx,deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let tC=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Kx,Zx],imports:[[sw,_x,dx],dx]}),t})();const eC=["underline"],nC=["connectionContainer"],rC=["inputContainer"],iC=["label"];function oC(t,e){1&t&&(Rs(0),ks(1,"div",14),As(2,"div",15),As(3,"div",16),As(4,"div",17),Ts(),ks(5,"div",18),As(6,"div",15),As(7,"div",16),As(8,"div",17),Ts(),Os())}function sC(t,e){1&t&&(ks(0,"div",19),qs(1,1),Ts())}function aC(t,e){if(1&t&&(Rs(0),qs(1,2),ks(2,"span"),fa(3),Ts(),Os()),2&t){const t=Us(2);di(3),pa(t._control.placeholder)}}function uC(t,e){1&t&&qs(0,3,["*ngSwitchCase","true"])}function cC(t,e){1&t&&(ks(0,"span",23),fa(1," *"),Ts())}function lC(t,e){if(1&t){const t=Ds();ks(0,"label",20,21),Fs("cdkObserveContent",(function(){return Ze(t),Us().updateOutlineGap()})),ws(2,aC,4,1,"ng-container",12),ws(3,uC,1,0,void 0,12),ws(4,cC,2,0,"span",22),Ts()}if(2&t){const t=Us();ea("mat-empty",t._control.empty&&!t._shouldAlwaysFloat)("mat-form-field-empty",t._control.empty&&!t._shouldAlwaysFloat)("mat-accent","accent"==t.color)("mat-warn","warn"==t.color),Ss("cdkObserveContentDisabled","outline"!=t.appearance)("id",t._labelId)("ngSwitch",t._hasLabel()),ys("for",t._control.id)("aria-owns",t._control.id),di(2),Ss("ngSwitchCase",!1),di(1),Ss("ngSwitchCase",!0),di(1),Ss("ngIf",!t.hideRequiredMarker&&t._control.required&&!t._control.disabled)}}function hC(t,e){1&t&&(ks(0,"div",24),qs(1,4),Ts())}function dC(t,e){if(1&t&&(ks(0,"div",25,26),As(2,"span",27),Ts()),2&t){const t=Us();di(2),ea("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)}}function fC(t,e){1&t&&(ks(0,"div"),qs(1,5),Ts()),2&t&&Ss("@transitionMessages",Us()._subscriptAnimationState)}function pC(t,e){if(1&t&&(ks(0,"div",31),fa(1),Ts()),2&t){const t=Us(2);Ss("id",t._hintLabelId),di(1),pa(t.hintLabel)}}function mC(t,e){if(1&t&&(ks(0,"div",28),ws(1,pC,2,2,"div",29),qs(2,6),As(3,"div",30),qs(4,7),Ts()),2&t){const t=Us();Ss("@transitionMessages",t._subscriptAnimationState),di(1),Ss("ngIf",t.hintLabel)}}const gC=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],vC=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"];let yC=0,bC=(()=>{class t{constructor(){this.id=`mat-error-${yC++}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-error"]],hostAttrs:["role","alert",1,"mat-error"],hostVars:1,hostBindings:function(t,e){2&t&&ys("id",e.id)},inputs:{id:"id"}}),t})();const wC={transitionMessages:Fg("transitionMessages",[Vg("enter",jg({opacity:1,transform:"translateY(0%)"})),zg("void => enter",[jg({opacity:0,transform:"translateY(-100%)"}),Lg("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let _C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t}),t})();function xC(t){return Error(`A hint was already declared for 'align="${t}"'.`)}let CC=0,EC=(()=>{class t{constructor(){this.align="start",this.id=`mat-hint-${CC++}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(t,e){2&t&&(ys("id",e.id)("align",null),ea("mat-right","end"==e.align))},inputs:{align:"align",id:"id"}}),t})(),SC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-label"]]}),t})(),IC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-placeholder"]]}),t})(),kC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matPrefix",""]]}),t})(),TC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matSuffix",""]]}),t})(),AC=0;class RC{constructor(t){this._elementRef=t}}const OC=yw(RC,"primary"),NC=new zt("MAT_FORM_FIELD_DEFAULT_OPTIONS"),DC=new zt("MatFormField");let PC=(()=>{class t extends OC{constructor(t,e,n,r,i,o,s,a){super(t),this._elementRef=t,this._changeDetectorRef=e,this._dir=r,this._defaults=i,this._platform=o,this._ngZone=s,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new T,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId=`mat-hint-${AC++}`,this._labelId=`mat-form-field-label-${AC++}`,this._labelOptions=n||{},this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==a,this.appearance=i&&i.appearance?i.appearance:"legacy",this._hideRequiredMarker=!(!i||null==i.hideRequiredMarker)&&i.hideRequiredMarker}get appearance(){return this._appearance}set appearance(t){const e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=mb(t)}get _shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}get _canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}get _labelChild(){return this._labelChildNonStatic||this._labelChildStatic}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${t.controlType}`),t.stateChanges.pipe(jf(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe($_(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.asObservable().pipe($_(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),Y(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(jf(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(jf(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe($_(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const e=this._control?this._control.ngControl:null;return e&&e[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!!this._labelChild}_shouldLabelFloat(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,R_(this._label.nativeElement,"transitionend").pipe(Af(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){if(this._hintChildren){let t,e;this._hintChildren.forEach(n=>{if("start"===n.align){if(t||this.hintLabel)throw xC("start");t=n}else if("end"===n.align){if(e)throw xC("end");e=n}})}}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}_syncDescribedByIds(){if(this._control){let t=[];if("hint"===this._getDisplayedMessages()){const e=this._hintChildren?this._hintChildren.find(t=>"start"===t.align):null,n=this._hintChildren?this._hintChildren.find(t=>"end"===t.align):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&(t=this._errorChildren.map(t=>t.id));this._control.setDescribedByIds(t)}}_validateControlChild(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}updateOutlineGap(){const t=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!t||!t.children.length||!t.textContent.trim())return;if(!this._platform.isBrowser)return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let e=0,n=0;const r=this._connectionContainerRef.nativeElement,i=r.querySelectorAll(".mat-form-field-outline-start"),o=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const i=r.getBoundingClientRect();if(0===i.width&&0===i.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const o=this._getStartEnd(i),s=this._getStartEnd(t.children[0].getBoundingClientRect());let a=0;for(const e of t.children)a+=e.offsetWidth;e=Math.abs(s-o)-5,n=a>0?.75*a+10:0}for(let s=0;s<i.length;s++)i[s].style.width=`${e}px`;for(let s=0;s<o.length;s++)o[s].style.width=`${n}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}_isAttachedToDOM(){const t=this._elementRef.nativeElement;if(t.getRootNode){const e=t.getRootNode();return e&&e!==t}return document.documentElement.contains(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(zo),xs(s_,8),xs(ow,8),xs(NC,8),xs(Cb),xs(xc),xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-form-field"]],contentQueries:function(t,e,n){var r;1&t&&($u(n,_C,!0),Ku(n,_C,!0),$u(n,SC,!0),Ku(n,SC,!0),$u(n,IC,!0),$u(n,bC,!0),$u(n,EC,!0),$u(n,kC,!0),$u(n,TC,!0)),2&t&&(Wu(r=Yu())&&(e._controlNonStatic=r.first),Wu(r=Yu())&&(e._controlStatic=r.first),Wu(r=Yu())&&(e._labelChildNonStatic=r.first),Wu(r=Yu())&&(e._labelChildStatic=r.first),Wu(r=Yu())&&(e._placeholderChild=r.first),Wu(r=Yu())&&(e._errorChildren=r),Wu(r=Yu())&&(e._hintChildren=r),Wu(r=Yu())&&(e._prefixChildren=r),Wu(r=Yu())&&(e._suffixChildren=r))},viewQuery:function(t,e){var n;1&t&&(Hu(eC,!0),qu(nC,!0),Hu(rC,!0),Hu(iC,!0)),2&t&&(Wu(n=Yu())&&(e.underlineRef=n.first),Wu(n=Yu())&&(e._connectionContainerRef=n.first),Wu(n=Yu())&&(e._inputContainerRef=n.first),Wu(n=Yu())&&(e._label=n.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(t,e){2&t&&ea("mat-form-field-appearance-standard","standard"==e.appearance)("mat-form-field-appearance-fill","fill"==e.appearance)("mat-form-field-appearance-outline","outline"==e.appearance)("mat-form-field-appearance-legacy","legacy"==e.appearance)("mat-form-field-invalid",e._control.errorState)("mat-form-field-can-float",e._canLabelFloat)("mat-form-field-should-float",e._shouldLabelFloat())("mat-form-field-has-label",e._hasFloatingLabel())("mat-form-field-hide-placeholder",e._hideControlPlaceholder())("mat-form-field-disabled",e._control.disabled)("mat-form-field-autofilled",e._control.autofilled)("mat-focused",e._control.focused)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)("ng-untouched",e._shouldForward("untouched"))("ng-touched",e._shouldForward("touched"))("ng-pristine",e._shouldForward("pristine"))("ng-dirty",e._shouldForward("dirty"))("ng-valid",e._shouldForward("valid"))("ng-invalid",e._shouldForward("invalid"))("ng-pending",e._shouldForward("pending"))("_mat-animation-noopable",!e._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Fa([{provide:DC,useExisting:t}]),wa],ngContentSelectors:vC,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,e){1&t&&(Ws(gC),ks(0,"div",0),ks(1,"div",1,2),Fs("click",(function(t){return e._control.onContainerClick&&e._control.onContainerClick(t)})),ws(3,oC,9,0,"ng-container",3),ws(4,sC,2,0,"div",4),ks(5,"div",5,6),qs(7),ks(8,"span",7),ws(9,lC,5,16,"label",8),Ts(),Ts(),ws(10,hC,2,0,"div",9),Ts(),ws(11,dC,3,4,"div",10),ks(12,"div",11),ws(13,fC,2,1,"div",12),ws(14,mC,5,2,"div",13),Ts(),Ts()),2&t&&(di(3),Ss("ngIf","outline"==e.appearance),di(1),Ss("ngIf",e._prefixChildren.length),di(5),Ss("ngIf",e._hasFloatingLabel()),di(1),Ss("ngIf",e._suffixChildren.length),di(1),Ss("ngIf","outline"!=e.appearance),di(1),Ss("ngSwitch",e._getDisplayedMessages()),di(1),Ss("ngSwitchCase","error"),di(1),Ss("ngSwitchCase","hint"))},directives:[kl,Ol,Nl,Mb],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[wC.transitionMessages]},changeDetection:0}),t})(),MC=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,gw,Fb],gw]}),t})();const FC=["trigger"],LC=["panel"];function BC(t,e){if(1&t&&(ks(0,"span",8),fa(1),Ts()),2&t){const t=Us();di(1),pa(t.placeholder||"\xa0")}}function jC(t,e){if(1&t&&(ks(0,"span"),fa(1),Ts()),2&t){const t=Us(2);di(1),pa(t.triggerValue||"\xa0")}}function VC(t,e){1&t&&qs(0,0,["*ngSwitchCase","true"])}function UC(t,e){1&t&&(ks(0,"span",9),ws(1,jC,2,1,"span",10),ws(2,VC,1,0,void 0,11),Ts()),2&t&&(Ss("ngSwitch",!!Us().customTrigger),di(2),Ss("ngSwitchCase",!0))}function zC(t,e){if(1&t){const t=Ds();ks(0,"div",12),ks(1,"div",13,14),Fs("@transformPanel.done",(function(e){return Ze(t),Us()._panelDoneAnimatingStream.next(e.toState)}))("keydown",(function(e){return Ze(t),Us()._handleKeydown(e)})),qs(3,1),Ts(),Ts()}if(2&t){const t=Us();Ss("@transformPanelWrap",void 0),di(1),"mat-select-panel ",n=t._getPanelTheme(),"",ia(ce,na,bs(Qe(),"mat-select-panel ",n,""),!0),ta("transform-origin",t._transformOrigin)("font-size",t._triggerFontSize,"px"),Ss("ngClass",t.panelClass)("@transformPanel",t.multiple?"showing-multiple":"showing"),ys("id",t.id+"-panel")}var n}const WC=[[["mat-select-trigger"]],"*"],qC=["mat-select-trigger","*"],HC={transformPanelWrap:Fg("transformPanelWrap",[zg("* => void",qg("@transformPanel",[Wg()],{optional:!0}))]),transformPanel:Fg("transformPanel",[Vg("void",jg({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Vg("showing",jg({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Vg("showing-multiple",jg({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),zg("void => *",Lg("120ms cubic-bezier(0, 0, 0.2, 1)")),zg("* => void",Lg("100ms 25ms linear",jg({opacity:0})))])};let GC=0;const $C=new zt("mat-select-scroll-strategy"),KC=new zt("MAT_SELECT_CONFIG"),XC={provide:$C,deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};class YC{constructor(t,e){this.source=t,this.value=e}}class QC{constructor(t,e,n,r,i){this._elementRef=t,this._defaultErrorStateMatcher=e,this._parentForm=n,this._parentFormGroup=r,this.ngControl=i}}const JC=bw(ww(vw(_w(QC))));let ZC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-select-trigger"]]}),t})(),tE=(()=>{class t extends JC{constructor(t,e,n,r,i,o,s,a,u,c,l,h,d,f){super(i,r,s,a,c),this._viewportRuler=t,this._changeDetectorRef=e,this._ngZone=n,this._dir=o,this._parentFormField=u,this.ngControl=c,this._liveAnnouncer=d,this._panelOpen=!1,this._required=!1,this._scrollTop=0,this._multiple=!1,this._compareWith=(t,e)=>t===e,this._uid=`mat-select-${GC++}`,this._destroy=new T,this._triggerFontSize=0,this._onChange=()=>{},this._onTouched=()=>{},this._optionIds="",this._transformOrigin="top",this._panelDoneAnimatingStream=new T,this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],this._disableOptionCentering=!1,this._focused=!1,this.controlType="mat-select",this.ariaLabel="",this.optionSelectionChanges=cf(()=>{const t=this.options;return t?t.changes.pipe(jf(t),Mf(()=>Y(...t.map(t=>t.onSelectionChange)))):this._ngZone.onStable.asObservable().pipe(Af(1),Mf(()=>this.optionSelectionChanges))}),this.openedChange=new Nu,this._openedStream=this.openedChange.pipe(hf(t=>t),V(()=>{})),this._closedStream=this.openedChange.pipe(hf(t=>!t),V(()=>{})),this.selectionChange=new Nu,this.valueChange=new Nu,this.ngControl&&(this.ngControl.valueAccessor=this),this._scrollStrategyFactory=h,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(l)||0,this.id=this.id,f&&(null!=f.disableOptionCentering&&(this.disableOptionCentering=f.disableOptionCentering),null!=f.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=f.typeaheadDebounceInterval))}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required}set required(t){this._required=mb(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){if(this._selectionModel)throw Error("Cannot change `multiple` mode of select after initialization.");this._multiple=mb(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=mb(t)}get compareWith(){return this._compareWith}set compareWith(t){if("function"!=typeof t)throw Error("`compareWith` must be a function.");this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){t!==this._value&&(this.writeValue(t),this._value=t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=gb(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new ax(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(j_(),$_(this._destroy)).subscribe(()=>{this.panelOpen?(this._scrollTop=0,this.openedChange.emit(!0)):(this.openedChange.emit(!1),this.overlayDir.offsetX=0,this._changeDetectorRef.markForCheck())}),this._viewportRuler.change().pipe($_(this._destroy)).subscribe(()=>{this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe($_(this._destroy)).subscribe(t=>{t.added.forEach(t=>t.select()),t.removed.forEach(t=>t.deselect())}),this.options.changes.pipe(jf(null),$_(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){this.ngControl&&this.updateErrorState()}ngOnChanges(t){t.disabled&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.asObservable().pipe(Af(1)).subscribe(()=>{this._triggerFontSize&&this.overlayDir.overlayRef&&this.overlayDir.overlayRef.overlayElement&&(this.overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this.options&&this._setSelectionByValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(t=>t.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const e=t.keyCode,n=40===e||38===e||37===e||39===e,r=13===e||32===e,i=this._keyManager;if(!i.isTyping()&&r&&!ob(t)||(this.multiple||t.altKey)&&n)t.preventDefault(),this.open();else if(!this.multiple){const n=this.selected;36===e||35===e?(36===e?i.setFirstItemActive():i.setLastItemActive(),t.preventDefault()):i.onKeydown(t);const r=this.selected;r&&n!==r&&this._liveAnnouncer.announce(r.viewValue,1e4)}}_handleOpenKeydown(t){const e=this._keyManager,n=t.keyCode,r=40===n||38===n,i=e.isTyping();if(36===n||35===n)t.preventDefault(),36===n?e.setFirstItemActive():e.setLastItemActive();else if(r&&t.altKey)t.preventDefault(),this.close();else if(i||13!==n&&32!==n||!e.activeItem||ob(t))if(!i&&this._multiple&&65===n&&t.ctrlKey){t.preventDefault();const e=this.options.some(t=>!t.disabled&&!t.selected);this.options.forEach(t=>{t.disabled||(e?t.select():t.deselect())})}else{const n=e.activeItemIndex;e.onKeydown(t),this._multiple&&r&&t.shiftKey&&e.activeItem&&e.activeItemIndex!==n&&e.activeItem._selectViaInteraction()}else t.preventDefault(),e.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this.overlayDir.positionChange.pipe(Af(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.multiple&&t){if(!Array.isArray(t))throw Error("Value must be an array in multiple-selection mode.");this._selectionModel.clear(),t.forEach(t=>this._selectValue(t)),this._sortValues()}else{this._selectionModel.clear();const e=this._selectValue(t);e?this._keyManager.setActiveItem(e):this.panelOpen||this._keyManager.setActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectValue(t){const e=this.options.find(e=>{try{return null!=e.value&&this._compareWith(e.value,t)}catch(n){return Sr()&&console.warn(n),!1}});return e&&this._selectionModel.select(e),e}_initKeyManager(){this._keyManager=new zb(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe($_(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe($_(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollActiveOptionIntoView():this._panelOpen||this.multiple||!this._keyManager.activeItem||this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=Y(this.options.changes,this._destroy);this.optionSelectionChanges.pipe($_(t)).subscribe(t=>{this._onSelect(t.source,t.isUserInput),t.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Y(...this.options.map(t=>t._stateChanges)).pipe($_(t)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()}),this._setOptionIds()}_onSelect(t,e){const n=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(n!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),e&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),e&&this.focus())):(t.deselect(),this._selectionModel.clear(),this._propagateChanges(t.value)),n!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((e,n)=>this.sortComparator?this.sortComparator(e,n,t):t.indexOf(e)-t.indexOf(n)),this.stateChanges.next()}}_propagateChanges(t){let e=null;e=this.multiple?this.selected.map(t=>t.value):this.selected?this.selected.value:t,this._value=e,this.valueChange.emit(e),this._onChange(e),this.selectionChange.emit(new YC(this,e)),this._changeDetectorRef.markForCheck()}_setOptionIds(){this._optionIds=this.options.map(t=>t.id).join(" ")}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_scrollActiveOptionIntoView(){const t=this._keyManager.activeItemIndex||0,e=i_(t,this.options,this.optionGroups);this.panel.nativeElement.scrollTop=function(t,e,n,r){const i=t*e;return i<n?i:i+e>n+256?Math.max(0,i-256+e):n}(t+e,this._getItemHeight(),this.panel.nativeElement.scrollTop)}focus(t){this._elementRef.nativeElement.focus(t)}_getOptionIndex(t){return this.options.reduce((e,n,r)=>void 0!==e?e:t===n?r:void 0,void 0)}_calculateOverlayPosition(){const t=this._getItemHeight(),e=this._getItemCount(),n=Math.min(e*t,256),r=e*t-n;let i=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);i+=i_(i,this.options,this.optionGroups);const o=n/2;this._scrollTop=this._calculateOverlayScroll(i,o,r),this._offsetY=this._calculateOverlayOffsetY(i,o,r),this._checkOverlayWithinViewport(r)}_calculateOverlayScroll(t,e,n){const r=this._getItemHeight();return Math.min(Math.max(0,r*t-e+r/2),n)}_getAriaLabel(){return this.ariaLabelledby?null:this.ariaLabel||this.placeholder}_getAriaLabelledby(){return this.ariaLabelledby?this.ariaLabelledby:this._parentFormField&&this._parentFormField._hasFloatingLabel()&&!this._getAriaLabel()&&this._parentFormField._labelId||null}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_calculateOverlayOffsetX(){const t=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),e=this._viewportRuler.getViewportSize(),n=this._isRtl(),r=this.multiple?56:32;let i;if(this.multiple)i=40;else{let t=this._selectionModel.selected[0]||this.options.first;i=t&&t.group?32:16}n||(i*=-1);const o=0-(t.left+i-(n?r:0)),s=t.right+i-e.width+(n?0:r);o>0?i+=o+8:s>0&&(i-=s+8),this.overlayDir.offsetX=Math.round(i),this.overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(t,e,n){const r=this._getItemHeight(),i=(r-this._triggerRect.height)/2,o=Math.floor(256/r);let s;return this._disableOptionCentering?0:(s=0===this._scrollTop?t*r:this._scrollTop===n?(t-(this._getItemCount()-o))*r+(r-(this._getItemCount()*r-256)%r):e-r/2,Math.round(-1*s-i))}_checkOverlayWithinViewport(t){const e=this._getItemHeight(),n=this._viewportRuler.getViewportSize(),r=this._triggerRect.top-8,i=n.height-this._triggerRect.bottom-8,o=Math.abs(this._offsetY),s=Math.min(this._getItemCount()*e,256)-o-this._triggerRect.height;s>i?this._adjustPanelUp(s,i):o>r?this._adjustPanelDown(o,r,t):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(t,e){const n=Math.round(t-e);this._scrollTop-=n,this._offsetY-=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(t,e,n){const r=Math.round(t-e);if(this._scrollTop+=r,this._offsetY+=r,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=n)return this._scrollTop=n,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_getOriginBasedOnOption(){const t=this._getItemHeight(),e=(t-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-e+t/2}px 0px`}_getItemCount(){return this.options.length+this.optionGroups.length}_getItemHeight(){return 3*this._triggerFontSize}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty}}return t.\u0275fac=function(e){return new(e||t)(xs(lx),xs(zo),xs(xc),xs(Fw),xs(Va),xs(ow,8),xs(Ad,8),xs(Ud,8),xs(DC,8),xs(Nh,10),Cs("tabindex"),xs($C),xs(Yb),xs(KC,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-select"]],contentQueries:function(t,e,n){var r;1&t&&($u(n,ZC,!0),$u(n,r_,!0),$u(n,Jw,!0)),2&t&&(Wu(r=Yu())&&(e.customTrigger=r.first),Wu(r=Yu())&&(e.options=r),Wu(r=Yu())&&(e.optionGroups=r))},viewQuery:function(t,e){var n;1&t&&(Hu(FC,!0),Hu(LC,!0),Hu(Jx,!0)),2&t&&(Wu(n=Yu())&&(e.trigger=n.first),Wu(n=Yu())&&(e.panel=n.first),Wu(n=Yu())&&(e.overlayDir=n.first))},hostAttrs:["role","listbox",1,"mat-select"],hostVars:19,hostBindings:function(t,e){1&t&&Fs("keydown",(function(t){return e._handleKeydown(t)}))("focus",(function(){return e._onFocus()}))("blur",(function(){return e._onBlur()})),2&t&&(ys("id",e.id)("tabindex",e.tabIndex)("aria-label",e._getAriaLabel())("aria-labelledby",e._getAriaLabelledby())("aria-required",e.required.toString())("aria-disabled",e.disabled.toString())("aria-invalid",e.errorState)("aria-owns",e.panelOpen?e._optionIds:null)("aria-multiselectable",e.multiple)("aria-describedby",e._ariaDescribedby||null)("aria-activedescendant",e._getAriaActiveDescendant()),ea("mat-select-disabled",e.disabled)("mat-select-invalid",e.errorState)("mat-select-required",e.required)("mat-select-empty",e.empty))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Fa([{provide:_C,useExisting:t},{provide:n_,useExisting:t}]),wa,Ia],ngContentSelectors:qC,decls:9,vars:9,consts:[["cdk-overlay-origin","","aria-hidden","true",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],[3,"ngClass","keydown"],["panel",""]],template:function(t,e){if(1&t&&(Ws(WC),ks(0,"div",0,1),Fs("click",(function(){return e.toggle()})),ks(3,"div",2),ws(4,BC,2,1,"span",3),ws(5,UC,3,2,"span",4),Ts(),ks(6,"div",5),As(7,"div",6),Ts(),Ts(),ws(8,zC,4,11,"ng-template",7),Fs("backdropClick",(function(){return e.close()}))("attach",(function(){return e._onAttached()}))("detach",(function(){return e.close()}))),2&t){const t=_s(1);di(3),Ss("ngSwitch",e.empty),di(1),Ss("ngSwitchCase",!0),di(1),Ss("ngSwitchCase",!1),di(3),Ss("cdkConnectedOverlayScrollStrategy",e._scrollStrategy)("cdkConnectedOverlayOrigin",t)("cdkConnectedOverlayOpen",e.panelOpen)("cdkConnectedOverlayPositions",e._positions)("cdkConnectedOverlayMinWidth",null==e._triggerRect?null:e._triggerRect.width)("cdkConnectedOverlayOffsetY",e._offsetY)}},directives:[Qx,Ol,Nl,Jx,Dl,Cl],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[HC.transformPanelWrap,HC.transformPanel]},changeDetection:0}),t})(),eE=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[XC],imports:[[jl,tC,o_,gw],hx,MC,o_,gw]}),t})();class nE{constructor(t){this.total=t}call(t,e){return e.subscribe(new rE(t,this.total))}}class rE extends v{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}const iE=new Set;let oE,sE=(()=>{class t{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):aE}matchMedia(t){return this._platform.WEBKIT&&function(t){if(!iE.has(t))try{oE||(oE=document.createElement("style"),oE.setAttribute("type","text/css"),document.head.appendChild(oE)),oE.sheet&&(oE.sheet.insertRule(`@media ${t} {.fx-query-test{ }}`,0),iE.add(t))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cb))},t.\u0275prov=pt({factory:function(){return new t(Jt(Cb))},token:t,providedIn:"root"}),t})();function aE(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let uE=(()=>{class t{constructor(t,e){this._mediaMatcher=t,this._zone=e,this._queries=new Map,this._destroySubject=new T}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return cE(yb(t)).some(t=>this._registerQuery(t).mql.matches)}observe(t){let e=rf(cE(yb(t)).map(t=>this._registerQuery(t).observable));return e=Bf(e.pipe(Af(1)),e.pipe(t=>t.lift(new nE(1)),hb(0))),e.pipe(V(t=>{const e={matches:!1,breakpoints:{}};return t.forEach(t=>{e.matches=e.matches||t.matches,e.breakpoints[t.query]=t.matches}),e}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const e=this._mediaMatcher.matchMedia(t),n={observable:new C(t=>{const n=e=>this._zone.run(()=>t.next(e));return e.addListener(n),()=>{e.removeListener(n)}}).pipe(jf(e),V(e=>({query:t,matches:e.matches})),$_(this._destroySubject)),mql:e};return this._queries.set(t,n),n}}return t.\u0275fac=function(e){return new(e||t)(Jt(sE),Jt(xc))},t.\u0275prov=pt({factory:function(){return new t(Jt(sE),Jt(xc))},token:t,providedIn:"root"}),t})();function cE(t){return t.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const lE={tooltipState:Fg("state",[Vg("initial, void, hidden",jg({opacity:0,transform:"scale(0)"})),Vg("visible",jg({transform:"scale(1)"})),zg("* => visible",Lg("200ms cubic-bezier(0, 0, 0.2, 1)",Ug([jg({opacity:0,transform:"scale(0)",offset:0}),jg({opacity:.5,transform:"scale(0.99)",offset:.5}),jg({opacity:1,transform:"scale(1)",offset:1})]))),zg("* => hidden",Lg("100ms cubic-bezier(0, 0, 0.2, 1)",jg({opacity:0})))])},hE=Rb({passive:!0});function dE(t){return Error(`Tooltip position "${t}" is invalid.`)}const fE=new zt("mat-tooltip-scroll-strategy"),pE={provide:fE,deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.reposition({scrollThrottle:20})}},mE=new zt("mat-tooltip-default-options",{providedIn:"root",factory:function(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let gE=(()=>{class t{constructor(t,e,n,r,i,o,s,a,u,c,l,h){this._overlay=t,this._elementRef=e,this._scrollDispatcher=n,this._viewContainerRef=r,this._ngZone=i,this._platform=o,this._ariaDescriber=s,this._focusMonitor=a,this._dir=c,this._defaultOptions=l,this._position="below",this._disabled=!1,this.showDelay=this._defaultOptions.showDelay,this.hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=new Map,this._destroyed=new T,this._handleKeydown=t=>{this._isTooltipVisible()&&27===t.keyCode&&!ob(t)&&(t.preventDefault(),t.stopPropagation(),this._ngZone.run(()=>this.hide(0)))},this._scrollStrategy=u,l&&(l.position&&(this.position=l.position),l.touchGestures&&(this.touchGestures=l.touchGestures)),a.monitor(e).pipe($_(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&i.run(()=>this.show()):i.run(()=>this.hide(0))}),i.runOutsideAngular(()=>{e.nativeElement.addEventListener("keydown",this._handleKeydown)})}get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(),this._tooltipInstance&&this._tooltipInstance.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(t){this._disabled=mb(t),this._disabled&&this.hide(0)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message),this._message=null!=t?`${t}`.trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message)})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngOnInit(){this._setupPointerEvents()}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),t.removeEventListener("keydown",this._handleKeydown),this._passiveListeners.forEach((e,n)=>{t.removeEventListener(n,e,hE)}),this._passiveListeners.clear(),this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const e=this._createOverlay();this._detach(),this._portal=this._portal||new mx(vE,this._viewContainerRef),this._tooltipInstance=e.attach(this._portal).instance,this._tooltipInstance.afterHidden().pipe($_(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),this._tooltipInstance.show(t)}hide(t=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(t)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const t=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),e=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(".mat-tooltip").withFlexibleDimensions(!1).withViewportMargin(8).withScrollableContainers(t);return e.positionChanges.pipe($_(this._destroyed)).subscribe(t=>{this._tooltipInstance&&t.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:e,panelClass:"mat-tooltip-panel",scrollStrategy:this._scrollStrategy()}),this._updatePosition(),this._overlayRef.detachments().pipe($_(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(){const t=this._overlayRef.getConfig().positionStrategy,e=this._getOrigin(),n=this._getOverlayPosition();t.withPositions([Object.assign(Object.assign({},e.main),n.main),Object.assign(Object.assign({},e.fallback),n.fallback)])}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,e=this.position;let n;if("above"==e||"below"==e)n={originX:"center",originY:"above"==e?"top":"bottom"};else if("before"==e||"left"==e&&t||"right"==e&&!t)n={originX:"start",originY:"center"};else{if(!("after"==e||"right"==e&&t||"left"==e&&!t))throw dE(e);n={originX:"end",originY:"center"}}const{x:r,y:i}=this._invertPosition(n.originX,n.originY);return{main:n,fallback:{originX:r,originY:i}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,e=this.position;let n;if("above"==e)n={overlayX:"center",overlayY:"bottom"};else if("below"==e)n={overlayX:"center",overlayY:"top"};else if("before"==e||"left"==e&&t||"right"==e&&!t)n={overlayX:"end",overlayY:"center"};else{if(!("after"==e||"right"==e&&t||"left"==e&&!t))throw dE(e);n={overlayX:"start",overlayY:"center"}}const{x:r,y:i}=this._invertPosition(n.overlayX,n.overlayY);return{main:n,fallback:{overlayX:r,overlayY:i}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.asObservable().pipe(Af(1),$_(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,e){return"above"===this.position||"below"===this.position?"top"===e?e="bottom":"bottom"===e&&(e="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:e}}_setupPointerEvents(){if(this._platform.IOS||this._platform.ANDROID){if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const t=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};this._passiveListeners.set("touchend",t).set("touchcancel",t).set("touchstart",()=>{clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)})}}else this._passiveListeners.set("mouseenter",()=>this.show()).set("mouseleave",()=>this.hide());this._passiveListeners.forEach((t,e)=>{this._elementRef.nativeElement.addEventListener(e,t,hE)})}_disableNativeGesturesIfNecessary(){const t=this._elementRef.nativeElement,e=t.style,n=this.touchGestures;"off"!==n&&(("on"===n||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName)&&(e.userSelect=e.msUserSelect=e.webkitUserSelect=e.MozUserSelect="none"),"on"!==n&&t.draggable||(e.webkitUserDrag="none"),e.touchAction="none",e.webkitTapHighlightColor="transparent")}}return t.\u0275fac=function(e){return new(e||t)(xs(Kx),xs(Va),xs(ux),xs(du),xs(xc),xs(Cb),xs(Ub),xs(tw),xs(fE),xs(ow,8),xs(mE,8),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["","matTooltip",""]],inputs:{showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]}),t})(),vE=(()=>{class t{constructor(t,e){this._changeDetectorRef=t,this._breakpointObserver=e,this._visibility="initial",this._closeOnInteraction=!1,this._onHide=new T,this._isHandset=this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)")}show(t){this._hideTimeoutId&&(clearTimeout(this._hideTimeoutId),this._hideTimeoutId=null),this._closeOnInteraction=!0,this._showTimeoutId=setTimeout(()=>{this._visibility="visible",this._showTimeoutId=null,this._markForCheck()},t)}hide(t){this._showTimeoutId&&(clearTimeout(this._showTimeoutId),this._showTimeoutId=null),this._hideTimeoutId=setTimeout(()=>{this._visibility="hidden",this._hideTimeoutId=null,this._markForCheck()},t)}afterHidden(){return this._onHide.asObservable()}isVisible(){return"visible"===this._visibility}ngOnDestroy(){this._onHide.complete()}_animationStart(){this._closeOnInteraction=!1}_animationDone(t){const e=t.toState;"hidden"!==e||this.isVisible()||this._onHide.next(),"visible"!==e&&"hidden"!==e||(this._closeOnInteraction=!0)}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(xs(zo),xs(uE))},t.\u0275cmp=ve({type:t,selectors:[["mat-tooltip-component"]],hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(t,e){1&t&&Fs("click",(function(){return e._handleBodyInteraction()}),!1,Hn),2&t&&ta("zoom","visible"===e._visibility?1:null)},decls:3,vars:7,consts:[[1,"mat-tooltip",3,"ngClass"]],template:function(t,e){var n;1&t&&(ks(0,"div",0),Fs("@state.start",(function(){return e._animationStart()}))("@state.done",(function(t){return e._animationDone(t)})),Ru(1,"async"),fa(2),Ts()),2&t&&(ea("mat-tooltip-handset",null==(n=Ou(1,5,e._isHandset))?null:n.matches),Ss("ngClass",e.tooltipClass)("@state",e._visibility),di(2),pa(e.message))},directives:[Cl],pipes:[Bl],styles:[".mat-tooltip-panel{pointer-events:none !important}.mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}\n"],encapsulation:2,data:{animation:[lE.tooltipState]},changeDetection:0}),t})(),yE=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[pE],imports:[[rw,jl,tC,gw],gw,hx]}),t})();function bE(t,e){if(1&t&&(ks(0,"mat-option",19),fa(1),Ts()),2&t){const t=e.$implicit;Ss("value",t),di(1),ma(" ",t," ")}}function wE(t,e){if(1&t){const t=Ds();ks(0,"mat-form-field",16),ks(1,"mat-select",17),Fs("selectionChange",(function(e){return Ze(t),Us(2)._changePageSize(e.value)})),ws(2,bE,2,2,"mat-option",18),Ts(),Ts()}if(2&t){const t=Us(2);Ss("color",t.color),di(1),Ss("value",t.pageSize)("disabled",t.disabled)("aria-label",t._intl.itemsPerPageLabel),di(1),Ss("ngForOf",t._displayedPageSizeOptions)}}function _E(t,e){if(1&t&&(ks(0,"div",20),fa(1),Ts()),2&t){const t=Us(2);di(1),pa(t.pageSize)}}function xE(t,e){if(1&t&&(ks(0,"div",12),ks(1,"div",13),fa(2),Ts(),ws(3,wE,3,5,"mat-form-field",14),ws(4,_E,2,1,"div",15),Ts()),2&t){const t=Us();di(2),ma(" ",t._intl.itemsPerPageLabel," "),di(1),Ss("ngIf",t._displayedPageSizeOptions.length>1),di(1),Ss("ngIf",t._displayedPageSizeOptions.length<=1)}}function CE(t,e){if(1&t){const t=Ds();ks(0,"button",21),Fs("click",(function(){return Ze(t),Us().firstPage()})),En(),ks(1,"svg",7),As(2,"path",22),Ts(),Ts()}if(2&t){const t=Us();Ss("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),ys("aria-label",t._intl.firstPageLabel)}}function EE(t,e){if(1&t){const t=Ds();En(),Sn(),ks(0,"button",23),Fs("click",(function(){return Ze(t),Us().lastPage()})),En(),ks(1,"svg",7),As(2,"path",24),Ts(),Ts()}if(2&t){const t=Us();Ss("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),ys("aria-label",t._intl.lastPageLabel)}}let SE=(()=>{class t{constructor(){this.changes=new T,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,n)=>{if(0==n||0==e)return`0 of ${n}`;const r=t*e;return`${r+1} \u2013 ${r<(n=Math.max(n,0))?Math.min(r+e,n):r+e} of ${n}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const IE={provide:SE,deps:[[new ut,new lt,SE]],useFactory:function(t){return t||new SE}},kE=new zt("MAT_PAGINATOR_DEFAULT_OPTIONS");class TE{}const AE=vw(xw(TE));let RE=(()=>{class t extends AE{constructor(t,e,n){if(super(),this._intl=t,this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.page=new Nu,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),n){const{pageSize:t,pageSizeOptions:e,hidePageSize:r,showFirstLastButtons:i}=n;null!=t&&(this._pageSize=t),null!=e&&(this._pageSizeOptions=e),null!=r&&(this._hidePageSize=r),null!=i&&(this._showFirstLastButtons=i)}}get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(gb(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=gb(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(gb(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(t=>gb(t)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=mb(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=mb(t)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,e)=>t-e),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return t.\u0275fac=function(e){return new(e||t)(xs(SE),xs(zo),xs(kE,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-paginator"]],hostAttrs:[1,"mat-paginator"],inputs:{disabled:"disabled",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",color:"color"},outputs:{page:"page"},exportAs:["matPaginator"],features:[wa],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,e){1&t&&(ks(0,"div",0),ks(1,"div",1),ws(2,xE,5,3,"div",2),ks(3,"div",3),ks(4,"div",4),fa(5),Ts(),ws(6,CE,3,5,"button",5),ks(7,"button",6),Fs("click",(function(){return e.previousPage()})),En(),ks(8,"svg",7),As(9,"path",8),Ts(),Ts(),Sn(),ks(10,"button",9),Fs("click",(function(){return e.nextPage()})),En(),ks(11,"svg",7),As(12,"path",10),Ts(),Ts(),ws(13,EE,3,5,"button",11),Ts(),Ts(),Ts()),2&t&&(di(2),Ss("ngIf",!e.hidePageSize),di(3),ma(" ",e._intl.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),di(1),Ss("ngIf",e.showFirstLastButtons),di(1),Ss("matTooltip",e._intl.previousPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),ys("aria-label",e._intl.previousPageLabel),di(3),Ss("matTooltip",e._intl.nextPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),ys("aria-label",e._intl.nextPageLabel),di(3),Ss("ngIf",e.showFirstLastButtons))},directives:[kl,k_,gE,PC,tE,Sl,r_],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;min-height:56px;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}\n"],encapsulation:2,changeDetection:0}),t})(),OE=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[IE],imports:[[jl,A_,eE,yE]]}),t})(),NE=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[sw]]}),t})();class DE{}class PE{}class ME{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof ME?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new ME;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof ME?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===i.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class FE{encodeKey(t){return LE(t)}encodeValue(t){return LE(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function LE(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class BE{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new FE,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const r=t.indexOf("="),[i,o]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],s=n.get(i)||[];s.push(o),n.set(i,s)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new BE({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function jE(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function VE(t){return"undefined"!=typeof Blob&&t instanceof Blob}function UE(t){return"undefined"!=typeof FormData&&t instanceof FormData}class zE{constructor(t,e,n,r){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new ME),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new BE,this.urlWithParams=e}serializeBody(){return null===this.body?null:jE(this.body)||VE(this.body)||UE(this.body)||"string"==typeof this.body?this.body:this.body instanceof BE?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body?null:UE(this.body)?null:VE(this.body)?this.body.type||null:jE(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof BE?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,u=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),a)),t.setParams&&(u=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),u)),new zE(e,n,i,{params:u,headers:a,reportProgress:s,responseType:r,withCredentials:o})}}const WE=function(){var t={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return t[t.Sent]="Sent",t[t.UploadProgress]="UploadProgress",t[t.ResponseHeader]="ResponseHeader",t[t.DownloadProgress]="DownloadProgress",t[t.Response]="Response",t[t.User]="User",t}();class qE{constructor(t,e=200,n="OK"){this.headers=t.headers||new ME,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class HE extends qE{constructor(t={}){super(t),this.type=WE.ResponseHeader}clone(t={}){return new HE({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class GE extends qE{constructor(t={}){super(t),this.type=WE.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new GE({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class $E extends qE{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function KE(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let XE=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof zE)r=t;else{let i=void 0;i=n.headers instanceof ME?n.headers:new ME(n.headers);let o=void 0;n.params&&(o=n.params instanceof BE?n.params:new BE({fromObject:n.params})),r=new zE(t,e,void 0!==n.body?n.body:null,{headers:i,params:o,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Zd(r).pipe(Wf(t=>this.handler.handle(t)));if(t instanceof zE||"events"===n.observe)return i;const o=i.pipe(hf(t=>t instanceof GE));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return o.pipe(V(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return o.pipe(V(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return o.pipe(V(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return o.pipe(V(t=>t.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new BE).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,KE(n,e))}post(t,e,n={}){return this.request("POST",t,KE(n,e))}put(t,e,n={}){return this.request("PUT",t,KE(n,e))}}return t.\u0275fac=function(e){return new(e||t)(Jt(DE))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();class YE{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const QE=new zt("HTTP_INTERCEPTORS");let JE=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const ZE=/^\)\]\}',?\n/;class tS{}let eS=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),nS=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new C(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const r=t.serializeBody();let i=null;const o=()=>{if(null!==i)return i;const e=1223===n.status?204:n.status,r=n.statusText||"OK",o=new ME(n.getAllResponseHeaders()),s=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return i=new HE({headers:o,status:e,statusText:r,url:s}),i},s=()=>{let{headers:r,status:i,statusText:s,url:a}=o(),u=null;204!==i&&(u=void 0===n.response?n.responseText:n.response),0===i&&(i=u?200:0);let c=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof u){const t=u;u=u.replace(ZE,"");try{u=""!==u?JSON.parse(u):null}catch(l){u=t,c&&(c=!1,u={error:l,text:u})}}c?(e.next(new GE({body:u,headers:r,status:i,statusText:s,url:a||void 0})),e.complete()):e.error(new $E({error:u,headers:r,status:i,statusText:s,url:a||void 0}))},a=t=>{const{url:r}=o(),i=new $E({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});e.error(i)};let u=!1;const c=r=>{u||(e.next(o()),u=!0);let i={type:WE.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===t.responseType&&n.responseText&&(i.partialText=n.responseText),e.next(i)},l=t=>{let n={type:WE.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",s),n.addEventListener("error",a),t.reportProgress&&(n.addEventListener("progress",c),null!==r&&n.upload&&n.upload.addEventListener("progress",l)),n.send(r),e.next({type:WE.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("load",s),t.reportProgress&&(n.removeEventListener("progress",c),null!==r&&n.upload&&n.upload.removeEventListener("progress",l)),n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Jt(tS))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})();const rS=new zt("XSRF_COOKIE_NAME"),iS=new zt("XSRF_HEADER_NAME");class oS{}let sS=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=xl(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Jt(el),Jt(sc),Jt(rS))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),aS=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Jt(oS),Jt(iS))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),uS=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(QE,[]);this.chain=t.reduceRight((t,e)=>new YE(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Jt(PE),Jt(is))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),cS=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:aS,useClass:JE}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:rS,useValue:e.cookieName}:[],e.headerName?{provide:iS,useValue:e.headerName}:[]]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[aS,{provide:QE,useExisting:aS,multi:!0},{provide:oS,useClass:sS},{provide:rS,useValue:"XSRF-TOKEN"},{provide:iS,useValue:"X-XSRF-TOKEN"}]}),t})(),lS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[XE,{provide:DE,useClass:uS},nS,{provide:PE,useExisting:nS},eS,{provide:tS,useExisting:eS}],imports:[[cS.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();const hS=["*"];function dS(t){return Error(`Unable to find icon with the name "${t}"`)}function fS(t){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL "+`via Angular's DomSanitizer. Attempted URL was "${t}".`)}function pS(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by "+`Angular's DomSanitizer. Attempted literal was "${t}".`)}class mS{constructor(t,e){this.options=e,t.nodeName?this.svgElement=t:this.url=t}}let gS=(()=>{class t{constructor(t,e,n,r){this._httpClient=t,this._sanitizer=e,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=n}addSvgIcon(t,e,n){return this.addSvgIconInNamespace("",t,e,n)}addSvgIconLiteral(t,e,n){return this.addSvgIconLiteralInNamespace("",t,e,n)}addSvgIconInNamespace(t,e,n,r){return this._addSvgIconConfig(t,e,new mS(n,r))}addSvgIconLiteralInNamespace(t,e,n,r){const i=this._sanitizer.sanitize($r.HTML,n);if(!i)throw pS(n);const o=this._createSvgElementForSingleIcon(i,r);return this._addSvgIconConfig(t,e,new mS(o,r))}addSvgIconSet(t,e){return this.addSvgIconSetInNamespace("",t,e)}addSvgIconSetLiteral(t,e){return this.addSvgIconSetLiteralInNamespace("",t,e)}addSvgIconSetInNamespace(t,e,n){return this._addSvgIconSetConfig(t,new mS(e,n))}addSvgIconSetLiteralInNamespace(t,e,n){const r=this._sanitizer.sanitize($r.HTML,e);if(!r)throw pS(e);const i=this._svgElementFromString(r);return this._addSvgIconSetConfig(t,new mS(i,n))}registerFontClassAlias(t,e=t){return this._fontCssClassesByAlias.set(t,e),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const e=this._sanitizer.sanitize($r.RESOURCE_URL,t);if(!e)throw fS(t);const n=this._cachedIconsByUrl.get(e);return n?Zd(vS(n)):this._loadSvgIconFromConfig(new mS(t)).pipe(Hf(t=>this._cachedIconsByUrl.set(e,t)),V(t=>vS(t)))}getNamedSvgIcon(t,e=""){const n=yS(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);const i=this._iconSetConfigs.get(e);return i?this._getSvgFromIconSetConfigs(t,i):Z_(dS(n))}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgElement?Zd(vS(t.svgElement)):this._loadSvgIconFromConfig(t).pipe(Hf(e=>t.svgElement=e),V(t=>vS(t)))}_getSvgFromIconSetConfigs(t,e){const n=this._extractIconWithNameFromAnySet(t,e);return n?Zd(n):wh(e.filter(t=>!t.svgElement).map(t=>this._loadSvgIconSetFromConfig(t).pipe(If(e=>{const n=`Loading icon set URL: ${this._sanitizer.sanitize($r.RESOURCE_URL,t.url)} failed: ${e.message}`;return this._errorHandler?this._errorHandler.handleError(new Error(n)):console.error(n),Zd(null)})))).pipe(V(()=>{const n=this._extractIconWithNameFromAnySet(t,e);if(!n)throw dS(t);return n}))}_extractIconWithNameFromAnySet(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.svgElement){const e=this._extractSvgIconFromSet(r.svgElement,t,r.options);if(e)return e}}return null}_loadSvgIconFromConfig(t){return this._fetchUrl(t.url).pipe(V(e=>this._createSvgElementForSingleIcon(e,t.options)))}_loadSvgIconSetFromConfig(t){return t.svgElement?Zd(t.svgElement):this._fetchUrl(t.url).pipe(V(e=>(t.svgElement||(t.svgElement=this._svgElementFromString(e)),t.svgElement)))}_createSvgElementForSingleIcon(t,e){const n=this._svgElementFromString(t);return this._setSvgAttributes(n,e),n}_extractSvgIconFromSet(t,e,n){const r=t.querySelector(`[id="${e}"]`);if(!r)return null;const i=r.cloneNode(!0);if(i.removeAttribute("id"),"svg"===i.nodeName.toLowerCase())return this._setSvgAttributes(i,n);if("symbol"===i.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(i),n);const o=this._svgElementFromString("<svg></svg>");return o.appendChild(i),this._setSvgAttributes(o,n)}_svgElementFromString(t){const e=this._document.createElement("DIV");e.innerHTML=t;const n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(t){const e=this._svgElementFromString("<svg></svg>"),n=t.attributes;for(let r=0;r<n.length;r++){const{name:t,value:i}=n[r];"id"!==t&&e.setAttribute(t,i)}for(let r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[r].cloneNode(!0));return e}_setSvgAttributes(t,e){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),e&&e.viewBox&&t.setAttribute("viewBox",e.viewBox),t}_fetchUrl(t){if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==t)throw Error(`Cannot fetch icon from URL "${t}".`);const e=this._sanitizer.sanitize($r.RESOURCE_URL,t);if(!e)throw fS(t);const n=this._inProgressUrlFetches.get(e);if(n)return n;const r=this._httpClient.get(e,{responseType:"text"}).pipe(Kf(()=>this._inProgressUrlFetches.delete(e)),it());return this._inProgressUrlFetches.set(e,r),r}_addSvgIconConfig(t,e,n){return this._svgIconConfigs.set(yS(t,e),n),this}_addSvgIconSetConfig(t,e){const n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}}return t.\u0275fac=function(e){return new(e||t)(Jt(XE,8),Jt(mh),Jt(el,8),Jt(fr,8))},t.\u0275prov=pt({factory:function(){return new t(Jt(XE,8),Jt(mh),Jt(el,8),Jt(fr,8))},token:t,providedIn:"root"}),t})();function vS(t){return t.cloneNode(!0)}function yS(t,e){return t+":"+e}class bS{constructor(t){this._elementRef=t}}const wS=yw(bS),_S=new zt("mat-icon-location",{providedIn:"root",factory:function(){const t=Zt(el),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),xS=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],CS=xS.map(t=>`[${t}]`).join(", "),ES=/^url\(['"]?#(.*?)['"]?\)$/;let SS=(()=>{class t extends wS{constructor(t,e,n,r,i){super(t),this._iconRegistry=e,this._location=r,this._errorHandler=i,this._inline=!1,this._currentIconFetch=p.EMPTY,n||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=mb(t)}get fontSet(){return this._fontSet}set fontSet(t){this._fontSet=this._cleanupFontValue(t)}get fontIcon(){return this._fontIcon}set fontIcon(t){this._fontIcon=this._cleanupFontValue(t)}_splitIconName(t){if(!t)return["",""];const e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnChanges(t){const e=t.svgIcon;if(e)if(this._currentIconFetch.unsubscribe(),this.svgIcon){const[t,e]=this._splitIconName(this.svgIcon);this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(e,t).pipe(Af(1)).subscribe(t=>this._setSvgElement(t),n=>{const r=`Error retrieving icon ${t}:${e}! ${n.message}`;this._errorHandler?this._errorHandler.handleError(new Error(r)):console.error(r)})}else e.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}ngOnInit(){this._usingFontIcon()&&this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&this._location&&t.size){const t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const e=t.querySelectorAll("style");for(let n=0;n<e.length;n++)e[n].textContent+=" ";if(this._location){const e=this._location.getPathname();this._previousPath=e,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(e)}this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){const n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const e=this._elementsWithExternalReferences;e&&e.forEach((e,n)=>{e.forEach(e=>{n.setAttribute(e.name,`url('${t}#${e.value}')`)})})}_cacheChildrenWithExternalReferences(t){const e=t.querySelectorAll(CS),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<e.length;r++)xS.forEach(t=>{const i=e[r],o=i.getAttribute(t),s=o?o.match(ES):null;if(s){let e=n.get(i);e||(e=[],n.set(i,e)),e.push({name:t,value:s[1]})}})}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(gS),Cs("aria-hidden"),xs(_S,8),xs(fr,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(t,e){2&t&&ea("mat-icon-inline",e.inline)("mat-icon-no-color","primary"!==e.color&&"accent"!==e.color&&"warn"!==e.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[wa,Ia],ngContentSelectors:hS,decls:1,vars:0,template:function(t,e){1&t&&(Ws(),qs(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),t})(),IS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw],gw]}),t})(),kS=(()=>{class t{constructor(){this.changes=new T,this.optionalLabel="Optional"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const TS={provide:kS,deps:[[new ut,new lt,kS]],useFactory:function(t){return t||new kS}};let AS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[TS,Fw],imports:[[gw,jl,_x,A_,NE,IS,Gw],gw]}),t})(),RS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,gw,_x,Gw,Fb,rw],gw]}),t})();const OS=["mat-sort-header",""];function NS(t,e){if(1&t){const t=Ds();ks(0,"div",3),Fs("@arrowPosition.start",(function(){return Ze(t),Us()._disableViewStateAnimation=!0}))("@arrowPosition.done",(function(){return Ze(t),Us()._disableViewStateAnimation=!1})),As(1,"div",4),ks(2,"div",5),As(3,"div",6),As(4,"div",7),As(5,"div",8),Ts(),Ts()}if(2&t){const t=Us();Ss("@arrowOpacity",t._getArrowViewState())("@arrowPosition",t._getArrowViewState())("@allowChildren",t._getArrowDirectionState()),di(2),Ss("@indicator",t._getArrowDirectionState()),di(1),Ss("@leftPointer",t._getArrowDirectionState()),di(1),Ss("@rightPointer",t._getArrowDirectionState())}}const DS=["*"];class PS{}const MS=xw(vw(PS));let FS=(()=>{class t extends MS{constructor(){super(...arguments),this.sortables=new Map,this._stateChanges=new T,this.start="asc",this._direction="",this.sortChange=new Nu}get direction(){return this._direction}set direction(t){if(Sr()&&t&&"asc"!==t&&"desc"!==t)throw function(t){return Error(`${t} is not a valid sort direction ('asc' or 'desc').`)}(t);this._direction=t}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=mb(t)}register(t){if(!t.id)throw Error("MatSortHeader must be provided with a unique id.");if(this.sortables.has(t.id))throw Error(`Cannot have two MatSortables with the same id (${t.id}).`);this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let e=function(t,e){let n=["asc","desc"];return"desc"==t&&n.reverse(),e||n.push(""),n}(t.start||this.start,null!=t.disableClear?t.disableClear:this.disableClear),n=e.indexOf(this.direction)+1;return n>=e.length&&(n=0),e[n]}ngOnInit(){this._markInitialized()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return t.\u0275fac=function(e){return LS(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"],active:["matSortActive","active"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[wa,Ia]}),t})();const LS=cr(FS),BS=fw.ENTERING+" "+dw.STANDARD_CURVE,jS={indicator:Fg("indicator",[Vg("active-asc, asc",jg({transform:"translateY(0px)"})),Vg("active-desc, desc",jg({transform:"translateY(10px)"})),zg("active-asc <=> active-desc",Lg(BS))]),leftPointer:Fg("leftPointer",[Vg("active-asc, asc",jg({transform:"rotate(-45deg)"})),Vg("active-desc, desc",jg({transform:"rotate(45deg)"})),zg("active-asc <=> active-desc",Lg(BS))]),rightPointer:Fg("rightPointer",[Vg("active-asc, asc",jg({transform:"rotate(45deg)"})),Vg("active-desc, desc",jg({transform:"rotate(-45deg)"})),zg("active-asc <=> active-desc",Lg(BS))]),arrowOpacity:Fg("arrowOpacity",[Vg("desc-to-active, asc-to-active, active",jg({opacity:1})),Vg("desc-to-hint, asc-to-hint, hint",jg({opacity:.54})),Vg("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",jg({opacity:0})),zg("* => asc, * => desc, * => active, * => hint, * => void",Lg("0ms")),zg("* <=> *",Lg(BS))]),arrowPosition:Fg("arrowPosition",[zg("* => desc-to-hint, * => desc-to-active",Lg(BS,Ug([jg({transform:"translateY(-25%)"}),jg({transform:"translateY(0)"})]))),zg("* => hint-to-desc, * => active-to-desc",Lg(BS,Ug([jg({transform:"translateY(0)"}),jg({transform:"translateY(25%)"})]))),zg("* => asc-to-hint, * => asc-to-active",Lg(BS,Ug([jg({transform:"translateY(25%)"}),jg({transform:"translateY(0)"})]))),zg("* => hint-to-asc, * => active-to-asc",Lg(BS,Ug([jg({transform:"translateY(0)"}),jg({transform:"translateY(-25%)"})]))),Vg("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",jg({transform:"translateY(0)"})),Vg("hint-to-desc, active-to-desc, desc",jg({transform:"translateY(-25%)"})),Vg("hint-to-asc, active-to-asc, asc",jg({transform:"translateY(25%)"}))]),allowChildren:Fg("allowChildren",[zg("* <=> *",[qg("@*",Wg(),{optional:!0})])])};let VS=(()=>{class t{constructor(){this.changes=new T,this.sortButtonLabel=t=>`Change sorting for ${t}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const US={provide:VS,deps:[[new ut,new lt,VS]],useFactory:function(t){return t||new VS}};class zS{}const WS=vw(zS);let qS=(()=>{class t extends WS{constructor(t,e,n,r,i,o){if(super(),this._intl=t,this._sort=n,this._columnDef=r,this._focusMonitor=i,this._elementRef=o,this._showIndicatorHint=!1,this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",!n)throw Error("MatSortHeader must be placed within a parent element with the MatSort directive.");this._rerenderSubscription=Y(n.sortChange,n._stateChanges,t.changes).subscribe(()=>{this._isSorted()&&this._updateArrowDirection(),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),e.markForCheck()}),i&&o&&i.monitor(o,!0).subscribe(t=>this._setIndicatorHintVisible(!!t))}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=mb(t)}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this)}ngOnDestroy(){this._focusMonitor&&this._elementRef&&this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}_setIndicatorHintVisible(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(t){this._viewState=t,this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}_handleClick(){if(this._isDisabled())return;this._sort.sort(this),"hint"!==this._viewState.toState&&"active"!==this._viewState.toState||(this._disableViewStateAnimation=!0);const t=this._isSorted()?{fromState:this._arrowDirection,toState:"active"}:{fromState:"active",toState:this._arrowDirection};this._setAnimationTransitionState(t),this._showIndicatorHint=!1}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const t=this._viewState.fromState;return(t?`${t}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":null}_renderArrow(){return!this._isDisabled()||this._isSorted()}}return t.\u0275fac=function(e){return new(e||t)(xs(VS),xs(zo),xs(FS,8),xs("MAT_SORT_HEADER_COLUMN_DEF",8),xs(tw),xs(Va))},t.\u0275cmp=ve({type:t,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(t,e){1&t&&Fs("click",(function(){return e._handleClick()}))("mouseenter",(function(){return e._setIndicatorHintVisible(!0)}))("mouseleave",(function(){return e._setIndicatorHintVisible(!1)})),2&t&&(ys("aria-sort",e._getAriaSortAttribute()),ea("mat-sort-header-disabled",e._isDisabled()))},inputs:{disabled:"disabled",arrowPosition:"arrowPosition",disableClear:"disableClear",id:["mat-sort-header","id"],start:"start"},exportAs:["matSortHeader"],features:[wa],attrs:OS,ngContentSelectors:DS,decls:4,vars:7,consts:[[1,"mat-sort-header-container"],["type","button",1,"mat-sort-header-button","mat-focus-indicator"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(t,e){1&t&&(Ws(),ks(0,"div",0),ks(1,"button",1),qs(2),Ts(),ws(3,NS,6,6,"div",2),Ts()),2&t&&(ea("mat-sort-header-sorted",e._isSorted())("mat-sort-header-position-before","before"==e.arrowPosition),di(1),ys("disabled",e._isDisabled()||null)("aria-label",e._intl.sortButtonLabel(e.id)),di(2),Ss("ngIf",e._renderArrow()))},directives:[kl],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-button{border:none;background:0 0;display:flex;align-items:center;padding:0;cursor:inherit;outline:0;font:inherit;color:currentColor;position:relative}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-button,[mat-sort-header].cdk-program-focused .mat-sort-header-button{border-bottom:solid 1px currentColor}.mat-sort-header-button::-moz-focus-inner{border:0}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}\n"],encapsulation:2,data:{animation:[jS.indicator,jS.leftPointer,jS.rightPointer,jS.arrowOpacity,jS.arrowPosition,jS.allowChildren]},changeDetection:0}),t})(),HS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[US],imports:[[jl]]}),t})(),GS=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,gw],gw]}),t})();function $S(t,e){}class KS{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const XS={dialogContainer:Fg("dialogContainer",[Vg("void, exit",jg({opacity:0,transform:"scale(0.7)"})),Vg("enter",jg({transform:"none"})),zg("* => enter",Lg("150ms cubic-bezier(0, 0, 0.2, 1)",jg({transform:"none",opacity:1}))),zg("* => void, * => exit",Lg("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",jg({opacity:0})))])};function YS(){throw Error("Attempting to attach dialog content after content is already attached")}let QS=(()=>{class t extends yx{constructor(t,e,n,r,i){super(),this._elementRef=t,this._focusTrapFactory=e,this._changeDetectorRef=n,this._config=i,this._elementFocusedBeforeDialogWasOpened=null,this._state="enter",this._animationStateChanged=new Nu,this.attachDomPortal=t=>(this._portalOutlet.hasAttached()&&YS(),this._setupFocusTrap(),this._portalOutlet.attachDomPortal(t)),this._ariaLabelledBy=i.ariaLabelledBy||null,this._document=r}attachComponentPortal(t){return this._portalOutlet.hasAttached()&&YS(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached()&&YS(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||this._focusTrap.focusInitialElement()||this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const e=this._document.activeElement,n=this._elementRef.nativeElement;e&&e!==this._document.body&&e!==n&&!n.contains(e)||t.focus()}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}_containsFocus(){const t=this._elementRef.nativeElement,e=this._document.activeElement;return t===e||t.contains(e)}_onAnimationDone(t){"enter"===t.toState?this._trapFocus():"exit"===t.toState&&this._restoreFocus(),this._animationStateChanged.emit(t)}_onAnimationStart(t){this._animationStateChanged.emit(t)}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs($b),xs(zo),xs(el,8),xs(KS))},t.\u0275cmp=ve({type:t,selectors:[["mat-dialog-container"]],viewQuery:function(t,e){var n;1&t&&qu(wx,!0),2&t&&Wu(n=Yu())&&(e._portalOutlet=n.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,e){1&t&&Ls("@dialogContainer.start",(function(t){return e._onAnimationStart(t)}))("@dialogContainer.done",(function(t){return e._onAnimationDone(t)})),2&t&&(ys("id",e._id)("role",e._config.role)("aria-labelledby",e._config.ariaLabel?null:e._ariaLabelledBy)("aria-label",e._config.ariaLabel)("aria-describedby",e._config.ariaDescribedBy||null),ya("@dialogContainer",e._state))},features:[wa],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&ws(0,$S,0,0,"ng-template",0)},directives:[wx],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[XS.dialogContainer]}}),t})(),JS=0;class ZS{constructor(t,e,n=`mat-dialog-${JS++}`){this._overlayRef=t,this._containerInstance=e,this.id=n,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new T,this._afterClosed=new T,this._beforeClosed=new T,this._state=0,e._id=n,e._animationStateChanged.pipe(hf(t=>"done"===t.phaseName&&"enter"===t.toState),Af(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe(hf(t=>"done"===t.phaseName&&"exit"===t.toState),Af(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),t.keydownEvents().pipe(hf(t=>27===t.keyCode&&!this.disableClose&&!ob(t))).subscribe(t=>{t.preventDefault(),this.close()}),t.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():this.close()})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(hf(t=>"start"===t.phaseName),Af(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._containerInstance._startExitAnimation(),this._state=1}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(t){let e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(t="",e=""){return this._getPositionStrategy().width(t).height(e),this._overlayRef.updatePosition(),this}addPanelClass(t){return this._overlayRef.addPanelClass(t),this}removePanelClass(t){return this._overlayRef.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}const tI=new zt("MatDialogData"),eI=new zt("mat-dialog-default-options"),nI=new zt("mat-dialog-scroll-strategy"),rI={provide:nI,deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.block()}};let iI=(()=>{class t{constructor(t,e,n,r,i,o,s){this._overlay=t,this._injector=e,this._defaultOptions=r,this._parentDialog=o,this._overlayContainer=s,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new T,this._afterOpenedAtThisLevel=new T,this._ariaHiddenElements=new Map,this.afterAllClosed=cf(()=>this.openDialogs.length?this._afterAllClosed:this._afterAllClosed.pipe(jf(void 0))),this._scrollStrategy=i}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}get _afterAllClosed(){const t=this._parentDialog;return t?t._afterAllClosed:this._afterAllClosedAtThisLevel}open(t,e){if((e=function(t,e){return Object.assign(Object.assign({},e),t)}(e,this._defaultOptions||new KS)).id&&this.getDialogById(e.id))throw Error(`Dialog with id "${e.id}" exists already. The dialog id must be unique.`);const n=this._createOverlay(e),r=this._attachDialogContainer(n,e),i=this._attachDialogContent(t,r,n,e);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(i),i.afterClosed().subscribe(()=>this._removeOpenDialog(i)),this.afterOpened.next(i),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(e=>e.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const e=this._getOverlayConfig(t);return this._overlay.create(e)}_getOverlayConfig(t){const e=new Ox({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(e.backdropClass=t.backdropClass),e}_attachDialogContainer(t,e){const n=is.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:KS,useValue:e}]}),r=new mx(QS,e.viewContainerRef,n,e.componentFactoryResolver);return t.attach(r).instance}_attachDialogContent(t,e,n,r){const i=new ZS(n,e,r.id);if(t instanceof lu)e.attachTemplatePortal(new gx(t,null,{$implicit:r.data,dialogRef:i}));else{const n=this._createInjector(r,i,e),o=e.attachComponentPortal(new mx(t,r.viewContainerRef,n));i.componentInstance=o.instance}return i.updateSize(r.width,r.height).updatePosition(r.position),i}_createInjector(t,e,n){const r=t&&t.viewContainerRef&&t.viewContainerRef.injector,i=[{provide:QS,useValue:n},{provide:tI,useValue:t.data},{provide:ZS,useValue:e}];return!t.direction||r&&r.get(ow,null)||i.push({provide:ow,useValue:{value:t.direction,change:Zd()}}),is.create({parent:r||this._injector,providers:i})}_removeOpenDialog(t){const e=this.openDialogs.indexOf(t);e>-1&&(this.openDialogs.splice(e,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((t,e)=>{t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._afterAllClosed.next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const e=t.parentElement.children;for(let n=e.length-1;n>-1;n--){let r=e[n];r===t||"SCRIPT"===r.nodeName||"STYLE"===r.nodeName||r.hasAttribute("aria-live")||(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let e=t.length;for(;e--;)t[e].close()}}return t.\u0275fac=function(e){return new(e||t)(Jt(Kx),Jt(is),Jt(gl,8),Jt(eI,8),Jt(nI),Jt(t,12),Jt(Bx))},t.\u0275prov=pt({token:t,factory:t.\u0275fac}),t})(),oI=0,sI=(()=>{class t{constructor(t,e,n){this.dialogRef=t,this._elementRef=e,this._dialog=n,this.type="button"}ngOnInit(){this.dialogRef||(this.dialogRef=cI(this._elementRef,this._dialog.openDialogs))}ngOnChanges(t){const e=t._matDialogClose||t._matDialogCloseResult;e&&(this.dialogResult=e.currentValue)}}return t.\u0275fac=function(e){return new(e||t)(xs(ZS,8),xs(Va),xs(iI))},t.\u0275dir=Ce({type:t,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(t,e){1&t&&Fs("click",(function(){return e.dialogRef.close(e.dialogResult)})),2&t&&ys("aria-label",e.ariaLabel||null)("type",e.type)},inputs:{type:"type",dialogResult:["mat-dialog-close","dialogResult"],ariaLabel:["aria-label","ariaLabel"],_matDialogClose:["matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],features:[Ia]}),t})(),aI=(()=>{class t{constructor(t,e,n){this._dialogRef=t,this._elementRef=e,this._dialog=n,this.id=`mat-dialog-title-${oI++}`}ngOnInit(){this._dialogRef||(this._dialogRef=cI(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{const t=this._dialogRef._containerInstance;t&&!t._ariaLabelledBy&&(t._ariaLabelledBy=this.id)})}}return t.\u0275fac=function(e){return new(e||t)(xs(ZS,8),xs(Va),xs(iI))},t.\u0275dir=Ce({type:t,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(t,e){2&t&&va("id",e.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),t})(),uI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-dialog-actions"]}),t})();function cI(t,e){let n=t.nativeElement.parentElement;for(;n&&!n.classList.contains("mat-dialog-container");)n=n.parentElement;return n?e.find(t=>t.id===n.id):null}let lI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[iI,rI],imports:[[tC,_x,gw],gw]}),t})();const hI=Rb({passive:!0});let dI=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return af;const e=wb(t),n=this._monitoredElements.get(e);if(n)return n.subject.asObservable();const r=new T,i="cdk-text-field-autofilled",o=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(i)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(i)&&(e.classList.remove(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!1}))):(e.classList.add(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",o,hI),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:r,unlisten:()=>{e.removeEventListener("animationstart",o,hI)}}),r.asObservable()}stopMonitoring(t){const e=wb(t),n=this._monitoredElements.get(e);n&&(n.unlisten(),n.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(Jt(Cb),Jt(xc))},t.\u0275prov=pt({factory:function(){return new t(Jt(Cb),Jt(xc))},token:t,providedIn:"root"}),t})(),fI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Eb]]}),t})();const pI=new zt("MAT_INPUT_VALUE_ACCESSOR"),mI=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let gI=0;class vI{constructor(t,e,n,r){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r}}const yI=_w(vI);let bI=(()=>{class t extends yI{constructor(t,e,n,r,i,o,s,a,u){super(o,r,i,n),this._elementRef=t,this._platform=e,this.ngControl=n,this._autofillMonitor=a,this._uid=`mat-input-${gI++}`,this.focused=!1,this.stateChanges=new T,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>Ib().has(t));const c=this._elementRef.nativeElement,l=c.nodeName.toLowerCase();this._inputValueAccessor=s||c,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&u.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===l,this._isTextarea="textarea"===l,this._isNativeSelect&&(this.controlType=c.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=mb(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=mb(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Ib().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=mb(t)}ngOnInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){if(mI.indexOf(this._type)>-1)throw Error(`Input type "${this._type}" isn't supported by matInput.`)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(Cb),xs(Nh,10),xs(Ad,8),xs(Ud,8),xs(Fw),xs(pI,10),xs(dI),xs(xc))},t.\u0275dir=Ce({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(t,e){1&t&&Fs("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(va("disabled",e.disabled)("required",e.required),ys("id",e.id)("placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-describedby",e._ariaDescribedby||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),ea("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[Fa([{provide:_C,useExisting:t}]),wa,Ia]}),t})(),wI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Fw],imports:[[fI,MC],fI,MC]}),t})(),_I=(()=>{class t{constructor(){this.changes=new T,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(t,e){return`${t} \u2013 ${e}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const xI={provide:new zt("mat-datepicker-scroll-strategy"),deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let CI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[_I,xI],imports:[[jl,A_,lI,tC,rw,_x],hx]}),t})(),EI=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(xs(lu))},t.\u0275dir=Ce({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),SI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[tw,EI]}),t})(),II=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[SI,gw],gw]}),t})();const kI=["*",[["mat-toolbar-row"]]],TI=["*","mat-toolbar-row"];class AI{constructor(t){this._elementRef=t}}const RI=yw(AI);let OI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ce({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),NI=(()=>{class t extends RI{constructor(t,e,n){super(t),this._platform=e,this._document=n}ngAfterViewInit(){Sr()&&this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length&&Array.from(this._elementRef.nativeElement.childNodes).filter(t=>!(t.classList&&t.classList.contains("mat-toolbar-row"))).filter(t=>t.nodeType!==(this._document?this._document.COMMENT_NODE:8)).some(t=>!(!t.textContent||!t.textContent.trim()))&&function(){throw Error("MatToolbar: Attempting to combine different toolbar modes. Either specify multiple `<mat-toolbar-row>` elements explicitly or just place content inside of a `<mat-toolbar>` for a single row.")}()}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(Cb),xs(el))},t.\u0275cmp=ve({type:t,selectors:[["mat-toolbar"]],contentQueries:function(t,e,n){var r;1&t&&$u(n,OI,!0),2&t&&Wu(r=Yu())&&(e._toolbarRows=r)},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,e){2&t&&ea("mat-toolbar-multiple-rows",e._toolbarRows.length>0)("mat-toolbar-single-row",0===e._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[wa],ngContentSelectors:TI,decls:2,vars:0,template:function(t,e){1&t&&(Ws(kI),qs(0),qs(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}\n"],encapsulation:2,changeDetection:0}),t})(),DI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw],gw]}),t})();const PI=["*"];function MI(t,e){if(1&t){const t=Ds();ks(0,"div",2),Fs("click",(function(){return Ze(t),Us()._onBackdropClicked()})),Ts()}2&t&&ea("mat-drawer-shown",Us()._isShowingBackdrop())}function FI(t,e){1&t&&(ks(0,"mat-drawer-content"),qs(1,2),Ts())}const LI=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],BI=["mat-drawer","mat-drawer-content","*"],jI={transformDrawer:Fg("transform",[Vg("open, open-instant",jg({transform:"none",visibility:"visible"})),Vg("void",jg({"box-shadow":"none",visibility:"hidden"})),zg("void => open-instant",Lg("0ms")),zg("void <=> open, open-instant => void",Lg("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};function VI(t){throw Error(`A drawer was already declared for 'position="${t}"'`)}const UI=new zt("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),zI=new zt("MAT_DRAWER_CONTAINER");let WI=(()=>{class t extends cx{constructor(t,e,n,r,i){super(n,r,i),this._changeDetectorRef=t,this._container=e}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(xs(zo),xs(kt(()=>HI)),xs(Va),xs(ux),xs(xc))},t.\u0275cmp=ve({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,e){2&t&&ta("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[wa],ngContentSelectors:PI,decls:1,vars:0,template:function(t,e){1&t&&(Ws(),qs(0))},encapsulation:2,changeDetection:0}),t})(),qI=(()=>{class t{constructor(t,e,n,r,i,o,s){this._elementRef=t,this._focusTrapFactory=e,this._focusMonitor=n,this._platform=r,this._ngZone=i,this._doc=o,this._container=s,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new T,this._animationEnd=new T,this._animationState="void",this.openedChange=new Nu(!0),this._destroyed=new T,this.onPositionChanged=new Nu,this._modeChanged=new T,this.openedChange.subscribe(t=>{t?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._restoreFocus()}),this._ngZone.runOutsideAngular(()=>{R_(this._elementRef.nativeElement,"keydown").pipe(hf(t=>27===t.keyCode&&!this.disableClose&&!ob(t)),$_(this._destroyed)).subscribe(t=>this._ngZone.run(()=>{this.close(),t.stopPropagation(),t.preventDefault()}))}),this._animationEnd.pipe(j_((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{const{fromState:e,toState:n}=t;(0===n.indexOf("open")&&"void"===e||"void"===n&&0===e.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=mb(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"!==this.mode:t}set autoFocus(t){this._autoFocus=mb(t)}get opened(){return this._opened}set opened(t){this.toggle(mb(t))}get _openedStream(){return this.openedChange.pipe(hf(t=>t),V(()=>{}))}get openedStart(){return this._animationStarted.pipe(hf(t=>t.fromState!==t.toState&&0===t.toState.indexOf("open")),V(()=>{}))}get _closedStream(){return this.openedChange.pipe(hf(t=>!t),V(()=>{}))}get closedStart(){return this._animationStarted.pipe(hf(t=>t.fromState!==t.toState&&"void"===t.toState),V(()=>{}))}_takeFocus(){this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then(t=>{t||"function"!=typeof this._elementRef.nativeElement.focus||this._elementRef.nativeElement.focus()})}_restoreFocus(){if(!this.autoFocus)return;const t=this._doc&&this._doc.activeElement;t&&this._elementRef.nativeElement.contains(t)&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}toggle(t=!this.opened,e="program"){return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=e):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise(t=>{this.openedChange.pipe(Af(1)).subscribe(e=>t(e?"open":"close"))})}get _width(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(t){this._animationStarted.next(t)}_animationDoneListener(t){this._animationEnd.next(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs($b),xs(tw),xs(Cb),xs(xc),xs(el,8),xs(zI,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,e){1&t&&Ls("@transform.start",(function(t){return e._animationStartListener(t)}))("@transform.done",(function(t){return e._animationDoneListener(t)})),2&t&&(ys("align",null),ya("@transform",e._animationState),ea("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",onPositionChanged:"positionChanged",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart"},exportAs:["matDrawer"],ngContentSelectors:PI,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(Ws(),ks(0,"div",0),qs(1),Ts())},encapsulation:2,data:{animation:[jI.transformDrawer]},changeDetection:0}),t})(),HI=(()=>{class t{constructor(t,e,n,r,i,o=!1,s){this._dir=t,this._element=e,this._ngZone=n,this._changeDetectorRef=r,this._animationMode=s,this._drawers=new Pu,this.backdropClick=new Nu,this._destroyed=new T,this._doCheckSubject=new T,this._contentMargins={left:null,right:null},this._contentMarginChanges=new T,t&&t.change.pipe($_(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),i.change().pipe($_(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=o}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=mb(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:mb(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(jf(this._allDrawers),$_(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(t=>!t._container||t._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(jf(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._doCheckSubject.pipe(hb(10),$_(this._destroyed)).subscribe(()=>this.updateContentMargins())}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,e=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._width;else if("push"==this._left.mode){const n=this._left._width;t+=n,e-=n}if(this._right&&this._right.opened)if("side"==this._right.mode)e+=this._right._width;else if("push"==this._right.mode){const n=this._right._width;e+=n,t-=n}t=t||null,e=e||null,t===this._contentMargins.left&&e===this._contentMargins.right||(this._contentMargins={left:t,right:e},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(hf(t=>t.fromState!==t.toState),$_(this._drawers.changes)).subscribe(t=>{"open-instant"!==t.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe($_(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe($_(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.asObservable().pipe(Af(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe($_(Y(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const e=this._element.nativeElement.classList,n="mat-drawer-container-has-open";t?e.add(n):e.remove(n)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?(null!=this._end&&VI("end"),this._end=t):(null!=this._start&&VI("start"),this._start=t)}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawer()}_closeModalDrawer(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t.close())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return t.\u0275fac=function(e){return new(e||t)(xs(ow,8),xs(Va),xs(xc),xs(zo),xs(lx),xs(UI),xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(t,e,n){var r;1&t&&($u(n,WI,!0),$u(n,qI,!0)),2&t&&(Wu(r=Yu())&&(e._content=r.first),Wu(r=Yu())&&(e._allDrawers=r))},viewQuery:function(t,e){var n;1&t&&Hu(WI,!0),2&t&&Wu(n=Yu())&&(e._userContent=n.first)},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,e){2&t&&ea("mat-drawer-container-explicit-backdrop",e._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Fa([{provide:zI,useExisting:t}])],ngContentSelectors:BI,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,e){1&t&&(Ws(LI),ws(0,MI,1,2,"div",0),qs(1),qs(2,1),ws(3,FI,2,0,"mat-drawer-content",1)),2&t&&(Ss("ngIf",e.hasBackdrop),di(3),Ss("ngIf",!e._content))},directives:[kl,WI],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),t})(),GI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,gw,Eb,hx],hx,gw]}),t})();const $I=["*",[["mat-card-footer"]]],KI=["*","mat-card-footer"];let XI=(()=>{class t{constructor(t){this._animationMode=t}}return t.\u0275fac=function(e){return new(e||t)(xs(nb,8))},t.\u0275cmp=ve({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,e){2&t&&ea("_mat-animation-noopable","NoopAnimations"===e._animationMode)},exportAs:["matCard"],ngContentSelectors:KI,decls:2,vars:0,template:function(t,e){1&t&&(Ws($I),qs(0),qs(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),t})(),YI=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw],gw]}),t})();function QI(t,e){if(1&t&&(En(),As(0,"circle",3)),2&t){const t=Us();ta("animation-name","mat-progress-spinner-stroke-rotate-"+t.diameter)("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),ys("r",t._circleRadius)}}function JI(t,e){if(1&t&&(En(),As(0,"circle",3)),2&t){const t=Us();ta("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),ys("r",t._circleRadius)}}function ZI(t,e){if(1&t&&(En(),As(0,"circle",3)),2&t){const t=Us();ta("animation-name","mat-progress-spinner-stroke-rotate-"+t.diameter)("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),ys("r",t._circleRadius)}}function tk(t,e){if(1&t&&(En(),As(0,"circle",3)),2&t){const t=Us();ta("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),ys("r",t._circleRadius)}}class ek{constructor(t){this._elementRef=t}}const nk=yw(ek,"primary"),rk=new zt("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});let ik=(()=>{class t extends nk{constructor(e,n,r,i,o){super(e),this._elementRef=e,this._document=r,this._diameter=100,this._value=0,this._fallbackAnimation=!1,this.mode="determinate";const s=t._diameters;s.has(r.head)||s.set(r.head,new Set([100])),this._fallbackAnimation=n.EDGE||n.TRIDENT,this._noopAnimations="NoopAnimations"===i&&!!o&&!o._forceAnimations,o&&(o.diameter&&(this.diameter=o.diameter),o.strokeWidth&&(this.strokeWidth=o.strokeWidth))}get diameter(){return this._diameter}set diameter(t){this._diameter=gb(t),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(t){this._strokeWidth=gb(t)}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,gb(t)))}ngOnInit(){const t=this._elementRef.nativeElement;this._styleRoot=Nb(t)||this._document.head,this._attachStyleNode(),t.classList.add(`mat-progress-spinner-indeterminate${this._fallbackAnimation?"-fallback":""}-animation`)}get _circleRadius(){return(this.diameter-10)/2}get _viewBox(){const t=2*this._circleRadius+this.strokeWidth;return`0 0 ${t} ${t}`}get _strokeCircumference(){return 2*Math.PI*this._circleRadius}get _strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}get _circleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const e=this._styleRoot,n=this._diameter,r=t._diameters;let i=r.get(e);if(!i||!i.has(n)){const t=this._document.createElement("style");t.setAttribute("mat-spinner-animation",n+""),t.textContent=this._getAnimationText(),e.appendChild(t),i||(i=new Set,r.set(e,i)),i.add(n)}}_getAnimationText(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,`${.95*this._strokeCircumference}`).replace(/END_VALUE/g,`${.2*this._strokeCircumference}`).replace(/DIAMETER/g,`${this.diameter}`)}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(Cb),xs(el,8),xs(nb,8),xs(rk))},t.\u0275cmp=ve({type:t,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(ys("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),ta("width",e.diameter,"px")("height",e.diameter,"px"),ea("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[wa],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(En(),ks(0,"svg",0),ws(1,QI,1,9,"circle",1),ws(2,JI,1,7,"circle",2),Ts()),2&t&&(ta("width",e.diameter,"px")("height",e.diameter,"px"),Ss("ngSwitch","indeterminate"===e.mode),ys("viewBox",e._viewBox),di(1),Ss("ngSwitchCase",!0),di(1),Ss("ngSwitchCase",!1))},directives:[Ol,Nl],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),t._diameters=new WeakMap,t})(),ok=(()=>{class t extends ik{constructor(t,e,n,r,i){super(t,e,n,r,i),this.mode="indeterminate"}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(Cb),xs(el,8),xs(nb,8),xs(rk))},t.\u0275cmp=ve({type:t,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(t,e){2&t&&(ta("width",e.diameter,"px")("height",e.diameter,"px"),ea("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color"},features:[wa],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(En(),ks(0,"svg",0),ws(1,ZI,1,9,"circle",1),ws(2,tk,1,7,"circle",2),Ts()),2&t&&(ta("width",e.diameter,"px")("height",e.diameter,"px"),Ss("ngSwitch","indeterminate"===e.mode),ys("viewBox",e._viewBox),di(1),Ss("ngSwitchCase",!0),di(1),Ss("ngSwitchCase",!1))},directives:[Ol,Nl],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),t})(),sk=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw,jl],gw]}),t})();const ak=[[["caption"]]],uk=["caption"];function ck(t){return class extends t{constructor(...t){super(...t),this._sticky=!1,this._hasStickyChanged=!1}get sticky(){return this._sticky}set sticky(t){const e=this._sticky;this._sticky=mb(t),this._hasStickyChanged=e!==this._sticky}hasStickyChanged(){const t=this._hasStickyChanged;return this._hasStickyChanged=!1,t}resetStickyChanged(){this._hasStickyChanged=!1}}}const lk=new zt("CDK_TABLE");let hk=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(xs(lu))},t.\u0275dir=Ce({type:t,selectors:[["","cdkCellDef",""]]}),t})(),dk=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(xs(lu))},t.\u0275dir=Ce({type:t,selectors:[["","cdkHeaderCellDef",""]]}),t})(),fk=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(xs(lu))},t.\u0275dir=Ce({type:t,selectors:[["","cdkFooterCellDef",""]]}),t})();class pk{}const mk=ck(pk);let gk=(()=>{class t extends mk{constructor(t){super(),this._table=t,this._stickyEnd=!1}get name(){return this._name}set name(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"))}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const e=this._stickyEnd;this._stickyEnd=mb(t),this._hasStickyChanged=e!==this._stickyEnd}}return t.\u0275fac=function(e){return new(e||t)(xs(lk,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,e,n){var r;1&t&&($u(n,hk,!0),$u(n,dk,!0),$u(n,fk,!0)),2&t&&(Wu(r=Yu())&&(e.cell=r.first),Wu(r=Yu())&&(e.headerCell=r.first),Wu(r=Yu())&&(e.footerCell=r.first))},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[Fa([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:t}]),wa]}),t})();class vk{constructor(t,e){e.nativeElement.classList.add(`cdk-column-${t.cssClassFriendlyName}`)}}let yk=(()=>{class t extends vk{constructor(t,e){super(t,e)}}return t.\u0275fac=function(e){return new(e||t)(xs(gk),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[wa]}),t})(),bk=(()=>{class t extends vk{constructor(t,e){super(t,e)}}return t.\u0275fac=function(e){return new(e||t)(xs(gk),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:["role","gridcell",1,"cdk-cell"],features:[wa]}),t})(),wk=(()=>{class t{constructor(t,e){this.template=t,this._differs=e}ngOnChanges(t){if(!this._columnsDiffer){const e=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(e).create(),this._columnsDiffer.diff(e)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof Ck?t.headerCell.template:this instanceof Ik?t.footerCell.template:t.cell.template}}return t.\u0275fac=function(e){return new(e||t)(xs(lu),xs(ou))},t.\u0275dir=Ce({type:t,features:[Ia]}),t})();class _k extends wk{}const xk=ck(_k);let Ck=(()=>{class t extends xk{constructor(t,e,n){super(t,e),this._table=n}ngOnChanges(t){super.ngOnChanges(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(lu),xs(ou),xs(lk,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[wa,Ia]}),t})();class Ek extends wk{}const Sk=ck(Ek);let Ik=(()=>{class t extends Sk{constructor(t,e,n){super(t,e),this._table=n}ngOnChanges(t){super.ngOnChanges(t)}}return t.\u0275fac=function(e){return new(e||t)(xs(lu),xs(ou),xs(lk,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[wa,Ia]}),t})(),kk=(()=>{class t extends wk{constructor(t,e,n){super(t,e),this._table=n}}return t.\u0275fac=function(e){return new(e||t)(xs(lu),xs(ou),xs(lk,8))},t.\u0275dir=Ce({type:t,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[wa]}),t})(),Tk=(()=>{class t{constructor(e){this._viewContainer=e,t.mostRecentCellOutlet=this}ngOnDestroy(){t.mostRecentCellOutlet===this&&(t.mostRecentCellOutlet=null)}}return t.\u0275fac=function(e){return new(e||t)(xs(du))},t.\u0275dir=Ce({type:t,selectors:[["","cdkCellOutlet",""]]}),t.mostRecentCellOutlet=null,t})(),Ak=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Ns(0,0)},directives:[Tk],encapsulation:2}),t})(),Rk=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Ns(0,0)},directives:[Tk],encapsulation:2}),t})();const Ok=["top","bottom","left","right"];class Nk{constructor(t,e,n,r=!0){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=n,this._isBrowser=r}clearStickyPositioning(t,e){for(const n of t)if(n.nodeType===n.ELEMENT_NODE){this._removeStickyStyle(n,e);for(let t=0;t<n.children.length;t++)this._removeStickyStyle(n.children[t],e)}}updateStickyColumns(t,e,n){const r=e.some(t=>t)||n.some(t=>t);if(!t.length||!r||!this._isBrowser)return;const i=t[0],o=i.children.length,s=this._getCellWidths(i),a=this._getStickyStartColumnPositions(s,e),u=this._getStickyEndColumnPositions(s,n),c="rtl"===this.direction;for(const l of t)for(let t=0;t<o;t++){const r=l.children[t];e[t]&&this._addStickyStyle(r,c?"right":"left",a[t]),n[t]&&this._addStickyStyle(r,c?"left":"right",u[t])}}stickRows(t,e,n){if(!this._isBrowser)return;const r="bottom"===n?t.reverse():t;let i=0;for(let o=0;o<r.length;o++){if(!e[o])continue;const t=r[o];if(this._isNativeHtmlTable)for(let e=0;e<t.children.length;e++)this._addStickyStyle(t.children[e],n,i);else this._addStickyStyle(t,n,i);if(o===r.length-1)return;i+=t.getBoundingClientRect().height}}updateStickyFooterContainer(t,e){if(!this._isNativeHtmlTable)return;const n=t.querySelector("tfoot");e.some(t=>!t)?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0)}_removeStickyStyle(t,e){for(const n of e)t.style[n]="";t.style.zIndex=this._getCalculatedZIndex(t),Ok.some(e=>!!t.style[e])||(t.style.position="",t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,n){t.classList.add(this._stickCellCss),t.style[e]=`${n}px`,t.style.cssText+="position: -webkit-sticky; position: sticky; ",t.style.zIndex=this._getCalculatedZIndex(t)}_getCalculatedZIndex(t){const e={top:100,bottom:10,left:1,right:1};let n=0;for(const r of Ok)t.style[r]&&(n+=e[r]);return n?`${n}`:""}_getCellWidths(t){const e=[],n=t.children;for(let r=0;r<n.length;r++)e.push(n[r].getBoundingClientRect().width);return e}_getStickyStartColumnPositions(t,e){const n=[];let r=0;for(let i=0;i<t.length;i++)e[i]&&(n[i]=r,r+=t[i]);return n}_getStickyEndColumnPositions(t,e){const n=[];let r=0;for(let i=t.length;i>0;i--)e[i]&&(n[i]=r,r+=t[i]);return n}}function Dk(t){return Error(`Could not find column with id "${t}".`)}let Pk=(()=>{class t{constructor(t,e){this.viewContainer=t,this.elementRef=e}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["","rowOutlet",""]]}),t})(),Mk=(()=>{class t{constructor(t,e){this.viewContainer=t,this.elementRef=e}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["","headerRowOutlet",""]]}),t})(),Fk=(()=>{class t{constructor(t,e){this.viewContainer=t,this.elementRef=e}}return t.\u0275fac=function(e){return new(e||t)(xs(du),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["","footerRowOutlet",""]]}),t})(),Lk=(()=>{class t{constructor(t,e,n,r,i,o,s){this._differs=t,this._changeDetectorRef=e,this._elementRef=n,this._dir=i,this._platform=s,this._onDestroy=new T,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this._multiTemplateDataRows=!1,this.viewChange=new tf({start:0,end:Number.MAX_VALUE}),r||this._elementRef.nativeElement.setAttribute("role","grid"),this._document=o,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}get trackBy(){return this._trackByFn}set trackBy(t){Sr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}.`),this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=mb(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&this._forceRenderDataRows()}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,e)=>this.trackBy?this.trackBy(e.dataIndex,e.data):e)}ngAfterContentChecked(){if(this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&!this._rowDefs.length)throw Error("Missing definitions for header, footer, and row; cannot determine which columns should be rendered.");this._renderUpdatedColumns(),this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription&&this._observeRenderChanges(),this._checkStickyStates()}ngOnDestroy(){this._rowOutlet.viewContainer.clear(),this._headerRowOutlet.viewContainer.clear(),this._footerRowOutlet.viewContainer.clear(),this._cachedRenderRowsMap.clear(),this._onDestroy.next(),this._onDestroy.complete(),sx(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return;const e=this._rowOutlet.viewContainer;t.forEachOperation((t,n,r)=>{if(null==t.previousIndex)this._insertRow(t.item,r);else if(null==r)e.remove(n);else{const t=e.get(n);e.move(t,r)}}),this._updateRowIndexContext(),t.forEachIdentityChange(t=>{e.get(t.currentIndex).context.$implicit=t.item.data}),this.updateStickyColumnStyles()}setHeaderRowDef(t){this._customHeaderRowDefs=new Set([t]),this._headerRowDefChanged=!0}setFooterRowDef(t){this._customFooterRowDefs=new Set([t]),this._footerRowDefChanged=!0}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),e=this._elementRef.nativeElement.querySelector("thead");e&&(e.style.display=t.length?"":"none");const n=this._headerRowDefs.map(t=>t.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,n,"top"),this._headerRowDefs.forEach(t=>t.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),e=this._elementRef.nativeElement.querySelector("tfoot");e&&(e.style.display=t.length?"":"none");const n=this._footerRowDefs.map(t=>t.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,n,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,n),this._footerRowDefs.forEach(t=>t.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),e=this._getRenderedRows(this._rowOutlet),n=this._getRenderedRows(this._footerRowOutlet);this._stickyStyler.clearStickyPositioning([...t,...e,...n],["left","right"]),t.forEach((t,e)=>{this._addStickyColumnStyles([t],this._headerRowDefs[e])}),this._rowDefs.forEach(t=>{const n=[];for(let r=0;r<e.length;r++)this._renderRows[r].rowDef===t&&n.push(e[r]);this._addStickyColumnStyles(n,t)}),n.forEach((t,e)=>{this._addStickyColumnStyles([t],this._footerRowDefs[e])}),Array.from(this._columnDefsByName.values()).forEach(t=>t.resetStickyChanged())}_getAllRenderRows(){const t=[],e=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let n=0;n<this._data.length;n++){let r=this._data[n];const i=this._getRenderRowsForData(r,n,e.get(r));this._cachedRenderRowsMap.has(r)||this._cachedRenderRowsMap.set(r,new WeakMap);for(let e=0;e<i.length;e++){let n=i[e];const r=this._cachedRenderRowsMap.get(n.data);r.has(n.rowDef)?r.get(n.rowDef).push(n):r.set(n.rowDef,[n]),t.push(n)}}return t}_getRenderRowsForData(t,e,n){return this._getRowDefs(t,e).map(r=>{const i=n&&n.has(r)?n.get(r):[];if(i.length){const t=i.shift();return t.dataIndex=e,t}return{data:t,rowDef:r,dataIndex:e}})}_cacheColumnDefs(){this._columnDefsByName.clear(),Bk(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(t=>{if(this._columnDefsByName.has(t.name))throw function(t){return Error(`Duplicate column definition name provided: "${t}".`)}(t.name);this._columnDefsByName.set(t.name,t)})}_cacheRowDefs(){this._headerRowDefs=Bk(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=Bk(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=Bk(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(t=>!t.when);if(!this.multiTemplateDataRows&&t.length>1)throw Error("There can only be one default row without a when predicate function.");this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(t,e)=>t||!!e.getColumnsDiff();this._rowDefs.reduce(t,!1)&&this._forceRenderDataRows(),this._headerRowDefs.reduce(t,!1)&&this._forceRenderHeaderRows(),this._footerRowDefs.reduce(t,!1)&&this._forceRenderFooterRows()}_switchDataSource(t){this._data=[],sx(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;if(sx(this.dataSource)?t=this.dataSource.connect(this):(e=this.dataSource)&&(e instanceof C||"function"==typeof e.lift&&"function"==typeof e.subscribe)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=Zd(this.dataSource)),void 0===t)throw Error("Provided data source did not match an array, Observable, or DataSource");var e;this._renderChangeSubscription=t.pipe($_(this._onDestroy)).subscribe(t=>{this._data=t||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,e)=>this._renderRow(this._headerRowOutlet,t,e)),this.updateStickyHeaderRowStyles(),this.updateStickyColumnStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,e)=>this._renderRow(this._footerRowOutlet,t,e)),this.updateStickyFooterRowStyles(),this.updateStickyColumnStyles()}_addStickyColumnStyles(t,e){const n=Array.from(e.columns||[]).map(t=>{const e=this._columnDefsByName.get(t);if(!e)throw Dk(t);return e}),r=n.map(t=>t.sticky),i=n.map(t=>t.stickyEnd);this._stickyStyler.updateStickyColumns(t,r,i)}_getRenderedRows(t){const e=[];for(let n=0;n<t.viewContainer.length;n++){const r=t.viewContainer.get(n);e.push(r.rootNodes[0])}return e}_getRowDefs(t,e){if(1==this._rowDefs.length)return[this._rowDefs[0]];let n=[];if(this.multiTemplateDataRows)n=this._rowDefs.filter(n=>!n.when||n.when(e,t));else{let r=this._rowDefs.find(n=>n.when&&n.when(e,t))||this._defaultRowDef;r&&n.push(r)}if(!n.length)throw function(t){return Error("Could not find a matching row definition for the"+`provided row data: ${JSON.stringify(t)}`)}(t);return n}_insertRow(t,e){this._renderRow(this._rowOutlet,t.rowDef,e,{$implicit:t.data})}_renderRow(t,e,n,r={}){t.viewContainer.createEmbeddedView(e.template,r,n);for(let i of this._getCellTemplates(e))Tk.mostRecentCellOutlet&&Tk.mostRecentCellOutlet._viewContainer.createEmbeddedView(i,r);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let e=0,n=t.length;e<n;e++){const r=t.get(e).context;r.count=n,r.first=0===e,r.last=e===n-1,r.even=e%2==0,r.odd=!r.even,this.multiTemplateDataRows?(r.dataIndex=this._renderRows[e].dataIndex,r.renderIndex=e):r.index=this._renderRows[e].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,e=>{const n=this._columnDefsByName.get(e);if(!n)throw Dk(e);return t.extractCellTemplate(n)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),e=[{tag:"thead",outlet:this._headerRowOutlet},{tag:"tbody",outlet:this._rowOutlet},{tag:"tfoot",outlet:this._footerRowOutlet}];for(const n of e){const e=this._document.createElement(n.tag);e.setAttribute("role","rowgroup"),e.appendChild(n.outlet.elementRef.nativeElement),t.appendChild(e)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows(),this.updateStickyColumnStyles()}_checkStickyStates(){const t=(t,e)=>t||e.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&this.updateStickyColumnStyles()}_setupStickyStyler(){this._stickyStyler=new Nk(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._platform.isBrowser),(this._dir?this._dir.change:Zd()).pipe($_(this._onDestroy)).subscribe(t=>{this._stickyStyler.direction=t,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(t=>!t._table||t._table===this)}}return t.\u0275fac=function(e){return new(e||t)(xs(ou),xs(zo),xs(Va),Cs("role"),xs(ow,8),xs(el),xs(Cb))},t.\u0275cmp=ve({type:t,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,e,n){var r;1&t&&($u(n,gk,!0),$u(n,kk,!0),$u(n,Ck,!0),$u(n,Ik,!0)),2&t&&(Wu(r=Yu())&&(e._contentColumnDefs=r),Wu(r=Yu())&&(e._contentRowDefs=r),Wu(r=Yu())&&(e._contentHeaderRowDefs=r),Wu(r=Yu())&&(e._contentFooterRowDefs=r))},viewQuery:function(t,e){var n;1&t&&(qu(Pk,!0),qu(Mk,!0),qu(Fk,!0)),2&t&&(Wu(n=Yu())&&(e._rowOutlet=n.first),Wu(n=Yu())&&(e._headerRowOutlet=n.first),Wu(n=Yu())&&(e._footerRowOutlet=n.first))},hostAttrs:[1,"cdk-table"],inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows"},exportAs:["cdkTable"],features:[Fa([{provide:lk,useExisting:t}])],ngContentSelectors:uk,decls:4,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["footerRowOutlet",""]],template:function(t,e){1&t&&(Ws(ak),qs(0),Ns(1,0),Ns(2,1),Ns(3,2))},directives:[Mk,Pk,Fk],encapsulation:2}),t})();function Bk(t,e){return t.concat(Array.from(e))}let jk=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})();const Vk=[[["caption"]]],Uk=["caption"];let zk=(()=>{class t extends Lk{constructor(){super(...arguments),this.stickyCssClass="mat-table-sticky"}}return t.\u0275fac=function(e){return Wk(e||t)},t.\u0275cmp=ve({type:t,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-table"],exportAs:["matTable"],features:[Fa([{provide:Lk,useExisting:t},{provide:lk,useExisting:t}]),wa],ngContentSelectors:Uk,decls:4,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["footerRowOutlet",""]],template:function(t,e){1&t&&(Ws(Vk),qs(0),Ns(1,0),Ns(2,1),Ns(3,2))},directives:[Mk,Pk,Fk],styles:['mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-row::after,mat-header-row::after,mat-footer-row::after{display:inline-block;min-height:inherit;content:""}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type,[dir=rtl] mat-header-cell:first-of-type,[dir=rtl] mat-footer-cell:first-of-type{padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type,[dir=rtl] mat-header-cell:last-of-type,[dir=rtl] mat-footer-cell:last-of-type{padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}table.mat-table{border-spacing:0}tr.mat-header-row{height:56px}tr.mat-row,tr.mat-footer-row{height:48px}th.mat-header-cell{text-align:left}[dir=rtl] th.mat-header-cell{text-align:right}th.mat-header-cell,td.mat-cell,td.mat-footer-cell{padding:0;border-bottom-width:1px;border-bottom-style:solid}th.mat-header-cell:first-of-type,td.mat-cell:first-of-type,td.mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] th.mat-header-cell:first-of-type,[dir=rtl] td.mat-cell:first-of-type,[dir=rtl] td.mat-footer-cell:first-of-type{padding-left:0;padding-right:24px}th.mat-header-cell:last-of-type,td.mat-cell:last-of-type,td.mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] th.mat-header-cell:last-of-type,[dir=rtl] td.mat-cell:last-of-type,[dir=rtl] td.mat-footer-cell:last-of-type{padding-right:0;padding-left:24px}\n'],encapsulation:2}),t})();const Wk=cr(zk);let qk=(()=>{class t extends hk{}return t.\u0275fac=function(e){return Hk(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matCellDef",""]],features:[Fa([{provide:hk,useExisting:t}]),wa]}),t})();const Hk=cr(qk);let Gk=(()=>{class t extends dk{}return t.\u0275fac=function(e){return $k(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matHeaderCellDef",""]],features:[Fa([{provide:dk,useExisting:t}]),wa]}),t})();const $k=cr(Gk);let Kk=(()=>{class t extends gk{}return t.\u0275fac=function(e){return Xk(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[Fa([{provide:gk,useExisting:t},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:t}]),wa]}),t})();const Xk=cr(Kk);let Yk=(()=>{class t extends yk{constructor(t,e){super(t,e),e.nativeElement.classList.add(`mat-column-${t.cssClassFriendlyName}`)}}return t.\u0275fac=function(e){return new(e||t)(xs(gk),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-header-cell"],features:[wa]}),t})(),Qk=(()=>{class t extends bk{constructor(t,e){super(t,e),e.nativeElement.classList.add(`mat-column-${t.cssClassFriendlyName}`)}}return t.\u0275fac=function(e){return new(e||t)(xs(gk),xs(Va))},t.\u0275dir=Ce({type:t,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:["role","gridcell",1,"mat-cell"],features:[wa]}),t})(),Jk=(()=>{class t extends Ck{}return t.\u0275fac=function(e){return Zk(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[Fa([{provide:Ck,useExisting:t}]),wa]}),t})();const Zk=cr(Jk);let tT=(()=>{class t extends kk{}return t.\u0275fac=function(e){return eT(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[Fa([{provide:kk,useExisting:t}]),wa]}),t})();const eT=cr(tT);let nT=(()=>{class t extends Ak{}return t.\u0275fac=function(e){return rT(e||t)},t.\u0275cmp=ve({type:t,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-header-row"],exportAs:["matHeaderRow"],features:[Fa([{provide:Ak,useExisting:t}]),wa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Ns(0,0)},directives:[Tk],encapsulation:2}),t})();const rT=cr(nT);let iT=(()=>{class t extends Rk{}return t.\u0275fac=function(e){return oT(e||t)},t.\u0275cmp=ve({type:t,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-row"],exportAs:["matRow"],features:[Fa([{provide:Rk,useExisting:t}]),wa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Ns(0,0)},directives:[Tk],encapsulation:2}),t})();const oT=cr(iT);let sT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jk,gw],gw]}),t})();class aT extends class{}{constructor(t=[]){super(),this._renderData=new tf([]),this._filter=new tf(""),this._internalPageChanges=new T,this._renderChangesSubscription=p.EMPTY,this.sortingDataAccessor=(t,e)=>{const n=t[e];if(vb(n)){const t=Number(n);return t<9007199254740991?t:n}return n},this.sortData=(t,e)=>{const n=e.active,r=e.direction;return n&&""!=r?t.sort((t,e)=>{let i=this.sortingDataAccessor(t,n),o=this.sortingDataAccessor(e,n),s=0;return null!=i&&null!=o?i>o?s=1:i<o&&(s=-1):null!=i?s=1:null!=o&&(s=-1),s*("asc"==r?1:-1)}):t},this.filterPredicate=(t,e)=>{const n=Object.keys(t).reduce((e,n)=>e+t[n]+"\u25ec","").toLowerCase(),r=e.trim().toLowerCase();return-1!=n.indexOf(r)},this._data=new tf(t),this._updateChangeSubscription()}get data(){return this._data.value}set data(t){this._data.next(t)}get filter(){return this._filter.value}set filter(t){this._filter.next(t)}get sort(){return this._sort}set sort(t){this._sort=t,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(t){this._paginator=t,this._updateChangeSubscription()}_updateChangeSubscription(){const t=this._sort?Y(this._sort.sortChange,this._sort.initialized):Zd(null),e=this._paginator?Y(this._paginator.page,this._internalPageChanges,this._paginator.initialized):Zd(null),n=rf([this._data,this._filter]).pipe(V(([t])=>this._filterData(t))),r=rf([n,t]).pipe(V(([t])=>this._orderData(t))),i=rf([r,e]).pipe(V(([t])=>this._pageData(t)));this._renderChangesSubscription.unsubscribe(),this._renderChangesSubscription=i.subscribe(t=>this._renderData.next(t))}_filterData(t){return this.filteredData=this.filter?t.filter(t=>this.filterPredicate(t,this.filter)):t,this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(t){return this.sort?this.sortData(t.slice(),this.sort):t}_pageData(t){if(!this.paginator)return t;const e=this.paginator.pageIndex*this.paginator.pageSize;return t.slice(e,e+this.paginator.pageSize)}_updatePaginator(t){Promise.resolve().then(()=>{const e=this.paginator;if(e&&(e.length=t,e.pageIndex>0)){const t=Math.ceil(e.length/e.pageSize)-1||0,n=Math.min(e.pageIndex,t);n!==e.pageIndex&&(e.pageIndex=n,this._internalPageChanges.next())}})}connect(){return this._renderData}disconnect(){}}let uT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Gw,gw],gw]}),t})();function cT(t,e){if(1&t){const t=Ds();ks(0,"div",1),ks(1,"button",2),Fs("click",(function(){return Ze(t),Us().action()})),fa(2),Ts(),Ts()}if(2&t){const t=Us();di(2),pa(t.data.action)}}function lT(t,e){}const hT=Math.pow(2,31)-1;class dT{constructor(t,e){this._overlayRef=e,this._afterDismissed=new T,this._afterOpened=new T,this._onAction=new T,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe(()=>this.dismiss()),t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,hT))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed.asObservable()}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction.asObservable()}}const fT=new zt("MatSnackBarData");class pT{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let mT=(()=>{class t{constructor(t,e){this.snackBarRef=t,this.data=e}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return t.\u0275fac=function(e){return new(e||t)(xs(dT),xs(fT))},t.\u0275cmp=ve({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(ks(0,"span"),fa(1),Ts(),ws(2,cT,3,1,"div",0)),2&t&&(di(1),pa(e.data.message),di(1),Ss("ngIf",e.hasAction))},directives:[kl,k_],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),t})();const gT={snackBarState:Fg("state",[Vg("void, hidden",jg({transform:"scale(0.8)",opacity:0})),Vg("visible",jg({transform:"scale(1)",opacity:1})),zg("* => visible",Lg("150ms cubic-bezier(0, 0, 0.2, 1)")),zg("* => void, * => hidden",Lg("75ms cubic-bezier(0.4, 0.0, 1, 1)",jg({opacity:0})))])};let vT=(()=>{class t extends yx{constructor(t,e,n,r){super(),this._ngZone=t,this._elementRef=e,this._changeDetectorRef=n,this.snackBarConfig=r,this._destroyed=!1,this._onExit=new T,this._onEnter=new T,this._animationState="void",this.attachDomPortal=t=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(t)),this._role="assertive"!==r.politeness||r.announcementMessage?"off"===r.politeness?null:"status":"alert"}attachComponentPortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(t)}onAnimationEnd(t){const{fromState:e,toState:n}=t;if(("void"===n&&"void"!==e||"hidden"===n)&&this._completeExit(),"visible"===n){const t=this._onEnter;this._ngZone.run(()=>{t.next(),t.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}exit(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.asObservable().pipe(Af(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const t=this._elementRef.nativeElement,e=this.snackBarConfig.panelClass;e&&(Array.isArray(e)?e.forEach(e=>t.classList.add(e)):t.classList.add(e)),"center"===this.snackBarConfig.horizontalPosition&&t.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&t.classList.add("mat-snack-bar-top")}_assertNotAttached(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}return t.\u0275fac=function(e){return new(e||t)(xs(xc),xs(Va),xs(zo),xs(pT))},t.\u0275cmp=ve({type:t,selectors:[["snack-bar-container"]],viewQuery:function(t,e){var n;1&t&&qu(wx,!0),2&t&&Wu(n=Yu())&&(e._portalOutlet=n.first)},hostAttrs:[1,"mat-snack-bar-container"],hostVars:2,hostBindings:function(t,e){1&t&&Ls("@state.done",(function(t){return e.onAnimationEnd(t)})),2&t&&(ys("role",e._role),ya("@state",e._animationState))},features:[wa],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&ws(0,lT,0,0,"ng-template",0)},directives:[wx],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[gT.snackBarState]}}),t})(),yT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[tC,_x,jl,A_,gw],gw]}),t})();const bT=new zt("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new pT}});let wT=(()=>{class t{constructor(t,e,n,r,i,o){this._overlay=t,this._live=e,this._injector=n,this._breakpointObserver=r,this._parentSnackBar=i,this._defaultConfig=o,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}openFromComponent(t,e){return this._attach(t,e)}openFromTemplate(t,e){return this._attach(t,e)}open(t,e="",n){const r=Object.assign(Object.assign({},this._defaultConfig),n);return r.data={message:t,action:e},r.announcementMessage||(r.announcementMessage=t),this.openFromComponent(mT,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(t,e){const n=new xx(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[pT,e]])),r=new mx(vT,e.viewContainerRef,n),i=t.attach(r);return i.instance.snackBarConfig=e,i.instance}_attach(t,e){const n=Object.assign(Object.assign(Object.assign({},new pT),this._defaultConfig),e),r=this._createOverlay(n),i=this._attachSnackBarContainer(r,n),o=new dT(i,r);if(t instanceof lu){const e=new gx(t,null,{$implicit:n.data,snackBarRef:o});o.instance=i.attachTemplatePortal(e)}else{const e=this._createInjector(n,o),r=new mx(t,void 0,e),s=i.attachComponentPortal(r);o.instance=s.instance}return this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait)").pipe($_(r.detachments())).subscribe(t=>{const e=r.overlayElement.classList;t.matches?e.add("mat-snack-bar-handset"):e.remove("mat-snack-bar-handset")}),this._animateSnackBar(o,n),this._openedSnackBarRef=o,this._openedSnackBarRef}_animateSnackBar(t,e){t.afterDismissed().subscribe(()=>{this._openedSnackBarRef==t&&(this._openedSnackBarRef=null),e.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{t.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),e.duration&&e.duration>0&&t.afterOpened().subscribe(()=>t._dismissAfter(e.duration)),e.announcementMessage&&this._live.announce(e.announcementMessage,e.politeness)}_createOverlay(t){const e=new Ox;e.direction=t.direction;let n=this._overlay.position().global();const r="rtl"===t.direction,i="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!r||"end"===t.horizontalPosition&&r,o=!i&&"center"!==t.horizontalPosition;return i?n.left("0"):o?n.right("0"):n.centerHorizontally(),"top"===t.verticalPosition?n.top("0"):n.bottom("0"),e.positionStrategy=n,this._overlay.create(e)}_createInjector(t,e){return new xx(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[dT,e],[fT,t.data]]))}}return t.\u0275fac=function(e){return new(e||t)(Jt(Kx),Jt(Yb),Jt(is),Jt(uE),Jt(t,12),Jt(bT))},t.\u0275prov=pt({factory:function(){return new t(Jt(Kx),Jt(Yb),Jt(Wt),Jt(uE),Jt(t,12),Jt(bT))},token:t,providedIn:yT}),t})(),_T=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})(),xT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Gw,gw,Fb,_T],gw,_T]}),t})(),CT=(()=>{class t{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=mb(t)}get inset(){return this._inset}set inset(t){this._inset=mb(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(t,e){2&t&&(ys("aria-orientation",e.vertical?"vertical":"horizontal"),ea("mat-divider-vertical",e.vertical)("mat-divider-horizontal",!e.vertical)("mat-divider-inset",e.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(t,e){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),t})(),ET=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[gw],gw]}),t})(),ST=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Lw,Gw,gw,Kw,jl],Lw,gw,Kw,ET]}),t})(),IT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})(),kT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl,IT,_x]]}),t})(),TT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)}}),t})(),AT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[TT,Gw,gw,Fb],TT,gw]}),t})();const RT={provide:new zt("mat-menu-scroll-strategy"),deps:[Kx],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let OT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[RT],imports:[gw]}),t})(),NT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[RT],imports:[[jl,gw,Gw,tC,OT],hx,gw,OT]}),t})(),DT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[jl],ib,DI,A_,IS,GI,YI,MC,sk,wI,sT,o_,NT,eE,uT,yT,lI,xT,ST,w_,II,GS,CI,__,CI,Mw,OE,yE,AS,RS,HS,GS,kT,__,AT,ET]}),t})();const PT={provide:ac,useFactory:function(t,e){return()=>{if(Vl(e)){const e=Array.from(t.querySelectorAll(`[class*=${MT}]`)),n=/\bflex-layout-.+?\b/g;e.forEach(t=>{t.classList.contains(`${MT}ssr`)&&t.parentNode?t.parentNode.removeChild(t):t.className.replace(n,"")})}}},deps:[el,sc],multi:!0},MT="flex-layout-";let FT=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[PT]}),t})();class LT{constructor(t=!1,e="all",n="",r="",i=0){this.matches=t,this.mediaQuery=e,this.mqAlias=n,this.suffix=r,this.priority=i,this.property=""}clone(){return new LT(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}let BT=(()=>{class t{constructor(){this.stylesheet=new Map}addStyleToElement(t,e,n){const r=this.stylesheet.get(t);r?r.set(e,n):this.stylesheet.set(t,new Map([[e,n]]))}clearStyles(){this.stylesheet.clear()}getStyleForElement(t,e){const n=this.stylesheet.get(t);let r="";if(n){const t=n.get(e);"number"!=typeof t&&"string"!=typeof t||(r=t+"")}return r}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const jT={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[]},VT=new zt("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>jT}),UT=new zt("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),zT=new zt("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null});function WT(t,e){return t=t?t.clone():new LT,e&&(t.mqAlias=e.alias,t.mediaQuery=e.mediaQuery,t.suffix=e.suffix,t.priority=e.priority),t}const qT=["row","column","row-reverse","column-reverse"];function HT(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}let GT=(()=>{class t{constructor(t,e,n,r){this.elementRef=t,this.styleBuilder=e,this.styler=n,this.marshal=r,this.DIRECTIVE_KEY="",this.inputs=[],this.mru={},this.destroySubject=new T,this.styleCache=new Map}get parentElement(){return this.elementRef.nativeElement.parentElement}get nativeElement(){return this.elementRef.nativeElement}get activatedValue(){return this.marshal.getValue(this.nativeElement,this.DIRECTIVE_KEY)}set activatedValue(t){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,this.marshal.activatedAlias)}ngOnChanges(t){Object.keys(t).forEach(e=>{if(-1!==this.inputs.indexOf(e)){const n=e.split(".").slice(1).join(".");this.setValue(t[e].currentValue,n)}})}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete(),this.marshal.releaseElement(this.nativeElement)}init(t=[]){this.marshal.init(this.elementRef.nativeElement,this.DIRECTIVE_KEY,this.updateWithValue.bind(this),this.clearStyles.bind(this),t)}addStyles(t,e){const n=this.styleBuilder,r=n.shouldCache;let i=this.styleCache.get(t);i&&r||(i=n.buildStyles(t,e),r&&this.styleCache.set(t,i)),this.mru=Object.assign({},i),this.applyStyleToElement(i),n.sideEffect(t,i,e)}clearStyles(){Object.keys(this.mru).forEach(t=>{this.mru[t]=""}),this.applyStyleToElement(this.mru),this.mru={}}triggerUpdate(){this.marshal.triggerUpdate(this.nativeElement,this.DIRECTIVE_KEY)}getFlexFlowDirection(t,e=!1){if(t){const[n,r]=this.styler.getFlowDirection(t);if(!r&&e){const e=function(t){let[e,n,r]=function(t){t=t?t.toLowerCase():"";let[e,n,r]=t.split(" ");return qT.find(t=>t===e)||(e=qT[0]),"inline"===n&&(n="inline"!==r?r:"",r="inline"),[e,HT(n),!!r]}(t);return function(t,e=null,n=!1){return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}(e,n,r)}(n);this.styler.applyStyleToElements(e,[t])}return n.trim()}return"row"}hasWrap(t){return this.styler.hasWrap(t)}applyStyleToElement(t,e,n=this.nativeElement){this.styler.applyStyleToElement(n,t,e)}setValue(t,e){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,e)}updateWithValue(t){this.currentValue!==t&&(this.addStyles(t),this.currentValue=t)}}return t.\u0275fac=function(t){Es()},t.\u0275dir=Ce({type:t,features:[Ia]}),t})();const $T=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.9px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.9px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.9px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.9px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.9px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.9px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.9px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.9px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.9px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],KT="(orientation: portrait) and (min-width: 600px) and (max-width: 839.9px)",XT="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.9px)",YT="(orientation: portrait) and (min-width: 840px)",QT="(orientation: landscape) and (min-width: 1280px)",JT={HANDSET:"(orientation: portrait) and (max-width: 599.9px), (orientation: landscape) and (max-width: 959.9px)",TABLET:`${KT} , ${XT}`,WEB:`${YT}, ${QT} `,HANDSET_PORTRAIT:"(orientation: portrait) and (max-width: 599.9px)",TABLET_PORTRAIT:`${KT} `,WEB_PORTRAIT:`${YT}`,HANDSET_LANDSCAPE:"(orientation: landscape) and (max-width: 959.9px)",TABLET_LANDSCAPE:`${XT}`,WEB_LANDSCAPE:`${QT}`},ZT=[{alias:"handset",priority:2e3,mediaQuery:JT.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:JT.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:JT.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:JT.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:JT.TABLET_LANDSCAPE},{alias:"tablet.portrait",priority:2100,mediaQuery:JT.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:JT.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:JT.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:JT.WEB_PORTRAIT,overlapping:!0}],tA=/(\.|-|_)/g;function eA(t){let e=t.length>0?t.charAt(0):"",n=t.length>1?t.slice(1):"";return e.toUpperCase()+n}const nA=new zt("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:()=>{const t=Zt(zT),e=Zt(VT),n=[].concat.apply([],(t||[]).map(t=>Array.isArray(t)?t:[t]));return function(t,e=[]){const n={};return t.forEach(t=>{n[t.alias]=t}),e.forEach(t=>{n[t.alias]?function(t,...e){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(let n of e)if(null!=n)for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}(n[t.alias],t):n[t.alias]=t}),(r=Object.keys(n).map(t=>n[t])).forEach(t=>{t.suffix||(t.suffix=function(t){return t.replace(tA,"|").split("|").map(eA).join("")}(t.alias),t.overlapping=!!t.overlapping)}),r;var r}((e.disableDefaultBps?[]:$T).concat(e.addOrientationBps?ZT:[]),n)}});function rA(t,e){return(e&&e.priority||0)-(t&&t.priority||0)}function iA(t,e){return(t.priority||0)-(e.priority||0)}let oA=(()=>{class t{constructor(t){this.findByMap=new Map,this.items=[...t].sort(iA)}findByAlias(t){return t?this.findWithPredicate(t,e=>e.alias==t):null}findByQuery(t){return this.findWithPredicate(t,e=>e.mediaQuery==t)}get overlappings(){return this.items.filter(t=>1==t.overlapping)}get aliases(){return this.items.map(t=>t.alias)}get suffixes(){return this.items.map(t=>t.suffix?t.suffix:"")}findWithPredicate(t,e){let n=this.findByMap.get(t);return n||(n=this.items.find(e)||null,this.findByMap.set(t,n)),n||null}}return t.\u0275fac=function(e){return new(e||t)(Jt(nA))},t.\u0275prov=pt({factory:function(){return new t(Jt(nA))},token:t,providedIn:"root"}),t})(),sA=(()=>{class t{constructor(t,e,n){this._zone=t,this._platformId=e,this._document=n,this.source=new tf(new LT(!0)),this.registry=new Map,this.pendingRemoveListenerFns=[],this._observable$=this.source.asObservable()}get activations(){const t=[];return this.registry.forEach((e,n)=>{e.matches&&t.push(n)}),t}isActive(t){const e=this.registry.get(t);return e?e.matches:this.registerQuery(t).some(t=>t.matches)}observe(t,e=!1){if(t&&t.length){const n=this._observable$.pipe(hf(n=>!e||t.indexOf(n.mediaQuery)>-1));return Y(new C(e=>{const n=this.registerQuery(t);if(n.length){const t=n.pop();n.forEach(t=>{e.next(t)}),this.source.next(t)}e.complete()}),n)}return this._observable$}registerQuery(t){const e=Array.isArray(t)?t:[t],n=[];return function(t,e){const n=t.filter(t=>!aA[t]);if(n.length>0){const t=n.join(", ");try{const r=e.createElement("style");r.setAttribute("type","text/css"),r.styleSheet||r.appendChild(e.createTextNode(`\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ${t} {.fx-query-test{ }}\n`)),e.head.appendChild(r),n.forEach(t=>aA[t]=r)}catch(r){console.error(r)}}}(e,this._document),e.forEach(t=>{const e=e=>{this._zone.run(()=>this.source.next(new LT(e.matches,t)))};let r=this.registry.get(t);r||(r=this.buildMQL(t),r.addListener(e),this.pendingRemoveListenerFns.push(()=>r.removeListener(e)),this.registry.set(t,r)),r.matches&&n.push(new LT(!0,t))}),n}ngOnDestroy(){let t;for(;t=this.pendingRemoveListenerFns.pop();)t()}buildMQL(t){return function(t,e){return e&&window.matchMedia("all").addListener?window.matchMedia(t):{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{},onchange:null,addEventListener(){},removeEventListener(){},dispatchEvent:()=>!1}}(t,Vl(this._platformId))}}return t.\u0275fac=function(e){return new(e||t)(Jt(xc),Jt(sc),Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(xc),Jt(sc),Jt(el))},token:t,providedIn:"root"}),t})();const aA={},uA={alias:"print",mediaQuery:"print",priority:1e3};let cA=(()=>{class t{constructor(t,e,n){this.breakpoints=t,this.layoutConfig=e,this._document=n,this.registeredBeforeAfterPrintHooks=!1,this.isPrintingBeforeAfterEvent=!1,this.beforePrintEventListeners=[],this.afterPrintEventListeners=[],this.isPrinting=!1,this.queue=new lA,this.deactivations=[]}withPrintQuery(t){return[...t,"print"]}isPrintEvent(t){return t.mediaQuery.startsWith("print")}get printAlias(){return this.layoutConfig.printWithBreakpoints||[]}get printBreakPoints(){return this.printAlias.map(t=>this.breakpoints.findByAlias(t)).filter(t=>null!==t)}getEventBreakpoints({mediaQuery:t}){const e=this.breakpoints.findByQuery(t);return(e?[...this.printBreakPoints,e]:this.printBreakPoints).sort(rA)}updateEvent(t){let e=this.breakpoints.findByQuery(t.mediaQuery);return this.isPrintEvent(t)&&(e=this.getEventBreakpoints(t)[0],t.mediaQuery=e?e.mediaQuery:""),WT(t,e)}registerBeforeAfterPrintHooks(t){if(!this._document.defaultView||this.registeredBeforeAfterPrintHooks)return;this.registeredBeforeAfterPrintHooks=!0;const e=()=>{this.isPrinting||(this.isPrintingBeforeAfterEvent=!0,this.startPrinting(t,this.getEventBreakpoints(new LT(!0,"print"))),t.updateStyles())},n=()=>{this.isPrintingBeforeAfterEvent=!1,this.isPrinting&&(this.stopPrinting(t),t.updateStyles())};this._document.defaultView.addEventListener("beforeprint",e),this._document.defaultView.addEventListener("afterprint",n),this.beforePrintEventListeners.push(e),this.afterPrintEventListeners.push(n)}interceptEvents(t){return this.registerBeforeAfterPrintHooks(t),e=>{this.isPrintEvent(e)?e.matches&&!this.isPrinting?(this.startPrinting(t,this.getEventBreakpoints(e)),t.updateStyles()):e.matches||!this.isPrinting||this.isPrintingBeforeAfterEvent||(this.stopPrinting(t),t.updateStyles()):this.collectActivations(e)}}blockPropagation(){return t=>!(this.isPrinting||this.isPrintEvent(t))}startPrinting(t,e){this.isPrinting=!0,t.activatedBreakpoints=this.queue.addPrintBreakpoints(e)}stopPrinting(t){t.activatedBreakpoints=this.deactivations,this.deactivations=[],this.queue.clear(),this.isPrinting=!1}collectActivations(t){if(!this.isPrinting||this.isPrintingBeforeAfterEvent)if(t.matches)this.isPrintingBeforeAfterEvent||(this.deactivations=[]);else{const e=this.breakpoints.findByQuery(t.mediaQuery);e&&(this.deactivations.push(e),this.deactivations.sort(rA))}}ngOnDestroy(){this.beforePrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("beforeprint",t)),this.afterPrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("afterprint",t))}}return t.\u0275fac=function(e){return new(e||t)(Jt(oA),Jt(VT),Jt(el))},t.\u0275prov=pt({factory:function(){return new t(Jt(oA),Jt(VT),Jt(el))},token:t,providedIn:"root"}),t})();class lA{constructor(){this.printBreakpoints=[]}addPrintBreakpoints(t){return t.push(uA),t.sort(rA),t.forEach(t=>this.addBreakpoint(t)),this.printBreakpoints}addBreakpoint(t){t&&void 0===this.printBreakpoints.find(e=>e.mediaQuery===t.mediaQuery)&&(this.printBreakpoints=function(t){return!!t&&t.mediaQuery.startsWith("print")}(t)?[t,...this.printBreakpoints]:[...this.printBreakpoints,t])}clear(){this.printBreakpoints=[]}}function hA(t){for(let e in t){let n=t[e]||"";switch(e){case"display":t.display="flex"===n?["-webkit-flex","flex"]:"inline-flex"===n?["-webkit-inline-flex","inline-flex"]:n;break;case"align-items":case"align-self":case"align-content":case"flex":case"flex-basis":case"flex-flow":case"flex-grow":case"flex-shrink":case"flex-wrap":case"justify-content":t["-webkit-"+e]=n;break;case"flex-direction":n=n||"row",t["-webkit-flex-direction"]=n,t["flex-direction"]=n;break;case"order":t.order=t["-webkit-"+e]=isNaN(+n)?"0":n}}return t}let dA=(()=>{class t{constructor(t,e,n,r){this._serverStylesheet=t,this._serverModuleLoaded=e,this._platformId=n,this.layoutConfig=r}applyStyleToElement(t,e,n=null){let r={};"string"==typeof e&&(r[e]=n,e=r),r=this.layoutConfig.disableVendorPrefixes?e:hA(e),this._applyMultiValueStyleToElement(r,t)}applyStyleToElements(t,e=[]){const n=this.layoutConfig.disableVendorPrefixes?t:hA(t);e.forEach(t=>{this._applyMultiValueStyleToElement(n,t)})}getFlowDirection(t){let e=this.lookupStyle(t,"flex-direction");return[e||"row",this.lookupInlineStyle(t,"flex-direction")||Ul(this._platformId)&&this._serverModuleLoaded?e:""]}hasWrap(t){return"wrap"===this.lookupStyle(t,"flex-wrap")}lookupAttributeValue(t,e){return t.getAttribute(e)||""}lookupInlineStyle(t,e){return Vl(this._platformId)?t.style.getPropertyValue(e):this._getServerStyle(t,e)}lookupStyle(t,e,n=!1){let r="";return t&&((r=this.lookupInlineStyle(t,e))||(Vl(this._platformId)?n||(r=getComputedStyle(t).getPropertyValue(e)):this._serverModuleLoaded&&(r=this._serverStylesheet.getStyleForElement(t,e)))),r?r.trim():""}_applyMultiValueStyleToElement(t,e){Object.keys(t).sort().forEach(n=>{const r=t[n],i=Array.isArray(r)?r:[r];i.sort();for(let t of i)t=t?t+"":"",Vl(this._platformId)||!this._serverModuleLoaded?Vl(this._platformId)?e.style.setProperty(n,t):this._setServerStyle(e,n,t):this._serverStylesheet.addStyleToElement(e,n,t)})}_setServerStyle(t,e,n){e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();const r=this._readStyleAttribute(t);r[e]=n||"",this._writeStyleAttribute(t,r)}_getServerStyle(t,e){return this._readStyleAttribute(t)[e]||""}_readStyleAttribute(t){const e={},n=t.getAttribute("style");if(n){const t=n.split(/;+/g);for(let n=0;n<t.length;n++){const r=t[n].trim();if(r.length>0){const t=r.indexOf(":");if(-1===t)throw new Error(`Invalid CSS style: ${r}`);e[r.substr(0,t).trim()]=r.substr(t+1).trim()}}}return e}_writeStyleAttribute(t,e){let n="";for(const r in e)e[r]&&(n+=r+":"+e[r]+";");t.setAttribute("style",n)}}return t.\u0275fac=function(e){return new(e||t)(Jt(BT),Jt(UT),Jt(sc),Jt(VT))},t.\u0275prov=pt({factory:function(){return new t(Jt(BT),Jt(UT),Jt(sc),Jt(VT))},token:t,providedIn:"root"}),t})();class fA{constructor(){this.shouldCache=!0}sideEffect(t,e,n){}}let pA=(()=>{class t{constructor(t,e,n){this.matchMedia=t,this.breakpoints=e,this.hook=n,this.activatedBreakpoints=[],this.elementMap=new Map,this.elementKeyMap=new WeakMap,this.watcherMap=new WeakMap,this.updateMap=new WeakMap,this.clearMap=new WeakMap,this.subject=new T,this.observeActivations()}get activatedAlias(){return this.activatedBreakpoints[0]?this.activatedBreakpoints[0].alias:""}onMediaChange(t){const e=this.findByQuery(t.mediaQuery);e&&((t=WT(t,e)).matches&&-1===this.activatedBreakpoints.indexOf(e)?(this.activatedBreakpoints.push(e),this.activatedBreakpoints.sort(rA),this.updateStyles()):t.matches||-1===this.activatedBreakpoints.indexOf(e)||(this.activatedBreakpoints.splice(this.activatedBreakpoints.indexOf(e),1),this.activatedBreakpoints.sort(rA),this.updateStyles()))}init(t,e,n,r,i=[]){mA(this.updateMap,t,e,n),mA(this.clearMap,t,e,r),this.buildElementKeyMap(t,e),this.watchExtraTriggers(t,e,i)}getValue(t,e,n){const r=this.elementMap.get(t);if(r){const t=void 0!==n?r.get(n):this.getActivatedValues(r,e);if(t)return t.get(e)}}hasValue(t,e){const n=this.elementMap.get(t);if(n){const t=this.getActivatedValues(n,e);if(t)return void 0!==t.get(e)||!1}return!1}setValue(t,e,n,r){let i=this.elementMap.get(t);if(i){const o=(i.get(r)||new Map).set(e,n);i.set(r,o),this.elementMap.set(t,i)}else i=(new Map).set(r,(new Map).set(e,n)),this.elementMap.set(t,i);const o=this.getValue(t,e);void 0!==o&&this.updateElement(t,e,o)}trackValue(t,e){return this.subject.asObservable().pipe(hf(n=>n.element===t&&n.key===e))}updateStyles(){this.elementMap.forEach((t,e)=>{const n=new Set(this.elementKeyMap.get(e));let r=this.getActivatedValues(t);r&&r.forEach((t,r)=>{this.updateElement(e,r,t),n.delete(r)}),n.forEach(n=>{if(r=this.getActivatedValues(t,n),r){const t=r.get(n);this.updateElement(e,n,t)}else this.clearElement(e,n)})})}clearElement(t,e){const n=this.clearMap.get(t);if(n){const r=n.get(e);r&&(r(),this.subject.next({element:t,key:e,value:""}))}}updateElement(t,e,n){const r=this.updateMap.get(t);if(r){const i=r.get(e);i&&(i(n),this.subject.next({element:t,key:e,value:n}))}}releaseElement(t){const e=this.watcherMap.get(t);e&&(e.forEach(t=>t.unsubscribe()),this.watcherMap.delete(t));const n=this.elementMap.get(t);n&&(n.forEach((t,e)=>n.delete(e)),this.elementMap.delete(t))}triggerUpdate(t,e){const n=this.elementMap.get(t);if(n){const r=this.getActivatedValues(n,e);r&&(e?this.updateElement(t,e,r.get(e)):r.forEach((e,n)=>this.updateElement(t,n,e)))}}buildElementKeyMap(t,e){let n=this.elementKeyMap.get(t);n||(n=new Set,this.elementKeyMap.set(t,n)),n.add(e)}watchExtraTriggers(t,e,n){if(n&&n.length){let r=this.watcherMap.get(t);if(r||(r=new Map,this.watcherMap.set(t,r)),!r.get(e)){const i=Y(...n).subscribe(()=>{const n=this.getValue(t,e);this.updateElement(t,e,n)});r.set(e,i)}}}findByQuery(t){return this.breakpoints.findByQuery(t)}getActivatedValues(t,e){for(let r=0;r<this.activatedBreakpoints.length;r++){const n=t.get(this.activatedBreakpoints[r].alias);if(n&&(void 0===e||n.has(e)&&null!=n.get(e)))return n}const n=t.get("");return void 0===e||n&&n.has(e)?n:void 0}observeActivations(){const t=this.breakpoints.items.map(t=>t.mediaQuery);this.matchMedia.observe(this.hook.withPrintQuery(t)).pipe(Hf(this.hook.interceptEvents(this)),hf(this.hook.blockPropagation())).subscribe(this.onMediaChange.bind(this))}}return t.\u0275fac=function(e){return new(e||t)(Jt(sA),Jt(oA),Jt(cA))},t.\u0275prov=pt({factory:function(){return new t(Jt(sA),Jt(oA),Jt(cA))},token:t,providedIn:"root"}),t})();function mA(t,e,n,r){if(void 0!==r){let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n,r)}}const gA=["row","column","row-reverse","column-reverse"];function vA(t){t=t?t.toLowerCase():"";let[e,n,r]=t.split(" ");return gA.find(t=>t===e)||(e=gA[0]),"inline"===n&&(n="inline"!==r?r:"",r="inline"),[e,bA(n),!!r]}function yA(t){let[e]=vA(t);return e.indexOf("row")>-1}function bA(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}let wA=(()=>{class t extends fA{buildStyles(t){return function(t){let[e,n,r]=vA(t);return function(t,e=null,n=!1){return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}(e,n,r)}(t)}}return t.\u0275fac=function(e){return _A(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const _A=cr(wA),xA=["fxLayout","fxLayout.xs","fxLayout.sm","fxLayout.md","fxLayout.lg","fxLayout.xl","fxLayout.lt-sm","fxLayout.lt-md","fxLayout.lt-lg","fxLayout.lt-xl","fxLayout.gt-xs","fxLayout.gt-sm","fxLayout.gt-md","fxLayout.gt-lg"];let CA=(()=>{class t extends GT{constructor(t,e,n,r){super(t,n,e,r),this.DIRECTIVE_KEY="layout",this.styleCache=IA,this.init()}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(dA),xs(wA),xs(pA))},t.\u0275dir=Ce({type:t,features:[wa]}),t})(),EA=(()=>{class t extends CA{constructor(){super(...arguments),this.inputs=xA}}return t.\u0275fac=function(e){return SA(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","fxLayout",""],["","fxLayout.xs",""],["","fxLayout.sm",""],["","fxLayout.md",""],["","fxLayout.lg",""],["","fxLayout.xl",""],["","fxLayout.lt-sm",""],["","fxLayout.lt-md",""],["","fxLayout.lt-lg",""],["","fxLayout.lt-xl",""],["","fxLayout.gt-xs",""],["","fxLayout.gt-sm",""],["","fxLayout.gt-md",""],["","fxLayout.gt-lg",""]],inputs:{fxLayout:"fxLayout","fxLayout.xs":"fxLayout.xs","fxLayout.sm":"fxLayout.sm","fxLayout.md":"fxLayout.md","fxLayout.lg":"fxLayout.lg","fxLayout.xl":"fxLayout.xl","fxLayout.lt-sm":"fxLayout.lt-sm","fxLayout.lt-md":"fxLayout.lt-md","fxLayout.lt-lg":"fxLayout.lt-lg","fxLayout.lt-xl":"fxLayout.lt-xl","fxLayout.gt-xs":"fxLayout.gt-xs","fxLayout.gt-sm":"fxLayout.gt-sm","fxLayout.gt-md":"fxLayout.gt-md","fxLayout.gt-lg":"fxLayout.gt-lg"},features:[wa]}),t})();const SA=cr(EA),IA=new Map,kA={"margin-left":null,"margin-right":null,"margin-top":null,"margin-bottom":null};let TA=(()=>{class t extends fA{constructor(t){super(),this._styler=t}buildStyles(t,e){return t.endsWith(LA)?function(t,e){const[n,r]=t.split(" "),i=t=>`-${t}`;let o="0px",s=i(r||n),a="0px";return"rtl"===e?a=i(n):o=i(n),{margin:`0px ${o} ${s} ${a}`}}(t=t.slice(0,t.indexOf(LA)),e.directionality):{}}sideEffect(t,e,n){const r=n.items;if(t.endsWith(LA)){const e=function(t,e){const[n,r]=t.split(" ");let i="0px",o="0px";return"rtl"===e?o=n:i=n,{padding:`0px ${i} ${r||n} ${o}`}}(t=t.slice(0,t.indexOf(LA)),n.directionality);this._styler.applyStyleToElements(e,n.items)}else{const e=r.pop(),i=function(t,e){const n=BA(e.directionality,e.layout),r=Object.assign({},kA);return r[n]=t,r}(t,n);this._styler.applyStyleToElements(i,r),this._styler.applyStyleToElements(kA,[e])}}}return t.\u0275fac=function(e){return new(e||t)(Jt(dA))},t.\u0275prov=pt({factory:function(){return new t(Jt(dA))},token:t,providedIn:"root"}),t})();const AA=["fxLayoutGap","fxLayoutGap.xs","fxLayoutGap.sm","fxLayoutGap.md","fxLayoutGap.lg","fxLayoutGap.xl","fxLayoutGap.lt-sm","fxLayoutGap.lt-md","fxLayoutGap.lt-lg","fxLayoutGap.lt-xl","fxLayoutGap.gt-xs","fxLayoutGap.gt-sm","fxLayoutGap.gt-md","fxLayoutGap.gt-lg"];let RA=(()=>{class t extends GT{constructor(t,e,n,r,i,o){super(t,i,r,o),this.zone=e,this.directionality=n,this.styleUtils=r,this.layout="row",this.DIRECTIVE_KEY="layout-gap",this.observerSubject=new T;const s=[this.directionality.change,this.observerSubject.asObservable()];this.init(s),this.marshal.trackValue(this.nativeElement,"layout").pipe($_(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}get childrenNodes(){const t=this.nativeElement.children,e=[];for(let n=t.length;n--;)e[n]=t[n];return e}ngAfterContentInit(){this.buildChildObservable(),this.triggerUpdate()}ngOnDestroy(){super.ngOnDestroy(),this.observer&&this.observer.disconnect()}onLayoutChange(t){const e=t.value.split(" ");this.layout=e[0],gA.find(t=>t===this.layout)||(this.layout="row"),this.triggerUpdate()}updateWithValue(t){const e=this.childrenNodes.filter(t=>1===t.nodeType&&this.willDisplay(t)).sort((t,e)=>{const n=+this.styler.lookupStyle(t,"order"),r=+this.styler.lookupStyle(e,"order");return isNaN(n)||isNaN(r)||n===r?0:n>r?1:-1});if(e.length>0){const n=this.directionality.value,r=this.layout;"row"===r&&"rtl"===n?this.styleCache=DA:"row"===r&&"rtl"!==n?this.styleCache=MA:"column"===r&&"rtl"===n?this.styleCache=PA:"column"===r&&"rtl"!==n&&(this.styleCache=FA),this.addStyles(t,{directionality:n,items:e,layout:r})}}clearStyles(){const t=Object.keys(this.mru).length>0,e=t?"padding":BA(this.directionality.value,this.layout);t&&super.clearStyles(),this.styleUtils.applyStyleToElements({[e]:""},this.childrenNodes)}willDisplay(t){const e=this.marshal.getValue(t,"show-hide");return!0===e||void 0===e&&"none"!==this.styleUtils.lookupStyle(t,"display")}buildChildObservable(){this.zone.runOutsideAngular(()=>{"undefined"!=typeof MutationObserver&&(this.observer=new MutationObserver(t=>{t.some(t=>t.addedNodes&&t.addedNodes.length>0||t.removedNodes&&t.removedNodes.length>0)&&this.observerSubject.next()}),this.observer.observe(this.nativeElement,{childList:!0}))})}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(xc),xs(ow),xs(dA),xs(TA),xs(pA))},t.\u0275dir=Ce({type:t,features:[wa]}),t})(),OA=(()=>{class t extends RA{constructor(){super(...arguments),this.inputs=AA}}return t.\u0275fac=function(e){return NA(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","fxLayoutGap",""],["","fxLayoutGap.xs",""],["","fxLayoutGap.sm",""],["","fxLayoutGap.md",""],["","fxLayoutGap.lg",""],["","fxLayoutGap.xl",""],["","fxLayoutGap.lt-sm",""],["","fxLayoutGap.lt-md",""],["","fxLayoutGap.lt-lg",""],["","fxLayoutGap.lt-xl",""],["","fxLayoutGap.gt-xs",""],["","fxLayoutGap.gt-sm",""],["","fxLayoutGap.gt-md",""],["","fxLayoutGap.gt-lg",""]],inputs:{fxLayoutGap:"fxLayoutGap","fxLayoutGap.xs":"fxLayoutGap.xs","fxLayoutGap.sm":"fxLayoutGap.sm","fxLayoutGap.md":"fxLayoutGap.md","fxLayoutGap.lg":"fxLayoutGap.lg","fxLayoutGap.xl":"fxLayoutGap.xl","fxLayoutGap.lt-sm":"fxLayoutGap.lt-sm","fxLayoutGap.lt-md":"fxLayoutGap.lt-md","fxLayoutGap.lt-lg":"fxLayoutGap.lt-lg","fxLayoutGap.lt-xl":"fxLayoutGap.lt-xl","fxLayoutGap.gt-xs":"fxLayoutGap.gt-xs","fxLayoutGap.gt-sm":"fxLayoutGap.gt-sm","fxLayoutGap.gt-md":"fxLayoutGap.gt-md","fxLayoutGap.gt-lg":"fxLayoutGap.gt-lg"},features:[wa]}),t})();const NA=cr(OA),DA=new Map,PA=new Map,MA=new Map,FA=new Map,LA=" grid";function BA(t,e){switch(e){case"column":return"margin-bottom";case"column-reverse":return"margin-top";case"row":return"rtl"===t?"margin-left":"margin-right";case"row-reverse":return"rtl"===t?"margin-right":"margin-left";default:return"rtl"===t?"margin-left":"margin-right"}}const jA={margin:0,width:"100%",height:"100%","min-width":"100%","min-height":"100%"};let VA=(()=>{class t extends fA{buildStyles(t){return jA}}return t.\u0275fac=function(e){return UA(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const UA=cr(VA);let zA=(()=>{class t extends GT{constructor(t,e,n,r){super(t,n,e,r),this.styleCache=WA,this.addStyles("")}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(dA),xs(VA),xs(pA))},t.\u0275dir=Ce({type:t,selectors:[["","fxFill",""],["","fxFlexFill",""]],features:[wa]}),t})();const WA=new Map;let qA=(()=>{class t extends fA{buildStyles(t,e){const n={},[r,i]=t.split(" ");switch(r){case"center":n["justify-content"]="center";break;case"space-around":n["justify-content"]="space-around";break;case"space-between":n["justify-content"]="space-between";break;case"space-evenly":n["justify-content"]="space-evenly";break;case"end":case"flex-end":n["justify-content"]="flex-end";break;case"start":case"flex-start":default:n["justify-content"]="flex-start"}switch(i){case"start":case"flex-start":n["align-items"]=n["align-content"]="flex-start";break;case"center":n["align-items"]=n["align-content"]="center";break;case"end":case"flex-end":n["align-items"]=n["align-content"]="flex-end";break;case"space-between":n["align-content"]="space-between",n["align-items"]="stretch";break;case"space-around":n["align-content"]="space-around",n["align-items"]="stretch";break;case"baseline":n["align-content"]="stretch",n["align-items"]="baseline";break;case"stretch":default:n["align-items"]=n["align-content"]="stretch"}return function(t,...e){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(let n of e)if(null!=n)for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}(n,{display:e.inline?"inline-flex":"flex","flex-direction":e.layout,"box-sizing":"border-box","max-width":"stretch"===i?yA(e.layout)?null:"100%":null,"max-height":"stretch"===i&&yA(e.layout)?"100%":null})}}return t.\u0275fac=function(e){return HA(e||t)},t.\u0275prov=pt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const HA=cr(qA),GA=["fxLayoutAlign","fxLayoutAlign.xs","fxLayoutAlign.sm","fxLayoutAlign.md","fxLayoutAlign.lg","fxLayoutAlign.xl","fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg"];let $A=(()=>{class t extends GT{constructor(t,e,n,r){super(t,n,e,r),this.DIRECTIVE_KEY="layout-align",this.layout="row",this.inline=!1,this.init(),this.marshal.trackValue(this.nativeElement,"layout").pipe($_(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}updateWithValue(t){const e=this.layout||"row",n=this.inline;"row"===e&&n?this.styleCache=tR:"row"!==e||n?"row-reverse"===e&&n?this.styleCache=nR:"row-reverse"!==e||n?"column"===e&&n?this.styleCache=eR:"column"!==e||n?"column-reverse"===e&&n?this.styleCache=rR:"column-reverse"!==e||n||(this.styleCache=ZA):this.styleCache=QA:this.styleCache=JA:this.styleCache=YA,this.addStyles(t,{layout:e,inline:n})}onLayoutChange(t){const e=t.value.split(" ");this.layout=e[0],this.inline=t.value.includes("inline"),gA.find(t=>t===this.layout)||(this.layout="row"),this.triggerUpdate()}}return t.\u0275fac=function(e){return new(e||t)(xs(Va),xs(dA),xs(qA),xs(pA))},t.\u0275dir=Ce({type:t,features:[wa]}),t})(),KA=(()=>{class t extends $A{constructor(){super(...arguments),this.inputs=GA}}return t.\u0275fac=function(e){return XA(e||t)},t.\u0275dir=Ce({type:t,selectors:[["","fxLayoutAlign",""],["","fxLayoutAlign.xs",""],["","fxLayoutAlign.sm",""],["","fxLayoutAlign.md",""],["","fxLayoutAlign.lg",""],["","fxLayoutAlign.xl",""],["","fxLayoutAlign.lt-sm",""],["","fxLayoutAlign.lt-md",""],["","fxLayoutAlign.lt-lg",""],["","fxLayoutAlign.lt-xl",""],["","fxLayoutAlign.gt-xs",""],["","fxLayoutAlign.gt-sm",""],["","fxLayoutAlign.gt-md",""],["","fxLayoutAlign.gt-lg",""]],inputs:{fxLayoutAlign:"fxLayoutAlign","fxLayoutAlign.xs":"fxLayoutAlign.xs","fxLayoutAlign.sm":"fxLayoutAlign.sm","fxLayoutAlign.md":"fxLayoutAlign.md","fxLayoutAlign.lg":"fxLayoutAlign.lg","fxLayoutAlign.xl":"fxLayoutAlign.xl","fxLayoutAlign.lt-sm":"fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md":"fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg":"fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl":"fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs":"fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm":"fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md":"fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg":"fxLayoutAlign.gt-lg"},features:[wa]}),t})();const XA=cr(KA),YA=new Map,QA=new Map,JA=new Map,ZA=new Map,tR=new Map,eR=new Map,nR=new Map,rR=new Map;let iR=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[FT,sw]]}),t})(),oR=(()=>{class t{constructor(t){this.router=t,this.fondo="white",this.isThemeDark=!1,this.themes=["deeppurple-amber","indigo-pink","pink-bluegrey","purple-green"]}irAPersonalizar(){this.router.navigate(["main/personalizar-usuario"])}sombra(){return JSON.parse(localStorage.getItem("colorFondo"))?"3px 0 6px rgba(255, 255, 255, 0.658)":JSON.parse(localStorage.getItem("colorFondo"))?void 0:"3px 0 6px rgba(0, 0, 0, 0.658)"}irAEquipos(){this.router.navigate(["main/equipos-tabla"])}irASancionados(){this.router.navigate(["main/sancionados-tabla"])}comprobarSancionados(){this.router.navigate(["main/comprobar-sancionados"])}toHome(){this.router.navigate(["main/home"])}logOut(){localStorage.setItem("Logueado","false"),this.router.navigate(["login"])}colores(){return JSON.parse(localStorage.getItem("colorFondo"))?JSON.parse(localStorage.getItem("colorFondo"))?"#fafafa":void 0:"#303030"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(xs(dg))},t.\u0275cmp=ve({type:t,selectors:[["app-main-nav"]],hostVars:2,hostBindings:function(t,e){2&t&&ia(ce,na,e.activeThemeCssClass,!0)},decls:44,vars:6,consts:[[1,"body"],[3,"clickOutside"],["color","primary",1,"mat-elevation-z8",".mat-toolbar-single-row"],[1,"boton-menu"],["type","button","mat-button","",3,"click"],[1,"titulo-principal"],[1,"espacioncentral"],["mat-button","",3,"click"],["color","primary","autosize","",1,"ventana"],["fixedInViewport","true",1,".mat-drawer",3,"mode"],["drawer",""],["mat-label","","fxLayout","row",1,"boton2",3,"click"],[1,"icono"]],template:function(t,e){if(1&t){const t=Ds();ks(0,"body",0),ks(1,"div",1),Fs("clickOutside",(function(){return Ze(t),_s(19).close()})),ks(2,"mat-toolbar",2),ks(3,"span"),ks(4,"div",3),ks(5,"button",4),Fs("click",(function(){return Ze(t),_s(19).toggle()})),ks(6,"mat-icon"),fa(7,"menu"),Ts(),Ts(),Ts(),Ts(),ks(8,"span",5),fa(9," LIGA DE FUTBOL "),Ts(),As(10,"span",6),ks(11,"button",7),Fs("click",(function(){return e.toHome()})),ks(12,"mat-icon"),fa(13,"home"),Ts(),Ts(),ks(14,"button",7),Fs("click",(function(){return e.logOut()})),ks(15,"mat-icon"),fa(16,"cancel"),Ts(),Ts(),Ts(),ks(17,"mat-drawer-container",8),ks(18,"mat-drawer",9,10),Ru(20,"async"),Ru(21,"async"),ks(22,"a",11),Fs("click",(function(){return Ze(t),_s(19).toggle()}))("click",(function(){return e.irAEquipos()})),ks(23,"div",12),ks(24,"mat-icon"),fa(25,"tour "),Ts(),fa(26," \xa0 "),Ts(),ks(27,"div"),fa(28," Equipos "),Ts(),Ts(),ks(29,"a",11),Fs("click",(function(){return Ze(t),_s(19).toggle()}))("click",(function(){return e.irASancionados()})),ks(30,"div",12),ks(31,"mat-icon"),fa(32,"account_circle "),Ts(),fa(33," \xa0 "),Ts(),ks(34,"div"),fa(35," Jugadores sancionados "),Ts(),Ts(),ks(36,"a",11),Fs("click",(function(){return Ze(t),_s(19).toggle()}))("click",(function(){return e.comprobarSancionados()})),ks(37,"div",12),ks(38,"mat-icon"),fa(39,"verified_user "),Ts(),fa(40," \xa0 "),Ts(),ks(41,"div"),fa(42," Comprobar sancionados "),Ts(),Ts(),Ts(),Ts(),Ts(),As(43,"router-outlet"),Ts()}2&t&&(di(18),Ss("mode",Ou(21,4,e.isHandset$)?"over":"side"),ys("role",Ou(20,2,e.isHandset$)?"dialog":"navigation"))},directives:[NI,k_,SS,HI,qI,EA,mg],pipes:[Bl],styles:[".titulo-principal[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}.body[_ngcontent-%COMP%]{overflow-y:scroll}.boton-menu[_ngcontent-%COMP%]{margin-left:-10%}.mat-toolbar-single-row[_ngcontent-%COMP%]{position:fixed;z-index:10}.icono[_ngcontent-%COMP%]{margin-top:-4px}.espacioncentral[_ngcontent-%COMP%]{flex:1 1 auto}.mat-drawer[_ngcontent-%COMP%]{box-shadow:3px 0 6px rgba(0,0,0,.287);position:fixed;top:64px;padding:10px 8px 0}.formatos[_ngcontent-%COMP%]{text-align:center}.letras[_ngcontent-%COMP%]{font-size:12px}.theme-selectors-container[_ngcontent-%COMP%]{width:190px;margin:0 8px}.subti[_ngcontent-%COMP%]{margin-left:5%}.paletaColores[_ngcontent-%COMP%]{margin-left:10px}.center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}@media screen and (max-width:599px){.mat-drawer[_ngcontent-%COMP%]{box-shadow:3px 0 6px hsla(0,0%,100%,.19);position:fixed;top:56px}}.desplegable[_ngcontent-%COMP%]{max-height:400px}.titulo[_ngcontent-%COMP%]{font-weight:800;font-family:Open Sans;font-size:15px}.boton2[_ngcontent-%COMP%]{text-align:start;width:100%;cursor:pointer;margin:8px 0;padding:10px 8px 4px}.boton2[_ngcontent-%COMP%]:hover{background:#cfcfcf}.boton3[_ngcontent-%COMP%]{text-align:start;margin-left:15px;margin-right:15px;width:100%;cursor:pointer}.ventana[_ngcontent-%COMP%]{z-index:10}"]}),t})(),sR=(()=>{class t{constructor(t){this.router=t}irAEquipos(){this.router.navigate(["main/equipos-tabla"])}irASancionados(){this.router.navigate(["main/sancionados-tabla"])}comprobarSancionados(){this.router.navigate(["main/comprobar-sancionados"])}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(xs(dg))},t.\u0275cmp=ve({type:t,selectors:[["app-home"]],decls:35,vars:0,consts:[[1,"contenido"],[1,"number2"],["fxLayout","row wrap","fxLayout.lt-sm","column","fxLayoutGap","26px","fxLayoutAlign","flex-start"],[1,"info-box2","hover-expand-effect2",3,"click"],[1,"icon2","bg-light-blue2"],[1,"material-icons"],["fxLayout","column","fxLayoutGap","10px",1,"content2"],[1,"text2"]],template:function(t,e){1&t&&(ks(0,"div",0),ks(1,"div"),ks(2,"div"),ks(3,"h3",1),fa(4,"BIENVENIDO"),Ts(),As(5,"mat-divider"),Ts(),As(6,"br"),ks(7,"div",2),ks(8,"div",3),Fs("click",(function(){return e.irAEquipos()})),ks(9,"div",4),ks(10,"i",5),fa(11,"tour"),Ts(),Ts(),ks(12,"div",6),ks(13,"div",7),fa(14,"Administrar"),Ts(),ks(15,"div",1),fa(16,"Equipos"),Ts(),Ts(),Ts(),ks(17,"div",3),Fs("click",(function(){return e.irASancionados()})),ks(18,"div",4),ks(19,"i",5),fa(20,"account_circle"),Ts(),Ts(),ks(21,"div",6),ks(22,"div",7),fa(23,"Lista de"),Ts(),ks(24,"div",1),fa(25,"Sancionados"),Ts(),Ts(),Ts(),ks(26,"div",3),Fs("click",(function(){return e.comprobarSancionados()})),ks(27,"div",4),ks(28,"i",5),fa(29,"verified_user"),Ts(),Ts(),ks(30,"div",6),ks(31,"div",7),fa(32,"Comprobar"),Ts(),ks(33,"div",1),fa(34,"Sancionados"),Ts(),Ts(),Ts(),Ts(),Ts(),Ts())},directives:[CT,EA,OA,KA],styles:['.carta[_ngcontent-%COMP%]{margin-left:36%;margin-right:20%;margin-top:-15%;text-align:center}.tituloCabecera[_ngcontent-%COMP%]{margin-top:15px}.number[_ngcontent-%COMP%]{color:#fff}.number2[_ngcontent-%COMP%]{color:#000}.texto[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-weight:100;color:#fff}.contenido[_ngcontent-%COMP%]{padding-top:7%;margin-left:2%}.iconos[_ngcontent-%COMP%]{background-color:#fff}.iconos[_ngcontent-%COMP%], .info-box2[_ngcontent-%COMP%]{height:80px;display:flex;cursor:pointer;position:relative;overflow:hidden;margin-bottom:30px}.info-box2[_ngcontent-%COMP%]{box-shadow:0 2px 10px rgba(0,0,0,.541);background-color:#cfcfcf;width:285px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]{display:inline-block;text-align:center;background-color:hsla(0,0%,100%,.12);width:80px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000;font-size:50px;line-height:80px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-bar2[_ngcontent-%COMP%]{height:100%;line-height:100px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-bar2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-pie2[_ngcontent-%COMP%]{height:100%;line-height:123px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-pie2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]{height:100%;line-height:115px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-line2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]{display:inline-block;padding:7px 10px}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]   .text2[_ngcontent-%COMP%]{font-size:13px;margin-top:6px;color:#505050}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]   .number2[_ngcontent-%COMP%]{font-weight:400;font-size:26px;margin-top:1px;color:#000}.bg-light-blue2[_ngcontent-%COMP%]{color:red}.info-box2.hover-expand-effect2[_ngcontent-%COMP%]:after{background-color:rgba(0,0,0,.192);content:".";position:absolute;top:0;width:0;height:100%;color:transparent;transition:all .95s}.info-box2.hover-expand-effect2[_ngcontent-%COMP%]:hover:after{width:100%}.card2[_ngcontent-%COMP%]{background:#cecece;min-height:50px;margin-right:1.5%;box-shadow:0 2px 10px rgba(0,0,0,.507);position:relative;margin-bottom:30px;border-radius:2px}.card2[_ngcontent-%COMP%]   .header2[_ngcontent-%COMP%]{color:#dfdfdf;padding:5px;height:115px;margin-left:12px;position:relative;border-bottom:1px solid hsla(0,0%,80%,.35)}.info-box[_ngcontent-%COMP%]{box-shadow:0 2px 10px hsla(0,0%,100%,.219);height:80px;display:flex;cursor:pointer;background-color:#424242;width:285px;position:relative;overflow:hidden;margin-bottom:30px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:inline-block;text-align:center;background-color:rgba(0,0,0,.12);width:80px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:50px;line-height:80px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-bar[_ngcontent-%COMP%]{height:100%;line-height:100px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-bar[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-pie[_ngcontent-%COMP%]{height:100%;line-height:123px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-pie[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]{height:100%;line-height:115px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:inline-block;padding:7px 10px}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:13px;margin-top:6px;color:#969696}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{font-weight:400;font-size:26px;margin-top:1px;color:#fff}.bg-light-blue[_ngcontent-%COMP%]{color:#fff}.info-box.hover-expand-effect[_ngcontent-%COMP%]:after{background-color:hsla(0,0%,100%,.192);content:".";position:absolute;top:0;width:0;height:100%;color:transparent;transition:all .95s}.info-box.hover-expand-effect[_ngcontent-%COMP%]:hover:after{width:100%}.card[_ngcontent-%COMP%]{background:#424242;min-height:50px;margin-right:1.5%;box-shadow:0 2px 10px hsla(0,0%,100%,.2);position:relative;margin-bottom:30px;border-radius:2px}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:#dfdfdf;padding:5px;height:115px;margin-left:12px;position:relative;border-bottom:1px solid hsla(0,0%,80%,.35)}']}),t})(),aR=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return"true"===localStorage.getItem("Logueado")||this.router.parseUrl("/login")}}return t.\u0275fac=function(e){return new(e||t)(Jt(dg))},t.\u0275prov=pt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var uR=n("mrSG");let cR=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["app-login-incorrecto"]],decls:5,vars:0,consts:[["mat-label","",1,"md-body-2"],[1,"error"]],template:function(t,e){1&t&&(ks(0,"span",0),fa(1," Datos incorrectos "),Ts(),ks(2,"span",1),ks(3,"mat-icon"),fa(4,"block"),Ts(),Ts())},directives:[SS],styles:[".md-body-2[_ngcontent-%COMP%]{color:#fff;vertical-align:5px;text-align:center;font-family:Arial,Helvetica,sans-serif}.error[_ngcontent-%COMP%]{text-align:right;margin-left:50%;vertical-align:-1.5px;vertical-align:center;color:red}"]}),t})(),lR=(()=>{class t{constructor(){}login(t,e){return Object(uR.b)(this,void 0,void 0,(function*(){let n=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});return yield n.json()}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=pt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function hR(t,e){1&t&&As(0,"mat-spinner",13)}let dR=(()=>{class t{constructor(t,e,n){this.usuarioService=t,this.router=e,this.snackBar=n,this.spinner=!1,this.logueado=!1,this.listaPermisos=[]}entrar(t,e){return Object(uR.b)(this,void 0,void 0,(function*(){let n;this.spinner=yield!0,n=yield this.usuarioService.login(t,e),1===n.split(" ").length?(this.router.navigate(["main/home"]),this.logueado=!0,localStorage.setItem("Logueado","true"),localStorage.setItem("usuarioRegistrado",JSON.stringify(t))):this.openSnackBarErrorLogin(),this.spinner=!1}))}openSnackBarErrorLogin(){this.snackBar.openFromComponent(cR,{duration:3e3})}getUserLoggedIn(){return JSON.parse(localStorage.getItem("usuarioRegistrado"))}verificarSesionAbierta(){localStorage.getItem("Logueado")&&this.router.navigate(["main/home"])}ngOnInit(){this.verificarSesionAbierta()}}return t.\u0275fac=function(e){return new(e||t)(xs(lR),xs(dg),xs(wT))},t.\u0275cmp=ve({type:t,selectors:[["app-login"]],decls:22,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center","fxFill",""],[1,"carta"],[1,"tipografia"],[1,"row"],[1,"col-md-4","text-center"],[1,"forma"],[1,"example-full-width"],["matInput","","type","text","placeholder","Email","required","","autofocus","",1,"caja-texto",3,"keyup.enter"],["userEmail",""],["matInput","","type","password","placeholder","Password","required","",1,"form-control","mb-2",3,"keyup.enter"],["userPassword",""],["diameter","35","class","spin",3,"display",4,"ngIf"],["mat-raised-button","","fxLayoutAlign","center center","color","primary",1,"tipografia",3,"click"],["diameter","35",1,"spin",3,"display"]],template:function(t,e){if(1&t){const t=Ds();ks(0,"div",0),ks(1,"div"),ks(2,"div"),ks(3,"mat-card",1),As(4,"p"),ks(5,"mat-label",2),fa(6,"Ingreso"),Ts(),As(7,"p"),ks(8,"div",3),As(9,"div",4),ks(10,"div"),ks(11,"div",5),ks(12,"mat-form-field",6),ks(13,"input",7,8),Fs("keyup.enter",(function(){Ze(t);const n=_s(14),r=_s(17);return e.entrar(n.value,r.value)})),Ts(),Ts(),ks(15,"mat-form-field",6),ks(16,"input",9,10),Fs("keyup.enter",(function(){Ze(t);const n=_s(14),r=_s(17);return e.entrar(n.value,r.value)})),Ts(),Ts(),Ts(),As(18,"p"),ws(19,hR,1,0,"mat-spinner",11),ks(20,"button",12),Fs("click",(function(){Ze(t);const n=_s(14),r=_s(17);return e.entrar(n.value,r.value)})),fa(21,"Entrar"),Ts(),Ts(),Ts(),Ts(),Ts(),Ts(),Ts()}2&t&&(di(19),Ss("ngIf",e.spinner))},directives:[EA,KA,zA,XI,SC,PC,bI,kl,k_,ok],styles:[".tipografia[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin-left:36%}.forma[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%;text-align:center;align-content:center}.container[_ngcontent-%COMP%]{align-items:center;text-align:center;width:60%;height:90%;margin-left:35%;position:absolute;display:flex}.example-full-width[_ngcontent-%COMP%]{width:100%}.carta[_ngcontent-%COMP%]{box-shadow:6px 13px 75px 3px rgba(0,0,0,.19)}.spin[_ngcontent-%COMP%]{margin-left:80%;position:absolute}"]}),t})(),fR=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["app-confirmar-eliminar"]],decls:8,vars:2,consts:[[1,"mat-typography"],["mat-dialog-title",""],["fxLayoutAlign","center center","fxFill","",1,"botones"],["mat-raised-button","","color","primary",3,"mat-dialog-close"],["mat-raised-button","","color","warn",3,"mat-dialog-close"]],template:function(t,e){1&t&&(ks(0,"section",0),ks(1,"h1",1),fa(2,"\xbfEsta seguro que desea eliminarlo?"),Ts(),ks(3,"mat-dialog-actions",2),ks(4,"button",3),fa(5,"Si"),Ts(),ks(6,"button",4),fa(7,"No"),Ts(),Ts(),Ts()),2&t&&(di(4),Ss("mat-dialog-close",!0),di(2),Ss("mat-dialog-close",!1))},directives:[aI,uI,KA,zA,k_,sI],styles:[""]}),t})(),pR=(()=>{class t{constructor(t){this.http=t}getConfiguration(){return t.config}}return t.\u0275fac=function(e){return new(e||t)(Jt(XE))},t.\u0275prov=pt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),mR=(()=>{class t{constructor(t,e){this.confService=t,this.http=e,this.httpHeaders=new ME({"Content-Type":"application/json",Authorization:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjExLCJ1c2VyRW1haWwiOiJzYW50aWRhbG1hc3NvakBnbWFpbC5jb20iLCJpYXQiOjE2MDI2ODQwMTksImV4cCI6MTYwMjY4NzYxOX0.YJOCbcipmYnO2hxW2BRm91yjhe9a92q9BBGLvS4nau4"})}get(){return Object(uR.b)(this,void 0,void 0,(function*(){let t=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const e=yield t.json(),n=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"GET",headers:{Authorization:e,"Access-Control-Allow-Origin":"*"}});return yield(yield n).json()}))}nuevo(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({name:t})});return yield(yield r).json()}))}editar(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:n,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({id:t.id,name:t.name})});return yield(yield r).json()}))}eliminar(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams/"+t,{method:"DELETE",headers:{Authorization:n,"Access-Control-Allow-Origin":"*"}});return yield(yield r).json()}))}}return t.\u0275fac=function(e){return new(e||t)(Jt(pR),Jt(XE))},t.\u0275prov=pt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function gR(t,e){1&t&&(ks(0,"div",2),As(1,"mat-spinner"),Ts())}function vR(t,e){1&t&&(ks(0,"th",21),fa(1," Nombre "),Ts())}function yR(t,e){if(1&t&&(ks(0,"td",22),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.name," ")}}function bR(t,e){1&t&&(ks(0,"th",23),fa(1,"Acciones"),Ts())}function wR(t,e){if(1&t){const t=Ds();ks(0,"td",24),ks(1,"button",25),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).verJugadores(n)})),ks(2,"mat-icon"),fa(3," accessibility "),Ts(),Ts(),ks(4,"button",26),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).editar(n)})),ks(5,"mat-icon"),fa(6,"create"),Ts(),Ts(),ks(7,"button",27),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).eliminar(n)})),ks(8,"mat-icon"),fa(9,"delete_forever"),Ts(),Ts(),Ts()}}function _R(t,e){1&t&&As(0,"tr",28)}function xR(t,e){1&t&&As(0,"tr",29)}const CR=function(){return[10,20,50]};function ER(t,e){if(1&t){const t=Ds();ks(0,"div",3),As(1,"br"),ks(2,"div",4),ks(3,"h2"),fa(4,"Equipos"),Ts(),Ts(),ks(5,"mat-grid-list",5),ks(6,"mat-grid-tile"),ks(7,"mat-form-field"),ks(8,"mat-label"),fa(9,"Filtro"),Ts(),ks(10,"input",6),Fs("keyup",(function(e){return Ze(t),Us().applyFilter(e)})),Ts(),Ts(),Ts(),ks(11,"mat-grid-tile"),ks(12,"button",7),Fs("click",(function(){return Ze(t),Us().nuevo()})),fa(13," Agregar nuevo equipo "),Ts(),Ts(),Ts(),ks(14,"div",8),ks(15,"table",9,10),Rs(17,11),ws(18,vR,2,0,"th",12),ws(19,yR,2,1,"td",13),Os(),Rs(20,14),ws(21,bR,2,0,"th",15),ws(22,wR,10,0,"td",16),Os(),ws(23,_R,1,0,"tr",17),ws(24,xR,1,0,"tr",18),Ts(),As(25,"mat-paginator",19),Ts(),As(26,"div",20),Ts()}if(2&t){const t=Us();di(15),Ss("dataSource",t.dataSource),di(8),Ss("matHeaderRowDef",t.displayedColumns),di(1),Ss("matRowDefColumns",t.displayedColumns),di(1),Ss("pageSizeOptions",Au(5,CR))("pageSize",t.itemPorPagina)}}let SR=(()=>{class t{constructor(t,e,n){this.dialog=t,this.router=e,this.equiposService=n,this.cargaPendientes=!0,this.displayedColumns=["nombre","acciones"],this.dataSource=new aT,this.verificarAcceso=!0,this.enBlanco=!1}set matSort(t){this.sort=t,this.setDataSourceAttributes()}set matPaginator(t){this.paginator=t,this.setDataSourceAttributes()}setDataSourceAttributes(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}determinarCantidadItem(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}verJugadores(t){console.log(t),this.router.navigate(["main/jugadores-tabla/"+t.id])}eliminar(t){this.dialog.open(fR).afterClosed().subscribe(e=>Object(uR.b)(this,void 0,void 0,(function*(){e&&(yield this.equiposService.eliminar(t.id),location.reload())})))}editar(t){this.router.navigate(["main/equipos-editar/"+t.id])}nuevo(){this.router.navigate(["main/equipos-crear"])}cargarTabla(){return Object(uR.b)(this,void 0,void 0,(function*(){this.dataSource.data=yield this.equiposService.get(),this.cargaPendientes=!1}))}ngOnInit(){this.cargarTabla(),console.log(this.dataSource.data)}}return t.\u0275fac=function(e){return new(e||t)(xs(iI),xs(dg),xs(mR))},t.\u0275cmp=ve({type:t,selectors:[["app-equipos-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(FS,!0),Hu(RE,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["cols","2","rowHeight","100px"],["matInput","",3,"keyup"],["mat-raised-button","","color","primary",3,"click"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],[1,"button-row"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Jugadores",3,"click"],["mat-button","","color","accent","matTooltip","Editar",3,"click"],["mat-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(ws(0,gR,2,0,"div",0),ws(1,ER,27,6,"div",1)),2&t&&(Ss("ngIf",e.cargaPendientes),di(1),Ss("ngIf",!e.cargaPendientes))},directives:[kl,KA,zA,ok,b_,c_,PC,SC,bI,k_,zk,FS,Kk,Gk,qk,Jk,tT,RE,Yk,qS,Qk,gE,SS,nT,iT],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),t})();var IR=function(t,e){return(IR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function kR(t,e){function n(){this.constructor=t}IR(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var TR=function(){return(TR=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function AR(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function RR(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var OR=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=NR(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function NR(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}var DR=null;function PR(t){DR=t}function MR(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function FR(t,e,n){return Math.max(t,Math.min(e,n))}function LR(t){return t%2==0?t:t+1}function BR(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function jR(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function VR(t,e,n){void 0===n&&(n=""),jR(qR(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function UR(t){jR(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function zR(t,e){if(void 0===e&&(e=[]),null==e&&(e=[]),Array.isArray(t)||oO(t))for(var n=0;n<t.length;++n)zR(t[n],e);else e.push(t);return e}function WR(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function qR(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function HR(t){return t%1==0}function GR(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function $R(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function KR(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function XR(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0,s=function(){if(t())r();else{var a=e(++o);null!=n&&o>=n?i():setTimeout(s,a)}};s()}))}function YR(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function QR(t,e){var n=e.length;return jR((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),jR(t.every((function(t){return HR(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function JR(t,e){for(var n=[],r=[],i=null==e?null:QR(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function ZR(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function tO(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function eO(t,e,n){if("float32"===e)for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))throw Error("The result of the '"+n+"' is "+i+".")}}function nO(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function rO(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function iO(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function oO(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function sO(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function aO(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=2*t.length})),e}function uO(t){return"string"==typeof t||t instanceof String}function cO(t){return"boolean"==typeof t}function lO(t){return"number"==typeof t}function hO(t){return Array.isArray(t)?hO(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":lO(t)?"float32":uO(t)?"string":cO(t)?"bool":"float32"}function dO(t){return!!(t&&t.constructor&&t.call&&t.apply)}function fO(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function pO(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function mO(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=zR(t)),n&&nO(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function gO(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],s=0;s<o;s++)i[s]=r[e+s];else{o=n[0];var a=n.slice(1),u=a.reduce((function(t,e){return t*e}));for(s=0;s<o;s++)i[s]=t(e+s*u,a,r)}return i}(0,t,e)}function vO(t,e){for(var n=yO(t,e),r=0;r<n.length;r++)n[r]=1;return n}function yO(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function bO(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")}function wO(t){t.forEach((function(e){jR(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function _O(t,e){return DR.platform.fetch(t,e)}Object.freeze({Environment:OR,getQueryParams:NR,get ENV(){return DR},setEnvironmentGlobal:PR}),Object.freeze({shuffle:MR,clamp:FR,nearestLargerEven:LR,sum:BR,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:jR,assertShapesMatch:VR,assertNonNull:UR,flatten:zR,sizeFromShape:WR,isScalarShape:function(t){return 0===t.length},arraysEqual:qR,isInt:HR,tanh:GR,sizeToSquarishShape:$R,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return MR(e),e},rightPad:KR,repeatedTry:XR,inferFromImplicitShape:YR,parseAxisParam:QR,squeezeShape:JR,getTypedArrayFromDType:ZR,getArrayFromDType:tO,checkComputationForErrors:eO,checkConversionForErrors:nO,isValidDtype:rO,hasEncodingLoss:iO,isTypedArray:oO,bytesPerElement:sO,bytesFromStringArray:aO,isString:uO,isBoolean:cO,isNumber:lO,inferDtype:hO,isFunction:dO,nearestDivisor:fO,computeStrides:pO,toTypedArray:mO,toNestedArray:gO,makeOnesTypedArray:vO,makeZerosTypedArray:yO,now:bO,assertNonNegativeIntegerDimensions:wO,fetch:_O});var xO=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new CO)}return t.prototype.profileKernel=function(t,e){var n,r=this,i=this.backendTimer.time((function(){n=e()}));return(Array.isArray(n)?n:[n]).forEach((function(e){var n=e.dataSync();eO(n,e.dtype,t),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),r.logger.logKernelProfile(t,e,n,i.kernelMs,o)}))})),n},t}(),CO=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i){var o=KR(r+"ms",9),s=KR(t,25),a=e.rank,u=e.size,c=KR(e.shape.toString(),14);console.log("%c"+s+"\t%c"+o+"\t%c"+a+"D "+c+"\t%c"+u+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green")},t}();function EO(t,e,n){return KR(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":uO(t)?"'"+t+"'":"bool"===n?SO(t):parseFloat(t.toFixed(7)).toString(),e)}function SO(t){return 0===t?"false":"true"}function IO(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var kO=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=WR(t),null!=n){var i=n.length;jR(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||tO(e,this.size),this.strides=pO(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),jR(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}n++}for(var a=t[t.length-1],u=0;u<t.length-1;++u)a+=this.strides[u]*t[u];return this.values[a]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return OO.make(this.shape,{values:this.values},this.dtype)},t}(),TO=null,AO=null,RO=null,OO=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=WR(t),this.strides=pO(t),this.dataId=null!=r?r:{},this.id=TO().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",TO().registerTensor(this,i),null!=n&&TO().write(i,this.dataId,n)}return t.make=function(e,n,r,i){return new t(e,r,n.values,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),jR(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),AO.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,AO.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return AO.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,gO(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return gO(this.shape,this.dataSync())},t.prototype.data=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){return this.throwIfDisposed(),[2,TO().read(this.dataId)]}))}))},t.prototype.dataSync=function(){return this.throwIfDisposed(),TO().readSync(this.dataId)},t.prototype.dispose=function(){this.isDisposed||(TO().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),AO.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),AO.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),AO.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),AO.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),AO.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),AO.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),AO.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=pO(e),o=function(t,e,n,r){var i=WR(e),o=r[r.length-1],s=new Array(o).fill(0),a=e.length,u="complex64"===n?IO(t):t;if(a>1)for(var c=0;c<i/o;c++)for(var l=c*o,h=0;h<o;h++)s[h]=Math.max(s[h],EO(u[l+h],0,n).length);return s}(t,e,n,i),s=e.length,a=function t(e,n,r,i,o,s){void 0===s&&(s=!0);var a="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[EO(IO(e)[0],0,r)]:"bool"===r?[SO(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=Array.from(e.slice(0,3*a)),h=Array.from(e.slice(u-3*a,u));return"complex64"===r&&(l=IO(l),h=IO(h)),["["+l.map((function(t,e){return EO(t,o[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return EO(t,o[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?IO(e):Array.from(e)).map((function(t,e){return EO(t,o[e],r)})).join(", ")+"]"]}var d=n.slice(1),f=i.slice(1),p=i[0]*a,m=[];if(u>20){for(var g=0;g<3;g++)m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,!1));for(m.push("..."),g=u-3;g<u;g++)m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,g===u-1))}else for(g=0;g<u;g++){var v;m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,g===u-1))}var y=2===c?",":"";for(m[0]="["+m[0]+y,g=1;g<m.length-1;g++)m[g]=" "+m[g]+y;var b=",\n";for(g=2;g<c;g++)b+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(s?"":b),m}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),AO.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),AO.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),AO.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),AO.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),AO.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),AO.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),AO.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),AO.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),AO.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),AO.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),AO.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),AO.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),RO("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),AO.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),AO.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),AO.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),AO.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),AO.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),AO.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),AO.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),AO.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),AO.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),AO.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),AO.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),AO.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),AO.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),AO.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),AO.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),AO.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),AO.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),AO.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),AO.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),AO.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),AO.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),AO.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),AO.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),AO.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),AO.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),AO.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),AO.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),AO.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),AO.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),AO.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),AO.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),AO.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),AO.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),AO.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),AO.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),AO.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),AO.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),AO.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),AO.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),AO.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),AO.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),AO.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),AO.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),AO.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),AO.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),AO.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),AO.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),AO.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),AO.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),AO.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),AO.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),AO.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),AO.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),AO.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),AO.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),AO.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),AO.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),AO.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),AO.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),AO.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),AO.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),AO.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),AO.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),AO.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),AO.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),AO.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),AO.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),AO.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),AO.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),AO.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),AO.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),AO.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),AO.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),AO.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),AO.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),AO.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),AO.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),AO.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),AO.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),AO.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),AO.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),AO.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),AO.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),AO.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),AO.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),AO.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),AO.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),AO.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),AO.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),AO.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),AO.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),AO.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),AO.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),AO.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),AO.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),AO.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),AO.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),AO.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),BO.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),AO.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),AO.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),AO.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),AO.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),this.throwIfDisposed(),AO.stridedSlice(this,t,e,n,r,i,o,s,a)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),AO.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),AO.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),AO.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),AO.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),AO.spectral.irfft(this)},t}();Object.defineProperty(OO,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var NO,DO,PO,MO,FO,LO,BO=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=TO().nextVariableId().toString());try{TO().registerVariable(i)}catch(t){throw TO().disposeTensor(i),t}return i}return kR(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!qR(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");TO().disposeTensor(this),this.dataId=t.dataId,TO().registerTensor(this)},e.prototype.dispose=function(){TO().disposeVariable(this),this.isDisposedInternal=!0},e}(OO);Object.defineProperty(BO,Symbol.hasInstance,{value:function(t){return t instanceof OO&&null!=t.assign&&t.assign instanceof Function}}),(LO=NO||(NO={})).R0="R0",LO.R1="R1",LO.R2="R2",LO.R3="R3",LO.R4="R4",LO.R5="R5",LO.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(DO||(DO={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(PO||(PO={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(MO||(MO={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(FO||(FO={}));var jO={float32:MO,int32:DO,bool:PO,complex64:FO};function VO(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return jO[t][e]}function UO(t){return VO(t,"int32")}function zO(t,e){if(t.dtype===e.dtype)return[t,e];var n=VO(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function WO(t,e){jR(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function qO(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof OO)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var s in o){var a=o[s];r.has(a)||(r.add(a),t(a,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:zO,assertTypesMatch:WO,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:qO});var HO,GO=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),$O=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new GO}return t.prototype.ready=function(){return AR(this,void 0,void 0,(function(){var t,e,n;return RR(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return AR(this,void 0,void 0,(function(){var e,n,r;return RR(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new xO(this.backendInstance),[2,!0]}}))}))},t.prototype.initializeBackend=function(t){var e=this,n=KO.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=OO.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,(function(t){return[t.toFloat()]})),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],s=this.isTapeOn(),a=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){s&&(o=t.map((function(t){return i.keep(i.clone(t))})))},c=this.state.numBytes,l=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(a,(function(){return t(i.backend,u)})):t(i.backend,u)})),s){var h={id:this.state.nextTapeNodeId++,name:a,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShape:Array.isArray(r)?r.map((function(t){return t.shape})):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*sO(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof BO||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return AR(this,void 0,void 0,(function(){var e,n;return RR(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach((function(t,e){r[e]=t}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=qO(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==s.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),jR(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));jR(o instanceof OO,(function(){return"The result y returned by f() must be a tensor."}));var s=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var s=(p=t[o]).inputs;for(var a in s){for(var u=s[a],c=!1,l=0;l<e.length;l++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var d={};for(o=t.length-1;o>=0;o--)for(s=(p=t[o]).inputs,l=0;l<p.outputs.length;l++)if(h[p.outputs[l].id]){for(var a in s)h[s[a].id]=!0,d[p.id]=!0;break}var f=[];for(o=0;o<t.length;o++){var p;if(i[(p=t[o]).id]&&d[p.id]){var m={};for(var a in p.inputs){var g=p.inputs[a];r[g.id]&&(m[a]=g)}var v=Object.assign({},p);v.inputs=m,v.outputs=p.outputs,f.push(v)}}return f}(this.state.activeTape,e,o);if(!r&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,a={};a[o.id]=null==n?(r=vO(WR(t=o.shape),"float32"),OO.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=OO.make(e.shape,{values:yO(e.size,e.dtype)},e.dtype);o.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var s=i.gradient(1===i.outputs.length?o[0]:o),a=function(e){if(!(e in s))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(s)+".");var r=n((function(){return s[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!qR(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var a=t[o.id];t[o.id]=a.add(r),a.dispose()}};for(var u in i.inputs)a(u)},i=e.length-1;i>=0;i--)r(i)}(a,s,(function(t){return i.tidy(t)}));var u=e.map((function(t){return a[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return jR(dO(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];jR(r.every((function(t){return t instanceof OO})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernel((function(e,i){return jR((n=t.apply(void 0,r.concat([i]))).value instanceof OO,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),jR(dO(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];jR(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),jR(o.every((function(t){return t instanceof OO})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var s={};return o.forEach((function(t,e){s[e]=function(){return t}})),s}))}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=aO(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return AR(this,void 0,void 0,(function(){var e,n;return RR(this,(function(r){switch(r.label){case 0:return e=bO(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=bO()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new GO,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),KO=function(){var t=function(){if(null==HO){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}HO=t}return HO}();if(null==t._tfengine){var e=new OR(t);t._tfengine=new $O(e)}return PR(t._tfengine.ENV),TO=function(){return t._tfengine},t._tfengine}();function XO(){return"undefined"!=typeof window||"undefined"!=typeof WorkerGlobalScope}DR.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),DR.registerFlag("IS_BROWSER",(function(){return XO()})),DR.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),DR.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),DR.registerFlag("PROD",(function(){return!1})),DR.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return DR.getBool("DEBUG")})),DR.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),DR.registerFlag("IS_TEST",(function(){return!1}));var YO={},QO={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function JO(t,e){YO[t]=e}function ZO(t){t in YO||(YO[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete YO[t]}),!1),1===t?e.getContext("webgl",QO)||e.getContext("experimental-webgl",QO):e.getContext("webgl2",QO)}(t));var e=YO[t];return e.isContextLost()?(delete YO[t],ZO(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),YO[t])}function tN(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+nN(t,e))}(t),r}function eN(t){return!!(DR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function nN(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function rN(t,e,n){return IN(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function iN(t,e,n){var r=IN(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(tN(t,e,(function(){return t.shaderSource(r,n)})),tN(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function oN(t,e,n){var r=IN(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(tN(t,e,(function(){return t.shaderSource(r,n)})),tN(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=uN.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,s=i.map((function(t,e){return KR((e+1).toString(),o)+t})),a=0,u=0;u<s.length;u++)a=Math.max(s[u].length,a);var c=s.slice(0,r-1),l=s.slice(r-1,r),h=s.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+KR(l[0],a),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var sN,aN,uN=/ERROR: [0-9]+:([0-9]+):/g;function cN(t,e){return IN(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function lN(t,e,n){if(tN(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function hN(t,e,n){if(tN(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function dN(t,e,n){var r=IN(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return tN(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),tN(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function fN(t,e,n){var r=IN(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return tN(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),tN(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function pN(t,e){return IN(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function mN(t,e){var n=DR.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function gN(t,e){return IN(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function vN(t,e,n,r,i,o,s,a){var u=t.getAttribLocation(n,r);return-1!==u&&(tN(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),tN(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,s,a)})),tN(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function yN(t,e,n,r){kN(t,r),tN(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function bN(t,e,n,r){return IN(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function wN(t,e,n){return t.getUniformLocation(e,n)}function _N(t,e,n,r,i,o){tN(t,e,(function(){return yN(t,e,r,o)})),tN(t,e,(function(){return t.uniform1i(i,o)}))}function xN(t,e,n,r){tN(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),tN(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function CN(t,e,n){tN(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),tN(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function EN(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+SN(t,e))}function SN(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function IN(t,e,n,r){var i=tN(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function kN(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function TN(t,e){return void 0===e&&(e=2),WR(t.slice(0,t.length-e))}function AN(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function RN(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[TN(t)].concat(AN(t))),e}function ON(t,e){var n;void 0===e&&(e=!1);var r=DR.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?LR(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=JR(t);t=i.newShape}var o=WR(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var s=TN(t),a=2,u=2;return t.length&&(a=(n=AN(t))[0],u=n[1]),$R(o=s*(a/2)*(u/2)).map((function(t){return 2*t}))}return $R(o)}function NN(t){return t%2==0}function DN(t,e){if(qR(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(NN(n)&&NN(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&NN(t[0])&&NN(e[0])}function PN(t){if(null==sN){var e=ZO(t);sN=e.getParameter(e.MAX_TEXTURE_SIZE)}return sN}function MN(t){if(null==aN){var e=ZO(t);aN=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,aN)}function FN(t){if(0===t)return 0;var e=ZO(t);return LN(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:LN(e,"EXT_disjoint_timer_query")?1:0}function LN(t,e){return null!=t.getExtension(e)}function BN(t){try{if(null!=ZO(t))return!0}catch(t){return!1}return!1}function jN(t){if(0===t)return!1;var e=ZO(t);if(1===t){if(!LN(e,"OES_texture_float"))return!1}else if(!LN(e,"EXT_color_buffer_float"))return!1;return UN(e,t)}function VN(t){if(0===t)return!1;var e=ZO(t);if(1===t){if(!LN(e,"OES_texture_float"))return!1;if(!LN(e,"WEBGL_color_buffer_float"))return!1}else if(!LN(e,"EXT_color_buffer_float"))return!1;return UN(e,t)}function UN(t,e){var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,2===e?t.RGBA32F:t.RGBA,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(n),i}function zN(t){return 2===t&&null!=ZO(t).fenceSync}var WN=Object.freeze({callAndCheck:tN,canBeRepresented:eN,getWebGLErrorMessage:nN,getExtensionOrThrow:rN,createVertexShader:iN,createFragmentShader:oN,createProgram:cN,linkProgram:lN,validateProgram:hN,createStaticVertexBuffer:dN,createStaticIndexBuffer:fN,getNumChannels:function(){return 2===DR.getNumber("WEBGL_VERSION")?1:4},createTexture:pN,validateTextureSize:mN,createFramebuffer:gN,bindVertexBufferToProgramAttribute:vN,bindTextureUnit:yN,unbindTextureUnit:function(t,e,n){kN(t,n),tN(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:bN,getProgramUniformLocation:wN,bindTextureToProgramUniformSampler:_N,bindCanvasToFramebuffer:function(t,e){tN(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),tN(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),tN(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:xN,unbindColorTextureFromFramebuffer:CN,validateFramebuffer:EN,getFramebufferErrorMessage:SN,getBatchDim:TN,getRowsCols:AN,getShapeAs3D:RN,getTextureShapeFromLogicalShape:ON,isReshapeFree:DN,get MAX_TEXTURE_SIZE(){return sN},get MAX_TEXTURES_IN_SHADER(){return aN},getWebGLMaxTextureSize:PN,getMaxTexturesInShader:MN,getWebGLDisjointQueryTimerVersion:FN,isWebGLVersionEnabled:BN,isRenderToFloatTextureEnabled:jN,isDownloadFloatTextureEnabled:VN,isWebGLFenceEnabled:zN});function qN(t){DR.getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function HN(t,e){return KO.tidy(t,e)}function GN(t){qO(t).forEach((function(t){return t.dispose()}))}function $N(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DR.getBool("IS_TEST")||console.warn.apply(console,t)}function KN(t){var e=t;if(oO(t))return[t.length];if(!Array.isArray(t))return[];for(var n=[];Array.isArray(e)||oO(e);)n.push(e.length),e=e[0];return Array.isArray(t)&&DR.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||oO(e)){jR(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),jR(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else jR(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,n,[]),n}function XN(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function YN(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof OO)return XN(r,t.dtype,e,n),t;var i=hO(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),XN(r,i,e,n),null==t||!oO(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=KN(t);oO(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?mO(t,i,DR.getBool("DEBUG")):zR(t);return OO.make(o,{values:s},i)}function QN(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return YN(t,e+"["+r+"]",n)}),r)}function JN(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function ZN(t,e,n){for(var r=t.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)-1===n.indexOf(a)?i.push(t[o++]):i.push(e[s++]);return i}function tD(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function eD(t,e){return ZN(t,e.map((function(t){return 1})),e)}function nD(t,e,n){jR(JN(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function rD(t,e){if(JN(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function iD(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function oD(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function sD(t,e){var n=t[0].length;t.forEach((function(t,e){jR(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),jR(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)jR(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function aD(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function uD(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];KO.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),KO.endScope(i),i}catch(t){throw KO.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}DR.registerFlag("HAS_WEBGL",(function(){return DR.getNumber("WEBGL_VERSION")>0})),DR.registerFlag("WEBGL_VERSION",(function(){return BN(2)?2:BN(1)?1:0})),DR.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===DR.get("WEBGL_VERSION")})),DR.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),DR.registerFlag("WEBGL_PACK",(function(){return DR.getBool("HAS_WEBGL")})),DR.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_PACK_CLIP",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),DR.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_PACK_REDUCE",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_CONV_IM2COL",(function(){return DR.getBool("WEBGL_PACK")})),DR.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return PN(DR.getNumber("WEBGL_VERSION"))})),DR.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return MN(DR.getNumber("WEBGL_VERSION"))})),DR.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=DR.getNumber("WEBGL_VERSION");return 0===t?0:FN(t)})),DR.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),DR.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return jN(DR.getNumber("WEBGL_VERSION"))})),DR.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return VN(DR.getNumber("WEBGL_VERSION"))})),DR.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return zN(DR.getNumber("WEBGL_VERSION"))})),DR.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return DR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),RO=qN;var cD=uD({complex_:function(t,e){var n=YN(t,"real","complex"),r=YN(e,"imag","complex");return VR(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),KO.runKernel((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),lD=uD({real_:function(t){var e=YN(t,"input","real");return KO.runKernel((function(t){return t.real(e)}),{$input:e})}}),hD=uD({imag_:function(t){var e=YN(t,"input","imag");return KO.runKernel((function(t){return t.imag(e)}),{$input:e})}});function dD(t,e,n){return fD(t,e,KN(t),n)}function fD(t,e,n,r){if(null==r&&(r=hO(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!oO(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){wO(e);var i=WR(e),o=WR(n);jR(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var s=0;s<n.length;++s){var a=s!==n.length-1||n[s]!==WR(e.slice(s));jR(n[s]===e[s]||!a,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return oO(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?mO(t,r,DR.getBool("DEBUG")):zR(t),OO.make(e,{values:t},r)}function pD(t,e){if((oO(t)||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");return fD(t,[],[],e)}function mD(t,e){UR(t);var n=KN(t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return fD(t,null,n,e)}function gD(t,e,n){if(UR(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=KN(t);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return fD(t,e,r,n)}function vD(t,e,n){if(UR(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=KN(t);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return fD(t,e,r,n)}function yD(t,e,n){if(UR(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=KN(t);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return fD(t,e,r,n)}function bD(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=bD(t,"float32"),r=wD(t,"float32");return cD(n,r)}var i=vO(WR(t),e);return OO.make(t,{values:i},e)}function wD(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=wD(t,"float32"),r=wD(t,"float32");return cD(n,r)}var i=yO(WR(t),e);return OO.make(t,{values:i},e)}function _D(t,e,n){return KO.runKernel((function(r){return r.fill(t,e,n)}),{})}function xD(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return wD([0],r);var i=yO(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return mD(i,r)}var CD=uD({onesLike_:function(t){var e=YN(t,"x","onesLike");if("complex64"===e.dtype){var n=CD(lD(e)),r=ED(hD(e));return cD(n,r)}return KO.runKernel((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return ED(t)}}}))}}),ED=uD({zerosLike_:function(t){var e=YN(t,"x","zerosLike");return KO.runKernel((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return ED(t)}}}))}}),SD=uD({concat_:function(t,e){void 0===e&&(e=0),jR(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=QN(t,"tensors","concat");e=QR(e,n[0].shape)[0];var r=aD(n.map((function(t){return t.shape})),e);if(0===WR(r))return dD([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return sD(i,e),KO.runKernel((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return RD(t,n,e).map((function(t){return function(){return t}}))}))}}),ID=uD({concat1d_:function(t){return SD(t,0)}}),kD=uD({concat2d_:function(t,e){return SD(t,e)}}),TD=uD({concat3d_:function(t,e){return SD(t,e)}}),AD=uD({concat4d_:function(t,e){return SD(t,e)}}),RD=uD({split_:function(t,e,n){void 0===n&&(n=0);var r,i=YN(t,"x","split");return n=QR(n,i.shape)[0],"number"==typeof e?(jR(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(jR(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),KO.runKernel((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return SD(t,n)}}}))}});function OD(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ND=OD((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.alea=o}(0,t)})),DD=OD((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor128=o}(0,t)})),PD=OD((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)})),MD=OD((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)})),FD=OD((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=a[127&o]^=r+(s=s+1640531527|0))?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,a[i]=(r^=r>>>15)^(n^=n>>>12);t.w=s,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)})),LD=OD((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.tychei=o}(0,t)})),BD=OD((function(t){!function(e,r){var i,o=this,s=256,a="random",u=r.pow(s,6),c=r.pow(2,52),l=2*c,h=255;function d(t,n,h){var d=[],v=m(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(o.crypto||o.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,g(e)]}}():t,3),d),y=new f(d),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*s,e*=s,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(g(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&p(i,y),t.state=function(){return p(y,{})}),n?(r[a]=t,e):t})(b,v,"global"in n?n.global:this==r,n.state)}function f(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=h&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=h&i+1],n=n*s+a[h&(a[i]=a[o=h&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(s)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(r["seed"+a]=d,m(r.random(),e),t.exports){t.exports=d;try{i=n(1)}catch(t){}}}([],Math)}));BD.alea=ND,BD.xor128=DD,BD.xorwow=PD,BD.xorshift7=MD,BD.xor4096=FD,BD.tychei=LD;var jD=BD.alea,VD=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=jD(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,s=void 0;do{s=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(s>=1||0===s);var a=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*o*a,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),UD=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=1);var i=this;if(this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=jD(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function zD(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",wO(t),new kO(t,e,n)}var WD=uD({batchToSpaceND_:function(t,e,n){var r=YN(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return jR(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),jR(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),jR(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),KO.runKernel((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),qD=uD({cast_:function(t,e){var n=YN(t,"x","cast");if(!rO(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return KO.runKernel((function(t){return t.cast(n,e)}),{$x:n},(function(t){return{$x:function(){return t.clone()}}}))}}),HD=uD({clone_:function(t){var e=YN(t,"x","clone",null);return KO.runKernel((function(t){return OO.make(e.shape,{dataId:e.dataId},e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),GD=uD({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=YN(t,"x","cumsum"),o=rD([e|=0],i.rank),s=i;null!=o&&(s=i.transpose(o));var a=oD(1,i.rank)[0],u=KO.runKernel((function(t){return t.cumsum(s,a,n,r)}),{permutedX:s},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),$D=uD({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=YN(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];return jR(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),jR(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),jR(s%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape})),KO.runKernel((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),KD=uD({expandDims_:function(t,e){void 0===e&&(e=0);var n=YN(t,"x","expandDims",null);jR(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(jR(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),sP(n,r)}}),XD=uD({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=zD([t,e],r),o=t<=e?t:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(t,e);if(null==n)return a;if(1===n.length)return lP(KD(a,0),[n[0],1,1]);if(2===n.length)return lP(KD(KD(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return lP(KD(KD(KD(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),YD=uD({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=YN(t,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);n=n||Math.random();var a=1===s?i.as2D(1,-1):i,u=KO.runKernel((function(t){return t.multinomial(a,r,e,n)}),{logits2D:a});return 1===s?u.as1D():u}}),QD=uD({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=YN(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),KO.runKernel((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return wD(i.shape,"float32")}}})).reshape(o)}}),JD=uD({pad_:function(t,e,n){void 0===n&&(n=0);var r=YN(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map((function(t){return t[0]}));return KO.runKernel((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(i,r.shape)}}}))}}),ZD=uD({pad1d_:function(t,e,n){return void 0===n&&(n=0),jR(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),JD(t,[e],n)}}),tP=uD({pad2d_:function(t,e,n){return void 0===n&&(n=0),jR(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),JD(t,e,n)}}),eP=uD({pad3d_:function(t,e,n){return void 0===n&&(n=0),jR(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),JD(t,e,n)}}),nP=uD({pad4d_:function(t,e,n){return void 0===n&&(n=0),jR(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),JD(t,e,n)}}),rP=uD({rand_:function(t,e,n){var r=WR(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return OO.make(t,{values:i},n)}}),iP=uD({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new VD(e,n,r,!1,i),s=zD(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),oP=uD({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=zD(t,r),s=new UD(e,n,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),sP=uD({reshape_:function(t,e){var n=YN(t,"x","reshape",null);return e=YR(e,n.size),jR(n.size===WR(e),(function(){return"new shape and old shape must have the same number of elements."})),KO.runKernel((function(t){return t.reshape(n,e)}),{$x:n},(function(t){return{$x:function(){return t.reshape(n.shape)}}}))}}),aP=uD({spaceToBatchND_:function(t,e,n){var r=YN(t,"x","spaceToBatchND");return jR(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),jR(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),jR(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),KO.runKernel((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),uP=uD({squeeze_:function(t,e){var n=YN(t,"x","squeeze");return sP(n,JR(n.shape,e).newShape)}}),cP=uD({stack_:function(t,e){void 0===e&&(e=0);var n=QN(t,"tensors","stack");if(jR(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;jR(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){VR(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){jR(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return SD(o,e)}}),lP=uD({tile_:function(t,e){var n=YN(t,"x","tile",null);return jR(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),KO.runKernel((function(t,r){var i=t.tile(n,e);return r([n]),i}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=ED(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var s=0;s<e[2];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(s=0;s<e[2];++s)for(var a=0;a<e[3];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2],a*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),hP=uD({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new VD(e,n,r,!0,i),s=zD(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),dP=uD({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=YN(t,"x","unstack");return jR(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),KO.runKernel((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return cP(t,e)}}}))}});function fP(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([t[s+1]/e[s],e[s]]);i=i.concat(t.slice(o+1))}return i}function pP(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function mP(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function gP(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function vP(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function yP(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var s=t.shape,a=n.slice();a.pop();var u=1;for(o=r;o<t.rank;++o)u*=s[o],a.push(s[o]);var c=pO(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[a,i,u,c]}function bP(t){return t<=30?t:fO(t,Math.floor(Math.sqrt(t)))}function wP(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,s=r;s<i;++s)o*=n[s];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:pO(n.slice(0,r)).concat([1]),outputSize:WR(n)}}function _P(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),0!==s)throw new Error("ellipsis mask is not yet supported");if(0!==a)throw new Error("new axis mask is not yet supported");for(var c=[],l=[],h=[],d=0;d<t.length;d++)c[d]=xP(i,e,r,t,d),l[d]=CP(o,n,r,t,d),u&1<<d&&(l[d]=c[d]+1,h.push(d));var f=new Array(t.length).fill(0);return f=f.map((function(t,e){for(var n=0,i=r[e]||1,o=c[e];!(i>0?o>=l[e]:o<=l[e]);o+=i)n+=1;return n})),[c,f,h]}function xP(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),FR(0,o,s-1)}function CP(t,e,n,r,i){var o=e[i],s=n[i]||1;(t&1<<i||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),s>0?FR(0,o,a):FR(-1,o,a-1)}function EP(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function SP(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function IP(t){return KO.customGrad(t)}var kP=uD({softmax_:function(t,e){void 0===e&&(e=-1);var n=YN(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return IP((function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}}))(n)}}),TP=uD({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=YN(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return IP((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),AP=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}();function RP(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function OP(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function NP(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var s=e[e.length-i-1];if(null==s&&(s=1),1===o)n.unshift(s);else if(1===s)n.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function DP(t,e,n,r,i,o,s){void 0===s&&(s="channelsLast");var a,u=LP(e),c=u[0],l=u[1];if("channelsLast"===s)a=[c,l,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);a=[c,l,t[1],t[1]]}return PP(t,a,n,r,i,o,!1,s)}function PP(t,e,n,r,i,o,s,a){void 0===s&&(s=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],d=u[3];if("channelsLast"===a)c=t[0],l=t[1],h=t[2],d=t[3];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=t[0],d=t[1],l=t[2],h=t[3]}var f,p=e[0],m=e[1],g=e[3],v=LP(n),y=v[0],b=v[1],w=LP(r),_=w[0],x=w[1],C=jP(p,_),E=jP(m,x),S=function(t,e,n,r,i,o,s,a){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i,o){null==i&&(i=FP(t,e,r));var s=t[1],a=VP((t[0]-e+2*i)/r+1,o);jR(HR(a),(function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"}));var u=VP((s-e+2*i)/r+1,o);return jR(HR(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[a,u,1]}([e,n,1],o,0,r,t,a);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var d=Math.max(0,(c-1)*r+o-e),f=Math.max(0,(l-1)*i+s-n),p=Math.floor(d/2),m=d-p,g=Math.floor(f/2);u={top:p,bottom:m,left:g,right:f-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),l=Math.ceil((n-s+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,b,C,E,o),I=S.outHeight,k=S.outWidth,T=s?g*d:g;return"channelsFirst"===a?f=[c,T,I,k]:"channelsLast"===a&&(f=[c,I,k,T]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:h,inChannels:d,outHeight:I,outWidth:k,outChannels:T,padInfo:S.padInfo,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:C,effectiveFilterWidth:E,dilationHeight:_,dilationWidth:x,inShape:t,outShape:f,filterShape:e}}function MP(t,e,n,r,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var a=[-1,-1,-1,-1,-1],u=a[0],c=a[1],l=a[2],h=a[3],d=a[4];if("channelsLast"===s)u=t[0],c=t[1],l=t[2],h=t[3],d=t[4];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);u=t[0],d=t[1],c=t[2],l=t[3],h=t[4]}var f,p=e[0],m=e[1],g=e[2],v=e[4],y=BP(n),b=y[0],w=y[1],_=y[2],x=BP(r),C=x[0],E=x[1],S=x[2],I=function(t,e,n,r,i,o,s,a,u,c){var l,h,d,f;if("same"===t){var p=((h=Math.ceil(e/i))-1)*i+a-e,m=((d=Math.ceil(n/o))-1)*o+u-n,g=((f=Math.ceil(r/s))-1)*s+c-r,v=Math.floor(p/2),y=p-v,b=Math.floor(m/2),w=m-b,_=Math.floor(g/2);l={top:b,bottom:w,left:_,right:g-_,front:v,back:y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);l={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-a+1)/i),d=Math.ceil((n-u+1)/o),f=Math.ceil((r-c+1)/s)}return{padInfo:l,outDepth:h,outHeight:d,outWidth:f}}(i,c,l,h,b,w,_,jP(p,C),jP(m,E),jP(g,S)),k=I.outDepth,T=I.outHeight,A=I.outWidth,R=o?v*d:v;return"channelsFirst"===s?f=[u,R,k,T,A]:"channelsLast"===s&&(f=[u,k,T,A,R]),{batchSize:u,dataFormat:s,inDepth:c,inHeight:l,inWidth:h,inChannels:d,outDepth:k,outHeight:T,outWidth:A,outChannels:R,padInfo:I.padInfo,strideDepth:b,strideHeight:w,strideWidth:_,filterDepth:p,filterHeight:m,filterWidth:g,dilationDepth:C,dilationHeight:E,dilationWidth:S,inShape:t,outShape:f,filterShape:e}}function FP(t,e,n,r){void 0===r&&(r=1);var i=jP(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function LP(t){return"number"==typeof t?[t,t]:t}function BP(t){return"number"==typeof t?[t,t,t]:t}function jP(t,e){return e<=1?t:t+(t-1)*(e-1)}function VP(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function UP(t){var e=LP(t);return 1===e[0]&&1===e[1]}function zP(t,e){return UP(t)||UP(e)}function WP(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=wD(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!iO(t.dtype,e))return OO.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var s=n.real(t);return o=s.cast(e),s.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var a=pD(0,t.dtype);return o=n.notEqual(t,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function qP(t,e){return OO.make(e,{dataId:t.dataId},t.dtype)}function HP(t,e,n){var r=(e-t)/(n-1),i=yO(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return mD(i,"float32")}function GP(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function $P(t,e){return{real:t[2*e],imag:t[2*e+1]}}function KP(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function XP(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function YP(t,e,n,r,i){for(var o=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),s=[],a=0;a<o.length;a++){var u=o[a],c=u.boxIndex;if(u.score<i)break;for(var l=!1,h=s.length-1;h>=0;--h)if(QP(t,c,s[h])>=r){l=!0;break}if(!l&&(s.push(c),s.length>=n))break}return mD(s,"int32")}function QP(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(a-o)*(u-s),p=(h-c)*(d-l);if(f<=0||p<=0)return 0;var m=Math.max(o,c),g=Math.max(s,l),v=Math.min(a,h),y=Math.min(u,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+p-b)}function JP(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function ZP(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=zD(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(t.rank),a=0;a<s.length;a++)s[a]=o[a]%t.shape[a];var u=t.locToIndex(s);i.values[r]=t.values[u]}return i.toTensor()}function tM(t,e,n,r,i){for(var o=e[e.length-1],s=[t.length/o,o],a=s[0],u=s[1],c=ZR(n,a*r),l=ZR("int32",a*r),h=0;h<a;h++){for(var d=h*u,f=t.subarray(d,d+u),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((function(t,e){return e.value-t.value}));var g=h*r,v=c.subarray(g,g+r),y=l.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=e.slice();return b[b.length-1]=r,[dD(c,b,n),dD(l,b,"int32")]}function eM(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=zD(t,"int32"),o=zD([n.length,t.length],"int32");for(r=0;r<n.length;r++){var s=i.indexToLoc(n[r]);o.values.set(s,r*t.length)}return o.toTensor()}!function(){function t(){}t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")}}(),Object.freeze({castTensor:WP,reshapeTensor:qP,linspaceImpl:HP,upcastType:VO,axesAreInnerMostDims:JN,combineLocations:ZN,computeOutAndReduceShapes:tD,expandShapeToKeepDim:eD,assertAxesAreInnerMostDims:nD,getAxesPermutation:rD,getUndoAxesPermutation:iD,getInnerMostAxes:oD,getBroadcastDims:RP,getReductionAxes:OP,assertAndGetBroadcastShape:NP,assertParamsConsistent:sD,computeOutShape:aD,computePool2DInfo:DP,computeConv2DInfo:PP,computeConv3DInfo:MP,computeDefaultPad:FP,tupleValuesAreOne:UP,eitherStridesOrDilationsAreOne:zP});var nM=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},rM=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},iM=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function oM(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function sM(t,e){return 1===e?[t]:oM(t,e)}function aM(){var t,e,n,r,i,o,s,a,u,c;return 2===DR.getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 0. || val == 0.) ? false : true;\n      }\n    ",u="\n      const float INFINITY = uintBitsToFloat(uint(0x7f800000));\n    ",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:c}}function uM(t,e,n){void 0===n&&(n="index");var r=pO(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function cM(t){var e=pO(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var lM="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function hM(t){return"offset"+t}function dM(t){var e=t.name,n=WR(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function fM(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function pM(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function mM(t,e){return e.map((function(e){return t[e]})).join(", ")}var gM=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,jR(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,a=this.outputShape,u=a.length,c=fM(u),l=sM("coords",u);if(1===i){var h=fM(s=u+1);o="\n        "+h+" sourceLocR = "+h+"("+l.join()+", 0);\n        ++"+l[u-1]+";\n        "+h+" sourceLocG = "+h+"("+l.join()+", 0);\n        ++"+l[u-2]+";\n        "+h+" sourceLocA = "+h+"("+l.join()+", 0);\n        --"+l[u-1]+";\n        "+h+" sourceLocB = "+h+"("+l.join()+", 0);\n        --"+l[u-2]+";"}else s=u,o="\n        "+c+" sourceLocR = coords;\n        ++"+l[u-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+l[u-2]+";\n        "+c+" sourceLocA = coords;\n        --"+l[u-1]+";\n        "+c+" sourceLocB = coords;\n        --"+l[u-2]+";";var d=["x","y","z","w","u","v"].slice(0,s),f="."+d[s-1],p=d.map((function(t){return"int "+t})),m=sM("sourceLocR",s-1).concat("inIdx.r"),g=sM("sourceLocG",s-1).concat("inIdx.g"),v=sM("sourceLocB",s-1).concat("inIdx.b"),y=sM("sourceLocA",s-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+")));",_="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+v.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+y.join()+") : 0.)",x=r?"":"\n      float getBestIndicesAChannel("+p.join()+") {\n        return getChannel(getBestIndicesA("+d.join()+"),\n                                          vec2("+d.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+p.join()+") {\n        return getChannel(getA("+d.join()+"),\n                               vec2("+d.slice(-2).join()+"));\n      }\n      "+x+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+l[u-1]+" < "+(a[u-1]-1)+";\n        bool hasNextRow = "+l[u-2]+" < "+(a[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+f+", sourceLocG"+f+",\n          sourceLocB"+f+", sourceLocA"+f+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+_+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+_+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},vM=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yM=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],NP(t,e),NP(t,n);var s="0.0";null!=r&&(NP(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";null!=i&&(NP(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+s+";\n        float scale = "+a+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},bM=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],NP(t,e),NP(t,n);var s="vec4(0.0)";null!=r&&(NP(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";null!=i&&(NP(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+s+";\n        vec4 scale = "+a+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},wM=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=NP(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},_M="return a - b;",xM="return a * b;",CM=function(t,e,n){this.variableNames=["A","B"],this.outputShape=NP(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},EM=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=NP(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===WR(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+fM(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var s=sM("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+s[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+s[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},SM=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, min, max));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),IM=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(min), vec4(max)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),kM=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},TM=function(t){this.outputShape=[],this.outputShape=aD(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},AM=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=aD(t,e);var n=this.outputShape,r=n.length,i=fM(r),o=sM("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var a=new Array(t.length-1);a[0]=t[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+t[u][e];var c=s[e],l="vec2("+s.slice(-2).join()+")",h=s.join(),d="if ("+c+" < "+a[0]+")\n          return getChannel(getT0("+h+"), "+l+");";for(u=1;u<a.length;u++)d+="\n        else if ("+c+" < "+a[u]+") {\n          "+c+" -= "+a[u-1]+";\n          return getChannel(getT"+u+"("+h+"), "+l+");\n        }";d+="\n        else {\n          "+c+" -= "+a[a.length-1]+";\n          return getChannel(getT"+a.length+"("+h+"), "+l+");\n        }",this.userCode="\n      float getValue("+s.map((function(t){return"int "+t}))+") {\n        "+d+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n        if (++"+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n        if (++"+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            --"+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "},RM=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},OM=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},NM=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},DM=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},PM=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TODO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},MM=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TODO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},FM=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.top,n=t.padInfo.left,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,a=t.filterHeight,u=t.filterWidth,c=4*Math.floor(t.inChannels/4),l=t.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+i+");\n      const ivec2 pads = ivec2("+e+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+"; wR++) {\n          int xR = xRCorner + wR * "+o+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+u+"; wC++) {\n            int xC = xCCorner + wC * "+s+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+c+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===l)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+c+") *\n                getW(wR, wC, "+c+", d2);\n            } else if ("+(2===l)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===l)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1),\n                getX(batch, xR, xC, "+c+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2),\n                getW(wR, wC, "+c+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},LM=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+s+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+a+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},BM=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+t.strideHeight+", "+t.strideWidth+");\n      const ivec2 pads = ivec2("+t.padInfo.top+", "+t.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+e+";\n        int q = d2 - d1 * "+e+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+t.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+t.dilationHeight+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+t.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+t.dilationWidth+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},jM=function(t){this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var e=t.inHeight,n=t.inWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,a=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,d="int xR; int xC; int xCOffset;",f=0;f<c;f++)for(var p=0;p<l;p++)d+="\n          vec4 xTexelR"+f+"C"+2*p+" = vec4(0.);\n          vec4 wR"+f+"C"+p+" = vec4(0.);\n          vec4 xR"+f+"C"+p+" = vec4(0.);";for(f=0;f<c;f++)for(var m=0;m<h;m++){if(d+="\n          xR = xRCorner + "+f*a+";\n          xC = xCCorner + "+(p=2*m)*u+";\n        ",1===s){if(p<l&&(d+=i%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+f+"C"+p+" = vec4(previous.zw, xTexelR"+f+"C"+p+".xy);\n                } else {\n                  xR"+f+"C"+p+" = vec4(0, 0, xTexelR"+f+"C"+p+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+e+" && xC >= 0 && xC < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = xTexelR"+f+"C"+p+";\n              ",p+1<l)){var g=i%2==0?LR(u):u;u%2==0&&i%2==1||u%2!=0&&i%2!=1?(d+="\n                  xCOffset = xC + "+i%2+" + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",u>1&&(d+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+e+" &&\n                      xCOffset >= 0 && xCOffset < "+n+") {\n                      xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+f+"C"+p+" = vec4(0.);\n                    }\n                  "),d+="\n                  xR"+f+"C"+(p+1)+" = vec4(\n                    xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".xy);\n                "):d+="\n                  xCOffset = xC + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+f+"C"+(p+1)+" = xTexelR"+f+"C"+(p+2)+";\n                "}}else p<l&&(d+="\n              if(xR >= 0 && xR < "+e+") {\n            ",i%2==1?(d+="\n                xCOffset = xC + 1 - "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+n+") {\n                  xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+f+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = vec4(\n                  xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".zw);\n              ",p+1<l&&(d+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+s+";\n                  if(xCOffset >= 0 && xCOffset < "+n+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+f+"C"+(p+1)+" = vec4(xTexelR"+f+"C"+(p+2)+".xy, final.xy);\n                ")):(d+="\n                if(xC >= 0 && xC < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = vec4(\n                  xTexelR"+f+"C"+p+".xy, xTexelR"+f+"C"+(p+2)+".xy);\n              ",p+1<l&&(d+="\n                  xR"+f+"C"+(p+1)+" = vec4(\n                    xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".zw);\n                ")),d+="}");p<l&&(d+="\n            vec4 wTexelR"+f+"C"+p+" = getW("+f+", "+p+", d1, q);\n            wR"+f+"C"+p+" = vec4(wTexelR"+f+"C"+p+".xz, wTexelR"+f+"C"+p+".xz);\n          ",p+1<l&&(d+="\n              vec4 wTexelR"+f+"C"+(p+1)+" = getW("+f+", "+(p+1)+", d1, q);\n              wR"+f+"C"+(p+1)+" =\n                vec4(wTexelR"+f+"C"+(p+1)+".xz, wTexelR"+f+"C"+(p+1)+".xz);"))}for(f=0;f<c;f++)for(p=0;p<l;p++)d+="result += xR"+f+"C"+p+" * wR"+f+"C"+p+";";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+r+", "+i+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 result = vec4(0.);\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},VM=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],s=t[1],a=t[2],u=n[0],c=n[1];this.outputShape=[e[0],u,c,t[3]];var l=[s-1+".0",a-1+".0"],h=l[0],d=l[1],f=u>1?[""+(s-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],p=c>1?[""+(a-1)/(c-1),"(x2-x1) * width_ratio","x1*"+d+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+d];this.userCode="\n      const float height_ratio = float("+f[0]+");\n      const float width_ratio = float("+p[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+f[1]+";\n        float width_scale = "+p[1]+";\n\n        float in_y = "+f[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+p[2]+";\n        if( in_x < 0.0 || in_x > "+d+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},UM=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+fM(r)+" coords = getOutputCoords();\n        int end = "+zM(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+zM(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function zM(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var WM,qM,HM=function(t,e){this.variableNames=["A"];var n=aM();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+uM(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},GM=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=aM();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+uM(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},$M=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),KM=function(t){this.variableNames=["A"];var e=aM();this.outputShape=t,this.userCode="\n      "+lM+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},XM=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=aM();this.outputShape=t,this.userCode="\n      "+lM+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},YM=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=aM(),i=e[0],o=e[1];this.outputShape=t;var s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      "+cM(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex /= 4;\n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+s+", 0., 0., 0.);\n      }\n    "},QM=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=aM(),i=e[0],o=e[1];this.outputShape=t;var s="",a="result";n&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;s+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex /= 4;\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+cM(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+s+"\n\n        "+r.output+" = "+a+";\n      }\n    "},JM=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},ZM=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),tF=function(t){this.variableNames=["A"];var e=aM(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},eF=function(t){this.variableNames=["A"];var e=aM(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},nF=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=fM(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},rF=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=fM(e.length),i=fM(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function iF(t,e){return[e,t]}function oF(t){var e=WR(t);return $R(Math.ceil(e/4))}function sF(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function aF(t,e){var n=aM();return iN(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function uF(t,e){return dN(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function cF(t,e){return fN(t,e,new Uint16Array([0,1,2,2,1,3]))}function lF(t,e){var n,r,i,o,s,a,u,c,l=t;return 2===DR.getNumber("WEBGL_VERSION")?(n=l.R32F,r=l.R16F,i=l.RGBA16F,o=l.RGBA32F,s=l.RED,a=4,u=1,c=l.HALF_FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=l.RGBA,s=t.RGBA,a=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:c}}function hF(t,e,n,r,i,o,s){mN(n,r);var a=pN(t,e),u=t.TEXTURE_2D;return tN(t,e,(function(){return t.bindTexture(u,a)})),tN(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),tN(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),tN(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),tN(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),tN(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,s,null)})),tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),a}function dF(t,e,n,r,i){var o=iF(n,r);return hF(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function fF(t,e,n,r,i){var o=iF(n,r);return hF(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function pF(t,e,n,r,i){var o=iF(n,r);return hF(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function mF(t,e,n,r,i){var o=sF(n,r);return hF(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function gF(t,e,n,r,i){var o=sF(n,r);return hF(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function vF(t,e,n,r){return tN(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),vN(t,e,n,"clipSpacePos",r,3,20,0)&&vN(t,e,n,"uv",r,2,20,12)}function yF(t,e,n,r,i,o,s){var a,u,c;tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(a=new Float32Array(r*i*4),u=t.FLOAT,c=s.internalFormatPackedFloat),a.set(o),tN(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,a)})),tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function bF(t,e,n,r){tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?tN(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):tN(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),tN(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function wF(t,e,n,r,i){var o=t.createBuffer();tN(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var s=16*n*r;return tN(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ)})),tN(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),tN(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function _F(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function xF(t,e,n,r,i){var o=iF(n,r),s=o[0],a=o[1],u=new Uint8Array(n*r*4);return tN(t,e,(function(){return t.readPixels(0,0,s,a,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function CF(t,e,n,r,i,o,s,a){var u=t,c=new Float32Array(function(t,e){var n=sF(t,e);return n[0]*n[1]*4}(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function EF(t,e,n,r){var i=new Float32Array(n*r*4);return tN(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(WM||(WM={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(qM||(qM={}));var SF=Object.freeze({createVertexShader:aF,createVertexBuffer:uF,createIndexBuffer:cF,getTextureConfig:lF,createFloat32MatrixTexture:dF,createFloat16MatrixTexture:fF,createUnsignedBytesMatrixTexture:pF,createPackedMatrixTexture:mF,createFloat16PackedMatrixTexture:gF,bindVertexProgramAttributeStreams:vF,uploadDenseMatrixToTexture:yF,uploadPixelDataToTexture:bF,createBufferFromOutputTexture:wF,downloadFloat32MatrixFromBuffer:_F,downloadByteEncodedFloatMatrixFromOutputTexture:xF,downloadPackedMatrixFromBuffer:CF,downloadMatrixFromPackedOutputTexture:EF}),IF=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=DR.getNumber("WEBGL_VERSION");null!=t?(this.gl=t,JO(e,t)):this.gl=ZO(e),1===DR.getNumber("WEBGL_VERSION")?(this.textureFloatExtension=rN(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),DR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||(this.textureHalfFloatExtension=rN(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float"))):this.colorBufferFloatExtension=rN(this.gl,this.debug,"EXT_color_buffer_float"),this.vertexBuffer=uF(this.gl,this.debug),this.indexBuffer=cF(this.gl,this.debug),this.framebuffer=gN(this.gl,this.debug),this.textureConfig=lF(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return DR.getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;tN(e,this.debug,(function(){return e.finish()})),tN(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),tN(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),tN(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),tN(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),tN(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),dF(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),fF(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),pF(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),bF(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),yF(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),gF(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),mF(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(CN(this.gl,this.debug,this.framebuffer),this.outputTexture=null),tN(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return xF(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return CF(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return _F(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=wF(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(DR.getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return EF(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=oN(e,this.debug,t),r=aF(e,this.debug),i=cN(e,this.debug);return tN(e,this.debug,(function(){return e.attachShader(i,r)})),tN(e,this.debug,(function(){return e.attachShader(i,n)})),lN(e,this.debug,i),this.debug&&hN(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=vF(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&tN(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&hN(this.gl,this.debug,this.program),tN(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?bN(this.gl,this.debug,t,e):wN(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),tN(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),_N(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=sF(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&hN(this.gl,this.debug,this.program),EN(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),tN(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),tN(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=rN(this.gl,this.debug,2===DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return AR(this,void 0,void 0,(function(){var e=this;return RR(this,(function(n){switch(n.label){case 0:return[4,XR((function(){return e.disposed||e.isQueryAvailable(t,DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||XR((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),xN(this.gl,this.debug,t,this.framebuffer),this.debug&&EN(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(xN(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&EN(this.gl)):CN(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;xN(r,this.debug,t,this.framebuffer),this.debug&&EN(r),this.outputTexture=t,tN(r,this.debug,(function(){return r.viewport(0,0,e,n)})),tN(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),tN(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function kF(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!qR(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var s=t.texShape,a=i.isUniform?null:i.texData.texShape;if(!qR(s,a))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+a+" must match")}}))}var TF=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,a=n.outWidth,u=n.dilationWidth,c=n.dilationHeight,l=s.left,h=s.top,d=r*n.filterWidth,f=aM();this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            int blockIndex = rc.y + col;\n            int pos = rc.x + row;\n\n            if(blockIndex >= "+t[1]+" || pos >= "+t[0]+") continue;\n\n            int offsetY = int(blockIndex / ("+a+")) * "+o+" - "+h+";\n            int d0 = offsetY + "+c+" * (pos / "+d+");\n\n            if(d0 >= "+e[0]+" || d0 < 0) continue;\n\n            int offsetX = int(mod(float(blockIndex), "+a+".) * "+i+". - "+l+".);\n            int d1 = offsetX + "+u+" * (int(mod(float(pos), "+d+".) / "+r+".));\n\n            if(d1 >= "+e[1]+" || d1 < 0) continue;\n\n            vec2 innerDims = vec2(d1, int(mod(float(pos), "+r+".)));\n            result[row * 2 + col] = getChannel(getA(d0, int(innerDims.x),\n                                              int(innerDims.y)), innerDims);\n          }\n        }\n\n        "+f.output+" = result;\n      }\n    "},AF=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},RF=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},OF=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},NF=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},DF=function(t,e,n,r,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var s=Math.ceil((n?t[1]:t[2])/2),a=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],l=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",d="";o&&(h="vec4 activation(vec4 x) {\n        "+o+"\n      }",d="result = activation(result);");var f=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+s+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+s+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+a+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          result += ("+c[0]+" * "+l[0]+") + ("+c[1]+" * "+l[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+f+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},PF=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),MF=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},FF=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=sM("rc",e),r=fM(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),s=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),s=2;s<t;s++)o=e[e.length-1-s]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+s+"));\n          }\n        }\n      "}},LF=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=fM(r),o=e.map((function(t){return t[0]})).join(","),s=e.map((function(e,n){return e[0]+t[n]})).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+a+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+s+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},BF=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=fM(r),o=e.map((function(t){return t[0]})).join(","),s=e.map((function(e,n){return e[0]+t[n]})).join(","),a=sM("rc",r),u=sM("source",r),c=a[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",a[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+a[r-2]+" += 1;\n       if("+a[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+a[r-1]+" += 1;\n         if("+c+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,m=1===r?2:4;p<m;p++)f+="\n        "+h[p]+"\n        if ("+d+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(f+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},jF=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var d="avg"===e,f="0.0";if(d||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+l+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+s+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+a+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+l+", "+h+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+s+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+a+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              getValue(batch, xR, xC + 3 * "+a+", d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},VF=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var s="0.0",a="";"prod"===e?s="1.0":"min"===e?(s="1.0 / 1e-20",a="min"):"max"===e&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+a+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===e?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+s+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+s+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},UF=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+uM(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+cM(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},zF=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],c=[n&&a>1?i-1:i,n&&u>1?o-1:o],l=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=c[0]/l[0],d=c[1]/l[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},WF=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},qF=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],s=t[3];this.outputShape=[t[0],e,n,s];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+a[0]/u[0]+",\n          "+a[1]/u[1]+",\n          "+a[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},HF=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],c=[n&&a>1?i-1:i,n&&u>1?o-1:o],l=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=c[0]/l[0],d=c[1]/l[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},GF=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},$F=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=fM(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},KF=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=sM("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],s=fM(n);function a(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+s+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return a(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},XF=function(t,e,n,r,i,o,s){void 0===s&&(s=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=fM(i.length),u=fM(o.length),c="";1===n?c="i":2===n&&(c="i, j");var l="";1===r?l="i":2===r&&(l="i, coords[1]"),this.userCode="\n        "+a+" strides = "+a+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+l+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},YF=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/n);this.outputShape=[r,s];var a=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+a+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+a+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},QF=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<t&&s.push(""+o[u]);r=s.join(),i=a.join()}var c=fM(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},JF=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=fM(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return ZF.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+ZF[e]+" = start["+e+"] + coords."+ZF[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),ZF=["x","y","z","w","u","v"],tL=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=fM(this.rank),n=sM("coords",this.rank),r=sM("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",s="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",a=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+s+"\n        "+a+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),eL=function(t,e,n,r){this.variableNames=["x"];var i=n.filter((function(t,e){return-1===r.indexOf(e)}));this.outputShape=i;var o=n.length,s=fM(n.length),a=fM(i.length),u="";if(1===o)u="coords * strides + begin";else{var c=0;u=n.map((function(t,e){return-1===r.indexOf(e)?(c++,1===i.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(c-1)+"] * strides["+e+"] + begin["+e+"]"):"begin["+e+"]"})).join(",")}this.userCode="\n      "+s+" begin = "+s+"("+t+");\n      "+s+" strides = "+s+"("+e+");\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+u+"));\n      }\n    "},nL=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=rL(e,n),o=iL(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),i===qM.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===qM.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===qM.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===qM.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===qM.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=iL(e,rL(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function rL(t,e){if(t===WM.UPLOAD)return qM.PACKED_2X2_FLOAT32;if(t===WM.RENDER||null==t)return e?DR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?qM.PACKED_2X2_FLOAT32:qM.PACKED_2X2_FLOAT16:DR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?qM.UNPACKED_FLOAT32:qM.UNPACKED_FLOAT16;if(t===WM.DOWNLOAD||t===WM.PIXELS)return qM.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function iL(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var oL=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=fM(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},sL=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=fM(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},aL=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=fM(this.rank),o=oM("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+s.join()+"), "+a+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},uL=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},cL="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",lL="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",hL=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},dL=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=sM("rc",e),r=fM(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+s+"));\n      }\n    "},fL={},pL=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!DR.getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=ZO(DR.getNumber("WEBGL_VERSION"));this.binaryCache=(n=DR.getNumber("WEBGL_VERSION"))in fL?fL[n]:(fL[n]={},fL[n]),this.gpgpu=new IF(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new nL(this.gpgpu),this.numMBBeforeWarning=null==DR.global.screen?1024:DR.global.screen.height*DR.global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new AP(this,KO)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=[t.height,t.width],r=[t.height,t.width,e];if(DR.getBool("IS_BROWSER")){if(!(t instanceof HTMLVideoElement||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t.data instanceof Uint8Array))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(t instanceof HTMLVideoElement){if(null==this.fromPixels2DContext){if("complete"!==document.readyState)throw new Error("The DOM is not ready yet. Please call tf.browser.fromPixels() once the DOM is ready. One way to do that is to add an event listener for `DOMContentLoaded` on the document object");this.fromPixels2DContext=document.createElement("canvas").getContext("2d")}this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),t=this.fromPixels2DContext.canvas}}var i,o,s=this.makeTensorHandle(n,"int32");if(this.texData.get(s.dataId).usage=WM.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(s.dataId),t),DR.getBool("WEBGL_PACK")){i=new eF(r);var a=this.makePackedTensor(i.outputShape,s.dtype);o=this.compileAndRun(i,[s],a)}else i=new tF(r),o=this.compileAndRun(i,[s]);return this.disposeData(s.dataId),o},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(DR.getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!eN(r))throw Error("The value "+r+" cannot be represented on this device.")}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=WM.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var s=new uL(o,"return x;"),a=this.compileAndRun(s,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(a.dataId);return a.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var c,l,h=null!=this.activeTimers;return h&&(c=performance.now()),l="complex64"===r?GP(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=performance.now()-c),this.convertAndCacheOnCPU(t,l)},t.prototype.read=function(t){return AR(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y;return RR(this,(function(b){switch(b.label){case 0:if(this.pendingRead.has(t))return n=this.pendingRead.get(t),[2,new Promise((function(t){return n.push(t)}))];if(r=this.texData.get(t),i=r.values,o=r.shape,s=r.dtype,a=r.complexTensors,null!=r.slice)return u=new uL(o,"return x;"),c=this.compileAndRun(u,[{dataId:t,shape:o,dtype:s}]),l=this.read(c.dataId),c.dispose(),[2,l];if(null!=i)return[2,this.convertAndCacheOnCPU(t)];if(!DR.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===DR.getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==s&&DR.get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(t),t=d.dataId,f=this.texData.get(d.dataId),h=(e=this.gpgpu).createBufferFromTexture.apply(e,[f.texture].concat(oF(o)))),this.pendingRead.set(t,[]),"complex64"===s?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:b.sent(),b.label=2;case 2:return"complex64"!==s?[3,4]:[4,Promise.all([a.real.data(),a.imag.data()])];case 3:return m=b.sent(),p=GP(m[0],m[1]),[3,5];case 4:null==h?p=this.getValuesFromTexture(t):(g=WR(o),p=this.gpgpu.downloadFloat32MatrixFromBuffer(h,g),this.disposeData(t)),b.label=5;case 5:return v=this.convertAndCacheOnCPU(t,p),y=this.pendingRead.get(t),this.pendingRead.delete(t),y.forEach((function(t){return t(v)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,v]}}))}))},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,s=r.isPacked,a=WR(i);if(DR.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),c=this.texData.get(u.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(oF(i))).subarray(0,a);return this.disposeData(u.dataId),l}var h=DR.getBool("WEBGL_PACK")&&!0===s,d=h?RN(i):i,f=this.makeTensorHandle(d,"float32");f.size=WR(i),this.texData.get(f.dataId).usage=WM.DOWNLOAD;var p=HN((function(){var e=h?new XM(d):new KM(d);return n.compileAndRun(e,[{shape:d,dtype:o,dataId:t}],f,null)})),m=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,a);return this.disposeData(f.dataId),g},t.prototype.time=function(t){return AR(this,void 0,void 0,(function(){var e,n,r,i,o,s,a;return RR(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=zR(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=zR(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return s=u.sent(),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:BR(s),getExtraProfileInfo:function(){return s.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},t.prototype.endTimer=function(t){return DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=performance.now(),t)},t.prototype.getQueryTime=function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){return DR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,s=e.isPacked,a=e.slice,u=a&&a.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,s)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getCPUBackend=function(){return DR.getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=KO.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:KO.keep(t.clone()),imag:KO.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===WR(n))return dD([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=EP(t.shape,e,n);if(r||!i){var o=DR.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tL(n):new JF(n),s=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,s)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=OO.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var s=SP(e,t.strides);r.slice&&(s+=r.slice.flatOffset),o.slice={flatOffset:s,origDataId:r.slice&&r.slice.origDataId||t.dataId};var a=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,a+1),i},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r,i,o,s,a,u);var c=_P(t.shape,e,n,r,i,o,s,a,u),l=c[0],h=c[1],d=c[2],f=h.filter((function(t,e){return-1===d.indexOf(e)}));if(f.some((function(t){return 0===t})))return dD([],f);var p=new eL(l,r,h,d);return this.compileAndRun(p,[t])},t.prototype.reverse=function(t,e){var n=DR.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new KF(t.shape,e):new $F(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>DR.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(t.length/2),r=this.concat(t.slice(0,n),e),i=this.concat(t.slice(n),e);return this.concat([r,i],e)}if(DR.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var o=new AM(t.map((function(t){return t.shape})),e);return this.compileAndRun(o,t)}var s=aD(t.map((function(t){return t.shape})),e),a=t.map((function(t){return t.as2D(-1,WR(t.shape.slice(e)))})),u=new TM(a.map((function(t){return t.shape})));return this.compileAndRun(u,a).reshape(s)},t.prototype.neg=function(t){var e=new uL(t.shape,"return -x;");return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=n?t.shape[1]:t.shape[2],a=t.shape[0];if((1===i||1===o)&&s>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(a,s,1),c=1===o?2:1,l=1===o?e.as3D(a,1,s):e;return this.multiply(u,l).sum(c,!0)}var h=VO(t.dtype,e.dtype),d=new DF(t.shape,[a,i,o],n,r),f=this.makePackedTensor(d.outputShape,h);return this.compileAndRun(d,[t,e],f)},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var s=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],u=t.shape[0],c=VO(t.dtype,e.dtype),l=new DF(t.shape,[u,s,a],n,r,!!i,o?function(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?lL:cL;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}(o,!0):null),h=this.makePackedTensor(l.outputShape,c),d=[t,e];return i&&d.push(i),this.compileAndRun(l,d,h)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new wM("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new wM("return areal * bimag + aimag * breal;",t.shape,e.shape),s=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],a=this.compileAndRun(i,s),u=this.compileAndRun(o,s),c=this.complex(a,u);return a.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,xM,t.dtype);var l=new CM(xM,t.shape,e.shape),h=this.makeOutputArray(l.outputShape,t.dtype);return this.compileAndRun(l,[t,e],h)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var s=[t,e,n],a=null;null!=o&&(a=o.shape,s.push(o));var u=null;if(null!=i&&(u=i.shape,s.push(i)),DR.getBool("WEBGL_PACK_NORMALIZATION")){var c=new bM(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(c,s)}var l=new yM(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(l,s)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=DR.getBool("WEBGL_PACK_NORMALIZATION")?new OF(t.shape,e,n,r,i):new AF(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){var a=new RF(e.shape,r,i,o,s);return this.compileAndRun(a,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype)return ZP(zD(t.shape,t.dtype,this.readSync(t.dataId)),e);var n=new oL(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.pad=function(t,e,n){var r=DR.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BF(t.shape,e,n):new LF(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=DR.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aL(t.shape,e):new sL(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new nF(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){jR(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=fP(t.shape,e,r),o=pP(i.length,e.length),s=mP(t.shape,e,r),a=gP(n,e.length),u=vP(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){jR(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=fP(s.shape,e,r,!1),u=pP(a.length,e.length,!1),c=mP(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(c)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=bP(i),s=new VF({windowSize:o,inSize:i,batchSize:r},e),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],n);return this.compileAndRun(s,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=bP(i),s=new iM({windowSize:o,inSize:i,batchSize:r},e,null==n),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],"int32"),c=[t];return null!=n&&c.push(n),this.compileAndRun(s,c,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=bP(r[r.length-1]),o=new gM(r,i,e,null==n),s=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],s),s.rank===t.rank?this.argReducePacked(t,e,s):s},t.prototype.sum=function(t,e){nD("sum",e,t.rank);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i),s=UO(t.dtype);return this.reduce(o,"sum",s).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i),s=UO(t.dtype);return this.reduce(o,"prod",s).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=rD([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=oD(1,t.rank)[0]);var s=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),a=WR([o.shape[r]]),u=o.as2D(-1,a),c=UO(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(s);return null!=i&&(l=l.transpose(iD(i))),l},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],s=t.shape[1],a=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=fO(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=fO(t,n+1);return n}(s,i),u=new YF({windowSize:a,inSize:s,batchSize:o,numSegments:i},e),c=u.outputShape,l=this.makeOutputArray([c[0],c[1]],r);return this.compileAndRun(u,[t,n],l),l.shape[1]===i?l:(n=xD(0,i).tile([s/a]),this.segOpCompute(l,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(nD("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!DR.getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=tD(t.shape,r),o=i[0],s=WR(i[1]),a=t.as2D(-1,s);return this.argReduce(a,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new UM(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new CM("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new CM("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new CM("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new CM("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new CM("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new CM("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new uL(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new CM("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new CM("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new QF(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,VO(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){$N("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return eM(t.shape,e)},t.prototype.topk=function(t,e,n){return tM(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){nD("min",e,t.rank);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new CM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new CM("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);nD("max",e,t.rank);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new CM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){nD("all",e,t.rank);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){nD("any",e,t.rank);var n=tD(t.shape,e),r=n[0],i=WR(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("return (a - b) * (a - b);",t.shape,e.shape):new CM("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(b.x == 0.0) {\n    result.x = NAN;\n  } else if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(b.y == 0.0) {\n    result.y = NAN;\n  } else if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(b.z == 0.0) {\n    result.z = NAN;\n  } else if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(b.w == 0.0) {\n    result.w = NAN;\n  } else if(a.w == b.w) {\n    result.w = 1.;\n  }\n  \n  return result;\n","float32",!0);var n=new CM("\nif (b == 0.0) {\n  return NAN;\n} \nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new CM("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a + b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=VO(t.dtype,e.dtype);if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a + b;",n);var r=new CM("return a + b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new EM(n,t.shape,e.shape,i),s=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],s)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),s=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],s=i[1],a=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,s),c=new CM(n,t.shape,e.shape),l=r.makeOutputArray(c.outputShape,VO(o.dtype,s.dtype));return r.compileAndRun(c,[a,u],l)})),a=s[0],u=s[1],c=this.complex(a,u);return a.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>DR.get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return VO(t,e)})),o=t.map((function(t){return t.shape})),s=DR.getBool("WEBGL_PACK"),a=s?new rM(t[0].shape,o):new nM(t[0].shape,o),u=s?this.makePackedTensor(a.outputShape,i):this.makeOutputArray(a.outputShape,i);return this.compileAndRun(a,t,u)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,_M);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=VO(t.dtype,e.dtype);if(DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,_M,t.dtype);var r=new CM(_M,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new EM("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new CM("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=VO(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){var e=new uL(t.shape,"return ceil(x);");return this.compileAndRun(e,[t])},t.prototype.floor=function(t){var e=new uL(t.shape,"return floor(x);");return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new uL(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new uL(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new uL(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new uL(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new uL(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){var e;return e=DR.getBool("WEBGL_PACK")?new hL(t.shape,"return exp(x);"):new uL(t.shape,"return exp(x);"),this.compileAndRun(e,[t])},t.prototype.expm1=function(t){var e=new uL(t.shape,"return exp(x) - 1.0;");return this.compileAndRun(e,[t])},t.prototype.log=function(t){var e;return e=DR.getBool("WEBGL_PACK")?new hL(t.shape,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n"):new uL(t.shape,"if (x < 0.0) return NAN;\n  return log(x);"),this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new uL(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new uL(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new uL(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new uL(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new uL(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=DR.getBool("WEBGL_PACK")?new hL(t.shape,lL):new uL(t.shape,cL),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",t.shape,e.shape):new CM("return (a < 0.) ? b * a : a;",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){var e=new uL(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new CM("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new uL(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new uL(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=DR.getBool("WEBGL_PACK_CLIP")?new IM(t.shape):new SM(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){var e=new uL(t.shape,"return abs(x);");return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new kM(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new uL(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new uL(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new uL(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new uL(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new uL(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new uL(t.shape,"return asin(x);");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new uL(t.shape,"return acos(x);");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new uL(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new EM("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new CM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new uL(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new uL(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new uL(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new uL(t.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new uL(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new uL(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new uL(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new uL(t.shape,function(t){return void 0===t&&(t=0),"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n){var r=t.shape,i=this.texData.get(t.dataId),o=r[2]%2!=0&&!!i.isPacked;if((1==r[0]*r[1]*r[2]||1===n.outChannels)&&n.inChannels>1e3||!DR.getBool("WEBGL_LAZILY_UNPACK")||!DR.getBool("WEBGL_PACK_BINARY_OPERATIONS")||!o){var s=this.reshape(t,[1,r[0]*r[1]*r[2],n.inChannels]),a=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.batchMatMul(s,a,!1,!1),n.outShape)}var u=OO.make([1,r[0]*r[1]*(r[2]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),c=i.shape;i.shape=i.shape.slice(),i.shape[i.shape.length-2]++,jR(DN(i.shape,u.shape),(function(){return"packed reshape "+i.shape+" to "+u.shape+" isn't free"}));var l=this.reshape(e,[1,n.inChannels,n.outChannels]),h=this.batchMatMul(u,l,!1,!1),d=this.texData.get(h.dataId);return jR(d.isPacked,(function(){return"batchMatMul result is expected to be packed"})),i.shape=c,d.shape=n.outShape,OO.make(n.outShape,{dataId:h.dataId},h.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n){var r=n.outWidth,i=n.outHeight,o=n.filterWidth*n.filterHeight*n.inChannels,s=i*r,a=[o,s],u=t.squeeze([0]),c=e.reshape([1,o,-1]),l=new TF(a,u.shape,n),h=this.compileAndRun(l,[u]).reshape([1,a[0],a[1]]),d=new DF(h.shape,[1,s,n.outChannels],!0,!1);return this.compileAndRun(d,[h,c]).reshape([1,i,r,n.outChannels])},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(DR.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new FM(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new OM(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new RM(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r;return DR.getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new jM(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new BM(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new MM(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new PM(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new LM(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new DM(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new NM(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new jF(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new jF(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new jF(r,"max",!0),o=this.compileAndRun(i,[e]),s=new NF(r),a=this.makeOutputArray(s.outputShape,e.dtype),u=this.compileAndRun(s,[t,o],a);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new vM(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return WP(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||DN(t.shape,e)||null!==n.texture&&DN(n.shape,e)?qP(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=DR.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qF(t.shape,e,n,r):new WF(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new zF(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new GF(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new HF(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:kP(t),o=new PF(i.shape[0],i.shape[1],n),s=this.makeOutputArray(o.outputShape,"int32"),a=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],s,a)},t.prototype.oneHot=function(t,e,n,r){var i=new MF(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return $N("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),YP(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var s=new VM(t.shape,e.shape,r,i,o);return this.compileAndRun(s,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){jR(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,s=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),a=new $M("NHWC"===n?[r,i,o,s]:[r,s,i,o],e,n);return this.compileAndRun(a,[t])},t.prototype.split=function(t,e,n){return JP(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=wP(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,c=[u/s,s],l=t.reshape([o,i]),h=e.reshape([o,s]);if(0===u)return qP(dD([]),n);var d=pD(0),f=new XF(o,i,l.rank,h.rank,a,c);return this.compileAndRun(f,[h,l,d]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=wP(0,t,n),o=new XF(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new JM("return real * expR - imag * expI;",t.shape,e),i=new JM("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],s=this.compileAndRun(r,o),a=this.compileAndRun(i,o),u=this.complex(s,a).as2D(t.shape[0],t.shape[1]);return s.dispose(),a.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=yP(t,e),o=i[0],s=i[1],a=i[2],u=i[3],c=e.reshape([s,r]),l=t.reshape([t.size/a,a]),h=new rF(r,u,[s,a]);return this.compileAndRun(h,[l,c]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||hO(e))){var r=tO(n,WR(t));return r.fill(e),OO.make(t,{values:r},n)}var i=new ZM(t,e),o=i.getCustomSetupFunc(e),s=this.makeOutputArray(t,n);return this.compileAndRun(i,[],s,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return HP(t,e,n)},t.prototype.makeOutputArray=function(t,e){return OO.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=OO.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new dL(t.shape);return this.compileAndRun(e,[t],OO.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new FF(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([TN(t.shape)].concat(AN(t.shape))),r=[TN(e)].concat(AN(e)),i=new UF(r,n.shape);return this.compileAndRun(i,[n]).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,s=RN(i),a=oF(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=a.map((function(t){return 2*t})),e=r?new GM(s,a):new HM(s,a),this.compileAndRun(e,[{shape:s,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=ZR(n.dtype,0),n;var s=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&WR(e.shape)<=DR.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!DN(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var a,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,s,u),l=this.getAndSaveBinary(c,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),s=o.map((function(t){return t.shapeInfo})),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(t,e,n,r){var i=[];t.forEach((function(t){var e=WR(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,s,a=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+aM().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=aM();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],a=aM();if(null!=i&&qR(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+s+".0, "+o+".0);\n\n        return "+a.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+a.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var a=pM(e,n.slice(1));return"\n        "+t(a)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+mM(["b","row","col"],[1,2])+");\n        }\n      "}var u=s[0],c=s[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return "+aM().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],a=s[0],u=s[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",d="b * "+l+" + (row / 2) * "+c+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,d="b"+f+" * "+(l*=e[n-f-1])+" + "+d;return"\n    vec4 "+i+"("+h+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+a+");\n      return "+aM().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+hM(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+dM(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var s=hM(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+s+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+s+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+s+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&qR(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var s=JR(n),a=s.newShape,u=s.keptDims;if(a.length<n.length){var c=pM(e,a);return"\n      "+t(c)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+mM(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+dM(e)+"\n      }\n    ";var l=o[0],h=o[1],d=hM(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===l?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+l+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],a=JR(n),u=a.newShape,c=a.keptDims;if(u.length<n.length){var l=pM(e,u);return"\n        "+t(l)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+mM(["row","col","depth"],c)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+s+", 1)));\n        "+dM(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,d=h[0],f=h[1],p=e.shapeInfo.flatOffset;return f===o&&null==p?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+s+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+f+".0, "+d+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":f===s&&null==p?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+".0, "+d+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+s+" + depth + "+hM(r)+";\n        vec2 uv = uvFromFlat("+d+", "+f+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,u=JR(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=pM(e,c);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+mM(["row","col","depth","depth2"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+s+", "+o+", 1)));\n        "+dM(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];return m===a&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+s+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+m+", index + "+hM(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],s=n[3]*o,a=n[2]*s,u=n[1]*a,c=JR(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var d=pM(e,l);return"\n      "+t(d)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+mM(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+a+", "+s+", "+o+")) +\n          depth3;\n        "+dM(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],g=p[1];return g===u&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===o&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+a+" + depth * "+s+" +\n          depth2 * "+o+" + depth3 + "+hM(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=JR(n),s=o.newShape,a=o.keptDims;if(s.length<n.length){var u=pM(e,s);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+mM(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    "}var c=n[5],l=n[4]*c,h=n[3]*l,d=n[2]*h,f=n[1]*d;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+d+", "+h+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+dM(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,g=m[0],v=m[1];return v===f&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+d+", "+h+", "+l+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":v===c&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+d+" + depth * "+h+" +\n          depth2 * "+l+" + depth3 * "+c+" + depth4 + "+hM(r)+";\n      vec2 uv = uvFromFlat("+g+", "+v+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),s="get"+o+"AtOutCoords",a=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c=RP(t.shapeInfo.logicalShape,e.logicalShape),l=fM(u),h=u-a,d=["x","y","z","w","u","v"];n=0===a?"":u<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords."+d[t+h]+" = 0;"})).join("\n"),r=u<2&&a>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+d[e+h]})).join(", ");var f="return outputValue;",p=1===WR(t.shapeInfo.logicalShape),m=1===WR(e.logicalShape);if(1!==a||p||m){if(p&&!m)f=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var g=a-2,v=a-1;c.indexOf(g)>-1&&c.indexOf(v)>-1?f="return vec4(outputValue.x);":c.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+s+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+f+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===s&&null==t.shapeInfo.flatOffset&&qR(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var a=fM(s),u=RP(t.shapeInfo.logicalShape,e.logicalShape),c=s-o,l=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+a+" coords = getOutputCoords();\n      "+(0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+l[t+c]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+l[e+c]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=aM(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),d=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    #define isnan(value) isnan_custom(value)\n    "+t.defineSpecialNaN+"\n    bvec4 isnan_custom(vec4 val) {\n      return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n    }\n\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  "}(l);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(qR(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],s=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+s+";\n      index -= b * "+s+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,s="",a="b, r, c",u=2;u<t.length-1;u++)s="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+s,a="b"+u+", "+a;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+s+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+a+");\n    }\n  "}(t,e)}var n,r,i,o,s}(e.logicalShape,c),s=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return qR(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=uM(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=uM(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=uM(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=uM(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),s=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(d+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[d,h,s,a,o,u,n].join("\n")}(o,a,i,e.usesPackedTextures),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===DR.getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var d={},f=0;f<e.variableNames.length;f++){var p=e.variableNames[f];d[p]=t.getUniformLocation(c,p,!1),d["offset"+p]=t.getUniformLocation(c,"offset"+p,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:d,inShapeInfos:s,outShapeInfo:a,infLoc:l,nanLoc:h}}(o.gpgpu,t,s,u)})),h=null!=this.activeTimers;return h&&(a=this.startTimer()),function(t,e,n,r,i){kF(e.inShapeInfos,n),kF([e.outShapeInfo],[r]);var o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,s[0],s[1]):t.setOutputMatrixTexture(o,s[0],s[1]),t.setProgram(e.webGLProgram),1===DR.getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],s=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(WR(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var a=n.uniformValues;a instanceof Float32Array||(a=new Float32Array(a)),t.gl.uniform1fv(o,a)}else null!=n.texData.slice&&null!=s&&t.gl.uniform1i(s,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,l,s,u,r),h&&(a=this.endTimer(a),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(a)})),!DR.getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&null!=this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=HN((function(){var e=DR.getBool("DEBUG");DR.set("DEBUG",!1);var n=t.abs(pD(1e-8)).dataSync()[0];return DR.set("DEBUG",e),n>0?32:16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,s=n.usage,a=n.isPacked;if(null==n.texture){var u,c=null!=this.activeTimers;c&&(u=performance.now());var l=n.texShape;if(null==l&&(l=ON(r,a),n.texShape=l),null!=o){var h=RN(r),d=void 0,f=l[1],p=l[0],m=o instanceof Uint8Array;a?(f=(e=sF(l[0],l[1]))[0],d=new QM(h,[p=e[1],f],m)):d=new YM(h,[p,f],m);var g=this.makeTensorHandle([p,f],i);this.texData.get(g.dataId).usage=m?WM.PIXELS:WM.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),f,p,o);var v=this.makeTensorHandle(d.outputShape,g.dtype);v.size=WR(d.outputShape),this.texData.get(v.dataId).isPacked=a,this.compileAndRun(d,[g],v);var y=this.texData.get(v.dataId);n.texture=y.texture,n.texShape=y.texShape,n.isPacked=y.isPacked,n.usage=y.usage,this.disposeData(g.dataId),this.texData.delete(v.dataId),n.values=null,c&&(this.uploadWaitMs+=performance.now()-u)}else{var b=this.acquireTexture(l,s,i,a);n.texture=b}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*sO(e)},t}();XO()&&KO.registerBackend("webgl",(function(){return new pL}),2);var mL=uD({abs_:function(t){var e=YN(t,"x","abs");return"complex64"===e.dtype?KO.runKernel((function(t){return t.complexAbs(e)}),{$x:e}):KO.runKernel((function(t,n){var r=t.abs(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}}))}}),gL=uD({acos_:function(t){var e=YN(t,"x","acos");return KO.runKernel((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(pD(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),vL=uD({acosh_:function(t){var e=YN(t,"x","acosh");return KO.runKernel((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),yL=uD({asin_:function(t){var e=YN(t,"x","asin");return KO.runKernel((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(pD(1).sub(n.toFloat().square()).sqrt())}}}))}}),bL=uD({asinh_:function(t){var e=YN(t,"x","asinh");return KO.runKernel((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(pD(1).add(n.toFloat().square()).sqrt())}}}))}}),wL=uD({atan_:function(t){var e=YN(t,"x","atan");return KO.runKernel((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),_L=uD({atanh_:function(t){var e=YN(t,"x","atanh");return KO.runKernel((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(pD(1).sub(n.toFloat().square()))}}}))}}),xL=uD({ceil_:function(t){var e=YN(t,"x","ceil");return KO.runKernel((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),CL=uD({clipByValue_:function(t,e,n){var r=YN(t,"x","clipByValue");return jR(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),KO.runKernel((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{$x:r},(function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),ED(t))}}}))}}),EL=uD({cos_:function(t){var e=YN(t,"x","cos");return KO.runKernel((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),SL=uD({cosh_:function(t){var e=YN(t,"x","cosh");return KO.runKernel((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),IL=uD({erf_:function(t){var e=YN(t,"x","erf");return jR("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),KO.runKernel((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),kL=uD({exp_:function(t){var e=YN(t,"x","exp");return KO.runKernel((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),TL=uD({expm1_:function(t){var e=YN(t,"x","expm1");return KO.runKernel((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),AL=uD({floor_:function(t){var e=YN(t,"x","floor");return KO.runKernel((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),RL=uD({log_:function(t){var e=YN(t,"x","log");return KO.runKernel((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),OL=uD({log1p_:function(t){var e=YN(t,"x","log1p");return KO.runKernel((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),NL=uD({logSigmoid_:function(t){var e=YN(t,"x","logSigmoid");return KO.runKernel((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),DL=uD({neg_:function(t){var e=YN(t,"x","neg");return KO.runKernel((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),PL=uD({reciprocal_:function(t){var e=YN(t,"x","reciprocal");return KO.runKernel((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),ML=uD({round_:function(t){var e=YN(t,"x","round");return KO.runKernel((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),FL=uD({rsqrt_:function(t){var e=YN(t,"x","rsqrt");return KO.runKernel((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),LL=uD({sigmoid_:function(t){var e=YN(t,"x","sigmoid");return KO.runKernel((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(pD(1).sub(n)))}}}))}}),BL=uD({sign_:function(t){var e=YN(t,"x","sign");return KO.runKernel((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),jL=uD({isNaN_:function(t){var e=YN(t,"x","isNaN");return KO.runKernel((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),VL=uD({isInf_:function(t){var e=YN(t,"x","isInf");return KO.runKernel((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),UL=uD({isFinite_:function(t){var e=YN(t,"x","isFinite");return KO.runKernel((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return ED(t)}}}))}}),zL=uD({sin_:function(t){var e=YN(t,"x","sin");return KO.runKernel((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),WL=uD({sinh_:function(t){var e=YN(t,"x","sinh");return KO.runKernel((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),qL=uD({softplus_:function(t){var e=YN(t,"x","softplus");return KO.runKernel((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),HL=uD({sqrt_:function(t){var e=YN(t,"x","sqrt");return KO.runKernel((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),GL=uD({square_:function(t){var e=YN(t,"x","square");return KO.runKernel((function(t,n){return n([e]),t.square(e)}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}}))}}),$L=uD({step_:function(t,e){void 0===e&&(e=0);var n=YN(t,"x","step");return KO.runKernel((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return ED(t)}}}))}}),KL=uD({tan_:function(t){var e=YN(t,"x","tan");return KO.runKernel((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),XL=uD({tanh_:function(t){var e=YN(t,"x","tanh");return KO.runKernel((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return pD(1).sub(n.square()).mulStrict(t)}}}))}});function YL(t,e,n,r,i,o){var s,a,u=YN(t,"x","batchNorm"),c=YN(e,"mean","batchNorm"),l=YN(n,"variance","batchNorm");return null!=i&&(s=YN(i,"scale","batchNorm")),null!=r&&(a=YN(r,"offset","batchNorm")),jR(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),jR(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),jR(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=s&&jR(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),null!=a&&jR(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."})),ZL(u,c,l,a,s,o)}function QL(t,e,n,r,i,o){var s,a,u=YN(t,"x","batchNorm"),c=YN(e,"mean","batchNorm"),l=YN(n,"variance","batchNorm");return null!=i&&(s=YN(i,"scale","batchNorm")),null!=r&&(a=YN(r,"offset","batchNorm")),jR(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),jR(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),jR(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=s&&jR(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),null!=a&&jR(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."})),ZL(u,c,l,a,s,o)}function JL(t,e,n,r,i,o){var s,a,u=YN(t,"x","batchNorm"),c=YN(e,"mean","batchNorm"),l=YN(n,"variance","batchNorm");return null!=i&&(s=YN(i,"scale","batchNorm")),null!=r&&(a=YN(r,"offset","batchNorm")),jR(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),jR(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),jR(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=s&&jR(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),null!=a&&jR(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."})),ZL(u,c,l,a,s,o)}function ZL(t,e,n,r,i,o){null==o&&(o=.001);var s,a,u,c=YN(t,"x","batchNorm"),l=YN(e,"mean","batchNorm"),h=YN(n,"variance","batchNorm");return null!=i&&(s=YN(i,"scale","batchNorm")),null!=r&&(a=YN(r,"offset","batchNorm")),jR(l.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),jR(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),jR(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,KO.runKernel((function(t,e){var n=t.batchNormalization(u,tB(l),tB(h),o,tB(s),tB(a));return e([c,l,h,s]),n}),{$x:c,$mean:l,$variance:h,$scale:s,$offset:a},(function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=null==s?pD(1):s,c=OP(r.shape,u.shape),l=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)l.push(u.shape[h]);l.push(1)}var d=n.sub(r),f=t.mul(a),p=FL(i.add(pD(o))),m=p.mul(p).mul(p).mul(pD(-.5));return{$x:function(){return 1===r.rank?t.mul(lP(p.as4D(1,1,1,r.shape[0]),l)).mul(a).reshape(n.shape):t.mul(p).mul(a).reshape(n.shape)},$mean:function(){var t=p.mul(pD(-1)).mul(f);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$variance:function(){var t=m.mul(d).mul(f);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$scale:function(){var e=d.mul(p),n=t.mul(e);return 1===r.rank&&(n=n.sum(c)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(c)),e.reshape(r.shape)}}})).reshape(c.shape)}function tB(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function eB(){qN("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var nB=uD({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),eB(),YL(t,e,n,o,i,r)}}),rB=uD({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),eB(),QL(t,e,n,o,i,r)}}),iB=uD({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),eB(),JL(t,e,n,o,i,r)}}),oB=uD({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),eB(),ZL(t,e,n,o,i,r)}}),sB=uD({batchNorm_:ZL}),aB=uD({batchNorm2d_:YL}),uB=uD({batchNorm3d_:QL}),cB=uD({batchNorm4d_:JL});function lB(t,e,n,r,i,o){jR(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,a=e,u=!1;3===e.rank&&(u=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]);var c=s[3],l=a.shape[3];jR(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),jR(4===a.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+a.rank})),jR(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank})),jR(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."})),jR(l===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&jR(HR(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=PP(s,n.shape,r,1,i,o),d=KO.runKernel((function(t,e){var r=t.conv2dDerInput(a,n,h);return e([n,a]),r}),{dy4D:a,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return pB(t,n,r,i,"NHWC",1,o)},filter:function(){return gB(t,s,n.shape,r,i,o)}}}));return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function hB(t,e,n,r,i,o){var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=e;3===a.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),jR(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),jR(4===a.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+a.shape+"."})),jR(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."})),jR(s.shape[3]===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+s.shape[3]+") must match input depth in filter ("+n[2]+"."})),jR(a.shape[3]===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+a.shape[3]+") must match output depth for filter ("+n[3]+")."})),null!=o&&jR(HR(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var u=PP(s.shape,n,r,1,i,o);return KO.runKernel((function(t){return t.conv2dDerFilter(s,a,u)}),{x4D:s,dy4D:a})}function dB(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}var fB=uD({conv1d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NWC"),void 0===o&&(o=1);var a=YN(t,"x","conv1d"),u=YN(e,"filter","conv1d"),c=a,l=!1;2===a.rank&&(l=!0,c=a.as3D(1,a.shape[0],a.shape[1])),jR(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),jR(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=s&&jR(HR(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),jR(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),jR(zP(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),jR("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=pB(d,h,[1,n],r,"NHWC",[1,o],s);return l?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),pB=uD({conv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=YN(t,"x","conv2d"),u=YN(e,"filter","conv2d"),c=a,l=!1;3===a.rank&&(l=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),jR(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),jR(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=s&&jR(HR(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),jR(c.shape[3]===u.shape[2],(function(){return"Error in conv2d: depth of input ("+c.shape[3]+") must match input depth for filter "+u.shape[2]+"."})),jR(zP(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),jR("NHWC"===i,(function(){return"Error in conv2d: got dataFormat of "+i+" but only NHWC is currently supported."}));var h=PP(c.shape,u.shape,n,o,r,s),d=KO.runKernel((function(t,e){var n=t.conv2d(c,u,h);return e([u,c]),n}),{x:c,$filter:u},(function(t,e){var i=e[0],s=e[1];return jR(UP(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return lB(s.shape,t,i,n,r)},$filter:function(){return hB(s,t,i.shape,n,r)}}}));return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),mB=uD({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var s=YN(t,"x","conv3d"),a=YN(e,"filter","conv3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),jR(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),jR(5===a.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."})),jR(u.shape[4]===a.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."})),jR(function(t,e){return dB(t)||dB(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),jR("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=MP(u.shape,a.shape,n,o,r),h=KO.runKernel((function(t,e){var n=t.conv3d(u,a,l);return e([u,a]),n}),{x:u,$filter:a},(function(t,e){jR(dB(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],s=e[1];return{x:function(){return function(t,e,n,r,i){jR(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,s=e,a=!1;4===e.rank&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],c=s.shape[4];jR(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),jR(5===s.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),jR(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),jR(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),jR(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=MP(o,n.shape,r,1,i),h=KO.runKernel((function(t){return t.conv3dDerInput(s,n,l)}),{dy5D:s});return a?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}(i.shape,t,s,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var s=e;4===s.rank&&(s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),jR(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),jR(5===s.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+s.shape+"."})),jR(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),jR(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),jR(s.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+s.shape[4]+") must match output depth for filter ("+n[4]+")."}));var a=MP(o.shape,n,r,1,i);return KO.runKernel((function(t){return t.conv3dDerFilter(o,s,a)}),{x5D:o,dy5D:s})}(i,t,s.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),gB=uD({conv2dDerFilter_:hB}),vB=uD({depthwiseConv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=YN(t,"x","depthwiseConv2d"),u=YN(e,"filter","depthwiseConv2d"),c=a,l=!1;3===a.rank&&(l=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),jR(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),jR(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),jR(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),jR(zP(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=s&&jR(HR(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var h=PP(c.shape,u.shape,n,o,r,s,!0),d=KO.runKernel((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,$filter:u},(function(t,e){jR(UP(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=KO.runKernel((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}(0,t,r,h)},$filter:function(){return function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),KO.runKernel((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}(n,t,0,h)}}}));return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),yB=uD({separableConv2d_:function(t,e,n,r,i,o,s){void 0===o&&(o=[1,1]),void 0===s&&(s="NHWC");var a=YN(t,"x","separableConv2d"),u=YN(e,"depthwiseFilter","separableConv2d"),c=YN(n,"pointwiseFilter","separableConv2d"),l=a,h=!1;if(3===a.rank&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");jR(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),jR(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),jR(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),jR(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),jR(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var d=u.shape[2],f=u.shape[3];jR(c.shape[2]===d*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+c.shape[2]+"."}));var p=vB(l,u,r,i,s,o),m=pB(p,c,1,"valid",s);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),bB=uD({conv2dTranspose_:function(t,e,n,r,i,o){return lB(n,YN(t,"x","conv2dTranspose"),YN(e,"filter","conv2dTranspose"),r,i,o)}}),wB=uD({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=YN(t,"a","matMul"),s=YN(e,"b","matMul");i=zO(o,s),o=i[0],s=i[1];var a=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?s.shape[s.rank-2]:s.shape[s.rank-1],h=o.shape.slice(0,-2),d=s.shape.slice(0,-2),f=WR(h),p=WR(d);jR(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),jR(qR(h,d),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),jR(a===u,(function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=o.shape.slice(0,-2).concat([c,l]),g=n?o.as3D(f,a,c):o.as3D(f,c,a),v=r?s.as3D(p,l,u):s.as3D(p,u,l);return KO.runKernel((function(t,e){var i=t.batchMatMul(g,v,n,r);return e([g,v]),i}),{$a:g,$b:v},(function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}})).reshape(m)}}),_B=uD({dot_:function(t,e){var n=YN(t,"t1","dot"),r=YN(e,"t2","dot");jR(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return jR(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),xB=uD({outerProduct_:function(t,e){var n=YN(t,"v1","outerProduct"),r=YN(e,"v2","outerProduct");return jR(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),CB=uD({reverse_:function(t,e){var n=YN(t,"x","reverse");if(0===n.rank)return n.clone();var r=QR(e,n.shape);return KO.runKernel((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),EB=uD({reverse1d_:function(t){var e=YN(t,"x","reverse");return jR(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),CB(e,0)}}),SB=uD({reverse2d_:function(t,e){var n=YN(t,"x","reverse");return jR(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),CB(n,e)}}),IB=uD({reverse3d_:function(t,e){var n=YN(t,"x","reverse");return jR(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),CB(n,e)}}),kB=uD({reverse4d_:function(t,e){var n=YN(t,"x","reverse");return jR(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),CB(n,e)}});function TB(t,e,n,r,i,o){var s=YN(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),null==r&&(r=[1,1]),jR(4===a.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."})),jR(zP(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&jR(HR(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=DP(a.shape,e,n,r,i,o),l=KO.runKernel((function(t,e){var n=t.maxPool(a,c);return e([a,n]),n}),{x:a},(function(t,o){var s=o[0],a=o[1];return{x:function(){return function(t,e,n,r,i,o,s,a){var u=YN(t,"dy","maxPoolBackprop"),c=YN(e,"input","maxPoolBackprop"),l=YN(n,"output","maxPoolBackprop");jR(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),jR(zP(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),jR(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),jR(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var h=DP(c.shape,r,i,o,s,void 0);return KO.runKernel((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,s,a,e,n,r,i)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function AB(t,e,n,r,i,o){var s=YN(t,"x","avgPool","float32");null==r&&(r=[1,1]),jR(zP(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jR(4===a.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."})),null!=o&&jR(HR(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=DP(a.shape,e,n,r,i,o),l=KO.runKernel((function(t){return t.avgPool(a,c)}),{x:a},(function(t){return{x:function(){return function(t,e,n,r,i,o){var s=YN(t,"dy","avgPoolBackprop"),a=YN(e,"input","avgPoolBackprop");jR(a.rank===s.rank,(function(){return"Rank of input ("+a.rank+") does not match rank of dy ("+s.rank+")"})),null==i&&(i=[1,1]),jR(zP(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=a,c=s,l=!1;3===a.rank&&(l=!0,u=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]),c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jR(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),jR(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=DP(u.shape,n,r,i,o),d=KO.runKernel((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(t,a,e,n,r,i)}}}));return l=l.cast(s.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var RB=uD({maxPool_:function(t,e,n,r,i){return TB(t,e,n,1,r,i)}}),OB=uD({avgPool_:function(t,e,n,r,i){return AB(t,e,n,1,r,i)}}),NB=uD({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var s=YN(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jR(zP(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var c,l=DP(a.shape,e,o,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],f=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),s=e.map((function(t,e){return(t-o[e]%t)%t})),a=i.map((function(t,e){return t+s[e]}));return[e.map((function(t,e){return[r[e],a[e]]})),e.map((function(t,e){return[0,s[e]]}))]}([l.inHeight,l.inWidth],h,c),p=f[1],m=d?r:"valid",g=d?a:aP(a,h,f[0]),v=("avg"===n?function(){return AB(g,e,o,1,m)}:function(){return TB(g,e,o,1,m)})(),y=d?v:WD(v,h,p);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),DB=uD({slice_:function(t,e,n){var r,i,o=YN(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice(),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(jR(-1===t,(function(){return"Bad value in size"})),o.shape[e]-r[e])})),function(t,e,n){jR(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),jR(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){jR(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}(o,r,i);var s=o.shape;return KO.runKernel((function(t){return t.slice(o,r,i)}),{$x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],s[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}}))}}),PB=uD({slice1d_:function(t,e,n){var r=YN(t,"x","slice1d");return jR(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),DB(r,[e],[n])}}),MB=uD({slice2d_:function(t,e,n){var r=YN(t,"x","slice2d");return jR(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),DB(r,e,n)}}),FB=uD({slice3d_:function(t,e,n){var r=YN(t,"x","slice3d");return jR(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),DB(r,e,n)}}),LB=uD({slice4d_:function(t,e,n){var r=YN(t,"x","slice4d");return jR(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),DB(r,e,n)}});function BB(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(eD(e.shape,r))),t.rank<n.rank&&(t=t.reshape(eD(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var jB=uD({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","all","bool"),i=QR(e,r.shape),o=i,s=rD(o,r.rank);null!=s&&(r=r.transpose(s),o=oD(o.length,r.rank));var a=KO.runKernel((function(t){return t.all(r,o)}),{$x:r});if(n){var u=eD(a.shape,i);return a.reshape(u)}return a}}),VB=uD({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","any","bool"),i=QR(e,r.shape),o=i,s=rD(o,r.rank);null!=s&&(r=r.transpose(s),o=oD(o.length,r.rank));var a=KO.runKernel((function(t){return t.any(r,o)}),{$x:r});if(n){var u=eD(a.shape,i);return a.reshape(u)}return a}}),UB=uD({argMax_:function(t,e){void 0===e&&(e=0);var n=YN(t,"x","argMax");null==e&&(e=0);var r=QR(e,n.shape),i=rD(r,n.rank);return null!=i&&(n=n.transpose(i),r=oD(r.length,n.rank)),KO.runKernel((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return ED(n)}}}))}}),zB=uD({argMin_:function(t,e){void 0===e&&(e=0);var n=YN(t,"x","argMin");null==e&&(e=0);var r=QR(e,n.shape),i=rD(r,n.rank);return null!=i&&(n=n.transpose(i),r=oD(r.length,n.rank)),KO.runKernel((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return ED(n)}}}))}}),WB=uD({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","logSumExp"),i=QR(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(n){var u=eD(a.shape,i);return a.reshape(u)}return a}}),qB=uD({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","max"),i=r,o=QR(e,r.shape),s=o,a=rD(s,r.rank);null!=a&&(r=r.transpose(a),s=oD(s.length,r.rank));var u=KO.runKernel((function(t,e){var n=t.max(r,s);return e([i,n]),n}),{$x:r},(function(t,e){return BB(t,e[1],e[0],o,a)}));if(n){var c=eD(u.shape,o);u=u.reshape(c)}return u}}),HB=uD({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","mean"),i=QR(e,r.shape),o=WR(tD(r.shape,i)[1]);return IP((function(t){var r=pD(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(bD(t.shape,"float32")).div(o)}}}))(r)}}),GB=uD({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","min"),i=r,o=QR(e,r.shape),s=o,a=rD(s,r.rank);null!=a&&(r=r.transpose(a),s=oD(s.length,r.rank));var u=KO.runKernel((function(t,e){var n=t.min(r,s);return e([i,n]),n}),{$x:r},(function(t,e){return BB(t,e[1],e[0],o,a)}));if(n){var c=eD(u.shape,o);u=u.reshape(c)}return u}}),$B=uD({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=QR(e,(t=YN(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=eD(i.shape,r));var s=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,n)}}}),KB=uD({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=QR(e,r.shape);return IP((function(t){var e=rD(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=oD(r.length,t.rank));var s=KO.runKernel((function(t){return t.sum(o,r)}),{permutedX:o});if(n){var a=eD(s.shape,i);s=s.reshape(a)}return{value:s,gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(bD(t.shape,"float32"))}}}))(r)}}),XB=uD({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=YN(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=QR(e,r.shape),o=rD(i,r.rank),s=i,a=r;null!=o&&(a=r.transpose(o),s=oD(s.length,r.rank));var u=KO.runKernel((function(t){return t.prod(a,s)}),{permutedX:a});if(n){var c=eD(u.shape,i);u=u.reshape(c)}return u}}),YB=uD({equal_:function(t,e){var n,r=YN(t,"a","equal"),i=YN(e,"b","equal");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),QB=uD({equalStrict_:function(t,e){var n=YN(t,"a","equalStrict"),r=YN(e,"b","equalStrict");return VR(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),JB=uD({greater_:function(t,e){var n,r=YN(t,"a","greater"),i=YN(e,"b","greater");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t){return t.greater(r,i)}),{$a:r,$b:i})}}),ZB=uD({greaterEqual_:function(t,e){var n,r=YN(t,"a","greaterEqual"),i=YN(e,"b","greaterEqual");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return ED(n)},$b:function(){return ED(r)}}}))}}),tj=uD({greaterEqualStrict_:function(t,e){var n=YN(t,"a","greaterEqualStrict"),r=YN(e,"b","greaterEqualStrict");return VR(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),ej=uD({greaterStrict_:function(t,e){var n=YN(t,"a","greaterStrict"),r=YN(e,"b","greaterStrict");return VR(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),nj=uD({less_:function(t,e){var n,r=YN(t,"a","less"),i=YN(e,"b","less");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t){return t.less(r,i)}),{$a:r,$b:i})}}),rj=uD({lessEqual_:function(t,e){var n,r=YN(t,"a","lessEqual"),i=YN(e,"b","lessEqual");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t){return t.lessEqual(r,i)}),{$a:r,$b:i})}}),ij=uD({lessEqualStrict_:function(t,e){var n=YN(t,"a","lessEqualStrict"),r=YN(e,"b","lessEqualStrict");return VR(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),oj=uD({lessStrict_:function(t,e){var n=YN(t,"a","lessStrict"),r=YN(e,"b","lessStrict");return VR(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),sj=uD({notEqual_:function(t,e){var n,r=YN(t,"a","notEqual"),i=YN(e,"b","notEqual");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t){return t.notEqual(r,i)}),{$a:r,$b:i})}}),aj=uD({notEqualStrict_:function(t,e){var n=YN(t,"a","notEqualStrict"),r=YN(e,"b","notEqualStrict");return VR(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),uj=uD({add_:function(t,e){var n,r=YN(t,"a","add"),i=YN(e,"b","add");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t){return t.add(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=OP(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=OP(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}))}}),cj=uD({addN_:function(t){jR(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),jR(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return YN(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!qR(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),KO.runKernel((function(t){return t.addN(e)}),e,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),lj=uD({addStrict_:function(t,e){var n=YN(t,"a","addStrict"),r=YN(e,"b","addStrict");return VR(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),hj=uD({atan2_:function(t,e){var n,r=YN(t,"a","atan2"),i=YN(e,"b","atan2");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=uj(n.square(),r.square()),i=t.mul(r.div(e)),s=OP(n.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(n.shape)},$b:function(){var e=uj(n.square(),r.square()),i=DL(t.mul(n.div(e))),s=OP(r.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(r.shape)}}}))}}),dj=uD({div_:function(t,e){var n,r=YN(t,"a","div"),i=YN(e,"b","div");if(n=zO(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return pj(r,i);var o=NP(r.shape,i.shape);return KO.runKernel((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=OP(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=OP(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}}))}}),fj=uD({divStrict_:function(t,e){var n=YN(t,"a","div"),r=YN(e,"b","div");return VR(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),pj=uD({floorDiv_:function(t,e){var n,r=YN(t,"a","floorDiv"),i=YN(e,"b","floorDiv");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=OP(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=OP(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}}))}}),mj=uD({maximum_:function(t,e){var n,r=YN(t,"a","maximum"),i=YN(e,"b","maximum");return n=zO(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),NP(r.shape,i.shape),KO.runKernel((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),gj=uD({maximumStrict_:function(t,e){var n=YN(t,"a","maximumStrict"),r=YN(e,"b","maximumStrict");return VR(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),vj=uD({minimum_:function(t,e){var n,r=YN(t,"a","minimum"),i=YN(e,"b","minimum");return n=zO(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),NP(r.shape,i.shape),KO.runKernel((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),yj=uD({minimumStrict_:function(t,e){var n=YN(t,"a","minimumStrict"),r=YN(e,"b","minimumStrict");return VR(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),bj=uD({mod_:function(t,e){var n,r=YN(t,"a","mod"),i=YN(e,"b","mod");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=OP(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=OP(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),wj=uD({modStrict_:function(t,e){var n=YN(t,"a","modStrict"),r=YN(e,"b","modStrict");return VR(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),_j=uD({mul_:function(t,e){var n,r=YN(t,"a","mul"),i=YN(e,"b","mul");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=OP(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=OP(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),xj=uD({mulStrict_:function(t,e){var n=YN(t,"a","mul"),r=YN(e,"b","mul");return VR(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Cj=uD({pow_:function(t,e){var n=YN(t,"base","pow"),r=YN(e,"exp","pow"),i=NP(n.shape,r.shape);return t=n.cast(VO(n.dtype,r.dtype)),e=r.cast(VO(n.dtype,r.dtype)),KO.runKernel((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(pD(1))))),s=OP(n.shape,i);return s.length>0&&(o=o.sum(s)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),s=n.log().where(e,ED(n)),a=t.mul(o.mul(s)),u=OP(r.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)}}}))}}),Ej=uD({powStrict_:function(t,e){return VR(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Sj=uD({squaredDifference_:function(t,e){var n,r=YN(t,"a","squaredDifference"),i=YN(e,"b","squaredDifference");return n=zO(r,i),NP((r=n[0]).shape,(i=n[1]).shape),KO.runKernel((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1],i=pD(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}}))}}),Ij=uD({squaredDifferenceStrict_:function(t,e){var n=YN(t,"a","squaredDifferenceStrict"),r=YN(e,"b","squaredDifferenceStrict");return VR(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),kj=uD({sub_:function(t,e){var n,r=YN(t,"a","sub"),i=YN(e,"b","sub");n=zO(r,i);var o=NP((r=n[0]).shape,(i=n[1]).shape);return KO.runKernel((function(t){return t.subtract(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=OP(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=OP(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}))}}),Tj=uD({subStrict_:function(t,e){var n=YN(t,"a","subStrict"),r=YN(e,"b","subStrict");return VR(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Aj=uD({logicalAnd_:function(t,e){var n=YN(t,"a","logicalAnd","bool"),r=YN(e,"b","logicalAnd","bool");return NP(n.shape,r.shape),KO.runKernel((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),Rj=uD({logicalNot_:function(t){var e=YN(t,"x","logicalNot","bool");return KO.runKernel((function(t){return t.logicalNot(e)}),{$x:e})}}),Oj=uD({logicalOr_:function(t,e){var n=YN(t,"a","logicalOr","bool"),r=YN(e,"b","logicalOr","bool");return NP(n.shape,r.shape),KO.runKernel((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),Nj=uD({logicalXor_:function(t,e){var n=YN(t,"a","logicalXor","bool"),r=YN(e,"b","logicalXor","bool");return NP(n.shape,r.shape),Oj(t,e).logicalAnd(Aj(t,e).logicalNot())}}),Dj=uD({where_:function(t,e,n){var r=YN(e,"a","where"),i=YN(n,"b","where"),o=YN(t,"condition","where","bool");return VR(r.shape,i.shape,"Error in where: "),1===o.rank?jR(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):VR(o.shape,i.shape,"Error in where: "),KO.runKernel((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return ED(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),Pj=uD({elu_:function(t){var e=YN(t,"x","elu");return KO.runKernel((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return KO.runKernel((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),Mj=uD({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=YN(t,"x","leakyRelu");return mj(pD(e).mul(n),n)}}),Fj=uD({prelu_:function(t,e){var n=YN(t,"x","prelu"),r=YN(e,"alpha","prelu");return KO.runKernel((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{$x:n,$alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return Dj(i,t,t.mul(r))},$alpha:function(){var e=Dj(i,ED(t),t.mul(n)),o=OP(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}))}}),Lj=uD({relu_:function(t){var e=YN(t,"x","relu");return"bool"===e.dtype?e.toInt():KO.runKernel((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),Bj=uD({selu_:function(t){var e=YN(t,"x","selu");return KO.runKernel((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(pD(0)),r=pD(1.7580993408473768),i=pD(1.0507009873554805),o=t.mul(i),s=t.mul(r).mul(n.toFloat().exp());return Dj(e,o,s)}}}))}}),jj=uD({transpose_:function(t,e){var n=YN(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),jR(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){jR(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():KO.runKernel((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=iD(e);return{$x:function(){return t.transpose(n)}}}))}}),Vj=uD({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=YN(t,"x","localResponseNormalization");jR(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),jR(HR(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var s=o,a=!1;3===o.rank&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=KO.runKernel((function(t,o){var a=t.localResponseNormalization4D(s,e,n,r,i);return o([s,a]),a}),{x4D:s},(function(t,o){var s=o[0],a=o[1];return{x4D:function(){return KO.runKernel((function(o){return o.LRNGrad(t,s,a,e,n,r,i)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Uj=uD({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(pD(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=YN(t,"x","norm"),e,n),o=i.shape;if(r){var s=QR(n,t.shape);o=eD(i.shape,s)}return i.reshape(o)}});function zj(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Wj(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var qj=uD({gather_:function(t,e,n){void 0===n&&(n=0);var r=YN(t,"x","gather"),i=YN(e,"indices","gather","int32");n=QR(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,s=1,a=0;a<n;a++)i.push(t.shape[a]),o*=t.shape[a];for(a=0;a<e.rank;a++)i.push(e.shape[a]);for(a=n+1;a<t.rank;a++)i.push(t.shape[a]),s*=t.shape[a];return{batchSize:o,sliceSize:s,dimSize:r,outputShape:i}}(r,i,n);return KO.runKernel((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{$x:r},(function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,s=e.slice(0,n),a=s.length,u=e.slice(n,e.length).slice(1),c=u.length,l=zj(0,a),h=zj(a+1,a+1+c),d=Wj([s,[o],u]),f=t.reshape(d),p=i.reshape([o]),m=Wj([[a],l,h]),g=f.transpose(m),v=Hj(g,p,r.shape[n]),y=iD(m);return v.transpose(y)}}})).reshape(o.outputShape)}}),Hj=uD({unsortedSegmentSum_:function(t,e,n){var r=YN(t,"x","unsortedSegmentSum"),i=YN(e,"segmentIds","unsortedSegmentSum","int32");return jR(HR(n),(function(){return"numSegments must be of dtype int"})),KO.runKernel((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=mj(e,ED(e)),r=qj(t,n),i=ZB(e,pD(0,"int32")),o=r.rank-i.rank,s=0;s<o;++s)i=KD(i,s+1);i=Aj(i,bD(r.shape,"bool"));var a=ED(r);return Dj(i,r,a)}(t,n)}}}))}}),Gj=uD({basicLSTMCell_:function(t,e,n,r,i,o){var s=YN(t,"forgetBias","basicLSTMCell"),a=YN(e,"lstmKernel","basicLSTMCell"),u=YN(n,"lstmBias","basicLSTMCell"),c=YN(r,"data","basicLSTMCell"),l=YN(i,"c","basicLSTMCell"),h=YN(o,"h","basicLSTMCell"),d=c.concat(h,1).matMul(a).add(u),f=d.shape[1]/4,p=[d.shape[0],f],m=d.slice([0,0],p),g=d.slice([0,f],p),v=d.slice([0,2*f],p),y=d.slice([0,3*f],p),b=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(s.add(v).sigmoid())),w=b.tanh().mulStrict(y.sigmoid());return[b,w]}}),$j=uD({multiRNNCell_:function(t,e,n,r){for(var i=YN(e,"data","multiRNNCell"),o=QN(n,"c","multiRNNCell"),s=QN(r,"h","multiRNNCell"),a=i,u=[],c=0;c<t.length;c++){var l=t[c](a,o[c],s[c]);u.push(l[0]),u.push(l[1]),a=l[1]}var h=[],d=[];for(c=0;c<u.length;c+=2)h.push(u[c]),d.push(u[c+1]);return[h,d]}}),Kj=uD({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=YN(t,"v","movingAverage"),s=YN(e,"x","movingAverage"),a=YN(n,"decay","movingAverage");WO(o,s),jR(qR(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var u=pD(1),c=u.sub(a),l=s.sub(o).mul(c);if(i){jR(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=YN(r,"step","movingAverage");l=l.div(u.sub(Cj(a,h)))}return o.add(l)}}),Xj=uD({stridedSlice_:function(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),0!==s)throw new Error("ellipsis mask is not yet supported");if(0!==a)throw new Error("new axis mask is not yet supported");var c=YN(t,"x","stridedSlice");if(r.every((function(t){return 1===t}))){var l=_P(c.shape,e,n,r,i,o,s,a,u),h=l[0],d=l[1],f=l[2],p=d.filter((function(t,e){return-1===f.indexOf(e)}));return DB(c,h,d).reshape(p)}return KO.runKernel((function(t){return t.stridedSlice(c,e,n,r,i,o,s,a,u)}),{$x:c})}}),Yj=uD({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=YN(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=KO.runKernel((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),Qj=uD({scatterND_:function(t,e,n){var r=YN(t,"indices","scatterND","int32"),i=YN(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var s=0;s<i;++s)if(n.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+n.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+n.shape[s+i]+") != shape["+(s+i)+"] ("+t[s+i]+")")}(n,e,t)}(i,r,n),KO.runKernel((function(t){return t.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),Jj=uD({fft_:function(t){jR("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return KO.runKernel((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),Zj=uD({ifft_:function(t){jR("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return KO.runKernel((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),tV=uD({rfft_:function(t,e){jR("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e,n=t.slice(o,s),r=e}else if(null!=e&&e>r){var a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e-r,n=t.concat(wD(a),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=cD(n,u).as2D(i,r),l=Jj(c),h=Math.floor(r/2)+1,d=lD(l),f=hD(l),p=d.split([h,r-h],d.shape.length-1),m=f.split([h,r-h],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,cD(p[0],m[0]).reshape(g)}}),eV=uD({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=Zj(r);return lD(i)}var o=[n,2*(e-1)],s=lD(t).as2D(n,e),a=hD(t).as2D(n,e),u=s.slice([0,1],[n,e-2]).reverse(1),c=a.slice([0,1],[n,e-2]).reverse(1).mul(pD(-1)),l=s.concat(u,1),h=a.concat(c,1);return r=cD(l,h).as2D(o[0],o[1]),i=Zj(r),lD(i)}}),nV=Object.freeze({fft:Jj,ifft:Zj,rfft:tV,irfft:eV}),rV=uD({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=YN(t,"sparseIndices","sparseToDense","int32"),o=YN(e,"sparseValues","sparseToDense"),s=YN(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,s),KO.runKernel((function(t){return t.sparseToDense(i,o,n,s)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),iV=uD({gatherND_:function(t,e){var n=YN(e,"indices","gatherND","int32"),r=YN(t,"x","gatherND");return KO.runKernel((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),oV=uD({dropout_:function(t,e,n,r){if(null!=n&&!qR(t.shape,n))throw new Error("Non-default noise shape is not implemented yet: "+JSON.stringify(n));var i=oP(t.shape,0,1,"float32",r).greater(e);return i=i.div(kj(1,e)),t.mul(i)}});function sV(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var s=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(s)}return mD(i,"float32")}var aV,uV=uD({hannWindow_:function(t){return sV(t,.5,.5)}}),cV=uD({hammingWindow_:function(t){return sV(t,.54,.46)}}),lV=uD({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,s=[];o+e<=t.size;)s.push(DB(t,o,e)),o+=n;if(r){var a=o+e-t.size,u=SD([DB(t,o,e-a),_D([a],i)]);s.push(u)}return 0===s.length?gD([],[0,e]):SD(s).as2D(s.length,e)}}),hV=Object.freeze({hannWindow:uV,hammingWindow:cV,frame:lV});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(aV||(aV={}));var dV=uD({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=aV.SUM_BY_NONZERO_WEIGHTS);var i=YN(t,"labels","absoluteDifference"),o=YN(e,"predictions","absoluteDifference"),s=null;null!=n&&(s=YN(n,"weights","absoluteDifference")),VR(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return fV(a,s,r)}}),fV=uD({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=aV.SUM_BY_NONZERO_WEIGHTS);var r=YN(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=YN(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===aV.NONE)return o;if(n===aV.SUM)return o.sum();if(n===aV.MEAN){if(null==i)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(pD(s)):a}if(n===aV.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(pD(r.size));var u=i.mul(bD(r.shape)).notEqual(pD(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),pV=uD({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=aV.SUM_BY_NONZERO_WEIGHTS);var o=YN(t,"labels","cosineDistance"),s=YN(e,"predictions","cosineDistance"),a=null;null!=r&&(a=YN(r,"weights","cosineDistance")),VR(o.shape,s.shape,"Error in cosineDistance: ");var u=pD(1).sub(o.mul(s).sum(n,!0));return fV(u,a,i)}}),mV=uD({hingeLoss_:function(t,e,n,r){void 0===r&&(r=aV.SUM_BY_NONZERO_WEIGHTS);var i=YN(t,"labels","hingeLoss"),o=YN(e,"predictions","hingeLoss"),s=null;null!=n&&(s=YN(n,"weights","hingeLoss")),VR(i.shape,o.shape,"Error in hingeLoss: ");var a=pD(1);i=pD(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return fV(u,s,r)}}),gV=uD({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=aV.SUM_BY_NONZERO_WEIGHTS);var o=YN(t,"labels","huberLoss"),s=YN(e,"predictions","huberLoss"),a=null;null!=n&&(a=YN(n,"weights","huberLoss")),VR(o.shape,s.shape,"Error in huberLoss: ");var u=pD(r),c=s.sub(o).abs(),l=vj(c,u),h=c.sub(l),d=pD(.5).mul(l.square()).add(u.mul(h));return fV(d,a,i)}}),vV=uD({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=aV.SUM_BY_NONZERO_WEIGHTS);var o=YN(t,"labels","logLoss"),s=YN(e,"predictions","logLoss"),a=null;null!=n&&(a=YN(n,"weights","logLoss")),VR(o.shape,s.shape,"Error in logLoss: ");var u=pD(1),c=pD(r),l=o.mul(s.add(c).log()).neg().sub(u.sub(o).mul(u.sub(s).add(c).log()));return fV(l,a,i)}}),yV=uD({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=aV.SUM_BY_NONZERO_WEIGHTS);var i=YN(t,"labels","meanSquaredError"),o=YN(e,"predictions","meanSquaredError"),s=null;null!=n&&(s=YN(n,"weights","meanSquaredError")),VR(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return fV(a,s,r)}}),bV=uD({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=aV.SUM_BY_NONZERO_WEIGHTS);var o=YN(t,"multiClassLabels","sigmoidCrossEntropy"),s=YN(e,"logits","sigmoidCrossEntropy"),a=null;if(null!=n&&(a=YN(n,"weights","sigmoidCrossEntropy")),VR(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=pD(r),c=pD(1),l=pD(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=YN(t,"labels","sigmoidCrossEntropyWithLogits"),r=YN(e,"logits","sigmoidCrossEntropyWithLogits");VR(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),s=r.abs().neg().exp().log1p();return i.sub(o).add(s)}(o,s);return fV(h,a,i)}}),wV=uD({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=aV.SUM_BY_NONZERO_WEIGHTS);var o=YN(t,"onehotLabels","softmaxCrossEntropy"),s=YN(e,"logits","softmaxCrossEntropy"),a=null;if(null!=n&&(a=YN(n,"weights","softmaxCrossEntropy")),VR(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=pD(r),c=pD(1),l=pD(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return IP((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=eD(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,s);return fV(h,a,i)}}),_V=Object.freeze({get Reduction(){return aV},absoluteDifference:dV,computeWeightedLoss:fV,cosineDistance:pV,hingeLoss:mV,huberLoss:gV,logLoss:vV,meanSquaredError:yV,sigmoidCrossEntropy:bV,softmaxCrossEntropy:wV});function xV(t,e){return void 0===e&&(e=!1),KO.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=XD(n),o=t.clone(),s=gD([[1]],[1,1]),a=s.clone(),u=n>=r?r:n,c=function(t){var e,u=o,c=a,l=i;e=KO.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),c=o.slice([t,t],[1,1]),l=c.sign().neg(),h=c.sub(l.mul(u)),d=e.div(h);a=1===d.shape[0]?s.clone():s.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var f=l.matMul(h).div(u).neg(),p=o.slice([t,0],[n-t,r]),m=f.mul(a);o=0===t?p.sub(m.matMul(a.transpose().matMul(p))):o.slice([0,0],[t,r]).concat(p.sub(m.matMul(a.transpose().matMul(p))),0);var g=i.slice([0,t],[n,i.shape[1]-t]);return i=0===t?g.sub(g.matMul(a).matMul(m.transpose())):i.slice([0,0],[n,t]).concat(g.sub(g.matMul(a).matMul(m.transpose())),1),[a,o,i]})),a=e[0],o=e[1],i=e[2],GN([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var CV=uD({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,jR(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){jR(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=RD(t,t.shape[0],0).map((function(t){return uP(t,[0])}));jR(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],s=t,a=function(t){o.push(KO.tidy((function(){var e=s[t];if(t>0)for(var n=0;n<t;++n){var r=KB(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(Uj(e,"euclidean"))})))};for(i=0;i<t.length;++i)a(i);return e?cP(o,0):o}}),EV=uD({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return xV(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=dP(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=xV(t,e),r=n[1];i.push(n[0]),o.push(r)})),[cP(i,0).reshape(t.shape),cP(o,0).reshape(t.shape)]}}),SV=Object.freeze({gramSchmidt:CV,qr:EV});function IV(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),jR(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),jR(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),jR(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),jR(1===e.rank,(function(){return"scores must be a 1D tensor"})),jR(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var kV=uD({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=YN(t,"images","resizeBilinear");jR(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),jR(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=KO.runKernel((function(t,e){return e([i]),t.resizeBilinear(i,s,a,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return KO.runKernel((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),TV=uD({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=YN(t,"images","resizeNearestNeighbor");jR(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),jR(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),jR("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=KO.runKernel((function(t,e){return e([i]),t.resizeNearestNeighbor(i,s,a,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return KO.runKernel((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),AV=uD({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=YN(t,"boxes","nonMaxSuppression"),s=YN(e,"scores","nonMaxSuppression"),a=IV(o,s,n,r,i);return n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,KO.runKernel((function(t){return t.nonMaxSuppression(o,s,n,r,i)}),{$boxes:o})}}),RV=uD({cropAndResize_:function(t,e,n,r,i,o){var s=YN(t,"image","cropAndResize","float32"),a=YN(e,"boxes","cropAndResize","float32"),u=YN(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=a.shape[0];return jR(4===s.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),jR(2===a.rank&&4===a.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+a.shape+"."})),jR(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+a.shape+"."})),jR(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),jR(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),jR("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),KO.runKernel((function(t,e){return t.cropAndResize(s,a,u,r,i,o)}),{$image:s,$boxes:a})}}),OV=Object.freeze({resizeBilinear:kV,resizeNearestNeighbor:TV,nonMaxSuppression:AV,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),AR(this,void 0,void 0,(function(){var o,s,a,u,c,l;return RR(this,(function(h){switch(h.label){case 0:return o=YN(t,"boxes","nonMaxSuppressionAsync"),s=YN(e,"scores","nonMaxSuppressionAsync"),a=IV(o,s,n,r,i),n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,o.data()];case 1:return u=h.sent(),[4,s.data()];case 2:return c=h.sent(),l=YP(u,c,n,r,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,l]}}))}))},cropAndResize:RV}),NV=uD({matMul_:function(t,e,n,r,i,o){var s;void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o="linear");var a=YN(t,"a","fused matMul"),u=YN(e,"b","fused matMul");s=zO(a,u),a=s[0],u=s[1];var c=n?a.shape[a.rank-2]:a.shape[a.rank-1],l=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?a.shape[a.rank-1]:a.shape[a.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=a.shape.slice(0,-2),p=u.shape.slice(0,-2),m=WR(f),g=WR(p);jR(a.rank>=2&&u.rank>=2&&a.rank===u.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+u.rank+"."})),jR(qR(f,p),(function(){return"Error in fused matMul: outer dimensions ("+f+") and ("+p+") of Tensors with shapes "+a.shape+" and "+u.shape+" must match."})),jR(c===l,(function(){return"Error in fused matMul: inner shapes ("+c+") and ("+l+") of Tensors with shapes "+a.shape+" and "+u.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v,y=a.shape.slice(0,-2).concat([h,d]),b=n?a.as3D(m,c,h):a.as3D(m,h,c),w=r?u.as3D(g,d,l):u.as3D(g,l,d);null!=i&&NP(y,(v=zO(v=YN(i,"bias","fused matMul"),a)[0]).shape);var _={$a:b,$b:w};return null!=i&&(_.$bias=v),KO.runKernel((function(t,e){var i=t.fusedBatchMatMul(b,w,n,r,v,o);return e([b,w,i]),i}),_,(function(t,e){var s,a=e[0],u=e[1],c=e[2];if(null==o||"linear"===o)s=t;else{if("relu"!==o)throw new Error("Gradient for activation "+o+" has not been implemented yet.");s=t.mul(c.step())}var l={};return null!=i&&(l={$bias:function(){var t=s,e=OP(v.shape,s.shape);return e.length>0&&(t=t.sum(e)),t.reshape(v.shape)}}),Object.assign(n||r?!n&&r?{$a:function(){return s.matMul(u,!1,!1)},$b:function(){return s.matMul(a,!0,!1)}}:n&&!r?{$a:function(){return u.matMul(s,!1,!0)},$b:function(){return a.matMul(s,!1,!1)}}:{$a:function(){return u.matMul(s,!0,!0)},$b:function(){return s.matMul(a,!0,!0)}}:{$a:function(){return s.matMul(u,!1,!0)},$b:function(){return a.matMul(s,!0,!1)}},l)})).reshape(y)}}),DV=Object.freeze({matMul:NV}),PV=Object.freeze({image:OV,linalg:SV,losses:_V,spectral:nV,fused:DV,signal:hV,op:uD,batchNormalization2d:nB,batchNormalization3d:rB,batchNormalization4d:iB,batchNormalization:oB,batchNorm:sB,batchNorm2d:aB,batchNorm3d:uB,batchNorm4d:cB,complex:cD,real:lD,imag:hD,concat:SD,concat1d:ID,concat2d:kD,concat3d:TD,concat4d:AD,split:RD,conv1d:fB,conv2d:pB,conv3d:mB,conv2dDerFilter:gB,depthwiseConv2d:vB,separableConv2d:yB,conv2dTranspose:bB,matMul:wB,dot:_B,outerProduct:xB,reverse:CB,reverse1d:EB,reverse2d:SB,reverse3d:IB,reverse4d:kB,maxPool:RB,avgPool:OB,pool:NB,slice:DB,slice1d:PB,slice2d:MB,slice3d:FB,slice4d:LB,abs:mL,acos:gL,acosh:vL,asin:yL,asinh:bL,atan:wL,atanh:_L,ceil:xL,clipByValue:CL,cos:EL,cosh:SL,erf:IL,exp:kL,expm1:TL,floor:AL,log:RL,log1p:OL,logSigmoid:NL,neg:DL,reciprocal:PL,round:ML,rsqrt:FL,sigmoid:LL,sign:BL,isNaN:jL,isInf:VL,isFinite:UL,sin:zL,sinh:WL,softplus:qL,sqrt:HL,square:GL,step:$L,tan:KL,tanh:XL,all:jB,any:VB,argMax:UB,argMin:zB,logSumExp:WB,max:qB,mean:HB,min:GB,moments:$B,sum:KB,prod:XB,equal:YB,equalStrict:QB,greater:JB,greaterEqual:ZB,greaterEqualStrict:tj,greaterStrict:ej,less:nj,lessEqual:rj,lessEqualStrict:ij,lessStrict:oj,notEqual:sj,notEqualStrict:aj,add:uj,addN:cj,addStrict:lj,atan2:hj,div:dj,divStrict:fj,floorDiv:pj,maximum:mj,maximumStrict:gj,minimum:vj,minimumStrict:yj,mod:bj,modStrict:wj,mul:_j,mulStrict:xj,pow:Cj,powStrict:Ej,squaredDifference:Sj,squaredDifferenceStrict:Ij,sub:kj,subStrict:Tj,elu:Pj,leakyRelu:Mj,prelu:Fj,relu:Lj,selu:Bj,logicalAnd:Aj,logicalNot:Rj,logicalOr:Oj,logicalXor:Nj,where:Dj,whereAsync:function(t){return AR(this,void 0,void 0,(function(){var e,n,r;return RR(this,(function(i){switch(i.label){case 0:return[4,(e=YN(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=eM(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},buffer:zD,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:WD,cast:qD,clone:HD,cumsum:GD,depthToSpace:$D,expandDims:KD,eye:XD,multinomial:YD,oneHot:QD,pad:JD,pad1d:ZD,pad2d:tP,pad3d:eP,pad4d:nP,rand:rP,randomNormal:iP,randomUniform:oP,reshape:sP,spaceToBatchND:aP,squeeze:uP,stack:cP,tile:lP,truncatedNormal:hP,unstack:dP,setdiff1dAsync:function(t,e){return AR(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h;return RR(this,(function(d){switch(d.label){case 0:return n=YN(t,"x","setdiff1d"),r=YN(e,"y","setdiff1d"),jR(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),jR(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),jR(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(o=d.sent(),s=new Set(o),a=0,l=0;l<i.length;l++)s.has(i[l])||a++;for(u=new kO([a],n.dtype),c=new kO([a],"int32"),l=0,h=0;l<i.length;l++)s.has(i[l])||(u.values[h]=i[l],c.values[h]=l,h++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},fill:_D,linspace:function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return KO.runKernel((function(r){return r.linspace(t,e,n)}),{})},ones:bD,range:xD,scalar:pD,tensor:dD,tensor1d:mD,tensor2d:gD,tensor3d:vD,tensor4d:yD,tensor5d:function(t,e,n){if(UR(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=KN(t);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return fD(t,e,r,n)},tensor6d:function(t,e,n){if(UR(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=KN(t);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return fD(t,e=e||r,r,n)},zeros:wD,onesLike:CD,zerosLike:ED,transpose:jj,softmax:kP,logSoftmax:TP,localResponseNormalization:Vj,norm:Uj,gather:qj,unsortedSegmentSum:Hj,basicLSTMCell:Gj,multiRNNCell:$j,movingAverage:Kj,stridedSlice:Xj,topk:Yj,scatterND:Qj,fft:Jj,ifft:Zj,rfft:tV,irfft:eV,sparseToDense:rV,gatherND:iV,dropout:oV,hannWindow:uV,hammingWindow:cV,frame:lV}),MV=function(){function t(){if(this.blockSize=48,this.firstUse=!0,DR.get("IS_BROWSER")){var t=function(){if("undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}();this.fromPixels2DContext=t.getContext("2d")}this.data=new AP(this,KO)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,DR.get("IS_NODE")&&$N("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r;if(DR.get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,t.width,t.height).data;else if(t instanceof ImageData||t.data instanceof Uint8Array)n=t.data;else{if(!(t instanceof HTMLImageElement||t instanceof HTMLVideoElement))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),n=this.fromPixels2DContext.getImageData(0,0,t.width,t.height).data}if(4===e)r=new Int32Array(n);else{var i=t.width*t.height;r=new Int32Array(i*e);for(var o=0;o<i;o++)for(var s=0;s<e;++s)r[o*e+s]=n[4*o+s]}return vD(r,[t.height,t.width,e],"int32")},t.prototype.read=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?GP(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){return zD(t.shape,t.dtype,this.readSync(t.dataId))},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){return e=bO(),t(),[2,{kernelMs:bO()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=OO.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:KO.keep(t.clone()),imag:KO.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&jR("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),EP(t.shape,e,n)){var r=SP(e,t.strides),i=WR(n);return dD(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=zD(n,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a).map((function(t,n){return t+e[n]}));o.values[a]=s.get.apply(s,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){this.assertNotComplex(t,"stridedSlice");var c=_P(t.shape,e,n,r,i,o,s,a,u),l=c[0],h=c[1],d=c[2],f=h.filter((function(t,e){return-1===d.indexOf(e)}));if(f.some((function(t){return 0===t})))return dD([],f);for(var p=zD(h,t.dtype),m=this.bufferSync(t),g=0;g<p.size;g++){for(var v=p.indexToLoc(g),y=new Array(v.length),b=0;b<y.length;b++)y[b]=v[b]*r[b]+l[b];p.set.apply(p,[m.get.apply(m,y)].concat(v))}return p.toTensor().reshape(f)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=zD(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),s=o.slice();e.forEach((function(e){return s[e]=t.shape[e]-1-s[e]})),n.set.apply(n,[r.get.apply(r,s)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;this.assertNotComplex(t,"concat");var r=t.map((function(t){var n=WR(t.shape.slice(e));return t.as2D(-1,n)})),i=aD(r.map((function(t){return t.shape})),1),o=zD(i,t[0].dtype).values;if(1===r[0].shape[0]){var s=0;r.forEach((function(t){o.set(n.readSync(t.dataId),s),s+=t.size}))}else{var a=0;r.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,s=0;s<t.shape[0];++s)for(var u=s*i[1]+a,c=0;c<t.shape[1];++c)o[u+c]=e[r++];a+=t.shape[1]}))}var u=aD(t.map((function(t){return t.shape})),e);return dD(o,u,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(pD(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,VO(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=zD(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var s=n[o],a=0;a<i.length;a++)i[a]+=s[a];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,VO(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],s=r?e.shape[1]:e.shape[2],a=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],d=l[1],f=l[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=p[0],g=p[1],v=p[2],y=o*s,b=zD([a,o,s],t.dtype),w=b.values,_=this.blockSize,x=0;x<a;x++)for(var C=0;C<o;C+=_)for(var E=0;E<s;E+=_)for(var S=0;S<i;S+=_)for(var I=Math.min(C+_,o),k=Math.min(E+_,s),T=Math.min(S+_,i),A=C;A<I;A++)for(var R=E;R<k;R++){for(var O=0,N=S;N<T;N++)O+=u[x*h+A*d+N*f]*c[N*m+R*g+x*v];w[x*y+(A*s+R)]+=O}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var s=this.batchMatMul(t,e,n,r);return i&&(s=this.add(s,i)),o&&(s=function(t,e,n){if("linear"===e)return t.linear(n);if("relu"===e)return t.relu(n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}(this,o,s)),s},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,VO(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),nD("sum",e,t.rank);for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],VO(t.dtype,"int32")),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=0,h=0;h<o;++h)l+=a[c+h];s[u]=l}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],VO(t.dtype,"int32")),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=1,h=0;h<o;++h)l*=a[c+h];s[u]=l}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var s=pD(o,"int32"),a=YB(s,e).asType("float32").mul(t).sum(0);r.push(a)}return cP(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];nD("argMin",n,t.rank);for(var r=tD(t.shape,n),i=r[1],o=wD(r[0],"int32"),s=WR(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<a.length;++c){for(var l=c*s,h=u[l],d=0,f=0;f<s;++f){var p=u[l+f];p<h&&(h=p,d=f)}a[c]=d}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];nD("argMax",n,t.rank);for(var r=tD(t.shape,n),i=r[1],o=wD(r[0],"int32"),s=WR(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<a.length;++c){for(var l=c*s,h=u[l],d=0,f=0;f<s;++f){var p=u[l+f];p>h&&(h=p,d=f)}a[c]=d}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=VO(t.dtype,"int32"),o=wD(t.shape,i),s=this.readSync(o.dataId),a=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<a.length;l+=u)for(var h=0;h<u;h++){var d=c(l,h);if(0===h)s[d]=n?0:a[d];else{var f=c(l,h-1);s[d]=n?a[f]+s[f]:a[d]+s[f]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return OO.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),s=wD(e.shape,VO(e.dtype,n.dtype)),a=this.readSync(s.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],l=0;l<r.length;l++)for(var h=0;h<c;h++)a[u++]=1===r[l]?i[l]:o[l];return s},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return eM(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),tM(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),nD("min",e,t.rank);for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],t.dtype),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h){var d=a[c+h];d<l&&(l=d)}s[u]=l}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),nD("max",e,t.rank);for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],t.dtype),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h){var d=a[c+h];d>l&&(l=d)}s[u]=l}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),nD("all",e,t.rank);for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],t.dtype),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h)l=l&&a[c+h];s[u]=l}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),nD("any",e,t.rank);for(var n=tD(t.shape,e),r=n[1],i=wD(n[0],t.dtype),o=WR(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h)l=l||a[c+h];s[u]=l}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return OO.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return OO.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return OO.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return OO.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return OO.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return OO.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return OO.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return OO.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return OO.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return OO.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return OO.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return OO.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return OO.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return OO.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return OO.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=wD(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return OO.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var s=r[o];n[o]=s>=1?i[o]:i[o]*(s+1)}return OO.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return OO.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>n?n:s<e?e:s}return OO.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return OO.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return OO.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return OO.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return OO.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,s=r[i]>-e,a=r[i]<e,u=Math.exp(r[i]);o=a?u:s?r[i]:Math.log(1+u),n[i]=o}return OO.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return OO.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return OO.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return OO.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return OO.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return OO.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return OO.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return OO.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return OO.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=GR(n[r]);return OO.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return OO.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return OO.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return OO.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r],o=1/(1+.3275911*i);e[r]=1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i)}return OO.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return OO.make(t.shape,{values:n})},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,c=zD(n.outShape,t.dtype),l=this.readSync(t.dataId),h=this.readSync(e.dataId),d=c.values,f=0;f<n.batchSize;++f)for(var p=f*t.strides[0],m=f*c.strides[0],g=0;g<n.outHeight;++g)for(var v=m+g*c.strides[1],y=g*n.strideHeight-u,b=0;b<r;b++){var w=y+b*o;if(!(w<0||w>=n.inHeight))for(var _=b*e.strides[0],x=p+w*t.strides[1],C=0;C<n.outWidth;++C)for(var E=v+C*n.outChannels,S=C*n.strideWidth-a,I=0;I<i;I++){var k=S+I*s;if(!(k<0||k>=n.inWidth))for(var T=x+k*n.inChannels,A=_+I*e.strides[1],R=0;R<n.inChannels;++R){for(var O=l[T+R],N=0;N<n.outChannels;++N)d[E+N]+=O*h[A+N];A+=n.outChannels}}}return c.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,s=n.dilationDepth,a=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,d=zD(n.outShape,t.dtype),f=this.readSync(t.dataId),p=this.readSync(e.dataId),m=d.values,g=0;g<n.batchSize;++g)for(var v=g*t.strides[0],y=g*d.strides[0],b=0;b<n.outDepth;++b)for(var w=y+b*d.strides[1],_=b*n.strideDepth-c,x=0;x<r;x++){var C=_+x*s;if(!(C<0||C>=n.inDepth))for(var E=x*e.strides[0],S=v+C*t.strides[1],I=0;I<n.outHeight;++I)for(var k=w+I*d.strides[2],T=I*n.strideHeight-h,A=0;A<i;A++){var R=T+A*a;if(!(R<0||R>=n.inHeight))for(var O=E+A*e.strides[1],N=S+R*t.strides[2],D=0;D<n.outWidth;++D)for(var P=k+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<o;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=N+L*n.inChannels,j=O+F*e.strides[2],V=0;V<n.inChannels;++V){for(var U=f[B+V],z=0;z<n.outChannels;++z)m[P+z]+=U*p[j+z];j+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=zD(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],d=l[1],f=l[2],p=this.readSync(e.dataId),m=e.strides,g=m[0],v=m[1],y=m[2],b=n.batchSize,w=n.filterHeight,_=n.filterWidth,x=n.inChannels,C=n.inHeight,E=n.inWidth,S=n.outChannels,I=n.outHeight,k=n.outWidth,T=n.strideHeight,A=n.strideWidth,R=w-1-n.padInfo.top,O=_-1-n.padInfo.left,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-R,F=Math.max(0,Math.ceil(M/T)),L=Math.min(I,(w+M)/T),B=0;B<E;++B){for(var j=B-O,V=Math.max(0,Math.ceil(j/A)),U=Math.min(k,(_+j)/A),z=0,W=F;W<L;++W)for(var q=W*T-M,H=V;H<U;++H)for(var G=h*N+d*W+f*H,$=g*(w-1-q)+v*(_-1-(H*A-j))+y*D,K=0;K<S;++K)z+=c[G+K]*p[$+K];i[s*N+a*P+u*B+D]=z}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=zD(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],c=o[3],l=this.readSync(t.dataId),h=t.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),v=e.strides,y=v[0],b=v[1],w=v[2],_=v[3],x=n.batchSize,C=n.filterDepth,E=n.filterHeight,S=n.filterWidth,I=n.inChannels,k=n.inDepth,T=n.inHeight,A=n.inWidth,R=n.outChannels,O=n.outDepth,N=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=C-1-n.padInfo.front,B=E-1-n.padInfo.top,j=S-1-n.padInfo.left,V=0;V<x;++V)for(var U=0;U<I;++U)for(var z=0;z<k;++z)for(var W=z-L,q=Math.max(0,Math.ceil(W/P)),H=Math.min(O,(C+W)/P),G=0;G<T;++G)for(var $=G-B,K=Math.max(0,Math.ceil($/M)),X=Math.min(N,(E+$)/M),Y=0;Y<A;++Y){for(var Q=Y-j,J=Math.max(0,Math.ceil(Q/F)),Z=Math.min(D,(S+Q)/F),tt=0,et=q;et<H;++et)for(var nt=et*P-W,rt=K;rt<X;++rt)for(var it=rt*M-$,ot=J;ot<Z;++ot)for(var st=d*V+f*et+p*rt+m*ot,at=y*(C-1-nt)+b*(E-1-it)+w*(S-1-(ot*F-Q))+_*U,ut=0;ut<R;++ut)tt+=l[st+ut]*g[at+ut];i[s*V+a*z+u*G+c*Y+U]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=zD(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=this.bufferSync(t),h=this.bufferSync(e),d=0;d<o;++d)for(var f=Math.max(0,Math.ceil((c-d)/r)),p=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((u-m)/i)),v=Math.min(n.outWidth,(n.inWidth+u-m)/i),y=0;y<n.inChannels;++y)for(var b=0;b<n.outChannels;++b){for(var w=0,_=0;_<n.batchSize;++_)for(var x=f;x<p;++x)for(var C=d+x*r-c,E=g;E<v;++E)w+=l.get(_,C,m+E*i-u,y)*h.get(_,x,E,b);a.set(w,d,m,y,b)}return a.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,s=n.filterDepth,a=n.filterHeight,u=n.filterWidth,c=zD(n.filterShape,"float32"),l=c.values,h=c.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),v=e.strides,y=v[0],b=v[1],w=v[2],_=v[3],x=this.readSync(t.dataId),C=t.strides,E=C[0],S=C[1],I=C[2],k=C[3],T=n.padInfo.front,A=n.padInfo.left,R=n.padInfo.top,O=0;O<s;++O)for(var N=Math.max(0,Math.ceil((T-O)/r)),D=Math.min(n.outDepth,(n.inDepth+T-O)/r),P=O*d,M=0;M<a;++M)for(var F=Math.max(0,Math.ceil((R-M)/i)),L=Math.min(n.outHeight,(n.inHeight+R-M)/i),B=M*f+P,j=0;j<u;++j)for(var V=Math.max(0,Math.ceil((A-j)/o)),U=Math.min(n.outWidth,(n.inWidth+A-j)/o),z=j*p+B,W=0;W<n.inChannels;++W)for(var q=W*m+z,H=0;H<n.outChannels;++H){for(var G=0,$=0;$<n.batchSize;++$)for(var K=$*E,X=$*y,Y=N;Y<D;++Y)for(var Q=(O+Y*r-T)*S+K,J=Y*b+X,Z=F;Z<L;++Z)for(var tt=(M+Z*i-R)*I+Q,et=Z*w+J,nt=V;nt<U;++nt)G+=x[(j+nt*o-A)*k+tt+W]*g[nt*_+et+H];l[q+H]=G}return c.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=zD(n.outShape,t.dtype),h=this.readSync(t.dataId),d=this.readSync(e.dataId),f=l.values,p=0;p<n.batchSize;++p)for(var m=p*t.strides[0],g=p*l.strides[0],v=0;v<n.outHeight;++v)for(var y=g+v*l.strides[1],b=v*n.strideHeight-a,w=0;w<r;++w){var _=b+w*o;if(!(_<0||_>=n.inHeight))for(var x=w*e.strides[0],C=m+_*t.strides[1],E=0;E<n.outWidth;++E)for(var S=y+E*l.strides[2],I=E*n.strideWidth-u,k=0;k<i;++k){var T=I+k*s;if(!(T<0||T>=n.inWidth))for(var A=C+T*n.inChannels,R=S,O=x+k*e.strides[1],N=0;N<n.inChannels;++N){for(var D=h[A+N],P=0;P<c;++P)f[R+P]+=D*d[O+P];R+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=zD(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],d=l[1],f=l[2],p=this.readSync(e.dataId),m=e.strides,g=m[0],v=m[1],y=m[2],b=n.batchSize,w=n.filterHeight,_=n.filterWidth,x=n.inChannels,C=n.inHeight,E=n.inWidth,S=n.outHeight,I=n.outWidth,k=n.strideHeight,T=n.strideWidth,A=w-1-n.padInfo.top,R=_-1-n.padInfo.left,O=n.outChannels/x,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-A,F=Math.max(0,Math.ceil(M/k)),L=Math.min(S,(w+M)/k),B=0;B<E;++B){for(var j=B-R,V=Math.max(0,Math.ceil(j/T)),U=Math.min(I,(_+j)/T),z=0,W=F;W<L;++W)for(var q=W*k-M,H=V;H<U;++H)for(var G=h*N+d*W+f*H,$=g*(w-1-q)+v*(_-1-(H*T-j))+y*D,K=0;K<O;++K)z+=c[G+(D*O+K)]*p[$+K];i[s*N+a*P+u*B+D]=z}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=zD(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),d=this.bufferSync(e),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),g=0;g<s;++g)for(var v=Math.max(0,Math.ceil((u-g)/i)),y=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/l),_=b%l,x=0,C=0;C<n.batchSize;++C)for(var E=p;E<m;++E)for(var S=f+E*r-c,I=v;I<y;++I)x+=h.get(C,S,g+I*i-u,w)*d.get(C,E,I,b);a.set(x,f,g,w,_)}return a.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),ZP(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),s=zD(r,t.dtype);0!==n&&s.values.fill(n);for(var a=0;a<t.size;a++){var u=o.indexToLoc(a),c=u.map((function(t,e){return t+i[e]}));s.set.apply(s,[o.get.apply(o,u)].concat(c))}return s.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=zD(n,t.dtype),s=this.bufferSync(t);for(r=0;r<t.size;++r){for(var a=s.indexToLoc(r),u=new Array(a.length),c=0;c<u.length;c++)u[c]=a[e[c]];var l=o.locToIndex(u);o.values[l]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=zD(r,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a),c=u.slice();c[n]=i[u[n]];var l=s.locToIndex(c);o.values[a]=s.values[l]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=fP(t.shape,e,r),o=pP(i.length,e.length),s=mP(t.shape,e,r),a=gP(n,e.length),u=vP(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=fP(s.shape,e,r,!1),u=pP(a.length,e.length,!1),c=mP(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(c)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(t.dataId),f=zD(e.outShape,t.dtype),p=f.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],g=e.outShape[2]*e.outShape[3],v=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*m,w=y*t.strides[0],_=0;_<e.inChannels;++_)for(var x=0;x<e.outHeight;++x)for(var C=x*r-c,E=Math.max(0,C),S=Math.min(e.inHeight,a+C),I=b+x*g,k=0;k<e.outWidth;++k){for(var T=k*i-l,A=Math.max(0,T),R=Math.min(e.inWidth,u+T),O=h,N=0,D=0,P=E;P<S;P+=o){for(var M=w+P*t.strides[1],F=A;F<R;F+=s){var L=d[M+F*t.strides[2]+_];"max"===n&&L>O?O=L:"avg"===n&&(N+=L,D++)}if(isNaN(O))break}p[I+k*v+_]="avg"===n?N/D:O}return f.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=zD(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),d=0;d<e.batchSize;++d)for(var f=0;f<e.inChannels;++f)for(var p=0;p<e.outHeight;++p){for(var m=p*r-c,g=m;g<0;)g+=o;for(var v=Math.min(e.inHeight,a+m),y=0;y<e.outWidth;++y){for(var b=y*i-l,w=b;w<0;)w+=s;for(var _=Math.min(e.inWidth,u+b),x=Number.NEGATIVE_INFINITY,C=-1,E=g;E<v;E+=o)for(var S=E-m,I=w;I<_;I+=s){var k=I-b,T=h.get(d,E,I,f);T>x&&(x=T,C=S*u+k)}n.set(C,d,p,y,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,d=c-1-r.padInfo.top,f=zD(e.shape,"float32"),p=this.bufferSync(i),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var w=y-d,_=b-h,x=0,C=0;C<c;C+=a){var E=(w+C)/o;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var S=0;S<l;S+=u){var I=(_+S)/s;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var k=c*l-1-p.get(g,E,I,v)===C*l+S?1:0;0!==k&&(x+=m.get(g,E,I,v)*k)}}}f.set(x,g,y,b,v)}return f.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,d=c-1-n.padInfo.top,f=zD(e.shape,"float32"),p=1/(o*s),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var v=0;v<n.inChannels;++v)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var w=y-d,_=b-h,x=0,C=0;C<c;C+=a){var E=(w+C)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var S=0;S<l;S+=u){var I=(_+S)/i;I<0||I>=n.outWidth||Math.floor(I)!==I||(x+=m.get(g,E,I,v))}}f.set(x*p,g,y,b,v)}return f.toTensor()},t.prototype.cast=function(t,e){return WP(t,e,this)},t.prototype.reshape=function(t,e){return qP(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(WR([o,e,n,u])),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=0,p=h[0]/d[0],m=h[1]/d[1],g=0;g<o;g++)for(var v=0;v<e;v++)for(var y=p*v,b=Math.floor(y),w=y-b,_=Math.min(s-1,Math.ceil(y)),x=g*t.strides[0]+b*t.strides[1],C=g*t.strides[0]+_*t.strides[1],E=0;E<n;E++)for(var S=m*E,I=Math.floor(S),k=S-I,T=Math.min(a-1,Math.ceil(S)),A=x+I*t.strides[2],R=C+I*t.strides[2],O=x+ +T*t.strides[2],N=C+T*t.strides[2],D=0;D<u;D++){var P=c[A+D],M=c[R+D],F=P+(c[O+D]-P)*k;l[f++]=F+(M+(c[N+D]-M)*k-F)*w}return dD(l,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*s*a),d=[n&&c>1?o-1:o,n&&l>1?s-1:s],f=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=d[0]/f[0],m=d[1]/f[1],g=this.readSync(t.dataId),v=0,y=0;y<i;y++)for(var b=y*e.strides[0],w=0;w<c;w++)for(var _=w*p,x=Math.floor(_),C=Math.min(Math.ceil(_),o-1),E=b+x*e.strides[1],S=b+C*e.strides[1],I=_-x,k=1-I,T=0;T<l;T++)for(var A=T*m,R=Math.floor(A),O=Math.min(Math.ceil(A),s-1),N=A-R,D=1-N,P=E+R*e.strides[2],M=E+O*e.strides[2],F=S+R*e.strides[2],L=S+O*e.strides[2],B=k*D,j=k*N,V=I*D,U=I*N,z=0;z<a;z++){var W=g[v++];h[P+z]+=W*B,h[M+z]+=W*j,h[F+z]+=W*V,h[L+z]+=W*U}return yD(h,[i,s,o,a],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(o*e*n*u),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=h[0]/d[0],p=h[1]/d[1],m=0,g=0;g<o;g++)for(var v=g*t.strides[0],y=0;y<e;y++)for(var b=f*y,w=v+Math.min(s-1,r?Math.round(b):Math.floor(b))*t.strides[1],_=0;_<n;_++)for(var x=p*_,C=w+Math.min(a-1,r?Math.round(x):Math.floor(x))*t.strides[2],E=0;E<u;E++)l[m++]=c[C+E];return dD(l,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*s*a),d=this.readSync(t.dataId),f=[n&&c>1?o-1:o,n&&l>1?s-1:s],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=f[0]/p[0],g=f[1]/p[1],v=1/m,y=1/g,b=2*Math.ceil(v)+2,w=2*Math.ceil(y)+2,_=0;_<i;_++)for(var x=_*e.strides[0],C=0;C<o;C++)for(var E=x+C*e.strides[1],S=Math.floor(C*v),I=Math.floor(S-b/2),k=0;k<s;k++)for(var T=E+k*e.strides[2],A=Math.floor(k*y),R=Math.floor(A-w/2),O=0;O<a;O++){for(var N=0,D=0;D<b;D++){var P=D+I;if(!(P<0||P>=c)){var M=x+P*t.strides[1],F=P*m;if(C===Math.min(o-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<w;L++){var B=L+R;if(!(B<0||B>=l)){var j=M+B*t.strides[2],V=B*g;k===Math.min(s-1,n?Math.round(V):Math.floor(V))&&(N+=d[j+O])}}}}h[T+O]=N}return yD(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(s.length),d=l.length,f=c.length,p=u.length,m=a.length,g=0,v=0,y=0,b=0,w=0;w<s.length;++w)h[w]=l[g++]+(s[w]-a[v++])*c[y++]/Math.sqrt(u[b++]+r),g>=d&&(g=0),v>=m&&(v=0),y>=f&&(y=0),b>=p&&(b=0);return yD(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],s=o-1,a=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,s),u=0;r<=i;r++){var c=a[r];u+=c*c}return u}for(var h=0;h<u;h++){var d=l(h),f=a[h]*Math.pow(n+r*d,-i);c[h]=f}return yD(c,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){this.assertNotComplex(t,"LRNGrad");for(var a=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),d=t.size,f=0;f<d;f++){for(var p=f%a,m=f-p+Math.max(0,p-r),g=f-p+Math.min(a,p+r+1),v=0,y=m;y<g;y++)v+=Math.pow(c[y],2);for(v=o*v+i,y=m;y<g;y++){var b=-2*o*s*c[y]*l[f]/v;f===y&&(b+=Math.pow(v,-s)),h[y]+=b*=u[f]}}return yD(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:kP(t),o=i.shape[0],s=i.shape[1],a=wD([o,n],"int32"),u=this.readSync(a.dataId),c=this.readSync(i.dataId),l=0;l<o;++l){var h=l*s,d=new Float32Array(s-1);d[0]=c[h];for(var f=1;f<d.length;++f)d[f]=d[f-1]+c[h+f];for(var p=jD(r.toString()),m=l*n,g=0;g<n;++g){var v=p();u[m+g]=d.length;for(var y=0;y<d.length;y++)if(v<d[y]){u[m+g]=y;break}}}return a},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),s=0;s<t.size;++s)o[s]>=0&&o[s]<e&&(i[s*e+o[s]]=n);return gD(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),YP(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=zD(t.shape,"float32"),o=zD(t.shape,"float32"),s=lD(t).as2D(n,r),a=hD(t).as2D(n,r),u=0;u<n;u++)for(var c=s.slice([u,0],[1,r]),l=a.slice([u,0],[1,r]),h=cD(c,l),d=this.readSync(this.fftImpl(h,e).dataId),f=0;f<r;f++){var p=$P(d,f);i.values[u*r+f]=p.real,o.values[u*r+f]=p.imag}return cD(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=cD(lD(i).div(pD(r)),hD(i).div(pD(r)))),i}var o=this.readSync(t.dataId),s=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return cD(s.real,s.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),s=cD(o.real,o.imag).as1D(),a=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=cD(a.real,a.imag).as1D();s=this.fftRadix2(s,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),l=cD(c.real,c.imag).mul(u),h=s.add(l),d=s.sub(l),f=lD(h).concat(lD(d)),p=hD(h).concat(hD(d));return cD(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,s=0,a=0;a<e;a++){var u=XP(i*a,e,n),c=$P(t,a);o+=c.real*u.real-c.imag*u.imag,s+=c.real*u.imag+c.imag*u.real}n&&(o/=e,s/=e),KP(r,o,s,i)}return r},t.prototype.depthToSpace=function(t,e,n){jR("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),jR(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],s=t.shape[3],a=i*e,u=o*e,c=s/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*a*u*c),d=0,f=0;f<r;++f)for(var p=0;p<a;++p)for(var m=Math.floor(p/e),g=p%e,v=0;v<u;++v)for(var y=Math.floor(v/e),b=(g*e+v%e)*c,w=0;w<c;++w)h[d++]=l[w+b+s*(y+o*(m+i*f))];return yD(h,[r,a,u,c])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=NP(t.shape,e.shape),o=zD(i,n),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=RP(t.shape,i),c=RP(e.shape,i),l=o.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(s[h%s.length],a[h%a.length]);else{var d=this.bufferSync(t),f=this.bufferSync(e),p=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=d.locToIndex(h),m=i.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var g=f.locToIndex(m);l[n]=r(s[p],a[g])};for(h=0;h<l.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=NP(t.shape,e.shape),i=zD(r,"float32"),o=zD(r,"float32"),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=RP(t.shape,r),c=RP(e.shape,r),l=i.values,h=o.values;if(u.length+c.length===0)for(var d=0;d<l.length;d++){var f=d%s.length,p=d%a.length,m=n(s[2*f],s[2*f+1],a[2*p],a[2*p+1]);l[d]=m.real,h[d]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),v=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),d=o.slice(-t.rank);u.forEach((function(t){return d[t]=0}));var f=g.locToIndex(d),p=o.slice(-e.rank);c.forEach((function(t){return p[t]=0}));var m=v.locToIndex(p),y=n(s[2*f],s[2*f+1],a[2*m],a[2*m+1]);l[r]=y.real,h[r]=y.imag};for(d=0;d<l.length;d++)y(d)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return JP(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var s=t.shape,a=s[0],u=s[1],c=s[2],l=s[3],h=e.shape[0],d=r[0],f=r[1],p=zD([h,d,f,l],t.dtype),m=this.readSync(e.dataId),g=this.readSync(n.dataId),v=this.readSync(t.dataId),y=t.strides,b=p.strides,w=0;w<h;w++){var _=4*w,x=m[_],C=m[_+1],E=m[_+2],S=m[_+3],I=g[w];if(!(I>=a))for(var k=d>1?(E-x)*(u-1)/(d-1):0,T=f>1?(S-C)*(c-1)/(f-1):0,A=0;A<d;A++){var R=d>1?x*(u-1)+A*k:.5*(x+E)*(u-1);if(R<0||R>u-1)for(var O=0;O<f;O++)for(var N=0;N<l;N++){var D=N+O*b[2]+A*b[1]+w*b[0];p.values[D]=o}else if("bilinear"===i){var P=Math.floor(R),M=Math.ceil(R),F=R-P;for(O=0;O<f;O++)if((H=f>1?C*(c-1)+O*T:.5*(C+S)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=o;else{var L=Math.floor(H),B=Math.ceil(H),j=H-L;for(N=0;N<l;N++){var V=v[D=N+L*y[2]+P*y[1]+I*y[0]],U=v[D=N+B*y[2]+P*y[1]+I*y[0]],z=v[D=N+L*y[2]+M*y[1]+I*y[0]],W=V+(U-V)*j,q=z+(v[D=N+B*y[2]+M*y[1]+I*y[0]]-z)*j;p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=W+(q-W)*F}}}else for(O=0;O<f;++O){var H;if((H=f>1?C*(c-1)+O*T:.5*(C+S)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=o;else{var G=Math.round(H),$=Math.round(R);for(N=0;N<l;N++)p.values[N+O*b[2]+A*b[1]+w*b[0]]=v[N+G*y[2]+$*y[1]+I*y[0]]}}}}return p.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=wP(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=yP(t,e),o=i[0],s=i[1],a=i[2],u=i[3];if(0===s)return dD([],o,t.dtype);for(var c=new kO([s,a],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),d=0;d<s;d++){for(var f=[],p=0,m=0;m<r;m++){var g=l[d*r+m];p+=g*u[m],f.push(g)}if(p<0||p>=t.size/a)throw new Error("Invalid indices: "+f+" does not index into "+t.shape);for(var v=0;v<a;v++)c.values[d*a+v]=h[p*a+v]}return c.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=wP(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,c=pD(0);return this.scatter(t,e,n,u,s,o,i,a,c,!0)},t.prototype.fill=function(t,e,n){var r=tO(n=n||hO(e),WR(t));return r.fill(e),OO.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=tO(t.dtype,WR(t.shape));return OO.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return HP(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,s,a,u,c){var l=[r/i,i],h=this.readSync(t.dataId),d=this.readSync(e.dataId);if(0===r)return dD([],n,e.dtype);var f=new kO(l,e.dtype);f.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var m=[],g=0,v=0;v<s;v++){var y=h[p*s+v];m.push(y),g+=y*a[v]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)c?f.values[g*i+b]+=d[p*i+b]:f.values[g*i+b]=0===e.rank?d[0]:d[p*i+b]}return f.toTensor().reshape(n)},t}();KO.registerBackend("cpu",(function(){return new MV}),1);var FV=function(){function t(){this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder}return t.prototype.encodeUTF8=function(t){return this.textEncoder.encode(t)},t.prototype.decodeUTF8=function(t){return this.textDecoder.decode(t)},t.prototype.fetch=function(t,e){return fetch(t,e)},t}();DR.get("IS_BROWSER")&&DR.setPlatform("browser",new FV);var LV,BV=function(){function t(){var t=n(3);this.textEncoder=new t.TextEncoder,this.textDecoder=new t.TextDecoder}return t.prototype.encodeUTF8=function(t){return this.textEncoder.encode(t)},t.prototype.decodeUTF8=function(t){return 0===t.length?"":this.textDecoder.decode(t)},t.prototype.fetch=function(t,e){return null!=DR.global.fetch?DR.global.fetch(t,e):(null==LV&&(LV=n(2)),LV(t,e))},t}();DR.get("IS_NODE")&&DR.setPlatform("node",new BV);var jV={float32:4,int32:4,uint16:2,uint8:1,bool:1};function VV(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,s=e.shape,a=WR(s),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=jV[c.dtype],h=t.slice(r,r+a*l),d="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(d,(function(t){return t*c.scale+c.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(d,(function(t){return Math.round(t*c.scale+c.min)}))}r+=a*l}else if("string"===o){var f=e,p=new Uint8Array(t.slice(r,r+f.byteLength));u=DR.platform.decodeUTF8(p).split(f.delimiter),r+=f.byteLength}else{var m=jV[o];if(h=t.slice(r,r+a*m),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=a*m}n[i]=dD(u,s,o)},o=0,s=e;o<s.length;o++)i(s[o]);return n}function UV(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var zV="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function WV(t){return zV?Buffer.byteLength(t):new Blob([t]).size}function qV(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function HV(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function GV(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:WV(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:WV(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var $V=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),KV=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){jR(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),jR(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();jR(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function XV(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+KV.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}function YV(t,e,n){return void 0===n&&(n=!1),AR(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h;return RR(this,(function(d){switch(d.label){case 0:return jR(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),jR((r=$V.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),jR(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],jR((o=$V.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),jR(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],a=XV(t).scheme,u=XV(t).path,c=a===XV(t).scheme,[4,i.load()];case 1:return l=d.sent(),n&&c?[4,KV.getManager(a).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,s.save(l)];case 4:return h=d.sent(),!n||c?[3,6]:[4,KV.getManager(a).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}function QV(){if(!DR.getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function JV(t){var e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}var ZV=function(){function t(t){if(this.indexedDB=QV(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return JV(i)},i.onsuccess=function(){var o=i.result;if(null==e){var s=o.transaction("models_store","readonly"),a=s.objectStore("models_store").get(n.modelPath);a.onsuccess=function(){if(null==a.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(a.result.modelArtifacts)},a.onerror=function(t){return o.close(),r(a.error)},s.oncomplete=function(){return o.close()}}else{var u,c=GV(e),l=o.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var i=(u=o.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore("model_info_store")).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},d.onerror=function(t){return o.close(),r(d.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),tU=function(t){return DR.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ZV.URL_SCHEME)?(e=t.slice(ZV.URL_SCHEME.length),new ZV(e)):null;var e};$V.registerSaveRouter(tU),$V.registerLoadRouter(tU);var eU=function(){function t(){this.indexedDB=QV()}return t.prototype.listModels=function(){return AR(this,void 0,void 0,(function(){var t=this;return RR(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return JV(r)},r.onsuccess=function(){var t=r.result,i=t.transaction("model_info_store","readonly"),o=i.objectStore("model_info_store").getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return AR(this,void 0,void 0,(function(){var e=this;return RR(this,(function(n){var r;return t=(r=t).startsWith(ZV.URL_SCHEME)?r.slice(ZV.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return JV(i)},i.onsuccess=function(){var e,o=i.result,s=o.transaction("model_info_store","readwrite"),a=s.objectStore("model_info_store"),u=a.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=a.delete(t),s=function(){var i=(e=o.transaction("models_store","readwrite")).objectStore("models_store").delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=s,i.onerror=function(t){return s(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},s.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(DR.getBool("IS_BROWSER"))try{KV.registerManager(ZV.URL_SCHEME,new eU)}catch(LO){}var nU="tensorflowjs_models",rU="info",iU="model_topology",oU="weight_specs",sU="weight_data",aU="model_metadata";function uU(t){return{info:[nU,t,rU].join("/"),topology:[nU,t,iU].join("/"),weightSpecs:[nU,t,oU].join("/"),weightData:[nU,t,sU].join("/"),modelMetadata:[nU,t,aU].join("/")}}function cU(t){var e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}var lU=function(){function t(t){if(!DR.getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=uU(this.modelPath)}return t.prototype.save=function(t){return AR(this,void 0,void 0,(function(){var e,n,r;return RR(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=GV(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,zV?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},t.prototype.load=function(){return AR(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return RR(this,(function(a){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(zV){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),hU=function(t){return DR.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(lU.URL_SCHEME)?(e=t.slice(lU.URL_SCHEME.length),new lU(e)):null;var e};$V.registerSaveRouter(hU),$V.registerLoadRouter(hU);var dU=function(){function t(){jR(DR.getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),jR(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return AR(this,void 0,void 0,(function(){var t,e,n,r,i,o;return RR(this,(function(s){for(t={},e=nU+"/",n="/"+rU,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=cU(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return AR(this,void 0,void 0,(function(){var e,n;return RR(this,(function(r){var i;if(t=(i=t).startsWith(lU.URL_SCHEME)?i.slice(lU.URL_SCHEME.length):i,e=uU(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(DR.getBool("IS_BROWSER"))try{KV.registerManager(lU.URL_SCHEME,new dU)}catch(LO){}function fU(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var pU=function(){function t(e){if(!DR.getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return AR(this,void 0,void 0,(function(){var e,n,r,i;return RR(this,(function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,fU((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,fU((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:GV(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),mU=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return AR(this,void 0,void 0,(function(){var t,e,n=this;return RR(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var s=JSON.parse(o.target.result),a=s.modelTopology;if(null!=a){0===e.length&&r({modelTopology:a});var u=s.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],d=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),d.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);d[i]=n,-1===d.indexOf(null)&&r({modelTopology:a,weightSpecs:l,weightData:qV(d)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return HV(t.name)})),i={},o=0,s=t;o<s.length;o++)s[o].paths.forEach((function(t){var o=HV(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function gU(t,e,n,r){!function(t){jR(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){jR(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),jR(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),jR(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var s=n+ ++i/t.length*(r-n);return e(s),o})),o})))}function vU(t,e){return AR(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return RR(this,(function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?_O:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit)})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=h.sent(),[3,4];case 2:return[4,gU(r,e.onProgress,i,o)];case 3:s=h.sent(),h.label=4;case 4:return a=s.map((function(t){return t.arrayBuffer()})),u=.5,c=1,null!=e.onProgress?[3,6]:[4,Promise.all(a)];case 5:return l=h.sent(),[3,8];case 6:return[4,gU(a,e.onProgress,u,c)];case 7:l=h.sent(),h.label=8;case 8:return[2,l]}}))}))}function yU(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),AR(e,void 0,void 0,(function(){var e,o,s,a,u,c,l,h,d,f;return RR(this,(function(p){switch(p.label){case 0:if(e=n.map((function(){return!1})),o={},s=null!=i?i.map((function(){return!1})):[],a=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u=jV["quantization"in t?t.quantization.dtype:t.dtype]*WR(t.shape),c=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach((function(e,n){e===t.name&&(c(),s[n]=!0)})):c(),a.push(t.name),r+=u}))})),!s.every((function(t){return t})))throw u=i.filter((function(t,e){return!s[e]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+a.join(", ")+".");return c=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),l=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;l.push(e)}))})),[4,t(l)];case 1:return h=p.sent(),d={},f=0,c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[f+i].byteLength;for(var s=new ArrayBuffer(r),a=new Uint8Array(s),u=0,c=0;c<e;c++){var l=new Uint8Array(h[f+c]);a.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=VV(s.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)d[n]=e[n]})),f+=e})),[2,d]}}))}))}}$V.registerSaveRouter((function(t){return DR.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(pU.URL_SCHEME)?(void 0===(e=t.slice(pU.URL_SCHEME.length))&&(e="model"),new pU(e)):null;var e}));var bU=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(jR("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=_O,jR(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&jR(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return AR(this,void 0,void 0,(function(){var e,n;return RR(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:GV(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return AR(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a;return RR(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:a=u.sent(),o=a[0],s=a[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:s}]}}))}))},t.prototype.loadWeights=function(t){return AR(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,l;return RR(this,(function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,s=[],a=0,u=t;a<u.length;a++)s.push.apply(s,u[a].weights);return c=[],t.forEach((function(t){t.paths.forEach((function(t){c.push(o+t+i)}))})),[4,vU(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return l=h.sent(),[2,[s,qV(l)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function wU(t){return null!=t.match(bU.URL_SCHEME_REGEX)}var _U=function(t,e){return(Array.isArray(t)?t.every((function(t){return wU(t)})):wU(t))?xU(t,{onProgress:e}):null};function xU(t,e){return new bU(t,e)}$V.registerSaveRouter(_U),$V.registerLoadRouter(_U);var CU=function(){function t(t,e,n,r){this.modelTopology=t,this.weightSpecs=e,this.weightData=n,this.trainingConfig=r}return t.prototype.load=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){return t={},null!=this.modelTopology&&(t=TR({modelTopology:this.modelTopology},t)),null!=this.weightSpecs&&this.weightSpecs.length>0&&(t=TR({weightSpecs:this.weightSpecs},t)),null!=this.weightData&&this.weightData.byteLength>0&&(t=TR({weightData:this.weightData},t)),null!=this.trainingConfig&&(t=TR({trainingConfig:this.trainingConfig},t)),[2,t]}))}))},t}(),EU=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),SU=(Object.freeze({browserFiles:function(t){return new mU(t)},browserHTTPRequest:function(t,e){return xU(t,e)},concatenateArrayBuffers:qV,decodeWeights:VV,encodeWeights:function(t,e){return AR(this,void 0,void 0,(function(){var n,r,i,o,s,a=this;return RR(this,(function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),o=function(o){var s=i[o],u=Array.isArray(t)?t[o].tensor:t[s];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+s+"': "+u.dtype);var c={name:s,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(t){return AR(a,void 0,void 0,(function(){var e,n,r;return RR(this,(function(i){switch(i.label){case 0:return e=c,[4,u.data()];case 1:return n=i.sent(),r=DR.platform.encodeUTF8(n.join("\0")),e.byteLength=r.length,e.delimiter="\0",t(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=e&&(c.group=e),n.push(c)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:UV(u.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return new CU(t,e,n,r)},getLoadHandlers:function(t,e){return $V.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:GV,getSaveHandlers:function(t){return $V.getSaveHandlers(t)},http:xU,isHTTPScheme:wU,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),AR(this,void 0,void 0,(function(){return RR(this,(function(i){return[2,yU((function(t){return vU(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return $V.registerLoadRouter(t)},registerSaveRouter:function(t){return $V.registerSaveRouter(t)},weightsLoaderFactory:yU,withSaveHandler:function(t){return new EU(t)},copyModel:function(t,e){return AR(this,void 0,void 0,(function(){return RR(this,(function(n){return[2,YV(t,e,!1)]}))}))},listModels:function(){return AR(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return RR(this,(function(a){switch(a.label){case 0:t=KV.getSchemes(),e={},n=0,r=t,a.label=1;case 1:return n<r.length?[4,KV.getManager(i=r[n]).listModels()]:[3,4];case 2:for(s in o=a.sent())e[i+"://"+s]=o[s];a.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return AR(this,void 0,void 0,(function(){return RR(this,(function(n){return[2,YV(t,e,!0)]}))}))},removeModel:function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){return e=XV(t),[2,KV.getManager(e.scheme).removeModel(e.path)]}))}))}}),uD({confusionMatrix_:function(t,e,n){var r=YN(t,"labels","confusionMatrix"),i=YN(e,"predictions","confusionMatrix");jR(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),jR(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),jR(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),jR(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),jR(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=QD(r.asType("int32"),n),s=QD(i.asType("int32"),n);return o.transpose().matMul(s).asType("int32")}})),IU=(Object.freeze({confusionMatrix:SU}),uD({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return KO.fromPixels(t,e)}})),kU=Object.freeze({toPixels:function(t,e){return AR(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b,w,_,x;return RR(this,(function(C){switch(C.label){case 0:if(n=YN(t,"img","toPixels"),t instanceof OO||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return a=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),h=l[0][0],d=l[1][0],u.dispose(),c.dispose(),"float32"===n.dtype){if(h<0||d>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+d+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||d>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+d+"].")}for(f="float32"===n.dtype?255:1,p=new Uint8ClampedArray(o*i*4),m=0;m<i*o;++m)g=void 0,v=void 0,y=void 0,b=void 0,1===s?(g=a[m]*f,v=a[m]*f,y=a[m]*f,b=255):3===s?(g=a[3*m]*f,v=a[3*m+1]*f,y=a[3*m+2]*f,b=255):4===s&&(g=a[4*m]*f,v=a[4*m+1]*f,y=a[4*m+2]*f,b=a[4*m+3]*f),p[0+(w=4*m)]=Math.round(g),p[w+1]=Math.round(v),p[w+2]=Math.round(y),p[w+3]=Math.round(b);return null!=e&&(e.width=o,e.height=i,_=e.getContext("2d"),x=new ImageData(p,o,i),_.putImageData(x,0,0)),n!==t&&n.dispose(),[2,p]}}))}))},fromPixels:IU}),TU=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),AU=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function RU(t){jR(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),jR("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),jR(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),AU.register(t)}function OU(){return 32===KO.backend.floatPrecision()?.001:.1}function NU(t,e,n){var r=!0;if((oO(t)||oO(e))&&(r=!1),oO(t)&&oO(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var s=KN(t),a=KN(e);if(!qR(s,a))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+a+"]")}var u=oO(t)?t:zR(t),c=oO(e)?e:zR(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],d=c[l];if(!n(h,d))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+d+".\nActual:   "+u+".\nExpected: "+c+".")}}function DU(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({Serializable:TU,SerializationMap:AU,registerClass:RU}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=OU()),NU(t,e,(function(t,e){return DU(t,e,n)}))},testEpsilon:OU,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return uO(t)||uO(t[0])||uO(e)||uO(e[0])?NU(t,n,(function(t,e){return t==e})):NU(t,e,(function(t,e){return DU(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=OU()),!DU(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Object.freeze({gpgpu_util:SF,webgl_util:WN,MathBackendWebGL:pL,setWebGLContext:JO,GPGPUContext:IF});var PU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kR(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var s=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(s)}else this.applyGradients(o);return GN(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){jR(dO(t),(function(){return"The f passed in variableGrads(f) must be a function"})),jR(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof BO})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],KO.registeredVariables)e.push(KO.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;jR((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=KO.gradients(t,e,null,!0),a=s.value,u=s.grads;jR(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),jR(0===a.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:a,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&GN(this.iterations_)},e.prototype.saveIterations=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:pD(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(TU);Object.defineProperty(PU,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var MU=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=KO.backend.epsilon()),i}return kR(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=KO.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:HN((function(){return ED(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:HN((function(){return ED(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable,a=e.accumulatedUpdates[r].variable;HN((function(){var t=s.mul(e.rho).add(o.square().mul(1-e.rho)),n=a.add(e.epsilon).sqrt().div(s.add(e.epsilon).sqrt()).mul(o),r=a.mul(e.rho).add(n.square().mul(1-e.rho));s.assign(t),a.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(GN(this.accumulatedGrads.map((function(t){return t.variable}))),GN(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="AdadeltaOptimizer",e}(PU);RU(MU);var FU=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return kR(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=KO.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:HN((function(){return _D(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable;HN((function(){var t=s.add(o.square());s.assign(t);var n=o.div(t.add(KO.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&GN(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(PU);RU(FU);var LU=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],HN((function(){o.accBeta1=pD(n).variable(),o.accBeta2=pD(r).variable()})),null==i&&(o.epsilon=KO.backend.epsilon()),o}return kR(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);HN((function(){var r=kj(1,e.accBeta1),i=kj(1,e.accBeta2);n.forEach((function(n,o){var s=KO.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:HN((function(){return ED(s).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:HN((function(){return ED(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedSecondMoment[o].variable,l=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=c.mul(e.beta2).add(a.square().mul(1-e.beta2)),d=l.div(r),f=h.div(i);u.assign(l),c.assign(h);var p=d.div(f.sqrt().add(e.epsilon)).mul(-e.learningRate).add(s);s.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&GN(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&GN(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){var e,n=this;return RR(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),HN((function(){n.accBeta1.assign(Cj(n.beta1,n.iterations_+1)),n.accBeta2.assign(Cj(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(PU);RU(LU);var BU=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var s=t.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=r,s.epsilon=i,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],HN((function(){s.iteration=pD(0).variable(),s.accBeta1=pD(n).variable()})),null==i&&(s.epsilon=KO.backend.epsilon()),s}return kR(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);HN((function(){var r=kj(1,e.accBeta1),i=dj(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var s=KO.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:ED(s).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:ED(s).variable(!1)});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedWeightedInfNorm[o].variable,l=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=c.mul(e.beta2),d=a.abs(),f=h.maximum(d);u.assign(l),c.assign(f);var p=i.div(r).mul(l.div(f.add(e.epsilon))).add(s);s.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&GN(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&GN(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(PU);RU(BU);var jU=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return kR(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=KO.registeredVariables[n];HN((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function(t){return KO.keep(t)}(pD(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(PU);RU(jU);var VU=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=pD(i.momentum),i}return kR(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=KO.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:HN((function(){return ED(i).variable(!1)}))});var o=e.accumulations[r].variable,s=Array.isArray(t)?t[r].tensor:t[n];null!=s&&HN((function(){var t,n=e.m.mul(o).add(s);t=e.useNesterov?e.c.mul(s.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&GN(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){return RR(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){return RR(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="MomentumOptimizer",e}(jU);RU(VU);var UU=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var s=t.call(this)||this;return s.learningRate=e,s.decay=n,s.momentum=r,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,null==i&&(s.epsilon=KO.backend.epsilon()),s}return kR(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=KO.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:HN((function(){return ED(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:HN((function(){return ED(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:HN((function(){return ED(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,a=e.accumulatedMoments[r].variable;HN((function(){var t=s.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),c=a.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));s.assign(t),n.assign(u),a.assign(c);var l=i.sub(c);i.assign(l)}else{var h=s.mul(e.decay).add(o.square().mul(1-e.decay));c=a.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),s.assign(h),a.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&GN(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&GN(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&GN(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return AR(this,void 0,void 0,(function(){var t;return RR(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return AR(this,void 0,void 0,(function(){var e;return RR(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(PU);RU(UU),function(){function t(){}t.sgd=function(t){return new jU(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new VU(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new UU(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new LU(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new MU(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new BU(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new FU(t,e)}}(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate,AO=PV;var zU=function(t,e){return(zU=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function WU(t,e){function n(){this.constructor=t}zU(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function qU(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function HU(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var GU=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=$U(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function $U(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}var KU=null;function XU(t){KU=t}function YU(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function QU(t,e,n){return Math.max(t,Math.min(e,n))}function JU(t){return t%2==0?t:t+1}function ZU(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function tz(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function ez(t,e,n){void 0===n&&(n=""),tz(oz(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function nz(t){tz(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function rz(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||bz(t)&&!n)for(var r=0;r<t.length;++r)rz(t[r],e,n);else e.push(t);return e}function iz(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function oz(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function sz(t){return t%1==0}function az(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function uz(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function cz(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function lz(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0,s=function(){if(t())r();else{var a=e(++o);null!=n&&o>=n?i():setTimeout(s,a)}};s()}))}function hz(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function dz(t,e){var n=e.length;return tz((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),tz(t.every((function(t){return sz(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function fz(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:dz(e,t).sort(),s=0,a=0;a<t.length;++a){if(null!=o){if(o[s]===a&&1!==t[a])throw new Error("Can't squeeze axis "+a+" since its dim '"+t[a]+"' is not 1");(null==o[s]||o[s]>a)&&1===t[a]&&(n.push(t[a]),r.push(a)),o[s]<=a&&s++}1!==t[a]&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function pz(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function mz(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function gz(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function vz(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function yz(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function bz(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function wz(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function _z(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function xz(t){return"string"==typeof t||t instanceof String}function Cz(t){return"boolean"==typeof t}function Ez(t){return"number"==typeof t}function Sz(t){return Array.isArray(t)?Sz(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":Ez(t)?"float32":xz(t)?"string":Cz(t)?"bool":"float32"}function Iz(t){return!!(t&&t.constructor&&t.call&&t.apply)}function kz(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Tz(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Az(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=rz(t)),n&&gz(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function Rz(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],s=0;s<o;s++)i[s]=r[e+s];else{o=n[0];var a=n.slice(1),u=a.reduce((function(t,e){return t*e}));for(s=0;s<o;s++)i[s]=t(e+s*u,a,r)}return i}(0,t,e)}function Oz(t,e){for(var n=Nz(t,e),r=0;r<n.length;r++)n[r]=1;return n}function Nz(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Dz(){return KU.platform.now()}function Pz(t){t.forEach((function(e){tz(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function Mz(t,e){return void 0===e&&(e="utf-8"),KU.platform.encode(t,e=e||"utf-8")}function Fz(t,e){return void 0===e&&(e="utf-8"),KU.platform.decode(t,e=e||"utf-8")}Object.freeze({Environment:GU,getQueryParams:$U,get ENV(){return KU},setEnvironmentGlobal:XU}),Object.freeze({shuffle:YU,clamp:QU,nearestLargerEven:JU,sum:ZU,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:tz,assertShapesMatch:ez,assertNonNull:nz,flatten:rz,sizeFromShape:iz,isScalarShape:function(t){return 0===t.length},arraysEqual:oz,isInt:sz,tanh:az,sizeToSquarishShape:uz,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return YU(e),e},rightPad:cz,repeatedTry:lz,inferFromImplicitShape:hz,parseAxisParam:dz,squeezeShape:fz,getTypedArrayFromDType:pz,getArrayFromDType:mz,checkConversionForErrors:gz,isValidDtype:vz,hasEncodingLoss:yz,isTypedArray:bz,bytesPerElement:wz,bytesFromStringArray:_z,isString:xz,isBoolean:Cz,isNumber:Ez,inferDtype:Sz,isFunction:Iz,nearestDivisor:kz,computeStrides:Tz,toTypedArray:Az,toNestedArray:Rz,makeOnesTypedArray:Oz,makeZerosTypedArray:Nz,now:Dz,assertNonNegativeIntegerDimensions:Pz,fetch:function(t,e){return KU.platform.fetch(t,e)},encodeString:Mz,decodeString:Fz});var Lz=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Bz)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,o=this.backendTimer.time((function(){r=n()}));return(Array.isArray(r)?r:[r]).forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),o.then((function(o){var s="";null!=o.getExtraProfileInfo&&(s=o.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,o.kernelMs,e,s)}))}))})),r},t}(),Bz=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,o){var s=cz(r+"ms",9),a=cz(t,25),u=e.rank,c=e.size,l=cz(e.shape.toString(),14),h="";for(var d in i){var f=i[d].shape,p=f.length;h+=d+": "+p+"D "+(p>0?f:"")+" "}console.log("%c"+a+"\t%c"+s+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+h+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function jz(t,e,n){return cz(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":xz(t)?"'"+t+"'":"bool"===n?Vz(t):parseFloat(t.toFixed(7)).toString(),e)}function Vz(t){return 0===t?"false":"true"}function Uz(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var zz=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=iz(t),null!=n){var i=n.length;tz(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||mz(e,this.size),this.strides=Tz(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),tz(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}n++}for(var a=t[t.length-1],u=0;u<t.length-1;++u)a+=this.strides[u]*t[u];return this.values[a]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return Gz.make(this.shape,{values:this.values},this.dtype)},t}(),Wz=null,qz=null,Hz=null,Gz=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=iz(t),this.strides=Tz(t),this.dataId=null!=r?r:{},this.id=Wz().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",Wz().registerTensor(this,i),null!=n&&Wz().write(i,this.dataId,n)}return t.make=function(e,n,r,i){var o=n.values;return null!=n.values&&"string"===r&&xz(n.values[0])&&(o=n.values.map((function(t){return Mz(t)}))),new t(e,r,o,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),tz(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),qz.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,qz.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return qz.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Rz(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return Rz(this.shape,this.dataSync())},t.prototype.data=function(){return qU(this,void 0,void 0,(function(){var t,e;return HU(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Wz().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return Fz(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=Wz().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return Fz(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Wz().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(Wz().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),qz.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),qz.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),qz.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),qz.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),qz.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),qz.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),qz.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=Tz(e),o=function(t,e,n,r){var i=iz(e),o=r[r.length-1],s=new Array(o).fill(0),a=e.length,u="complex64"===n?Uz(t):t;if(a>1)for(var c=0;c<i/o;c++)for(var l=c*o,h=0;h<o;h++)s[h]=Math.max(s[h],jz(u[l+h],0,n).length);return s}(t,e,n,i),s=e.length,a=function t(e,n,r,i,o,s){void 0===s&&(s=!0);var a="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[jz(Uz(e)[0],0,r)]:"bool"===r?[Vz(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=Array.from(e.slice(0,3*a)),h=Array.from(e.slice(u-3*a,u));return"complex64"===r&&(l=Uz(l),h=Uz(h)),["["+l.map((function(t,e){return jz(t,o[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return jz(t,o[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?Uz(e):Array.from(e)).map((function(t,e){return jz(t,o[e],r)})).join(", ")+"]"]}var d=n.slice(1),f=i.slice(1),p=i[0]*a,m=[];if(u>20){for(var g=0;g<3;g++)m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,!1));for(m.push("..."),g=u-3;g<u;g++)m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,g===u-1))}else for(g=0;g<u;g++){var v;m.push.apply(m,t(e.slice(v=g*p,v+p),d,r,f,o,g===u-1))}var y=2===c?",":"";for(m[0]="["+m[0]+y,g=1;g<m.length-1;g++)m[g]=" "+m[g]+y;var b=",\n";for(g=2;g<c;g++)b+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(s?"":b),m}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),qz.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),qz.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),qz.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),qz.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),qz.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),qz.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),qz.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),qz.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),qz.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),qz.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),qz.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),qz.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),Hz("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),qz.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),qz.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),qz.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),qz.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),qz.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),qz.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),qz.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),qz.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),qz.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),qz.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),qz.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),qz.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),qz.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),qz.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),qz.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),qz.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),qz.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),qz.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),qz.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),qz.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),qz.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),qz.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),qz.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),qz.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),qz.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),qz.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),qz.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),qz.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),qz.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),qz.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),qz.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),qz.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),qz.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),qz.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),qz.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),qz.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),qz.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),qz.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),qz.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),qz.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),qz.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),qz.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),qz.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),qz.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),qz.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),qz.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),qz.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),qz.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),qz.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),qz.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),qz.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),qz.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),qz.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),qz.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),qz.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),qz.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),qz.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),qz.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),qz.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),qz.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),qz.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),qz.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),qz.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),qz.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),qz.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),qz.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),qz.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),qz.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),qz.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),qz.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),qz.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),qz.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),qz.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),qz.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),qz.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),qz.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),qz.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),qz.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),qz.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),qz.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),qz.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),qz.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),qz.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),qz.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),qz.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),qz.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),qz.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),qz.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),qz.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),qz.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),qz.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),qz.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),qz.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),qz.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),qz.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),qz.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),qz.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),qz.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),Jz.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),qz.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),qz.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),qz.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),qz.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),this.throwIfDisposed(),qz.stridedSlice(this,t,e,n,r,i,o,s,a)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),qz.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),qz.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),qz.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),qz.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),qz.spectral.irfft(this)},t}();Object.defineProperty(Gz,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var $z,Kz,Xz,Yz,Qz,Jz=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=Wz().nextVariableId().toString());try{Wz().registerVariable(i)}catch(t){throw Wz().disposeTensor(i),t}return i}return WU(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!oz(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");Wz().disposeTensor(this),this.dataId=t.dataId,Wz().registerTensor(this)},e.prototype.dispose=function(){Wz().disposeVariable(this),this.isDisposedInternal=!0},e}(Gz);Object.defineProperty(Jz,Symbol.hasInstance,{value:function(t){return t instanceof Gz&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}($z||($z={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Kz||(Kz={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Xz||(Xz={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Yz||(Yz={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Qz||(Qz={}));var Zz={float32:Yz,int32:Kz,bool:Xz,complex64:Qz};function tW(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return Zz[t][e]}function eW(t){return tW(t,"int32")}function nW(t,e){if(t.dtype===e.dtype)return[t,e];var n=tW(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function rW(t,e){tz(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function iW(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof Gz)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var s in o){var a=o[s];r.has(a)||(r.add(a),t(a,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:nW,assertTypesMatch:rW,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:iW});var oW,sW=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),aW=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new sW}return t.prototype.ready=function(){return qU(this,void 0,void 0,(function(){var t,e,n;return HU(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return qU(this,void 0,void 0,(function(){var e,n,r;return HU(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new Lz(this.backendInstance),[2,!0]}}))}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=Gz.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,(function(t){return[t.toFloat()]})),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],s=this.isTapeOn(),a=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){s&&(o=t.map((function(t){return i.keep(i.clone(t))})))},c=this.state.numBytes,l=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(a,e,(function(){return t(i.backend,u)})):t(i.backend,u)})),s){var h={id:this.state.nextTapeNodeId++,name:a,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShape:Array.isArray(r)?r.map((function(t){return t.shape})):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*wz(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Jz||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return qU(this,void 0,void 0,(function(){var e,n;return HU(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach((function(t,e){r[e]=t}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=iW(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==s.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),tz(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));tz(o instanceof Gz,(function(){return"The result y returned by f() must be a tensor."}));var s=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var s=(p=t[o]).inputs;for(var a in s){for(var u=s[a],c=!1,l=0;l<e.length;l++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var d={};for(o=t.length-1;o>=0;o--)for(s=(p=t[o]).inputs,l=0;l<p.outputs.length;l++)if(h[p.outputs[l].id]){for(var a in s)h[s[a].id]=!0,d[p.id]=!0;break}var f=[];for(o=0;o<t.length;o++){var p;if(i[(p=t[o]).id]&&d[p.id]){var m={};for(var a in p.inputs){var g=p.inputs[a];r[g.id]&&(m[a]=g)}var v=Object.assign({},p);v.inputs=m,v.outputs=p.outputs,f.push(v)}}return f}(this.state.activeTape,e,o);if(!r&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,a={};a[o.id]=null==n?(r=Oz(iz(t=o.shape),"float32"),Gz.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=Gz.make(e.shape,{values:Nz(e.size,e.dtype)},e.dtype);o.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var s=i.gradient(1===i.outputs.length?o[0]:o),a=function(e){if(!(e in s))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(s)+".");var r=n((function(){return s[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!oz(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var a=t[o.id];t[o.id]=a.add(r),a.dispose()}};for(var u in i.inputs)a(u)},i=e.length-1;i>=0;i--)r(i)}(a,s,(function(t){return i.tidy(t)}));var u=e.map((function(t){return a[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return tz(Iz(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];tz(r.every((function(t){return t instanceof Gz})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernel((function(e,i){return tz((n=t.apply(void 0,r.concat([i]))).value instanceof Gz,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),tz(Iz(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];tz(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),tz(o.every((function(t){return t instanceof Gz})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var s={};return o.forEach((function(t,e){s[e]=function(){return t}})),s}))}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=_z(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return qU(this,void 0,void 0,(function(){var e,n;return HU(this,(function(r){switch(r.label){case 0:return e=Dz(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=Dz()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new sW,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),uW=function(){var t=function(){if(null==oW){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}oW=t}return oW}();if(null==t._tfengine){var e=new GU(t);t._tfengine=new aW(e)}return XU(t._tfengine.ENV),Wz=function(){return t._tfengine},t._tfengine}();function cW(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}KU.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),KU.registerFlag("IS_BROWSER",(function(){return cW()})),KU.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),KU.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),KU.registerFlag("PROD",(function(){return!1})),KU.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return KU.getBool("DEBUG")})),KU.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),KU.registerFlag("IS_TEST",(function(){return!1}));var lW,hW,dW={},fW={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function pW(t,e){dW[t]=e}function mW(t){t in dW||(dW[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=gW(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete dW[t]}),!1),1===t?e.getContext("webgl",fW)||e.getContext("experimental-webgl",fW):e.getContext("webgl2",fW)}(t));var e=dW[t];return e.isContextLost()?(delete dW[t],mW(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),dW[t])}function gW(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function vW(t,e){return[e,t]}function yW(t){var e=iz(t);return uz(Math.ceil(e/4))}function bW(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function wW(t,e){var n,r,i,o,s,a,u,c,l,h=t;return 2===KU.getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,o=h.RGBA32F,s=h.RED,a=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=h.RGBA,s=t.RGBA,a=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function _W(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+CW(t,e))}(t),r}function xW(t){return!!(KU.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function CW(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function EW(t,e,n){return $W(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function SW(t,e,n){var r=$W(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(_W(t,e,(function(){return t.shaderSource(r,n)})),_W(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function IW(t,e,n){var r=$W(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(_W(t,e,(function(){return t.shaderSource(r,n)})),_W(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=AW.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,s=i.map((function(t,e){return cz((e+1).toString(),o)+t})),a=0,u=0;u<s.length;u++)a=Math.max(s[u].length,a);var c=s.slice(0,r-1),l=s.slice(r-1,r),h=s.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+cz(l[0],a),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(lW||(lW={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(hW||(hW={}));var kW,TW,AW=/ERROR: [0-9]+:([0-9]+):/g;function RW(t,e){return $W(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function OW(t,e,n){if(_W(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function NW(t,e,n){if(_W(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function DW(t,e,n){var r=$W(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return _W(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),_W(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function PW(t,e,n){var r=$W(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return _W(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),_W(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function MW(t,e){return $W(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function FW(t,e){var n=KU.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function LW(t,e){return $W(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function BW(t,e,n,r,i,o,s,a){var u=t.getAttribLocation(n,r);return-1!==u&&(_W(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),_W(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,s,a)})),_W(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function jW(t,e,n,r){KW(t,r),_W(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function VW(t,e,n,r){return $W(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function UW(t,e,n){return t.getUniformLocation(e,n)}function zW(t,e,n,r,i,o){_W(t,e,(function(){return jW(t,e,r,o)})),_W(t,e,(function(){return t.uniform1i(i,o)}))}function WW(t,e,n,r){_W(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),_W(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function qW(t,e,n){_W(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),_W(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function HW(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+GW(t,e))}function GW(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function $W(t,e,n,r){var i=_W(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function KW(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function XW(t,e){return void 0===e&&(e=2),iz(t.slice(0,t.length-e))}function YW(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function QW(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[XW(t)].concat(YW(t))),e}function JW(t,e){var n;void 0===e&&(e=!1);var r=KU.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?JU(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=fz(t);t=i.newShape}var o=iz(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var s=XW(t),a=2,u=2;return t.length&&(a=(n=YW(t))[0],u=n[1]),uz(o=s*(a/2)*(u/2)).map((function(t){return 2*t}))}return uz(o)}function ZW(t){return t%2==0}function tq(t,e){if(oz(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(ZW(n)&&ZW(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&ZW(t[0])&&ZW(e[0])}function eq(t){if(null==kW){var e=mW(t);kW=e.getParameter(e.MAX_TEXTURE_SIZE)}return kW}function nq(t){if(null==TW){var e=mW(t);TW=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,TW)}function rq(t){if(0===t)return 0;var e=mW(t);return iq(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:iq(e,"EXT_disjoint_timer_query")?1:0}function iq(t,e){return null!=t.getExtension(e)}function oq(t){try{if(null!=mW(t))return!0}catch(t){return!1}return!1}function sq(t){if(0===t)return!1;var e=mW(t);if(1===t){if(!iq(e,"OES_texture_float"))return!1}else if(!iq(e,"EXT_color_buffer_float"))return!1;return uq(e)}function aq(t){if(0===t)return!1;var e=mW(t);if(1!==t){if(iq(e,"EXT_color_buffer_float"))return uq(e);if(iq(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=wW(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),o}(e,n)}return!1}return!!iq(e,"OES_texture_float")&&!!iq(e,"WEBGL_color_buffer_float")&&uq(e)}function uq(t){var e=wW(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function cq(t){return 2===t&&null!=mW(t).fenceSync}var lq=Object.freeze({callAndCheck:_W,canBeRepresented:xW,getWebGLErrorMessage:CW,getExtensionOrThrow:EW,createVertexShader:SW,createFragmentShader:IW,createProgram:RW,linkProgram:OW,validateProgram:NW,createStaticVertexBuffer:DW,createStaticIndexBuffer:PW,getNumChannels:function(){return 2===KU.getNumber("WEBGL_VERSION")?1:4},createTexture:MW,validateTextureSize:FW,createFramebuffer:LW,bindVertexBufferToProgramAttribute:BW,bindTextureUnit:jW,unbindTextureUnit:function(t,e,n){KW(t,n),_W(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:VW,getProgramUniformLocation:UW,bindTextureToProgramUniformSampler:zW,bindCanvasToFramebuffer:function(t,e){_W(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),_W(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),_W(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:WW,unbindColorTextureFromFramebuffer:qW,validateFramebuffer:HW,getFramebufferErrorMessage:GW,getBatchDim:XW,getRowsCols:YW,getShapeAs3D:QW,getTextureShapeFromLogicalShape:JW,isReshapeFree:tq,getWebGLMaxTextureSize:eq,resetMaxTextureSize:function(){kW=null},resetMaxTexturesInShader:function(){TW=null},getMaxTexturesInShader:nq,getWebGLDisjointQueryTimerVersion:rq,hasExtension:iq,isWebGLVersionEnabled:oq,isCapableOfRenderingToFloatTexture:sq,isDownloadFloatTextureEnabled:aq,isWebGLFenceEnabled:cq});function hq(t){KU.getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function dq(t,e){return uW.tidy(t,e)}function fq(t){iW(t).forEach((function(t){return t.dispose()}))}function pq(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];KU.getBool("IS_TEST")||console.warn.apply(console,t)}function mq(t,e){var n=t;if(bz(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||bz(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&KU.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||bz(e)){tz(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),tz(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else tz(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function gq(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function vq(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof Gz)return gq(r,t.dtype,e,n),t;var i=Sz(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),gq(r,i,e,n),null==t||!bz(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=mq(t,i);bz(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?Az(t,i,KU.getBool("DEBUG")):rz(t,[],!0);return Gz.make(o,{values:s},i)}function yq(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return vq(t,e+"["+r+"]",n)}),r)}function bq(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function wq(t,e,n){for(var r=t.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)-1===n.indexOf(a)?i.push(t[o++]):i.push(e[s++]);return i}function _q(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function xq(t,e){return wq(t,e.map((function(t){return 1})),e)}function Cq(t,e,n){tz(bq(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function Eq(t,e){if(bq(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function Sq(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function Iq(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function kq(t,e){var n=t[0].length;t.forEach((function(t,e){tz(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),tz(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)tz(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function Tq(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function Aq(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];uW.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),uW.endScope(i),i}catch(t){throw uW.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}KU.registerFlag("HAS_WEBGL",(function(){return KU.getNumber("WEBGL_VERSION")>0})),KU.registerFlag("WEBGL_VERSION",(function(){return oq(2)?2:oq(1)?1:0})),KU.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===KU.get("WEBGL_VERSION")})),KU.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),KU.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),KU.registerFlag("WEBGL_PACK",(function(){return KU.getBool("HAS_WEBGL")})),KU.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_CLIP",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),KU.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_PACK_REDUCE",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_CONV_IM2COL",(function(){return KU.getBool("WEBGL_PACK")})),KU.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return eq(KU.getNumber("WEBGL_VERSION"))})),KU.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return nq(KU.getNumber("WEBGL_VERSION"))})),KU.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=KU.getNumber("WEBGL_VERSION");return 0===t?0:rq(t)})),KU.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),KU.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return sq(KU.getNumber("WEBGL_VERSION"))})),KU.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!KU.getBool("WEBGL_FORCE_F16_TEXTURES")&&KU.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),KU.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return aq(KU.getNumber("WEBGL_VERSION"))})),KU.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return cq(KU.getNumber("WEBGL_VERSION"))})),KU.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return KU.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Hz=hq;var Rq=Aq({complex_:function(t,e){var n=vq(t,"real","complex"),r=vq(e,"imag","complex");return ez(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),uW.runKernel((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),Oq=Aq({real_:function(t){var e=vq(t,"input","real");return uW.runKernel((function(t){return t.real(e)}),{$input:e})}}),Nq=Aq({imag_:function(t){var e=vq(t,"input","imag");return uW.runKernel((function(t){return t.imag(e)}),{$input:e})}});function Dq(t,e,n){return Pq(t,e,mq(t,n),n)}function Pq(t,e,n,r){if(null==r&&(r=Sz(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!bz(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Pz(e);var i=iz(e),o=iz(n);tz(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var s=0;s<n.length;++s){var a=s!==n.length-1||n[s]!==iz(e.slice(s));tz(n[s]===e[s]||!a,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return bz(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Az(t,r,KU.getBool("DEBUG")):rz(t,[],!0),Gz.make(e,{values:t},r)}function Mq(t,e){if((bz(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&bz(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Pq(t,[],[],e)}function Fq(t,e){nz(t);var n=mq(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Pq(t,null,n,e)}function Lq(t,e,n){if(nz(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=mq(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Pq(t,e,r,n)}function Bq(t,e,n){if(nz(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=mq(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Pq(t,e,r,n)}function jq(t,e,n){if(nz(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=mq(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Pq(t,e,r,n)}function Vq(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Vq(t,"float32"),r=Uq(t,"float32");return Rq(n,r)}var i=Oz(iz(t),e);return Gz.make(t,{values:i},e)}function Uq(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Uq(t,"float32"),r=Uq(t,"float32");return Rq(n,r)}var i=Nz(iz(t),e);return Gz.make(t,{values:i},e)}function zq(t,e,n){return uW.runKernel((function(r){return r.fill(t,e,n)}),{})}function Wq(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Uq([0],r);var i=Nz(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return Fq(i,r)}var qq=Aq({onesLike_:function(t){var e=vq(t,"x","onesLike");if("complex64"===e.dtype){var n=qq(Oq(e)),r=Hq(Nq(e));return Rq(n,r)}return uW.runKernel((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Hq(t)}}}))}}),Hq=Aq({zerosLike_:function(t){var e=vq(t,"x","zerosLike");return uW.runKernel((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Hq(t)}}}))}}),Gq=Aq({concat_:function(t,e){void 0===e&&(e=0),tz(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=yq(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=dz(e,n[0].shape)[0];var r=Tq(n.map((function(t){return t.shape})),e);if(0===iz(r))return Dq([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return kq(i,e),uW.runKernel((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return Qq(t,n,e).map((function(t){return function(){return t}}))}))}}),$q=Aq({concat1d_:function(t){return Gq(t,0)}}),Kq=Aq({concat2d_:function(t,e){return Gq(t,e)}}),Xq=Aq({concat3d_:function(t,e){return Gq(t,e)}}),Yq=Aq({concat4d_:function(t,e){return Gq(t,e)}}),Qq=Aq({split_:function(t,e,n){void 0===n&&(n=0);var r,i=vq(t,"x","split");return n=dz(n,i.shape)[0],"number"==typeof e?(tz(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(tz(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),uW.runKernel((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return Gq(t,n)}}}))}});function Jq(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Zq=Jq((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.alea=o}(0,t)})),tH=Jq((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor128=o}(0,t)})),eH=Jq((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)})),nH=Jq((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)})),rH=Jq((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=a[127&o]^=r+(s=s+1640531527|0))?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,a[i]=(r^=r>>>15)^(n^=n>>>12);t.w=s,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)})),iH=Jq((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.tychei=o}(0,t)})),oH=Jq((function(t){!function(e,r){var i,o=this,s=256,a="random",u=r.pow(s,6),c=r.pow(2,52),l=2*c,h=255;function d(t,n,h){var d=[],v=m(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(o.crypto||o.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,g(e)]}}():t,3),d),y=new f(d),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*s,e*=s,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(g(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&p(i,y),t.state=function(){return p(y,{})}),n?(r[a]=t,e):t})(b,v,"global"in n?n.global:this==r,n.state)}function f(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=h&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=h&i+1],n=n*s+a[h&(a[i]=a[o=h&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(s)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(r["seed"+a]=d,m(r.random(),e),t.exports){t.exports=d;try{i=n(4)}catch(t){}}}([],Math)}));oH.alea=Zq,oH.xor128=tH,oH.xorwow=eH,oH.xorshift7=nH,oH.xor4096=rH,oH.tychei=iH;var sH=oH.alea,aH=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=sH(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,s=void 0;do{s=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(s>=1||0===s);var a=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*o*a,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),uH=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=sH(i.toString()),this.randn=new aH(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-(o*=o*o)+Math.log(o)),(i=this.randu())<e||Math.log(i)<n)break}return o*=1/this.beta*this.d,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),cH=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=sH(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function lH(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",Pz(t),new zz(t,e,n)}var hH=Aq({batchToSpaceND_:function(t,e,n){var r=vq(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return tz(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),tz(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),tz(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),uW.runKernel((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),dH=Aq({cast_:function(t,e){var n=vq(t,"x","cast");if(!vz(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return uW.runKernel((function(t){return t.cast(n,e)}),{$x:n},(function(t){return{$x:function(){return t.clone()}}}))}}),fH=Aq({clone_:function(t){var e=vq(t,"x","clone",null);return uW.runKernel((function(t){return Gz.make(e.shape,{dataId:e.dataId},e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),pH=Aq({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=vq(t,"x","cumsum"),o=Eq([e|=0],i.rank),s=i;null!=o&&(s=i.transpose(o));var a=Iq(1,i.rank)[0],u=uW.runKernel((function(t){return t.cumsum(s,a,n,r)}),{permutedX:s},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),mH=Aq({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=vq(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];return tz(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),tz(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),tz(s%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape})),uW.runKernel((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),gH=Aq({expandDims_:function(t,e){void 0===e&&(e=0);var n=vq(t,"x","expandDims",null);tz(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(tz(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),AH(n,r)}}),vH=Aq({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=lH([t,e],r),o=t<=e?t:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(t,e);if(null==n)return a;if(1===n.length)return DH(gH(a,0),[n[0],1,1]);if(2===n.length)return DH(gH(gH(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return DH(gH(gH(gH(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),yH=Aq({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=vq(t,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);n=n||Math.random();var a=1===s?i.as2D(1,-1):i,u=uW.runKernel((function(t){return t.multinomial(a,r,e,n)}),{logits2D:a});return 1===s?u.as1D():u}}),bH=Aq({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=vq(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),uW.runKernel((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return Uq(i.shape,"float32")}}})).reshape(o)}}),wH=Aq({pad_:function(t,e,n){void 0===n&&(n=0);var r=vq(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map((function(t){return t[0]}));return uW.runKernel((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(i,r.shape)}}}))}}),_H=Aq({pad1d_:function(t,e,n){return void 0===n&&(n=0),tz(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),wH(t,[e],n)}}),xH=Aq({pad2d_:function(t,e,n){return void 0===n&&(n=0),tz(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wH(t,e,n)}}),CH=Aq({pad3d_:function(t,e,n){return void 0===n&&(n=0),tz(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wH(t,e,n)}}),EH=Aq({pad4d_:function(t,e,n){return void 0===n&&(n=0),tz(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wH(t,e,n)}}),SH=Aq({rand_:function(t,e,n){var r=iz(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return Gz.make(t,{values:i},n)}}),IH=Aq({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new aH(e,n,r,!1,i),s=lH(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),kH=Aq({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var o=new uH(e,n,r,i),s=lH(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),TH=Aq({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=lH(t,r),s=new cH(e,n,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),AH=Aq({reshape_:function(t,e){var n=vq(t,"x","reshape",null);return e=hz(e,n.size),tz(n.size===iz(e),(function(){return"new shape and old shape must have the same number of elements."})),uW.runKernel((function(t){return t.reshape(n,e)}),{$x:n},(function(t){return{$x:function(){return t.reshape(n.shape)}}}))}}),RH=Aq({spaceToBatchND_:function(t,e,n){var r=vq(t,"x","spaceToBatchND");return tz(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),tz(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),tz(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),uW.runKernel((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),OH=Aq({squeeze_:function(t,e){var n=vq(t,"x","squeeze");return AH(n,fz(n.shape,e).newShape)}}),NH=Aq({stack_:function(t,e){void 0===e&&(e=0);var n=yq(t,"tensors","stack");if(tz(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;tz(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){ez(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){tz(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return Gq(o,e)}}),DH=Aq({tile_:function(t,e){var n=vq(t,"x","tile",null);return tz(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),uW.runKernel((function(t,r){var i=t.tile(n,e);return r([n]),i}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=Hq(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var s=0;s<e[2];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(s=0;s<e[2];++s)for(var a=0;a<e[3];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2],a*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),PH=Aq({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new aH(e,n,r,!0,i),s=lH(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),MH=Aq({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=vq(t,"x","unstack");return tz(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),uW.runKernel((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return NH(t,e)}}}))}});function FH(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([t[s+1]/e[s],e[s]]);i=i.concat(t.slice(o+1))}return i}function LH(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function BH(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function jH(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function VH(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function UH(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var s=t.shape,a=n.slice();a.pop();var u=1;for(o=r;o<t.rank;++o)u*=s[o],a.push(s[o]);var c=Tz(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[a,i,u,c]}function zH(t){return t<=30?t:kz(t,Math.floor(Math.sqrt(t)))}function WH(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,s=r;s<i;++s)o*=n[s];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:Tz(n.slice(0,r)).concat([1]),outputSize:iz(n)}}function qH(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function HH(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function GH(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),QU(0,o,s-1)}function $H(t,e,n,r,i){var o=e[i],s=n[i]||1;(t&1<<i||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),s>0?QU(0,o,a):QU(-1,o,a-1)}function KH(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function XH(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function YH(t){return uW.customGrad(t)}var QH=Aq({softmax_:function(t,e){void 0===e&&(e=-1);var n=vq(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return YH((function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}}))(n)}}),JH=Aq({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=vq(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return YH((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),ZH=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}();function tG(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function eG(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function nG(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var s=e[e.length-i-1];if(null==s&&(s=1),1===o)n.unshift(s);else if(1===s)n.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function rG(t,e,n,r,i,o,s){void 0===s&&(s="channelsLast");var a,u=uG(e),c=u[0],l=u[1];if("channelsLast"===s)a=[c,l,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);a=[c,l,t[1],t[1]]}return oG(t,a,n,r,i,o,!1,s)}function iG(t,e,n,r,i,o,s){void 0===s&&(s="NDHWC");var a,u,c=cG(e),l=c[0],h=c[1],d=c[2];if("NDHWC"===s)u="channelsLast",a=[l,h,d,t[4],t[4]];else{if("NCDHW"!==s)throw new Error("Unknown dataFormat "+s);u="channelsFirst",a=[l,h,d,t[1],t[1]]}return sG(t,a,n,r,i,!1,u,o)}function oG(t,e,n,r,i,o,s,a){void 0===s&&(s=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],d=u[3];if("channelsLast"===a)c=t[0],l=t[1],h=t[2],d=t[3];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=t[0],d=t[1],l=t[2],h=t[3]}var f,p=e[0],m=e[1],g=e[3],v=uG(n),y=v[0],b=v[1],w=uG(r),_=w[0],x=w[1],C=lG(p,_),E=lG(m,x),S=function(t,e,n,r,i,o,s,a){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=aG(t,e,n));var o=t[1],s=hG((t[0]-e+2*r)/n+1,i);tz(sz(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var a=hG((o-e+2*r)/n+1,i);return tz(sz(a),(function(){return"The output # of columns ("+a+") must be an integer. Change the stride and/or zero pad parameters"})),[s,a]}([e,n],o,r,t,a);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var d=Math.max(0,(c-1)*r+o-e),f=Math.max(0,(l-1)*i+s-n),p=Math.floor(d/2),m=d-p,g=Math.floor(f/2);u={top:p,bottom:m,left:g,right:f-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),l=Math.ceil((n-s+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,b,C,E,o),I=S.outHeight,k=S.outWidth,T=s?g*d:g;return"channelsFirst"===a?f=[c,T,I,k]:"channelsLast"===a&&(f=[c,I,k,T]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:h,inChannels:d,outHeight:I,outWidth:k,outChannels:T,padInfo:S.padInfo,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:C,effectiveFilterWidth:E,dilationHeight:_,dilationWidth:x,inShape:t,outShape:f,filterShape:e}}function sG(t,e,n,r,i,o,s,a){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],d=u[3],f=u[4];if("channelsLast"===s)c=t[0],l=t[1],h=t[2],d=t[3],f=t[4];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],h=t[3],d=t[4]}var p,m=e[0],g=e[1],v=e[2],y=e[4],b=cG(n),w=b[0],_=b[1],x=b[2],C=cG(r),E=C[0],S=C[1],I=C[2],k=lG(m,E),T=lG(g,S),A=lG(v,I),R=function(t,e,n,r,i,o,s,a,u,c,l){var h,d,f,p;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,i,o){null==i&&(i=aG(t,e,r));var s=t[1],a=t[2],u=hG((t[0]-e+2*i)/r+1,o);tz(sz(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=hG((s-e+2*i)/r+1,o);tz(sz(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=hG((a-e+2*i)/r+1,o);return tz(sz(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([e,n,r,1],a,0,i,t,l);d=m[0],f=m[1],p=m[2]}else if("same"===t){var g=((d=Math.ceil(e/i))-1)*i+a-e,v=((f=Math.ceil(n/o))-1)*o+u-n,y=((p=Math.ceil(r/s))-1)*s+c-r,b=Math.floor(g/2),w=g-b,_=Math.floor(v/2),x=v-_,C=Math.floor(y/2);h={top:_,bottom:x,left:C,right:y-C,front:b,back:w,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/i),f=Math.ceil((n-u+1)/o),p=Math.ceil((r-c+1)/s)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(i,l,h,d,w,_,x,k,T,A,a),O=R.outDepth,N=R.outHeight,D=R.outWidth,P=o?y*f:y;return"channelsFirst"===s?p=[c,P,O,N,D]:"channelsLast"===s&&(p=[c,O,N,D,P]),{batchSize:c,dataFormat:s,inDepth:l,inHeight:h,inWidth:d,inChannels:f,outDepth:O,outHeight:N,outWidth:D,outChannels:P,padInfo:R.padInfo,strideDepth:w,strideHeight:_,strideWidth:x,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:A,dilationDepth:E,dilationHeight:S,dilationWidth:I,inShape:t,outShape:p,filterShape:e}}function aG(t,e,n,r){void 0===r&&(r=1);var i=lG(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function uG(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function cG(t){return"number"==typeof t?[t,t,t]:t}function lG(t,e){return e<=1?t:t+(t-1)*(e-1)}function hG(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function dG(t){var e=uG(t);return 1===e[0]&&1===e[1]&&1===e[2]}function fG(t,e){return dG(t)||dG(e)}function pG(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function mG(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=Uq(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!yz(t.dtype,e))return Gz.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var s=n.real(t);return o=s.cast(e),s.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var a=Mq(0,t.dtype);return o=n.notEqual(t,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function gG(t,e){return Gz.make(e,{dataId:t.dataId},t.dtype)}function vG(t,e,n){var r=(e-t)/(n-1),i=Nz(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Fq(i,"float32")}function yG(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function bG(t,e){return{real:t[2*e],imag:t[2*e+1]}}function wG(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function _G(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function xG(t,e,n,r,i){for(var o=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),s=[],a=0;a<o.length;a++){var u=o[a],c=u.boxIndex;if(u.score<i)break;for(var l=!1,h=s.length-1;h>=0;--h)if(CG(t,c,s[h])>=r){l=!0;break}if(!l&&(s.push(c),s.length>=n))break}return Fq(s,"int32")}function CG(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(a-o)*(u-s),p=(h-c)*(d-l);if(f<=0||p<=0)return 0;var m=Math.max(o,c),g=Math.max(s,l),v=Math.min(a,h),y=Math.min(u,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(f+p-b)}function EG(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function SG(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=lH(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(t.rank),a=0;a<s.length;a++)s[a]=o[a]%t.shape[a];var u=t.locToIndex(s);i.values[r]=t.values[u]}return i.toTensor()}function IG(t,e,n,r,i){for(var o=e[e.length-1],s=[t.length/o,o],a=s[0],u=s[1],c=pz(n,a*r),l=pz("int32",a*r),h=0;h<a;h++){for(var d=h*u,f=t.subarray(d,d+u),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((function(t,e){return e.value-t.value}));var g=h*r,v=c.subarray(g,g+r),y=l.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var b=e.slice();return b[b.length-1]=r,[Dq(c,b,n),Dq(l,b,"int32")]}function kG(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=lH(t,"int32"),o=lH([n.length,t.length],"int32");for(r=0;r<n.length;r++){var s=i.indexToLoc(n[r]);o.values.set(s,r*t.length)}return o.toTensor()}!function(){function t(){}t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.fusedConv2d=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.avgPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPool3dBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPool3dBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.diag=function(t){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")}}(),Object.freeze({castTensor:mG,reshapeTensor:gG,linspaceImpl:vG,upcastType:tW,axesAreInnerMostDims:bq,combineLocations:wq,computeOutAndReduceShapes:_q,expandShapeToKeepDim:xq,assertAxesAreInnerMostDims:Cq,getAxesPermutation:Eq,getUndoAxesPermutation:Sq,getInnerMostAxes:Iq,getBroadcastDims:tG,getReductionAxes:eG,assertAndGetBroadcastShape:nG,assertParamsConsistent:kq,computeOutShape:Tq,computePool2DInfo:rG,computePool3DInfo:iG,computeConv2DInfo:oG,computeConv3DInfo:sG,computeDefaultPad:aG,tupleValuesAreOne:dG,eitherStridesOrDilationsAreOne:fG,convertConv2DDataFormat:pG});var TG=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},AG=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},RG=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function OG(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function NG(t,e){return 1===e?[t]:OG(t,e)}function DG(){var t,e,n,r,i,o,s,a,u,c;return 2===KU.getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 0. || val == 0.) ? false : true;\n      }\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:c}}function PG(t,e,n){void 0===n&&(n="index");var r=Tz(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function MG(t){var e=Tz(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var FG="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function LG(t){return"offset"+t}function BG(t){var e=t.name,n=iz(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function jG(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function VG(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function UG(t,e){return e.map((function(e){return t[e]})).join(", ")}var zG=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,tz(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,a=this.outputShape,u=a.length,c=jG(u),l=NG("coords",u);if(1===i){var h=jG(s=u+1);o="\n        "+h+" sourceLocR = "+h+"("+l.join()+", 0);\n        ++"+l[u-1]+";\n        "+h+" sourceLocG = "+h+"("+l.join()+", 0);\n        ++"+l[u-2]+";\n        "+h+" sourceLocA = "+h+"("+l.join()+", 0);\n        --"+l[u-1]+";\n        "+h+" sourceLocB = "+h+"("+l.join()+", 0);\n        --"+l[u-2]+";"}else s=u,o="\n        "+c+" sourceLocR = coords;\n        ++"+l[u-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+l[u-2]+";\n        "+c+" sourceLocA = coords;\n        --"+l[u-1]+";\n        "+c+" sourceLocB = coords;\n        --"+l[u-2]+";";var d=["x","y","z","w","u","v"].slice(0,s),f="."+d[s-1],p=d.map((function(t){return"int "+t})),m=NG("sourceLocR",s-1).concat("inIdx.r"),g=NG("sourceLocG",s-1).concat("inIdx.g"),v=NG("sourceLocB",s-1).concat("inIdx.b"),y=NG("sourceLocA",s-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+")));",_="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+v.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+y.join()+") : 0.)",x=r?"":"\n      float getBestIndicesAChannel("+p.join()+") {\n        return getChannel(getBestIndicesA("+d.join()+"),\n                                          vec2("+d.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+p.join()+") {\n        return getChannel(getA("+d.join()+"),\n                               vec2("+d.slice(-2).join()+"));\n      }\n      "+x+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+l[u-1]+" < "+(a[u-1]-1)+";\n        bool hasNextRow = "+l[u-2]+" < "+(a[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+f+", sourceLocG"+f+",\n          sourceLocB"+f+", sourceLocA"+f+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+_+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+_+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},WG=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},qG=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterDepth*t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n            wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},HG=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],nG(t,e),nG(t,n);var s="0.0";null!=r&&(nG(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";null!=i&&(nG(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+s+";\n        float scale = "+a+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},GG=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],nG(t,e),nG(t,n);var s="vec4(0.0)";null!=r&&(nG(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";null!=i&&(nG(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+s+";\n        vec4 scale = "+a+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},$G=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=nG(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},KG=function(t,e,n){this.variableNames=["A","B"],this.outputShape=nG(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},XG="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",YG=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=nG(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===iz(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+jG(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var s=NG("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+s[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+s[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},QG=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),JG=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),ZG=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},t$=function(t){this.outputShape=[],this.outputShape=Tq(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},e$=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=Tq(t,e);var n=this.outputShape,r=n.length,i=jG(r),o=NG("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var a=new Array(t.length-1);a[0]=t[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+t[u][e];var c=s[e],l="vec2("+s.slice(-2).join()+")",h=s.join(),d="if ("+c+" < "+a[0]+")\n          return getChannel(getT0("+h+"), "+l+");";for(u=1;u<a.length;u++)d+="\n        else if ("+c+" < "+a[u]+") {\n          "+c+" -= "+a[u-1]+";\n          return getChannel(getT"+u+"("+h+"), "+l+");\n        }";d+="\n        else {\n          "+c+" -= "+a[a.length-1]+";\n          return getChannel(getT"+a.length+"("+h+"), "+l+");\n        }",this.userCode="\n      float getValue("+s.map((function(t){return"int "+t}))+") {\n        "+d+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n        if (++"+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n        if (++"+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            --"+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "},n$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===t.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},r$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(r?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(r?1:2)+"], coords["+(r?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+r+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},i$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},o$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},s$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},a$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},u$=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,a=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,d=4*Math.floor(t.inChannels/4),f=t.inChannels%4,p="channelsLast"===t.dataFormat,m=p?1:2,g=p?2:3,v=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+s+", "+a+");\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+v+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+w+"\n        "+b+"\n        setOutput(result);\n      }\n    "},c$=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+s+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+a+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},l$=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+t.strideHeight+", "+t.strideWidth+");\n      const ivec2 pads = ivec2("+t.padInfo.top+", "+t.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+e+";\n        int q = d2 - d1 * "+e+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+t.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+t.dilationHeight+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+t.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+t.dilationWidth+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},h$=function(t){this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var e=t.inHeight,n=t.inWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,a=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,d="int xR; int xC; int xCOffset;",f=0;f<c;f++)for(var p=0;p<l;p++)d+="\n          vec4 xTexelR"+f+"C"+2*p+" = vec4(0.);\n          vec4 wR"+f+"C"+p+" = vec4(0.);\n          vec4 xR"+f+"C"+p+" = vec4(0.);";for(f=0;f<c;f++)for(var m=0;m<h;m++){if(d+="\n          xR = xRCorner + "+f*a+";\n          xC = xCCorner + "+(p=2*m)*u+";\n        ",1===s){if(p<l&&(d+=i%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+f+"C"+p+" = vec4(previous.zw, xTexelR"+f+"C"+p+".xy);\n                } else {\n                  xR"+f+"C"+p+" = vec4(0, 0, xTexelR"+f+"C"+p+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+e+" && xC >= 0 && xC < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = xTexelR"+f+"C"+p+";\n              ",p+1<l)){var g=i%2==0?JU(u):u;u%2==0&&i%2==1||u%2!=0&&i%2!=1?(d+="\n                  xCOffset = xC + "+i%2+" + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",u>1&&(d+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+e+" &&\n                      xCOffset >= 0 && xCOffset < "+n+") {\n                      xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+f+"C"+p+" = vec4(0.);\n                    }\n                  "),d+="\n                  xR"+f+"C"+(p+1)+" = vec4(\n                    xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".xy);\n                "):d+="\n                  xCOffset = xC + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+f+"C"+(p+1)+" = xTexelR"+f+"C"+(p+2)+";\n                "}}else p<l&&(d+="\n              if(xR >= 0 && xR < "+e+") {\n            ",i%2==1?(d+="\n                xCOffset = xC + 1 - "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+n+") {\n                  xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+f+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = vec4(\n                  xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".zw);\n              ",p+1<l&&(d+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+s+";\n                  if(xCOffset >= 0 && xCOffset < "+n+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+f+"C"+(p+1)+" = vec4(xTexelR"+f+"C"+(p+2)+".xy, final.xy);\n                ")):(d+="\n                if(xC >= 0 && xC < "+n+") {\n                  xTexelR"+f+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+f+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+f+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+f+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+f+"C"+p+" = vec4(\n                  xTexelR"+f+"C"+p+".xy, xTexelR"+f+"C"+(p+2)+".xy);\n              ",p+1<l&&(d+="\n                  xR"+f+"C"+(p+1)+" = vec4(\n                    xTexelR"+f+"C"+p+".zw, xTexelR"+f+"C"+(p+2)+".zw);\n                ")),d+="}");p<l&&(d+="\n            vec4 wTexelR"+f+"C"+p+" = getW("+f+", "+p+", d1, q);\n            wR"+f+"C"+p+" = vec4(wTexelR"+f+"C"+p+".xz, wTexelR"+f+"C"+p+".xz);\n          ",p+1<l&&(d+="\n              vec4 wTexelR"+f+"C"+(p+1)+" = getW("+f+", "+(p+1)+", d1, q);\n              wR"+f+"C"+(p+1)+" =\n                vec4(wTexelR"+f+"C"+(p+1)+".xz, wTexelR"+f+"C"+(p+1)+".xz);"))}for(f=0;f<c;f++)for(p=0;p<l;p++)d+="result += xR"+f+"C"+p+" * wR"+f+"C"+p+";";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+r+", "+i+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 result = vec4(0.);\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},d$=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],s=t[1],a=t[2],u=n[0],c=n[1];this.outputShape=[e[0],u,c,t[3]];var l=[s-1+".0",a-1+".0"],h=l[0],d=l[1],f=u>1?[""+(s-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],p=c>1?[""+(a-1)/(c-1),"(x2-x1) * width_ratio","x1*"+d+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+d];this.userCode="\n      const float height_ratio = float("+f[0]+");\n      const float width_ratio = float("+p[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+f[1]+";\n        float width_scale = "+p[1]+";\n\n        float in_y = "+f[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+p[2]+";\n        if( in_x < 0.0 || in_x > "+d+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},f$=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+jG(r)+" coords = getOutputCoords();\n        int end = "+p$(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+p$(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function p$(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var m$=function(t,e){this.variableNames=["A"];var n=DG();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+PG(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},g$=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=DG();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+PG(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},v$=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),y$=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},b$=function(t){this.variableNames=["A"];var e=DG();this.outputShape=t,this.userCode="\n      "+FG+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},w$=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=DG();this.outputShape=t,this.userCode="\n      "+FG+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},_$=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=DG(),i=e[0],o=e[1];this.outputShape=t;var s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      "+MG(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+s+", 0., 0., 0.);\n      }\n    "},x$=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=DG(),i=e[0],o=e[1];this.outputShape=t;var s="",a="result";n&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;s+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+MG(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+s+"\n\n        "+r.output+" = "+a+";\n      }\n    "},C$=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},E$=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),S$=function(t){this.variableNames=["A"];var e=DG(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},I$=function(t){this.variableNames=["A"];var e=DG(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},k$=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=jG(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},T$=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=jG(e.length),i=jG(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function A$(t,e){var n=DG();return SW(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function R$(t,e){return DW(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function O$(t,e){return PW(t,e,new Uint16Array([0,1,2,2,1,3]))}function N$(t,e,n,r,i,o,s){FW(n,r);var a=MW(t,e),u=t.TEXTURE_2D;return _W(t,e,(function(){return t.bindTexture(u,a)})),_W(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),_W(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),_W(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),_W(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),_W(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,s,null)})),_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),a}function D$(t,e,n,r,i){var o=vW(n,r);return N$(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function P$(t,e,n,r,i){var o=vW(n,r);return N$(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function M$(t,e,n,r,i){var o=vW(n,r);return N$(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function F$(t,e,n,r,i){var o=bW(n,r);return N$(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function L$(t,e,n,r,i){var o=bW(n,r);return N$(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function B$(t,e,n,r){return _W(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),BW(t,e,n,"clipSpacePos",r,3,20,0)&&BW(t,e,n,"uv",r,2,20,12)}function j$(t,e,n,r,i,o,s){var a,u,c;_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(a=new Float32Array(r*i*4),u=t.FLOAT,c=s.internalFormatPackedFloat),a.set(o),_W(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,a)})),_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function V$(t,e,n,r){_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?_W(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):_W(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),_W(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function U$(t,e,n,r,i){var o=t.createBuffer();_W(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var s=16*n*r;return _W(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ)})),_W(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),_W(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function z$(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function W$(t,e,n,r,i){var o=vW(n,r),s=o[0],a=o[1],u=new Uint8Array(n*r*4);return _W(t,e,(function(){return t.readPixels(0,0,s,a,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function q$(t,e,n,r,i,o,s,a){var u=t,c=new Float32Array(function(t,e){var n=bW(t,e);return n[0]*n[1]*4}(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function H$(t,e,n,r){var i=new Float32Array(n*r*4);return _W(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var G$=Object.freeze({createVertexShader:A$,createVertexBuffer:R$,createIndexBuffer:O$,createFloat32MatrixTexture:D$,createFloat16MatrixTexture:P$,createUnsignedBytesMatrixTexture:M$,createPackedMatrixTexture:F$,createFloat16PackedMatrixTexture:L$,bindVertexProgramAttributeStreams:B$,uploadDenseMatrixToTexture:j$,uploadPixelDataToTexture:V$,createBufferFromOutputTexture:U$,downloadFloat32MatrixFromBuffer:z$,downloadByteEncodedFloatMatrixFromOutputTexture:W$,downloadPackedMatrixFromBuffer:q$,downloadMatrixFromPackedOutputTexture:H$}),$$=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=KU.getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,pW(e,t)):this.gl=mW(e),1===KU.getNumber("WEBGL_VERSION"))this.textureFloatExtension=EW(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=EW(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(iq(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!iq(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=R$(this.gl,this.debug),this.indexBuffer=O$(this.gl,this.debug),this.framebuffer=LW(this.gl,this.debug),this.textureConfig=wW(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return KU.getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;_W(e,this.debug,(function(){return e.finish()})),_W(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),_W(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),_W(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),_W(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),_W(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),D$(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),P$(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),M$(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),V$(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),j$(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),L$(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),F$(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(qW(this.gl,this.debug,this.framebuffer),this.outputTexture=null),_W(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return W$(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return q$(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return z$(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=U$(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(KU.getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return H$(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=IW(e,this.debug,t),r=A$(e,this.debug),i=RW(e,this.debug);return _W(e,this.debug,(function(){return e.attachShader(i,r)})),_W(e,this.debug,(function(){return e.attachShader(i,n)})),OW(e,this.debug,i),this.debug&&NW(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=B$(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&_W(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&NW(this.gl,this.debug,this.program),_W(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?VW(this.gl,this.debug,t,e):UW(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),_W(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),zW(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=bW(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&NW(this.gl,this.debug,this.program),HW(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),_W(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),_W(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=EW(this.gl,this.debug,2===KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return qU(this,void 0,void 0,(function(){var e=this;return HU(this,(function(n){switch(n.label){case 0:return[4,lz((function(){return e.disposed||e.isQueryAvailable(t,KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||lz((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),WW(this.gl,this.debug,t,this.framebuffer),this.debug&&HW(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(WW(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&HW(this.gl)):qW(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;WW(r,this.debug,t,this.framebuffer),this.debug&&HW(r),this.outputTexture=t,_W(r,this.debug,(function(){return r.viewport(0,0,e,n)})),_W(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),_W(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function K$(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!oz(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var s=t.texShape,a=i.isUniform?null:i.texData.texShape;if(!oz(s,a))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+a+" must match")}}))}var X$=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,a=n.outWidth,u=n.dilationWidth,c=n.dilationHeight,l=n.dataFormat,h=s.left,d=s.top,f=r*n.filterWidth,p=DG(),m="channelsLast"===l,g=m?0:1,v=m?1:2,y="",b=0;b<=1;b++)for(var w=0;w<=1;w++)y+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+b+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+a+")) * "+o+" - "+d+";\n            d0 = offsetY + "+c+" * (pos / "+f+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+a+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+u+" * (int(mod(float(pos), "+f+".) / "+r+".));\n\n              if(d1 < "+e[v]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+r+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+y+"\n\n        "+p.output+" = result;\n      }\n    "},Y$=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},Q$=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},J$=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},Z$=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},tK=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n           wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(e*n*r-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+n+" * "+r+" +\n                  wR * "+r+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eK=function(t,e,n,r,i,o,s){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===s&&(s=!1),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var a=Math.ceil((n?t[1]:t[2])/2),u=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",l=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",f="";o&&(d=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+o+"\n        }":"vec4 activation(vec4 x) {\n          "+o+"\n        }",f="result = activation(result);");var p=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+d+"\n\n      const float sharedDimension = "+a+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+a+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+u+");\n          vec4 b = getMatrixB(rc.x, "+c+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+l[0]+" * "+h[0]+");\n          result += ("+l[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+p+"\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},nK=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),rK=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},iK=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=NG("rc",e),r=jG(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),s=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),s=2;s<t;s++)o=e[e.length-1-s]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+s+"));\n          }\n        }\n      "}},oK=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=jG(r),o=e.map((function(t){return t[0]})).join(","),s=e.map((function(e,n){return e[0]+t[n]})).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+a+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+s+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},sK=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=jG(r),o=e.map((function(t){return t[0]})).join(","),s=e.map((function(e,n){return e[0]+t[n]})).join(","),a=NG("rc",r),u=NG("source",r),c=a[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",a[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+a[r-2]+" += 1;\n       if("+a[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+a[r-1]+" += 1;\n         if("+c+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,m=1===r?2:4;p<m;p++)f+="\n        "+h[p]+"\n        if ("+d+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(f+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},aK=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var d="avg"===e,f="0.0";if(d||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+l+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+s+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+a+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+l+", "+h+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+s+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+a+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              getValue(batch, xR, xC + 3 * "+a+", d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},uK=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.front,p=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var g="avg"===e,v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+o+", "+s+");\n        const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+a+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,_="\n      if ("+g+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+o+", "+s+");\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float initializationValue = "+v+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+v+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+a+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+_+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+_+"\n            } else if ("+(2===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+_+"\n            } else if ("+(3===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+_+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},cK=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var s="0.0",a="";"prod"===e?s="1.0":"min"===e?(s="1.0 / 1e-20",a="min"):"max"===e&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+a+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===e?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+s+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+s+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},lK=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+PG(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+MG(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},hK=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],c=[n&&a>1?i-1:i,n&&u>1?o-1:o],l=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=c[0]/l[0],d=c[1]/l[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},dK=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},fK=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],s=t[3];this.outputShape=[t[0],e,n,s];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+a[0]/u[0]+",\n          "+a[1]/u[1]+",\n          "+a[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},pK=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],c=[n&&a>1?i-1:i,n&&u>1?o-1:o],l=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=c[0]/l[0],d=c[1]/l[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},mK=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},gK=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=jG(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},vK=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=NG("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],s=jG(n);function a(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+s+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return a(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},yK=function(t,e,n,r,i,o,s){void 0===s&&(s=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=jG(i.length),u=jG(o.length),c="";1===n?c="i":2===n&&(c="i, j");var l="";1===r?l="i":2===r&&(l="i, coords[1]"),this.userCode="\n        "+a+" strides = "+a+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+l+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},bK=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/n);this.outputShape=[r,s];var a=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+a+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+a+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},wK=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<t&&s.push(""+o[u]);r=s.join(),i=a.join()}var c=jG(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},_K=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=jG(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return xK.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+xK[e]+" = start["+e+"] + coords."+xK[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),xK=["x","y","z","w","u","v"],CK=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=jG(this.rank),n=NG("coords",this.rank),r=NG("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",s="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",a=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+s+"\n        "+a+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),EK=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=jG(n.length),o=jG(n.length),s="";if(1===r)s="coords * strides + begin";else{var a=0;s=n.map((function(t,e){return a++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(a-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+s+"));\n      }\n    "},SK=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=IK(e,n),o=kK(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),i===hW.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===hW.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===hW.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===hW.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===hW.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=kK(e,IK(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function IK(t,e){if(t===lW.UPLOAD)return hW.PACKED_2X2_FLOAT32;if(t===lW.RENDER||null==t)return function(t){return KU.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?hW.PACKED_2X2_FLOAT32:hW.UNPACKED_FLOAT32:t?hW.PACKED_2X2_FLOAT16:hW.UNPACKED_FLOAT16}(e);if(t===lW.DOWNLOAD||t===lW.PIXELS)return hW.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function kK(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var TK=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=jG(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},AK=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=jG(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},RK=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=jG(this.rank),o=OG("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+s.join()+"), "+a+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},OK=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},NK="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",DK="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",PK=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},MK=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=NG("rc",e),r=jG(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+s+"));\n      }\n    "},FK={};function LK(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?NK:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===t)return e?DK:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("prelu"===t)return e?XG:"return (a < 0.) ? b * a : a;";throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var BK=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!KU.getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=mW(KU.getNumber("WEBGL_VERSION"));this.binaryCache=(n=KU.getNumber("WEBGL_VERSION"))in FK?FK[n]:(FK[n]={},FK[n]),this.gpgpu=new $$(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new SK(this.gpgpu),this.numMBBeforeWarning=null==KU.global.screen?1024:KU.global.screen.height*KU.global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new ZH(this,uW)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n="undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement,r=t.data instanceof Uint8Array,i="undefined"!=typeof ImageData&&t instanceof ImageData,o="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,a=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],u=a[0],c=a[1],l=[c,u],h=[c,u,e];if(!(n||r||i||o||s))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(s||o)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=gW(KU.getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=u,this.fromPixels2DContext.canvas.height=c,this.fromPixels2DContext.drawImage(t,0,0,u,c),t=this.fromPixels2DContext.canvas);var d,f,p=this.makeTensorHandle(l,"int32");if(this.texData.get(p.dataId).usage=lW.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(p.dataId),t),KU.getBool("WEBGL_PACK")){d=new I$(h);var m=this.makePackedTensor(d.outputShape,p.dtype);f=this.compileAndRun(d,[p],m)}else d=new S$(h),f=this.compileAndRun(d,[p]);return this.disposeData(p.dataId),f},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(KU.getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!xW(r)){if(KU.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.ENV.set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+r+" cannot be represented on this device.")}}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=lW.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var s;s=e.isPacked?new PK(o,"return x;"):new OK(o,"return x;");var a=this.compileAndRun(s,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(a.dataId);return a.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var c,l,h=null!=this.activeTimers;return h&&(c=Dz()),l="complex64"===r?yG(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=Dz()-c),this.convertAndCacheOnCPU(t,l)},t.prototype.read=function(t){return qU(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b;return HU(this,(function(w){switch(w.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,o=n.dtype,s=n.complexTensors,a=n.isPacked,null!=n.slice)return u=a?new PK(i,"return x;"):new OK(i,"return x;"),c=this.compileAndRun(u,[{dataId:t,shape:i,dtype:o}]),l=this.read(c.dataId),c.dispose(),[2,l];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!KU.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===KU.getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==o&&KU.get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(t),f=this.texData.get(d.dataId),h=(b=this.gpgpu).createBufferFromTexture.apply(b,[f.texture].concat(yW(i)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:w.sent(),w.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=w.sent(),p=yG(m[0],m[1]),[3,5];case 4:null==h?p=this.getValuesFromTexture(t):(g=iz(i),p=this.gpgpu.downloadFloat32MatrixFromBuffer(h,g)),w.label=5;case 5:return null!=d&&this.disposeData(d.dataId),v=this.convertAndCacheOnCPU(t,p),y=this.pendingRead.get(t),this.pendingRead.delete(t),y.forEach((function(t){return t(v)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,v]}}))}))},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,s=r.isPacked,a=iz(i);if(KU.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),c=this.texData.get(u.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(yW(i))).subarray(0,a);return this.disposeData(u.dataId),l}var h=KU.getBool("WEBGL_PACK")&&!0===s,d=h?QW(i):i,f=this.makeTensorHandle(d,"float32");f.size=iz(i),this.texData.get(f.dataId).usage=lW.DOWNLOAD;var p=dq((function(){var e=h?new w$(d):new b$(d);return n.compileAndRun(e,[{shape:d,dtype:o,dataId:t}],f,null)})),m=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,a);return this.disposeData(f.dataId),g},t.prototype.time=function(t){return qU(this,void 0,void 0,(function(){var e,n,r,i,o,s,a;return HU(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=rz(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=rz(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return s=u.sent(),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:ZU(s),getExtraProfileInfo:function(){return s.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Dz(),endMs:null}},t.prototype.endTimer=function(t){return KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=Dz(),t)},t.prototype.getQueryTime=function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){return KU.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,s=e.isPacked,a=e.slice,u=a&&a.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,s)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getDataInfo=function(t){return this.texData.get(t)},t.prototype.getCPUBackend=function(){return KU.getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=uW.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:uW.keep(t.clone()),imag:uW.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===iz(n))return Dq([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=KH(t.shape,e,n);if(r||!i){var o=KU.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CK(n):new _K(n),s=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,s)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=Gz.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var s=XH(e,t.strides);r.slice&&(s+=r.slice.flatOffset),o.slice={flatOffset:s,origDataId:r.slice&&r.slice.origDataId||t.dataId};var a=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,a+1),i},t.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=HH(e,n,r);if(i.some((function(t){return 0===t})))return Dq([],i);var o=new EK(e,r,i);return this.compileAndRun(o,[t])},t.prototype.reverse=function(t,e){var n=KU.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vK(t.shape,e):new gK(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return Oq(t)})),r=t.map((function(t){return Nq(t)}));return Rq(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>KU.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),o=this.concat(t.slice(0,i),e),s=this.concat(t.slice(i),e);return this.concat([o,s],e)}if(KU.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var a=new e$(t.map((function(t){return t.shape})),e);return this.compileAndRun(a,t)}var u=Tq(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,iz(t.shape.slice(e)))})),l=new t$(c.map((function(t){return t.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return -x;",t.dtype);var e=new OK(t.shape,"return -x;");return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=n?t.shape[1]:t.shape[2],a=t.shape[0];if((1===i||1===o)&&s>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(a,s,1),c=1===o?2:1,l=1===o?e.as3D(a,1,s):e;return this.multiply(u,l).sum(c,!0)}var h=tW(t.dtype,e.dtype),d=new eK(t.shape,[a,i,o],n,r),f=this.makePackedTensor(d.outputShape,h);return this.compileAndRun(d,[t,e],f)},t.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,o=t.bias,s=t.activation,a=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],l=e.shape[0],h=tW(e.dtype,n.dtype),d=null!=o,f=null!=a,p=s?LK(s,!0):null,m=new eK(e.shape,[l,u,c],r,i,d,p,f),g=this.makePackedTensor(m.outputShape,h),v=[e,n];return o&&v.push(o),a&&v.push(a),this.compileAndRun(m,v,g)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new $G("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new $G("return areal * bimag + aimag * breal;",t.shape,e.shape),s=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],a=this.compileAndRun(i,s),u=this.compileAndRun(o,s),c=this.complex(a,u);return a.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a * b;",t.dtype);var l=new KG("return a * b;",t.shape,e.shape),h=this.makeOutputArray(l.outputShape,t.dtype);return this.compileAndRun(l,[t,e],h)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var s=[t,e,n],a=null;null!=o&&(a=o.shape,s.push(o));var u=null;if(null!=i&&(u=i.shape,s.push(i)),KU.getBool("WEBGL_PACK_NORMALIZATION")){var c=new GG(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(c,s)}var l=new HG(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(l,s)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=KU.getBool("WEBGL_PACK_NORMALIZATION")?new J$(t.shape,e,n,r,i):new Y$(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){var a=new Q$(e.shape,r,i,o,s);return this.compileAndRun(a,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return Fz(t)}));return SG(lH(t.shape,t.dtype,n),e)}var r=new TK(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.pad=function(t,e,n){var r=KU.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sK(t.shape,e,n):new oK(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=KU.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RK(t.shape,e):new AK(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new k$(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){tz(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=FH(t.shape,e,r),o=LH(i.length,e.length),s=BH(t.shape,e,r),a=jH(n,e.length),u=VH(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){tz(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=FH(s.shape,e,r,!1),u=LH(a.length,e.length,!1),c=BH(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(c)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=zH(i),s=new cK({windowSize:o,inSize:i,batchSize:r},e),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],n);return this.compileAndRun(s,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=zH(i),s=new RG({windowSize:o,inSize:i,batchSize:r},e,null==n),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],"int32"),c=[t];return null!=n&&c.push(n),this.compileAndRun(s,c,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=zH(r[r.length-1]),o=new zG(r,i,e,null==n),s=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],s),s.rank===t.rank?this.argReducePacked(t,e,s):s},t.prototype.sum=function(t,e){Cq("sum",e,t.rank);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i),s=eW(t.dtype);return this.reduce(o,"sum",s).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i),s=eW(t.dtype);return this.reduce(o,"prod",s).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=Eq([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=Iq(1,t.rank)[0]);var s=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),a=iz([o.shape[r]]),u=o.as2D(-1,a),c=eW(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(s);return null!=i&&(l=l.transpose(Sq(i))),l},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],s=t.shape[1],a=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=kz(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=kz(t,n+1);return n}(s,i),u=new bK({windowSize:a,inSize:s,batchSize:o,numSegments:i},e),c=u.outputShape,l=this.makeOutputArray([c[0],c[1]],r);return this.compileAndRun(u,[t,n],l),l.shape[1]===i?l:(n=Wq(0,i).tile([s/a]),this.segOpCompute(l,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(Cq("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!KU.getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=_q(t.shape,r),o=i[0],s=iz(i[1]),a=t.as2D(-1,s);return this.argReduce(a,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new f$(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new KG("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new KG("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new KG("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new KG("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new KG("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new KG("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new OK(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new KG("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new KG("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new wK(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,tW(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){pq("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return kG(t.shape,e)},t.prototype.topk=function(t,e,n){return IG(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){Cq("min",e,t.rank);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new KG("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new KG("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);Cq("max",e,t.rank);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new KG("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){Cq("all",e,t.rank);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){Cq("any",e,t.rank);var n=_q(t.shape,e),r=n[0],i=iz(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("return (a - b) * (a - b);",t.shape,e.shape):new KG("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(b.x == 0.0) {\n    result.x = NAN;\n  } else if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(b.y == 0.0) {\n    result.y = NAN;\n  } else if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(b.z == 0.0) {\n    result.z = NAN;\n  } else if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(b.w == 0.0) {\n    result.w = NAN;\n  } else if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new KG("\nif (b == 0.0) {\n  return NAN;\n}\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new KG("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a + b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=tW(t.dtype,e.dtype);if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a + b;",n);var r=new KG("return a + b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedUnaryOp=function(t,e,n){var r=new PK(t.shape,e),i=this.makePackedTensor(r.outputShape,n);return this.compileAndRun(r,[t],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new YG(n,t.shape,e.shape,i),s=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],s)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),s=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],s=i[1],a=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,s),c=new KG(n,t.shape,e.shape),l=r.makeOutputArray(c.outputShape,tW(o.dtype,s.dtype));return r.compileAndRun(c,[a,u],l)})),a=s[0],u=s[1],c=this.complex(a,u);return a.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>KU.get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return tW(t,e)})),o=t.map((function(t){return t.shape})),s=KU.getBool("WEBGL_PACK"),a=s?new AG(t[0].shape,o):new TG(t[0].shape,o),u=s?this.makePackedTensor(a.outputShape,i):this.makeOutputArray(a.outputShape,i);return this.compileAndRun(a,t,u)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a - b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=tW(t.dtype,e.dtype);if(KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a - b;",t.dtype);var r=new KG("return a - b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new YG("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new KG("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=tW(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return ceil(x);",t.dtype);var e=new OK(t.shape,"return ceil(x);");return this.compileAndRun(e,[t])},t.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return floor(x);",t.dtype);var e=new OK(t.shape,"return floor(x);");return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new OK(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new OK(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new OK(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new OK(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new OK(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return exp(x);",t.dtype);var e=new OK(t.shape,"return exp(x);");return this.compileAndRun(e,[t])},t.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return exp(x) - 1.0;",t.dtype);var e=new OK(t.shape,"return exp(x) - 1.0;");return this.compileAndRun(e,[t])},t.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new OK(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new OK(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new OK(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new OK(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new OK(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new OK(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=KU.getBool("WEBGL_PACK")?new PK(t.shape,NK):new OK(t.shape,"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n"),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG(XG,t.shape,e.shape):new KG("return (a < 0.) ? b * a : a;",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,DK,t.dtype);var e=new OK(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new KG("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new OK(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new OK(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=KU.getBool("WEBGL_PACK_CLIP")?new JG(t.shape):new QG(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(KU.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return abs(x);",t.dtype);var e=new OK(t.shape,"return abs(x);");return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new ZG(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new OK(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new OK(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new OK(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new OK(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new OK(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new OK(t.shape,"return asin(x);");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new OK(t.shape,"return acos(x);");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new OK(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YG("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new KG("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new OK(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new OK(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new OK(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new OK(t.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new OK(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new OK(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new OK(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new OK(t.shape,function(t){return void 0===t&&(t=0),"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n,r,i,o){var s=t.shape,a=this.texData.get(t.dataId),u="channelsLast"===n.dataFormat,c=s[2]%2!=0&&!!a.isPacked;if((1==s[0]*s[1]*s[2]||1===n.outChannels)&&n.inChannels>1e3||!KU.getBool("WEBGL_LAZILY_UNPACK")||!KU.getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){var l=this.reshape(t,[1,u?s[0]*s[1]*s[2]:s[0]*s[2]*s[3],n.inChannels]),h=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:l,b:h,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),n.outShape)}var d=Gz.make([1,u?s[0]*s[1]*(s[2]+1):s[0]*s[2]*(s[3]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),f=a.shape;a.shape=a.shape.slice(),a.shape[a.shape.length-2]++,tz(tq(a.shape,d.shape),(function(){return"packed reshape "+a.shape+" to "+d.shape+" isn't free"}));var p=this.reshape(e,[1,n.inChannels,n.outChannels]),m=this.fusedBatchMatMul({a:d,b:p,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),g=this.texData.get(m.dataId);return tz(g.isPacked,(function(){return"batchMatMul result is expected to be packed"})),a.shape=f,g.shape=n.outShape,Gz.make(n.outShape,{dataId:m.dataId},m.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n,r,i,o){var s=n.outWidth,a=n.outHeight,u="channelsLast"===n.dataFormat,c=n.filterWidth*n.filterHeight*n.inChannels,l=a*s,h=[c,l],d=t.squeeze([0]),f=e.reshape([1,c,-1]),p=new X$(h,d.shape,n),m=this.compileAndRun(p,[d]).reshape([1,h[0],h[1]]),g=null!=r,v=null!=o,y=i?LK(i,!0):null,b=new eK(m.shape,[1,l,n.outChannels],!0,!1,g,y,v),w=[m,f];return r&&w.push(r),v&&w.push(o),this.compileAndRun(b,w).reshape(u?[1,a,s,n.outChannels]:[1,n.outChannels,a,s])},t.prototype.fusedConv2d=function(t,e,n,r,i,o){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n,r,i,o);if(KU.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n,r,i,o);var s=null!=r,a=null!=o,u=i?LK(i,!1):null,c=new u$(n,s,u,a),l=[t,e];return r&&l.push(r),o&&l.push(o),this.compileAndRun(c,l)},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(KU.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new u$(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new r$(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new n$(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r;return KU.getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new h$(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new l$(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new a$(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new s$(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new c$(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new o$(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new i$(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new aK(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new aK(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new aK(r,"max",!0),o=this.compileAndRun(i,[e]),s=new Z$(r),a=this.makeOutputArray(s.outputShape,e.dtype),u=this.compileAndRun(s,[t,o],a);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new WG(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return mG(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.avgPool3d=function(t,e){var n=new uK(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.avgPool3dBackprop=function(t,e,n){var r=new qG(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.maxPool3d=function(t,e){var n=new uK(e,"max",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new uK(r,"max",!0),o=this.compileAndRun(i,[e]),s=new tK(r),a=this.makeOutputArray(s.outputShape,e.dtype),u=this.compileAndRun(s,[t,o],a);return o.dispose(),u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||tq(t.shape,e)||null!==n.texture&&tq(n.shape,e)?gG(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=KU.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fK(t.shape,e,n,r):new dK(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new hK(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new mK(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new pK(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:QH(t),o=new nK(i.shape[0],i.shape[1],n),s=this.makeOutputArray(o.outputShape,"int32"),a=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],s,a)},t.prototype.oneHot=function(t,e,n,r){var i=new rK(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.diag=function(t){var e=new y$(t.size);return this.compileAndRun(e,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return pq("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),xG(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var s=new d$(t.shape,e.shape,r,i,o);return this.compileAndRun(s,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){tz(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,s=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),a=new v$("NHWC"===n?[r,i,o,s]:[r,s,i,o],e,n);return this.compileAndRun(a,[t])},t.prototype.split=function(t,e,n){return EG(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=WH(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,c=[u/s,s],l=t.reshape([o,i]),h=e.reshape([o,s]);if(0===u)return gG(Dq([]),n);var d=Mq(0),f=new yK(o,i,l.rank,h.rank,a,c);return this.compileAndRun(f,[h,l,d]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=WH(0,t,n),o=new yK(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new C$("return real * expR - imag * expI;",t.shape,e),i=new C$("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],s=this.compileAndRun(r,o),a=this.compileAndRun(i,o),u=this.complex(s,a).as2D(t.shape[0],t.shape[1]);return s.dispose(),a.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=UH(t,e),o=i[0],s=i[1],a=i[2],u=i[3],c=e.reshape([s,r]),l=t.reshape([t.size/a,a]),h=new T$(r,u,[s,a]);return this.compileAndRun(h,[l,c]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||Sz(e))){var r=mz(n,iz(t));return r.fill(e),Gz.make(t,{values:r},n)}var i=new E$(t,e),o=i.getCustomSetupFunc(e),s=this.makeOutputArray(t,n);return this.compileAndRun(i,[],s,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return vG(t,e,n)},t.prototype.makeOutputArray=function(t,e){return Gz.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=Gz.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new MK(t.shape);return this.compileAndRun(e,[t],Gz.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new iK(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([XW(t.shape)].concat(YW(t.shape))),r=[XW(e)].concat(YW(e)),i=new lK(r,n.shape);return this.compileAndRun(i,[n]).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,s=QW(i),a=yW(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=a.map((function(t){return 2*t})),e=r?new g$(s,a):new m$(s,a),this.compileAndRun(e,[{shape:s,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=pz(n.dtype,0),n;var s=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&iz(e.shape)<=KU.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!tq(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var a,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,s,u),l=this.getAndSaveBinary(c,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),s=o.map((function(t){return t.shapeInfo})),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(t,e,n,r){var i=[];t.forEach((function(t){var e=iz(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,s,a=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+DG().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=DG();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],a=DG();if(null!=i&&oz(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+s+".0, "+o+".0);\n\n        return "+a.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+a.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var a=VG(e,n.slice(1));return"\n        "+t(a)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+UG(["b","row","col"],[1,2])+");\n        }\n      "}var u=s[0],c=s[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return "+DG().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],a=s[0],u=s[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",d="b * "+l+" + (row / 2) * "+c+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,d="b"+f+" * "+(l*=e[n-f-1])+" + "+d;return"\n    vec4 "+i+"("+h+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+a+");\n      return "+DG().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+LG(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+BG(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var s=LG(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+s+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+s+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+s+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&oz(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var s=fz(n),a=s.newShape,u=s.keptDims;if(a.length<n.length){var c=VG(e,a);return"\n      "+t(c)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+UG(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+BG(e)+"\n      }\n    ";var l=o[0],h=o[1],d=LG(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===l?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+l+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],a=fz(n),u=a.newShape,c=a.keptDims;if(u.length<n.length){var l=VG(e,u);return"\n        "+t(l)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+UG(["row","col","depth"],c)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+s+", 1)));\n        "+BG(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,d=h[0],f=h[1],p=e.shapeInfo.flatOffset;return f===o&&null==p?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+s+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+f+".0, "+d+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":f===s&&null==p?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+".0, "+d+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+s+" + depth + "+LG(r)+";\n        vec2 uv = uvFromFlat("+d+", "+f+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,u=fz(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=VG(e,c);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+UG(["row","col","depth","depth2"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+s+", "+o+", 1)));\n        "+BG(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];return m===a&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+s+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+m+", index + "+LG(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],s=n[3]*o,a=n[2]*s,u=n[1]*a,c=fz(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var d=VG(e,l);return"\n      "+t(d)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+UG(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+a+", "+s+", "+o+")) +\n          depth3;\n        "+BG(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],g=p[1];return g===u&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===o&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+a+" + depth * "+s+" +\n          depth2 * "+o+" + depth3 + "+LG(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=fz(n),s=o.newShape,a=o.keptDims;if(s.length<n.length){var u=VG(e,s);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+UG(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    "}var c=n[5],l=n[4]*c,h=n[3]*l,d=n[2]*h,f=n[1]*d;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+d+", "+h+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+BG(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,g=m[0],v=m[1];return v===f&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+d+", "+h+", "+l+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":v===c&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+d+" + depth * "+h+" +\n          depth2 * "+l+" + depth3 * "+c+" + depth4 + "+LG(r)+";\n      vec2 uv = uvFromFlat("+g+", "+v+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),s="get"+o+"AtOutCoords",a=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c=tG(t.shapeInfo.logicalShape,e.logicalShape),l=jG(u),h=u-a,d=["x","y","z","w","u","v"];n=0===a?"":u<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords."+d[t+h]+" = 0;"})).join("\n"),r=u<2&&a>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+d[e+h]})).join(", ");var f="return outputValue;",p=1===iz(t.shapeInfo.logicalShape),m=1===iz(e.logicalShape);if(1!==a||p||m){if(p&&!m)f=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var g=a-2,v=a-1;c.indexOf(g)>-1&&c.indexOf(v)>-1?f="return vec4(outputValue.x);":c.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+s+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+f+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===s&&null==t.shapeInfo.flatOffset&&oz(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var a=jG(s),u=tG(t.shapeInfo.logicalShape,e.logicalShape),c=s-o,l=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+a+" coords = getOutputCoords();\n      "+(0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+l[t+c]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+l[e+c]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=DG(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),d=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    #define isnan(value) isnan_custom(value)\n    "+t.defineSpecialNaN+"\n    bvec4 isnan_custom(vec4 val) {\n      return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n    }\n\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  "}(l);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(oz(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],s=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+s+";\n      index -= b * "+s+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,s="",a="b, r, c",u=2;u<t.length-1;u++)s="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+s,a="b"+u+", "+a;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+s+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+a+");\n    }\n  "}(t,e)}var n,r,i,o,s}(e.logicalShape,c),s=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return oz(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=PG(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=PG(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=PG(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=PG(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),s=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(d+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[d,h,s,a,o,u,n].join("\n")}(o,a,i,e.usesPackedTextures),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===KU.getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var d={},f=0;f<e.variableNames.length;f++){var p=e.variableNames[f];d[p]=t.getUniformLocation(c,p,!1),d["offset"+p]=t.getUniformLocation(c,"offset"+p,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:d,inShapeInfos:s,outShapeInfo:a,infLoc:l,nanLoc:h}}(o.gpgpu,t,s,u)})),h=null!=this.activeTimers;return h&&(a=this.startTimer()),function(t,e,n,r,i){K$(e.inShapeInfos,n),K$([e.outShapeInfo],[r]);var o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,s[0],s[1]):t.setOutputMatrixTexture(o,s[0],s[1]),t.setProgram(e.webGLProgram),1===KU.getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],s=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(iz(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var a=n.uniformValues;a instanceof Float32Array||(a=new Float32Array(a)),t.gl.uniform1fv(o,a)}else null!=n.texData.slice&&null!=s&&t.gl.uniform1i(s,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,l,s,u,r),h&&(a=this.endTimer(a),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(a)})),!KU.getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=dq((function(){if(!KU.get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=KU.getBool("DEBUG");KU.set("DEBUG",!1);var n=t.abs(Mq(1e-8)).dataSync()[0];if(KU.set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,s=n.usage,a=n.isPacked;if(null==n.texture){var u,c=null!=this.activeTimers;c&&(u=Dz());var l=n.texShape;if(null==l&&(l=JW(r,a),n.texShape=l),null!=o){var h=QW(r),d=void 0,f=l[1],p=l[0],m=o instanceof Uint8Array;a?(f=(e=bW(l[0],l[1]))[0],d=new x$(h,[p=e[1],f],m)):d=new _$(h,[p,f],m);var g=this.makeTensorHandle([p,f],i);this.texData.get(g.dataId).usage=m?lW.PIXELS:lW.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),f,p,o);var v=this.makeTensorHandle(d.outputShape,g.dtype);v.size=iz(d.outputShape),this.texData.get(v.dataId).isPacked=a,this.compileAndRun(d,[g],v);var y=this.texData.get(v.dataId);n.texture=y.texture,n.texShape=y.texShape,n.isPacked=y.isPacked,n.usage=y.usage,this.disposeData(g.dataId),this.texData.delete(v.dataId),n.values=null,c&&(this.uploadWaitMs+=Dz()-u)}else{var b=this.acquireTexture(l,s,i,a);n.texture=b}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*wz(e)},t}();cW()&&uW.registerBackend("webgl",(function(){return new BK}),2);var jK=Aq({abs_:function(t){var e=vq(t,"x","abs");return"complex64"===e.dtype?uW.runKernel((function(t){return t.complexAbs(e)}),{$x:e}):uW.runKernel((function(t,n){var r=t.abs(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}}))}}),VK=Aq({acos_:function(t){var e=vq(t,"x","acos");return uW.runKernel((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Mq(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),UK=Aq({acosh_:function(t){var e=vq(t,"x","acosh");return uW.runKernel((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),zK=Aq({asin_:function(t){var e=vq(t,"x","asin");return uW.runKernel((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Mq(1).sub(n.toFloat().square()).sqrt())}}}))}}),WK=Aq({asinh_:function(t){var e=vq(t,"x","asinh");return uW.runKernel((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Mq(1).add(n.toFloat().square()).sqrt())}}}))}}),qK=Aq({atan_:function(t){var e=vq(t,"x","atan");return uW.runKernel((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),HK=Aq({atanh_:function(t){var e=vq(t,"x","atanh");return uW.runKernel((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(Mq(1).sub(n.toFloat().square()))}}}))}}),GK=Aq({ceil_:function(t){var e=vq(t,"x","ceil");return uW.runKernel((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),$K=Aq({clipByValue_:function(t,e,n){var r=vq(t,"x","clipByValue");return tz(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),uW.runKernel((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{$x:r},(function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),Hq(t))}}}))}}),KK=Aq({cos_:function(t){var e=vq(t,"x","cos");return uW.runKernel((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),XK=Aq({cosh_:function(t){var e=vq(t,"x","cosh");return uW.runKernel((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),YK=Aq({erf_:function(t){var e=vq(t,"x","erf");return tz("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),uW.runKernel((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),QK=Aq({exp_:function(t){var e=vq(t,"x","exp");return uW.runKernel((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),JK=Aq({expm1_:function(t){var e=vq(t,"x","expm1");return uW.runKernel((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),ZK=Aq({floor_:function(t){var e=vq(t,"x","floor");return uW.runKernel((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),tX=Aq({log_:function(t){var e=vq(t,"x","log");return uW.runKernel((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),eX=Aq({log1p_:function(t){var e=vq(t,"x","log1p");return uW.runKernel((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),nX=Aq({logSigmoid_:function(t){var e=vq(t,"x","logSigmoid");return uW.runKernel((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),rX=Aq({neg_:function(t){var e=vq(t,"x","neg");return uW.runKernel((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),iX=Aq({reciprocal_:function(t){var e=vq(t,"x","reciprocal");return uW.runKernel((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),oX=Aq({round_:function(t){var e=vq(t,"x","round");return uW.runKernel((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),sX=Aq({rsqrt_:function(t){var e=vq(t,"x","rsqrt");return uW.runKernel((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),aX=Aq({sigmoid_:function(t){var e=vq(t,"x","sigmoid");return uW.runKernel((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(Mq(1).sub(n)))}}}))}}),uX=Aq({sign_:function(t){var e=vq(t,"x","sign");return uW.runKernel((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),cX=Aq({isNaN_:function(t){var e=vq(t,"x","isNaN");return uW.runKernel((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),lX=Aq({isInf_:function(t){var e=vq(t,"x","isInf");return uW.runKernel((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),hX=Aq({isFinite_:function(t){var e=vq(t,"x","isFinite");return uW.runKernel((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Hq(t)}}}))}}),dX=Aq({sin_:function(t){var e=vq(t,"x","sin");return uW.runKernel((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),fX=Aq({sinh_:function(t){var e=vq(t,"x","sinh");return uW.runKernel((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),pX=Aq({softplus_:function(t){var e=vq(t,"x","softplus");return uW.runKernel((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),mX=Aq({sqrt_:function(t){var e=vq(t,"x","sqrt");return uW.runKernel((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),gX=Aq({square_:function(t){var e=vq(t,"x","square");return uW.runKernel((function(t,n){return n([e]),t.square(e)}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}}))}}),vX=Aq({step_:function(t,e){void 0===e&&(e=0);var n=vq(t,"x","step");return uW.runKernel((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Hq(t)}}}))}}),yX=Aq({tan_:function(t){var e=vq(t,"x","tan");return uW.runKernel((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),bX=Aq({tanh_:function(t){var e=vq(t,"x","tanh");return uW.runKernel((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Mq(1).sub(n.square()).mulStrict(t)}}}))}});function wX(t,e,n,r,i,o){var s,a,u=vq(t,"x","batchNorm"),c=vq(e,"mean","batchNorm"),l=vq(n,"variance","batchNorm");return null!=i&&(s=vq(i,"scale","batchNorm")),null!=r&&(a=vq(r,"offset","batchNorm")),tz(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),tz(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),tz(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=s&&tz(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),null!=a&&tz(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."})),CX(u,c,l,a,s,o)}function _X(t,e,n,r,i,o){var s,a,u=vq(t,"x","batchNorm"),c=vq(e,"mean","batchNorm"),l=vq(n,"variance","batchNorm");return null!=i&&(s=vq(i,"scale","batchNorm")),null!=r&&(a=vq(r,"offset","batchNorm")),tz(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),tz(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),tz(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=s&&tz(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),null!=a&&tz(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."})),CX(u,c,l,a,s,o)}function xX(t,e,n,r,i,o){var s,a,u=vq(t,"x","batchNorm"),c=vq(e,"mean","batchNorm"),l=vq(n,"variance","batchNorm");return null!=i&&(s=vq(i,"scale","batchNorm")),null!=r&&(a=vq(r,"offset","batchNorm")),tz(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),tz(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),tz(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=s&&tz(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),null!=a&&tz(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."})),CX(u,c,l,a,s,o)}function CX(t,e,n,r,i,o){null==o&&(o=.001);var s,a,u,c=vq(t,"x","batchNorm"),l=vq(e,"mean","batchNorm"),h=vq(n,"variance","batchNorm");return null!=i&&(s=vq(i,"scale","batchNorm")),null!=r&&(a=vq(r,"offset","batchNorm")),tz(l.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),tz(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),tz(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,uW.runKernel((function(t,e){var n=t.batchNormalization(u,EX(l),EX(h),o,EX(s),EX(a));return e([c,l,h,s]),n}),{$x:c,$mean:l,$variance:h,$scale:s,$offset:a},(function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=null==s?Mq(1):s,c=eG(r.shape,u.shape),l=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)l.push(u.shape[h]);l.push(1)}var d=n.sub(r),f=t.mul(a),p=sX(i.add(Mq(o))),m=p.mul(p).mul(p).mul(Mq(-.5));return{$x:function(){return 1===r.rank?t.mul(DH(p.as4D(1,1,1,r.shape[0]),l)).mul(a).reshape(n.shape):t.mul(p).mul(a).reshape(n.shape)},$mean:function(){var t=p.mul(Mq(-1)).mul(f);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$variance:function(){var t=m.mul(d).mul(f);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$scale:function(){var e=d.mul(p),n=t.mul(e);return 1===r.rank&&(n=n.sum(c)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(c)),e.reshape(r.shape)}}})).reshape(c.shape)}function EX(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function SX(){hq("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var IX=Aq({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),SX(),wX(t,e,n,o,i,r)}}),kX=Aq({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),SX(),_X(t,e,n,o,i,r)}}),TX=Aq({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),SX(),xX(t,e,n,o,i,r)}}),AX=Aq({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),SX(),CX(t,e,n,o,i,r)}}),RX=Aq({batchNorm_:CX}),OX=Aq({batchNorm2d_:wX}),NX=Aq({batchNorm3d_:_X}),DX=Aq({batchNorm4d_:xX}),PX=Aq({logicalAnd_:function(t,e){var n=vq(t,"a","logicalAnd","bool"),r=vq(e,"b","logicalAnd","bool");return nG(n.shape,r.shape),uW.runKernel((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),MX=Aq({logicalNot_:function(t){var e=vq(t,"x","logicalNot","bool");return uW.runKernel((function(t){return t.logicalNot(e)}),{$x:e})}}),FX=Aq({logicalOr_:function(t,e){var n=vq(t,"a","logicalOr","bool"),r=vq(e,"b","logicalOr","bool");return nG(n.shape,r.shape),uW.runKernel((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),LX=Aq({logicalXor_:function(t,e){var n=vq(t,"a","logicalXor","bool"),r=vq(e,"b","logicalXor","bool");return nG(n.shape,r.shape),FX(t,e).logicalAnd(PX(t,e).logicalNot())}}),BX=Aq({where_:function(t,e,n){var r=vq(e,"a","where"),i=vq(n,"b","where"),o=vq(t,"condition","where","bool");return ez(r.shape,i.shape,"Error in where: "),1===o.rank?tz(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):ez(o.shape,i.shape,"Error in where: "),uW.runKernel((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return Hq(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),jX=function(t){return qU(this,void 0,void 0,(function(){var e,n,r;return HU(this,(function(i){switch(i.label){case 0:return[4,(e=vq(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=kG(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},VX=Aq({add_:function(t,e){var n,r=vq(t,"a","add"),i=vq(e,"b","add");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t){return t.add(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=eG(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=eG(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}))}}),UX=Aq({addN_:function(t){tz(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),tz(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return vq(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!oz(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),uW.runKernel((function(t){return t.addN(e)}),e,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),zX=Aq({addStrict_:function(t,e){var n=vq(t,"a","addStrict"),r=vq(e,"b","addStrict");return ez(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),WX=Aq({atan2_:function(t,e){var n,r=vq(t,"a","atan2"),i=vq(e,"b","atan2");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=VX(n.square(),r.square()),i=t.mul(r.div(e)),s=eG(n.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(n.shape)},$b:function(){var e=VX(n.square(),r.square()),i=rX(t.mul(n.div(e))),s=eG(r.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(r.shape)}}}))}}),qX=Aq({div_:function(t,e){var n,r=vq(t,"a","div"),i=vq(e,"b","div");if(n=nW(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return GX(r,i);var o=nG(r.shape,i.shape);return uW.runKernel((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=eG(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=eG(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}}))}}),HX=Aq({divStrict_:function(t,e){var n=vq(t,"a","div"),r=vq(e,"b","div");return ez(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),GX=Aq({floorDiv_:function(t,e){var n,r=vq(t,"a","floorDiv"),i=vq(e,"b","floorDiv");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=eG(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=eG(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}}))}}),$X=Aq({maximum_:function(t,e){var n,r=vq(t,"a","maximum"),i=vq(e,"b","maximum");return n=nW(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),nG(r.shape,i.shape),uW.runKernel((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),KX=Aq({maximumStrict_:function(t,e){var n=vq(t,"a","maximumStrict"),r=vq(e,"b","maximumStrict");return ez(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),XX=Aq({minimum_:function(t,e){var n,r=vq(t,"a","minimum"),i=vq(e,"b","minimum");return n=nW(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),nG(r.shape,i.shape),uW.runKernel((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),YX=Aq({minimumStrict_:function(t,e){var n=vq(t,"a","minimumStrict"),r=vq(e,"b","minimumStrict");return ez(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),QX=Aq({mod_:function(t,e){var n,r=vq(t,"a","mod"),i=vq(e,"b","mod");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=eG(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=eG(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),JX=Aq({modStrict_:function(t,e){var n=vq(t,"a","modStrict"),r=vq(e,"b","modStrict");return ez(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),ZX=Aq({mul_:function(t,e){var n,r=vq(t,"a","mul"),i=vq(e,"b","mul");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=eG(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=eG(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),tY=Aq({mulStrict_:function(t,e){var n=vq(t,"a","mul"),r=vq(e,"b","mul");return ez(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),eY=Aq({pow_:function(t,e){var n=vq(t,"base","pow"),r=vq(e,"exp","pow"),i=nG(n.shape,r.shape);return t=n.cast(tW(n.dtype,r.dtype)),e=r.cast(tW(n.dtype,r.dtype)),uW.runKernel((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(Mq(1))))),s=eG(n.shape,i);return s.length>0&&(o=o.sum(s)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),s=n.log().where(e,Hq(n)),a=t.mul(o.mul(s)),u=eG(r.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)}}}))}}),nY=Aq({powStrict_:function(t,e){return ez(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),rY=Aq({squaredDifference_:function(t,e){var n,r=vq(t,"a","squaredDifference"),i=vq(e,"b","squaredDifference");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1],i=Mq(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}}))}}),iY=Aq({squaredDifferenceStrict_:function(t,e){var n=vq(t,"a","squaredDifferenceStrict"),r=vq(e,"b","squaredDifferenceStrict");return ez(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),oY=Aq({sub_:function(t,e){var n,r=vq(t,"a","sub"),i=vq(e,"b","sub");n=nW(r,i);var o=nG((r=n[0]).shape,(i=n[1]).shape);return uW.runKernel((function(t){return t.subtract(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=eG(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=eG(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}))}}),sY=Aq({subStrict_:function(t,e){var n=vq(t,"a","subStrict"),r=vq(e,"b","subStrict");return ez(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),aY=Aq({equal_:function(t,e){var n,r=vq(t,"a","equal"),i=vq(e,"b","equal");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),uY=Aq({equalStrict_:function(t,e){var n=vq(t,"a","equalStrict"),r=vq(e,"b","equalStrict");return ez(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),cY=Aq({greater_:function(t,e){var n,r=vq(t,"a","greater"),i=vq(e,"b","greater");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t){return t.greater(r,i)}),{$a:r,$b:i})}}),lY=Aq({greaterEqual_:function(t,e){var n,r=vq(t,"a","greaterEqual"),i=vq(e,"b","greaterEqual");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return Hq(n)},$b:function(){return Hq(r)}}}))}}),hY=Aq({greaterEqualStrict_:function(t,e){var n=vq(t,"a","greaterEqualStrict"),r=vq(e,"b","greaterEqualStrict");return ez(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),dY=Aq({greaterStrict_:function(t,e){var n=vq(t,"a","greaterStrict"),r=vq(e,"b","greaterStrict");return ez(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),fY=Aq({less_:function(t,e){var n,r=vq(t,"a","less"),i=vq(e,"b","less");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t){return t.less(r,i)}),{$a:r,$b:i})}}),pY=Aq({lessEqual_:function(t,e){var n,r=vq(t,"a","lessEqual"),i=vq(e,"b","lessEqual");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t){return t.lessEqual(r,i)}),{$a:r,$b:i})}}),mY=Aq({lessEqualStrict_:function(t,e){var n=vq(t,"a","lessEqualStrict"),r=vq(e,"b","lessEqualStrict");return ez(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),gY=Aq({lessStrict_:function(t,e){var n=vq(t,"a","lessStrict"),r=vq(e,"b","lessStrict");return ez(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),vY=Aq({notEqual_:function(t,e){var n,r=vq(t,"a","notEqual"),i=vq(e,"b","notEqual");return n=nW(r,i),nG((r=n[0]).shape,(i=n[1]).shape),uW.runKernel((function(t){return t.notEqual(r,i)}),{$a:r,$b:i})}}),yY=Aq({notEqualStrict_:function(t,e){var n=vq(t,"a","notEqualStrict"),r=vq(e,"b","notEqualStrict");return ez(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function bY(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function wY(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var _Y=Aq({gather_:function(t,e,n){void 0===n&&(n=0);var r=vq(t,"x","gather"),i=vq(e,"indices","gather","int32");n=dz(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,s=1,a=0;a<n;a++)i.push(t.shape[a]),o*=t.shape[a];for(a=0;a<e.rank;a++)i.push(e.shape[a]);for(a=n+1;a<t.rank;a++)i.push(t.shape[a]),s*=t.shape[a];return{batchSize:o,sliceSize:s,dimSize:r,outputShape:i}}(r,i,n);return uW.runKernel((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{$x:r},(function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,s=e.slice(0,n),a=s.length,u=e.slice(n,e.length).slice(1),c=u.length,l=bY(0,a),h=bY(a+1,a+1+c),d=wY([s,[o],u]),f=t.reshape(d),p=i.reshape([o]),m=wY([[a],l,h]),g=f.transpose(m),v=xY(g,p,r.shape[n]),y=Sq(m);return v.transpose(y)}}})).reshape(o.outputShape)}}),xY=Aq({unsortedSegmentSum_:function(t,e,n){var r=vq(t,"x","unsortedSegmentSum"),i=vq(e,"segmentIds","unsortedSegmentSum","int32");return tz(sz(n),(function(){return"numSegments must be of dtype int"})),uW.runKernel((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=$X(e,Hq(e)),r=_Y(t,n),i=lY(e,Mq(0,"int32")),o=r.rank-i.rank,s=0;s<o;++s)i=gH(i,s+1);i=PX(i,Vq(r.shape,"bool"));var a=Hq(r);return BX(i,r,a)}(t,n)}}}))}});function CY(t,e,n,r,i,o,s){void 0===o&&(o="NHWC"),tz(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var a=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,t[0],t[1],t[2]]),tz(4===a.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."})),tz(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),tz(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===o?a[3]:a[1],h="NHWC"===o?u.shape[3]:u.shape[1];tz(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),tz(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=s&&tz(sz(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var d=pG(o),f=oG(a,n.shape,r,1,i,s,!1,d),p=uW.runKernel((function(t,e){var r=t.conv2dDerInput(u,n,f);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],a=e[1];return{dy4D:function(){return TY(t,n,r,i,o,1,s)},filter:function(){return RY(t,a,n.shape,r,i,o,s)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function EY(t,e,n,r,i,o,s){void 0===o&&(o="NHWC");var a=t;3===t.rank&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),tz(4===a.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."})),tz(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),tz(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===o?a.shape[3]:a.shape[1],l="NHWC"===o?u.shape[3]:u.shape[1];tz(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),tz(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=s&&tz(sz(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var h=pG(o),d=oG(a.shape,n,r,1,i,s,!1,h);return uW.runKernel((function(t){return t.conv2dDerFilter(a,u,d)}),{x4D:a,dy4D:u})}function SY(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}function IY(t,e,n,r,i){tz(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,s=e,a=!1;4===e.rank&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],c=s.shape[4];tz(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),tz(5===s.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),tz(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),tz(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),tz(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=sG(o,n.shape,r,1,i),h=uW.runKernel((function(t){return t.conv3dDerInput(s,n,l)}),{dy5D:s});return a?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var kY=Aq({conv1d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NWC"),void 0===o&&(o=1);var a=vq(t,"x","conv1d"),u=vq(e,"filter","conv1d"),c=a,l=!1;2===a.rank&&(l=!0,c=a.as3D(1,a.shape[0],a.shape[1])),tz(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),tz(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=s&&tz(sz(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),tz(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),tz(fG(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),tz("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=TY(d,h,[1,n],r,"NHWC",[1,o],s);return l?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),TY=Aq({conv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=vq(t,"x","conv2d"),u=vq(e,"filter","conv2d"),c=a,l=!1;3===a.rank&&(l=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),tz(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),tz(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=s&&tz(sz(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var h="NHWC"===i?c.shape[3]:c.shape[1];tz(h===u.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."})),tz(fG(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}));var d=pG(i),f=oG(c.shape,u.shape,n,o,r,s,!1,d),p=uW.runKernel((function(t,e){var n=t.conv2d(c,u,f);return e([u,c]),n}),{x:c,$filter:u},(function(t,e){var s=e[0],a=e[1];return tz(dG(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return CY(a.shape,t,s,n,r,i)},$filter:function(){return EY(a,t,s.shape,n,r,i)}}}));return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),AY=Aq({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var s=vq(t,"x","conv3d"),a=vq(e,"filter","conv3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),tz(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),tz(5===a.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."})),tz(u.shape[4]===a.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."})),tz(function(t,e){return SY(t)||SY(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),tz("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=sG(u.shape,a.shape,n,o,r),h=uW.runKernel((function(t,e){var n=t.conv3d(u,a,l);return e([u,a]),n}),{x:u,$filter:a},(function(t,e){tz(SY(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],s=e[1];return{x:function(){return IY(i.shape,t,s,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var s=e;4===s.rank&&(s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),tz(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),tz(5===s.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+s.shape+"."})),tz(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),tz(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),tz(s.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+s.shape[4]+") must match output depth for filter ("+n[4]+")."}));var a=sG(o.shape,n,r,1,i);return uW.runKernel((function(t){return t.conv3dDerFilter(o,s,a)}),{x5D:o,dy5D:s})}(i,t,s.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),RY=Aq({conv2dDerFilter_:EY}),OY=Aq({conv2dDerInput_:CY}),NY=Aq({depthwiseConv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=vq(t,"x","depthwiseConv2d"),u=vq(e,"filter","depthwiseConv2d"),c=a,l=!1;3===a.rank&&(l=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),tz(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),tz(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),tz(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),tz(fG(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=s&&tz(sz(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var h=oG(c.shape,u.shape,n,o,r,s,!0),d=uW.runKernel((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,$filter:u},(function(t,e){tz(dG(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=uW.runKernel((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}(0,t,r,h)},$filter:function(){return function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),uW.runKernel((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}(n,t,0,h)}}}));return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),DY=Aq({separableConv2d_:function(t,e,n,r,i,o,s){void 0===o&&(o=[1,1]),void 0===s&&(s="NHWC");var a=vq(t,"x","separableConv2d"),u=vq(e,"depthwiseFilter","separableConv2d"),c=vq(n,"pointwiseFilter","separableConv2d"),l=a,h=!1;if(3===a.rank&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");tz(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),tz(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),tz(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),tz(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),tz(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var d=u.shape[2],f=u.shape[3];tz(c.shape[2]===d*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+c.shape[2]+"."}));var p=NY(l,u,r,i,s,o),m=TY(p,c,1,"valid",s);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),PY=Aq({conv2dTranspose_:function(t,e,n,r,i,o){return CY(n,vq(t,"x","conv2dTranspose"),vq(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),MY=Aq({conv3dTranspose_:function(t,e,n,r,i){return IY(n,vq(t,"x","conv3dTranspose"),vq(e,"filter","conv3dTranspose"),r,i)}}),FY=Aq({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=vq(t,"a","matMul"),s=vq(e,"b","matMul");i=nW(o,s),o=i[0],s=i[1];var a=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?s.shape[s.rank-2]:s.shape[s.rank-1],h=o.shape.slice(0,-2),d=s.shape.slice(0,-2),f=iz(h),p=iz(d);tz(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),tz(oz(h,d),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),tz(a===u,(function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=o.shape.slice(0,-2).concat([c,l]),g=n?o.as3D(f,a,c):o.as3D(f,c,a),v=r?s.as3D(p,l,u):s.as3D(p,u,l);return uW.runKernel((function(t,e){var i=t.batchMatMul(g,v,n,r);return e([g,v]),i}),{$a:g,$b:v},(function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}})).reshape(m)}}),LY=Aq({dot_:function(t,e){var n=vq(t,"t1","dot"),r=vq(e,"t2","dot");tz(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return tz(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),BY=Aq({outerProduct_:function(t,e){var n=vq(t,"v1","outerProduct"),r=vq(e,"v2","outerProduct");return tz(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),jY=Aq({reverse_:function(t,e){var n=vq(t,"x","reverse");if(0===n.rank)return n.clone();var r=dz(e,n.shape);return uW.runKernel((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),VY=Aq({reverse1d_:function(t){var e=vq(t,"x","reverse");return tz(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),jY(e,0)}}),UY=Aq({reverse2d_:function(t,e){var n=vq(t,"x","reverse");return tz(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),jY(n,e)}}),zY=Aq({reverse3d_:function(t,e){var n=vq(t,"x","reverse");return tz(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),jY(n,e)}}),WY=Aq({reverse4d_:function(t,e){var n=vq(t,"x","reverse");return tz(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),jY(n,e)}});function qY(t,e,n,r,i,o){var s=vq(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),null==r&&(r=[1,1]),tz(4===a.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."})),tz(fG(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&tz(sz(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=rG(a.shape,e,n,r,i,o),l=uW.runKernel((function(t,e){var n=t.maxPool(a,c);return e([a,n]),n}),{x:a},(function(t,o){var s=o[0],a=o[1];return{x:function(){return function(t,e,n,r,i,o,s,a){var u=vq(t,"dy","maxPoolBackprop"),c=vq(e,"input","maxPoolBackprop"),l=vq(n,"output","maxPoolBackprop");tz(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),tz(fG(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),tz(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),tz(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var h=rG(c.shape,r,i,o,s,void 0);return uW.runKernel((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,s,a,e,n,r,i)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function HY(t,e,n,r,i,o){var s=vq(t,"x","avgPool","float32");null==r&&(r=[1,1]),tz(fG(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),tz(4===a.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."})),null!=o&&tz(sz(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=rG(a.shape,e,n,r,i,o),l=uW.runKernel((function(t){return t.avgPool(a,c)}),{x:a},(function(t){return{x:function(){return function(t,e,n,r,i,o){var s=vq(t,"dy","avgPoolBackprop"),a=vq(e,"input","avgPoolBackprop");tz(a.rank===s.rank,(function(){return"Rank of input ("+a.rank+") does not match rank of dy ("+s.rank+")"})),null==i&&(i=[1,1]),tz(fG(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=a,c=s,l=!1;3===a.rank&&(l=!0,u=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]),c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),tz(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),tz(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=rG(u.shape,n,r,i,o),d=uW.runKernel((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(t,a,e,n,r,i)}}}));return l=l.cast(s.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var GY=Aq({maxPool_:function(t,e,n,r,i){return qY(t,e,n,1,r,i)}}),$Y=Aq({avgPool_:function(t,e,n,r,i){return HY(t,e,n,1,r,i)}}),KY=Aq({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var s=vq(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),tz(fG(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var c,l=rG(a.shape,e,o,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],f=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),s=e.map((function(t,e){return(t-o[e]%t)%t})),a=i.map((function(t,e){return t+s[e]}));return[e.map((function(t,e){return[r[e],a[e]]})),e.map((function(t,e){return[0,s[e]]}))]}([l.inHeight,l.inWidth],h,c),p=f[1],m=d?r:"valid",g=d?a:RH(a,h,f[0]),v=("avg"===n?function(){return HY(g,e,o,1,m)}:function(){return qY(g,e,o,1,m)})(),y=d?v:hH(v,h,p);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),XY=Aq({maxPool3d_:function(t,e,n,r,i,o,s){void 0===o&&(o="NDHWC");var a=vq(t,"x","maxPool3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),null==s&&(s=[1,1,1]),tz(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),tz("NDHWC"===o,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),tz(fG(n,s),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"})),null!=i&&tz(sz(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=iG(u.shape,e,n,s,r,i,o),h=uW.runKernel((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,o){var a=o[0],u=o[1];return{x:function(){return function(t,e,n,r,i,o,s,a){var u=vq(t,"dy","maxPool3dBackprop"),c=vq(e,"input","maxPool3dBackprop"),l=vq(n,"output","maxPool3dBackprop"),h=u,d=c,f=l,p=!1;4===c.rank&&(p=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),f=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),tz(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),tz(5===d.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."})),tz(5===f.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."})),null==o&&(o=[1,1,1]),tz(fG(i,o),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),null!=a&&tz(sz(s),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+s+"."}));var m=iG(d.shape,r,i,o,s,a),g=uW.runKernel((function(t){return t.maxPool3dBackprop(h,d,f,m)}),{dy5D:h,input5D:d});return p?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(t,a,u,e,n,s,r,i)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),YY=Aq({avgPool3d_:function(t,e,n,r,i,o,s){void 0===o&&(o="NDHWC");var a=vq(t,"x","avgPool3d","float32"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),null==s&&(s=[1,1,1]),tz(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),tz("NDHWC"===o,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),tz(fG(n,s),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"})),null!=i&&tz(sz(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=iG(u.shape,e,n,s,r,i,o),h=uW.runKernel((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,o,s){var a=vq(t,"dy","avgPool3dBackprop"),u=vq(e,"input","avgPool3dBackprop"),c=a,l=u,h=!1;4===u.rank&&(h=!0,c=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),tz(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),tz(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==i&&(i=[1,1,1]),tz(fG(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=s&&tz(sz(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var d=iG(l.shape,n,r,i,o,s),f=uW.runKernel((function(t){return t.avgPool3dBackprop(c,l,d)}),{dy5D:c,input5D:l});return h?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(t,u,e,n,s,r,i)}}}));return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),QY=Aq({slice_:function(t,e,n){var r,i,o=vq(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(t){tz(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(tz(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),o.shape[e]-r[e])})),function(t,e,n){tz(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),tz(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){tz(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}(o,r,i);var s=o.shape;return uW.runKernel((function(t){return t.slice(o,r,i)}),{$x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],s[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}}))}}),JY=Aq({slice1d_:function(t,e,n){var r=vq(t,"x","slice1d");return tz(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),QY(r,[e],[n])}}),ZY=Aq({slice2d_:function(t,e,n){var r=vq(t,"x","slice2d");return tz(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),QY(r,e,n)}}),tQ=Aq({slice3d_:function(t,e,n){var r=vq(t,"x","slice3d");return tz(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),QY(r,e,n)}}),eQ=Aq({slice4d_:function(t,e,n){var r=vq(t,"x","slice4d");return tz(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),QY(r,e,n)}});function nQ(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(xq(e.shape,r))),t.rank<n.rank&&(t=t.reshape(xq(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var rQ=Aq({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","all","bool"),i=dz(e,r.shape),o=i,s=Eq(o,r.rank);null!=s&&(r=r.transpose(s),o=Iq(o.length,r.rank));var a=uW.runKernel((function(t){return t.all(r,o)}),{$x:r});if(n){var u=xq(a.shape,i);return a.reshape(u)}return a}}),iQ=Aq({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","any","bool"),i=dz(e,r.shape),o=i,s=Eq(o,r.rank);null!=s&&(r=r.transpose(s),o=Iq(o.length,r.rank));var a=uW.runKernel((function(t){return t.any(r,o)}),{$x:r});if(n){var u=xq(a.shape,i);return a.reshape(u)}return a}}),oQ=Aq({argMax_:function(t,e){void 0===e&&(e=0);var n=vq(t,"x","argMax");null==e&&(e=0);var r=dz(e,n.shape),i=Eq(r,n.rank);return null!=i&&(n=n.transpose(i),r=Iq(r.length,n.rank)),uW.runKernel((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Hq(n)}}}))}}),sQ=Aq({argMin_:function(t,e){void 0===e&&(e=0);var n=vq(t,"x","argMin");null==e&&(e=0);var r=dz(e,n.shape),i=Eq(r,n.rank);return null!=i&&(n=n.transpose(i),r=Iq(r.length,n.rank)),uW.runKernel((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Hq(n)}}}))}}),aQ=Aq({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","logSumExp"),i=dz(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(n){var u=xq(a.shape,i);return a.reshape(u)}return a}}),uQ=Aq({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","max"),i=r,o=dz(e,r.shape),s=o,a=Eq(s,r.rank);null!=a&&(r=r.transpose(a),s=Iq(s.length,r.rank));var u=uW.runKernel((function(t,e){var n=t.max(r,s);return e([i,n]),n}),{$x:r},(function(t,e){return nQ(t,e[1],e[0],o,a)}));if(n){var c=xq(u.shape,o);u=u.reshape(c)}return u}}),cQ=Aq({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","mean"),i=dz(e,r.shape),o=iz(_q(r.shape,i)[1]);return YH((function(t){var r=Mq(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(Vq(t.shape,"float32")).div(o)}}}))(r)}}),lQ=Aq({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","min"),i=r,o=dz(e,r.shape),s=o,a=Eq(s,r.rank);null!=a&&(r=r.transpose(a),s=Iq(s.length,r.rank));var u=uW.runKernel((function(t,e){var n=t.min(r,s);return e([i,n]),n}),{$x:r},(function(t,e){return nQ(t,e[1],e[0],o,a)}));if(n){var c=xq(u.shape,o);u=u.reshape(c)}return u}}),hQ=Aq({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=dz(e,(t=vq(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=xq(i.shape,r));var s=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,n)}}}),dQ=Aq({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=dz(e,r.shape);return YH((function(t){var e=Eq(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=Iq(r.length,t.rank));var s=uW.runKernel((function(t){return t.sum(o,r)}),{permutedX:o});if(n){var a=xq(s.shape,i);s=s.reshape(a)}return{value:s,gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(Vq(t.shape,"float32"))}}}))(r)}}),fQ=Aq({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=vq(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=dz(e,r.shape),o=Eq(i,r.rank),s=i,a=r;null!=o&&(a=r.transpose(o),s=Iq(s.length,r.rank));var u=uW.runKernel((function(t){return t.prod(a,s)}),{permutedX:a});if(n){var c=xq(u.shape,i);u=u.reshape(c)}return u}}),pQ=Aq({elu_:function(t){var e=vq(t,"x","elu");return uW.runKernel((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return uW.runKernel((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),mQ=Aq({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=vq(t,"x","leakyRelu");return $X(Mq(e).mul(n),n)}}),gQ=Aq({prelu_:function(t,e){var n=vq(t,"x","prelu"),r=vq(e,"alpha","prelu");return uW.runKernel((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{$x:n,$alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return BX(i,t,t.mul(r))},$alpha:function(){var e=BX(i,Hq(t),t.mul(n)),o=eG(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}))}}),vQ=Aq({relu_:function(t){var e=vq(t,"x","relu");return"bool"===e.dtype?e.toInt():uW.runKernel((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),yQ=Aq({selu_:function(t){var e=vq(t,"x","selu");return uW.runKernel((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(Mq(0)),r=Mq(1.7580993408473768),i=Mq(1.0507009873554805),o=t.mul(i),s=t.mul(r).mul(n.toFloat().exp());return BX(e,o,s)}}}))}}),bQ=Aq({transpose_:function(t,e){var n=vq(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),tz(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){tz(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():uW.runKernel((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=Sq(e);return{$x:function(){return t.transpose(n)}}}))}}),wQ=Aq({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=vq(t,"x","localResponseNormalization");tz(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),tz(sz(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var s=o,a=!1;3===o.rank&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=uW.runKernel((function(t,o){var a=t.localResponseNormalization4D(s,e,n,r,i);return o([s,a]),a}),{x4D:s},(function(t,o){var s=o[0],a=o[1];return{x4D:function(){return uW.runKernel((function(o){return o.LRNGrad(t,s,a,e,n,r,i)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_Q=Aq({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(Mq(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=vq(t,"x","norm"),e,n),o=i.shape;if(r){var s=dz(n,t.shape);o=xq(i.shape,s)}return i.reshape(o)}}),xQ=Aq({basicLSTMCell_:function(t,e,n,r,i,o){var s=vq(t,"forgetBias","basicLSTMCell"),a=vq(e,"lstmKernel","basicLSTMCell"),u=vq(n,"lstmBias","basicLSTMCell"),c=vq(r,"data","basicLSTMCell"),l=vq(i,"c","basicLSTMCell"),h=vq(o,"h","basicLSTMCell"),d=c.concat(h,1).matMul(a).add(u),f=d.shape[1]/4,p=[d.shape[0],f],m=d.slice([0,0],p),g=d.slice([0,f],p),v=d.slice([0,2*f],p),y=d.slice([0,3*f],p),b=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(s.add(v).sigmoid())),w=b.tanh().mulStrict(y.sigmoid());return[b,w]}}),CQ=Aq({multiRNNCell_:function(t,e,n,r){for(var i=vq(e,"data","multiRNNCell"),o=yq(n,"c","multiRNNCell"),s=yq(r,"h","multiRNNCell"),a=i,u=[],c=0;c<t.length;c++){var l=t[c](a,o[c],s[c]);u.push(l[0]),u.push(l[1]),a=l[1]}var h=[],d=[];for(c=0;c<u.length;c+=2)h.push(u[c]),d.push(u[c+1]);return[h,d]}}),EQ=Aq({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=vq(t,"v","movingAverage"),s=vq(e,"x","movingAverage"),a=vq(n,"decay","movingAverage");rW(o,s),tz(oz(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var u=Mq(1),c=u.sub(a),l=s.sub(o).mul(c);if(i){tz(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=vq(r,"step","movingAverage");l=l.div(u.sub(eY(a,h)))}return o.add(l)}}),SQ=Aq({stridedSlice_:function(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==s)throw new Error("ellipsis mask is not yet supported");var c=vq(t,"x","stridedSlice"),l=qH(a),h=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),c=c.reshape(h);for(var d=0;d<c.rank;d++)e[d]=GH(i,e,r,c.shape,d),n[d]=$H(o,n,r,c.shape,d),r[d]=r[d]||1;var f=qH(u);f.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var p=HH(e,n,r),m=p.filter((function(t,e){return-1===f.indexOf(e)}));return r.every((function(t){return 1===t}))?QY(c,e,p).reshape(m):uW.runKernel((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(m)}}),IQ=Aq({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=vq(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=uW.runKernel((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),kQ=Aq({scatterND_:function(t,e,n){var r=vq(t,"indices","scatterND","int32"),i=vq(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var s=0;s<i;++s)if(n.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+n.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+n.shape[s+i]+") != shape["+(s+i)+"] ("+t[s+i]+")")}(n,e,t)}(i,r,n),uW.runKernel((function(t){return t.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),TQ=Aq({fft_:function(t){tz("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return uW.runKernel((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),AQ=Aq({ifft_:function(t){tz("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return uW.runKernel((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),RQ=Aq({rfft_:function(t,e){tz("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e,n=t.slice(o,s),r=e}else if(null!=e&&e>r){var a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e-r,n=t.concat(Uq(a),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=Rq(n,u).as2D(i,r),l=TQ(c),h=Math.floor(r/2)+1,d=Oq(l),f=Nq(l),p=d.split([h,r-h],d.shape.length-1),m=f.split([h,r-h],f.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,Rq(p[0],m[0]).reshape(g)}}),OQ=Aq({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=AQ(r);return Oq(i)}var o=[n,2*(e-1)],s=Oq(t).as2D(n,e),a=Nq(t).as2D(n,e),u=s.slice([0,1],[n,e-2]).reverse(1),c=a.slice([0,1],[n,e-2]).reverse(1).mul(Mq(-1)),l=s.concat(u,1),h=a.concat(c,1);return r=Rq(l,h).as2D(o[0],o[1]),i=AQ(r),Oq(i)}}),NQ=Object.freeze({fft:TQ,ifft:AQ,rfft:RQ,irfft:OQ}),DQ=Aq({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=vq(t,"sparseIndices","sparseToDense","int32"),o=vq(e,"sparseValues","sparseToDense"),s=vq(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,s),uW.runKernel((function(t){return t.sparseToDense(i,o,n,s)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),PQ=Aq({gatherND_:function(t,e){var n=vq(e,"indices","gatherND","int32"),r=vq(t,"x","gatherND");return uW.runKernel((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),MQ=Aq({diag_:function(t){var e=vq(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return uW.runKernel((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),FQ=Aq({dropout_:function(t,e,n,r){var i=vq(t,"x","dropout");if(tz("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),tz(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof Gz?i.clone():i;var o=function(t,e){if(null==e)return t.shape.slice();if(oz(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),s=1-e,a=TH(o,0,1,"float32",r).add(s).floor().div(s);return i.mul(a)}});function LQ(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var s=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(s)}return Fq(i,"float32")}var BQ,jQ=Aq({hannWindow_:function(t){return LQ(t,.5,.5)}}),VQ=Aq({hammingWindow_:function(t){return LQ(t,.54,.46)}}),UQ=Aq({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,s=[];o+e<=t.size;)s.push(QY(t,o,e)),o+=n;if(r)for(;o<t.size;){var a=o+e-t.size,u=Gq([QY(t,o,e-a),zq([a],i)]);s.push(u),o+=n}return 0===s.length?Lq([],[0,e]):Gq(s).as2D(s.length,e)}}),zQ=Aq({stft_:function(t,e,n,r,i){void 0===i&&(i=jQ),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));for(var o=UQ(t,e,n),s=ZX(o,i(e)),a=[],u=0;u<o.shape[0];u++)a.push(RQ(s.slice([u,0],[1,e]),r));return Gq(a)}}),WQ=Object.freeze({hannWindow:jQ,hammingWindow:VQ,frame:UQ,stft:zQ});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(BQ||(BQ={}));var qQ=Aq({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=BQ.SUM_BY_NONZERO_WEIGHTS);var i=vq(t,"labels","absoluteDifference"),o=vq(e,"predictions","absoluteDifference"),s=null;null!=n&&(s=vq(n,"weights","absoluteDifference")),ez(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return HQ(a,s,r)}}),HQ=Aq({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=BQ.SUM_BY_NONZERO_WEIGHTS);var r=vq(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=vq(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===BQ.NONE)return o;if(n===BQ.SUM)return o.sum();if(n===BQ.MEAN){if(null==i)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(Mq(s)):a}if(n===BQ.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(Mq(r.size));var u=i.mul(Vq(r.shape)).notEqual(Mq(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),GQ=Aq({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=BQ.SUM_BY_NONZERO_WEIGHTS);var o=vq(t,"labels","cosineDistance"),s=vq(e,"predictions","cosineDistance"),a=null;null!=r&&(a=vq(r,"weights","cosineDistance")),ez(o.shape,s.shape,"Error in cosineDistance: ");var u=Mq(1).sub(o.mul(s).sum(n,!0));return HQ(u,a,i)}}),$Q=Aq({hingeLoss_:function(t,e,n,r){void 0===r&&(r=BQ.SUM_BY_NONZERO_WEIGHTS);var i=vq(t,"labels","hingeLoss"),o=vq(e,"predictions","hingeLoss"),s=null;null!=n&&(s=vq(n,"weights","hingeLoss")),ez(i.shape,o.shape,"Error in hingeLoss: ");var a=Mq(1);i=Mq(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return HQ(u,s,r)}}),KQ=Aq({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=BQ.SUM_BY_NONZERO_WEIGHTS);var o=vq(t,"labels","huberLoss"),s=vq(e,"predictions","huberLoss"),a=null;null!=n&&(a=vq(n,"weights","huberLoss")),ez(o.shape,s.shape,"Error in huberLoss: ");var u=Mq(r),c=s.sub(o).abs(),l=XX(c,u),h=c.sub(l),d=Mq(.5).mul(l.square()).add(u.mul(h));return HQ(d,a,i)}}),XQ=Aq({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=BQ.SUM_BY_NONZERO_WEIGHTS);var o=vq(t,"labels","logLoss"),s=vq(e,"predictions","logLoss"),a=null;null!=n&&(a=vq(n,"weights","logLoss")),ez(o.shape,s.shape,"Error in logLoss: ");var u=Mq(1),c=Mq(r),l=o.mul(s.add(c).log()).neg().sub(u.sub(o).mul(u.sub(s).add(c).log()));return HQ(l,a,i)}}),YQ=Aq({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=BQ.SUM_BY_NONZERO_WEIGHTS);var i=vq(t,"labels","meanSquaredError"),o=vq(e,"predictions","meanSquaredError"),s=null;null!=n&&(s=vq(n,"weights","meanSquaredError")),ez(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return HQ(a,s,r)}}),QQ=Aq({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=BQ.SUM_BY_NONZERO_WEIGHTS);var o=vq(t,"multiClassLabels","sigmoidCrossEntropy"),s=vq(e,"logits","sigmoidCrossEntropy"),a=null;if(null!=n&&(a=vq(n,"weights","sigmoidCrossEntropy")),ez(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Mq(r),c=Mq(1),l=Mq(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=vq(t,"labels","sigmoidCrossEntropyWithLogits"),r=vq(e,"logits","sigmoidCrossEntropyWithLogits");ez(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),s=r.abs().neg().exp().log1p();return i.sub(o).add(s)}(o,s);return HQ(h,a,i)}}),JQ=Aq({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=BQ.SUM_BY_NONZERO_WEIGHTS);var o=vq(t,"onehotLabels","softmaxCrossEntropy"),s=vq(e,"logits","softmaxCrossEntropy"),a=null;if(null!=n&&(a=vq(n,"weights","softmaxCrossEntropy")),ez(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Mq(r),c=Mq(1),l=Mq(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return YH((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=xq(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,s);return HQ(h,a,i)}}),ZQ=Object.freeze({get Reduction(){return BQ},absoluteDifference:qQ,computeWeightedLoss:HQ,cosineDistance:GQ,hingeLoss:$Q,huberLoss:KQ,logLoss:XQ,meanSquaredError:YQ,sigmoidCrossEntropy:QQ,softmaxCrossEntropy:JQ});function tJ(t,e){return void 0===e&&(e=!1),uW.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=vH(n),o=t.clone(),s=Lq([[1]],[1,1]),a=s.clone(),u=n>=r?r:n,c=function(t){var e,u=o,c=a,l=i;e=uW.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),c=o.slice([t,t],[1,1]),l=Lq([[-1]]).where(c.greater(0),Lq([[1]])),h=c.sub(l.mul(u)),d=e.div(h);a=1===d.shape[0]?s.clone():s.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var f=l.matMul(h).div(u).neg(),p=o.slice([t,0],[n-t,r]),m=f.mul(a);if(0===t)o=p.sub(m.matMul(a.transpose().matMul(p)));else{var g=p.sub(m.matMul(a.transpose().matMul(p)));o=o.slice([0,0],[t,r]).concat(g,0)}var v=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=v.sub(v.matMul(a).matMul(m.transpose()));else{var y=v.sub(v.matMul(a).matMul(m.transpose()));i=i.slice([0,0],[n,t]).concat(y,1)}return[a,o,i]})),a=e[0],o=e[1],i=e[2],fq([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var eJ=Aq({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,tz(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){tz(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=Qq(t,t.shape[0],0).map((function(t){return OH(t,[0])}));tz(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],s=t,a=function(t){o.push(uW.tidy((function(){var e=s[t];if(t>0)for(var n=0;n<t;++n){var r=dQ(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(_Q(e,"euclidean"))})))};for(i=0;i<t.length;++i)a(i);return e?NH(o,0):o}}),nJ=Aq({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return tJ(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=MH(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=tJ(t,e),r=n[1];i.push(n[0]),o.push(r)})),[NH(i,0).reshape(t.shape),NH(o,0).reshape(t.shape)]}}),rJ=Object.freeze({gramSchmidt:eJ,qr:nJ});function iJ(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),tz(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),tz(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),tz(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),tz(1===e.rank,(function(){return"scores must be a 1D tensor"})),tz(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var oJ=Aq({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=vq(t,"images","resizeBilinear");tz(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),tz(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=uW.runKernel((function(t,e){return e([i]),t.resizeBilinear(i,s,a,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return uW.runKernel((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),sJ=Aq({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=vq(t,"images","resizeNearestNeighbor");tz(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),tz(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),tz("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=uW.runKernel((function(t,e){return e([i]),t.resizeNearestNeighbor(i,s,a,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return uW.runKernel((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),aJ=Aq({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=vq(t,"boxes","nonMaxSuppression"),s=vq(e,"scores","nonMaxSuppression"),a=iJ(o,s,n,r,i);return n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,uW.runKernel((function(t){return t.nonMaxSuppression(o,s,n,r,i)}),{$boxes:o})}}),uJ=Aq({cropAndResize_:function(t,e,n,r,i,o){var s=vq(t,"image","cropAndResize","float32"),a=vq(e,"boxes","cropAndResize","float32"),u=vq(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=a.shape[0];return tz(4===s.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),tz(2===a.rank&&4===a.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+a.shape+"."})),tz(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+a.shape+"."})),tz(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),tz(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),tz("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),uW.runKernel((function(t,e){return t.cropAndResize(s,a,u,r,i,o)}),{$image:s,$boxes:a})}}),cJ=Object.freeze({resizeBilinear:oJ,resizeNearestNeighbor:sJ,nonMaxSuppression:aJ,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),qU(this,void 0,void 0,(function(){var o,s,a,u,c;return HU(this,(function(l){switch(l.label){case 0:return o=vq(t,"boxes","nonMaxSuppressionAsync"),s=vq(e,"scores","nonMaxSuppressionAsync"),a=iJ(o,s,n,r,i),n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return u=l.sent(),c=xG(u[0],u[1],n,r,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,c]}}))}))},cropAndResize:uJ}),lJ=Aq({matMul_:function(t){var e,n=t.b,r=t.transposeA,i=void 0!==r&&r,o=t.transposeB,s=void 0!==o&&o,a=t.bias,u=t.activation,c=void 0===u?"linear":u,l=t.preluActivationWeights,h=vq(t.a,"a","fused matMul"),d=vq(n,"b","fused matMul");e=nW(h,d),h=e[0],d=e[1];var f=i?h.shape[h.rank-2]:h.shape[h.rank-1],p=s?d.shape[d.rank-1]:d.shape[d.rank-2],m=i?h.shape[h.rank-1]:h.shape[h.rank-2],g=s?d.shape[d.rank-2]:d.shape[d.rank-1],v=h.shape.slice(0,-2),y=d.shape.slice(0,-2),b=iz(v),w=iz(y);tz(h.rank>=2&&d.rank>=2&&h.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+d.rank+"."})),tz(oz(v,y),(function(){return"Error in fused matMul: outer dimensions ("+v+") and ("+y+") of Tensors with shapes "+h.shape+" and "+d.shape+" must match."})),tz(f===p,(function(){return"Error in fused matMul: inner shapes ("+f+") and ("+p+") of Tensors with shapes "+h.shape+" and "+d.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var _,x,C=h.shape.slice(0,-2).concat([m,g]),E=i?h.as3D(b,f,m):h.as3D(b,m,f),S=s?d.as3D(w,g,p):d.as3D(w,p,g);null!=a&&nG(C,(_=nW(_=vq(a,"bias","fused matMul"),h)[0]).shape),null!=l&&(x=vq(l,"prelu weights","fused matMul"));var I={$a:E,$b:S};return null!=a&&(I.$bias=_),null!=l&&(I.$preluActivationWeights=x),uW.runKernel((function(t,e){var n=t.fusedBatchMatMul({a:E,b:S,transposeA:i,transposeB:s,bias:_,activation:c,preluActivationWeights:x});return e([E,S,n]),n}),I,(function(t,e){var n,r=e[0],o=e[1],u=e[2];if(null==c||"linear"===c)n=t;else{if("relu"!==c)throw new Error("Gradient for activation "+c+" has not been implemented yet.");n=t.mul(u.step())}var l={};return null!=a&&(l={$bias:function(){var t=n,e=eG(_.shape,n.shape);return e.length>0&&(t=t.sum(e)),t.reshape(_.shape)}}),Object.assign(i||s?!i&&s?{$a:function(){return n.matMul(o,!1,!1)},$b:function(){return n.matMul(r,!0,!1)}}:i&&!s?{$a:function(){return o.matMul(n,!1,!0)},$b:function(){return r.matMul(n,!1,!1)}}:{$a:function(){return o.matMul(n,!0,!0)},$b:function(){return n.matMul(r,!0,!0)}}:{$a:function(){return n.matMul(o,!1,!0)},$b:function(){return r.matMul(n,!0,!1)}},l)})).reshape(C)}}),hJ=Aq({conv2d_:function(t){var e=t.filter,n=t.strides,r=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,s=t.dilations,a=void 0===s?[1,1]:s,u=t.dimRoundingMode,c=t.bias,l=t.activation,h=void 0===l?"linear":l,d=t.preluActivationWeights,f=vq(t.x,"x","conv2d"),p=vq(e,"filter","conv2d"),m=f,g=!1;3===f.rank&&(g=!0,m=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),tz(4===m.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."})),tz(4===p.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+p.rank+"."})),null!=u&&tz(sz(r),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."})),tz(m.shape[3]===p.shape[2],(function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+p.shape[2]+"."})),tz(fG(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),tz("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var v,y,b=oG(m.shape,p.shape,n,a,r,u);null!=c&&(v=nW(v=vq(c,"bias","fused conv2d"),f)[0],nG(b.outShape,v.shape)),null!=d&&(y=vq(d,"prelu weights","fused conv2d"));var w={x:m,$filter:p};null!=c&&(w.$bias=v),null!=d&&(w.$preluActivationWeights=y);var _=uW.runKernel((function(t,e){var n=t.fusedConv2d(m,p,b,v,h,y);return e([p,m,n]),n}),w,(function(t,e){var i,o=e[0],s=e[1],u=e[2];if(null==h||"linear"===h)i=t;else{if("relu"!==h)throw new Error("Gradient for activation "+h+" has not been implemented yet.");i=t.mul(u.step())}tz(dG(a),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}));var l={};return null!=c&&(l={$bias:function(){var t=i,e=eG(v.shape,i.shape);return e.length>0&&(t=t.sum(e)),t.reshape(v.shape)}}),Object.assign({x:function(){return OY(s.shape,i,o,n,r)},$filter:function(){return RY(s,i,o.shape,n,r)}},l)}));return g?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),dJ=Object.freeze({matMul:lJ,conv2d:hJ}),fJ=Object.freeze({image:cJ,linalg:rJ,losses:ZQ,spectral:NQ,fused:dJ,signal:WQ,op:Aq,batchNormalization2d:IX,batchNormalization3d:kX,batchNormalization4d:TX,batchNormalization:AX,batchNorm:RX,batchNorm2d:OX,batchNorm3d:NX,batchNorm4d:DX,booleanMaskAsync:function(t,e,n){return qU(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,d,f,p,m;return HU(this,(function(g){switch(g.label){case 0:for(r=vq(t,"tensor","boolMask"),i=vq(e,"mask","boolMask","bool"),o=null==n?0:n,a=r.shape,tz((s=i.rank)>0,(function(){return"mask cannot be scalar"})),ez(a.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=o;c<o+s;c++)u*=a[c];return l=a.slice(0,o).concat([u],a.slice(o+s)),h=r.reshape(l),d=i.reshape([-1]),[4,jX(d)];case 1:return f=g.sent(),p=f.squeeze([1]),m=_Y(h,p,o),t!==r&&r.dispose(),e!==i&&i.dispose(),p.dispose(),h.dispose(),d.dispose(),f.dispose(),[2,m]}}))}))},complex:Rq,real:Oq,imag:Nq,concat:Gq,concat1d:$q,concat2d:Kq,concat3d:Xq,concat4d:Yq,split:Qq,conv1d:kY,conv2d:TY,conv3d:AY,conv2dDerFilter:RY,conv2dDerInput:OY,depthwiseConv2d:NY,separableConv2d:DY,conv2dTranspose:PY,conv3dTranspose:MY,matMul:FY,dot:LY,outerProduct:BY,reverse:jY,reverse1d:VY,reverse2d:UY,reverse3d:zY,reverse4d:WY,maxPool:GY,avgPool:$Y,pool:KY,maxPool3d:XY,avgPool3d:YY,slice:QY,slice1d:JY,slice2d:ZY,slice3d:tQ,slice4d:eQ,abs:jK,acos:VK,acosh:UK,asin:zK,asinh:WK,atan:qK,atanh:HK,ceil:GK,clipByValue:$K,cos:KK,cosh:XK,erf:YK,exp:QK,expm1:JK,floor:ZK,log:tX,log1p:eX,logSigmoid:nX,neg:rX,reciprocal:iX,round:oX,rsqrt:sX,sigmoid:aX,sign:uX,isNaN:cX,isInf:lX,isFinite:hX,sin:dX,sinh:fX,softplus:pX,sqrt:mX,square:gX,step:vX,tan:yX,tanh:bX,all:rQ,any:iQ,argMax:oQ,argMin:sQ,logSumExp:aQ,max:uQ,mean:cQ,min:lQ,moments:hQ,sum:dQ,prod:fQ,equal:aY,equalStrict:uY,greater:cY,greaterEqual:lY,greaterEqualStrict:hY,greaterStrict:dY,less:fY,lessEqual:pY,lessEqualStrict:mY,lessStrict:gY,notEqual:vY,notEqualStrict:yY,add:VX,addN:UX,addStrict:zX,atan2:WX,div:qX,divStrict:HX,floorDiv:GX,maximum:$X,maximumStrict:KX,minimum:XX,minimumStrict:YX,mod:QX,modStrict:JX,mul:ZX,mulStrict:tY,pow:eY,powStrict:nY,squaredDifference:rY,squaredDifferenceStrict:iY,sub:oY,subStrict:sY,elu:pQ,leakyRelu:mQ,prelu:gQ,relu:vQ,selu:yQ,logicalAnd:PX,logicalNot:MX,logicalOr:FX,logicalXor:LX,where:BX,whereAsync:jX,buffer:lH,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:hH,cast:dH,clone:fH,cumsum:pH,depthToSpace:mH,expandDims:gH,eye:vH,multinomial:yH,oneHot:bH,pad:wH,pad1d:_H,pad2d:xH,pad3d:CH,pad4d:EH,rand:SH,randomNormal:IH,randomGamma:kH,randomUniform:TH,reshape:AH,spaceToBatchND:RH,squeeze:OH,stack:NH,tile:DH,truncatedNormal:PH,unstack:MH,setdiff1dAsync:function(t,e){return qU(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h;return HU(this,(function(d){switch(d.label){case 0:return n=vq(t,"x","setdiff1d"),r=vq(e,"y","setdiff1d"),tz(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),tz(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),tz(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(o=d.sent(),s=new Set(o),a=0,l=0;l<i.length;l++)s.has(i[l])||a++;for(u=new zz([a],n.dtype),c=new zz([a],"int32"),l=0,h=0;l<i.length;l++)s.has(i[l])||(u.values[h]=i[l],c.values[h]=l,h++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},fill:zq,linspace:function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return uW.runKernel((function(r){return r.linspace(t,e,n)}),{})},ones:Vq,range:Wq,scalar:Mq,tensor:Dq,tensor1d:Fq,tensor2d:Lq,tensor3d:Bq,tensor4d:jq,tensor5d:function(t,e,n){if(nz(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=mq(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Pq(t,e,r,n)},tensor6d:function(t,e,n){if(nz(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=mq(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Pq(t,e=e||r,r,n)},zeros:Uq,onesLike:qq,zerosLike:Hq,transpose:bQ,softmax:QH,logSoftmax:JH,localResponseNormalization:wQ,norm:_Q,gather:_Y,unsortedSegmentSum:xY,basicLSTMCell:xQ,multiRNNCell:CQ,movingAverage:EQ,stridedSlice:SQ,topk:IQ,scatterND:kQ,fft:TQ,ifft:AQ,rfft:RQ,irfft:OQ,sparseToDense:DQ,gatherND:PQ,diag:MQ,dropout:FQ,hannWindow:jQ,hammingWindow:VQ,frame:UQ,stft:zQ,inTopKAsync:function(t,e,n){return void 0===n&&(n=1),qU(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,d,f,p,m,g;return HU(this,(function(v){switch(v.label){case 0:return r=vq(t,"predictions","inTopK"),i=vq(e,"targets","inTopK"),tz(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),tz(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),ez(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],tz(n>0&&n<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n})),[4,r.data()];case 1:return s=v.sent(),[4,i.data()];case 2:for(a=v.sent(),l=(u=[s.length/o,o])[1],h=pz("bool",c=u[0]),d=0;d<c;d++){for(p=s.subarray(f=d*l,f+l),m=[],g=0;g<p.length;g++)m.push({value:p[g],index:g});for(m.sort((function(t,e){return e.value-t.value})),h[d]=0,g=0;g<n;g++)if(m[g].index===a[d]){h[d]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,Dq(h,i.shape,"bool")]}}))}))}});function pJ(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var mJ=function(){function t(){if(this.blockSize=48,this.firstUse=!0,KU.get("IS_BROWSER")){var t="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==t&&(this.fromPixels2DContext=t.getContext("2d"))}this.data=new ZH(this,uW)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,KU.get("IS_NODE")&&pq("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,i=t.data instanceof Uint8Array,o="undefined"!=typeof ImageData&&t instanceof ImageData,s="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,u=s?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=u[0],l=u[1];if(KU.get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,c,l).data;else if(o||i)n=t.data;else{if(!a&&!s)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=l,this.fromPixels2DContext.drawImage(t,0,0,c,l),n=this.fromPixels2DContext.getImageData(0,0,c,l).data}if(4===e)r=new Int32Array(n);else{var h=c*l;r=new Int32Array(h*e);for(var d=0;d<h;d++)for(var f=0;f<e;++f)r[d*e+f]=n[4*d+f]}return Bq(r,[l,c,e],"int32")},t.prototype.read=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?yG(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return Fz(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return lH(t.shape,t.dtype,n)},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){return e=Dz(),t(),[2,{kernelMs:Dz()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=Gz.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:uW.keep(t.clone()),imag:uW.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&tz("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),KH(t.shape,e,n)){var r=XH(e,t.strides),i=iz(n);return Dq(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=lH(n,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a).map((function(t,n){return t+e[n]}));o.values[a]=s.get.apply(s,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r){this.assertNotComplex(t,"stridedSlice");var i=HH(e,n,r);if(i.some((function(t){return 0===t})))return Dq([],i);for(var o=lH(i,t.dtype),s=this.bufferSync(t),a=0;a<o.size;a++){for(var u=o.indexToLoc(a),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];o.set.apply(o,[s.get.apply(s,c)].concat(u))}return o.toTensor()},t.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=lH([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=lH(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),s=o.slice();e.forEach((function(e){return s[e]=t.shape[e]-1-s[e]})),n.set.apply(n,[r.get.apply(r,s)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return Oq(t)})),i=t.map((function(t){return Nq(t)}));return Rq(this.concat(r,e),this.concat(i,e))}var o=t.map((function(t){var n=iz(t.shape.slice(e));return t.as2D(-1,n)})),s=Tq(o.map((function(t){return t.shape})),1),a=lH(s,t[0].dtype).values;if(1===o[0].shape[0]){var u=0;o.forEach((function(t){a.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;o.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var o=i*s[1]+c,u=0;u<t.shape[1];++u)a[o+u]=e[r++];c+=t.shape[1]}))}var l=Tq(t.map((function(t){return t.shape})),e);return Dq(a,l,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(Mq(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,tW(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=lH(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var s=n[o],a=0;a<i.length;a++)i[a]+=s[a];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,tW(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],s=r?e.shape[1]:e.shape[2],a=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],d=l[1],f=l[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=p[0],g=p[1],v=p[2],y=o*s,b=lH([a,o,s],t.dtype),w=b.values,_=this.blockSize,x=0;x<a;x++)for(var C=0;C<o;C+=_)for(var E=0;E<s;E+=_)for(var S=0;S<i;S+=_)for(var I=Math.min(C+_,o),k=Math.min(E+_,s),T=Math.min(S+_,i),A=C;A<I;A++)for(var R=E;R<k;R++){for(var O=0,N=S;N<T;N++)O+=u[x*h+A*d+N*f]*c[N*m+R*g+x*v];w[x*y+(A*s+R)]+=O}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.batchMatMul(t.a,t.b,t.transposeA,t.transposeB);return e&&(i=this.add(i,e)),n&&(i=pJ(this,i,n,r)),i},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,tW(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),Cq("sum",e,t.rank);for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],tW(t.dtype,"int32")),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=0,h=0;h<o;++h)l+=a[c+h];s[u]=l}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],tW(t.dtype,"int32")),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=1,h=0;h<o;++h)l*=a[c+h];s[u]=l}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var s=Mq(o,"int32"),a=aY(s,e).asType("float32").mul(t).sum(0);r.push(a)}return NH(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];Cq("argMin",n,t.rank);for(var r=_q(t.shape,n),i=r[1],o=Uq(r[0],"int32"),s=iz(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<a.length;++c){for(var l=c*s,h=u[l],d=0,f=0;f<s;++f){var p=u[l+f];p<h&&(h=p,d=f)}a[c]=d}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];Cq("argMax",n,t.rank);for(var r=_q(t.shape,n),i=r[1],o=Uq(r[0],"int32"),s=iz(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<a.length;++c){for(var l=c*s,h=u[l],d=0,f=0;f<s;++f){var p=u[l+f];p>h&&(h=p,d=f)}a[c]=d}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=tW(t.dtype,"int32"),o=Uq(t.shape,i),s=this.readSync(o.dataId),a=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<a.length;l+=u)for(var h=0;h<u;h++){var d=c(l,h);if(0===h)s[d]=n?0:a[d];else{var f=c(l,h-1);s[d]=n?a[f]+s[f]:a[d]+s[f]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return Gz.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),s=Uq(e.shape,tW(e.dtype,n.dtype)),a=this.readSync(s.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],l=0;l<r.length;l++)for(var h=0;h<c;h++)a[u++]=1===r[l]?i[l]:o[l];return s},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return kG(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),IG(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),Cq("min",e,t.rank);for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],t.dtype),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h){var d=a[c+h];d<l&&(l=d)}s[u]=l}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),Cq("max",e,t.rank);for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],t.dtype),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h){var d=a[c+h];d>l&&(l=d)}s[u]=l}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),Cq("all",e,t.rank);for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],t.dtype),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h)l=l&&a[c+h];s[u]=l}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),Cq("any",e,t.rank);for(var n=_q(t.shape,e),r=n[1],i=Uq(n[0],t.dtype),o=iz(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,l=a[c],h=0;h<o;++h)l=l||a[c+h];s[u]=l}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return Gz.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return Gz.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return Gz.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return Gz.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return Gz.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return Gz.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return Gz.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return Gz.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=Uq(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return Gz.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var s=r[o];n[o]=s>=1?i[o]:i[o]*(s+1)}return Gz.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return Gz.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>n?n:s<e?e:s}return Gz.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return Gz.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return Gz.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return Gz.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,s=r[i]>-e,a=r[i]<e,u=Math.exp(r[i]);o=a?u:s?r[i]:Math.log(1+u),n[i]=o}return Gz.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=az(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return Gz.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r],o=1/(1+.3275911*i);e[r]=1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i)}return Gz.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return Gz.make(t.shape,{values:n})},t.prototype.fusedConv2d=function(t,e,n,r,i,o){var s=this.conv2d(t,e,n);return r&&(s=this.add(s,r)),i&&(s=pJ(this,s,i,o)),s},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=lH(n.outShape,t.dtype),h=t.strides[0],d=c?t.strides[1]:t.strides[2],f=c?t.strides[2]:1,p=c?1:t.strides[1],m=l.strides[0],g=c?l.strides[1]:l.strides[2],v=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(t.dataId),w=this.readSync(e.dataId),_=l.values,x=0;x<n.batchSize;++x)for(var C=x*h,E=x*m,S=0;S<n.outHeight;++S)for(var I=E+S*g,k=S*n.strideHeight-u,T=0;T<r;T++){var A=k+T*o;if(!(A<0||A>=n.inHeight))for(var R=T*e.strides[0],O=C+A*d,N=0;N<n.outWidth;++N)for(var D=I+N*v,P=N*n.strideWidth-a,M=0;M<i;M++){var F=P+M*s;if(!(F<0||F>=n.inWidth))for(var L=O+F*f,B=R+M*e.strides[1],j=0;j<n.inChannels;++j){for(var V=b[L+j*p],U=0;U<n.outChannels;++U)_[D+U*y]+=V*w[B+U];B+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,s=n.dilationDepth,a=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,d=lH(n.outShape,t.dtype),f=this.readSync(t.dataId),p=this.readSync(e.dataId),m=d.values,g=0;g<n.batchSize;++g)for(var v=g*t.strides[0],y=g*d.strides[0],b=0;b<n.outDepth;++b)for(var w=y+b*d.strides[1],_=b*n.strideDepth-c,x=0;x<r;x++){var C=_+x*s;if(!(C<0||C>=n.inDepth))for(var E=x*e.strides[0],S=v+C*t.strides[1],I=0;I<n.outHeight;++I)for(var k=w+I*d.strides[2],T=I*n.strideHeight-h,A=0;A<i;A++){var R=T+A*a;if(!(R<0||R>=n.inHeight))for(var O=E+A*e.strides[1],N=S+R*t.strides[2],D=0;D<n.outWidth;++D)for(var P=k+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<o;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=N+L*n.inChannels,j=O+F*e.strides[2],V=0;V<n.inChannels;++V){for(var U=f[B+V],z=0;z<n.outChannels;++z)m[P+z]+=U*p[j+z];j+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=lH(n.inShape,"float32"),i=r.values,o=this.readSync(t.dataId),s=this.readSync(e.dataId),a=e.strides,u=a[0],c=a[1],l=a[2],h=n.batchSize,d=n.filterHeight,f=n.filterWidth,p=n.inChannels,m=n.inHeight,g=n.inWidth,v=n.outChannels,y=n.outHeight,b=n.outWidth,w=n.strideHeight,_=n.strideWidth,x=d-1-n.padInfo.top,C=f-1-n.padInfo.left,E="channelsLast"===n.dataFormat,S=r.strides[0],I=E?r.strides[1]:r.strides[2],k=E?r.strides[2]:1,T=E?1:r.strides[1],A=t.strides[0],R=E?t.strides[1]:t.strides[2],O=E?t.strides[2]:1,N=E?1:t.strides[1],D=0;D<h;++D)for(var P=0;P<p;++P)for(var M=0;M<m;++M)for(var F=M-x,L=Math.max(0,Math.ceil(F/w)),B=Math.min(y,(d+F)/w),j=0;j<g;++j){for(var V=j-C,U=Math.max(0,Math.ceil(V/_)),z=Math.min(b,(f+V)/_),W=0,q=L;q<B;++q)for(var H=q*w-F,G=U;G<z;++G)for(var $=A*D+R*q+O*G,K=u*(d-1-H)+c*(f-1-(G*_-V))+l*P,X=0;X<v;++X)W+=o[$+N*X]*s[K+X];i[S*D+I*M+k*j+T*P]=W}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=lH(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],c=o[3],l=this.readSync(t.dataId),h=t.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),v=e.strides,y=v[0],b=v[1],w=v[2],_=v[3],x=n.batchSize,C=n.filterDepth,E=n.filterHeight,S=n.filterWidth,I=n.inChannels,k=n.inDepth,T=n.inHeight,A=n.inWidth,R=n.outChannels,O=n.outDepth,N=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=C-1-n.padInfo.front,B=E-1-n.padInfo.top,j=S-1-n.padInfo.left,V=0;V<x;++V)for(var U=0;U<I;++U)for(var z=0;z<k;++z)for(var W=z-L,q=Math.max(0,Math.ceil(W/P)),H=Math.min(O,(C+W)/P),G=0;G<T;++G)for(var $=G-B,K=Math.max(0,Math.ceil($/M)),X=Math.min(N,(E+$)/M),Y=0;Y<A;++Y){for(var Q=Y-j,J=Math.max(0,Math.ceil(Q/F)),Z=Math.min(D,(S+Q)/F),tt=0,et=q;et<H;++et)for(var nt=et*P-W,rt=K;rt<X;++rt)for(var it=rt*M-$,ot=J;ot<Z;++ot)for(var st=d*V+f*et+p*rt+m*ot,at=y*(C-1-nt)+b*(E-1-it)+w*(S-1-(ot*F-Q))+_*U,ut=0;ut<R;++ut)tt+=l[st+ut]*g[at+ut];i[s*V+a*z+u*G+c*Y+U]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a="channelsLast"===n.dataFormat,u=lH(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(t),d=this.bufferSync(e),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((l-f)/r)),m=Math.min(n.outHeight,(n.inHeight+l-f)/r),g=0;g<s;++g)for(var v=Math.max(0,Math.ceil((c-g)/i)),y=Math.min(n.outWidth,(n.inWidth+c-g)/i),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var _=0,x=0;x<n.batchSize;++x)for(var C=p;C<m;++C)for(var E=f+C*r-l,S=v;S<y;++S){var I=g+S*i-c;_+=a?h.get(x,E,I,b)*d.get(x,C,S,w):h.get(x,b,E,I)*d.get(x,w,C,S)}u.set(_,f,g,b,w)}return u.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,s=n.filterDepth,a=n.filterHeight,u=n.filterWidth,c=lH(n.filterShape,"float32"),l=c.values,h=c.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),v=e.strides,y=v[0],b=v[1],w=v[2],_=v[3],x=this.readSync(t.dataId),C=t.strides,E=C[0],S=C[1],I=C[2],k=C[3],T=n.padInfo.front,A=n.padInfo.left,R=n.padInfo.top,O=0;O<s;++O)for(var N=Math.max(0,Math.ceil((T-O)/r)),D=Math.min(n.outDepth,(n.inDepth+T-O)/r),P=O*d,M=0;M<a;++M)for(var F=Math.max(0,Math.ceil((R-M)/i)),L=Math.min(n.outHeight,(n.inHeight+R-M)/i),B=M*f+P,j=0;j<u;++j)for(var V=Math.max(0,Math.ceil((A-j)/o)),U=Math.min(n.outWidth,(n.inWidth+A-j)/o),z=j*p+B,W=0;W<n.inChannels;++W)for(var q=W*m+z,H=0;H<n.outChannels;++H){for(var G=0,$=0;$<n.batchSize;++$)for(var K=$*E,X=$*y,Y=N;Y<D;++Y)for(var Q=(O+Y*r-T)*S+K,J=Y*b+X,Z=F;Z<L;++Z)for(var tt=(M+Z*i-R)*I+Q,et=Z*w+J,nt=V;nt<U;++nt)G+=x[(j+nt*o-A)*k+tt+W]*g[nt*_+et+H];l[q+H]=G}return c.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=lH(n.outShape,t.dtype),h=this.readSync(t.dataId),d=this.readSync(e.dataId),f=l.values,p=0;p<n.batchSize;++p)for(var m=p*t.strides[0],g=p*l.strides[0],v=0;v<n.outHeight;++v)for(var y=g+v*l.strides[1],b=v*n.strideHeight-a,w=0;w<r;++w){var _=b+w*o;if(!(_<0||_>=n.inHeight))for(var x=w*e.strides[0],C=m+_*t.strides[1],E=0;E<n.outWidth;++E)for(var S=y+E*l.strides[2],I=E*n.strideWidth-u,k=0;k<i;++k){var T=I+k*s;if(!(T<0||T>=n.inWidth))for(var A=C+T*n.inChannels,R=S,O=x+k*e.strides[1],N=0;N<n.inChannels;++N){for(var D=h[A+N],P=0;P<c;++P)f[R+P]+=D*d[O+P];R+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=lH(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],d=l[1],f=l[2],p=this.readSync(e.dataId),m=e.strides,g=m[0],v=m[1],y=m[2],b=n.batchSize,w=n.filterHeight,_=n.filterWidth,x=n.inChannels,C=n.inHeight,E=n.inWidth,S=n.outHeight,I=n.outWidth,k=n.strideHeight,T=n.strideWidth,A=w-1-n.padInfo.top,R=_-1-n.padInfo.left,O=n.outChannels/x,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-A,F=Math.max(0,Math.ceil(M/k)),L=Math.min(S,(w+M)/k),B=0;B<E;++B){for(var j=B-R,V=Math.max(0,Math.ceil(j/T)),U=Math.min(I,(_+j)/T),z=0,W=F;W<L;++W)for(var q=W*k-M,H=V;H<U;++H)for(var G=h*N+d*W+f*H,$=g*(w-1-q)+v*(_-1-(H*T-j))+y*D,K=0;K<O;++K)z+=c[G+(D*O+K)]*p[$+K];i[s*N+a*P+u*B+D]=z}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=lH(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),d=this.bufferSync(e),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),g=0;g<s;++g)for(var v=Math.max(0,Math.ceil((u-g)/i)),y=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/l),_=b%l,x=0,C=0;C<n.batchSize;++C)for(var E=p;E<m;++E)for(var S=f+E*r-c,I=v;I<y;++I)x+=h.get(C,S,g+I*i-u,w)*d.get(C,E,I,b);a.set(x,f,g,w,_)}return a.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),SG(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),s=lH(r,t.dtype);0!==n&&s.values.fill(n);for(var a=0;a<t.size;a++){var u=o.indexToLoc(a),c=u.map((function(t,e){return t+i[e]}));s.set.apply(s,[o.get.apply(o,u)].concat(c))}return s.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=lH(n,t.dtype),s=this.bufferSync(t);for(r=0;r<t.size;++r){for(var a=s.indexToLoc(r),u=new Array(a.length),c=0;c<u.length;c++)u[c]=a[e[c]];var l=o.locToIndex(u);o.values[l]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=lH(r,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a),c=u.slice();c[n]=i[u[n]];var l=s.locToIndex(c);o.values[a]=s.values[l]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=FH(t.shape,e,r),o=LH(i.length,e.length),s=BH(t.shape,e,r),a=jH(n,e.length),u=VH(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=FH(s.shape,e,r,!1),u=LH(a.length,e.length,!1),c=BH(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(c)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(t.dataId),f=lH(e.outShape,t.dtype),p=f.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],g=e.outShape[2]*e.outShape[3],v=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*m,w=y*t.strides[0],_=0;_<e.inChannels;++_)for(var x=0;x<e.outHeight;++x)for(var C=x*r-c,E=Math.max(0,C),S=Math.min(e.inHeight,a+C),I=b+x*g,k=0;k<e.outWidth;++k){for(var T=k*i-l,A=Math.max(0,T),R=Math.min(e.inWidth,u+T),O=h,N=0,D=0,P=E;P<S;P+=o){for(var M=w+P*t.strides[1],F=A;F<R;F+=s){var L=d[M+F*t.strides[2]+_];"max"===n&&L>O?O=L:"avg"===n&&(N+=L,D++)}if(isNaN(O))break}p[I+k*v+_]="avg"===n?N/D:O}return f.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=lH(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),d=0;d<e.batchSize;++d)for(var f=0;f<e.inChannels;++f)for(var p=0;p<e.outHeight;++p){for(var m=p*r-c,g=m;g<0;)g+=o;for(var v=Math.min(e.inHeight,a+m),y=0;y<e.outWidth;++y){for(var b=y*i-l,w=b;w<0;)w+=s;for(var _=Math.min(e.inWidth,u+b),x=Number.NEGATIVE_INFINITY,C=-1,E=g;E<v;E+=o)for(var S=E-m,I=w;I<_;I+=s){var k=I-b,T=h.get(d,E,I,f);T>x&&(x=T,C=S*u+k)}n.set(C,d,p,y,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,d=c-1-r.padInfo.top,f=lH(e.shape,"float32"),p=this.bufferSync(i),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var w=y-d,_=b-h,x=0,C=0;C<c;C+=a){var E=(w+C)/o;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var S=0;S<l;S+=u){var I=(_+S)/s;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var k=c*l-1-p.get(g,E,I,v)===C*l+S?1:0;0!==k&&(x+=m.get(g,E,I,v)*k)}}}f.set(x,g,y,b,v)}return f.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,d=c-1-n.padInfo.top,f=lH(e.shape,"float32"),p=1/(o*s),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var v=0;v<n.inChannels;++v)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var w=y-d,_=b-h,x=0,C=0;C<c;C+=a){var E=(w+C)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var S=0;S<l;S+=u){var I=(_+S)/i;I<0||I>=n.outWidth||Math.floor(I)!==I||(x+=m.get(g,E,I,v))}}f.set(x*p,g,y,b,v)}return f.toTensor()},t.prototype.pool3d=function(t,e,n){this.assertNotComplex(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),v=lH(e.outShape,t.dtype),y=v.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[2]*e.outShape[3]*e.outShape[4],_=e.outShape[3]*e.outShape[4],x=e.outShape[4],C=0;C<e.batchSize;++C)for(var E=C*b,S=C*t.strides[0],I=0;I<e.inChannels;++I)for(var k=0;k<e.outDepth;++k){for(var T=k*r-d,A=T;A<0;)A+=s;for(var R=Math.min(e.inDepth,c+T),O=E+k*w,N=0;N<e.outHeight;++N){for(var D=N*i-f,P=D;P<0;)P+=a;for(var M=Math.min(e.inHeight,l+D),F=O+N*_,L=0;L<e.outWidth;++L){for(var B=L*o-p,j=B;j<0;)j+=u;for(var V=Math.min(e.inWidth,h+B),U=F+L*x,z=m,W=0,q=0,H=A;H<R;H+=s){for(var G=S+H*t.strides[1],$=P;$<M;$+=a){for(var K=G+$*t.strides[2],X=j;X<V;X+=u){var Y=g[K+X*t.strides[3]+I];if("max"===n&&Y>z?z=Y:"avg"===n&&(W+=Y,q++),isNaN(z))break}if(isNaN(z))break}if(isNaN(z))break}y[U+I]="avg"===n?W/q:z}}}return v.toTensor()},t.prototype.avgPool3d=function(t,e){return this.assertNotComplex(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,s=n.filterDepth,a=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=d-1-n.padInfo.front,g=p-1-n.padInfo.left,v=f-1-n.padInfo.top,y=lH(e.shape,"float32"),b=1/(s*a*u),w=this.bufferSync(t),_=0;_<n.batchSize;++_)for(var x=0;x<n.inChannels;++x)for(var C=0;C<n.inDepth;++C)for(var E=0;E<n.inHeight;++E)for(var S=0;S<n.inWidth;++S){for(var I=C-m,k=E-v,T=S-g,A=0,R=0;R<d;R+=c){var O=(I+R)/r;if(!(O<0||O>=n.outDepth||Math.floor(O)!==O))for(var N=0;N<f;N+=l){var D=(k+N)/i;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var P=0;P<p;P+=h){var M=(T+P)/o;M<0||M>=n.outWidth||Math.floor(M)!==M||(A+=w.get(_,O,D,M,x))}}}y.set(A*b,_,C,E,S,x)}return y.toTensor()},t.prototype.maxPool3d=function(t,e){return this.assertNotComplex(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},t.prototype.maxPool3dPositions=function(t,e){for(var n=lH(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left,m=this.bufferSync(t),g=0;g<e.batchSize;++g)for(var v=0;v<e.inChannels;++v)for(var y=0;y<e.outDepth;++y){for(var b=y*r-d,w=b;w<0;)w+=s;for(var _=Math.min(e.inDepth,c+b),x=0;x<e.outHeight;++x){for(var C=x*i-f,E=C;E<0;)E+=a;for(var S=Math.min(e.inHeight,l+C),I=0;I<e.outWidth;++I){for(var k=I*o-p,T=k;T<0;)T+=u;for(var A=Math.min(e.inWidth,h+k),R=Number.NEGATIVE_INFINITY,O=-1,N=w;N<_;N+=s)for(var D=N-b,P=E;P<S;P+=a)for(var M=P-C,F=T;F<A;F+=u){var L=F-k,B=m.get(g,N,P,F,v);B>=R&&(R=B,O=D*l*h+M*l+L)}n.set(O,g,y,x,I,v)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=h-1-r.padInfo.front,m=f-1-r.padInfo.left,g=d-1-r.padInfo.top,v=lH(e.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var _=0;_<r.inChannels;++_)for(var x=0;x<r.inDepth;++x)for(var C=0;C<r.inHeight;++C)for(var E=0;E<r.inWidth;++E){for(var S=x-p,I=C-g,k=E-m,T=0,A=0;A<h;A+=u){var R=(S+A)/o;if(!(R<0||R>=r.outDepth||Math.floor(R)!==R))for(var O=0;O<d;O+=c){var N=(I+O)/s;if(!(N<0||N>=r.outHeight||Math.floor(N)!==N))for(var D=0;D<f;D+=l){var P=(k+D)/a;if(!(P<0||P>=r.outWidth||Math.floor(P)!==P)){var M=h*d*f-1-y.get(w,R,N,P,_)===A*d*f+O*f+D?1:0;0!==M&&(T+=b.get(w,R,N,P,_)*M)}}}}v.set(T,w,x,C,E,_)}return v.toTensor()},t.prototype.cast=function(t,e){return mG(t,e,this)},t.prototype.reshape=function(t,e){return gG(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(iz([o,e,n,u])),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=0,p=h[0]/d[0],m=h[1]/d[1],g=0;g<o;g++)for(var v=0;v<e;v++)for(var y=p*v,b=Math.floor(y),w=y-b,_=Math.min(s-1,Math.ceil(y)),x=g*t.strides[0]+b*t.strides[1],C=g*t.strides[0]+_*t.strides[1],E=0;E<n;E++)for(var S=m*E,I=Math.floor(S),k=S-I,T=Math.min(a-1,Math.ceil(S)),A=x+I*t.strides[2],R=C+I*t.strides[2],O=x+ +T*t.strides[2],N=C+T*t.strides[2],D=0;D<u;D++){var P=c[A+D],M=c[R+D],F=P+(c[O+D]-P)*k;l[f++]=F+(M+(c[N+D]-M)*k-F)*w}return Dq(l,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*s*a),d=[n&&c>1?o-1:o,n&&l>1?s-1:s],f=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=d[0]/f[0],m=d[1]/f[1],g=this.readSync(t.dataId),v=0,y=0;y<i;y++)for(var b=y*e.strides[0],w=0;w<c;w++)for(var _=w*p,x=Math.floor(_),C=Math.min(Math.ceil(_),o-1),E=b+x*e.strides[1],S=b+C*e.strides[1],I=_-x,k=1-I,T=0;T<l;T++)for(var A=T*m,R=Math.floor(A),O=Math.min(Math.ceil(A),s-1),N=A-R,D=1-N,P=E+R*e.strides[2],M=E+O*e.strides[2],F=S+R*e.strides[2],L=S+O*e.strides[2],B=k*D,j=k*N,V=I*D,U=I*N,z=0;z<a;z++){var W=g[v++];h[P+z]+=W*B,h[M+z]+=W*j,h[F+z]+=W*V,h[L+z]+=W*U}return jq(h,[i,s,o,a],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(o*e*n*u),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=h[0]/d[0],p=h[1]/d[1],m=0,g=0;g<o;g++)for(var v=g*t.strides[0],y=0;y<e;y++)for(var b=f*y,w=v+Math.min(s-1,r?Math.round(b):Math.floor(b))*t.strides[1],_=0;_<n;_++)for(var x=p*_,C=w+Math.min(a-1,r?Math.round(x):Math.floor(x))*t.strides[2],E=0;E<u;E++)l[m++]=c[C+E];return Dq(l,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*s*a),d=this.readSync(t.dataId),f=[n&&c>1?o-1:o,n&&l>1?s-1:s],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=f[0]/p[0],g=f[1]/p[1],v=1/m,y=1/g,b=2*Math.ceil(v)+2,w=2*Math.ceil(y)+2,_=0;_<i;_++)for(var x=_*e.strides[0],C=0;C<o;C++)for(var E=x+C*e.strides[1],S=Math.floor(C*v),I=Math.floor(S-b/2),k=0;k<s;k++)for(var T=E+k*e.strides[2],A=Math.floor(k*y),R=Math.floor(A-w/2),O=0;O<a;O++){for(var N=0,D=0;D<b;D++){var P=D+I;if(!(P<0||P>=c)){var M=x+P*t.strides[1],F=P*m;if(C===Math.min(o-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<w;L++){var B=L+R;if(!(B<0||B>=l)){var j=M+B*t.strides[2],V=B*g;k===Math.min(s-1,n?Math.round(V):Math.floor(V))&&(N+=d[j+O])}}}}h[T+O]=N}return jq(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(s.length),d=l.length,f=c.length,p=u.length,m=a.length,g=0,v=0,y=0,b=0,w=0;w<s.length;++w)h[w]=l[g++]+(s[w]-a[v++])*c[y++]/Math.sqrt(u[b++]+r),g>=d&&(g=0),v>=m&&(v=0),y>=f&&(y=0),b>=p&&(b=0);return jq(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],s=o-1,a=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,s),u=0;r<=i;r++){var c=a[r];u+=c*c}return u}for(var h=0;h<u;h++){var d=l(h),f=a[h]*Math.pow(n+r*d,-i);c[h]=f}return jq(c,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){this.assertNotComplex(t,"LRNGrad");for(var a=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),d=t.size,f=0;f<d;f++){for(var p=f%a,m=f-p+Math.max(0,p-r),g=f-p+Math.min(a,p+r+1),v=0,y=m;y<g;y++)v+=Math.pow(c[y],2);for(v=o*v+i,y=m;y<g;y++){var b=-2*o*s*c[y]*l[f]/v;f===y&&(b+=Math.pow(v,-s)),h[y]+=b*=u[f]}}return jq(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:QH(t),o=i.shape[0],s=i.shape[1],a=Uq([o,n],"int32"),u=this.readSync(a.dataId),c=this.readSync(i.dataId),l=0;l<o;++l){var h=l*s,d=new Float32Array(s-1);d[0]=c[h];for(var f=1;f<d.length;++f)d[f]=d[f-1]+c[h+f];for(var p=sH(r.toString()),m=l*n,g=0;g<n;++g){var v=p();u[m+g]=d.length;for(var y=0;y<d.length;y++)if(v<d[y]){u[m+g]=y;break}}}return a},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),s=0;s<t.size;++s)o[s]>=0&&o[s]<e&&(i[s*e+o[s]]=n);return Lq(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),xG(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=lH(t.shape,"float32"),o=lH(t.shape,"float32"),s=Oq(t).as2D(n,r),a=Nq(t).as2D(n,r),u=0;u<n;u++)for(var c=s.slice([u,0],[1,r]),l=a.slice([u,0],[1,r]),h=Rq(c,l),d=this.readSync(this.fftImpl(h,e).dataId),f=0;f<r;f++){var p=bG(d,f);i.values[u*r+f]=p.real,o.values[u*r+f]=p.imag}return Rq(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=Rq(Oq(i).div(Mq(r)),Nq(i).div(Mq(r)))),i}var o=this.readSync(t.dataId),s=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return Rq(s.real,s.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),s=Rq(o.real,o.imag).as1D(),a=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=Rq(a.real,a.imag).as1D();s=this.fftRadix2(s,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),l=Rq(c.real,c.imag).mul(u),h=s.add(l),d=s.sub(l),f=Oq(h).concat(Oq(d)),p=Nq(h).concat(Nq(d));return Rq(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,s=0,a=0;a<e;a++){var u=_G(i*a,e,n),c=bG(t,a);o+=c.real*u.real-c.imag*u.imag,s+=c.real*u.imag+c.imag*u.real}n&&(o/=e,s/=e),wG(r,o,s,i)}return r},t.prototype.depthToSpace=function(t,e,n){tz("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),tz(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],s=t.shape[3],a=i*e,u=o*e,c=s/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*a*u*c),d=0,f=0;f<r;++f)for(var p=0;p<a;++p)for(var m=Math.floor(p/e),g=p%e,v=0;v<u;++v)for(var y=Math.floor(v/e),b=(g*e+v%e)*c,w=0;w<c;++w)h[d++]=l[w+b+s*(y+o*(m+i*f))];return jq(h,[r,a,u,c])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=nG(t.shape,e.shape),o=lH(i,n),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=tG(t.shape,i),c=tG(e.shape,i),l=o.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(s[h%s.length],a[h%a.length]);else{var d=this.bufferSync(t),f=this.bufferSync(e),p=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=d.locToIndex(h),m=i.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var g=f.locToIndex(m);l[n]=r(s[p],a[g])};for(h=0;h<l.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=nG(t.shape,e.shape),i=lH(r,"float32"),o=lH(r,"float32"),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=tG(t.shape,r),c=tG(e.shape,r),l=i.values,h=o.values;if(u.length+c.length===0)for(var d=0;d<l.length;d++){var f=d%s.length,p=d%a.length,m=n(s[2*f],s[2*f+1],a[2*p],a[2*p+1]);l[d]=m.real,h[d]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),v=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),d=o.slice(-t.rank);u.forEach((function(t){return d[t]=0}));var f=g.locToIndex(d),p=o.slice(-e.rank);c.forEach((function(t){return p[t]=0}));var m=v.locToIndex(p),y=n(s[2*f],s[2*f+1],a[2*m],a[2*m+1]);l[r]=y.real,h[r]=y.imag};for(d=0;d<l.length;d++)y(d)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return EG(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var s=t.shape,a=s[0],u=s[1],c=s[2],l=s[3],h=e.shape[0],d=r[0],f=r[1],p=lH([h,d,f,l],t.dtype),m=this.readSync(e.dataId),g=this.readSync(n.dataId),v=this.readSync(t.dataId),y=t.strides,b=p.strides,w=0;w<h;w++){var _=4*w,x=m[_],C=m[_+1],E=m[_+2],S=m[_+3],I=g[w];if(!(I>=a))for(var k=d>1?(E-x)*(u-1)/(d-1):0,T=f>1?(S-C)*(c-1)/(f-1):0,A=0;A<d;A++){var R=d>1?x*(u-1)+A*k:.5*(x+E)*(u-1);if(R<0||R>u-1)for(var O=0;O<f;O++)for(var N=0;N<l;N++){var D=N+O*b[2]+A*b[1]+w*b[0];p.values[D]=o}else if("bilinear"===i){var P=Math.floor(R),M=Math.ceil(R),F=R-P;for(O=0;O<f;O++)if((H=f>1?C*(c-1)+O*T:.5*(C+S)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=o;else{var L=Math.floor(H),B=Math.ceil(H),j=H-L;for(N=0;N<l;N++){var V=v[D=N+L*y[2]+P*y[1]+I*y[0]],U=v[D=N+B*y[2]+P*y[1]+I*y[0]],z=v[D=N+L*y[2]+M*y[1]+I*y[0]],W=V+(U-V)*j,q=z+(v[D=N+B*y[2]+M*y[1]+I*y[0]]-z)*j;p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=W+(q-W)*F}}}else for(O=0;O<f;++O){var H;if((H=f>1?C*(c-1)+O*T:.5*(C+S)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+w*b[0]]=o;else{var G=Math.round(H),$=Math.round(R);for(N=0;N<l;N++)p.values[N+O*b[2]+A*b[1]+w*b[0]]=v[N+G*y[2]+$*y[1]+I*y[0]]}}}}return p.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=WH(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=UH(t,e),o=i[0],s=i[1],a=i[2],u=i[3];if(0===s)return Dq([],o,t.dtype);for(var c=new zz([s,a],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),d=0;d<s;d++){for(var f=[],p=0,m=0;m<r;m++){var g=l[d*r+m];p+=g*u[m],f.push(g)}if(p<0||p>=t.size/a)throw new Error("Invalid indices: "+f+" does not index into "+t.shape);for(var v=0;v<a;v++)c.values[d*a+v]=h[p*a+v]}return c.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=WH(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,c=Mq(0);return this.scatter(t,e,n,u,s,o,i,a,c,!0)},t.prototype.fill=function(t,e,n){var r=mz(n=n||Sz(e),iz(t));return r.fill(e),Gz.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=mz(t.dtype,iz(t.shape));return Gz.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return vG(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,s,a,u,c){var l=[r/i,i],h=this.readSync(t.dataId),d=this.readSync(e.dataId);if(0===r)return Dq([],n,e.dtype);var f=new zz(l,e.dtype);f.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var m=[],g=0,v=0;v<s;v++){var y=h[p*s+v];m.push(y),g+=y*a[v]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)c?f.values[g*i+b]+=d[p*i+b]:f.values[g*i+b]=0===e.rank?d[0]:d[p*i+b]}return f.toTensor().reshape(n)},t}();uW.registerBackend("cpu",(function(){return new mJ}),1);var gJ=function(){function t(){this.textEncoder=new TextEncoder}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();KU.get("IS_BROWSER")&&KU.setPlatform("browser",new gJ);var vJ,yJ=function(){function t(){this.util=n(6),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=KU.global.fetch?KU.global.fetch(t,e):(null==vJ&&(vJ=n(5)),vJ(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();KU.get("IS_NODE")&&KU.setPlatform("node",new yJ);var bJ={float32:4,int32:4,uint16:2,uint8:1,bool:1};function wJ(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,s=e.shape,a=iz(s),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=bJ[c.dtype],h=t.slice(r,r+a*l),d="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(d,(function(t){return t*c.scale+c.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(d,(function(t){return Math.round(t*c.scale+c.min)}))}r+=a*l}else if("string"===o){var f=iz(e.shape);u=[];for(var p=0;p<f;p++){var m=new Uint32Array(t.slice(r,r+4))[0];r+=4;var g=new Uint8Array(t.slice(r,r+m));u.push(g),r+=m}}else{var v=bJ[o];if(h=t.slice(r,r+a*v),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=a*v}n[i]=Dq(u,s,o)},o=0,s=e;o<s.length;o++)i(s[o]);return n}function _J(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var xJ="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function CJ(t){return xJ?Buffer.byteLength(t):new Blob([t]).size}function EJ(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function SJ(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function IJ(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:CJ(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:CJ(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var kJ=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),TJ=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){tz(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),tz(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();tz(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function AJ(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+TJ.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}function RJ(t,e,n){return void 0===n&&(n=!1),qU(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h;return HU(this,(function(d){switch(d.label){case 0:return tz(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),tz((r=kJ.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),tz(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],tz((o=kJ.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),tz(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],a=AJ(t).scheme,u=AJ(t).path,c=a===AJ(t).scheme,[4,i.load()];case 1:return l=d.sent(),n&&c?[4,TJ.getManager(a).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,s.save(l)];case 4:return h=d.sent(),!n||c?[3,6]:[4,TJ.getManager(a).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}function OJ(){if(!KU.getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function NJ(t){var e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}var DJ=function(){function t(t){if(this.indexedDB=OJ(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return NJ(i)},i.onsuccess=function(){var o=i.result;if(null==e){var s=o.transaction("models_store","readonly"),a=s.objectStore("models_store").get(n.modelPath);a.onsuccess=function(){if(null==a.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(a.result.modelArtifacts)},a.onerror=function(t){return o.close(),r(a.error)},s.oncomplete=function(){return o.close()}}else{var u,c=IJ(e),l=o.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var i=(u=o.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore("model_info_store")).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},d.onerror=function(t){return o.close(),r(d.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),PJ=function(t){return KU.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(DJ.URL_SCHEME)?(e=t.slice(DJ.URL_SCHEME.length),new DJ(e)):null;var e};kJ.registerSaveRouter(PJ),kJ.registerLoadRouter(PJ);var MJ=function(){function t(){this.indexedDB=OJ()}return t.prototype.listModels=function(){return qU(this,void 0,void 0,(function(){var t=this;return HU(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return NJ(r)},r.onsuccess=function(){var t=r.result,i=t.transaction("model_info_store","readonly"),o=i.objectStore("model_info_store").getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return qU(this,void 0,void 0,(function(){var e=this;return HU(this,(function(n){var r;return t=(r=t).startsWith(DJ.URL_SCHEME)?r.slice(DJ.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return NJ(i)},i.onsuccess=function(){var e,o=i.result,s=o.transaction("model_info_store","readwrite"),a=s.objectStore("model_info_store"),u=a.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=a.delete(t),s=function(){var i=(e=o.transaction("models_store","readwrite")).objectStore("models_store").delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=s,i.onerror=function(t){return s(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},s.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(KU.getBool("IS_BROWSER"))try{TJ.registerManager(DJ.URL_SCHEME,new MJ)}catch(LO){}var FJ="tensorflowjs_models",LJ="info",BJ="model_topology",jJ="weight_specs",VJ="weight_data",UJ="model_metadata";function zJ(t){return{info:[FJ,t,LJ].join("/"),topology:[FJ,t,BJ].join("/"),weightSpecs:[FJ,t,jJ].join("/"),weightData:[FJ,t,VJ].join("/"),modelMetadata:[FJ,t,UJ].join("/")}}function WJ(t){var e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}var qJ=function(){function t(t){if(!KU.getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=zJ(this.modelPath)}return t.prototype.save=function(t){return qU(this,void 0,void 0,(function(){var e,n,r;return HU(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=IJ(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,xJ?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},t.prototype.load=function(){return qU(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return HU(this,(function(a){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(xJ){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),HJ=function(t){return KU.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(qJ.URL_SCHEME)?(e=t.slice(qJ.URL_SCHEME.length),new qJ(e)):null;var e};kJ.registerSaveRouter(HJ),kJ.registerLoadRouter(HJ);var GJ=function(){function t(){tz(KU.getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),tz(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return qU(this,void 0,void 0,(function(){var t,e,n,r,i,o;return HU(this,(function(s){for(t={},e=FJ+"/",n="/"+LJ,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=WJ(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return qU(this,void 0,void 0,(function(){var e,n;return HU(this,(function(r){var i;if(t=(i=t).startsWith(qJ.URL_SCHEME)?i.slice(qJ.URL_SCHEME.length):i,e=zJ(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(KU.getBool("IS_BROWSER"))try{TJ.registerManager(qJ.URL_SCHEME,new GJ)}catch(LO){}function $J(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var KJ=function(){function t(e){if(!KU.getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return qU(this,void 0,void 0,(function(){var e,n,r,i;return HU(this,(function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,$J((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,$J((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:IJ(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),XJ=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return qU(this,void 0,void 0,(function(){var t,e,n=this;return HU(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var s=JSON.parse(o.target.result),a=s.modelTopology;if(null!=a){0===e.length&&r({modelTopology:a});var u=s.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],d=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),d.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);d[i]=n,-1===d.indexOf(null)&&r({modelTopology:a,weightSpecs:l,weightData:EJ(d)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return SJ(t.name)})),i={},o=0,s=t;o<s.length;o++)s[o].paths.forEach((function(t){var o=SJ(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function YJ(t,e,n,r){!function(t){tz(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){tz(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),tz(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),tz(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var s=n+ ++i/t.length*(r-n);return e(s),o})),o})))}function QJ(t,e){return qU(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return HU(this,(function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?KU.platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=h.sent(),[3,4];case 2:return[4,YJ(r,e.onProgress,i,o)];case 3:s=h.sent(),h.label=4;case 4:return a=s.map((function(t){return t.arrayBuffer()})),u=.5,c=1,null!=e.onProgress?[3,6]:[4,Promise.all(a)];case 5:return l=h.sent(),[3,8];case 6:return[4,YJ(a,e.onProgress,u,c)];case 7:l=h.sent(),h.label=8;case 8:return[2,l]}}))}))}function JJ(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),qU(e,void 0,void 0,(function(){var e,o,s,a,u,c,l,h,d,f;return HU(this,(function(p){switch(p.label){case 0:if(e=n.map((function(){return!1})),o={},s=null!=i?i.map((function(){return!1})):[],a=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u=bJ["quantization"in t?t.quantization.dtype:t.dtype]*iz(t.shape),c=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach((function(e,n){e===t.name&&(c(),s[n]=!0)})):c(),a.push(t.name),r+=u}))})),!s.every((function(t){return t})))throw u=i.filter((function(t,e){return!s[e]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+a.join(", ")+".");return c=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),l=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;l.push(e)}))})),[4,t(l)];case 1:return h=p.sent(),d={},f=0,c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[f+i].byteLength;for(var s=new ArrayBuffer(r),a=new Uint8Array(s),u=0,c=0;c<e;c++){var l=new Uint8Array(h[f+c]);a.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=wJ(s.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)d[n]=e[n]})),f+=e})),[2,d]}}))}))}}kJ.registerSaveRouter((function(t){return KU.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(KJ.URL_SCHEME)?(void 0===(e=t.slice(KJ.URL_SCHEME.length))&&(e="model"),new KJ(e)):null;var e}));var ZJ=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(tz("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=KU.platform.fetch,tz(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&tz(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return qU(this,void 0,void 0,(function(){var e,n;return HU(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:IJ(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return qU(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a;return HU(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:a=u.sent(),o=a[0],s=a[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:s}]}}))}))},t.prototype.loadWeights=function(t){return qU(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,l;return HU(this,(function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,s=[],a=0,u=t;a<u.length;a++)s.push.apply(s,u[a].weights);return c=[],t.forEach((function(t){t.paths.forEach((function(t){c.push(o+t+i)}))})),[4,QJ(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return l=h.sent(),[2,[s,EJ(l)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function tZ(t){return null!=t.match(ZJ.URL_SCHEME_REGEX)}var eZ=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return tZ(t)})):tZ(t))?nZ(t,{onProgress:e}):null};function nZ(t,e){return new ZJ(t,e)}kJ.registerSaveRouter(eZ),kJ.registerLoadRouter(eZ);var rZ=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),iZ=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),oZ=Object.freeze({browserFiles:function(t){return new XJ(t)},browserHTTPRequest:function(t,e){return nZ(t,e)},concatenateArrayBuffers:EJ,decodeWeights:wJ,encodeWeights:function(t,e){return qU(this,void 0,void 0,(function(){var n,r,i,o,s,a=this;return HU(this,(function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),o=function(o){var s=i[o],u=Array.isArray(t)?t[o].tensor:t[s];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+s+"': "+u.dtype);var c={name:s,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(t){return qU(a,void 0,void 0,(function(){var e,n,r,i,o,s,a;return HU(this,(function(c){switch(c.label){case 0:return[4,u.bytes()];case 1:for(e=c.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),i=0,o=0;o<e.length;o++)s=e[o],a=new Uint8Array(new Uint32Array([s.length]).buffer),r.set(a,i),r.set(s,i+=4),i+=s.length;return t(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=e&&(c.group=e),n.push(c)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:_J(u.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new rZ(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rZ({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rZ({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return kJ.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:IJ,getSaveHandlers:function(t){return kJ.getSaveHandlers(t)},http:nZ,isHTTPScheme:tZ,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),qU(this,void 0,void 0,(function(){return HU(this,(function(i){return[2,JJ((function(t){return QJ(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return kJ.registerLoadRouter(t)},registerSaveRouter:function(t){return kJ.registerSaveRouter(t)},weightsLoaderFactory:JJ,withSaveHandler:function(t){return new iZ(t)},copyModel:function(t,e){return qU(this,void 0,void 0,(function(){return HU(this,(function(n){return[2,RJ(t,e,!1)]}))}))},listModels:function(){return qU(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return HU(this,(function(a){switch(a.label){case 0:t=TJ.getSchemes(),e={},n=0,r=t,a.label=1;case 1:return n<r.length?[4,TJ.getManager(i=r[n]).listModels()]:[3,4];case 2:for(s in o=a.sent())e[i+"://"+s]=o[s];a.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return qU(this,void 0,void 0,(function(){return HU(this,(function(n){return[2,RJ(t,e,!0)]}))}))},removeModel:function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){return e=AJ(t),[2,TJ.getManager(e.scheme).removeModel(e.path)]}))}))}}),sZ=Aq({confusionMatrix_:function(t,e,n){var r=vq(t,"labels","confusionMatrix"),i=vq(e,"predictions","confusionMatrix");tz(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),tz(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),tz(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),tz(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),tz(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=bH(r.asType("int32"),n),s=bH(i.asType("int32"),n);return o.transpose().matMul(s).asType("int32")}}),aZ=(Object.freeze({confusionMatrix:sZ}),Aq({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&n&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return uW.fromPixels(t,e)}})),uZ=Object.freeze({toPixels:function(t,e){return qU(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b,w,_,x;return HU(this,(function(C){switch(C.label){case 0:if(n=vq(t,"img","toPixels"),t instanceof Gz||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return a=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),h=l[0][0],d=l[1][0],u.dispose(),c.dispose(),"float32"===n.dtype){if(h<0||d>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+d+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||d>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+d+"].")}for(f="float32"===n.dtype?255:1,p=new Uint8ClampedArray(o*i*4),m=0;m<i*o;++m)g=void 0,v=void 0,y=void 0,b=void 0,1===s?(g=a[m]*f,v=a[m]*f,y=a[m]*f,b=255):3===s?(g=a[3*m]*f,v=a[3*m+1]*f,y=a[3*m+2]*f,b=255):4===s&&(g=a[4*m]*f,v=a[4*m+1]*f,y=a[4*m+2]*f,b=a[4*m+3]*f),p[0+(w=4*m)]=Math.round(g),p[w+1]=Math.round(v),p[w+2]=Math.round(y),p[w+3]=Math.round(b);return null!=e&&(e.width=o,e.height=i,_=e.getContext("2d"),x=new ImageData(p,o,i),_.putImageData(x,0,0)),n!==t&&n.dispose(),[2,p]}}))}))},fromPixels:aZ}),cZ=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),lZ=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function hZ(t){tz(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),tz("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),tz(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),lZ.register(t)}function dZ(){return 32===uW.backend.floatPrecision()?.001:.1}function fZ(t,e,n){var r=!0;if((bz(t)||bz(e))&&(r=!1),bz(t)&&bz(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var s=mq(t),a=mq(e);if(!oz(s,a))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+a+"]")}var u=bz(t)?t:rz(t),c=bz(e)?e:rz(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],d=c[l];if(!n(h,d))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+d+".\nActual:   "+u+".\nExpected: "+c+".")}}function pZ(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({Serializable:cZ,SerializationMap:lZ,registerClass:hZ}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=dZ()),fZ(t,e,(function(t,e){return pZ(t,e,n)}))},testEpsilon:dZ,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return xz(t)||xz(t[0])||xz(e)||xz(e[0])?fZ(t,n,(function(t,e){return t==e})):fZ(t,e,(function(t,e){return pZ(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=dZ()),!pZ(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Object.freeze({gpgpu_util:G$,webgl_util:lq,forceHalfFloat:function(){KU.set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:BK,setWebGLContext:pW,GPGPUContext:$$});var mZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return WU(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var s=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(s)}else this.applyGradients(o);return fq(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){tz(Iz(t),(function(){return"The f passed in variableGrads(f) must be a function"})),tz(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof Jz})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],uW.registeredVariables)e.push(uW.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;tz((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=uW.gradients(t,e,null,!0),a=s.value,u=s.grads;tz(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),tz(0===a.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:a,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&fq(this.iterations_)},e.prototype.saveIterations=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Mq(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(cZ);Object.defineProperty(mZ,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var gZ=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=uW.backend.epsilon()),i}return WU(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=uW.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:dq((function(){return Hq(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:dq((function(){return Hq(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable,a=e.accumulatedUpdates[r].variable;dq((function(){var t=s.mul(e.rho).add(o.square().mul(1-e.rho)),n=a.add(e.epsilon).sqrt().div(s.add(e.epsilon).sqrt()).mul(o),r=a.mul(e.rho).add(n.square().mul(1-e.rho));s.assign(t),a.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(fq(this.accumulatedGrads.map((function(t){return t.variable}))),fq(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(mZ);hZ(gZ);var vZ=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return WU(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=uW.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:dq((function(){return zq(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable;dq((function(){var t=s.add(o.square());s.assign(t);var n=o.div(t.add(uW.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&fq(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(mZ);hZ(vZ);var yZ=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],dq((function(){o.accBeta1=Mq(n).variable(),o.accBeta2=Mq(r).variable()})),null==i&&(o.epsilon=uW.backend.epsilon()),o}return WU(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);dq((function(){var r=oY(1,e.accBeta1),i=oY(1,e.accBeta2);n.forEach((function(n,o){var s=uW.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:dq((function(){return Hq(s).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:dq((function(){return Hq(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedSecondMoment[o].variable,l=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=c.mul(e.beta2).add(a.square().mul(1-e.beta2)),d=l.div(r),f=h.div(i);u.assign(l),c.assign(h);var p=d.div(f.sqrt().add(e.epsilon)).mul(-e.learningRate).add(s);s.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&fq(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&fq(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){var e,n=this;return HU(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),dq((function(){n.accBeta1.assign(eY(n.beta1,n.iterations_+1)),n.accBeta2.assign(eY(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(mZ);hZ(yZ);var bZ=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var s=t.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=r,s.epsilon=i,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],dq((function(){s.iteration=Mq(0).variable(),s.accBeta1=Mq(n).variable()})),null==i&&(s.epsilon=uW.backend.epsilon()),s}return WU(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);dq((function(){var r=oY(1,e.accBeta1),i=qX(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var s=uW.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:Hq(s).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:Hq(s).variable(!1)});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedWeightedInfNorm[o].variable,l=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=c.mul(e.beta2),d=a.abs(),f=h.maximum(d);u.assign(l),c.assign(f);var p=i.div(r).mul(l.div(f.add(e.epsilon))).add(s);s.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&fq(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&fq(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(mZ);hZ(bZ);var wZ=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return WU(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=uW.registeredVariables[n];dq((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function(t){return uW.keep(t)}(Mq(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(mZ);hZ(wZ);var _Z=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=Mq(i.momentum),i}return WU(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=uW.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:dq((function(){return Hq(i).variable(!1)}))});var o=e.accumulations[r].variable,s=Array.isArray(t)?t[r].tensor:t[n];null!=s&&dq((function(){var t,n=e.m.mul(o).add(s);t=e.useNesterov?e.c.mul(s.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&fq(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){return HU(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){return HU(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(wZ);hZ(_Z);var xZ=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var s=t.call(this)||this;return s.learningRate=e,s.decay=n,s.momentum=r,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,null==i&&(s.epsilon=uW.backend.epsilon()),s}return WU(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=uW.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:dq((function(){return Hq(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:dq((function(){return Hq(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:dq((function(){return Hq(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,a=e.accumulatedMoments[r].variable;dq((function(){var t=s.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),c=a.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));s.assign(t),n.assign(u),a.assign(c);var l=i.sub(c);i.assign(l)}else{var h=s.mul(e.decay).add(o.square().mul(1-e.decay));c=a.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),s.assign(h),a.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&fq(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&fq(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&fq(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return qU(this,void 0,void 0,(function(){var t;return HU(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return qU(this,void 0,void 0,(function(){var e;return HU(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(mZ);hZ(xZ),function(){function t(){}t.sgd=function(t){return new wZ(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new _Z(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new xZ(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new yZ(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new gZ(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new bZ(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new vZ(t,e)}}(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate,qz=fJ;var CZ=function(){function t(t,e){if(!DZ(t)||!DZ(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}(),EZ=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}();function SZ(t,e){return t instanceof Gz&&t.shape.length===e}function IZ(t){return SZ(t,3)}function kZ(t){return SZ(t,4)}function TZ(t){return t%2==0}function AZ(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function RZ(t){return t&&t.width&&t.height}function OZ(t){return t.reduce((function(t,e){return t.add(e)}),new EZ(0,0)).div(new EZ(t.length,t.length))}function NZ(t,e,n){return Array(t).fill(0).map((function(t,r){return e+r*n}))}function DZ(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}var PZ,MZ=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(DZ),o=[r.x,r.y,r.width,r.height].every(DZ);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var s=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=s[0],u=s[1],c=s[2],l=s[3];t.assertIsValidBox({x:a,y:u,width:c,height:l},"Box.constructor",n),this._x=a,this._y=u,this._width=c,this._height=l}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(DZ)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new EZ(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new EZ(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new EZ(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new EZ(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.round(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.floor(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.toSquare=function(){var e=this.x,n=this.y,r=this.width,i=this.height,o=Math.abs(r-i);return r<i&&(e-=o/2,r+=o),i<r&&(n-=o/2,i+=o),new t({x:e,y:n,width:r,height:i})},t.prototype.rescale=function(e){var n=RZ(e)?e.width:e,r=RZ(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(e,n){var r=this.y,i=this.right,o=this.bottom,s=Math.max(this.x,0),a=Math.max(r,0),u=o-a;return new t({x:s,y:a,width:Math.min(i-s,e-s),height:Math.min(u,n-a)}).floor()},t.prototype.shift=function(e,n){return new t({x:this.x+e,y:this.y+n,width:this.width,height:this.height})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,i=n,o=r,s=this.left,a=this.top,u=this.right,c=this.bottom;return u>e&&(i=-u+e+n,u=e),c>t&&(o=-c+t+r,c=t),s<1&&(o=2-s,s=1),a<1&&(o=2-a,a=1),{dy:1,edy:o,dx:1,edx:i,y:a,ey:c,x:s,ex:u,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),FZ=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{left:e,top:n,right:r,bottom:i},o)||this}return Object(uR.c)(e,t),e}(MZ),LZ=function(){function t(t,e,n,r,i){this._imageDims=new CZ(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new MZ(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new MZ(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),BZ=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{x:e,y:n,width:r,height:i},o)||this}return Object(uR.c)(e,t),e}(MZ);function jZ(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function VZ(t){var e="";if(!t)try{t=n(7)}catch(r){e=r.toString()}return{readFile:t?function(e){return new Promise((function(n,r){t.readFile(e,(function(t,e){return t?r(t):n(e)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)}}}function UZ(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},r=VZ();return Object(uR.a)({Canvas:t||function(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){},Image:e||function(){},ImageData:global.ImageData||function(){},Video:global.HTMLVideoElement||function(){},createCanvasElement:function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:n},r)}function zZ(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}function WZ(){return"object"==typeof global&&void 0!==t&&"undefined"!=typeof process&&!!process.version}function qZ(t){PZ=t}function HZ(){zZ()&&qZ(jZ()),WZ()&&qZ(UZ())}var GZ={getEnv:function(){if(!PZ)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return PZ},setEnv:qZ,initialize:HZ,createBrowserEnv:jZ,createFileSystem:VZ,createNodejsEnv:UZ,monkeyPatch:function(t){if(PZ||HZ(),!PZ)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?PZ.Canvas:e,r=t.Image,i=void 0===r?PZ.Image:r;PZ.Canvas=n,PZ.Image=i,PZ.createCanvasElement=t.createCanvasElement||function(){return new n},PZ.createImageElement=t.createImageElement||function(){return new i},PZ.ImageData=t.ImageData||PZ.ImageData,PZ.Video=t.Video||PZ.Video,PZ.fetch=t.fetch||PZ.fetch,PZ.readFile=t.readFile||PZ.readFile},isBrowser:zZ,isNodejs:WZ};function $Z(t){return GZ.isNodejs()||"string"!=typeof t?t:document.getElementById(t)}function KZ(t){var e=GZ.getEnv(),n=e.Canvas;if(t instanceof e.CanvasRenderingContext2D)return t;var r=$Z(t);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=r.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}HZ();var XZ=function(t){return t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT",t}({}),YZ=function(){return function(t){void 0===t&&(t={});var e=t.backgroundColor,n=t.fontColor,r=t.fontSize,i=t.fontStyle,o=t.padding;this.anchorPosition=t.anchorPosition||XZ.TOP_LEFT,this.backgroundColor=e||"rgba(0, 0, 0, 0.5)",this.fontColor=n||"rgba(255, 255, 255, 1)",this.fontSize=r||14,this.fontStyle=i||"Georgia",this.padding=o||4}}(),QZ=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"==typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new YZ(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map((function(e){return t.measureText(e).width})).reduce((function(t,e){return t<e?e:t}),0)+2*e},t.prototype.measureHeight=function(){var t=this.options;return this.text.length*t.fontSize+2*t.padding},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===XZ.BOTTOM_RIGHT||n===XZ.TOP_RIGHT,i=n===XZ.BOTTOM_LEFT||n===XZ.BOTTOM_RIGHT,o=this.measureWidth(t),s=this.measureHeight(),a=r?this.anchor.x-o:this.anchor.x,u=i?this.anchor.y-s:this.anchor.y;if(e){var c=e.height;return{x:Math.max(Math.min(a,e.width-o),0),y:Math.max(Math.min(u,c-s),0)}}return{x:a,y:u}},t.prototype.draw=function(t){var e=$Z(t),n=KZ(e),r=this.options,i=r.backgroundColor,o=r.fontColor,s=r.fontSize,a=r.padding;n.font=s+"px "+r.fontStyle;var u=this.measureWidth(n),c=this.measureHeight();n.fillStyle=i;var l=this.getUpperLeft(n,e);n.fillRect(l.x,l.y,u,c),n.fillStyle=o,this.text.forEach((function(t,e){n.fillText(t,a+l.x,a+l.y+(e+1)*s)}))},t}(),JZ=function(){return function(t){void 0===t&&(t={});var e=t.lineWidth,n=t.label,r=t.drawLabelOptions;this.boxColor=t.boxColor||"rgba(0, 0, 255, 1)",this.lineWidth=e||2,this.label=n,this.drawLabelOptions=new YZ(Object.assign({},{anchorPosition:XZ.BOTTOM_LEFT,backgroundColor:this.boxColor},r))}}(),ZZ=function(){function t(t,e){void 0===e&&(e={}),this.box=new MZ(t),this.options=new JZ(e)}return t.prototype.draw=function(t){var e=KZ(t),n=this.options,r=n.lineWidth,i=this.box,o=i.x,s=i.y,a=i.width,u=i.height;e.strokeStyle=n.boxColor,e.lineWidth=r,e.strokeRect(o,s,a,u);var c=this.options.label;c&&new QZ([c],{x:o-r/2,y:s},this.options.drawLabelOptions).draw(t)},t}();function t0(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),dq((function(){var i=VX(TY(t,e.filters,[1,1],n),e.bias);return r?vQ(i):i}))}function e0(t,e){Object.keys(t).forEach((function(n){e.some((function(t){return t.originalPath===n}))||t[n].dispose()}))}function n0(t,e){return function(n,r,i,o){var s=jq(t(n*r*i*i),[i,i,n,r]),a=Fq(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:a}}}function r0(t,e){return function(n,r,i){var o=Lq(t(n*r),[n,r]),s=Fq(t(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:s}}}var i0=function(){return function(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}}();function o0(t,e){return function(n,r,i){var o=jq(t(9*n),[3,3,n,1]),s=jq(t(n*r),[1,1,n,r]),a=Fq(t(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new i0(o,s,a)}}function s0(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),i=t(e+"/bias",1);return new i0(n,r,i)}}function a0(t,e){return function(n,r,i){var o=t[n];if(!SZ(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:n,paramPath:i||n}),o}}function u0(t){var e=t;return{extractWeights:function(t){var n=e.slice(0,t);return e=e.slice(t),n},getRemainingWeights:function(){return e}}}function c0(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",i=(t=t.replace(r,"")).split("/").filter((function(t){return t})),o=t.endsWith(".json")?i[i.length-1]:n,s=r+(t.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return{modelBaseUri:s=t.startsWith("/")?"/"+s:s,manifestUri:"/"===s?"/"+o:s+"/"+o}}function l0(t){var e=GZ.getEnv();return t instanceof e.Image&&t.complete||t instanceof e.Video&&t.readyState>=3}function h0(t){return new Promise((function(e,n){if(!(t instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if("string"!=typeof r.result)return n("bufferToImage - expected reader.result to be a string, in onload");var t=GZ.getEnv().createImageElement();t.onload=function(){return e(t)},t.onerror=n,t.src=r.result},r.onerror=n,r.readAsDataURL(t)}))}function d0(t){var e=GZ.getEnv(),n=e.Video;return t instanceof e.Image?new CZ(t.naturalWidth,t.naturalHeight):t instanceof n?new CZ(t.videoWidth,t.videoHeight):new CZ(t.width,t.height)}function f0(t){var e=t.width,n=t.height,r=(0,GZ.getEnv().createCanvasElement)();return r.width=e,r.height=n,r}function p0(t,e){var n=GZ.getEnv().ImageData;if(!(t instanceof n||l0(t)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=e||d0(t),i=r.width,o=r.height,s=f0({width:i,height:o});return t instanceof n?KZ(s).putImageData(t,0,0):KZ(s).drawImage(t,0,0,i,o),s}function m0(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,(0,GZ.getEnv().fetch)(t,e)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}}))}))}function g0(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return[4,m0(t)];case 1:return[2,e.sent().json()]}}))}))}function v0(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return n=e||GZ.getEnv().createCanvasElement(),r=t.shape.slice(kZ(t)?1:0),i=r[0],o=r[1],s=r[2],a=dq((function(){return t.as3D(i,o,s).toInt()})),[4,uZ.toPixels(a,n)];case 1:return u.sent(),a.dispose(),[2,n]}}))}))}function y0(t){var e=GZ.getEnv();return t instanceof e.Image||t instanceof e.Canvas||t instanceof e.Video}function b0(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return n=c0(t,e),r=n.modelBaseUri,[4,g0(n.manifestUri)];case 1:return i=o.sent(),[2,oZ.loadWeights(i,r)]}}))}))}var w0=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach((function(t,e){if(IZ(t))return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape);if(kZ(t)){var r=t.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape.slice(1))}var i=t instanceof GZ.getEnv().Canvas?t:p0(t);n._canvases[e]=i,n._inputDimensions[e]=[i.height,i.width,3]}))}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return NZ(this.batchSize,0,1).map((function(e,n){return t.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return n=(e={width:this.getInputWidth(t),height:this.getInputHeight(t)}).width,r=e.height,i=this.inputSize/Math.max(r,n),new CZ(Math.round(n*i),Math.round(r*i));var e,n,r,i},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,dq((function(){var r=NZ(n.batchSize,0,1).map((function(r){var i=n.getInput(r);if(i instanceof Gz){var o=kZ(i)?i:i.expandDims();return(o=function(t,e){return void 0===e&&(e=!1),dq((function(){var n=t.shape.slice(1),r=n[0],i=n[1];if(r===i)return t;var o=Math.abs(r-i),s=Math.round(o*(e?.5:1)),a=r>i?2:1,u=function(e){var n=t.shape.slice();return n[a]=e,zq(n,0)},c=u(s),l=o-c.shape[a],h=[e&&l?u(l):null,t,c].filter((function(t){return!!t})).map((function(t){return t.toFloat()}));return Gq(h,a)}))}(o,e)).shape[1]===t&&o.shape[2]===t||(o=cJ.resizeBilinear(o,[t,t])),o.as3D(t,t,3)}if(i instanceof GZ.getEnv().Canvas)return uZ.fromPixels(function(t,e,n){void 0===n&&(n=!1);var r=GZ.getEnv(),i=r.Canvas;if(!(t instanceof r.Image||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=d0(t),s=e/Math.max(o.height,o.width),a=s*o.width,u=s*o.height,c=f0({width:e,height:e}),l=t instanceof i?t:p0(t),h=Math.abs(a-u)/2,d=n&&a<u?h:0,f=n&&u<a?h:0;return KZ(c).drawImage(l,d,f,a,u),c}(i,t,e));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+i)}));return NH(r.map((function(t){return t.toFloat()}))).as4D(n.batchSize,t,t,3)}))},t}();function _0(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:if(t instanceof w0)return[2,t];if(!(e=Array.isArray(t)?t:[t]).length)throw new Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},(r=e.map($Z)).forEach((function(t,r){if(!y0(t)&&!IZ(t)&&!kZ(t)){if("string"==typeof e[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(kZ(t)){var i=t.shape[0];if(1!==i)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+i+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(t){return y0(t)&&(e=t,new Promise((function(t,n){if(e instanceof GZ.getEnv().Canvas||l0(e))return t();function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",i),t(e))}function i(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",i),n(t))}e.addEventListener("load",r),e.addEventListener("error",i)})));var e})))];case 1:return i.sent(),[2,new w0(r,Array.isArray(t))]}}))}))}var x0=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,i=n.objProp;r[i].dispose(),r[i]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map((function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}}))},t.prototype.getTrainableParams=function(){return this.getParamList().filter((function(t){return t.tensor instanceof Jz}))},t.prototype.getFrozenParams=function(){return this.getParamList().filter((function(t){return!(t.tensor instanceof Jz)}))},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach((function(e){t.reassignParamFromPath(e.path,e.tensor.variable())}))},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach((function(e){var n=e.path,r=e.tensor,i=Dq(r.dataSync());r.dispose(),t.reassignParamFromPath(n,i)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach((function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()})),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(t){return Array.from(t.tensor.dataSync())})).reduce((function(t,e){return t.concat(e)})))},t.prototype.load=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.loadFromUri=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromUri - expected model uri");return[4,b0(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}}))}))},t.prototype.loadFromDisk=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c;return Object(uR.d)(this,(function(l){switch(l.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromDisk - expected model file path");return e=GZ.getEnv().readFile,n=c0(t,this.getDefaultModelName()),r=n.manifestUri,i=n.modelBaseUri,o=oZ.weightsLoaderFactory((function(t){return Promise.all(t.map((function(t){return e(t).then((function(t){return t.buffer}))})))})),u=(a=JSON).parse,[4,e(r)];case 1:return s=u.apply(a,[l.sent().toString()]),[4,o(s,i)];case 2:return c=l.sent(),this.loadFromWeightMap(c),[2]}}))}))},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.params;this._paramMappings=e.paramMappings,this._params=n},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.params;this._paramMappings=e.paramMappings,this._params=n},t.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce((function(e,n){if(!e.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}}),{nextObj:this.params}),n=e.obj,r=e.objProp;if(!(n&&r&&n[r]instanceof Gz))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function C0(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return n?r/(t.area+e.area-r):r/Math.min(t.area,e.area)}function E0(t,e,n,r){void 0===r&&(r=!0);for(var i=e.map((function(t,e){return{score:t,boxIndex:e}})).sort((function(t,e){return t.score-e.score})).map((function(t){return t.boxIndex})),o=[],s=function(){var e=i.pop();o.push(e);for(var s=i,a=[],u=0;u<s.length;u++)a.push(C0(t[e],t[s[u]],r));i=i.filter((function(t,e){return a[e]<=n}))};i.length>0;)s();return o}function S0(t,e){return dq((function(){var n=e[0],r=e[1],i=e[2],o=zq(Object(uR.g)(t.shape.slice(0,3),[1]),n),s=zq(Object(uR.g)(t.shape.slice(0,3),[1]),r),a=zq(Object(uR.g)(t.shape.slice(0,3),[1]),i),u=Gq([o,s,a],3);return oY(t,u)}))}function I0(t){return 1/(1+Math.exp(-t))}var k0=function(t){return"number"==typeof t};function T0(t){if(!t)throw new Error("invalid config: "+t);if("boolean"!=typeof t.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!k0(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every((function(t){return"string"==typeof t})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map((function(t){return t||{}})).every((function(t){return k0(t.x)&&k0(t.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(k0)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function A0(t){return dq((function(){var e=ZX(t,Mq(.10000000149011612));return VX(vQ(oY(t,e)),e)}))}function R0(t,e){return dq((function(){var n=wH(t,[[0,0],[1,1],[1,1],[0,0]]);return n=TY(n,e.conv.filters,[1,1],"valid"),n=oY(n,e.bn.sub),n=ZX(n,e.bn.truediv),A0(n=VX(n,e.conv.bias))}))}function O0(t,e){return dq((function(){var n=wH(t,[[0,0],[1,1],[1,1],[0,0]]);return n=DY(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),A0(n=VX(n,e.bias))}))}var N0=function(t){return t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG",t}({}),D0=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),P0=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return T0(e),n._config=e,n}return Object(uR.c)(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=R0(t,e.conv0);return n=R0(n=GY(n,[2,2],[2,2],"same"),e.conv1),n=R0(n=GY(n,[2,2],[2,2],"same"),e.conv2),n=R0(n=GY(n,[2,2],[2,2],"same"),e.conv3),n=R0(n=GY(n,[2,2],[2,2],"same"),e.conv4),n=R0(n=GY(n,[2,2],[2,2],"same"),e.conv5),n=R0(n=GY(n,[2,2],[1,1],"same"),e.conv6),t0(n=R0(n,e.conv7),e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?A0(t0(t,e.conv0,"valid",!1)):O0(t,e.conv0);return n=O0(n=GY(n,[2,2],[2,2],"same"),e.conv1),n=O0(n=GY(n,[2,2],[2,2],"same"),e.conv2),n=O0(n=GY(n,[2,2],[2,2],"same"),e.conv3),n=O0(n=GY(n,[2,2],[2,2],"same"),e.conv4),n=O0(n=GY(n,[2,2],[2,2],"same"),e.conv5),n=GY(n,[2,2],[1,1],"same"),n=e.conv6?O0(n,e.conv6):n,t0(n=e.conv7?O0(n,e.conv7):n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return dq((function(){var i=t.toBatchTensor(e,!1).toFloat();return i=(i=n.config.meanRgb?S0(i,n.config.meanRgb):i).div(Mq(256)),n.config.withSeparableConvs?n.runMobilenet(i,r):n.runTinyYolov2(i,r)}))},e.prototype.forward=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,_0(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}}))}))},e.prototype.detect=function(t,e){return void 0===e&&(e={}),Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p=this;return Object(uR.d)(this,(function(m){switch(m.label){case 0:return n=new D0(e),r=n.inputSize,i=n.scoreThreshold,[4,_0(t)];case 1:return o=m.sent(),[4,this.forwardInput(o,r)];case 2:return s=m.sent(),a=dq((function(){return MH(s)[0].expandDims()})),u={width:o.getInputWidth(0),height:o.getInputHeight(0)},[4,this.extractBoxes(a,o.getReshapedInputDimensions(0),i)];case 3:return c=m.sent(),s.dispose(),a.dispose(),l=c.map((function(t){return t.box})),h=c.map((function(t){return t.score})),d=c.map((function(t){return t.classScore})),f=c.map((function(t){return p.config.classes[t.label]})),[2,E0(l.map((function(t){return t.rescale(r)})),h,this.config.iouThreshold,!0).map((function(t){return new LZ(h[t],d[t],f[t],l[t],u)}))]}}))}))},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r=[],i=function(t,e){var n=a0(t,e);function r(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(t){return{conv:r(t+"/conv"),bn:function(t){return{sub:n(t+"/sub",1),truediv:n(t+"/truediv",1)}}(t+"/bn")}},extractSeparableConvParams:s0(n)}}(t,r),o=i.extractConvParams,s=i.extractConvWithBatchNormParams,a=i.extractSeparableConvParams;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else n={conv0:s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:s("conv6"),conv7:s("conv7"),conv8:o("conv8")};return e0(t,r),{params:n,paramMappings:r}}(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(t,e,n,r){var i,o=u0(t),s=o.getRemainingWeights,a=[],u=function(t,e){var n=n0(t,e),r=o0(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,i,o){return{conv:n(r,i,3,o+"/conv"),bn:function(n,r){var i=Fq(t(n)),o=Fq(t(n));return e.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:i,truediv:o}}(i,o+"/bn")}},extractSeparableConvParams:r}}(o.extractWeights,a),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,h=u.extractSeparableConvParams;if(e.withSeparableConvs){var d=r[0],f=r[1],p=r[2],m=r[3],g=r[4],v=r[5],y=r[6],b=r[7],w=r[8];i={conv0:e.isFirstLayerConv2d?c(d,f,3,"conv0"):h(d,f,"conv0"),conv1:h(f,p,"conv1"),conv2:h(p,m,"conv2"),conv3:h(m,g,"conv3"),conv4:h(g,v,"conv4"),conv5:h(v,y,"conv5"),conv6:b?h(y,b,"conv6"):void 0,conv7:w?h(b,w,"conv7"):void 0,conv8:c(w||b||y,5*n,1,"conv8")}}else p=r[2],m=r[3],g=r[4],v=r[5],y=r[6],b=r[7],w=r[8],i={conv0:l(d=r[0],f=r[1],"conv0"),conv1:l(f,p,"conv1"),conv2:l(p,m,"conv2"),conv3:l(m,g,"conv3"),conv4:l(g,v,"conv4"),conv5:l(v,y,"conv5"),conv6:l(y,b,"conv6"),conv7:l(b,w,"conv7"),conv8:c(w,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:i,paramMappings:a}}(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b,w,_,x,C,E,S,I,k,T,A,R,O,N=this;return Object(uR.d)(this,(function(D){switch(D.label){case 0:return r=e.width,i=e.height,o=Math.max(r,i),s=o/r,a=o/i,u=t.shape[1],c=this.config.anchors.length,l=dq((function(){var e=t.reshape([u,u,c,N.boxEncodingSize]);return[e.slice([0,0,0,0],[u,u,c,4]),e.slice([0,0,0,4],[u,u,c,1]),N.withClassScores?QH(e.slice([0,0,0,5],[u,u,c,N.config.classes.length]),3):Mq(0)]})),h=l[0],f=l[2],p=[],[4,(d=l[1]).array()];case 1:return m=D.sent(),[4,h.array()];case 2:g=D.sent(),v=0,D.label=3;case 3:if(!(v<u))return[3,12];y=0,D.label=4;case 4:if(!(y<u))return[3,11];b=0,D.label=5;case 5:return b<c?(w=I0(m[v][y][b][0]),!n||w>n?(_=(y+I0(g[v][y][b][0]))/u*s,x=(v+I0(g[v][y][b][1]))/u*a,C=Math.exp(g[v][y][b][2])*this.config.anchors[b].x/u*s,E=Math.exp(g[v][y][b][3])*this.config.anchors[b].y/u*a,S=_-C/2,I=x-E/2,k={row:v,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(f,k)]:[3,7]):[3,9]):[3,10];case 6:return O=D.sent(),[3,8];case 7:O={classScore:1,label:0},D.label=8;case 8:A=(T=O).classScore,R=T.label,p.push(Object(uR.a)({box:new FZ(S,I,S+C,I+E),score:w,classScore:w*A,label:R},k)),D.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return v++,[3,3];case 12:return h.dispose(),d.dispose(),f.dispose(),[2,p]}}))}))},e.prototype.extractPredictedClass=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return n=e.row,r=e.col,i=e.anchor,[4,t.array()];case 1:return o=s.sent(),[2,Array(this.config.classes.length).fill(0).map((function(t,e){return o[n][r][i][e]})).map((function(t,e){return{classScore:t,label:e}})).reduce((function(t,e){return t.classScore>e.classScore?t:e}))]}}))}))},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(x0);function M0(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach((function(n,r){var i=n.x,o=n.y,s=e[r];t.moveTo(s.x,s.y),t.lineTo(i,o)})),n){var r=e[e.length-1],i=e[0];if(!r||!i)return;t.moveTo(r.x,r.y),t.lineTo(i.x,i.y)}t.stroke()}var F0=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return uR.c(e,t),e.prototype.forSize=function(n,r){var i=t.prototype.forSize.call(this,n,r);return new e(i.score,i.relativeBox,i.imageDims)},e}(LZ);function L0(t){return t.detection instanceof F0}function B0(t,e){return Object.assign({},t,{detection:e})}function j0(t,e){(Array.isArray(e)?e:[e]).forEach((function(e){var n=e instanceof F0?e.score:L0(e)?e.detection.score:void 0,i=e instanceof F0?e.box:L0(e)?e.detection.box:new MZ(e),o=n?""+AZ(n):void 0;new r.DrawBox(i,{label:o}).draw(t)}))}function V0(t,e,n){return HN((function(){var r=yB(t,e.depthwise_filter,e.pointwise_filter,n,"same");return uj(r,e.bias)}))}function U0(t,e,n){return void 0===n&&(n=!1),HN((function(){var r=Lj(n?uj(pB(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):V0(t,e.conv0,[2,2])),i=V0(r,e.conv1,[1,1]),o=V0(Lj(uj(r,i)),e.conv2,[1,1]);return Lj(uj(r,uj(i,o)))}))}function z0(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),HN((function(){var i=Lj(n?uj(pB(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):V0(t,e.conv0,r?[2,2]:[1,1])),o=V0(i,e.conv1,[1,1]),s=V0(Lj(uj(i,o)),e.conv2,[1,1]),a=V0(Lj(uj(i,uj(o,s))),e.conv3,[1,1]);return Lj(uj(i,uj(o,uj(s,a))))}))}function W0(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractSeparableConvParamsFactory(t,e);function o(t,e,i,o){return void 0===o&&(o=!1),{conv0:o?n(t,e,3,i+"/conv0"):r(t,e,i+"/conv0"),conv1:r(e,e,i+"/conv1"),conv2:r(e,e,i+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(t,e,n,i){void 0===i&&(i=!1);var s=o(t,e,n,i);return{conv0:s.conv0,conv1:s.conv1,conv2:s.conv2,conv3:r(e,e,n+"/conv3")}}}}function q0(t){return function(e){return{filters:t(e+"/filters",4),bias:t(e+"/bias",1)}}}function H0(t,e){var n=i.extractWeightEntryFactory(t,e),r=q0(n),o=i.loadSeparableConvParamsFactory(n);return{extractDenseBlock3Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2")}},extractDenseBlock4Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2"),conv3:o(t+"/conv3")}}}}var G0=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceFeatureExtractor - load model before inference");return HN((function(){var n=z0(S0(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(pD(255)),e.dense0,!0);return n=z0(n,e.dense1),n=z0(n,e.dense2),n=z0(n,e.dense3),OB(n,[7,7],[2,2],"valid")}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=H0(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=W0(n.extractWeights,e).extractDenseBlock4Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2"),c=o(128,256,"dense3");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u,dense3:c}}}(t)},e}(x0);function $0(t,e){return HN((function(){return uj(wB(t,e.weights),e.bias)}))}function K0(t){var e={},n={};return Object.keys(t).forEach((function(r){(r.startsWith("fc")?n:e)[r]=t[r]})),{featureExtractorMap:e,classifierMap:n}}var X0=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return uR.c(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return HN((function(){var r=t instanceof w0?e.faceFeatureExtractor.forwardInput(t):t;return $0(r.as2D(r.shape[0],-1),n.fc)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.paramMappings;this._params=e.params,this._paramMappings=n},e.prototype.extractClassifierParams=function(t){return function(t,e,n){var r=[],o=i.extractWeightsFactory(t),s=o.getRemainingWeights,a=i.extractFCParamsFactory(o.extractWeights,r)(e,n,"fc");if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:r,params:{fc:a}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e=K0(t),n=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(e.featureExtractorMap),function(t){var e=[],n=i.extractWeightEntryFactory(t,e),r={fc:{weights:n("fc/weights",2),bias:n("fc/bias",1)}};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(n)},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e}(x0),Y0=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Q0=function(){function t(t){var e=this;if(7!==t.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Y0.forEach((function(n,r){e[n]=t[r]}))}return t.prototype.asSortedArray=function(){var t=this;return Y0.map((function(e){return{expression:e,probability:t[e]}})).sort((function(t,e){return e.probability-t.probability}))},t}(),J0=function(t){function e(e){return void 0===e&&(e=new G0),t.call(this,"FaceExpressionNet",e)||this}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this;return HN((function(){return kP(e.runNet(t))}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictExpressions=function(t){return uR.b(this,void 0,void 0,(function(){var e,n,r,i,o=this;return uR.d(this,(function(s){switch(s.label){case 0:return[4,_0(t)];case 1:return e=s.sent(),[4,this.forwardInput(e)];case 2:return n=s.sent(),[4,Promise.all(dP(n).map((function(t){return uR.b(o,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}}))}))})))];case 3:return r=s.sent(),n.dispose(),i=r.map((function(t){return new Q0(t)})),[2,e.isBatchInput?i:i[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(X0);function Z0(t,e,n,i){void 0===n&&(n=.1),(Array.isArray(e)?e:[e]).forEach((function(e){var o=e instanceof Q0?e:e.expressions instanceof Q0?e.expressions:void 0;if(!o)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var s=o.asSortedArray().filter((function(t){return t.probability>n})),a=L0(e)?e.detection.box.bottomLeft:i||new EZ(0,0);new r.DrawTextField(s.map((function(t){return t.expression+" ("+AZ(t.probability)+")"})),a).draw(t)}))}var t1=function(){function t(t,e,n){void 0===n&&(n=new EZ(0,0));var r=e.width,i=e.height;this._imgDims=new CZ(r,i),this._shift=n,this._positions=t.map((function(t){return t.mul(new EZ(r,i)).add(n)}))}return Object.defineProperty(t.prototype,"shift",{get:function(){return new EZ(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map((function(e){return e.sub(t._shift).div(new EZ(t.imageWidth,t.imageHeight))}))},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new EZ(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof F0?t.box.floor():new MZ(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=r.minBoxPadding;return r.useDlibAlignment?this.alignDlib():this.alignMinBbox(i)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[1],n=t[2],r=function(t){return n.sub(t).magnitude()},i=(r(t[0])+r(e))/2,o=Math.floor(i/.45),s=OZ(t),a=Math.floor(Math.max(0,s.x-.5*o)),u=Math.floor(Math.max(0,s.y-.43*o));return new BZ(a,u,Math.min(o,this.imageWidth+a),Math.min(o,this.imageHeight+u))},t.prototype.alignMinBbox=function(t){var e,n,r,i,o,s,a,u=(n=(e=this.positions).map((function(t){return t.x})),r=e.map((function(t){return t.y})),i=n.reduce((function(t,e){return e<t?e:t}),1/0),o=r.reduce((function(t,e){return e<t?e:t}),1/0),s=n.reduce((function(t,e){return t<e?e:t}),0),a=r.reduce((function(t,e){return t<e?e:t}),0),new FZ(i,o,s,a));return u.pad(u.width*t,u.height*t)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),e1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(OZ)},e}(t1);function n1(t){return L0(t)&&t.landmarks instanceof t1&&t.unshiftedLandmarks instanceof t1&&t.alignedRect instanceof F0}function r1(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),i=r.align(),o=t.detection.imageDims,s=new F0(t.detection.score,i.rescale(o.reverse()),o);return Object.assign({},t,{landmarks:r,unshiftedLandmarks:e,alignedRect:s})}var i1=function(){return function(t){void 0===t&&(t={});var e=t.drawLines,n=t.drawPoints,r=void 0===n||n,i=t.lineWidth,o=t.lineColor,s=t.pointSize,a=t.pointColor;this.drawLines=void 0===e||e,this.drawPoints=r,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=a||"rgba(255, 0, 255, 1)"}}(),o1=function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new i1(e)}return t.prototype.draw=function(t){var e=KZ(t),n=this.options,r=n.drawPoints,i=n.lineWidth,o=n.pointSize,s=n.pointColor;n.drawLines&&this.faceLandmarks instanceof e1&&(e.strokeStyle=n.lineColor,e.lineWidth=i,M0(e,this.faceLandmarks.getJawOutline()),M0(e,this.faceLandmarks.getLeftEyeBrow()),M0(e,this.faceLandmarks.getRightEyeBrow()),M0(e,this.faceLandmarks.getNose()),M0(e,this.faceLandmarks.getLeftEye(),!0),M0(e,this.faceLandmarks.getRightEye(),!0),M0(e,this.faceLandmarks.getMouth(),!0)),r&&(e.strokeStyle=s,e.fillStyle=s,this.faceLandmarks.positions.forEach((function(t){e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI),e.fill()})))},t}();function s1(t,e){(Array.isArray(e)?e:[e]).forEach((function(e){var n=e instanceof t1?e:n1(e)?e.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new o1(n).draw(t)}))}function a1(t,e,n){return uj(pB(t,e.filters,n,"same"),e.bias)}function u1(t,e,n){void 0===n&&(n=!0);var r=n?Lj(t):t;return r=V0(r,e.separable_conv0,[1,1]),r=V0(Lj(r),e.separable_conv1,[1,1]),r=RB(r,[3,3],[2,2],"same"),uj(r,a1(t,e.expansion_conv,[2,2]))}var c1=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return HN((function(){var r=S0(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(pD(256)),i=Lj(a1(r,n.entry_flow.conv_in,[2,2]));return i=u1(i,n.entry_flow.reduction_block_0,!1),i=u1(i,n.entry_flow.reduction_block_1),NZ(e._numMainBlocks,0,1).forEach((function(t){i=function(t,e){var n=V0(Lj(t),e.separable_conv0,[1,1]);return n=V0(Lj(n),e.separable_conv1,[1,1]),n=V0(Lj(n),e.separable_conv2,[1,1]),uj(n,t)}(i,n.middle_flow["main_block_"+t])})),i=u1(i,n.exit_flow.reduction_block),i=Lj(V0(i,n.exit_flow.separable_conv,[1,1]))}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n=[],r=function(t,e){var n=i.extractWeightEntryFactory(t,e),r=q0(n),o=i.loadSeparableConvParamsFactory(n);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),expansion_conv:r(t+"/expansion_conv")}},extractMainBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),separable_conv2:o(t+"/separable_conv2")}}}}(t,n),o=r.extractSeparableConvParams,s=r.extractReductionBlockParams,a=r.extractMainBlockParams,u={conv_in:(0,r.extractConvParams)("entry_flow/conv_in"),reduction_block_0:s("entry_flow/reduction_block_0"),reduction_block_1:s("entry_flow/reduction_block_1")},c={};NZ(e,0,1).forEach((function(t){c["main_block_"+t]=a("middle_flow/main_block_"+t)}));var l={reduction_block:s("exit_flow/reduction_block"),separable_conv:o("exit_flow/separable_conv")};return i.disposeUnusedWeightTensors(t,n),{params:{entry_flow:u,middle_flow:c,exit_flow:l},paramMappings:n}}(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return function(t,e){var n=[],r=i.extractWeightsFactory(t),o=r.getRemainingWeights,s=function(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractSeparableConvParamsFactory(t,e);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(t,e,i){return{separable_conv0:r(t,e,i+"/separable_conv0"),separable_conv1:r(e,e,i+"/separable_conv1"),expansion_conv:n(t,e,1,i+"/expansion_conv")}},extractMainBlockParams:function(t,e){return{separable_conv0:r(t,t,e+"/separable_conv0"),separable_conv1:r(t,t,e+"/separable_conv1"),separable_conv2:r(t,t,e+"/separable_conv2")}}}}(r.extractWeights,n),a=s.extractSeparableConvParams,u=s.extractReductionBlockParams,c=s.extractMainBlockParams,l={conv_in:(0,s.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:u(32,64,"entry_flow/reduction_block_0"),reduction_block_1:u(64,128,"entry_flow/reduction_block_1")},h={};NZ(e,0,1).forEach((function(t){h["main_block_"+t]=c(128,"middle_flow/main_block_"+t)}));var d={reduction_block:u(128,256,"exit_flow/reduction_block"),separable_conv:a(256,512,"exit_flow/separable_conv")};if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:l,middle_flow:h,exit_flow:d}}}(t,this._numMainBlocks)},e}(x0),l1=function(t){return t.FEMALE="female",t.MALE="male",t}({}),h1=function(t){function e(e){void 0===e&&(e=new c1(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return uR.c(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return HN((function(){var r=t instanceof w0?e.faceFeatureExtractor.forwardInput(t):t,i=OB(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:$0(i,n.fc.age).as1D(),gender:$0(i,n.fc.gender)}}))},e.prototype.forwardInput=function(t){var e=this;return HN((function(){var n=e.runNet(t);return{age:n.age,gender:kP(n.gender)}}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictAgeAndGender=function(t){return uR.b(this,void 0,void 0,(function(){var e,n,r,i,o,s,a=this;return uR.d(this,(function(u){switch(u.label){case 0:return[4,_0(t)];case 1:return e=u.sent(),[4,this.forwardInput(e)];case 2:return n=u.sent(),r=dP(n.age),i=dP(n.gender),o=r.map((function(t,e){return{ageTensor:t,genderTensor:i[e]}})),[4,Promise.all(o.map((function(t){var e=t.ageTensor,n=t.genderTensor;return uR.b(a,void 0,void 0,(function(){var t,r,i,o,s;return uR.d(this,(function(a){switch(a.label){case 0:return[4,e.data()];case 1:return t=a.sent()[0],[4,n.data()];case 2:return r=a.sent()[0],o=(i=r>.5)?l1.MALE:l1.FEMALE,s=i?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:o,genderProbability:s}]}}))}))})))];case 3:return s=u.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?s:s[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.paramMappings;this._params=e.params,this._paramMappings=n},e.prototype.extractClassifierParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=i.extractFCParamsFactory(n.extractWeights,e),s=o(512,1,"fc/age"),a=o(512,2,"fc/gender");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{fc:{age:s,gender:a}}}}(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=K0(t),n=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(e.featureExtractorMap),function(t){var e=[],n=i.extractWeightEntryFactory(t,e);function r(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return i.disposeUnusedWeightTensors(t,e),{params:o,paramMappings:e}}(n)},e.prototype.extractParams=function(t){var e=t.slice(0,t.length-1539),n=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(e),this.extractClassifierParams(n)},e}(x0),d1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],OZ([t[3],t[4]])]},e}(t1);function f1(t,e){return uR.b(this,void 0,void 0,(function(){var n,r,i,o,s,a;return uR.d(this,(function(u){switch(u.label){case 0:return n=GZ.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,_0(t)];case 1:if((i=u.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(o=i.getInput(0))instanceof n?(s=o,[3,4]):[3,2];case 2:return[4,v0(o)];case 3:s=u.sent(),u.label=4;case 4:r=s,u.label=5;case 5:return a=KZ(r),[2,e.map((function(t){return t instanceof F0?t.forSize(r.width,r.height).box.floor():t})).map((function(t){return t.clipAtImageBorders(r.width,r.height)})).map((function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=f0({width:r,height:i});return KZ(o).putImageData(a.getImageData(e,n,r,i),0,0),o}))]}}))}))}function p1(t,e){return uR.b(this,void 0,void 0,(function(){return uR.d(this,(function(n){if(!IZ(t)&&!kZ(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(kZ(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,HN((function(){var n=t.shape.slice(kZ(t)?1:0),r=n[0],i=n[1],o=n[2];return e.map((function(t){return t instanceof F0?t.forSize(i,r).box:t})).map((function(t){return t.clipAtImageBorders(i,r)})).map((function(e){var n=e.x,s=e.y,a=e.width,u=e.height;return FB(t.as3D(r,i,o),[s,n,0],[u,a,o])}))}))]}))}))}var m1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map((function(t){var n=t.width,r=t.height,i=e/Math.max(r,n);return{width:n*i,height:r*i}})),i=r.length;return HN((function(){var n=function(t,e){return cP([_D([68],t),_D([68],e)],1).as2D(1,136).as1D()},o=function(t,e){var n=r[t],i=n.width,o=n.height;return e(i,o)?Math.abs(i-o)/2:0};return t.mul(_D([i,136],e)).sub(cP(Array.from(Array(i),(function(t,e){return n(function(t){return o(t,(function(t,e){return t<e}))}(e),function(t){return o(t,(function(t,e){return e<t}))}(e))})))).div(cP(Array.from(Array(i),(function(t,e){return n(r[e].width,r[e].height)}))))}))},e.prototype.forwardInput=function(t){var e=this;return HN((function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map((function(t){return{height:t[0],width:t[1]}})))}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.detectLandmarks=function(t){return uR.b(this,void 0,void 0,(function(){var e,n,r,i=this;return uR.d(this,(function(o){switch(o.label){case 0:return[4,_0(t)];case 1:return e=o.sent(),n=HN((function(){return dP(i.forwardInput(e))})),[4,Promise.all(n.map((function(t,n){return uR.b(i,void 0,void 0,(function(){var r,i,o,s,a;return uR.d(this,(function(u){switch(u.label){case 0:return o=(i=Array).from,[4,t.data()];case 1:return r=o.apply(i,[u.sent()]),s=r.filter((function(t,e){return TZ(e)})),a=r.filter((function(t,e){return!TZ(e)})),[2,new e1(Array(68).fill(0).map((function(t,e){return new EZ(s[e],a[e])})),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}}))}))})))];case 2:return r=o.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getClassifierChannelsOut=function(){return 136},e}(X0),g1=function(t){function e(e){return void 0===e&&(e=new G0),t.call(this,"FaceLandmark68Net",e)||this}return uR.c(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(m1),v1=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("TinyFaceFeatureExtractor - load model before inference");return HN((function(){var n=U0(S0(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(pD(255)),e.dense0,!0);return n=U0(n,e.dense1),n=U0(n,e.dense2),OB(n,[14,14],[2,2],"valid")}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=H0(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=W0(n.extractWeights,e).extractDenseBlock3Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u}}}(t)},e}(x0),y1=function(t){function e(e){return void 0===e&&(e=new v1),t.call(this,"FaceLandmark68TinyNet",e)||this}return uR.c(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(m1);function b1(t,e,n,r,i){void 0===i&&(i="same");var o=e.conv,s=o.bias,a=pB(t,o.filters,n,i);return a=function(t,e){return uj(_j(t,e.weights),e.biases)}(a=uj(a,s),e.scale),r?Lj(a):a}function w1(t,e){return b1(t,e,[1,1],!1)}function _1(t,e){return b1(t,e,[2,2],!0,"valid")}function x1(t,e){var n=function(t,e){return b1(t,e,[1,1],!0)}(t,e.conv1);return n=w1(n,e.conv2),n=uj(n,t),Lj(n)}function C1(t,e){var n=_1(t,e.conv1);n=w1(n,e.conv2);var r=OB(t,2,2,"valid"),i=wD(r.shape),o=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var s=n.shape.slice();s[1]=1;var a=wD(s),u=(n=SD([n,a],1)).shape.slice();u[2]=1;var c=wD(u);n=SD([n,c],2)}return r=o?SD([r,i],3):r,n=uj(r,n),Lj(n)}var E1=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceRecognitionNet - load model before inference");return HN((function(){var n=_1(S0(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(pD(256)),e.conv32_down);n=x1(n=RB(n,3,2,"valid"),e.conv32_1),n=x1(n,e.conv32_2),n=x1(n,e.conv32_3),n=x1(n=C1(n,e.conv64_down),e.conv64_1),n=x1(n,e.conv64_2),n=x1(n,e.conv64_3),n=x1(n=C1(n,e.conv128_down),e.conv128_1),n=x1(n,e.conv128_2),n=x1(n=C1(n,e.conv256_down),e.conv256_1);var r=(n=C1(n=x1(n,e.conv256_2),e.conv256_down_out)).mean([1,2]);return wB(r,e.fc)}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.computeFaceDescriptor=function(t){return uR.b(this,void 0,void 0,(function(){var e,n,r,i=this;return uR.d(this,(function(o){switch(o.label){case 0:return[4,_0(t)];case 1:return e=o.sent(),n=HN((function(){return dP(i.forwardInput(e))})),[4,Promise.all(n.map((function(t){return t.data()})))];case 2:return r=o.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t){return{conv:{filters:n(t+"/conv/filters",4),bias:n(t+"/conv/bias",1)},scale:function(t){return{weights:n(t+"/scale/weights",1),biases:n(t+"/scale/biases",1)}}(t)}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t){return{conv1:r(t+"/conv1"),conv2:r(t+"/conv2")}}}}(t,e),r=n.extractResidualLayerParams,o=(0,n.extractConvLayerParams)("conv32_down"),s=r("conv32_1"),a=r("conv32_2"),u=r("conv32_3"),c=r("conv64_down"),l=r("conv64_1"),h=r("conv64_2"),d=r("conv64_3"),f=r("conv128_down"),p=r("conv128_1"),m=r("conv128_2"),g=r("conv256_down"),v=r("conv256_1"),y=r("conv256_2"),b=r("conv256_down_out"),w=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!SZ(w,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var _={conv32_down:o,conv32_1:s,conv32_2:a,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:h,conv64_3:d,conv128_down:f,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:w};return i.disposeUnusedWeightTensors(t,e),{params:_,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=i.extractWeightsFactory(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],s=function(t,e){function n(n,r,i,o){var s=function(e,n,r){var i=t(e),o=i.length/(n*r*r);if(o%1!=0)throw new Error("depth has to be an integer: "+o+", weights.length: "+i.length+", numFilters: "+n+", filterSize: "+r);return HN((function(){return jj(yD(i,[n,o,r,r]),[2,3,1,0])}))}(n,r,i),a=mD(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:a}}function r(r,i,o,s){return{conv:n(r,i,o,s+"/conv"),scale:function(n,r){var i=mD(t(n)),o=mD(t(n));return e.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:i,biases:o}}(i,s+"/scale")}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t,e,n,i,o){return void 0===o&&(o=!1),{conv1:r((o?.5:1)*t,e,n,i+"/conv1"),conv2:r(t,e,n,i+"/conv2")}}}}(n,o),a=s.extractResidualLayerParams,u=(0,s.extractConvLayerParams)(4704,32,7,"conv32_down"),c=a(9216,32,3,"conv32_1"),l=a(9216,32,3,"conv32_2"),h=a(9216,32,3,"conv32_3"),d=a(36864,64,3,"conv64_down",!0),f=a(36864,64,3,"conv64_1"),p=a(36864,64,3,"conv64_2"),m=a(36864,64,3,"conv64_3"),g=a(147456,128,3,"conv128_down",!0),v=a(147456,128,3,"conv128_1"),y=a(147456,128,3,"conv128_2"),b=a(589824,256,3,"conv256_down",!0),w=a(589824,256,3,"conv256_1"),_=a(589824,256,3,"conv256_2"),x=a(589824,256,3,"conv256_down_out"),C=HN((function(){return jj(gD(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:h,conv64_down:d,conv64_1:f,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:w,conv256_2:_,conv256_down_out:x,fc:C},paramMappings:o}}(t)},e}(x0),S1=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,i=e.maxNumScales,o=e.scoreThresholds,s=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=s,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(t){return"number"!=typeof t})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(t){return"number"!=typeof t}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function I1(t,e,n){return HN((function(){var r=pB(t,e.filters,n,"same");return r=uj(r,e.batch_norm_offset),CL(r,0,6)}))}function k1(t,e,n){var r=t.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),s=Math.max(r[e][0],r[e][2]),a=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),d=(s-i)*(a-o),f=(l-u)*(h-c);if(d<=0||f<=0)return 0;var p=Math.max(i,u),m=Math.max(o,c),g=Math.min(s,l),v=Math.min(a,h),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(d+f-y)}function T1(t,e){return HN((function(){var n=t.shape[0];return{boxPredictionEncoding:sP(i.convLayer(t,e.box_encoding_predictor),[n,-1,1,4]),classPrediction:sP(i.convLayer(t,e.class_predictor),[n,-1,3])}}))}var A1=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),R1=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return uR.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("SsdMobilenetv1 - load model before inference");return HN((function(){var n=t.toBatchTensor(512,!1).toFloat(),r=function(t,e){return HN((function(){var n=null,r=I1(t,e.conv_0,[2,2]);if([e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13].forEach((function(t,e){var i=e+1,o=function(t){return[2,4,6,12].some((function(e){return e===t}))?[2,2]:[1,1]}(i);r=I1(r=function(t,e,n){return HN((function(){var r=vB(t,e.filters,n,"same");return r=sB(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,.0010000000474974513),CL(r,0,6)}))}(r,t.depthwise_conv,o),t.pointwise_conv,[1,1]),11===i&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}(kj(_j(n,pD(.007843137718737125)),pD(1)),e.mobilenetv1),i=function(t,e,n){return HN((function(){var r=I1(t,n.conv_0,[1,1]),i=I1(r,n.conv_1,[2,2]),o=I1(i,n.conv_2,[1,1]),s=I1(o,n.conv_3,[2,2]),a=I1(s,n.conv_4,[1,1]),u=I1(a,n.conv_5,[2,2]),c=I1(u,n.conv_6,[1,1]),l=I1(c,n.conv_7,[2,2]),h=T1(e,n.box_predictor_0),d=T1(t,n.box_predictor_1),f=T1(i,n.box_predictor_2),p=T1(s,n.box_predictor_3),m=T1(u,n.box_predictor_4),g=T1(l,n.box_predictor_5);return{boxPredictions:SD([h.boxPredictionEncoding,d.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:SD([h.classPrediction,d.classPrediction,f.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1)}}))}(r.out,r.conv11,e.prediction_layer);return function(t,e,n){return HN((function(){var r=t.shape[0],i=function(t,e){var n=function(t){var e=dP(jj(t,[1,0])),n=[kj(e[2],e[0]),kj(e[3],e[1])];return{sizes:n,centers:[uj(e[0],dj(n[0],pD(2))),uj(e[1],dj(n[1],pD(2)))]}}(t),r=n.sizes,i=n.centers,o=dP(jj(e,[1,0])),s=dj(_j(kL(dj(o[2],pD(5))),r[0]),pD(2)),a=uj(_j(dj(o[0],pD(10)),r[0]),i[0]),u=dj(_j(kL(dj(o[3],pD(5))),r[1]),pD(2)),c=uj(_j(dj(o[1],pD(10)),r[1]),i[1]);return jj(cP([kj(a,s),kj(c,u),uj(a,s),uj(c,u)]),[1,0])}(sP(lP(n.extra_dim,[r,1,1]),[-1,4]),sP(t,[-1,4]));i=sP(i,[r,i.shape[0]/r,4]);var o=LL(DB(e,[0,0,1],[-1,-1,-1])),s=DB(o,[0,0,0],[-1,-1,1]);return s=sP(s,[r,s.shape[1]]),{boxes:dP(i),scores:dP(s)}}))}(i.boxPredictions,i.classPredictions,e.output_layer)}))},e.prototype.forward=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,_0(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),uR.b(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b,w,_;return uR.d(this,(function(x){switch(x.label){case 0:return n=new A1(e),r=n.maxResults,i=n.minConfidence,[4,_0(t)];case 1:for(o=x.sent(),s=this.forwardInput(o),c=(a=s.boxes)[0],l=(u=s.scores)[0],h=1;h<a.length;h++)a[h].dispose(),u[h].dispose();return p=(f=Array).from,[4,l.data()];case 2:return d=p.apply(f,[x.sent()]),m=function(t,e,n,r,i){var o=Math.min(n,t.shape[0]),s=e.map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),a=[];return s.forEach((function(e){if(!(a.length>=o)){for(var n=e.score,r=a.length-1;r>=0;--r){var s=k1(t,e.boxIndex,a[r]);if(0!==s&&(e.score*=s<=.5?1:0,e.score<=i))break}n===e.score&&a.push(e.boxIndex)}})),a}(c,d,r,0,i),g=o.getReshapedInputDimensions(0),y=(v=o.inputSize)/g.width,b=v/g.height,w=c.arraySync(),_=m.map((function(t){var e=[Math.max(0,w[t][0]),Math.min(1,w[t][2])].map((function(t){return t*b})),n=e[0],r=e[1],i=[Math.max(0,w[t][1]),Math.min(1,w[t][3])].map((function(t){return t*y})),s=i[0];return new F0(d[t],new BZ(s,n,i[1]-s,r-n),{height:o.getInputHeight(0),width:o.getInputWidth(0)})})),c.dispose(),l.dispose(),[2,_]}}))}))},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t,e,r){return{filters:n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(t){var e="mobilenetv1/conv_"+t,i="MobilenetV1/Conv2d_"+t+"_depthwise",o=e+"/depthwise_conv",s=e+"/pointwise_conv";return{depthwise_conv:{filters:n(i+"/depthwise_weights",4,o+"/filters"),batch_norm_scale:n(i+"/BatchNorm/gamma",1,o+"/batch_norm_scale"),batch_norm_offset:n(i+"/BatchNorm/beta",1,o+"/batch_norm_offset"),batch_norm_mean:n(i+"/BatchNorm/moving_mean",1,o+"/batch_norm_mean"),batch_norm_variance:n(i+"/BatchNorm/moving_variance",1,o+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",t,s)}}function s(t,e){return{filters:n(t+"/weights",4,e+"/filters"),bias:n(t+"/biases",1,e+"/bias")}}function a(t){return{box_encoding_predictor:s("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),class_predictor:s("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,s=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!IZ(s))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+s);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:s}};return i.disposeUnusedWeightTensors(t,e),{params:a,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.extractWeights,o=n.getRemainingWeights,s=function(t,e){function n(n,r,i,o,s){var a=yD(t(n*r*i*i),[i,i,n,r]),u=mD(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/"+(s?"batch_norm_offset":"bias")}),{filters:a,bias:u}}function r(t,e,r,i){var o=n(t,e,r,i,!0);return{filters:o.filters,batch_norm_offset:o.bias}}function i(n,i,o){return{depthwise_conv:function(n,r){var i=yD(t(9*n),[3,3,n,1]),o=mD(t(n)),s=mD(t(n)),a=mD(t(n)),u=mD(t(n));return e.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:i,batch_norm_scale:o,batch_norm_offset:s,batch_norm_mean:a,batch_norm_variance:u}}(n,o+"/depthwise_conv"),pointwise_conv:r(n,i,1,o+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,e),a=s.extractPredictionLayerParams,u=(0,s.extractMobilenetV1Params)(),c=a(),l={extra_dim:vD(r(20472),[1,5118,4])};if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:l},paramMappings:e}}(t)},e}(x0),O1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return uR.c(e,t),e}(i.TinyYolov2Options),N1=function(){function t(){}return t.prototype.then=function(t){return uR.b(this,void 0,void 0,(function(){var e;return uR.d(this,(function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}}))}))},t.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){return uR.d(this,(function(t){throw new Error("ComposableTask - run is not implemented")}))}))},t}();function D1(t,e,n,r,i){return void 0===i&&(i=function(t){return t.alignedRect}),uR.b(this,void 0,void 0,(function(){var o,s,a,u,c;return uR.d(this,(function(l){switch(l.label){case 0:return o=t.map((function(t){return n1(t)?i(t):t.detection})),(a=r)?[3,5]:e instanceof OO?[4,p1(e,o)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,f1(e,o)];case 3:u=l.sent(),l.label=4;case 4:a=u,l.label=5;case 5:return[4,n(s=a)];case 6:return c=l.sent(),s.forEach((function(t){return t instanceof OO&&t.dispose()})),[2,c]}}))}))}function P1(t,e){var n=e[1];return{height:Math.floor(e[0]*t),width:Math.floor(n*t)}}var M1=function(t){function e(e,n,r,i){return t.call(this,{left:e,top:n,right:r,bottom:i},!0)||this}return uR.c(e,t),e}(MZ);function F1(t){return HN((function(){return _j(kj(t,pD(127.5)),pD(.0078125))}))}function L1(t,e){return HN((function(){return uj(Lj(t),_j(e,DL(Lj(DL(t)))))}))}function B1(t,e,n){return void 0===n&&(n=!1),HN((function(){var r=i.convLayer(t,e.conv1,"valid");return r=L1(r,e.prelu1_alpha),r=RB(r,n?[2,2]:[3,3],[2,2],"same"),r=L1(r=i.convLayer(r,e.conv2,"valid"),e.prelu2_alpha),r=n?r:RB(r,[3,3],[2,2],"valid"),L1(r=i.convLayer(r,e.conv3,"valid"),e.prelu3_alpha)}))}function j1(t,e,n,r,o){o.stage1=[];var s=e.map((function(e){return HN((function(){var n={scale:e},o=function(t,e){return HN((function(){var n=P1(e,t.shape.slice(1)),r=F1(OV.resizeBilinear(t,[n.height,n.width]));return jj(r,[0,2,1,3])}))}(t,e),s=Date.now(),a=function(t,e){return HN((function(){var n=B1(t,e,!0),r=i.convLayer(n,e.conv4_1,"valid"),o=KD(qB(r,3),3);return{prob:kP(kj(r,o),3),regions:i.convLayer(n,e.conv4_2,"valid")}}))}(o,r),u=a.prob,c=a.regions;return n.pnet=Date.now()-s,{scoresTensor:dP(dP(u,3)[1])[0],regionsTensor:dP(c)[0],scale:e,statsForScale:n}}))})).map((function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.statsForScale,s=function(t,e,n,r){for(var i=[],o=t.arraySync(),s=0;s<t.shape[0];s++)for(var a=0;a<t.shape[1];a++)o[s][a]>=r&&i.push(new EZ(a,s));return i.map((function(t){var r=new FZ(Math.round((2*t.y+1)/n),Math.round((2*t.x+1)/n),Math.round((2*t.y+12)/n),Math.round((2*t.x+12)/n)),i=o[t.y][t.x],s=e.arraySync();return{cell:r,score:i,region:new M1(s[t.y][t.x][0],s[t.y][t.x][1],s[t.y][t.x][2],s[t.y][t.x][3])}}))}(e,r,t.scale,n);if(e.dispose(),r.dispose(),!s.length)return o.stage1.push(i),[];var a=Date.now(),u=E0(s.map((function(t){return t.cell})),s.map((function(t){return t.score})),.5);return i.nms=Date.now()-a,i.numBoxes=u.length,o.stage1.push(i),u.map((function(t){return s[t]}))})).reduce((function(t,e){return t.concat(e)}),[]),a=[],u=[];if(s.length>0){var c=Date.now(),l=E0(s.map((function(t){return t.cell})),s.map((function(t){return t.score})),.7);o.stage1_nms=Date.now()-c,u=l.map((function(t){return s[t].score})),a=l.map((function(t){return s[t]})).map((function(t){var e=t.cell,n=t.region;return new FZ(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()}))}return{boxes:a,scores:u}}function V1(t,e,n){var r=n.width,i=n.height;return uR.b(this,void 0,void 0,(function(){var n,o,s,a=this;return uR.d(this,(function(u){switch(u.label){case 0:return n=KZ(t),[4,Promise.all(e.map((function(e){return uR.b(a,void 0,void 0,(function(){var r,i,o,s;return uR.d(this,(function(a){return r=e.padAtBorders(t.height,t.width),s=n.getImageData(i=r.x-1,o=r.y-1,r.ex-i,r.ey-o),[2,GZ.isNodejs()?p0(s):createImageBitmap(s)]}))}))})))];case 1:return o=u.sent(),s=[],o.forEach((function(t){var e=KZ(f0({width:r,height:i}));e.drawImage(t,0,0,r,i);for(var n=e.getImageData(0,0,r,i).data,o=[],a=0;a<n.length;a+=4)o.push(n[a+2]),o.push(n[a+1]),o.push(n[a]);s.push(o)})),[2,s.map((function(t){return HN((function(){return F1(jj(yD(t,[1,r,i,3]),[0,2,1,3]).toFloat())}))}))]}}))}))}function U1(t,e,n,r,i){return uR.b(this,void 0,void 0,(function(){var o,s,a,u,c,l,h,d,f,p,m,g,v,y;return uR.d(this,(function(b){switch(b.label){case 0:return o=Date.now(),[4,V1(t,e,{width:24,height:24})];case 1:return s=b.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map((function(t){var e=function(t,e){return HN((function(){var n=B1(t,e),r=L1($0(sP(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu4_alpha),i=$0(r,e.fc2_1),o=KD(qB(i,1),1),s=kP(kj(i,o),1),a=$0(r,e.fc2_2);return{scores:dP(s,1)[1],regions:a}}))}(t,r);return t.dispose(),e})),i.stage2_rnet=Date.now()-o,u=a.length>1?SD(a.map((function(t){return t.scores}))):a[0].scores,h=(l=Array).from,[4,u.data()];case 2:return c=h.apply(l,[b.sent()]),u.dispose(),d=c.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),f=d.map((function(t){return e[t]})),p=d.map((function(t){return c[t]})),m=[],g=[],f.length>0&&(o=Date.now(),v=E0(f,p,.7),i.stage2_nms=Date.now()-o,y=v.map((function(t){var e=a[d[t]].regions.arraySync();return new M1(e[0][0],e[0][1],e[0][2],e[0][3])})),g=v.map((function(t){return p[t]})),m=v.map((function(t,e){return f[t].calibrate(y[e])}))),a.forEach((function(t){t.regions.dispose(),t.scores.dispose()})),[2,{boxes:m,scores:g}]}}))}))}function z1(t,e,n,r,o){return uR.b(this,void 0,void 0,(function(){var s,a,u,c,l,h,d,f,p,m,g,v,y,b,w;return uR.d(this,(function(_){switch(_.label){case 0:return s=Date.now(),[4,V1(t,e,{width:48,height:48})];case 1:return a=_.sent(),o.stage3_extractImagePatches=Date.now()-s,s=Date.now(),u=a.map((function(t){var e=function(t,e){return HN((function(){var n=B1(t,e);n=RB(n,[2,2],[2,2],"same"),n=L1(n=i.convLayer(n,e.conv4,"valid"),e.prelu4_alpha);var r=L1($0(sP(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu5_alpha),o=$0(r,e.fc2_1),s=KD(qB(o,1),1),a=kP(kj(o,s),1),u=$0(r,e.fc2_2),c=$0(r,e.fc2_3);return{scores:dP(a,1)[1],regions:u,points:c}}))}(t,r);return t.dispose(),e})),o.stage3_onet=Date.now()-s,c=u.length>1?SD(u.map((function(t){return t.scores}))):u[0].scores,d=(h=Array).from,[4,c.data()];case 2:return l=d.apply(h,[_.sent()]),c.dispose(),f=l.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),p=f.map((function(t){var e=u[t].regions.arraySync();return new M1(e[0][0],e[0][1],e[0][2],e[0][3])})),m=f.map((function(t,n){return e[t].calibrate(p[n])})),g=f.map((function(t){return l[t]})),v=[],y=[],b=[],m.length>0&&(s=Date.now(),w=E0(m,g,.7,!1),o.stage3_nms=Date.now()-s,v=w.map((function(t){return m[t]})),y=w.map((function(t){return g[t]})),b=w.map((function(t,e){return Array(5).fill(0).map((function(n,r){var i=u[t].points.arraySync();return new EZ(i[0][r]*(v[e].width+1)+v[e].left,i[0][r+5]*(v[e].height+1)+v[e].top)}))}))),u.forEach((function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()})),[2,{boxes:v,scores:y,points:b}]}}))}))}var W1=function(t){function e(){return t.call(this,"Mtcnn")||this}return uR.c(e,t),e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),uR.b(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p,m,g,v,y,b,w,_;return uR.d(this,(function(x){switch(x.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=t.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return i={},o=Date.now(),s=HN((function(){return t=KD(kU.fromPixels(r)).toFloat(),HN((function(){return cP(dP(t,3).reverse(),3)}));var t})),a=function(t){return s.dispose(),i.total=Date.now()-o,t},u=s.shape.slice(1),c=u[0],l=u[1],h=new S1(e),d=h.minFaceSize,f=h.scaleFactor,p=h.maxNumScales,m=h.scoreThresholds,g=(h.scaleSteps||function(t,e,n){for(var r=12/t,i=[],o=Math.min(n[0],n[1])*r,s=0;o>=12;)i.push(r*Math.pow(e,s)),o*=e,s+=1;return i}(d,f,[c,l])).filter((function(t){var e=P1(t,[c,l]);return Math.min(e.width,e.height)>12})).slice(0,p),i.scales=g,i.pyramid=g.map((function(t){return P1(t,[c,l])})),v=Date.now(),[4,j1(s,g,m[0],n.pnet,i)];case 1:return y=x.sent(),i.total_stage1=Date.now()-v,y.boxes.length?(i.stage2_numInputBoxes=y.boxes.length,v=Date.now(),[4,U1(r,y.boxes,m[1],n.rnet,i)]):[2,a({results:[],stats:i})];case 2:return b=x.sent(),i.total_stage2=Date.now()-v,b.boxes.length?(i.stage3_numInputBoxes=b.boxes.length,v=Date.now(),[4,z1(r,b.boxes,m[2],n.onet,i)]):[2,a({results:[],stats:i})];case 3:return w=x.sent(),i.total_stage3=Date.now()-v,_=w.boxes.map((function(t,e){return r1(B0({},new F0(w.scores[e],new BZ(t.left/l,t.top/c,t.width/l,t.height/c),{height:c,width:l})),new d1(w.points[e].map((function(e){return e.sub(new EZ(t.left,t.top)).div(new EZ(t.width,t.height))})),{width:t.width,height:t.height}))})),[2,a({results:_,stats:i})]}}))}))},e.prototype.forward=function(t,e){return void 0===e&&(e={}),uR.b(this,void 0,void 0,(function(){var n;return uR.d(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,_0(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}}))}))},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),uR.b(this,void 0,void 0,(function(){var n;return uR.d(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,_0(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}}))}))},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t){return{filters:n(t+"/weights",4,t+"/filters"),bias:n(t+"/bias",1)}}function o(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}function s(t){return n(t,1)}function a(t){return{conv1:r(t+"/conv1"),prelu1_alpha:s(t+"/prelu1_alpha"),conv2:r(t+"/conv2"),prelu2_alpha:s(t+"/prelu2_alpha"),conv3:r(t+"/conv3"),prelu3_alpha:s(t+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=a("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return uR.a({},t,{conv4_1:e,conv4_2:n})},extractRNetParams:function(){var t=a("rnet"),e=o("rnet/fc1"),n=s("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),i=o("rnet/fc2_2");return uR.a({},t,{fc1:e,prelu4_alpha:n,fc2_1:r,fc2_2:i})},extractONetParams:function(){var t=a("onet"),e=r("onet/conv4"),n=s("onet/prelu4_alpha"),i=o("onet/fc1"),u=s("onet/prelu5_alpha"),c=o("onet/fc2_1"),l=o("onet/fc2_2"),h=o("onet/fc2_3");return uR.a({},t,{conv4:e,prelu4_alpha:n,fc1:i,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:h})}}}(t,e),r=n.extractRNetParams,o=n.extractONetParams,s=(0,n.extractPNetParams)(),a=r(),u=o();return i.disposeUnusedWeightTensors(t,e),{params:{pnet:s,rnet:a,onet:u},paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=i.extractWeightsFactory(t),n=e.getRemainingWeights,r=[],o=function(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractFCParamsFactory(t,e);function o(n,r){var i=mD(t(n));return e.push({paramPath:r}),i}function s(t,e,r){return void 0===r&&(r=!1),{conv1:n(t[0],t[1],3,e+"/conv1"),prelu1_alpha:o(t[1],e+"/prelu1_alpha"),conv2:n(t[1],t[2],3,e+"/conv2"),prelu2_alpha:o(t[2],e+"/prelu2_alpha"),conv3:n(t[2],t[3],r?2:3,e+"/conv3"),prelu3_alpha:o(t[3],e+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=s([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return uR.a({},t,{conv4_1:e,conv4_2:r})},extractRNetParams:function(){var t=s([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),i=r(128,2,"rnet/fc2_1"),a=r(128,4,"rnet/fc2_2");return uR.a({},t,{fc1:e,prelu4_alpha:n,fc2_1:i,fc2_2:a})},extractONetParams:function(){var t=s([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),i=o(128,"onet/prelu4_alpha"),a=r(1152,256,"onet/fc1"),u=o(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),l=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return uR.a({},t,{conv4:e,prelu4_alpha:i,fc1:a,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:h})}}}(e.extractWeights,r),s=o.extractRNetParams,a=o.extractONetParams,u=(0,o.extractPNetParams)(),c=s(),l=a();if(0!==n().length)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:u,rnet:c,onet:l},paramMappings:r}}(t)},e}(x0),q1=[new EZ(1.603231,2.094468),new EZ(6.041143,7.080126),new EZ(2.882459,3.518061),new EZ(4.266906,5.178857),new EZ(9.041765,10.66308)],H1=[117.001,114.697,97.404],G1=function(t){function e(){return t.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:q1,meanRgb:H1,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return uR.c(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return uR.b(this,void 0,void 0,(function(){return uR.d(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new F0(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(i.TinyYolov2),$1=[new EZ(.738768,.874946),new EZ(2.42204,2.65704),new EZ(4.30971,7.04493),new EZ(10.246,4.59428),new EZ(12.6868,11.8741)],K1=[new EZ(1.603231,2.094468),new EZ(6.041143,7.080126),new EZ(2.882459,3.518061),new EZ(4.266906,5.178857),new EZ(9.041765,10.66308)],X1=[117.001,114.697,97.404],Y1=function(t){function e(e){void 0===e&&(e=!0);var n=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:K1,meanRgb:X1}:{anchors:$1,withClassScores:!0});return t.call(this,n)||this}return uR.c(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return uR.b(this,void 0,void 0,(function(){return uR.d(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new F0(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(i.TinyYolov2),Q1={ssdMobilenetv1:new R1,tinyFaceDetector:new G1,tinyYolov2:new Y1,mtcnn:new W1,faceLandmark68Net:new g1,faceLandmark68TinyNet:new y1,faceRecognitionNet:new E1,faceExpressionNet:new J0,ageGenderNet:new h1},J1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){var t,e,n=this;return uR.d(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,D1(t=r.sent(),this.input,(function(t){return uR.b(n,void 0,void 0,(function(){return uR.d(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return Q1.faceExpressionNet.predictExpressions(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){return Object.assign({},t,{expressions:e[n]})}))]}}))}))},e.prototype.withAgeAndGender=function(){return new t2(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return uR.c(e,t),e}(N1)),Z1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.withAgeAndGender=function(){return new e2(this,this.input)},e.prototype.withFaceDescriptors=function(){return new n2(this,this.input)},e}(J1),t2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){var t,e,n=this;return uR.d(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,D1(t=r.sent(),this.input,(function(t){return uR.b(n,void 0,void 0,(function(){return uR.d(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return Q1.ageGenderNet.predictAgeAndGender(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){var r=e[n],i=r.age;return function(t,e){return Object.assign({},t,{age:e})}(Object.assign({},t,{gender:r.gender,genderProbability:r.genderProbability}),i)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new J1(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return uR.c(e,t),e}(N1)),e2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.withFaceExpressions=function(){return new Z1(this,this.input)},e.prototype.withFaceDescriptors=function(){return new n2(this,this.input)},e}(t2),n2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){var t;return uR.d(this,(function(e){switch(e.label){case 0:return[4,this.parentTask];case 1:return[4,D1(t=e.sent(),this.input,(function(t){return Promise.all(t.map((function(t){return Q1.faceRecognitionNet.computeFaceDescriptor(t)})))}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return[2,e.sent().map((function(e,n){return function(t,e){return Object.assign({},t,{descriptor:e})}(t[n],e)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new Z1(this,this.input)},e.prototype.withAgeAndGender=function(){return new e2(this,this.input)},e}(function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return uR.c(e,t),e}(N1)),r2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){var t,e,n,r,i,o=this;return uR.d(this,(function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return t=s.sent(),e=t.map((function(t){return t.detection})),this.input instanceof OO?[4,p1(this.input,e)]:[3,3];case 2:return r=s.sent(),[3,5];case 3:return[4,f1(this.input,e)];case 4:r=s.sent(),s.label=5;case 5:return n=r,[4,Promise.all(n.map((function(t){return o.landmarkNet.detectLandmarks(t)})))];case 6:return i=s.sent(),n.forEach((function(t){return t instanceof OO&&t.dispose()})),[2,t.map((function(t,e){return r1(t,i[e])}))]}}))}))},e.prototype.withFaceExpressions=function(){return new Z1(this,this.input)},e.prototype.withAgeAndGender=function(){return new e2(this,this.input)},e.prototype.withFaceDescriptors=function(){return new n2(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=r,i}return uR.c(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Q1.faceLandmark68TinyNet:Q1.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(N1)),i2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return uR.c(e,t),e.prototype.run=function(){return uR.b(this,void 0,void 0,(function(){var t,e,n,r;return uR.d(this,(function(o){switch(o.label){case 0:return e=(t=this).input,(n=t.options)instanceof S1?[4,Q1.mtcnn.forward(e,n)]:[3,2];case 1:return[2,o.sent().map((function(t){return t.detection}))];case 2:if(!(r=n instanceof O1?function(t){return Q1.tinyFaceDetector.locateFaces(t,n)}:n instanceof A1?function(t){return Q1.ssdMobilenetv1.locateFaces(t,n)}:n instanceof i.TinyYolov2Options?function(t){return Q1.tinyYolov2.locateFaces(t,n)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}}))}))},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise((function(e){return uR.b(t,void 0,void 0,(function(){var t;return uR.d(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t.map((function(t){return B0({},t)})))]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new r2(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new J1(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new t2(this.runAndExtendWithFaceDetections(),this.input)},e}(function(t){function e(e,n){void 0===n&&(n=new A1);var r=t.call(this)||this;return r.input=e,r.options=n,r}return uR.c(e,t),e}(N1));function o2(t,e){return void 0===e&&(e=new A1),new i2(t,e)}function s2(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map((function(t,e){return t-r[e]})).reduce((function(t,e){return t+Math.pow(e,2)}),0))}var a2=uR.a({},r,o),u2=n("zIRd");(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var s=t[o];s in i||(i[s]={}),i=i[s]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function r(){this.a=null}function o(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var s=n.setTimeout;r.prototype.c=function(t){s(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new r;return e.prototype.o=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(I5){o(I5)}}:e}var i,o,s=new e((function(t,e){i=t,o=e}));return this.Pa(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=i(t),s=r.next();!s.done;s=r.next())o(s.value).Pa(e,n)}))},e.all=function(t){var n=i(t),r=n.next();return r.done?o([]):new e((function(t,e){function i(e){return function(n){s[e]=n,0==--a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,o(r.value).Pa(i(s.length-1),e),r=n.next()}while(!r.done)}))},e}));var o=o||{},s=this||self,a=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function h(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){return"function"==l(t)}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function p(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++g)}var m="closure_uid_"+(1e9*Math.random()>>>0),g=0;function v(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:y).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t,e,n){this.code=I+t,this.message=e||k[t]||"",this.a=n||null}function E(t){var e=t&&t.code;return e?new C(e.substring(I.length),t.message,t.serverResponse):null}x(C,Error),C.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},C.prototype.toJSON=function(){return this.w()};var S,I="auth/",k={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},T={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function A(t){for(var e in T)if(T[e].id===t)return{firebaseEndpoint:(t=T[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function R(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function O(t){if(Error.captureStackTrace)Error.captureStackTrace(this,O);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");O.call(this,n+t[r])}function D(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function P(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}S=A("__EID__")?"__EID__":void 0,x(O,Error),O.prototype.name="CustomError",x(N,O),N.prototype.name="AssertionError",P.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new P((function(){return new j}),(function(t){t.reset()}));function B(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function j(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},j.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},j.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function H(t,e){return 0<=V(t,e)}function G(t,e){var n;return(n=0<=(e=V(t,e)))&&Array.prototype.splice.call(t,e,1),n}function $(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1)}))}function K(t){return Array.prototype.concat.apply([],arguments)}function X(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Y,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},J=/&/g,Z=/</g,tt=/>/g,et=/"/g,nt=/'/g,rt=/\x00/g,it=/[\x00&<>"']/;function ot(t,e){return-1!=t.indexOf(e)}function st(t,e){return t<e?-1:t>e?1:0}t:{var at=s.navigator;if(at){var ut=at.userAgent;if(ut){Y=ut;break t}}Y=""}function ct(t){return ot(Y,t)}function lt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function ht(t){for(var e in t)return!1;return!0}function dt(t){var e,n={};for(e in t)n[e]=t[e];return n}var ft="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ft.length;o++)n=ft[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function mt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(f(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function gt(t,e){this.a=t===bt&&e||"",this.b=yt}function vt(t){return t instanceof gt&&t.constructor===gt&&t.b===yt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}gt.prototype.sa=!0,gt.prototype.ra=function(){return this.a},gt.prototype.toString=function(){return"Const{"+this.a+"}"};var yt={},bt={},wt=new gt(bt,"");function _t(t,e){this.a=t===kt&&e||"",this.b=It}function xt(t){return t instanceof _t&&t.constructor===_t&&t.b===It?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+l(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=vt(t);if(!St.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Et,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof gt?vt(t):encodeURIComponent(String(t))})),new _t(kt,t)}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a.toString()},_t.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Et=/%{(\w+)}/g,St=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,It={},kt={};function Tt(t,e){this.a=t===Dt&&e||"",this.b=Nt}function At(t){return t instanceof Tt&&t.constructor===Tt&&t.b===Nt?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+l(t)),"type_error:SafeUrl")}Tt.prototype.sa=!0,Tt.prototype.ra=function(){return this.a.toString()},Tt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ot(t){return t instanceof Tt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Rt.test(t)||(t="about:invalid#zClosurez"),new Tt(Dt,t))}var Nt={},Dt={};function Pt(){this.a="",this.b=Ft}function Mt(t){return t instanceof Pt&&t.constructor===Pt&&t.b===Ft?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+l(t)),"type_error:SafeHtml")}Pt.prototype.sa=!0,Pt.prototype.ra=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ft={};function Lt(t){var e=new Pt;return e.a=t,e}Lt("<!DOCTYPE html>");var Bt=Lt("");function jt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Vt(t){return it.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(J,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Z,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(tt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(et,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(nt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(rt,"&#0;"))),t}function Ut(t){return Ut[" "](t),t}Lt("<br>"),Ut[" "]=c;var zt,Wt,qt=ct("Opera"),Ht=ct("Trident")||ct("MSIE"),Gt=ct("Edge"),$t=Gt||Ht,Kt=ct("Gecko")&&!(ot(Y.toLowerCase(),"webkit")&&!ct("Edge"))&&!(ct("Trident")||ct("MSIE"))&&!ct("Edge"),Xt=ot(Y.toLowerCase(),"webkit")&&!ct("Edge");function Yt(){var t=s.document;return t?t.documentMode:void 0}t:{var Qt="",Jt=(Wt=Y,Kt?/rv:([^\);]+)(\)|;)/.exec(Wt):Gt?/Edge\/([\d\.]+)/.exec(Wt):Ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Wt):Xt?/WebKit\/(\S+)/.exec(Wt):qt?/(?:Version)[ \/]?(\S+)/.exec(Wt):void 0);if(Jt&&(Qt=Jt?Jt[1]:""),Ht){var Zt=Yt();if(null!=Zt&&Zt>parseFloat(Qt)){zt=String(Zt);break t}}zt=Qt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=Q(String(zt)).split("."),r=Q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=st(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||st(0==s[2].length,0==a[2].length)||st(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}te=s.document&&Ht?Yt():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Wt){}var re=!Ht||9<=Number(te);function ie(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function oe(t,e){lt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ue.hasOwnProperty(n)?t.setAttribute(ue[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var se,ae,ue={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ce(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!h(o)||f(o)&&0<o.nodeType?r(o):U(he(o)?X(o):o,r)}}function le(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function he(t){if(t&&"number"==typeof t.length){if(f(t))return"function"==typeof t.item||"string"==typeof t.item;if(d(t))return"function"==typeof t.item}return!1}function de(t){s.setTimeout((function(){throw t}),0)}function fe(t,e){ae||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);ae=function(){t.then(ge)}}else ae=function(){var t=ge;!d(s.setImmediate)||s.Window&&s.Window.prototype&&!ct("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(se||(se=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ct("Presto")&&(t=function(){var t=le(document,"IFRAME");t.style.display="none",function(t){var e=new _t(kt,vt(wt));mt(t,"HTMLIFrameElement"),t.src=xt(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Mt(Bt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=b((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ct("Trident")&&!ct("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){r.next={Fb:t},r=r.next,e.port2.postMessage(0)}}return function(t){s.setTimeout(t,0)}}()),se(t)):s.setImmediate(t)}}(),pe||(ae(),pe=!0),me.add(t,e)}var pe=!1,me=new F;function ge(){for(var t;t=B();){try{t.a.call(t.b)}catch(e){de(e)}M(L,t)}pe=!1}function ve(t,e){if(this.a=ye,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=c)try{var n=this;t.call(e,(function(t){Re(n,be,t)}),(function(t){if(!(t instanceof Le))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Re(n,we,t)}))}catch(r){Re(this,we,r)}}var ye=0,be=2,we=3;function _e(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}_e.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var xe=new P((function(){return new _e}),(function(t){t.reset()}));function Ce(t,e,n){var r=xe.get();return r.g=t,r.b=e,r.f=n,r}function Ee(t){if(t instanceof ve)return t;var e=new ve(c);return Re(e,be,t),e}function Se(t){return new ve((function(e,n){n(t)}))}function Ie(t,e,n){Oe(t,e,n,null)||fe(w(e,t))}function ke(t){return new ve((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Ie(t[o],w(i,o,!0),w(i,o,!1));else e(r)}))}function Te(t,e){t.b||t.a!=be&&t.a!=we||Ne(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ae(t,e,n,r){var i=Ce(null,null,null);return i.a=new ve((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(s){o(s)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Le?o(e):t(i)}catch(s){o(s)}}:o})),i.a.c=t,Te(t,i),i.a}function Re(t,e,n){t.a==ye&&(t===n&&(e=we,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Oe(n,t.Zc,t.$c,t)||(t.i=n,t.a=e,t.c=null,Ne(t),e!=we||n instanceof Le||function(t,e){t.g=!0,fe((function(){t.g&&Fe.call(null,e)}))}(t,n)))}function Oe(t,e,n,r){if(t instanceof ve)return Te(t,Ce(e||c,n||null,r)),!0;if(R(t))return t.then(e,n,r),!0;if(f(t))try{var i=t.then;if(d(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,(function(t){s||(s=!0,n.call(i,t))}),o)}catch(a){o(a)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Ne(t){t.h||(t.h=!0,fe(t.fc,t))}function De(t){var e=null;return t.b&&(t.b=(e=t.b).next,e.next=null),t.b||(t.f=null),e}function Pe(t,e,n,r){if(n==we&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Me(e,n,r);else try{e.c?e.g.call(e.f):Me(e,n,r)}catch(i){Fe.call(null,i)}M(xe,e)}function Me(t,e,n){e==be?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}ve.prototype.then=function(t,e,n){return Ae(this,d(t)?t:null,d(e)?e:null,n)},ve.prototype.$goog_Thenable=!0,(t=ve.prototype).na=function(t,e){return(t=Ce(t,t,e)).c=!0,Te(this,t),this},t.s=function(t,e){return Ae(this,null,t,e)},t.cancel=function(t){if(this.a==ye){var e=new Le(t);fe((function(){!function t(e,n){if(e.a==ye)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==e&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==ye&&1==i?t(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):De(r),Pe(r,o,we,n)))}e.c=null}else Re(e,we,n)}(this,e)}),this)}},t.Zc=function(t){this.a=ye,Re(this,be,t)},t.$c=function(t){this.a=ye,Re(this,we,t)},t.fc=function(){for(var t;t=De(this);)Pe(this,t,this.a,this.i);this.h=!1};var Fe=de;function Le(t){O.call(this,t)}function Be(){0!=je&&(Ve[p(this)]=this),this.xa=this.xa,this.oa=this.oa}x(Le,O),Le.prototype.name="cancel";var je=0,Ve={};function Ue(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=je)){var e=p(t);if(0!=je&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ve[e]}}Be.prototype.xa=!1,Be.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var ze=Object.freeze||function(t){return t},We=!Ht||9<=Number(te),qe=Ht&&!ne("9"),He=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",c,e),s.removeEventListener("test",c,e)}catch(n){}return t}();function Ge(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function $e(t,e){if(Ge.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Kt){t:{try{Ut(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ke[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ge.prototype.preventDefault=function(){this.defaultPrevented=!0},x($e,Ge);var Ke=ze({2:"touch",3:"pen",4:"mouse"});$e.prototype.preventDefault=function(){$e.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,qe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},$e.prototype.g=function(){return this.a};var Xe="closure_listenable_"+(1e6*Math.random()|0),Ye=0;function Qe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Ye,this.va=this.Oa=!1}function Je(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function Ze(t){this.src=t,this.a={},this.b=0}function tn(t,e){var n=e.type;n in t.a&&G(t.a[n],e)&&(Je(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function en(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==r)return i}return-1}Ze.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=en(t,e,r,i);return-1<s?(e=t[s],n||(e.Oa=!1)):((e=new Qe(e,this.src,o,!!r,i)).Oa=n,t.push(e)),e};var nn="closure_lm_"+(1e6*Math.random()|0),rn={};function on(t,e,n,r,i){if(r&&r.once)an(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)on(t,e[o],n,r,i);else n=gn(n),t&&t[Xe]?yn(t,e,n,f(r)?!!r.capture:!!r,i):sn(t,e,n,!1,r,i)}function sn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=f(i)?!!i.capture:!!i,a=pn(t);if(a||(t[nn]=a=new Ze(t)),!(n=a.add(e,n,r,s,o)).proxy)if(r=function(){var t=fn,e=We?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)He||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ln(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function an(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)an(t,e[o],n,r,i);else n=gn(n),t&&t[Xe]?bn(t,e,n,f(r)?!!r.capture:!!r,i):sn(t,e,n,!0,r,i)}function un(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,r,i);else r=f(r)?!!r.capture:!!r,n=gn(n),t&&t[Xe]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=en(o=t.a[e],n,r,i))&&(Je(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=pn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=en(e,n,r,i)),(n=-1<t?e[t]:null)&&cn(n))}function cn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[Xe])tn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ln(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=pn(e))?(tn(n,t),0==n.b&&(n.src=null,e[nn]=null)):Je(t)}}}function ln(t){return t in rn?rn[t]:rn[t]="on"+t}function hn(t,e,n,r){var i=!0;if((t=pn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=dn(o,r),i=i&&!1!==o)}return i}function dn(t,e){var n=t.listener,r=t.Ua||t.src;return t.Oa&&cn(t),n.call(r,e)}function fn(t,e){if(t.va)return!0;if(!We){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new $e(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=hn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=hn(r[i],t,!1,e),n=n&&o}return n}return dn(t,new $e(e,this))}function pn(t){return(t=t[nn])instanceof Ze?t:null}var mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function gn(t){return d(t)?t:(t[mn]||(t[mn]=function(e){return t.handleEvent(e)}),t[mn])}function vn(){Be.call(this),this.v=new Ze(this),this.$b=this,this.fb=null}function yn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function bn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function wn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.va&&s.capture==n){var a=s.listener,u=s.Ua||s.src;s.Oa&&tn(t.v,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function _n(t,e,n){if(d(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function xn(t){var e=null;return new ve((function(n,r){-1==(e=_n((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw s.clearTimeout(e),t}))}function Cn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function En(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(h(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Sn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Sn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function In(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];kn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)kn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function kn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}x(vn,Be),vn.prototype[Xe]=!0,vn.prototype.addEventListener=function(t,e,n,r){on(this,t,e,n,r)},vn.prototype.removeEventListener=function(t,e,n,r){un(this,t,e,n,r)},vn.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var r=t.type||t;if("string"==typeof t)t=new Ge(t,n);else if(t instanceof Ge)t.target=t.target||n;else{var i=t;pt(t=new Ge(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=wn(s,r,!0,t)&&i}if(i=wn(s=t.b=n,r,!0,t)&&i,i=wn(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=wn(s=t.b=e[o],r,!1,t)&&i;return i},vn.prototype.Da=function(){if(vn.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Je(n[r]);delete e.a[t],e.b--}}this.fb=null},(t=Sn.prototype).V=function(){In(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return In(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return kn(this.b,t)?this.b[t]:e},t.set=function(t,e){kn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Tn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function An(t,e){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,t instanceof An?(this.i=void 0!==e?e:t.i,Rn(this,t.f),this.l=t.l,this.a=t.a,On(this,t.g),this.c=t.c,Nn(this,Qn(t.b)),this.h=t.h):t&&(n=String(t).match(Tn))?(this.i=!!e,Rn(this,n[1]||"",!0),this.l=Ln(n[2]||""),this.a=Ln(n[3]||"",!0),On(this,n[4]),this.c=Ln(n[5]||"",!0),Nn(this,n[6]||"",!0),this.h=Ln(n[7]||"")):(this.i=!!e,this.b=new Hn(null,this.i))}function Rn(t,e,n){t.f=n?Ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function On(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Nn(t,e,n){e instanceof Hn?(t.b=e,function(t,e){e&&!t.f&&(Gn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Kn(this,e),Yn(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Bn(e,Wn)),t.b=new Hn(e,t.i))}function Dn(t,e,n){t.b.set(e,n)}function Pn(t,e){return t.b.get(e)}function Mn(t){return t instanceof An?new An(t):new An(t,void 0)}function Fn(t,e,n,r){var i=new An(null,void 0);return t&&Rn(i,t),e&&(i.a=e),n&&On(i,n),r&&(i.c=r),i}function Ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,jn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}An.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Bn(e,Vn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Bn(e,Vn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?zn:Un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Bn(n,qn)),t.join("")},An.prototype.resolve=function(t){var e=new An(this),n=!!t.f;n?Rn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.c;if(n)On(e,t.g);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.a&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ot(i,"./")||ot(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.b.toString(),n?Nn(e,Qn(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Vn=/[#\/\?@]/g,Un=/[#\?:]/g,zn=/[#\?]/g,Wn=/[#\?@]/g,qn=/#/g;function Hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Gn(t){t.a||(t.a=new Sn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $n(t){var e=En(t);if(void 0===e)throw Error("Keys are undefined");var n=new Hn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?Yn(n,i,o):n.add(i,o)}return n}function Kn(t,e){Gn(t),e=Jn(t,e),kn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,kn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&In(t)))}function Xn(t,e){return Gn(t),e=Jn(t,e),kn(t.a.b,e)}function Yn(t,e,n){Kn(t,e),0<n.length&&(t.c=null,t.a.set(Jn(t,e),X(n)),t.b+=n.length)}function Qn(t){var e=new Hn;return e.c=t.c,t.a&&(e.a=new Sn(t.a),e.b=t.b),e}function Jn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Zn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(s=n[i])&&(r.push(o),rr(i,r),r.push(":"),t(e,s,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":rr(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new tr,t,e),e.join("")}function tr(){}(t=Hn.prototype).add=function(t,e){Gn(this),this.c=null,t=Jn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Gn(this),this.a.forEach((function(n,r){U(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Gn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.V=function(t){Gn(this);var e=[];if("string"==typeof t)Xn(this,t)&&(e=K(e,this.a.get(Jn(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=K(e,t[n])}return e},t.set=function(t,e){return Gn(this),this.c=null,Xn(this,t=Jn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var er={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},nr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function rr(t,e){e.push('"',t.replace(nr,(function(t){var e=er[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),er[t]=e),e})),'"')}function ir(){var t=xr();return Ht&&!!te&&11==te||/Edge\/\d+/.test(t)}function or(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function sr(t,e){e=e||s.window;var n="about:blank";t&&(n=At(Ot(t))),e.location.href=n}function ar(t){return!!((t=(t||xr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ur(t){t=t||s.window;try{t.close()}catch(e){}}function cr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=xr().toLowerCase(),r&&(e.target=r,ot(n,"crios/")&&(e.target="_blank")),br(xr())==yr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Tt?n:Ot(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((ct("iPhone")&&!ct("iPod")&&!ct("iPad")||ct("iPad")||ct("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(mt(s=le(document,"A"),"HTMLAnchorElement"),e instanceof Tt||e instanceof Tt||(e="object"==typeof e&&e.sa?e.ra():String(e),Rt.test(e)||(e="about:invalid#zClosurez"),e=new Tt(Dt,e)),s.href=At(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=At(e),s&&($t&&ot(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Lt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Vt(t)+'">'),r=s.document)&&(r.write(Mt(t)),r.close())):(s=r.open(At(e),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(a){}return s}var lr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hr=/^[^@]+@[^@]+$/;function dr(){var t=null;return new ve((function(e){"complete"==s.document.readyState?e():(t=function(){e()},an(window,"load",t))})).s((function(e){throw un(window,"load",t),e}))}function fr(t){return t=t||xr(),!("file:"!==kr()&&"ionic:"!==kr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function pr(){var t=s.window;try{return!(!t||t==t.top)}catch(e){return!1}}function mr(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function gr(){return u2.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":u2.a.INTERNAL.hasOwnProperty("node")?"Node":mr()?"Worker":"Browser"}function vr(){var t=gr();return"ReactNative"===t||"Node"===t}var yr="Firefox";function br(t){var e=t.toLowerCase();return ot(e,"opera/")||ot(e,"opr/")||ot(e,"opios/")?"Opera":ot(e,"iemobile")?"IEMobile":ot(e,"msie")||ot(e,"trident/")?"IE":ot(e,"edge/")?"Edge":ot(e,"firefox/")?yr:ot(e,"silk/")?"Silk":ot(e,"blackberry")?"Blackberry":ot(e,"webos")?"Webos":!ot(e,"safari/")||ot(e,"chrome/")||ot(e,"crios/")||ot(e,"android")?!ot(e,"chrome/")&&!ot(e,"crios/")||ot(e,"edge/")?ot(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"}var wr={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function _r(t,e){e=e||[];var n,r=[],i={};for(n in wr)i[wr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=gr())?r=br(i=xr()):"Worker"===r&&(r=br(i=xr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function xr(){return s.navigator&&s.navigator.userAgent||""}function Cr(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Er(){try{var t=s.localStorage,e=Nr();if(t)return t.setItem(e,"1"),t.removeItem(e),!ir()||!!s.indexedDB}catch(n){return mr()&&!!s.indexedDB}return!1}function Sr(){return(Ir()||"chrome-extension:"===kr()||fr())&&!vr()&&Er()&&!mr()}function Ir(){return"http:"===kr()||"https:"===kr()}function kr(){return s.location&&s.location.protocol||null}function Tr(t){return!ar(t=t||xr())&&br(t)!=yr}function Ar(t){return void 0===t?null:Zn(t)}function Rr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!=t[e]&&(n[e]=t[e]);return n}function Or(t){if(null!==t)return JSON.parse(t)}function Nr(t){return t||Math.floor(1e9*Math.random()).toString()}function Dr(t){return"Safari"!=br(t=t||xr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Pr(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Mr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=xr(),e=gr(),this.b=ar(t)||"ReactNative"===e}function Fr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Lr(t){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t)}function Br(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function jr(){return!(!Cr("fireauth.oauthhelper",s)&&!Cr("fireauth.iframe",s))}Mr.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Ir()&&"chrome-extension:"!==kr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Vr,Ur={};function zr(t){Ur[t]||(Ur[t]=!0,Lr(t))}try{var Wr={};Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:2}),Vr=2==Wr.abcd}catch(Wt){Vr=!1}function qr(t,e,n){Vr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Hr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&qr(t,n,e[n])}function Gr(t){var e={};return Hr(e,t),e}function $r(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)qr(e,n,$r(t[n]));return e}function Kr(t){var e=t&&(t[Zr]?"phone":null);if(!(e&&t&&t[Jr]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");qr(this,"uid",t[Jr]),qr(this,"displayName",t[Yr]||null);var n=null;t[Qr]&&(n=new Date(t[Qr]).toUTCString()),qr(this,"enrollmentTime",n),qr(this,"factorId",e)}function Xr(t){try{var e=new ti(t)}catch(n){e=null}return e}Kr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Yr="displayName",Qr="enrolledAt",Jr="mfaEnrollmentId",Zr="phoneInfo";function ti(t){Kr.call(this,t),qr(this,"phoneNumber",t[Zr])}function ei(t){var e={},n=t[oi],r=t[ai],i=t[ui];if(t=Xr(t[si]),!i||i!=ri&&i!=ii&&!n||i==ii&&!r||i==ni&&!t)throw Error("Invalid checkActionCode response!");i==ii?(e[li]=n||null,e[di]=n||null,e[ci]=r):(e[li]=r||null,e[di]=r||null,e[ci]=n||null),e[hi]=t||null,qr(this,pi,i),qr(this,fi,$r(e))}x(ti,Kr),ti.prototype.w=function(){var t=ti.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var ni="REVERT_SECOND_FACTOR_ADDITION",ri="EMAIL_SIGNIN",ii="VERIFY_AND_CHANGE_EMAIL",oi="email",si="mfaInfo",ai="newEmail",ui="requestType",ci="email",li="fromEmail",hi="multiFactorInfo",di="previousEmail",fi="data",pi="operation";function mi(t){var e=Pn(t=Mn(t),gi)||null,n=Pn(t,vi)||null,r=Pn(t,wi)||null;if(r=r&&xi[r]||null,!e||!n||!r)throw new C("argument-error",gi+", "+vi+"and "+wi+" are required in a valid action code URL.");Hr(this,{apiKey:e,operation:r,code:n,continueUrl:Pn(t,yi)||null,languageCode:Pn(t,bi)||null,tenantId:Pn(t,_i)||null})}var gi="apiKey",vi="oobCode",yi="continueUrl",bi="languageCode",wi="mode",_i="tenantId",xi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ni,signIn:ri,verifyAndChangeEmail:ii,verifyEmail:"VERIFY_EMAIL"};function Ci(t){try{return new mi(t)}catch(e){return null}}function Ei(t){var e=t[Ai];if(void 0===e)throw new C("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new C("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Si];if(n&&"object"==typeof n){e=n[Ni];var r=n[Ri];if(n=n[Oi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",Ri+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",Oi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new C("argument-error",Ni+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",Si+" property must be a non null object when specified.");if(this.f=null,(e=t[Ti])&&"object"==typeof e){if("string"==typeof(e=e[Di])&&e.length)this.f=e;else if(void 0!==e)throw new C("argument-error",Di+" property must be a non empty string when specified.")}else if(void 0!==e)throw new C("argument-error",Ti+" property must be a non null object when specified.");if(void 0!==(e=t[ki])&&"boolean"!=typeof e)throw new C("argument-error",ki+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Ii])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new C("argument-error",Ii+" property must be a non empty string when specified.");this.i=t||null}var Si="android",Ii="dynamicLinkDomain",ki="handleCodeInApp",Ti="iOS",Ai="url",Ri="installApp",Oi="minimumVersion",Ni="packageName",Di="bundleId";function Pi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Mi=null;function Fi(t){var e=Bi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,_(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Li(t){try{return new Fi(t)}catch(e){return null}}function Bi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Mi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Mi){Mi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Mi[o]&&(Mi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(t,(function(t){e+=String.fromCharCode(t)})),e}(t))}catch(r){}return null}Fi.prototype.S=function(){return this.f},Fi.prototype.i=function(){return this.b},Fi.prototype.toString=function(){return this.g};var ji="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Vi=["client_id","response_type","scope","redirect_uri","state"],Ui={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:Vi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:Vi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:Vi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:ji},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function zi(t){for(var e in Ui)if(Ui[e].fa==t)return Ui[e];return null}function Wi(t){var e={};e["facebook.com"]=Ki,e["google.com"]=Yi,e["github.com"]=Xi,e["twitter.com"]=Qi;var n=t&&t[Hi];try{if(n)return e[n]?new e[n](t):new $i(t);if(void 0!==t[qi])return new Gi(t)}catch(r){}return null}var qi="idToken",Hi="providerId";function Gi(t){var e=t[Hi];if(!e&&t[qi]){var n=Li(t[qi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),qr(this,"providerId",e),qr(this,"isNewUser",n)}function $i(t){Gi.call(this,t),qr(this,"profile",$r((t=Or(t.rawUserInfo||"{}"))||{}))}function Ki(t){if($i.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Xi(t){if($i.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",this.profile&&this.profile.login||null)}function Yi(t){if($i.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qi(t){if($i.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",t.screenName||null)}function Ji(t){var e=Mn(t),n=Pn(e,"link"),r=Pn(Mn(n),"link");return e=Pn(e,"deep_link_id"),Pn(Mn(e),"link")||e||r||n||t}function Zi(t,e){if(!t&&!e)throw new C("internal-error","Internal assert: no raw session string available");if(t&&e)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?to:eo}x($i,Gi),x(Ki,$i),x(Xi,$i),x(Yi,$i),x(Qi,$i);var to="enroll",eo="signin";function no(){}function ro(t,e){return t.then((function(t){if(t[Ws]){var n=Li(t[Ws]);if(!n||e!=n.h)throw new C("user-mismatch");return t}throw new C("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==I+"user-not-found"?new C("user-mismatch"):t}))}function io(t,e){if(!e)throw new C("internal-error","failed to construct a credential");this.a=e,qr(this,"providerId",t),qr(this,"signInMethod",t)}function oo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function so(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new io(t.providerId,t.pendingToken)}catch(e){}return null}function ao(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&qr(this,"idToken",e.idToken),e.accessToken&&qr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&qr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");qr(this,"accessToken",e.oauthToken),qr(this,"secret",e.oauthTokenSecret)}qr(this,"providerId",t),qr(this,"signInMethod",n)}function uo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:$n(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function co(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new ao(t.providerId,e,t.signInMethod)}catch(n){}}return null}function lo(t,e){this.Pc=e||[],Hr(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(zi(t)||{}).Ja||null,this.nb=null}function ho(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');lo.call(this,t,[])}function fo(t){lo.call(this,t,Vi),this.a=[]}function po(){fo.call(this,"facebook.com")}function mo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),(new po).credential({accessToken:e})}function go(){fo.call(this,"github.com")}function vo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),(new go).credential({accessToken:e})}function yo(){fo.call(this,"google.com"),this.Ca("profile")}function bo(t,e){var n=t;return f(t)&&(n=t.idToken,e=t.accessToken),(new yo).credential({idToken:n,accessToken:e})}function wo(){lo.call(this,"twitter.com",ji)}function _o(t,e){var n=t;if(f(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new ao("twitter.com",n,"twitter.com")}function xo(t,e,n){this.a=t,this.f=e,qr(this,"providerId","password"),qr(this,"signInMethod",n===Eo.EMAIL_LINK_SIGN_IN_METHOD?Eo.EMAIL_LINK_SIGN_IN_METHOD:Eo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Co(t){return t&&t.email&&t.password?new xo(t.email,t.password,t.signInMethod):null}function Eo(){Hr(this,{providerId:"password",isOAuthProvider:!1})}function So(t,e){if(!(e=Io(e)))throw new C("argument-error","Invalid email link!");return new xo(t,e.code,Eo.EMAIL_LINK_SIGN_IN_METHOD)}function Io(t){return(t=Ci(t=Ji(t)))&&t.operation===ri?t:null}function ko(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new C("internal-error");this.a=t,qr(this,"providerId","phone"),this.fa="phone",qr(this,"signInMethod","phone")}function To(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return U(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new ko(e)}return null}function Ao(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Ro(t){try{this.a=t||u2.a.auth()}catch(e){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Hr(this,{providerId:"phone",isOAuthProvider:!1})}function Oo(t,e){if(!t)throw new C("missing-verification-id");if(!e)throw new C("missing-verification-code");return new ko({cb:t,bb:e})}function No(t){if(t.temporaryProof&&t.phoneNumber)return new ko({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return bo(o,n);case"facebook.com":return mo(n);case"github.com":return vo(n);case"twitter.com":return _o(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new io(e,s):new ao(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new fo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(a){return null}}function Do(t){if(!t.isOAuthProvider)throw new C("invalid-oauth-provider")}function Po(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Mo(t){return(t=t||{}).type?new Po(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&E(t.error),t.postBody,t.tenantId):null}function Fo(){this.b=null,this.a=[]}Zi.prototype.Ha=function(){return Ee(this.a?this.a:this.b)},Zi.prototype.w=function(){return this.type==to?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},no.prototype.ja=function(){},no.prototype.b=function(){},no.prototype.c=function(){},no.prototype.w=function(){},io.prototype.ja=function(t){return la(t,oo(this))},io.prototype.b=function(t,e){var n=oo(this);return n.idToken=e,ha(t,n)},io.prototype.c=function(t,e){return ro(da(t,oo(this)),e)},io.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},ao.prototype.ja=function(t){return la(t,uo(this))},ao.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,ha(t,n)},ao.prototype.c=function(t,e){return ro(da(t,uo(this)),e)},ao.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},lo.prototype.Ka=function(t){return this.Hb=dt(t),this},x(ho,lo),x(fo,lo),fo.prototype.Ca=function(t){return H(this.a,t)||this.a.push(t),this},fo.prototype.Pb=function(){return X(this.a)},fo.prototype.credential=function(t,e){var n;if(!(n=f(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new ao(this.providerId,n,this.providerId)},x(po,fo),qr(po,"PROVIDER_ID","facebook.com"),qr(po,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),x(go,fo),qr(go,"PROVIDER_ID","github.com"),qr(go,"GITHUB_SIGN_IN_METHOD","github.com"),x(yo,fo),qr(yo,"PROVIDER_ID","google.com"),qr(yo,"GOOGLE_SIGN_IN_METHOD","google.com"),x(wo,lo),qr(wo,"PROVIDER_ID","twitter.com"),qr(wo,"TWITTER_SIGN_IN_METHOD","twitter.com"),xo.prototype.ja=function(t){return this.signInMethod==Eo.EMAIL_LINK_SIGN_IN_METHOD?$a(t,wa,{email:this.a,oobCode:this.f}):$a(t,za,{email:this.a,password:this.f})},xo.prototype.b=function(t,e){return this.signInMethod==Eo.EMAIL_LINK_SIGN_IN_METHOD?$a(t,_a,{idToken:e,email:this.a,oobCode:this.f}):$a(t,Pa,{idToken:e,email:this.a,password:this.f})},xo.prototype.c=function(t,e){return ro(this.ja(t),e)},xo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Hr(Eo,{PROVIDER_ID:"password"}),Hr(Eo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Hr(Eo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),ko.prototype.ja=function(t){return t.eb(Ao(this))},ko.prototype.b=function(t,e){var n=Ao(this);return n.idToken=e,$a(t,qa,n)},ko.prototype.c=function(t,e){var n=Ao(this);return n.operation="REAUTH",ro(t=$a(t,Ha,n),e)},ko.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Ro.prototype.eb=function(t,e){var n=this.a.a;return Ee(e.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=f(t)?t.session:null,o=f(t)?t.phoneNumber:t;return(i&&i.type==to?i.Ha().then((function(t){return function(t,e){return $a(t,Fa,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==eo?i.Ha().then((function(e){return function(t,e){return $a(t,La,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return $a(t,Na,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Hr(Ro,{PROVIDER_ID:"phone"}),Hr(Ro,{PHONE_SIGN_IN_METHOD:"phone"}),Po.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Po.prototype.S=function(){return this.h},Po.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Lo,Bo=null;function jo(t){var e="unauthorized-domain",n=void 0,r=Mn(t);t=r.a,"chrome-extension"==(r=r.f)?n=jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",C.call(this,e,n)}function Vo(t,e,n){C.call(this,t,n),(t=e||{}).Ib&&qr(this,"email",t.Ib),t.ea&&qr(this,"phoneNumber",t.ea),t.credential&&qr(this,"credential",t.credential),t.Yb&&qr(this,"tenantId",t.Yb)}function Uo(t){if(t.code){var e=t.code||"";0==e.indexOf(I)&&(e=e.substring(I.length));var n={credential:No(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new C(e,t.message||void 0);return new Vo(e,n,t.message)}return null}function zo(){}function Wo(){}function qo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Ho(){}function Go(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=b(this.pc,this),this.a.onerror=b(this.Rb,this),this.a.onprogress=b(this.qc,this),this.a.ontimeout=b(this.uc,this)}function $o(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Ko(t,e,n){this.reset(t,e,n,void 0,void 0)}function Xo(t){this.f=t,this.b=this.c=this.a=null}function Yo(t,e){this.name=t,this.value=e}x(jo,C),x(Vo,C),Vo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&pt(t,e),t},Vo.prototype.toJSON=function(){return this.w()},zo.prototype.c=null,x(Wo,zo),Wo.prototype.a=function(){var t=qo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Wo.prototype.b=function(){var t={};return qo(this)&&(t[0]=!0,t[1]=!0),t},Lo=new Wo,x(Ho,zo),Ho.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Go;throw Error("Unsupported browser")},Ho.prototype.b=function(){return{}},(t=Go.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,$o(this,4)},t.Rb=function(){this.status=500,this.response=this.responseText="",$o(this,4)},t.uc=function(){this.Rb()},t.qc=function(){this.status=200,$o(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Ko.prototype.a=null,Ko.prototype.reset=function(t,e,n,r,i){r||_(),delete this.a},Yo.prototype.toString=function(){return this.name};var Qo=new Yo("SEVERE",1e3),Jo=new Yo("WARNING",900),Zo=new Yo("CONFIG",700),ts=new Yo("FINE",500);Xo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(d(e)&&(e=e()),t=new Ko(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var es={},ns=null;function rs(t){var e;if(ns||(ns=new Xo(""),es[""]=ns,ns.c=Zo),!(e=es[t])){e=new Xo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=rs(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,es[t]=e}return e}function is(t,e){t&&t.log(ts,e,void 0)}function os(t){this.f=t}function ss(t){vn.call(this),this.o=t,this.readyState=as,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=rs("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}x(os,zo),os.prototype.a=function(){return new ss(this.f)},os.prototype.b=function(t){return function(){return t}}({}),x(ss,vn);var as=0;function us(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function cs(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,ls(t)}function ls(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function hs(t){vn.call(this),this.headers=new Sn,this.O=t||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.o=null,this.m=ds,this.u=this.R=!1}(t=ss.prototype).open=function(t,e){if(this.readyState!=as)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,ls(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.tc.bind(this),this.Ta.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,cs(this,!1)),this.readyState=as},t.tc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,ls(this)),this.a&&(this.readyState=3,ls(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,us(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},t.oc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?cs(this,!0):ls(this),3==this.readyState&&us(this)}},t.sc=function(t){this.a&&(this.response=this.responseText=t,cs(this,!0))},t.rc=function(t){this.a&&(this.response=t,cs(this,!0))},t.Ta=function(t){var e=this.h;e&&e.log(Jo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&cs(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Jo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Jo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},x(hs,vn);var ds="";hs.prototype.b=rs("goog.net.XhrIo");var fs=/^https?$/i,ps=["POST","PUT"];function ms(t){return"content-type"==t.toLowerCase()}function gs(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,vs(t),bs(t)}function vs(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ys(t){if(t.c&&void 0!==o)if(t.A[1]&&4==_s(t)&&2==xs(t))is(t.b,Cs(t,"Local request error detected and ignored"));else if(t.i&&4==_s(t))_n(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==_s(t)){is(t.b,Cs(t,"Request complete")),t.c=!1;try{var e,n=xs(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.l).match(Tn)[1]||null;if(!a&&s.self&&s.self.location){var u=s.self.location.protocol;a=u.substr(0,u.length-1)}i=!fs.test(a?a.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<_s(t)?t.a.statusText:""}catch(l){is(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+xs(t)+"]",vs(t)}}finally{bs(t)}}}function bs(t,e){if(t.a){ws(t);var n=t.a,r=t.A[0]?c:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Qo,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function ws(t){t.a&&t.u&&(t.a.ontimeout=null),t.o&&(s.clearTimeout(t.o),t.o=null)}function _s(t){return t.a?t.a.readyState:0}function xs(t){try{return 2<_s(t)?t.a.status:-1}catch(e){return-1}}function Cs(t,e){return e+" ["+t.P+" "+t.l+" "+xs(t)+"]"}function Es(t){var e=Ms;this.g=[],this.u=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function Ss(t,e,n){t.a=!0,t.c=n,t.f=!e,As(t)}function Is(t){if(t.a){if(!t.m)throw new Rs(t);t.m=!1}}function ks(t,e,n,r){t.g.push([e,n,r]),t.a&&As(t)}function Ts(t){return q(t.g,(function(t){return d(t[1])}))}function As(t){if(t.h&&t.a&&Ts(t)){var e=t.h,n=Ds[e];n&&(s.clearTimeout(n.a),delete Ds[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.o,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(R(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ts(t)||(n=!0)}}t.c=e,r&&(u=b(t.v,t,!0),r=b(t.v,t,!1),e instanceof Es?(ks(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new Ns(e),Ds[e.a]=e,t.h=e.a)}function Rs(){O.call(this)}function Os(){O.call(this)}function Ns(t){this.a=s.setTimeout(b(this.c,this),0),this.b=t}(t=hs.prototype).Ma=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",is(this.b,Cs(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(is(this.b,Cs(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),bs(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),bs(this,!0)),hs.$a.Da.call(this)},t.Ub=function(){this.xa||(this.N||this.i||this.f?ys(this):this.Ic())},t.Ic=function(){ys(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ds:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Qo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return is(this.b,"Can not get response: "+e.message),null}},Es.prototype.cancel=function(t){if(this.a)this.c instanceof Es&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.o,this):this.m=!0,this.a||(t=new Os(this),Is(this),Ss(this,!1,t))}},Es.prototype.v=function(t,e){this.i=!1,Ss(this,t,e)},Es.prototype.then=function(t,e,n){var r,i,o=new ve((function(t,e){r=t,i=e}));return ks(this,r,(function(t){t instanceof Os?o.cancel():i(t)})),o.then(t,e,n)},Es.prototype.$goog_Thenable=!0,x(Rs,O),Rs.prototype.message="Deferred has already fired",Rs.prototype.name="AlreadyCalledError",x(Os,O),Os.prototype.message="Deferred was canceled",Os.prototype.name="CanceledError",Ns.prototype.c=function(){throw delete Ds[this.a],this.b};var Ds={};function Ps(t){var e={},n=e.document||document,r=xt(t).toString(),i=le(document,"SCRIPT"),o={Vb:i,Ma:void 0},c=new Es(o),l=null,h=null!=e.timeout?e.timeout:5e3;return 0<h&&(l=window.setTimeout((function(){Fs(i,!0);var t=new js(Bs,"Timeout reached for loading script "+r);Is(c),Ss(c,!1,t)}),h),o.Ma=l),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Fs(i,e.wd||!1,l),Is(c),Ss(c,!0,null))},i.onerror=function(){Fs(i,!0,l);var t=new js(Ls,"Error while loading script "+r);Is(c),Ss(c,!1,t)},pt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),oe(i,o),function(t,e){mt(t,"HTMLScriptElement"),t.src=xt(e),null===u&&(u=(e=(e=s.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&a.test(e)?e:""),(e=u)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),c}function Ms(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&Fs(t,!0,this.Ma)}}function Fs(t,e,n){null!=n&&s.clearTimeout(n),t.onload=c,t.onerror=c,t.onreadystatechange=c,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ls=0,Bs=1;function js(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),O.call(this,n),this.code=t}function Vs(t){this.f=t}function Us(t,e,n){if(this.c=t,this.l=(t=e||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||qs,this.g=dt(t.secureTokenHeaders||Hs),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||Gs,this.a=dt(t.firebaseHeaders||$s),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==gr(),!(n=s.XMLHttpRequest||n&&u2.a.INTERNAL.node&&u2.a.INTERNAL.node.XMLHttpRequest)&&!mr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=mr()?new os(self):vr()?new Vs(n):new Ho,this.b=null}x(js,O),x(Vs,zo),Vs.prototype.a=function(){return new this.f},Vs.prototype.b=function(){return{}};var zs,Ws="idToken",qs=new Mr(3e4,6e4),Hs={"Content-Type":"application/x-www-form-urlencoded"},Gs=new Mr(3e4,6e4),$s={"Content-Type":"application/json"};function Ks(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Xs(t,e){e&&(t.l=Ys("https://securetoken.googleapis.com/v1/token",e),t.h=Ys("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=Ys("https://identitytoolkit.googleapis.com/v2/",e))}function Ys(t,e){return t=Mn(t),e=Mn(e.url),t.c=t.a+t.c,Rn(t,e.f),t.a=e.a,On(t,e.g),t.toString()}function Qs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Js(t,e,n,r,i,o,a){(function(){var t=xr();return!((t="Chrome"!=br(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Ht&&te&&!(9<te))})()||mr()?t=b(t.u,t):(zs||(zs=new ve((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(s[ta]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ks(t,null,e,void 0)}(Ps(Ct(Zs,{onload:ta})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=b(t.o,t)),t(e,n,r,i,o,a)}Us.prototype.S=function(){return this.b},Us.prototype.u=function(t,e,n,r,i,o){if(mr()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new hs(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout((function(){a.dispatchEvent("timeout")}),o)}yn(a,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return is(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),bn(a,"ready",(function(){u&&clearTimeout(u),Ue(this)})),bn(a,"timeout",(function(){u&&clearTimeout(u),Ue(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Lo.a(),t.A=function(t){return t.c||(t.c=t.b())}(t.O?t.O:Lo),t.a.onreadystatechange=b(t.Ub,t);try{is(t.b,Cs(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(a){return is(t.b,Cs(t,"Error opening Xhr: "+a.message)),void gs(t,a)}e=r||"";var o=new Sn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)U(t,e,void 0);else for(var n=En(t),r=Cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ms,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=s.FormData&&e instanceof s.FormData,!H(ps,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{ws(t),0<t.g&&(t.u=function(t){return Ht&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),is(t.b,Cs(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=b(t.Ma,t)):t.o=_n(t.Ma,t.g,t)),is(t.b,Cs(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){is(t.b,Cs(t,"Send error: "+a.message)),gs(t,a)}}(a,t,n,r,i)};var Zs=new gt(bt,"https://apis.google.com/js/client.js?onload=%{onload}"),ta="__fcb"+Math.floor(1e6*Math.random()).toString();function ea(t){if("string"!=typeof(t=t.email)||!hr.test(t))throw new C("invalid-email")}function na(t){"email"in t&&ea(t)}function ra(t){if(!t[Ws]){if(t.mfaPendingCredential)throw new C("multi-factor-auth-required",null,dt(t));throw new C("internal-error")}}function ia(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new C("internal-error")}else{if(!t.sessionInfo)throw new C("missing-verification-id");if(!t.code)throw new C("missing-verification-code")}}Us.prototype.o=function(t,e,n,r,i){var o=this;zs.then((function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Us.prototype.yb=function(){return $a(this,Ma,{})},Us.prototype.Ab=function(t,e){return $a(this,Da,{idToken:t,email:e})},Us.prototype.Bb=function(t,e){return $a(this,Pa,{idToken:t,password:e})};var oa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function sa(t){if(!t.phoneVerificationInfo)throw new C("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new C("missing-verification-code")}function aa(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new C("internal-error")}function ua(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Xn(t=new Hn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function ca(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Uo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Uo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Uo(t)):t.errorMessage&&(e=Ka(t.errorMessage)),e)throw e;ra(t)}function la(t,e){return e.returnIdpCredential=!0,$a(t,Ba,e)}function ha(t,e){return e.returnIdpCredential=!0,$a(t,Va,e)}function da(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,$a(t,ja,e)}function fa(t){if(!t.oobCode)throw new C("invalid-action-code")}(t=Us.prototype).Cb=function(t,e){var n={idToken:t},r=[];return lt(oa,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),$a(this,Da,n)},t.ub=function(t,e){return pt(t={requestType:"PASSWORD_RESET",email:t},e),$a(this,Ta,t)},t.vb=function(t,e){return pt(t={requestType:"EMAIL_SIGNIN",email:t},e),$a(this,Sa,t)},t.tb=function(t,e){return pt(t={requestType:"VERIFY_EMAIL",idToken:t},e),$a(this,Ia,t)},t.Db=function(t,e,n){return pt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),$a(this,ka,t)},t.eb=function(t){return $a(this,Wa,t)},t.mb=function(t,e){return $a(this,Oa,{oobCode:t,newPassword:e})},t.Qa=function(t){return $a(this,ma,{oobCode:t})},t.ib=function(t){return $a(this,pa,{oobCode:t})};var pa={endpoint:"setAccountInfo",B:fa,Z:"email",C:!0},ma={endpoint:"resetPassword",B:fa,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new C("internal-error")},C:!0},ga={endpoint:"signupNewUser",B:function(t){if(ea(t),!t.password)throw new C("weak-password")},F:ra,U:!0,C:!0},va={endpoint:"createAuthUri",C:!0},ya={endpoint:"deleteAccount",M:["idToken"]},ba={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if("array"!=l(t.deleteProvider))throw new C("internal-error")}},wa={endpoint:"emailLinkSignin",M:["email","oobCode"],B:ea,F:ra,U:!0,C:!0},_a={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:ea,F:ra,U:!0},xa={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:sa,F:ra,C:!0,Na:!0},Ca={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:sa,F:ra,C:!0,Na:!0},Ea={endpoint:"getAccountInfo"},Sa={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new C("internal-error");ea(t)},Z:"email",C:!0},Ia={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},ka={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},Ta={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new C("internal-error");ea(t)},Z:"email",C:!0},Aa={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Ra={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new C("internal-error")}},Oa={endpoint:"resetPassword",B:fa,Z:"email",C:!0},Na={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},Da={endpoint:"setAccountInfo",M:["idToken"],B:na,U:!0},Pa={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(na(t),!t.password)throw new C("weak-password")},F:ra,U:!0},Ma={endpoint:"signupNewUser",F:ra,U:!0,C:!0},Fa={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new C("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},La={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},Ba={endpoint:"verifyAssertion",B:aa,Xa:ua,F:ca,U:!0,C:!0},ja={endpoint:"verifyAssertion",B:aa,Xa:ua,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new C("user-not-found");if(t.errorMessage)throw Ka(t.errorMessage);ra(t)},U:!0,C:!0},Va={endpoint:"verifyAssertion",B:function(t){if(aa(t),!t.idToken)throw new C("internal-error")},Xa:ua,F:ca,U:!0},Ua={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new C("invalid-custom-token")},F:ra,U:!0,C:!0},za={endpoint:"verifyPassword",B:function(t){if(ea(t),!t.password)throw new C("wrong-password")},F:ra,U:!0,C:!0},Wa={endpoint:"verifyPhoneNumber",B:ia,F:ra,C:!0},qa={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new C("internal-error");ia(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Uo(t);ra(t)}},Ha={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:ia,F:ra,C:!0},Ga={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Ws]^!!t.refreshToken)throw new C("internal-error")},C:!0,Na:!0};function $a(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return Se(new C("internal-error"));var r,i=!!e.Na,o=e.Tb||"POST";return Ee(n).then(e.B).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,s){var a=Mn(e+n);Dn(a,"key",t.c),s&&Dn(a,"cb",_().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Dn(a,c,i[c]);return new ve((function(e,n){Js(t,a.toString(),(function(t){t?t.error?n(Xa(t,o||{})):e(t):n(new C("network-request-failed"))}),r,u?void 0:Zn(Rr(i)),t.a,t.m.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Gb,e.kb||!1)})).then((function(t){return r=t,e.Xa?e.Xa(n,r):r})).then(e.F).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new C("internal-error");return r[e.Z]}))}function Ka(t){return Xa({error:{errors:[{message:t}],code:400,message:t}})}function Xa(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",pt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],e);return!e&&t&&(e=Ar(t)),new C("internal-error",e)}function Ya(t){this.b=t,this.a=null,this.qb=function(t){return(tu||(tu=new ve((function(t,e){function n(){Pr(),Cr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Pr(),e(Error("Network Error"))},timeout:Ja.get()})}if(Cr("gapi.iframes.Iframe"))t();else if(Cr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Cr("gapi.load")?n():e(Error("Network Error"))},Ee(Ps(r=Ct(Qa,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw tu=null,t})))).then((function(){return new ve((function(e,n){Cr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),Za.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var Qa=new gt(bt,"https://apis.google.com/js/api.js?onload=%{onload}"),Ja=new Mr(3e4,6e4),Za=new Mr(5e3,15e3),tu=null;function eu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Fn((t=Mn(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):Fn("https",this.l,null,"/__/auth/iframe"),this.a=t,Dn(this.a,"apiKey",this.h),Dn(this.a,"appName",this.i),this.b=null,this.c=[]}function nu(t,e,n,r,i,o){this.u=t,this.o=e,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function ru(t){try{return u2.a.app(t).auth().Ga()}catch(e){return[]}}function iu(t,e,n,r,i,o){this.o=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function ou(t){var e=or();return function(t){return $a(t,Aa,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Mn(e),r=n.f;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=Mn(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:lr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new jo(or())}))}function su(t){return t.v?t.v:(t.v=dr().then((function(){if(!t.u){var e=t.c,n=t.i,r=ru(t.b),i=new eu(t.o,t.g,t.b,t.f);i.f=e,i.b=n,i.c=X(r||[]),t.u=i.toString()}t.m=new Ya(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then((function(){t.a.register("authEvent",e,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.m,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Mo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ee(n)}return n.status="ERROR",Ee(n)}))}(t)})),t.v)}function au(t){return t.l||(t.A=t.c?_r(t.c,ru(t.b)):null,t.l=new Us(t.g,A(t.i),t.A),t.f&&Xs(t.l,t.f)),t.l}function uu(t,e,n,r,i,o,s,a,u,c,l,h){return(t=new nu(t,e,n,r,i,h)).l=o,t.g=s,t.i=a,t.b=dt(u||null),t.f=c,t.xb(l).toString()}function cu(t){if(this.a=t||u2.a.INTERNAL.reactNative&&u2.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function lu(t){this.b=t,this.a={},this.f=b(this.c,this)}eu.prototype.toString=function(){return this.f?Dn(this.a,"v",this.f):Kn(this.a.b,"v"),this.b?Dn(this.a,"eid",this.b):Kn(this.a.b,"eid"),this.c.length?Dn(this.a,"fw",this.c.join(",")):Kn(this.a.b,"fw"),this.a.toString()},nu.prototype.xb=function(t){return this.h=t,this},nu.prototype.toString=function(){if(this.m){var t=Mn(this.m.url);t=Fn(t.f,t.a,t.g,"/emulator/auth/handler")}else t=Fn("https",this.u,null,"/__/auth/handler");if(Dn(t,"apiKey",this.o),Dn(t,"appName",this.c),Dn(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var n=u2.a.app(this.c).auth().ka()}catch(a){n=null}for(var r in e.nb=n,Dn(t,"providerId",this.a.providerId),e=Rr((n=this.a).Hb))e[r]=e[r].toString();r=n.Pc,e=dt(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.ob&&n.nb&&!e[n.ob]&&(e[n.ob]=n.nb),ht(e)||Dn(t,"customParameters",Ar(e))}if("function"==typeof this.a.Pb&&(n=this.a.Pb()).length&&Dn(t,"scopes",n.join(",")),this.l?Dn(t,"redirectUrl",this.l):Kn(t.b,"redirectUrl"),this.g?Dn(t,"eventId",this.g):Kn(t.b,"eventId"),this.i?Dn(t,"v",this.i):Kn(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Pn(t,s)&&Dn(t,s,this.b[s]);return this.h?Dn(t,"tid",this.h):Kn(t.b,"tid"),this.f?Dn(t,"eid",this.f):Kn(t.b,"eid"),(s=ru(this.c)).length&&Dn(t,"fw",s.join(",")),t.toString()},(t=iu.prototype).Nb=function(t,e,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),o=this,s=!1;return this.la().then((function(){(function(t){var e={type:"webStorageSupport"};return su(t).then((function(){return function(t,e){return t.qb.then((function(){return new ve((function(n){t.a.send(e.type,e,n,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.m,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&ur(t),e(i),s=!0)}))})).s((function(){})).then((function(){if(!s)return function(t){return new ve((function(e){return function n(){xn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!s)return xn(n).then((function(){e(r)}))}))},t.Wb=function(){var t=xr();return!Tr(t)&&!Dr(t)},t.Sb=function(){return!1},t.Lb=function(t,e,n,r,i,o,s,a){if(!t)return Se(new C("popup-blocked"));if(s&&!Tr())return this.la().s((function(e){ur(t),i(e)})),r(),Ee();this.a||(this.a=ou(au(this)));var u=this;return this.a.then((function(){var e=u.la().s((function(e){throw ur(t),i(e),e}));return r(),e})).then((function(){Do(n),s||sr(uu(u.o,u.g,u.b,e,n,null,o,u.c,void 0,u.i,a,u.f),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Mb=function(t,e,n,r){this.a||(this.a=ou(au(this)));var i=this;return this.a.then((function(){Do(e),sr(uu(i.o,i.g,i.b,t,e,or(),n,i.c,void 0,i.i,r,i.f))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.la=function(){var t=this;return su(this).then((function(){return t.m.qb})).s((function(){throw t.a=null,new C("network-request-failed")}))},t.Zb=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ra=function(t){$(this.h,(function(e){return e==t}))},(t=cu.prototype).get=function(t){return Ee(this.a.getItem(t)).then((function(t){return t&&Or(t)}))},t.set=function(t,e){return Ee(this.a.setItem(t,Ar(e)))},t.T=function(t){return Ee(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var hu,du=[];function fu(t,e,n){ht(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function pu(t){this.a=t}function mu(t){this.c=t,this.b=!1,this.a=[]}function gu(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return Se(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new ve((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),s=setTimeout((function(){r(Error("unsupported_event"))}),l),t.a.push(c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return vu(t,c),e})).s((function(e){throw vu(t,c),e}))}function vu(t,e){if(e){var n=e.messageChannel;n&&(n.port1.removeEventListener("message",e.onMessage),n.port1.close()),$(t.a,(function(t){return t==e}))}}function yu(){if(!wu())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=s.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;mr()&&self?(this.l=function(){var t=mr()?self:null;if(U(du,(function(n){n.b==t&&(e=n)})),!e){var e=new lu(t);du.push(e)}return e}(),fu(this.l,"keyChanged",(function(e,n){return Su(t).then((function(e){return 0<e.length&&U(t.a,(function(t){t(e)})),{keyProcessed:H(e,n.key)}}))})),fu(this.l,"ping",(function(){return Ee(["keyChanged"])}))):function(){var t=s.navigator;return t&&t.serviceWorker?Ee().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):Ee(null)}().then((function(e){(t.h=e)&&(t.g=new mu(new pu(e)),gu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&H(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function bu(t){return t.v||(t.v=function t(e){return new ve((function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){r(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new ve((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(e).then((function(){return t(e)})).then((function(t){n(t)})).s((function(t){r(t)}))}}))}(t)),t.v}function wu(){try{return!!s.indexedDB}catch(Wt){return!1}}function _u(t){return t.objectStore("firebaseLocalStorage")}function xu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Cu(t){return new ve((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Eu(t,e){return t.g&&t.h&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?gu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):Ee()}function Su(t){return bu(t).then((function(t){var e=_u(xu(t,!1));return e.getAll?Cu(e.getAll()):new ve((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Iu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ku(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ee().then((function(){if(wu()){var t=Nr(),r="__sak"+t;return hu||(hu=new yu),(n=hu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){U(e.a,(function(e){e(t)}))})),t}))}function Tu(){this.a={},this.type="inMemory"}function Au(){if(!function(){var t="Node"==gr();if(!(t=Ru()||t&&u2.a.INTERNAL.node&&u2.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gr())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Ru()||u2.a.INTERNAL.node.localStorage,this.type="localStorage"}function Ru(){try{var t=s.localStorage,e=Nr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ou(){this.type="nullStorage"}function Nu(){if(!function(){var t="Node"==gr();if(!(t=Du()||t&&u2.a.INTERNAL.node&&u2.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gr())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Du()||u2.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Du(){try{var t=s.sessionStorage,e=Nr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Pu(){var t={};t.Browser=Lu,t.Node=Bu,t.ReactNative=ju,t.Worker=Vu,this.a=t[gr()]}lu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];U(r,(function(e){i.push(Ee().then((function(){return e(t.origin,t.data.data)})))})),ke(i).then((function(r){var i=[];U(r,(function(t){i.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})})),U(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},pu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},mu.prototype.close=function(){for(;0<this.a.length;)vu(this,this.a[0]);this.b=!0},(t=yu.prototype).set=function(t,e){var n,r=!1,i=this;return bu(this).then((function(e){return Cu((e=_u(xu(n=e,!0))).get(t))})).then((function(o){var s=_u(xu(n,!0));return o?(o.value=e,Cu(s.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Cu(s.add(o)))})).then((function(){return i.c[t]=e,Eu(i,t)})).na((function(){r&&i.b--}))},t.get=function(t){return bu(this).then((function(e){return Cu(_u(xu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.T=function(t){var e=!1,n=this;return bu(this).then((function(r){return e=!0,n.b++,Cu(_u(xu(r,!0)).delete(t))})).then((function(){return delete n.c[t],Eu(n,t)})).na((function(){e&&n.b--}))},t.ca=function(t){0==this.a.length&&function(t){Iu(t),function e(){t.f=setTimeout((function(){t.i=Su(t).then((function(e){0<e.length&&U(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t})),0==this.a.length&&Iu(this)},(t=ku.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.T=function(t){return this.b.then((function(e){return e.T(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t}))},(t=Tu.prototype).get=function(t){return Ee(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ee()},t.T=function(t){return delete this.a[t],Ee()},t.ca=function(){},t.ia=function(){},(t=Au.prototype).get=function(t){var e=this;return Ee().then((function(){return Or(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ee().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return Ee().then((function(){e.a.removeItem(t)}))},t.ca=function(t){s.window&&on(s.window,"storage",t)},t.ia=function(t){s.window&&un(s.window,"storage",t)},(t=Ou.prototype).get=function(){return Ee(null)},t.set=function(){return Ee()},t.T=function(){return Ee()},t.ca=function(){},t.ia=function(){},(t=Nu.prototype).get=function(t){var e=this;return Ee().then((function(){return Or(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ee().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return Ee().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Mu,Fu,Lu={D:Au,ab:Nu},Bu={D:Au,ab:Nu},ju={D:cu,ab:Ou},Vu={D:Au,ab:Ou},Uu={qd:"local",NONE:"none",sd:"session"};function zu(){var t=!(Dr(xr())||!pr()),e=Tr(),n=Er();this.v=t,this.h=e,this.l=n,this.a={},Mu||(Mu=new Pu),t=Mu;try{this.g=!ir()&&jr()||!s.indexedDB?new t.a.D:new ku(mr()?new Tu:new t.a.D)}catch(r){this.g=new Tu,this.h=!0}try{this.i=new t.a.ab}catch(r){this.i=new Tu}this.m=new Tu,this.f=b(this.Xb,this),this.b={}}function Wu(){return Fu||(Fu=new zu),Fu}function qu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function Hu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Gu(t,e,n){return n=Hu(e,n),"local"==e.D&&(t.b[n]=null),qu(t,e.D).T(n)}function $u(t){t.c&&(clearInterval(t.c),t.c=null)}function Ku(t){this.a=t,this.b=Wu()}(t=zu.prototype).get=function(t,e){return qu(this,t.D).get(Hu(t,e))},t.set=function(t,e,n){var r=Hu(t,n),i=this,o=qu(this,t.D);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.D&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=Hu(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),ht(this.a)&&(qu(this,"local").ca(this.f),this.h||(ir()||!jr())&&s.indexedDB||!this.l||function(t){$u(t),t.c=setInterval((function(){for(var e in t.a){var n=s.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new $e({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Xb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Hu(t,e),this.a[t]&&($(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),ht(this.a)&&(qu(this,"local").ia(this.f),$u(this))},t.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?qu(this,"local").ia(this.f):$u(this),this.v)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.lb(e))},Ht&&te&&10==te&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else U(t,b(this.lb,this))},t.lb=function(t){this.a[t]&&U(this.a[t],(function(t){t()}))};var Xu,Yu={name:"authEvent",D:"local"};function Qu(){this.a=Wu()}function Ju(t,e){this.b=Zu,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===Xu&&(Xu=s.Int32Array?new Int32Array(sc):sc),this.reset()}x(Ju,(function(){this.b=-1}));for(var Zu=64,tc=Zu-1,ec=[],nc=0;nc<tc;nc++)ec[nc]=0;var rc=K(128,ec);function ic(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){var o=(0|n[e-16])+(((i=0|n[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+(((r=0|n[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var d=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&l^~c&h)+(0|Xu[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+s|0,u=a,a=i,i=r,r=s+d|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function oc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(ic(t),i=0);else{if(!h(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(ic(t),i=0)}}t.c=i,t.g+=n}Ju.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):X(this.h)};var sc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ac(){Ju.call(this,8,uc)}x(ac,Ju);var uc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function cc(t,e,n,r,i,o){this.m=t,this.i=e,this.l=n,this.v=r||null,this.u=i||null,this.o=o,this.h=e+":"+n,this.A=new Qu,this.g=new Ku(this.h),this.f=null,this.b=[],this.a=this.c=null}function lc(t){return new C("invalid-cordova-configuration",t)}function hc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function dc(t){return t.f||(t.f=t.la().then((function(){return new ve((function(e){t.Ea((function n(r){return e(r),t.Ra(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),fc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Ji(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Or(Pn(o=Mn(i),"firebaseError")||null))?E(o):null)?new Po(r.c,r.b,null,null,o,null,r.S()):new Po(r.c,r.b,i,r.f,null,null,r.S())),i=o||n}hc(t,i)}))}var n=new Po("unknown",null,null,null,new C("no-auth-event")),r=!1,i=xn(500).then((function(){return fc(t).then((function(){r||hc(t,n)}))})),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Cr("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Bo||(Bo=new Fo),function(t){var e=Bo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Cr("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)}))}))),t.f}function fc(t){var e=null;return function(t){return t.b.get(Yu,t.a).then((function(t){return Mo(t)}))}(t.g).then((function(n){return e=n,Gu((n=t.g).b,Yu,n.a)})).then((function(){return e}))}function pc(t){this.a=t,this.b=Wu()}(t=cc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(fr(void 0)?dr().then((function(){return new ve((function(t,e){var n=s.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Se(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Cr("universalLinks.subscribe",s))throw lc("cordova-universal-links-plugin-fix is not installed");if(void 0===Cr("BuildInfo.packageName",s))throw lc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Cr("cordova.plugins.browsertab.openUrl",s))throw lc("cordova-plugin-browsertab is not installed");if("function"!=typeof Cr("cordova.InAppBrowser.open",s))throw lc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},t.Nb=function(t,e){return e(new C("operation-not-supported-in-this-environment")),Ee()},t.Lb=function(){return Se(new C("operation-not-supported-in-this-environment"))},t.Zb=function(){return!1},t.Wb=function(){return!0},t.Sb=function(){return!0},t.Mb=function(t,e,n,r){if(this.c)return Se(new C("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,l=null;return this.c=Ee().then((function(){return Do(e),dc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Po(e,r,null,o,new C("no-auth-event"),null,i),u=Cr("BuildInfo.packageName",s);if("string"!=typeof u)throw new C("invalid-cordova-configuration");var c=Cr("BuildInfo.displayName",s),l={};if(xr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!xr().toLowerCase().match(/android/))return Se(new C("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=function(t){var e=new ac;oc(e,t),t=[];var n=8*e.g;oc(e,rc,56>e.c?56-e.c:e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(ic(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return W(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=uu(t.m,t.i,t.l,e,n,null,r,t.v,l,t.u,i,t.o);return t.la().then((function(){var e=t.h;return t.A.a.set(Yu,a.w(),e)})).then((function(){var e=Cr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new C("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Cr("cordova.plugins.browsertab.openUrl",s)))throw new C("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Cr("cordova.InAppBrowser.open",s)))throw new C("invalid-cordova-configuration");e=xr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new ve((function(t,e){u=function(){var e=Cr("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),l=function(){Fr()&&c()},o.addEventListener("resume",c=function(){a||(a=xn(2e3).then((function(){e(new C("redirect-cancelled-by-user"))})))},!1),xr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).s((function(t){return fc(i).then((function(){throw t}))}))})).na((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),u&&i.Ra(u),i.c=null}))},t.Ea=function(t){this.b.push(t),dc(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Po("unknown",null,null,null,new C("no-auth-event")),t(e))}))},t.Ra=function(t){$(this.b,(function(e){return e==t}))};var mc={name:"pendingRedirect",D:"session"};function gc(t){return Gu(t.b,mc,t.a)}function vc(t,e,n,r){this.i={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=b(this.o,this),this.b=new Nc,this.A=new Lc,this.g=new pc(Rc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=yc(this.O,this.m,this.v,S,this.G)}function yc(t,e,n,r,i){var o=u2.a.SDK_VERSION||null;return fr()?new cc(t,e,n,o,r,i):new iu(t,e,n,o,r,i)}function bc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().s((function(n){throw t.a==e&&t.reset(),n}))}function wc(t){t.a.Wb()&&bc(t).s((function(e){var n=new Po("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Ic(e)&&t.o(n)})),t.a.Sb()||Dc(t.b)}function _c(t,e){H(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(mc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?gc(t.g).then((function(){bc(t).s((function(e){var n=new Po("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Ic(e)&&t.o(n)}))})):wc(t)})).s((function(){wc(t)}))}function xc(t,e){$(t.h,(function(t){return t==e}))}vc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=yc(this.O,this.m,this.v,null,this.G),this.i={}},vc.prototype.o=function(t){if(!t)throw new C("invalid-auth-event");if(6e5<=_()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=_())),e=!0;break}}return Dc(this.b),e};var Cc=new Mr(2e3,1e4),Ec=new Mr(3e4,6e4);function Sc(t,e,n,r,i,o,s){return t.a.Lb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,s)}function Ic(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function kc(t,e,n,r,i){var o;return function(t){return t.b.set(mc,"pending",t.a)}(t.g).then((function(){return t.a.Mb(e,n,r,i).s((function(e){if(Ic(e))throw new C("operation-not-supported-in-this-environment");return o=e,gc(t.g).then((function(){throw o}))})).then((function(){return t.a.Zb()?new ve((function(){})):gc(t.g).then((function(){return t.qa()})).then((function(){})).s((function(){}))}))}))}function Tc(t,e,n,r,i){return t.a.Nb(r,(function(t){e.ma(n,null,t,i)}),Cc.get())}vc.prototype.qa=function(){return this.b.qa()};var Ac={};function Rc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Oc(t,e,n,r){var i=Rc(e,n,r);return Ac[i]||(Ac[i]=new vc(t,e,n,r)),Ac[i]}function Nc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Dc(t){t.g||(t.g=!0,Fc(t,!1,null,null))}function Pc(t){t.g&&!t.i&&Fc(t,!1,null,null)}function Mc(t,e){if(t.b=function(){return Ee(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Fc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Se(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Mc(t,n):Mc(t,{user:null}),t.f=[],t.c=[]}function Lc(){}function Bc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function jc(t,e){this.a=e,qr(this,"verificationId",t)}function Vc(t,e,n,r){return new Ro(t).eb(e,n).then((function(t){return new jc(t,r)}))}function Uc(t){var e=Bi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Hr(this,{token:t,expirationTime:Br(1e3*e.exp),authTime:Br(1e3*e.auth_time),issuedAtTime:Br(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function zc(t,e,n){var r=e&&e[qc];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=dt(e),this.g=n,this.c=new Zi(null,r),this.b=[];var i=this;U(e[Wc]||[],(function(t){(t=Xr(t))&&i.b.push(t)})),qr(this,"auth",this.a),qr(this,"session",this.c),qr(this,"hints",this.b)}Nc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Nc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Fc(this,!0,null,t.a),Ee()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,s=e.S(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then((function(e){Fc(t,a,e,null)})).s((function(e){Fc(t,a,null,e)}))}(this,t,e):Se(new C("invalid-auth-event")):(Fc(this,!1,null,null),Ee())}else Se(new C("invalid-auth-event"))},Nc.prototype.qa=function(){var t=this;return new ve((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new C("timeout");t.a&&t.a.cancel(),t.a=xn(Ec.get()).then((function(){t.b||(t.g=!0,Fc(t,!0,null,e))}))}(t))}))},Lc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ma(t.c,null,t.a,t.b),Ee()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.S(),t.i).then((function(t){e.ma(r,t,null,n)})).s((function(t){e.ma(r,null,t,n)}))}(t,e):Se(new C("invalid-auth-event"))}else Se(new C("invalid-auth-event"))},jc.prototype.confirm=function(t){return t=Oo(this.verificationId,t),this.a(t)};var Wc="mfaInfo",qc="mfaPendingCredential";function Hc(t,e,n,r){C.call(this,"multi-factor-auth-required",r,e),this.b=new zc(t,e,n),qr(this,"resolver",this.b)}function Gc(t,e,n){if(t&&f(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Hc(e,t.serverResponse,n,t.message)}catch(r){}return null}function $c(){}function Kc(t){qr(this,"factorId",t.fa),this.a=t}function Xc(t){if(Kc.call(this,t),this.a.fa!=Ro.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Yc(t,e){for(var n in Ge.call(this,t),e)this[n]=e[n]}function Qc(t,e){this.a=t,this.b=[],this.c=b(this.xc,this),on(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&U(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[Jr]=t.uid),t.displayName&&(r[Yr]=t.displayName),t.enrollmentTime&&(r[Qr]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[Zr]=t.phoneNumber);try{e=new ti(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),Jc(this,n)}function Jc(t,e){t.b=e,qr(t,"enrolledFactors",e)}function Zc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function tl(t){this.c=t,this.b=this.a=null}function el(t){return t.b&&1e3*t.b.c||0}function nl(t,e){var n=e.refreshToken;t.b=Li(e[Ws]||""),t.a=n}function rl(t,e){this.a=t||null,this.b=e||null,Hr(this,{lastSignInTime:Br(e||null),creationTime:Br(t||null)})}function il(t,e,n,r,i,o){Hr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ol(t,e,n){this.G=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null;var r=u2.a.SDK_VERSION?_r(u2.a.SDK_VERSION):null;this.a=new Us(this.l,A(S),r),t.emulatorConfig&&Xs(this.a,t.emulatorConfig),this.b=new tl(this.a),fl(this,e[Ws]),nl(this.b,e),qr(this,"refreshToken",this.b.a),gl(this,n||{}),vn.call(this),this.P=!1,this.o&&Sr()&&(this.i=Oc(this.o,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new Zc((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=el(t.b)-_()-3e5;return 0<e?e:0}))}(this),this.$=b(this.gb,this);var i=this;this.pa=null,this.Ba=function(t){i.wa(t.h)},this.ba=null,this.za=function(t){Xs(i.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){ul(i,t.f)},this.aa=null,this.N=new Qc(this,n),qr(this,"multiFactor",this.N)}function sl(t,e){t.ba&&un(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&on(e,"languageCodeChanged",t.Ba)}function al(t,e){t.W&&un(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&on(e,"emulatorConfigChanged",t.za)}function ul(t,e){t.X=e,Qs(t.a,u2.a.SDK_VERSION?_r(u2.a.SDK_VERSION,t.X):null)}function cl(t,e){t.aa&&un(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&on(e,"frameworkChanged",t.Aa)}function ll(t){try{return u2.a.app(t.m).auth()}catch(e){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function hl(t){t.A||t.u.b||(t.u.start(),un(t,"tokenChanged",t.$),on(t,"tokenChanged",t.$))}function dl(t){un(t,"tokenChanged",t.$),t.u.stop()}function fl(t,e){t.ya=e,qr(t,"_lat",e)}function pl(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return ke(e).then((function(){return t}))}function ml(t){t.i&&!t.P&&(t.P=!0,_c(t.i,t))}function gl(t,e){Hr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new rl(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function vl(){}function yl(t){return Ee().then((function(){if(t.A)throw new C("app-deleted")}))}function bl(t){return W(t.providerData,(function(t){return t.providerId}))}function wl(t,e){e&&(_l(t,e.providerId),t.providerData.push(e))}function _l(t,e){$(t.providerData,(function(t){return t.providerId==e}))}function xl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&qr(t,e,n)}function Cl(t,e){t!=e&&(Hr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),qr(t,"metadata",e.metadata?function(t){return new rl(t.a,t.b)}(e.metadata):new rl),U(e.providerData,(function(e){wl(t,e)})),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),qr(t,"refreshToken",t.b.a),Jc(t.N,e.N.b))}function El(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return $a(t.a,Ea,{idToken:e}).then(b(t.Jc,t))}(t,e).then((function(){return n||xl(t,"isAnonymous",!1),e}))}))}function Sl(t,e){e[Ws]&&t.ya!=e[Ws]&&(nl(t.b,e),t.dispatchEvent(new Yc("tokenChanged")),fl(t,e[Ws]),xl(t,"refreshToken",t.b.a))}function Il(t,e){return El(t).then((function(){if(H(bl(t),e))return pl(t).then((function(){throw new C("provider-already-linked")}))}))}function kl(t,e,n){return Gr({user:t,credential:No(e),additionalUserInfo:e=Wi(e),operationType:n})}function Tl(t,e){return Sl(t,e),t.reload().then((function(){return t}))}function Al(t,e,n,r,i){if(!Sr())return Se(new C("operation-not-supported-in-this-environment"));if(t.f&&!i)return Se(t.f);var o=zi(n.providerId),s=Nr(t.uid+":::"),a=null;(!Tr()||pr())&&t.o&&n.isOAuthProvider&&(a=uu(t.o,t.l,t.m,e,n,null,s,u2.a.SDK_VERSION||null,null,null,t.tenantId));var u=cr(a,o&&o.ua,o&&o.ta);return r=r().then((function(){if(Ol(t),!i)return t.I().then((function(){}))})).then((function(){return Sc(t.i,u,e,n,s,!!a,t.tenantId)})).then((function(){return new ve((function(n,r){t.ma(e,null,new C("cancelled-popup-request"),t.h||null),t.g=n,t.O=r,t.h=s,t.c=Tc(t.i,t,e,u,s)}))})).then((function(t){return u&&ur(u),t?Gr(t):null})).s((function(t){throw u&&ur(u),t})),Nl(t,r,i)}function Rl(t,e,n,r,i){if(!Sr())return Se(new C("operation-not-supported-in-this-environment"));if(t.f&&!i)return Se(t.f);var o=null,s=Nr(t.uid+":::");return r=r().then((function(){if(Ol(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=s,pl(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Ml,t.w(),e.a)),e})).then((function(){return kc(t.i,e,n,s,t.tenantId)})).s((function(e){if(o=e,t.ha)return Fl(t.ha);throw o})).then((function(){if(o)throw o})),Nl(t,r,i)}function Ol(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function Nl(t,e,n){var r=function(t,e,n){return t.f&&!n?(e.cancel(),Se(t.f)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new Yc("userInvalidated")),t.f=e),e}))}(t,e,n);return t.G.push(r),r.na((function(){G(t.G,r)})),r.s((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Gc(e.w(),ll(t),b(t.ic,t))),n||e}))}function Dl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ws]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=new ol(e,n,t);return t.providerData&&U(t.providerData,(function(t){t&&wl(r,Gr(t))})),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Pl(t){this.a=t,this.b=Wu()}zc.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then((function(t){var n=dt(e.f);return delete n[Wc],delete n[qc],pt(n,t),e.g(n)}))},x(Hc,C),$c.prototype.rb=function(t,e,n){return e.type==to?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),pt(n,{phoneVerificationInfo:Ao(t.a)}),$a(e,xa,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return pt(n={mfaPendingCredential:n},{phoneVerificationInfo:Ao(t.a)}),$a(e,Ca,n)}))}(this,t,e)},x(Kc,$c),x(Xc,Kc),x(Yc,Ge),(t=Qc.prototype).xc=function(t){Jc(this,function(t){var e=[];return U(t.mfaInfo||[],(function(t){(t=Xr(t))&&e.push(t)})),e}(t.gd))},t.Qb=function(){return this.a.I().then((function(t){return new Zi(t,null)}))},t.ec=function(t,e){var n=this,r=this.a.a;return this.Qb().then((function(n){return t.rb(r,n,e)})).then((function(t){return Sl(n.a,t),n.a.reload()}))},t.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return $a(r,Ga,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return Jc(e,r),Sl(e.a,t),e.a.reload().s((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:W(this.b,(function(t){return t.w()}))}}},Zc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=xn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=s.document,e=null;return Fr()||!t?Ee():new ve((function(n){e=function(){Fr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},Zc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},tl.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:el(this)}},tl.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Se(new C("user-token-expired")):t||!this.b||_()>el(this)-3e4?this.a?function(t,e){return function(t,e){return new ve((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Js(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Xa(t)):t.access_token&&t.refresh_token?n(t):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",$n(e).toString(),t.g,t.v.get()):r(new C("internal-error"))}))}(t.c,e).then((function(e){return t.b=Li(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ee(null):Ee({accessToken:this.b.toString(),refreshToken:this.a})},rl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},x(ol,vn),ol.prototype.wa=function(t){this.pa=t,Ks(this.a,t)},ol.prototype.ka=function(){return this.pa},ol.prototype.Ga=function(){return X(this.X)},ol.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},qr(ol.prototype,"providerId","firebase"),(t=ol.prototype).reload=function(){var t=this;return Nl(this,yl(this).then((function(){return El(t).then((function(){return pl(t)})).then(vl)})))},t.nc=function(t){return this.I(t).then((function(t){return new Uc(t)}))},t.I=function(t){var e=this;return Nl(this,yl(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new C("internal-error");return t.accessToken!=e.ya&&(fl(e,t.accessToken),e.dispatchEvent(new Yc("tokenChanged"))),xl(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Jc=function(t){if(!(t=t.users)||!t.length)throw new C("internal-error");gl(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new il(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)wl(this,e[n]);xl(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new Yc("userReloaded",{gd:t}))},t.Kc=function(t){return zr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},t.sb=function(t){var e=this,n=null;return Nl(this,t.c(this.a,this.uid).then((function(t){return Sl(e,t),n=kl(e,t,"reauthenticate"),e.f=null,e.reload()})).then((function(){return n})),!0)},t.Bc=function(t){return zr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return Nl(this,Il(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=kl(e,t,"link"),Tl(e,t)})).then((function(){return n})))},t.Cc=function(t,e){var n=this;return Nl(this,Il(this,"phone").then((function(){return Vc(ll(n),t,e,b(n.pb,n))})))},t.Lc=function(t,e){var n=this;return Nl(this,Ee().then((function(){return Vc(ll(n),t,e,b(n.sb,n))})),!0)},t.Ab=function(t){var e=this;return Nl(this,this.I().then((function(n){return e.a.Ab(n,t)})).then((function(t){return Sl(e,t),e.reload()})))},t.dd=function(t){var e=this;return Nl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Sl(e,t),e.reload()})))},t.Bb=function(t){var e=this;return Nl(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Sl(e,t),e.reload()})))},t.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return yl(this);var e=this;return Nl(this,this.I().then((function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Sl(e,t),xl(e,"displayName",t.displayName||null),xl(e,"photoURL",t.photoUrl||null),U(e.providerData,(function(t){"password"===t.providerId&&(qr(t,"displayName",e.displayName),qr(t,"photoURL",e.photoURL))})),pl(e)})).then(vl))},t.bd=function(t){var e=this;return Nl(this,El(this).then((function(n){return H(bl(e),t)?function(t,e,n){return $a(t,ba,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return U(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),U(bl(e),(function(t){n[t]||_l(e,t)})),n[Ro.PROVIDER_ID]||qr(e,"phoneNumber",null),pl(e)})):pl(e).then((function(){throw new C("no-such-provider")}))})))},t.delete=function(){var t=this;return Nl(this,this.I().then((function(e){return $a(t.a,ya,{idToken:e})})).then((function(){t.dispatchEvent(new Yc("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");sl(t,null),al(t,null),cl(t,null),t.G=[],t.A=!0,dl(t),qr(t,"refreshToken",null),t.i&&xc(t.i,t)}))},t.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.h||null)==e&&this.g||"reauthViaPopup"==t&&(this.h||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.ma=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.h||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.h||null)?b(this.Jb,this):"reauthViaPopup"==t&&e==(this.h||null)?b(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?b(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?b(this.Kb,this):null},t.Dc=function(t){var e=this;return Al(this,"linkViaPopup",t,(function(){return Il(e,t.providerId).then((function(){return pl(e)}))}),!1)},t.Mc=function(t){return Al(this,"reauthViaPopup",t,(function(){return Ee()}),!0)},t.Ec=function(t){var e=this;return Rl(this,"linkViaRedirect",t,(function(){return Il(e,t.providerId)}),!1)},t.Nc=function(t){return Rl(this,"reauthViaRedirect",t,(function(){return Ee()}),!0)},t.Jb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Nl(this,this.I().then((function(n){return ha(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=kl(i,t,"link"),Tl(i,t)})).then((function(){return o})))},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Nl(this,Ee().then((function(){return ro(da(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=kl(i,t,"reauthenticate"),Sl(i,t),i.f=null,i.reload()})).then((function(){return o})),!0)},t.tb=function(t){var e=this,n=null;return Nl(this,this.I().then((function(e){return n=e,void 0===t||ht(t)?{}:Pi(new Ei(t))})).then((function(t){return e.a.tb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Db=function(t,e){var n=this,r=null;return Nl(this,this.I().then((function(t){return r=t,void 0===e||ht(e)?{}:Pi(new Ei(e))})).then((function(e){return n.a.Db(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.ic=function(t){var e=null,n=this;return Nl(this,t=ro(Ee(t),n.uid).then((function(t){return e=kl(n,t,"reauthenticate"),Sl(n,t),n.f=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&pt(t,this.metadata.w()),U(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),pt(t,this.N.w()),t};var Ml={name:"redirectUser",D:"session"};function Fl(t){return Gu(t.b,Ml,t.a)}function Ll(t){this.a=t,this.b=Wu(),this.c=null,this.f=function(t){var e=Vl("local"),n=Vl("session"),r=Vl("none");return function(t,e,n){var r=Hu(e,n),i=qu(t,e.D);return t.get(e,n).then((function(o){var a=null;try{a=Or(s.localStorage.getItem(r))}catch(u){}if(a&&!o)return s.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(jl,t.a).then((function(t){return t?Vl(t):e}))}))}))})).then((function(e){return t.c=e,Bl(t,e.D)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Vl("local"),this.a,b(this.g,this))}function Bl(t,e){var n,r=[];for(n in Uu)Uu[n]!==e&&r.push(Gu(t.b,Vl(Uu[n]),t.a));return r.push(Gu(t.b,jl,t.a)),function(t){return new ve((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},a=0;a<t.length;a++)Ie(t[a],w(o,a),s);else e(i)}))}(r)}Ll.prototype.g=function(){var t=this,e=Vl("local");ql(this,(function(){return Ee().then((function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null})).then((function(n){if(n)return Bl(t,"local").then((function(){t.c=e}))}))}))};var jl={name:"persistence",D:"session"};function Vl(t){return{name:"authUser",D:t}}function Ul(t,e){return ql(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function zl(t){return ql(t,(function(){return Gu(t.b,t.c,t.a)}))}function Wl(t,e,n){return ql(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Dl(t||{})}))}))}function ql(t,e){return t.f=t.f.then(e,e),t.f}function Hl(t){if(this.m=!1,qr(this,"settings",new Bc),qr(this,"app",t),!Zl(this).options||!Zl(this).options.apiKey)throw new C("invalid-api-key");t=u2.a.SDK_VERSION?_r(u2.a.SDK_VERSION):null,this.a=new Us(Zl(this).options&&Zl(this).options.apiKey,A(S),t),this.R=[],this.u=[],this.P=[],this.ac=u2.a.INTERNAL.createSubscribe(b(this.yc,this)),this.X=void 0,this.bc=u2.a.INTERNAL.createSubscribe(b(this.zc,this)),Ql(this,null),this.l=new Ll(Zl(this).options.apiKey+":"+Zl(this).name),this.G=new Pl(Zl(this).options.apiKey+":"+Zl(this).name),this.$=rh(this,function(t){var e=Zl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Ml,t.a).then((function(t){return t&&e&&(t.authDomain=e),Dl(t||{})}))}(t.G,Zl(t).options.authDomain).then((function(e){return(t.o=e)&&(e.ha=t.G),Fl(t.G)}));return rh(t,e)}(t).then((function(){return Wl(t.l,e,t.f)})).then((function(e){return e?(e.ha=t.G,t.o&&(t.o.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Ul(t.l,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:zl(t.l)}))):null})).then((function(e){Ql(t,e||null)}));return rh(t,n)}(this)),this.i=rh(this,function(t){return t.$.then((function(){return Yl(t)})).s((function(){})).then((function(){if(!t.m)return t.pa()})).s((function(){})).then((function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(Vl("local"),e.a,t.pa)}}))}(this)),this.ba=!1,this.pa=b(this.Yc,this),this.Ba=b(this.da,this),this.ya=b(this.kc,this),this.za=b(this.vc,this),this.Aa=b(this.wc,this),this.b=null,function(t){var e=Zl(t).options.authDomain,n=Zl(t).options.apiKey;e&&Sr()&&(t.gb=t.$.then((function(){if(!t.m){if(t.b=Oc(e,n,Zl(t).name,t.f),_c(t.b,t),th(t)&&ml(th(t)),t.o){ml(t.o);var r=t.o;r.wa(t.ka()),sl(r,t),ul(r=t.o,t.N),cl(r,t),Xs((r=t.o).a,t.f),al(r,t),t.o=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=b(this.delete,this),this.INTERNAL.logFramework=b(this.Fc,this),this.A=0,vn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function Gl(t){Ge.call(this,"languageCodeChanged"),this.h=t}function $l(t){Ge.call(this,"emulatorConfigChanged"),this.c=t}function Kl(t){Ge.call(this,"frameworkChanged"),this.f=t}function Xl(t){return t.gb||Se(new C("auth-domain-config-required"))}function Yl(t){if(!Sr())return Se(new C("operation-not-supported-in-this-environment"));var e=Xl(t).then((function(){return t.b.qa()})).then((function(t){return t?Gr(t):null}));return rh(t,e)}function Ql(t,e){th(t)&&(function(t,e){$(t.R,(function(t){return t==e}))}(th(t),t.Ba),un(th(t),"tokenChanged",t.ya),un(th(t),"userDeleted",t.za),un(th(t),"userInvalidated",t.Aa),dl(th(t))),e&&(e.R.push(t.Ba),on(e,"tokenChanged",t.ya),on(e,"userDeleted",t.za),on(e,"userInvalidated",t.Aa),0<t.A&&hl(e)),qr(t,"currentUser",e),e&&(e.wa(t.ka()),sl(e,t),ul(e,t.N),cl(e,t),Xs(e.a,t.f),al(e,t))}function Jl(t,e){var n=null,r=null;return rh(t,e.then((function(e){return n=No(e),r=Wi(e),function(t,e){var n={};return n.apiKey=Zl(t).options.apiKey,n.authDomain=Zl(t).options.authDomain,n.appName=Zl(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then((function(){return function(t,e,n,r){var i=new ol(t,e);return n&&(i.ha=n),r&&ul(i,r),i.reload().then((function(){return i}))}(n,e,t.G,t.Ga())})).then((function(e){return th(t)&&e.uid==th(t).uid?(Cl(th(t),e),t.da(e)):(Ql(t,e),ml(e),t.da(e))})).then((function(){nh(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Gc(e.w(),t,b(t.jc,t))),n||e})).then((function(){return Gr({user:th(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Zl(t){return t.app}function th(t){return t.currentUser}function eh(t){return th(t)&&th(t)._lat||null}function nh(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](eh(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](eh(t))}}function rh(t,e){return t.R.push(e),e.na((function(){G(t.R,e)})),e}function ih(){}function oh(){this.a={},this.b=1e12}Ll.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");t:{for(r in Uu)if(Uu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(gr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!wu()&&"none"!==t)throw n;break;default:if(!Er()&&"none"!==t)throw n}}(t),ql(this,(function(){return t!=n.c.D?n.b.get(n.c,n.a).then((function(r){return e=r,Bl(n,t)})).then((function(){if(n.c=Vl(t),e)return n.b.set(n.c,e,n.a)})):Ee()}))},x(Hl,vn),x(Gl,Ge),x($l,Ge),x(Kl,Ge),(t=Hl.prototype).wb=function(t){return rh(this,t=this.l.wb(t))},t.wa=function(t){this.aa===t||this.m||(this.aa=t,Ks(this.a,this.aa),this.dispatchEvent(new Gl(this.ka())))},t.ka=function(){return this.aa},t.ed=function(){var t=s.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.fd=function(t){if(!this.f){if(!/^https?:\/\//.test(t))throw new C("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Lr("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&dr().then((function(){var t=s.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),s.document.body.appendChild(t)})),this.f={url:t},this.settings.hb=!0,Xs(this.a,this.f),this.dispatchEvent(new $l(this.f))}},t.Fc=function(t){this.N.push(t),Qs(this.a,u2.a.SDK_VERSION?_r(u2.a.SDK_VERSION,this.N):null),this.dispatchEvent(new Kl(this.N))},t.Ga=function(){return X(this.N)},t.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},t.S=function(){return this.W},t.toJSON=function(){return{apiKey:Zl(this).options.apiKey,authDomain:Zl(this).options.authDomain,appName:Zl(this).name,currentUser:th(this)&&th(this).w()}},t.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==e&&!!this.g;default:return!1}},t.ma=function(t,e,n,r){"signInViaPopup"==t&&this.h==r&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.h==e&&this.g?b(this.hc,this):null},t.hc=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return Jl(i,la(i.a,o))}))},t.Wc=function(t){if(!Sr())return Se(new C("operation-not-supported-in-this-environment"));var e=this,n=zi(t.providerId),r=Nr(),i=null;(!Tr()||pr())&&Zl(this).options.authDomain&&t.isOAuthProvider&&(i=uu(Zl(this).options.authDomain,Zl(this).options.apiKey,Zl(this).name,"signInViaPopup",t,null,r,u2.a.SDK_VERSION||null,null,null,this.S(),this.f));var o=cr(i,n&&n.ua,n&&n.ta);return rh(this,n=Xl(this).then((function(n){return Sc(n,o,"signInViaPopup",t,r,!!i,e.S())})).then((function(){return new ve((function(t,n){e.ma("signInViaPopup",null,new C("cancelled-popup-request"),e.h),e.g=t,e.O=n,e.h=r,e.c=Tc(e.b,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&ur(o),t?Gr(t):null})).s((function(t){throw o&&ur(o),t})))},t.Xc=function(t){if(!Sr())return Se(new C("operation-not-supported-in-this-environment"));var e=this;return rh(this,Xl(this).then((function(){return function(t){return ql(t,(function(){return t.b.set(jl,t.c.D,t.a)}))}(e.l)})).then((function(){return kc(e.b,"signInViaRedirect",t,void 0,e.S())})))},t.qa=function(){var t=this;return Yl(this).then((function(e){return t.b&&Pc(t.b.b),e})).s((function(e){throw t.b&&Pc(t.b.b),e}))},t.cd=function(t){if(!t)return Se(new C("null-user"));if(this.W!=t.tenantId)return Se(new C("tenant-id-mismatch"));var e=this,n={};n.apiKey=Zl(this).options.apiKey,n.authDomain=Zl(this).options.authDomain,n.appName=Zl(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Ws]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ol(e||{apiKey:t.l,authDomain:t.o,appName:t.m},o),n&&(e.ha=n),r&&ul(e,r),Cl(e,t),e}(t,n,e.G,e.Ga());return rh(this,this.i.then((function(){if(Zl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return th(e)&&t.uid==th(e).uid?(Cl(th(e),t),e.da(t)):(Ql(e,r),ml(r),e.da(r))})).then((function(){nh(e)})))},t.zb=function(){var t=this;return rh(this,this.i.then((function(){return t.b&&Pc(t.b.b),th(t)?(Ql(t,null),zl(t.l).then((function(){nh(t)}))):Ee()})))},t.Yc=function(){var t=this;return Wl(this.l,Zl(this).options.authDomain).then((function(e){if(!t.m){var n;if(n=th(t)&&e){n=th(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Cl(th(t),e),th(t).I();(th(t)||e)&&(Ql(t,e),e&&(ml(e),e.ha=t.G),t.b&&_c(t.b,t),nh(t))}}))},t.da=function(t){return Ul(this.l,t)},t.kc=function(){nh(this),this.da(th(this))},t.vc=function(){this.zb()},t.wc=function(){this.zb()},t.jc=function(t){var e=this;return this.i.then((function(){return Jl(e,Ee(t))}))},t.yc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(th(e))}))},t.zc=function(t){var e=this;!function(t,e){t.P.push(e),rh(t,t.i.then((function(){!t.m&&H(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(eh(t)))})))}(this,(function(){t.next(th(e))}))},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(th(r)):"function"==typeof t.next&&t.next(th(r))})),this.ac(t,e,n)},t.Gc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(th(r)):"function"==typeof t.next&&t.next(th(r))})),this.bc(t,e,n)},t.mc=function(t){var e=this;return rh(this,this.i.then((function(){return th(e)?th(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Sc=function(t){var e=this;return this.i.then((function(){return Jl(e,$a(e.a,Ua,{token:t}))})).then((function(t){var n=t.user;return xl(n,"isAnonymous",!1),e.da(n),t}))},t.Tc=function(t,e){var n=this;return this.i.then((function(){return Jl(n,$a(n.a,za,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.i.then((function(){return Jl(n,$a(n.a,ga,{email:t,password:e}))}))},t.Za=function(t){var e=this;return this.i.then((function(){return Jl(e,t.ja(e.a))}))},t.Rc=function(t){return zr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},t.yb=function(){var t=this;return this.i.then((function(){var e=th(t);if(e&&e.isAnonymous){var n=Gr({providerId:null,isNewUser:!1});return Gr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Jl(t,t.a.yb()).then((function(e){var n=e.user;return xl(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return th(this)&&th(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&th(this)&&hl(th(this))},t.Oc=function(t){var e=this;U(this.u,(function(n){n==t&&e.A--})),0>this.A&&(this.A=0),0==this.A&&th(this)&&dl(th(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.u.push(t),rh(this,this.i.then((function(){e.m||H(e.u,t)&&t(eh(e))})))},t.removeAuthTokenListener=function(t){$(this.u,(function(e){return e==t}))},t.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(Vl("local"),t.a,this.pa),this.b&&(xc(this.b,this),Pc(this.b.b)),Promise.resolve()},t.gc=function(t){return rh(this,function(t,e){return $a(t,va,{identifier:e,continueUri:Ir()?or():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Ac=function(t){return!!Io(t)},t.vb=function(t,e){var n=this;return rh(this,Ee().then((function(){var t=new Ei(e);if(!t.c)throw new C("argument-error",ki+" must be true when sending sign in link to email");return Pi(t)})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.hd=function(t){return this.Qa(t).then((function(t){return t.data.email}))},t.mb=function(t,e){return rh(this,this.a.mb(t,e).then((function(){})))},t.Qa=function(t){return rh(this,this.a.Qa(t).then((function(t){return new ei(t)})))},t.ib=function(t){return rh(this,this.a.ib(t).then((function(){})))},t.ub=function(t,e){var n=this;return rh(this,Ee().then((function(){return void 0===e||ht(e)?{}:Pi(new Ei(e))})).then((function(e){return n.a.ub(t,e)})).then((function(){})))},t.Vc=function(t,e){return rh(this,Vc(this,t,e,b(this.Za,this)))},t.Uc=function(t,e){var n=this;return rh(this,Ee().then((function(){var r=e||or(),i=So(t,r);if(!(r=Io(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new C("tenant-id-mismatch");return n.Za(i)})))},ih.prototype.render=function(){},ih.prototype.reset=function(){},ih.prototype.getResponse=function(){},ih.prototype.execute=function(){};var sh=null;function ah(t,e){return(e=uh(e))&&t.a[e]||null}function uh(t){return(t=void 0===t?1e12:t)?t.toString():null}function ch(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ie(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():on(this.f,"click",this.i)}function lh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function hh(){}function dh(){}oh.prototype.render=function(t,e){return this.a[this.b.toString()]=new ch(t,e),this.b++},oh.prototype.reset=function(t){var e=ah(this,t);t=uh(t),e&&t&&(e.delete(),delete this.a[t])},oh.prototype.getResponse=function(t){return(t=ah(this,t))?t.getResponse():null},oh.prototype.execute=function(t){(t=ah(this,t))&&t.execute()},ch.prototype.getResponse=function(){return lh(this),this.b},ch.prototype.execute=function(){lh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},ch.prototype.delete=function(){lh(this),this.g=!0,clearTimeout(this.a),this.a=null,un(this.f,"click",this.i)},qr(hh,"FACTOR_ID","phone"),dh.prototype.g=function(){return sh||(sh=new oh),Ee(sh)},dh.prototype.c=function(){};var fh=null;function ph(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var mh=new gt(bt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),gh=new Mr(3e4,6e4);ph.prototype.g=function(t){var e=this;return new ve((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),gh.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete s[e.a]},Ee(Ps(Ct(mh,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(s.grecaptcha))}))},ph.prototype.c=function(){this.b--};var vh=null;function yh(t,e,n,r,i,o,a){if(qr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,a?(fh||(fh=new dh),a=fh):(vh||(vh=new ph),a=vh),this.v=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[_h])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[xh],!s.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ie(e)||!this.i&&ie(e).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Us(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[bh];this.a[bh]=function(t){if(Ch(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Cr(c,s);"function"==typeof e&&e(t)}};var l=this.a[wh];this.a[wh]=function(){if(Ch(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=Cr(l,s);"function"==typeof t&&t()}}}var bh="callback",wh="expired-callback",_h="sitekey",xh="size";function Ch(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Eh(t,e){return t.h.push(e),e.na((function(){G(t.h,e)})),e}function Sh(t){if(t.A)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ih(t,e,n){var r=!1;try{this.b=n||u2.a.app()}catch(s){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(s){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}o=u2.a.SDK_VERSION?_r(u2.a.SDK_VERSION,o):null,yh.call(this,n,t,e,(function(){try{var t=i.b.auth().ka()}catch(e){t=null}return t}),o,A(S),r)}function kh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!o){if(e=e[i],0>i||i>=Th.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=Th[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new C("argument-error",t+" failed: "+r)}(t=yh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Eh(this,Ee().then((function(){if(Ir()&&!mr())return dr();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.v.g(t.u())})).then((function(e){return t.g=e,$a(t.o,Ra,{})})).then((function(e){t.a[_h]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},t.render=function(){Sh(this);var t=this;return Eh(this,this.Ia().then((function(){if(null===t.c){var e=t.m;if(!t.i){var n=ie(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!re&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Vt(s.name),'"'),s.type){o.push(' type="',Vt(s.type),'"');var a={};pt(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=le(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):oe(o,s)),2<r.length&&ce(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Sh(this);var t=this;return Eh(this,this.render().then((function(e){return new ve((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){$(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Sh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Sh(this),this.A=!0,this.v.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ie(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},x(Ih,yh);var Th="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ah(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Rh(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Oh(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:f}}function Nh(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function Dh(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Ph(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){return!!e&&!(!e.ja||t&&e.providerId!==t)}}}function Mh(t,e){return f(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Fh(t){return f(t)&&"string"==typeof t.uid}function Lh(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function Bh(t,e){for(var n in e){var r=e[n].name;t[r]=Uh(r,t[n],e[n].j)}}function jh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:w((function(t){return this[t]}),n),set:w((function(t,e,n,r){kh(t,[n],[r],!0),this[e]=r}),r,n,e[n].jb),enumerable:!0})}}function Vh(t,e,n,r){t[e]=Uh(e,n,r)}function Uh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return kh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Bh(Hl.prototype,{ib:{name:"applyActionCode",j:[Ah("code")]},Qa:{name:"checkActionCode",j:[Ah("code")]},mb:{name:"confirmPasswordReset",j:[Ah("code"),Ah("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ah("email"),Ah("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Ah("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Ah("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Lh(Oh(),Nh(),"nextOrObserver"),Nh("opt_error",!0),Nh("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Lh(Oh(),Nh(),"nextOrObserver"),Nh("opt_error",!0),Nh("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Ah("email"),Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Ah("email"),Oh("actionCodeSettings")]},wb:{name:"setPersistence",j:[Ah("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Ph()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Ph()]},Sc:{name:"signInWithCustomToken",j:[Ah("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Ah("email"),Ah("password")]},Uc:{name:"signInWithEmailLink",j:[Ah("email"),Ah("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[Lh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ol)}},Dh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ah(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Ah("url")]},hd:{name:"verifyPasswordResetCode",j:[Ah("code")]}}),jh(Hl.prototype,{lc:{name:"languageCode",jb:Lh(Ah(),Dh(),"languageCode")},ti:{name:"tenantId",jb:Lh(Ah(),Dh(),"tenantId")}}),(Hl.Persistence=Uu).LOCAL="local",Hl.Persistence.SESSION="session",Hl.Persistence.NONE="none",Bh(ol.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Rh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Rh("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Ph()]},pb:{name:"linkWithCredential",j:[Ph()]},Cc:{name:"linkWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Ph()]},sb:{name:"reauthenticateWithCredential",j:[Ph()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ah(null,!0)]},bd:{name:"unlink",j:[Ah("provider")]},Ab:{name:"updateEmail",j:[Ah("email")]},Bb:{name:"updatePassword",j:[Ah("password")]},dd:{name:"updatePhoneNumber",j:[Ph("phone")]},Cb:{name:"updateProfile",j:[Oh("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Ah("email"),Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]}}),Bh(oh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(ih.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(ve.prototype,{na:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),jh(Bc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Rh("appVerificationDisabledForTesting")}}),Bh(jc.prototype,{confirm:{name:"confirm",j:[Ah("verificationCode")]}}),Vh(no,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[co,Co,To,so],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Lh(Ah(),Oh(),"json")]),Vh(Eo,"credential",(function(t,e){return new xo(t,e)}),[Ah("email"),Ah("password")]),Bh(xo.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(po.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(po,"credential",mo,[Lh(Ah(),Oh(),"token")]),Vh(Eo,"credentialWithLink",So,[Ah("email"),Ah("emailLink")]),Bh(go.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(go,"credential",vo,[Lh(Ah(),Oh(),"token")]),Bh(yo.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(yo,"credential",bo,[Lh(Ah(),Lh(Oh(),Dh()),"idToken"),Lh(Ah(),Dh(),"accessToken",!0)]),Bh(wo.prototype,{Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(wo,"credential",_o,[Lh(Ah(),Oh(),"token"),Ah("secret",!0)]),Bh(fo.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},credential:{name:"credential",j:[Lh(Ah(),Lh(Oh(),Dh()),"optionsOrIdToken"),Lh(Ah(),Dh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Bh(ao.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(io.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Vh(Ro,"credential",Oo,[Ah("verificationId"),Ah("verificationCode")]),Bh(Ro.prototype,{eb:{name:"verifyPhoneNumber",j:[Lh(Ah(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Mh(t.session,to)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Mh(t.session,eo)&&Fh(t.multiFactorHint):t.session&&t.multiFactorUid?Mh(t.session,eo)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Bh(ko.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(C.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(Vo.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(jo.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(Hc.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(zc.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),Bh(Qc.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Ah("displayName",!0)]},ad:{name:"unenroll",j:[Lh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Fh},Ah(),"multiFactorInfoIdentifier")]}}),Bh(Ih.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Vh(mi,"parseLink",Ci,[Ah("link")]),Vh(hh,"assertion",(function(t){return new Xc(t)}),[Ph("phone")]),function(){if(void 0===u2.a||!u2.a.INTERNAL||!u2.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ri,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ni,VERIFY_AND_CHANGE_EMAIL:ii,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Hl,AuthCredential:no,Error:C};Vh(t,"EmailAuthProvider",Eo,[]),Vh(t,"FacebookAuthProvider",po,[]),Vh(t,"GithubAuthProvider",go,[]),Vh(t,"GoogleAuthProvider",yo,[]),Vh(t,"TwitterAuthProvider",wo,[]),Vh(t,"OAuthProvider",fo,[Ah("providerId")]),Vh(t,"SAMLAuthProvider",ho,[Ah("providerId")]),Vh(t,"PhoneAuthProvider",Ro,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Hl)}}]),Vh(t,"RecaptchaVerifier",Ih,[Lh(Ah(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Oh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof u2.a.app.App)}}]),Vh(t,"ActionCodeURL",mi,[]),Vh(t,"PhoneMultiFactorGenerator",hh,[]),u2.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Hl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),u2.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:b((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:b(t.mc,t),addAuthTokenListener:b(t.cc,t),removeAuthTokenListener:b(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),u2.a.registerVersion("@firebase/auth","0.15.1"),u2.a.INTERNAL.extendNamespace({User:ol})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n("6Uf2");var c2=n("q/0M"),l2=n("qOnz"),h2=function(t,e){return(h2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function d2(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var f2,p2="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m2=m2||{},g2=p2||self;function v2(){}function y2(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function b2(t){var e=y2(t);return"array"==e||"object"==e&&"number"==typeof t.length}function w2(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _2="closure_uid_"+(1e9*Math.random()>>>0),x2=0;function C2(t,e,n){return t.call.apply(t.bind,arguments)}function E2(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function S2(t,e,n){return(S2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C2:E2).apply(null,arguments)}function I2(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var k2=Date.now;function T2(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function A2(){this.j=this.j,this.i=this.i}A2.prototype.j=!1,A2.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,_2)&&t[_2]||(t[_2]=++x2)}(this)},A2.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var R2=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},O2=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function N2(t){return Array.prototype.concat.apply([],arguments)}function D2(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function P2(t){return/^[\s\xa0]*$/.test(t)}var M2,F2=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function L2(t,e){return-1!=t.indexOf(e)}function B2(t,e){return t<e?-1:t>e?1:0}t:{var j2=g2.navigator;if(j2){var V2=j2.userAgent;if(V2){M2=V2;break t}}M2=""}function U2(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function z2(t){var e={};for(var n in t)e[n]=t[n];return e}var W2="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q2(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<W2.length;o++)n=W2[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function H2(t){return H2[" "](t),t}H2[" "]=v2;var G2,$2,K2=L2(M2,"Opera"),X2=L2(M2,"Trident")||L2(M2,"MSIE"),Y2=L2(M2,"Edge"),Q2=Y2||X2,J2=L2(M2,"Gecko")&&!(L2(M2.toLowerCase(),"webkit")&&!L2(M2,"Edge"))&&!(L2(M2,"Trident")||L2(M2,"MSIE"))&&!L2(M2,"Edge"),Z2=L2(M2.toLowerCase(),"webkit")&&!L2(M2,"Edge");function t3(){var t=g2.document;return t?t.documentMode:void 0}t:{var e3="",n3=($2=M2,J2?/rv:([^\);]+)(\)|;)/.exec($2):Y2?/Edge\/([\d\.]+)/.exec($2):X2?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec($2):Z2?/WebKit\/(\S+)/.exec($2):K2?/(?:Version)[ \/]?(\S+)/.exec($2):void 0);if(n3&&(e3=n3?n3[1]:""),X2){var r3=t3();if(null!=r3&&r3>parseFloat(e3)){G2=String(r3);break t}}G2=e3}var i3={};function o3(t){return function(t,e){var n=i3;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=F2(String(G2)).split("."),r=F2(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=B2(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||B2(0==s[2].length,0==a[2].length)||B2(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}var s3=g2.document&&X2&&(t3()||parseInt(G2,10))||void 0,a3=!X2||9<=Number(s3),u3=X2&&!o3("9"),c3=function(){if(!g2.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{g2.addEventListener("test",v2,e),g2.removeEventListener("test",v2,e)}catch(n){}return t}();function l3(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function h3(t,e){if(l3.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(J2){t:{try{H2(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:d3[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}l3.prototype.b=function(){this.defaultPrevented=!0},T2(h3,l3);var d3={2:"touch",3:"pen",4:"mouse"};h3.prototype.b=function(){h3.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,u3)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var f3="closure_listenable_"+(1e6*Math.random()|0),p3=0;function m3(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++p3,this.Y=this.Z=!1}function g3(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function v3(t){this.src=t,this.a={},this.b=0}function y3(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=R2(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(g3(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function b3(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}v3.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=b3(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new m3(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var w3="closure_lm_"+(1e6*Math.random()|0),_3={};function x3(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=R3(r),e&&e[f3]?e.wa(n,r,w2(i)?!!i.capture:!!i,o):C3(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)x3(t,e[o],n,r,i);return null}return n=R3(n),t&&t[f3]?t.va(e,n,w2(r)?!!r.capture:!!r,i):C3(t,e,n,!1,r,i)}function C3(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=w2(i)?!!i.capture:!!i;if(s&&!a3)return null;var a=T3(t);if(a||(t[w3]=a=new v3(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=k3,e=a3?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)c3||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(S3(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function E3(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[f3])y3(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(S3(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=T3(e))?(y3(n,t),0==n.b&&(n.src=null,e[w3]=null)):g3(t)}}}function S3(t){return t in _3?_3[t]:_3[t]="on"+t}function I3(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&E3(t),n.call(r,e)}function k3(t,e){if(t.Y)return!0;if(!a3){if(!e)t:{e=["window","event"];for(var n=g2,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return I3(t,e=new h3(e,this))}return I3(t,new h3(e,this))}function T3(t){return(t=t[w3])instanceof v3?t:null}var A3="__closure_events_fn_"+(1e9*Math.random()>>>0);function R3(t){return"function"==y2(t)?t:(t[A3]||(t[A3]=function(e){return t.handleEvent(e)}),t[A3])}function O3(){A2.call(this),this.c=new v3(this),this.J=this,this.C=null}function N3(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&y3(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}T2(O3,A2),O3.prototype[f3]=!0,(f2=O3.prototype).addEventListener=function(t,e,n,r){x3(this,t,e,n,r)},f2.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=w2(i)?!!i.capture:!!i,r=R3(r),e&&e[f3]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=b3(s=e.a[n],r,i,o))&&(g3(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=T3(e))&&(n=e.a[n.toString()],e=-1,n&&(e=b3(n,r,i,o)),(r=-1<e?n[e]:null)&&E3(r))}(this,t,e,n,r)},f2.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new l3(t,n);else if(t instanceof l3)t.target=t.target||n;else{var i=t;q2(t=new l3(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=N3(s,r,!0,t)&&i}if(i=N3(s=t.a=n,r,!0,t)&&i,i=N3(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=N3(s=t.a=e[o],r,!1,t)&&i;return i},f2.G=function(){if(O3.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)g3(n[r]);delete e.a[t],e.b--}}this.C=null},f2.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},f2.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var D3=g2.JSON.stringify;function P3(){this.b=this.a=null}var M3,F3=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new B3}),(function(t){t.reset()}),100);function L3(){var t=z3,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function B3(){this.next=this.b=this.a=null}function j3(t){g2.setTimeout((function(){throw t}),0)}function V3(t,e){M3||function(){var t=g2.Promise.resolve(void 0);M3=function(){t.then(W3)}}(),U3||(M3(),U3=!0),z3.add(t,e)}P3.prototype.add=function(t,e){var n=F3.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},B3.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},B3.prototype.reset=function(){this.next=this.b=this.a=null};var U3=!1,z3=new P3;function W3(){for(var t;t=L3();){try{t.a.call(t.b)}catch(n){j3(n)}var e=F3;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}U3=!1}function q3(t,e){O3.call(this),this.b=t||1,this.a=e||g2,this.f=S2(this.Ya,this),this.g=k2()}function H3(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function G3(t,e,n){if("function"==y2(t))n&&(t=S2(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=S2(t.handleEvent,t)}return 2147483647<Number(e)?-1:g2.setTimeout(t,e||0)}function $3(t){t.a=G3((function(){t.a=null,t.c&&(t.c=!1,$3(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}T2(q3,O3),(f2=q3.prototype).aa=!1,f2.M=null,f2.Ya=function(){if(this.aa){var t=k2()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(H3(this),this.start()))}},f2.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=k2())},f2.G=function(){q3.S.G.call(this),H3(this),delete this.a};var K3=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}h2(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:$3(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(g2.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(A2);function X3(t){A2.call(this),this.b=t,this.a={}}T2(X3,A2);var Y3=[];function Q3(t,e,n,r){Array.isArray(n)||(n&&(Y3[0]=n.toString()),n=Y3);for(var i=0;i<n.length;i++){var o=x3(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function J3(t){U2(t.a,(function(t,e){this.a.hasOwnProperty(e)&&E3(t)}),t),t.a={}}function Z3(){this.a=!0}function t4(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return D3(n)}catch(a){return e}}(t,n)+(r?" "+r:"")}))}X3.prototype.G=function(){X3.S.G.call(this),J3(this)},X3.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Z3.prototype.info=function(){};var e4=null;function n4(){return e4=e4||new O3}function r4(t){l3.call(this,"serverreachability",t)}function i4(t){var e=n4();e.dispatchEvent(new r4(e,t))}function o4(t){l3.call(this,"statevent",t)}function s4(t){var e=n4();e.dispatchEvent(new o4(e,t))}function a4(t){l3.call(this,"timingevent",t)}function u4(t,e){if("function"!=y2(t))throw Error("Fn must not be null and must be a function");return g2.setTimeout((function(){t()}),e)}T2(r4,l3),T2(o4,l3),T2(a4,l3);var c4={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},l4={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function h4(){}function d4(){}h4.prototype.a=null;var f4,p4={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function m4(){l3.call(this,"d")}function g4(){l3.call(this,"c")}function v4(){}function y4(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new X3(this),this.P=b4,this.R=new q3(t=Q2?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}T2(m4,l3),T2(g4,l3),T2(v4,h4),f4=new v4;var b4=45e3,w4={},_4={};function x4(t,e,n){t.H=1,t.i=q4(B4(e)),t.j=n,t.I=!0,C4(t,null)}function C4(t,e){t.u=k2(),I4(t),t.l=B4(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),r5(n.b,"t",r),t.D=0,t.a=Q5(t.g,t.g.C?e:null),0<t.O&&(t.F=new K3(S2(t.Ca,t,t.a),t.O)),Q3(t.J,t.a,"readystatechange",t.Wa),e=t.B?z2(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),i4(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.T,t.j)}function E4(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=S4(t,n);if(i==_4){4==e&&(t.h=4,s4(14),r=!1),t4(t.c,t.f,null,"[Incomplete Response]");break}if(i==w4){t.h=4,s4(15),t4(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}t4(t.c,t.f,i,null),O4(t,i)}4==e&&0==n.length&&(t.h=1,s4(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),W5(e),e.F=!0)):(t4(t.c,t.f,n,"[Invalid Chunked Response]"),R4(t),A4(t))}function S4(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?_4:(n=Number(e.substring(n,r)),isNaN(n)?w4:(r+=1)+n>e.length?_4:(e=e.substr(r,n),t.D=r+n,e))}function I4(t){t.U=k2()+t.P,k4(t,t.P)}function k4(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=u4(S2(t.Ua,t),e)}function T4(t){t.o&&(g2.clearTimeout(t.o),t.o=null)}function A4(t){0==t.g.v||t.A||G5(t.g,t)}function R4(t){T4(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,H3(t.R),J3(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function O4(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||l5(n.b,t)))if(n.I=t.N,!t.C&&l5(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;H5(n),P5(n)}z5(n),s4(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=u4(S2(n.Ra,n),6e3));if(1>=c5(n.b)&&n.ea){try{n.ea()}catch(g){}n.ea=void 0}}else K5(n,11)}else if((t.C||n.a==t)&&H5(n),!P2(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(L2(l,"spdy")||L2(l,"quic")||L2(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(h5(h,h.b),h.b=null))}if(u.A){var d=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;d&&(u.na=d,W4(u.B,u.A,d))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=k2()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var f=t;if((u=n).la=Y5(u,u.C?u.ga:null,u.fa),f.C){d5(u.b,f);var p=f,m=u.D;m&&p.setTimeout(m),p.o&&(T4(p),I4(p)),u.a=f}else U5(u);0<n.g.length&&L5(n)}else"stop"!=i[0]&&"close"!=i[0]||K5(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?K5(n,7):D5(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);i4(4)}catch(g){}}function N4(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(b2(t)||"string"==typeof t)O2(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(b2(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(b2(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function D4(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof D4)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function P4(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];M4(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)M4(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function M4(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(f2=y4.prototype).setTimeout=function(t){this.P=t},f2.Wa=function(t){t=t.target;var e=this.F;e&&3==A5(t)?e.f():this.Ca(t)},f2.Ca=function(t){try{if(t==this.a)t:{var e=A5(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!Q2&&!this.a.$())){this.A||4!=e||7==n||i4(8==n||0>=r?3:2),T4(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P2(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,s4(12),R4(this),A4(this);break t}t4(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,O4(this,u)}this.I?(E4(this,e,o),Q2&&this.b&&3==e&&(Q3(this.J,this.R,"tick",this.Va),this.R.start())):(t4(this.c,this.f,o,null),O4(this,o)),4==e&&R4(this),this.b&&!this.A&&(4==e?G5(this.g,this):(this.b=!1,I4(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,s4(12)):(this.h=0,s4(13)),R4(this),A4(this)}}}catch(LO){}},f2.Va=function(){if(this.a){var t=A5(this.a),e=this.a.$();this.D<e.length&&(T4(this),E4(this,t,e),this.b&&4!=t&&I4(this))}},f2.cancel=function(){this.A=!0,R4(this)},f2.Ua=function(){this.o=null;var t=k2();0<=t-this.U?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(i4(3),s4(17)),R4(this),this.h=2,A4(this)):k4(this,this.U-t)},(f2=D4.prototype).K=function(){P4(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},f2.L=function(){return P4(this),this.a.concat()},f2.get=function(t,e){return M4(this.b,t)?this.b[t]:e},f2.set=function(t,e){M4(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},f2.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var F4=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function L4(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof L4){this.a=void 0!==e?e:t.a,j4(this,t.f),this.j=t.j,V4(this,t.c),U4(this,t.h),this.g=t.g,e=t.b;var n=new Z4;n.c=e.c,e.a&&(n.a=new D4(e.a),n.b=e.b),z4(this,n),this.i=t.i}else t&&(n=String(t).match(F4))?(this.a=!!e,j4(this,n[1]||"",!0),this.j=H4(n[2]||""),V4(this,n[3]||"",!0),U4(this,n[4]),this.g=H4(n[5]||"",!0),z4(this,n[6]||"",!0),this.i=H4(n[7]||"")):(this.a=!!e,this.b=new Z4(null,this.a))}function B4(t){return new L4(t)}function j4(t,e,n){t.f=n?H4(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function V4(t,e,n){t.c=n?H4(e,!0):e}function U4(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function z4(t,e,n){e instanceof Z4?(t.b=e,function(t,e){e&&!t.f&&(t5(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(e5(this,e),r5(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=G4(e,Q4)),t.b=new Z4(e,t.a))}function W4(t,e,n){t.b.set(e,n)}function q4(t){return W4(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^k2()).toString(36)),t}function H4(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function G4(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,$4),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function $4(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}L4.prototype.toString=function(){var t=[],e=this.f;e&&t.push(G4(e,K4,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(G4(e,K4,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(G4(n,"/"==n.charAt(0)?Y4:X4,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",G4(n,J4)),t.join("")};var K4=/[#\/\?@]/g,X4=/[#\?:]/g,Y4=/[#\?]/g,Q4=/[#\?@]/g,J4=/#/g;function Z4(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function t5(t){t.a||(t.a=new D4,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function e5(t,e){t5(t),e=i5(t,e),M4(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,M4((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&P4(t)))}function n5(t,e){return t5(t),e=i5(t,e),M4(t.a.b,e)}function r5(t,e,n){e5(t,e),0<n.length&&(t.c=null,t.a.set(i5(t,e),D2(n)),t.b+=n.length)}function i5(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function o5(t,e){this.b=t,this.a=e}function s5(t){this.g=t||a5,t=g2.PerformanceNavigationTiming?0<(t=g2.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(g2.ia&&g2.ia.ya&&g2.ia.ya()&&g2.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(f2=Z4.prototype).add=function(t,e){t5(this),this.c=null,t=i5(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},f2.forEach=function(t,e){t5(this),this.a.forEach((function(n,r){O2(n,(function(n){t.call(e,n,r,this)}),this)}),this)},f2.L=function(){t5(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},f2.K=function(t){t5(this);var e=[];if("string"==typeof t)n5(this,t)&&(e=N2(e,this.a.get(i5(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=N2(e,t[n])}return e},f2.set=function(t,e){return t5(this),this.c=null,n5(this,t=i5(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},f2.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},f2.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var a5=10;function u5(t){return!!t.b||!!t.a&&t.a.size>=t.f}function c5(t){return t.b?1:t.a?t.a.size:0}function l5(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function h5(t,e){t.a?t.a.add(e):t.b=e}function d5(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function f5(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=d2(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return D2(t.c)}function p5(){}function m5(){this.a=new p5}function g5(t,e,n){var r=n||"";try{N4(t,(function(t,n){var i=t;w2(t)&&(i=D3(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function v5(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}s5.prototype.cancel=function(){var t,e;if(this.c=f5(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=d2(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},p5.prototype.stringify=function(t){return g2.JSON.stringify(t,void 0)},p5.prototype.parse=function(t){return g2.JSON.parse(t,void 0)};var y5=g2.JSON.parse;function b5(t){O3.call(this),this.headers=new D4,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=w5,this.D=this.F=!1}T2(b5,O3);var w5="",_5=/^https?$/i,x5=["POST","PUT"];function C5(t){return"content-type"==t.toLowerCase()}function E5(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,S5(t),k5(t)}function S5(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function I5(t){if(t.b&&void 0!==m2&&(!t.s[1]||4!=A5(t)||2!=t.X()))if(t.l&&4==A5(t))G3(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==A5(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(F4)[1]||null;if(!o&&g2.self&&g2.self.location){var s=g2.self.location.protocol;o=s.substr(0,s.length-1)}i=!_5.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<A5(t)?t.a.statusText:""}catch(u){a=""}t.f=a+" ["+t.X()+"]",S5(t)}}finally{k5(t)}}}function k5(t,e){if(t.a){T5(t);var n=t.a,r=t.s[0]?v2:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function T5(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(g2.clearTimeout(t.m),t.m=null)}function A5(t){return t.a?t.a.readyState:0}function R5(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return U2(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):W4(t,e,n))}function O5(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function N5(t){this.pa=0,this.g=[],this.c=new Z3,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=O5("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=O5("baseRetryDelayMs",5e3,t),this.Ma=O5("retryDelaySeedMs",1e4,t),this.Ja=O5("forwardChannelMaxRetries",2,t),this.ma=O5("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new s5(t&&t.concurrentRequestLimit),this.ka=new m5,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function D5(t){if(M5(t),3==t.v){var e=t.R++,n=B4(t.B);W4(n,"SID",t.J),W4(n,"RID",e),W4(n,"TYPE","terminate"),j5(t,n),(e=new y4(t,t.c,e,void 0)).H=2,e.i=q4(B4(n)),n=!1,g2.navigator&&g2.navigator.sendBeacon&&(n=g2.navigator.sendBeacon(e.i.toString(),"")),!n&&g2.Image&&((new Image).src=e.i,n=!0),n||(e.a=Q5(e.g,null),e.a.ba(e.i)),e.u=k2(),I4(e)}X5(t)}function P5(t){t.a&&(W5(t),t.a.cancel(),t.a=null)}function M5(t){P5(t),t.j&&(g2.clearTimeout(t.j),t.j=null),H5(t),t.b.cancel(),t.h&&("number"==typeof t.h&&g2.clearTimeout(t.h),t.h=null)}function F5(t,e){t.g.push(new o5(t.La++,e)),3==t.v&&L5(t)}function L5(t){u5(t.b)||t.h||(t.h=!0,V3(t.Ba,t),t.u=0)}function B5(t,e){var n;n=e?e.f:t.R++;var r=B4(t.B);W4(r,"SID",t.J),W4(r,"RID",n),W4(r,"AID",t.P),j5(t,r),t.i&&t.l&&R5(r,t.i,t.l),n=new y4(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=V5(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),h5(t.b,n),x4(n,r,e)}function j5(t,e){t.f&&N4({},(function(t,n){W4(e,n,t)}))}function V5(t,e,n){n=Math.min(t.g.length,n);var r=t.f?S2(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{g5(l,s,"req"+c+"_")}catch(h){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function U5(t){t.a||t.j||(t.U=1,V3(t.Aa,t),t.o=0)}function z5(t){return!(t.a||t.j||3<=t.o||(t.U++,t.j=u4(S2(t.Aa,t),$5(t,t.o)),t.o++,0))}function W5(t){null!=t.s&&(g2.clearTimeout(t.s),t.s=null)}function q5(t){t.a=new y4(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=B4(t.la);W4(e,"RID","rpc"),W4(e,"SID",t.J),W4(e,"CI",t.H?"0":"1"),W4(e,"AID",t.P),j5(t,e),W4(e,"TYPE","xmlhttp"),t.i&&t.l&&R5(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=q4(B4(e)),n.j=null,n.I=!0,C4(n,t)}function H5(t){null!=t.m&&(g2.clearTimeout(t.m),t.m=null)}function G5(t,e){var n=null;if(t.a==e){H5(t),W5(t),t.a=null;var r=2}else{if(!l5(t.b,e))return;n=e.s,d5(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=k2()-e.u;var i=t.u;(r=n4()).dispatchEvent(new a4(r,n,e,i)),L5(t)}else U5(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(c5(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=u4(S2(t.Ba,t,e),$5(t,t.u)),t.u++,0)))}(t,e)||2==r&&z5(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:K5(t,5);break;case 4:K5(t,10);break;case 3:K5(t,6);break;default:K5(t,2)}}function $5(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function K5(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=S2(t.Xa,t);n||(n=new L4("//www.google.com/images/cleardot.gif"),g2.location&&"http"==g2.location.protocol||j4(n,"https"),q4(n)),function(t,e){var n=new Z3;if(g2.Image){var r=new Image;r.onload=I2(v5,n,r,"TestLoadImage: loaded",!0,e),r.onerror=I2(v5,n,r,"TestLoadImage: error",!1,e),r.onabort=I2(v5,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=I2(v5,n,r,"TestLoadImage: timeout",!1,e),g2.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else s4(2);t.v=0,t.f&&t.f.ra(e),X5(t),M5(t)}function X5(t){t.v=0,t.I=-1,t.f&&(0==f5(t.b).length&&0==t.g.length||(t.b.c.length=0,D2(t.g),t.g.length=0),t.f.qa())}function Y5(t,e,n){var r=function(t){return t instanceof L4?B4(t):new L4(t,void 0)}(n);if(""!=r.c)e&&V4(r,e+"."+r.c),U4(r,r.h);else{var i=g2.location;r=function(t,e,n,r){var i=new L4(null,void 0);return t&&j4(i,t),e&&V4(i,e),n&&U4(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&U2(t.W,(function(t,e){W4(r,e,t)})),n=t.na,(e=t.A)&&n&&W4(r,e,n),W4(r,"VER",t.ha),j5(t,r),r}function Q5(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new b5(t.Ka)).F=t.C,e}function J5(){}function Z5(){if(X2&&!(10<=Number(s3)))throw Error("Environmental error: no available transport.")}function t6(t,e){O3.call(this),this.a=new N5(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!P2(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!P2(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new r6(this)}function e6(t){m4.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function n6(){g4.call(this),this.status=1}function r6(t){this.a=t}(f2=b5.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:f4),this.a.onreadystatechange=S2(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void E5(this,o)}t=n||"";var i=new D4(this.headers);r&&N4(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=C5,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=g2.FormData&&t instanceof g2.FormData,!(0<=R2(x5,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{T5(this),0<this.o&&((this.D=function(t){return X2&&o3(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=S2(this.xa,this)):this.m=G3(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){E5(this,o)}},f2.xa=function(){void 0!==m2&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},f2.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),k5(this))},f2.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),k5(this,!0)),b5.S.G.call(this)},f2.za=function(){this.j||(this.A||this.l||this.g?I5(this):this.Ta())},f2.Ta=function(){I5(this)},f2.X=function(){try{return 2<A5(this)?this.a.status:-1}catch($2){return-1}},f2.$=function(){try{return this.a?this.a.responseText:""}catch($2){return""}},f2.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),y5(e)}},f2.ua=function(){return this.h},f2.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(f2=N5.prototype).ha=8,f2.v=1,f2.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new y4(this,this.c,t,void 0),r=this.l;if(this.O&&(r?q2(r=z2(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=V5(this,n,e),W4(i=B4(this.B),"RID",t),W4(i,"CVER",22),this.A&&W4(i,"X-HTTP-Session-Id",this.A),j5(this,i),this.i&&r&&R5(i,this.i,r),h5(this.b,n),this.Ga&&W4(i,"TYPE","init"),this.da?(W4(i,"$req",e),W4(i,"SID","null"),n.V=!0,x4(n,i,null)):x4(n,i,e),this.v=2}}else 3==this.v&&(t?B5(this,t):0==this.g.length||u5(this.b)||B5(this))},f2.Aa=function(){if(this.j=null,q5(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=u4(S2(this.Sa,this),t)}},f2.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,P5(this),q5(this))},f2.Ra=function(){null!=this.m&&(this.m=null,P5(this),z5(this),s4(19))},f2.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),s4(2)):(this.c.info("Failed to ping google.com"),s4(1))},(f2=J5.prototype).ta=function(){},f2.sa=function(){},f2.ra=function(){},f2.qa=function(){},f2.Ha=function(){},Z5.prototype.a=function(t,e){return new t6(t,e)},T2(t6,O3),(f2=t6.prototype).addEventListener=function(t,e,n,r){t6.S.addEventListener.call(this,t,e,n,r)},f2.removeEventListener=function(t,e,n,r){t6.S.removeEventListener.call(this,t,e,n,r)},f2.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;s4(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=Y5(t,null,t.fa),L5(t)},f2.close=function(){D5(this.a)},f2.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,F5(this.a,e)}else this.g?((e={}).__data__=D3(t),F5(this.a,e)):F5(this.a,t)},f2.G=function(){this.a.f=null,delete this.f,D5(this.a),delete this.a,t6.S.G.call(this)},T2(e6,m4),T2(n6,g4),T2(r6,J5),r6.prototype.ta=function(){this.a.dispatchEvent("a")},r6.prototype.sa=function(t){this.a.dispatchEvent(new e6(t))},r6.prototype.ra=function(t){this.a.dispatchEvent(new n6(t))},r6.prototype.qa=function(){this.a.dispatchEvent("b")},Z5.prototype.createWebChannel=Z5.prototype.a,t6.prototype.send=t6.prototype.Pa,t6.prototype.open=t6.prototype.Oa,t6.prototype.close=t6.prototype.close,c4.NO_ERROR=0,c4.TIMEOUT=8,c4.HTTP_ERROR=6,l4.COMPLETE="complete",d4.EventType=p4,p4.OPEN="a",p4.CLOSE="b",p4.ERROR="c",p4.MESSAGE="d",O3.prototype.listen=O3.prototype.va,b5.prototype.listenOnce=b5.prototype.wa,b5.prototype.getLastError=b5.prototype.Qa,b5.prototype.getLastErrorCode=b5.prototype.ua,b5.prototype.getStatus=b5.prototype.X,b5.prototype.getResponseJson=b5.prototype.Na,b5.prototype.getResponseText=b5.prototype.$,b5.prototype.send=b5.prototype.ba;var i6=c4,o6=l4,s6=d4,a6=b5,u6=n("/6Yf"),c6={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},l6=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(uR.c)(e,t),e}(Error),h6=new c2.b("@firebase/firestore");function d6(){return h6.logLevel}function f6(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h6.logLevel<=c2.a.DEBUG){var r=e.map(g6);h6.debug.apply(h6,Object(uR.g)(["Firestore (8.0.0): "+t],r))}}function p6(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h6.logLevel<=c2.a.ERROR){var r=e.map(g6);h6.error.apply(h6,Object(uR.g)(["Firestore (8.0.0): "+t],r))}}function m6(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h6.logLevel<=c2.a.WARN){var r=e.map(g6);h6.warn.apply(h6,Object(uR.g)(["Firestore (8.0.0): "+t],r))}}function g6(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function v6(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.0) INTERNAL ASSERTION FAILED: "+t;throw p6(e),new Error(e)}function y6(t,e){t||v6()}function b6(t,e){return t}function w6(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var _6=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=w6(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function x6(t,e){return t<e?-1:t>e?1:0}function C6(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function E6(t){return t+"\0"}var S6=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.h=function(t){return x6(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();S6.u=new S6("");var I6=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(S6.fromBase64String(e))}catch(e){throw new l6(c6.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(S6.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}();function k6(){if("undefined"==typeof Uint8Array)throw new l6(c6.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function T6(){if("undefined"==typeof atob)throw new l6(c6.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var A6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.fromBase64String=function(t){T6();try{return new e(S6.fromBase64String(t))}catch(t){throw new l6(c6.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){return k6(),new e(S6.fromUint8Array(t))},e.prototype.toBase64=function(){return T6(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return k6(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(I6),R6=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},O6=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.h=function(t){return x6(this.projectId,t.projectId)||x6(this.database,t.database)},t}();function N6(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function D6(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function P6(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var M6=function(){function t(t,e){this.m=t,this.A=e,this.R={}}return t.prototype.get=function(t){var e=this.m(t),n=this.R[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.A(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){D6(this.R,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.P=function(){return P6(this.R)},t}(),F6=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new l6(c6.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new l6(c6.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new l6(c6.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new l6(c6.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.g=function(t){return this.seconds===t.seconds?x6(this.nanoseconds,t.nanoseconds):x6(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),L6=function(){function t(t){this.timestamp=t}return t.V=function(e){return new t(e)},t.min=function(){return new t(new F6(0,0))},t.prototype.h=function(t){return this.timestamp.g(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.v=function(){return this.timestamp},t}(),B6=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&v6(),void 0===n?n=t.length-e:n>t.length-e&&v6(),this.segments=t,this.offset=e,this.S=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.D(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.C(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.N=function(t){return this.C(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},t.prototype.k=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.P=function(){return 0===this.length},t.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},t.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),j6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.C=function(t,n,r){return new e(t,n,r)},e.prototype.B=function(){return this.L().join("/")},e.prototype.toString=function(){return this.B()},e.q=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new l6(c6.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.U=function(){return new e([])},e}(B6),V6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,U6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.C=function(t,n,r){return new e(t,n,r)},e.K=function(t){return V6.test(t)},e.prototype.B=function(){return this.L().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.K(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.B()},e.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},e.j=function(){return new e(["__name__"])},e.G=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new l6(c6.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new l6(c6.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new l6(c6.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new l6(c6.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.U=function(){return new e([])},e}(B6),z6=function(){function t(t){this.path=t}return t.H=function(e){return new t(j6.q(e))},t.J=function(e){return new t(j6.q(e).N(5))},t.prototype.Y=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===j6.D(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.D=function(t,e){return j6.D(t.path,e.path)},t.X=function(t){return t.length%2==0},t.Z=function(e){return new t(new j6(e.slice()))},t}();function W6(t){return null==t}function q6(t){return 0===t&&1/t==-1/0}function H6(t){return"number"==typeof t&&Number.isInteger(t)&&!q6(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var G6=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function $6(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new G6(t,e,n,r,i,o,s)}function K6(t){var e=b6(t);if(null===e.tt){var n=e.path.B();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.B()+t.op.toString()+B8(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.B()+e.dir;var e})).join(","),W6(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=j9(e.startAt)),e.endAt&&(n+="|ub:",n+=j9(e.endAt)),e.tt=n}return e.tt}function X6(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!q9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!P8(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!U9(t.startAt,e.startAt)&&U9(t.endAt,e.endAt)}function Y6(t){return z6.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Q6,J6,Z6=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=L6.min()),void 0===o&&(o=L6.min()),void 0===s&&(s=S6.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),t8=function(t){this.count=t};function e8(t){switch(t){case c6.OK:return v6();case c6.CANCELLED:case c6.UNKNOWN:case c6.DEADLINE_EXCEEDED:case c6.RESOURCE_EXHAUSTED:case c6.INTERNAL:case c6.UNAVAILABLE:case c6.UNAUTHENTICATED:return!1;case c6.INVALID_ARGUMENT:case c6.NOT_FOUND:case c6.ALREADY_EXISTS:case c6.PERMISSION_DENIED:case c6.FAILED_PRECONDITION:case c6.ABORTED:case c6.OUT_OF_RANGE:case c6.UNIMPLEMENTED:case c6.DATA_LOSS:return!0;default:return v6()}}function n8(t){if(void 0===t)return p6("GRPC error has no .code"),c6.UNKNOWN;switch(t){case Q6.OK:return c6.OK;case Q6.CANCELLED:return c6.CANCELLED;case Q6.UNKNOWN:return c6.UNKNOWN;case Q6.DEADLINE_EXCEEDED:return c6.DEADLINE_EXCEEDED;case Q6.RESOURCE_EXHAUSTED:return c6.RESOURCE_EXHAUSTED;case Q6.INTERNAL:return c6.INTERNAL;case Q6.UNAVAILABLE:return c6.UNAVAILABLE;case Q6.UNAUTHENTICATED:return c6.UNAUTHENTICATED;case Q6.INVALID_ARGUMENT:return c6.INVALID_ARGUMENT;case Q6.NOT_FOUND:return c6.NOT_FOUND;case Q6.ALREADY_EXISTS:return c6.ALREADY_EXISTS;case Q6.PERMISSION_DENIED:return c6.PERMISSION_DENIED;case Q6.FAILED_PRECONDITION:return c6.FAILED_PRECONDITION;case Q6.ABORTED:return c6.ABORTED;case Q6.OUT_OF_RANGE:return c6.OUT_OF_RANGE;case Q6.UNIMPLEMENTED:return c6.UNIMPLEMENTED;case Q6.DATA_LOSS:return c6.DATA_LOSS;default:return v6()}}(J6=Q6||(Q6={}))[J6.OK=0]="OK",J6[J6.CANCELLED=1]="CANCELLED",J6[J6.UNKNOWN=2]="UNKNOWN",J6[J6.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J6[J6.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J6[J6.NOT_FOUND=5]="NOT_FOUND",J6[J6.ALREADY_EXISTS=6]="ALREADY_EXISTS",J6[J6.PERMISSION_DENIED=7]="PERMISSION_DENIED",J6[J6.UNAUTHENTICATED=16]="UNAUTHENTICATED",J6[J6.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J6[J6.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J6[J6.ABORTED=10]="ABORTED",J6[J6.OUT_OF_RANGE=11]="OUT_OF_RANGE",J6[J6.UNIMPLEMENTED=12]="UNIMPLEMENTED",J6[J6.INTERNAL=13]="INTERNAL",J6[J6.UNAVAILABLE=14]="UNAVAILABLE",J6[J6.DATA_LOSS=15]="DATA_LOSS";var r8=function(){function t(t,e){this.D=t,this.root=e||o8.EMPTY}return t.prototype.ot=function(e,n){return new t(this.D,this.root.ot(e,n,this.D).copy(null,null,o8.at,null,null))},t.prototype.remove=function(e){return new t(this.D,this.root.remove(e,this.D).copy(null,null,o8.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.P=function(){return this.root.P()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ht=function(){return this.root.ht()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new i8(this.root,null,this.D,!1)},t.prototype.ft=function(t){return new i8(this.root,t,this.D,!1)},t.prototype.dt=function(){return new i8(this.root,null,this.D,!0)},t.prototype.wt=function(t){return new i8(this.root,t,this.D,!0)},t}(),i8=function(){function t(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}return t.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},t.prototype.At=function(){return this.Tt.length>0},t.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),o8=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.P=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.P()?this:this.left.min()},t.prototype.ht=function(){return this.min().key},t.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},t.prototype.gt=function(){if(this.left.P())return t.EMPTY;var e=this;return e.left.Vt()||e.left.left.Vt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.gt(),null)).Pt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.P()||i.left.Vt()||i.left.left.Vt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Vt()&&(i=i.bt()),i.right.P()||i.right.Vt()||i.right.left.Vt()||(i=i.vt()),0===n(e,i.key)){if(i.right.P())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.gt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Pt()},t.prototype.Vt=function(){return this.color},t.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},t.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw v6();if(this.right.Vt())throw v6();var t=this.left.Nt();if(t!==this.right.Nt())throw v6();return t+(this.Vt()?0:1)},t}();o8.EMPTY=null,o8.RED=!0,o8.at=!1,o8.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw v6()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw v6()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw v6()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw v6()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw v6()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new o8(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.P=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ht=function(){return null},t.prototype.ct=function(){return null},t.prototype.Vt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());var s8=function(){function t(t){this.D=t,this.data=new r8(this.D)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ht()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.D(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.kt=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new a8(this.data._t())},t.prototype.ft=function(t){return new a8(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.P=function(){return this.data.P()},t.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.D(i,o))return!1}return!0},t.prototype.L=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.D);return n.data=e,n},t}(),a8=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),u8=new r8(z6.D);function c8(){return u8}function l8(){return c8()}var h8=new r8(z6.D);function d8(){return h8}var f8=new r8(z6.D),p8=new s8(z6.D);function m8(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=p8,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var g8=new s8(x6);function v8(){return g8}var y8=function(){function t(t){this.D=t?function(e,n){return t(e,n)||z6.D(e.key,n.key)}:function(t,e){return z6.D(t.key,e.key)},this.$t=d8(),this.Lt=new r8(this.D)}return t.Bt=function(e){return new t(e.D)},t.prototype.has=function(t){return null!=this.$t.get(t)},t.prototype.get=function(t){return this.$t.get(t)},t.prototype.first=function(){return this.Lt.ht()},t.prototype.last=function(){return this.Lt.ct()},t.prototype.P=function(){return this.Lt.P()},t.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.D=this.D,r.$t=e,r.Lt=n,r},t}(),b8=function(){function t(){this.qt=new r8(z6.D)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):v6():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ut((function(e,n){t.push(n)})),t},t}(),w8=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=a}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,y8.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&E9(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),_8=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,x8.Zt(e,n)),new t(L6.min(),r,v8(),c8(),m8())},t}(),x8=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(S6.u,n,m8(),m8(),m8())},t}(),C8=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},E8=function(t,e){this.targetId=t,this.oe=e},S8=function(t,e,n,r){void 0===n&&(n=S6.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},I8=function(){function t(){this.ae=0,this.he=A8(),this.ce=S6.u,this.ue=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.o()>0&&(this.le=!0,this.ce=t)},t.prototype.we=function(){var t=m8(),e=m8(),n=m8();return this.he.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:v6()}})),new x8(this.ce,this.ue,t,e,n)},t.prototype.Ee=function(){this.le=!1,this.he=A8()},t.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},t.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},t.prototype.me=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.ue=!0},t}(),k8=function(){function t(t){this.Pe=t,this.ge=new Map,this.Ve=c8(),this.ye=T8(),this.pe=new s8(x6)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof u9?this.ve(r,t.re):t.re instanceof c9&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Se(o[i],t.key,t.re)},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.xe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.Ee(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.xe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.xe(n)&&(e.Fe(n),r.de(t.resumeToken));break;default:v6()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ge.forEach((function(t,r){n.xe(r)&&e(r)}))},t.prototype.ke=function(t){var e=t.targetId,n=t.oe.count,r=this.Oe(e);if(r){var i=r.target;if(Y6(i))if(0===n){var o=new z6(i.path);this.Se(e,o,new c9(o,L6.min()))}else y6(1===n);else this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e))}},t.prototype.$e=function(t){var e=this,n=new Map;this.ge.forEach((function(r,i){var o=e.Oe(i);if(o){if(r.te&&Y6(o.target)){var s=new z6(o.target.path);null!==e.Ve.get(s)||e.Le(i,s)||e.Se(i,s,new c9(s,t))}r.fe&&(n.set(i,r.we()),r.Ee())}}));var r=m8();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.Oe(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new _8(t,n,this.pe,this.Ve,r);return this.Ve=c8(),this.ye=T8(),this.pe=new s8(x6),i},t.prototype.ve=function(t,e){if(this.xe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.xe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n))}},t.prototype.removeTarget=function(t){this.ge.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},t.prototype.me=function(t){this.Ne(t).me()},t.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new I8,this.ge.set(t,e)),e},t.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new s8(x6),this.ye=this.ye.ot(t,e)),e},t.prototype.xe=function(t){var e=null!==this.Oe(t);return e||f6("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},t.prototype.Fe=function(t){var e=this;this.ge.set(t,new I8),this.Pe.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},t}();function T8(){return new r8(z6.D)}function A8(){return new r8(z6.D)}function R8(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function O8(t){var e=j8(t.mapValue.fields.__local_write_time__.timestampValue);return new F6(e.seconds,e.nanos)}var N8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function D8(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?R8(t)?4:10:v6()}function P8(t,e){var n=D8(t);if(n!==D8(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return O8(t).isEqual(O8(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=j8(t.timestampValue),r=j8(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return U8(t.bytesValue).isEqual(U8(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return V8(t.geoPointValue.latitude)===V8(e.geoPointValue.latitude)&&V8(t.geoPointValue.longitude)===V8(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return V8(t.integerValue)===V8(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=V8(t.doubleValue),r=V8(e.doubleValue);return n===r?q6(n)===q6(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return C6(t.arrayValue.values||[],e.arrayValue.values||[],P8);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(N6(n)!==N6(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!P8(n[i],r[i])))return!1;return!0}(t,e);default:return v6()}}function M8(t,e){return void 0!==(t.values||[]).find((function(t){return P8(t,e)}))}function F8(t,e){var n=D8(t),r=D8(e);if(n!==r)return x6(n,r);switch(n){case 0:return 0;case 1:return x6(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=V8(t.integerValue||t.doubleValue),r=V8(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return L8(t.timestampValue,e.timestampValue);case 4:return L8(O8(t),O8(e));case 5:return x6(t.stringValue,e.stringValue);case 6:return function(t,e){var n=U8(t),r=U8(e);return n.h(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=x6(n[i],r[i]);if(0!==o)return o}return x6(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=x6(V8(t.latitude),V8(e.latitude));return 0!==n?n:x6(V8(t.longitude),V8(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=F8(n[i],r[i]);if(o)return o}return x6(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=x6(r[s],o[s]);if(0!==a)return a;var u=F8(n[r[s]],i[o[s]]);if(0!==u)return u}return x6(r.length,o.length)}(t.mapValue,e.mapValue);default:throw v6()}}function L8(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return x6(t,e);var n=j8(t),r=j8(e),i=x6(n.seconds,r.seconds);return 0!==i?i:x6(n.nanos,r.nanos)}function B8(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=j8(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?U8(e.bytesValue).toBase64():"referenceValue"in e?z6.J(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):v6();var n}(t)}function j8(t){if(y6(!!t),"string"==typeof t){var e=0,n=N8.exec(t);if(y6(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:V8(t.seconds),nanos:V8(t.nanos)}}function V8(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function U8(t){return"string"==typeof t?S6.fromBase64String(t):S6.fromUint8Array(t)}function z8(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function W8(t){return!!t&&"integerValue"in t}function q8(t){return!!t&&"arrayValue"in t}function H8(t){return!!t&&"nullValue"in t}function G8(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $8(t){return!!t&&"mapValue"in t}var K8={asc:"ASCENDING",desc:"DESCENDING"},X8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Y8=function(t,e){this._=t,this.Ke=e};function Q8(t){return{integerValue:""+t}}function J8(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:q6(e)?"-0":e}}function Z8(t,e){return H6(e)?Q8(e):J8(t,e)}function t7(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function e7(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function n7(t,e){return t7(t,e.v())}function r7(t){return y6(!!t),L6.V(function(t){var e=j8(t);return new F6(e.seconds,e.nanos)}(t))}function i7(t,e){return function(t){return new j6(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).B()}function o7(t){var e=j6.q(t);return y6(I7(e)),e}function s7(t,e){return i7(t._,e.path)}function a7(t,e){var n=o7(e);return y6(n.get(1)===t._.projectId),y6(!n.get(3)&&!t._.database||n.get(3)===t._.database),new z6(h7(n))}function u7(t,e){return i7(t._,e)}function c7(t){var e=o7(t);return 4===e.length?j6.U():h7(e)}function l7(t){return new j6(["projects",t._.projectId,"databases",t._.database]).B()}function h7(t){return y6(t.length>4&&"documents"===t.get(4)),t.N(5)}function d7(t,e,n){return{name:s7(t,e),fields:n.proto.mapValue.fields}}function f7(t,e){var n;if(e instanceof Y7)n={update:d7(t,e.key,e.value)};else if(e instanceof n9)n={delete:s7(t,e.key)};else if(e instanceof Q7)n={update:d7(t,e.key,e.data),updateMask:S7(e.Qe)};else if(e instanceof Z7)n={transform:{document:s7(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof O7)return{fieldPath:e.field.B(),setToServerValue:"REQUEST_TIME"};if(n instanceof N7)return{fieldPath:e.field.B(),appendMissingElements:{values:n.elements}};if(n instanceof P7)return{fieldPath:e.field.B(),removeAllFromArray:{values:n.elements}};if(n instanceof F7)return{fieldPath:e.field.B(),increment:n.We};throw v6()}(0,t)}))}};else{if(!(e instanceof r9))return v6();n={verify:s7(t,e.key)}}return e.Ge.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:n7(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:v6()}(t,e.Ge)),n}function p7(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?z7.updateTime(r7(t.updateTime)):void 0!==t.exists?z7.exists(t.exists):z7.ze()}(e.currentDocument):z7.ze();if(e.update){var r=a7(t,e.update.name),i=new i9({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new j7((t.fieldPaths||[]).map((function(t){return U6.G(t)})))}(e.updateMask);return new Q7(r,i,o,n)}return new Y7(r,i,n)}if(e.delete){var s=a7(t,e.delete);return new n9(s,n)}if(e.transform){var a=a7(t,e.transform.document),u=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(y6("REQUEST_TIME"===e.setToServerValue),n=new O7):"appendMissingElements"in e?n=new N7(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new P7(e.removeAllFromArray.values||[]):"increment"in e?n=new F7(t,e.increment):v6();var r=U6.G(e.fieldPath);return new V7(r,n)}(t,e)}));return y6(!0===n.exists),new Z7(a,u)}if(e.verify){var c=a7(t,e.verify);return new r9(c,n)}return v6()}function m7(t,e){return{documents:[u7(t,e.path)]}}function g7(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=u7(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=u7(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(G8(t.value))return{unaryFilter:{field:_7(t.field),op:"IS_NAN"}};if(H8(t.value))return{unaryFilter:{field:_7(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(G8(t.value))return{unaryFilter:{field:_7(t.field),op:"IS_NOT_NAN"}};if(H8(t.value))return{unaryFilter:{field:_7(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_7(t.field),op:w7(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:_7(t.field),direction:b7(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ke||W6(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=v7(e.startAt)),e.endAt&&(n.structuredQuery.endAt=v7(e.endAt)),n}function v7(t){return{before:t.before,values:t.position}}function y7(t){return new B9(t.values||[],!!t.before)}function b7(t){return K8[t]}function w7(t){return X8[t]}function _7(t){return{fieldPath:t.B()}}function x7(t){return U6.G(t.fieldPath)}function C7(t){return A9.create(x7(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return v6()}}(t.fieldFilter.op),t.fieldFilter.value)}function E7(t){switch(t.unaryFilter.op){case"IS_NAN":var e=x7(t.unaryFilter.field);return A9.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=x7(t.unaryFilter.field);return A9.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=x7(t.unaryFilter.field);return A9.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=x7(t.unaryFilter.field);return A9.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return v6()}}function S7(t){var e=[];return t.fields.forEach((function(t){return e.push(t.B())})),{fieldPaths:e}}function I7(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var k7=function(){this.He=void 0};function T7(t,e,n){return t instanceof O7?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof N7?D7(t,e):t instanceof P7?M7(t,e):function(t,e){var n=R7(t,e),r=L7(n)+L7(t.We);return W8(n)&&W8(t.We)?Q8(r):J8(t.serializer,r)}(t,e)}function A7(t,e,n){return t instanceof N7?D7(t,e):t instanceof P7?M7(t,e):n}function R7(t,e){return t instanceof F7?W8(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var O7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e}(k7),N7=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(uR.c)(e,t),e}(k7);function D7(t,e){for(var n=B7(e),r=function(t){n.some((function(e){return P8(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var P7=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(uR.c)(e,t),e}(k7);function M7(t,e){for(var n=B7(e),r=function(t){n=n.filter((function(e){return!P8(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var F7=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return Object(uR.c)(e,t),e}(k7);function L7(t){return V8(t.integerValue||t.doubleValue)}function B7(t){return q8(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var j7=function(){function t(t){this.fields=t,t.sort(U6.D)}return t.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},t.prototype.isEqual=function(t){return C6(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),V7=function(t,e){this.field=t,this.transform=e},U7=function(t,e){this.version=t,this.transformResults=e},z7=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function W7(t,e){return void 0!==t.updateTime?e instanceof u9&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof u9}var q7=function(){};function H7(t,e,n){return t instanceof Y7?function(t,e,n){return new u9(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Q7?function(t,e,n){if(!W7(t.Ge,e))return new l9(t.key,n.version);var r=J7(t,e);return new u9(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Z7?function(t,e,n){if(y6(null!=n.transformResults),!W7(t.Ge,e))return new l9(t.key,n.version);var r=t9(0,e),i=function(t,e,n){var r=[];y6(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof u9&&(a=e.field(o.field)),r.push(A7(s,a,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=e9(t,r.data(),i);return new u9(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new c9(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function G7(t,e,n,r){return t instanceof Y7?function(t,e){if(!W7(t.Ge,e))return e;var n=X7(e);return new u9(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof Q7?function(t,e){if(!W7(t.Ge,e))return e;var n=X7(e),r=J7(t,e);return new u9(t.key,n,r,{Ye:!0})}(t,e):t instanceof Z7?function(t,e,n,r){if(!W7(t.Ge,e))return e;var i=t9(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof u9&&(c=n.field(a.field)),null===c&&r instanceof u9&&(c=r.field(a.field)),i.push(T7(u,c,e))}return i}(t.fieldTransforms,n,e,r),s=e9(t,i.data(),o);return new u9(t.key,i.version,s,{Ye:!0})}(t,e,r,n):function(t,e){return W7(t.Ge,e)?new c9(t.key,L6.min()):e}(t,e)}function $7(t,e){return t instanceof Z7?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof u9?e.field(o.field):void 0,a=R7(o.transform,s||null);null!=a&&(n=null==n?(new o9).set(o.field,a):n.set(o.field,a))}return n?n.Xe():null}(t,e):null}function K7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||C6(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof N7&&e instanceof N7||t instanceof P7&&e instanceof P7?C6(t.elements,e.elements,P8):t instanceof F7&&e instanceof F7?P8(t.We,e.We):t instanceof O7&&e instanceof O7}(t.transform,e.transform)}(t,e)})))}function X7(t){return t instanceof u9?t.version:L6.min()}var Y7=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return Object(uR.c)(e,t),e}(q7),Q7=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ge=i,o.type=1,o}return Object(uR.c)(e,t),e}(q7);function J7(t,e){return function(t,e){var n=new o9(e);return t.Qe.fields.forEach((function(e){if(!e.P()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Xe()}(t,e instanceof u9?e.data():i9.empty())}var Z7=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=z7.exists(!0),r}return Object(uR.c)(e,t),e}(q7);function t9(t,e){return e}function e9(t,e,n){for(var r=new o9(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Xe()}var n9=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return Object(uR.c)(e,t),e}(q7),r9=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return Object(uR.c)(e,t),e}(q7),i9=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!$8(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return P8(this.proto,t.proto)},t}(),o9=function(){function t(t){void 0===t&&(t=i9.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===D8(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.O(),e)},t.prototype.Xe=function(){var t=this.nn(U6.U(),this.tn);return null!=t?new i9(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=$8(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.nn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function s9(t){var e=[];return D6(t.fields||{},(function(t,n){var r=new U6([t]);if($8(n)){var i=s9(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new j7(e)}var a9=function(t,e){this.key=t,this.version=e},u9=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(uR.c)(e,t),e.prototype.field=function(t){return this.sn.field(t)},e.prototype.data=function(){return this.sn},e.prototype.rn=function(){return this.sn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(a9),c9=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(uR.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(a9),l9=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(a9),h9=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=a,this.hn=null,this.cn=null};function d9(t,e,n,r,i,o,s,a){return new h9(t,e,n,r,i,o,s,a)}function f9(t){return new h9(t)}function p9(t){return!W6(t.limit)&&"F"===t.an}function m9(t){return!W6(t.limit)&&"L"===t.an}function g9(t){return t.on.length>0?t.on[0].field:null}function v9(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function y9(t){return null!==t.collectionGroup}function b9(t){var e=b6(t);if(null===e.hn){e.hn=[];var n=v9(e),r=g9(e);if(null!==n&&null===r)n.W()||e.hn.push(new z9(n)),e.hn.push(new z9(U6.j(),"asc"));else{for(var i=!1,o=0,s=e.on;o<s.length;o++){var a=s[o];e.hn.push(a),a.field.W()&&(i=!0)}if(!i){var u=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.hn.push(new z9(U6.j(),u))}}}return e.hn}function w9(t){var e=b6(t);if(!e.cn)if("F"===e.an)e.cn=$6(e.path,e.collectionGroup,b9(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=b9(e);r<i.length;r++){var o=i[r];n.push(new z9(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new B9(e.endAt.position,!e.endAt.before):null,a=e.startAt?new B9(e.startAt.position,!e.startAt.before):null;e.cn=$6(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.cn}function _9(t,e,n){return new h9(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function x9(t,e){return new h9(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function C9(t,e){return new h9(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function E9(t,e){return X6(w9(t),w9(e))&&t.an===e.an}function S9(t){return K6(w9(t))+"|lt:"+t.an}function I9(t){return"Query(target="+function(t){var e=t.path.B();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.B()+" "+e.op+" "+B8(e.value);var e})).join(", ")+"]"),W6(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.B()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+j9(t.startAt)),t.endAt&&(e+=", endAt: "+j9(t.endAt)),"Target("+e+")"}(w9(t))+"; limitType="+t.an+")"}function k9(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.Y(t.collectionGroup)&&t.path.M(n):z6.X(t.path)?t.path.isEqual(n):t.path.$(n)}(t,e)&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.W()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!V9(t.startAt,b9(t),e)||t.endAt&&V9(t.endAt,b9(t),e))}(t,e)}function T9(t){return function(e,n){for(var r=!1,i=0,o=b9(t);i<o.length;i++){var s=o[i],a=W9(s,e,n);if(0!==a)return a;r=r||s.field.W()}return 0}}var A9=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(uR.c)(e,t),e.create=function(t,n,r){return t.W()?"in"===n||"not-in"===n?this.ln(t,n,r):new R9(t,n,r):"array-contains"===n?new P9(t,r):"in"===n?new M9(t,r):"not-in"===n?new F9(t,r):"array-contains-any"===n?new L9(t,r):new e(t,n,r)},e.ln=function(t,e,n){return"in"===e?new O9(t,n):new N9(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(F8(e,this.value)):null!==e&&D8(this.value)===D8(e)&&this._n(F8(e,this.value))},e.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return v6()}},e.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),R9=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=z6.J(r.referenceValue),i}return Object(uR.c)(e,t),e.prototype.matches=function(t){var e=z6.D(t.key,this.key);return this._n(e)},e}(A9),O9=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=D9(0,n),r}return Object(uR.c)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(A9),N9=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=D9(0,n),r}return Object(uR.c)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(A9);function D9(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return z6.J(t.referenceValue)}))}var P9=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(uR.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return q8(e)&&M8(e.arrayValue,this.value)},e}(A9),M9=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(uR.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&M8(this.value.arrayValue,e)},e}(A9),F9=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(uR.c)(e,t),e.prototype.matches=function(t){if(M8(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!M8(this.value.arrayValue,e)},e}(A9),L9=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(uR.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!q8(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return M8(e.value.arrayValue,t)}))},e}(A9),B9=function(t,e){this.position=t,this.before=e};function j9(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return B8(t)})).join(",")}function V9(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.W()?z6.D(z6.J(s.referenceValue),n.key):F8(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function U9(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!P8(t.position[n],e.position[n]))return!1;return!0}var z9=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function W9(t,e,n){var r=t.field.W()?z6.D(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?F8(r,i):v6()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return v6()}}function q9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var H9=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},G9=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.In=0},t.prototype.Rn=function(){this.In=this.Tn},t.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&f6("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},t.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},t.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},t.prototype.gn=function(){return(Math.random()-.5)*this.In},t}(),$9=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&v6(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.xn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Nn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.kn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.On=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.kn(r)},t}(),K9=function(){function t(e,n,r){this.name=e,this.version=n,this.Mn=r,12.2===t.$n(Object(l2.p)())&&p6("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return f6("SimpleDb","Removing database:",t),ttt(window.indexedDB.deleteDatabase(t)).xn()},t.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(t.Bn())return!0;var e=Object(l2.p)(),n=t.$n(e),r=0<n&&n<10,i=t.qn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},t.Kn=function(t,e){return t.store(e)},t.$n=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Qn=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(f6("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Y9(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new l6(c6.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Y9(t,n))},i.onupgradeneeded=function(t){f6("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Mn.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){f6("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return n.Wn(t)}),this.db)]}}))}))},t.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Object(uR.d)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.Qn(t)];case 2:return a.db=h.sent(),e=J9.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),$9.reject(t)})).xn(),u={},s.catch((function(){})),[4,e.Gn];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return f6("SimpleDb","Transaction failed with error:",(c=h.sent()).message,"Retrying:",l="FirebaseError"!==c.name&&o<3),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),X9=function(){function t(t){this.zn=t,this.Hn=!1,this.Jn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Jn=t},t.prototype.delete=function(){return ttt(this.zn.delete())},t}(),Y9=function(t){function e(e,n){var r=this;return(r=t.call(this,c6.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(uR.c)(e,t),e}(l6);function Q9(t){return"IndexedDbTransactionError"===t.name}var J9=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new H9,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new Y9(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=ntt(e.target.error);n.Zn.reject(new Y9(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Y9(n,e)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(f6("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Z9(e)},t}(),Z9=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(f6("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(f6("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ttt(n)},t.prototype.add=function(t){return f6("SimpleDb","ADD",this.store.name,t,t),ttt(this.store.add(t))},t.prototype.get=function(t){var e=this;return ttt(this.store.get(t)).next((function(n){return void 0===n&&(n=null),f6("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return f6("SimpleDb","DELETE",this.store.name,t),ttt(this.store.delete(t))},t.prototype.count=function(){return f6("SimpleDb","COUNT",this.store.name),ttt(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){f6("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new $9((function(n,r){e.onerror=function(t){var e=ntt(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new $9((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new X9(i),s=e(i.primaryKey,i.value,o);if(s instanceof $9){var a=s.catch((function(t){return o.done(),$9.reject(t)}));n.push(a)}o.Sn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return $9.kn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ttt(t){return new $9((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ntt(t.target.error);n(e)}}))}var ett=!1;function ntt(t){var e=K9.$n(Object(l2.p)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new l6("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ett||(ett=!0,setTimeout((function(){throw r}),0)),r}}return t}function rtt(){return"undefined"!=typeof window?window:null}function itt(){return"undefined"!=typeof document?document:null}var ott=function(){function t(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new H9,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new l6(c6.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.hs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},t}(),stt=function(){function t(){var t=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new G9(this,"async_queue_retry"),this.ys=function(){var e=itt();e&&f6("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.Vs.yn()};var e=itt();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=itt();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Ts.push(t),e.Ns()}))},t.prototype.Ns=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e=this;return Object(uR.d)(this,(function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!Q9(t=n.sent()))throw t;return f6("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.Vs.Pn((function(){return e.Ns()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Es.then((function(){return e.Ps=!0,t().catch((function(t){throw e.Rs=t,e.Ps=!1,p6("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ps=!1,t}))}));return this.Es=n,n},t.prototype.Vn=function(t,e,n){var r=this;this.vs(),this.gs.indexOf(t)>-1&&(e=0);var i=ott._s(this,t,e,n,(function(t){return r.xs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&v6()},t.prototype.Fs=function(){},t.prototype.ks=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t;return Object(uR.d)(this,(function(e){switch(e.label){case 0:return[4,t=this.Es];case 1:e.sent(),e.label=2;case 2:if(t!==this.Es)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.ks().then((function(){e.As.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.ks()}))},t.prototype.$s=function(t){this.gs.push(t)},t.prototype.xs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function att(t,e){if(p6("AsyncQueue",e+": "+t),Q9(t))return new l6(c6.UNAVAILABLE,e+": "+t);throw t}var utt=function(){this.Ls=void 0,this.listeners=[]},ctt=function(){this.Bs=new M6((function(t){return S9(t)}),E9),this.onlineState="Unknown",this.qs=new Set};function ltt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:if(n=b6(t),i=!1,(o=n.Bs.get(r=e.query))||(i=!0,o=new utt),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Us(r)];case 2:return s.Ls=c.sent(),[3,4];case 3:return a=c.sent(),u=att(a,"Initialization of query '"+I9(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.Bs.set(r,o),o.listeners.push(e),e.Ks(n.onlineState),o.Ls&&e.Qs(o.Ls)&&ptt(n),[2]}}))}))}function htt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){return n=b6(t),i=!1,(o=n.Bs.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.Bs.delete(r),n.Ws(r))]:[2]}))}))}function dtt(t,e){for(var n=b6(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.Bs.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Qs(s)&&(r=!0);a.Ls=s}}r&&ptt(n)}function ftt(t,e,n){var r=b6(t),i=r.Bs.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Bs.delete(e)}function ptt(t){t.qs.forEach((function(t){t.next()}))}var mtt=function(){function t(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new w8(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},t.prototype.Js=function(t,e){return!t.fromCache||!(this.options.Xs&&"Offline"!==e||t.docs.P()&&"Offline"!==e)},t.prototype.Hs=function(t){return t.docChanges.length>0||!!(t.Wt||this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=w8.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},t}(),gtt=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();gtt.UNAUTHENTICATED=new gtt(null),gtt.ei=new gtt("google-credentials-uid"),gtt.ni=new gtt("first-party-uid");var vtt=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}return t.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},t}();function ytt(t,e){return"firestore_clients_"+t+"_"+e}function btt(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function wtt(t,e){return"firestore_targets_"+t+"_"+e}vtt.ai=-1;var _tt=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.hi=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new l6(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(p6("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xtt=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.hi=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new l6(r.error.code,r.error.message)),i?new t(e,r.state,o):(p6("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ctt=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.hi=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=v8(),s=0;i&&s<r.activeTargetIds.length;++s)i=H6(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(p6("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Ett=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.hi=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(p6("SharedClientState","Failed to parse online state: "+e),null)},t}(),Stt=function(){function t(){this.activeTargetIds=v8()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Itt=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new r8(x6),this.Ii=!1,this.mi=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=ytt(this.persistenceKey,this._i),this.Ri=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ti=this.Ti.ot(this._i,new Stt),this.Pi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l=this;return Object(uR.d)(this,(function(h){switch(h.label){case 0:return[4,this.fi.pi()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(ytt(this.persistenceKey,r)))&&(o=Ctt.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.yi))&&(a=this.vi(s))&&this.Si(a),u=0,c=this.mi;u<c.length;u++)this.Ei(c[u]);return this.mi=[],this.window.addEventListener("unload",(function(){return l.Di()})),this.Ii=!0,[2]}}))}))},t.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},t.prototype.Ci=function(){return this.Ni(this.Ti)},t.prototype.xi=function(t){var e=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Fi=function(t){this.ki(t,"pending")},t.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},t.prototype.$i=function(t){var e="not-current";if(this.xi(t)){var n=this.storage.getItem(wtt(this.persistenceKey,t));if(n){var r=xtt.hi(t,n);r&&(e=r.state)}}return this.Li.ui(t),this.bi(),e},t.prototype.Bi=function(t){this.Li.li(t),this.bi()},t.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},t.prototype.Ui=function(t){this.removeItem(wtt(this.persistenceKey,t))},t.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.Mi(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},t.prototype.ji=function(t){this.Gi(t)},t.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return f6("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){f6("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){f6("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ei=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(f6("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void p6("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return Object(uR.b)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Object(uR.d)(this,(function(a){if(this.Ii){if(null!==n.key)if(this.Pi.test(n.key)){if(null==n.newValue)return t=this.zi(n.key),[2,this.Hi(t,null)];if(e=this.Ji(n.key,n.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(r=this.Yi(n.key,n.newValue)))return[2,this.Xi(r)]}else if(this.Vi.test(n.key)){if(null!==n.newValue&&(i=this.Zi(n.key,n.newValue)))return[2,this.tr(i)]}else if(n.key===this.yi){if(null!==n.newValue&&(o=this.vi(n.newValue)))return[2,this.Si(o)]}else n.key===this.Ri&&(s=function(t){var e=vtt.ai;if(null!=t)try{var n=JSON.parse(t);y6("number"==typeof n),e=n}catch(t){p6("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==vtt.ai&&this.si(s)}else this.mi.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),t.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},t.prototype.ki=function(t,e,n){var r=new _tt(this.currentUser,t,e,n),i=btt(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.Mi=function(t){var e=btt(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Gi=function(t){this.storage.setItem(this.yi,JSON.stringify({clientId:this._i,onlineState:t}))},t.prototype.Qi=function(t,e,n){var r=wtt(this.persistenceKey,t),i=new xtt(t,e,n);this.setItem(r,i.ci())},t.prototype.zi=function(t){var e=this.Pi.exec(t);return e?e[1]:null},t.prototype.Ji=function(t,e){var n=this.zi(t);return Ctt.hi(n,e)},t.prototype.Yi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return _tt.hi(new gtt(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Zi=function(t,e){var n=this.Vi.exec(t),r=Number(n[1]);return xtt.hi(r,e)},t.prototype.vi=function(t){return Ett.hi(t)},t.prototype.Xi=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fi.er(t.batchId,t.state,t.error)]:(f6("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},t.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.fi.sr(s,a).then((function(){n.Ti=r}))},t.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},t.prototype.Ni=function(t){var e=v8();return t.forEach((function(t,n){e=e.Ot(n.activeTargetIds)})),e},t}(),ktt=function(){function t(){this.ir=new Stt,this.rr={},this.di=null,this.si=null}return t.prototype.Fi=function(t){},t.prototype.Oi=function(t,e,n){},t.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},t.prototype.Ki=function(t,e,n){this.rr[t]=e},t.prototype.Bi=function(t){this.ir.li(t)},t.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.Ui=function(t){delete this.rr[t]},t.prototype.Ci=function(){return this.ir.activeTargetIds},t.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.start=function(){return this.ir=new Stt,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Di=function(){},t.prototype.oi=function(t){},t}(),Ttt=function(){function t(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}return t.prototype.hr=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=H7(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=G7(i,e,e,this.ar))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=G7(u,e,o,this.ar))}return e},t.prototype.lr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),m8())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&C6(this.mutations,t.mutations,(function(t,e){return K7(t,e)}))&&C6(this.baseMutations,t.baseMutations,(function(t,e){return K7(t,e)}))},t}(),Att=function(){function t(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}return t.from=function(e,n,r){y6(e.mutations.length===r.length);for(var i=f8,o=e.mutations,s=0;s<o.length;s++)i=i.ot(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Rtt=function(){function t(){this.wr=new M6((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Er=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),t.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},t.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},t.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?$9.resolve(n):this.Pr(t,e)},t.prototype.getEntries=function(t,e){return this.gr(t,e)},t.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},t.prototype.mr=function(){},t}(),Ott="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ntt=function(){function t(){this.yr=[]}return t.prototype.pr=function(t){this.yr.push(t)},t.prototype.br=function(){this.yr.forEach((function(t){return t()}))},t}(),Dtt=function(){function t(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}return t.prototype.Cr=function(t,e){var n=this;return this.Sr.Nr(t,e).next((function(r){return n.Fr(t,e,r)}))},t.prototype.Fr=function(t,e,n){return this.vr.Rr(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.kr=function(t,e,n){var r=l8();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.ot(t,e)})),r},t.prototype.Or=function(t,e){var n=this;return this.vr.getEntries(t,e).next((function(e){return n.Mr(t,e)}))},t.prototype.Mr=function(t,e){var n=this;return this.Sr.$r(t,e).next((function(r){var i=n.kr(t,e,r),o=c8();return i.forEach((function(t,e){e||(e=new c9(t,L6.min())),o=o.ot(t,e)})),o}))},t.prototype.Lr=function(t,e,n){return function(t){return z6.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Br(t,e.path):y9(e)?this.qr(t,e,n):this.Ur(t,e,n)},t.prototype.Br=function(t,e){return this.Cr(t,new z6(e)).next((function(t){var e=d8();return t instanceof u9&&(e=e.ot(t.key,t)),e}))},t.prototype.qr=function(t,e,n){var r=this,i=e.collectionGroup,o=d8();return this.Dr.Kr(t,i).next((function(s){return $9.forEach(s,(function(s){var a=function(t,e){return new h9(e,null,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(e,s.child(i));return r.Ur(t,a,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ur=function(t,e,n){var r,i,o=this;return this.vr.Lr(t,e,n).next((function(n){return r=n,o.Sr.Qr(t,e)})).next((function(e){return o.Wr(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c),h=G7(u,l,l,o.ar);r=h instanceof u9?r.ot(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){k9(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=m8(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Q7&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.vr.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof u9&&(c=c.ot(t,e))})),c}))},t}(),Ptt=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}return t.zr=function(e,n){for(var r=m8(),i=m8(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function Mtt(t,e){var n=t[1],r=e[1],i=x6(t[0],e[0]);return 0===i?x6(n,r):i}var Ftt=function(){function t(t){this.Hr=t,this.buffer=new s8(Mtt),this.Jr=0}return t.prototype.Yr=function(){return++this.Jr},t.prototype.Xr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Mtt(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ltt={Zr:!1,eo:0,no:0,so:0},Btt=function(){function t(t,e,n){this.io=t,this.ro=e,this.oo=n}return t.ao=function(e){return new t(e,t.ho,t.co)},t}();Btt.uo=-1,Btt.lo=1048576,Btt._o=41943040,Btt.ho=10,Btt.co=1e3,Btt.fo=new Btt(Btt._o,Btt.ho,Btt.co),Btt.do=new Btt(Btt.uo,0,0);var jtt=function(){function t(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}return t.prototype.start=function(t){this.wo.params.io!==Btt.uo&&this.Io(t)},t.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(t.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),t.prototype.Io=function(t){var e=this,n=this.Eo?3e5:6e4;f6("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.hs.Vn("lru_garbage_collection",n,(function(){return Object(uR.b)(e,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:this.To=null,this.Eo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mo(this.wo)];case 2:return n.sent(),[3,7];case 3:return Q9(e=n.sent())?(f6("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,snt(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Io(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Vtt=function(){function t(t,e){this.Ao=t,this.params=e}return t.prototype.Ro=function(t,e){return this.Ao.Po(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Vo=function(t,e){var n=this;if(0===e)return $9.resolve(vtt.ai);var r=new Ftt(e);return this.Ao.Ce(t,(function(t){return r.Xr(t.sequenceNumber)})).next((function(){return n.Ao.yo(t,(function(t){return r.Xr(t)}))})).next((function(){return r.maxValue}))},t.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},t.prototype.bo=function(t,e){return this.Ao.bo(t,e)},t.prototype.vo=function(t,e){var n=this;return this.params.io===Btt.uo?(f6("LruGarbageCollector","Garbage collection skipped; disabled"),$9.resolve(Ltt)):this.So(t).next((function(r){return r<n.params.io?(f6("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),Ltt):n.Do(t,e)}))},t.prototype.So=function(t){return this.Ao.So(t)},t.prototype.Do=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.Ro(t,this.params.ro).next((function(e){return e>c.params.oo?(f6("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.oo+" from "+e),r=c.params.oo):r=e,o=Date.now(),c.Vo(t,r)})).next((function(r){return n=r,s=Date.now(),c.po(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.bo(t,n)})).next((function(t){return u=Date.now(),d6()<=c2.a.DEBUG&&f6("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),$9.resolve({Zr:!0,eo:r,no:i,so:t})}))},t}();function Utt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Wtt(e)),e=ztt(t.get(n),e);return Wtt(e)}function ztt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Wtt(t){return t+"\x01\x01"}function qtt(t){var e=t.length;if(y6(e>=2),2===e)return y6("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),j6.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&v6(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:v6()}o=s+2}return new j6(r)}var Htt=function(t){this.Co=t};function Gtt(t,e){if(e.document)return function(t,e,n){var r=a7(t,e.name),i=r7(e.updateTime),o=new i9({mapValue:{fields:e.fields}});return new u9(r,i,o,{hasCommittedMutations:!!n})}(t.Co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=z6.Z(e.noDocument.path),r=Qtt(e.noDocument.readTime);return new c9(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=z6.Z(e.unknownDocument.path),o=Qtt(e.unknownDocument.version);return new l9(i,o)}return v6()}function $tt(t,e,n){var r=Ktt(n),i=e.key.path.F().L();if(e instanceof u9){var o=function(t,e){return{name:s7(t,e.key),fields:e.rn().mapValue.fields,updateTime:t7(t,e.version.v())}}(t.Co,e);return new Eet(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof c9){var s=e.key.path.L(),a=Ytt(e.version),u=e.hasCommittedMutations;return new Eet(null,new xet(s,a),null,u,r,i)}if(e instanceof l9){var c=e.key.path.L(),l=Ytt(e.version);return new Eet(new Cet(c,l),null,null,!0,r,i)}return v6()}function Ktt(t){var e=t.v();return[e.seconds,e.nanoseconds]}function Xtt(t){var e=new F6(t[0],t[1]);return L6.V(e)}function Ytt(t){var e=t.v();return new vet(e.seconds,e.nanoseconds)}function Qtt(t){var e=new F6(t.seconds,t.nanoseconds);return L6.V(e)}function Jtt(t,e){var n=(e.baseMutations||[]).map((function(e){return p7(t.Co,e)})),r=e.mutations.map((function(e){return p7(t.Co,e)})),i=F6.fromMillis(e.localWriteTimeMs);return new Ttt(e.batchId,i,n,r)}function Ztt(t){var e,n,r=Qtt(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Qtt(t.lastLimboFreeSnapshotVersion):L6.min();return void 0!==t.query.documents?(y6(1===(n=t.query).documents.length),e=w9(f9(c7(n.documents[0])))):e=function(t){var e=c7(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){y6(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[E7(e)]:void 0!==e.fieldFilter?[C7(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):v6():[]}(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new z9(x7(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return W6(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=y7(n.startAt));var l=null;return n.endAt&&(l=y7(n.endAt)),w9(d9(e,i,a,s,u,"F",c,l))}(t.query),new Z6(e,t.targetId,0,t.lastListenSequenceNumber,r,i,S6.fromBase64String(t.resumeToken))}function tet(t,e){var n,r=Ytt(e.nt),i=Ytt(e.lastLimboFreeSnapshotVersion);n=Y6(e.target)?m7(t.Co,e.target):g7(t.Co,e.target);var o=e.resumeToken.toBase64();return new ket(e.targetId,K6(e.target),r,o,e.sequenceNumber,i,n)}var eet=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}return t.Fo=function(e,n,r,i){return y6(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.ko=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return iet(t).rs({index:wet.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Oo=function(t,e,n,r){var i=this,o=oet(t),s=iet(t);return s.add({}).next((function(a){y6("number"==typeof a);for(var u=new Ttt(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return f7(t.Co,e)})),i=n.mutations.map((function(e){return f7(t.Co,e)}));return new wet(e,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,u),l=[],h=new s8((function(t,e){return x6(t.B(),e.B())})),d=0,f=r;d<f.length;d++){var p=f[d],m=_et.key(i.userId,p.key.path,a);h=h.add(p.key.path.F()),l.push(s.put(c)),l.push(o.put(m,_et.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Dr.Mo(t,e))})),t.pr((function(){i.xo[a]=u.keys()})),$9.kn(l).next((function(){return u}))}))},t.prototype.$o=function(t,e){var n=this;return iet(t).get(e).next((function(t){return t?(y6(t.userId===n.userId),Jtt(n.serializer,t)):null}))},t.prototype.Lo=function(t,e){var n=this;return this.xo[e]?$9.resolve(this.xo[e]):this.$o(t,e).next((function(t){if(t){var r=t.keys();return n.xo[e]=r,r}return null}))},t.prototype.Bo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return iet(t).rs({index:wet.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(y6(e.batchId>=r),o=Jtt(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return iet(t).rs({index:wet.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return iet(t).ts(wet.userMutationsIndex,n).next((function(t){return t.map((function(t){return Jtt(e.serializer,t)}))}))},t.prototype.Nr=function(t,e){var n=this,r=_et.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return oet(t).rs({range:i},(function(r,i,s){var a=r[0],u=r[2],c=qtt(r[1]);if(a===n.userId&&e.path.isEqual(c))return iet(t).get(u).next((function(t){if(!t)throw v6();y6(t.userId===n.userId),o.push(Jtt(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.$r=function(t,e){var n=this,r=new s8(x6),i=[];return e.forEach((function(e){var o=_et.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=oet(t).rs({range:s},(function(t,i,o){var s=t[0],a=t[2],u=qtt(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()}));i.push(a)})),$9.kn(i).next((function(){return n.Ko(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=_et.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new s8(x6);return oet(t).rs({range:s},(function(t,e,o){var s=t[0],u=t[2],c=qtt(t[1]);s===n.userId&&r.M(c)?c.length===i&&(a=a.add(u)):o.done()})).next((function(){return n.Ko(t,a)}))},t.prototype.Ko=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(iet(t).get(e).next((function(t){if(null===t)throw v6();y6(t.userId===n.userId),r.push(Jtt(n.serializer,t))})))})),$9.kn(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return ret(t.Wo,this.userId,e).next((function(r){return t.pr((function(){n.jo(e.batchId)})),$9.forEach(r,(function(e){return n.No.Go(t,e)}))}))},t.prototype.jo=function(t){delete this.xo[t]},t.prototype.zo=function(t){var e=this;return this.ko(t).next((function(n){if(!n)return $9.resolve();var r=IDBKeyRange.lowerBound(_et.prefixForUser(e.userId)),i=[];return oet(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=qtt(t[1]);i.push(o)}else r.done()})).next((function(){y6(0===i.length)}))}))},t.prototype.Ho=function(t,e){return net(t,this.userId,e)},t.prototype.Jo=function(t){var e=this;return set(t).get(this.userId).next((function(t){return t||new bet(e.userId,-1,"")}))},t}();function net(t,e,n){var r=_et.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return oet(t).rs({range:o,ss:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function ret(t,e,n){var r=t.store(wet.store),i=t.store(_et.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.rs({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){y6(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var d=h[l],f=_et.key(e,d.key.path,n.batchId);o.push(i.delete(f)),c.push(d.key)}return $9.kn(o).next((function(){return c}))}function iet(t){return Wet.Kn(t,wet.store)}function oet(t){return Wet.Kn(t,_et.store)}function set(t){return Wet.Kn(t,bet.store)}var aet=function(){function t(t,e){this.serializer=t,this.Dr=e}return t.prototype.Ir=function(t,e,n){return het(t).put(det(e),n)},t.prototype.Ar=function(t,e){var n=het(t),r=det(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Rr=function(t,e){var n=this;return het(t).get(det(e)).next((function(t){return n.Xo(t)}))},t.prototype.Zo=function(t,e){var n=this;return het(t).get(det(e)).next((function(t){var e=n.Xo(t);return e?{ta:e,size:fet(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=l8();return this.ea(t,e,(function(t,e){var i=n.Xo(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype.na=function(t,e){var n=this,r=l8(),i=new r8(z6.D);return this.ea(t,e,(function(t,e){var o=n.Xo(e);o?(r=r.ot(t,o),i=i.ot(t,fet(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{sa:r,ia:i}}))},t.prototype.ea=function(t,e,n){if(e.P())return $9.resolve();var r=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),i=e._t(),o=i.It();return het(t).rs({range:r},(function(t,e,r){for(var s=z6.Z(t);o&&z6.D(o,s)<0;)n(o,null),o=i.It();o&&o.isEqual(s)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.L()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Lr=function(t,e,n){var r=this,i=d8(),o=e.path.length+1,s={};if(n.isEqual(L6.min())){var a=e.path.L();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.L(),c=Ktt(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Eet.collectionReadTimeIndex}return het(t).rs(s,(function(t,n,s){if(t.length===o){var a=Gtt(r.serializer,n);e.path.M(a.key.path)?a instanceof u9&&k9(e,a)&&(i=i.ot(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.ra=function(t){return new uet(this,!!t&&t.oa)},t.prototype.aa=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return cet(t).get(Iet.key).next((function(t){return y6(!!t),t}))},t.prototype.Yo=function(t,e){return cet(t).put(Iet.key,e)},t.prototype.Xo=function(t){if(t){var e=Gtt(this.serializer,t);return e instanceof c9&&e.version.isEqual(L6.min())?null:e}return null},t}(),uet=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ha=e,r.oa=n,r.ca=new M6((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(uR.c)(e,t),e.prototype.Vr=function(t){var e=this,n=[],r=0,i=new s8((function(t,e){return x6(t.B(),e.B())}));return this.wr.forEach((function(o,s){var a=e.ca.get(o);if(s){var u=$tt(e.ha.serializer,s,e.readTime);i=i.add(o.path.F());var c=fet(u);r+=c-a,n.push(e.ha.Ir(t,o,u))}else if(r-=a,e.oa){var l=$tt(e.ha.serializer,new c9(o,L6.min()),e.readTime);n.push(e.ha.Ir(t,o,l))}else n.push(e.ha.Ar(t,o))})),i.forEach((function(r){n.push(e.ha.Dr.Mo(t,r))})),n.push(this.ha.updateMetadata(t,r)),$9.kn(n)},e.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next((function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)}))},e.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next((function(t){var e=t.sa;return t.ia.forEach((function(t,e){n.ca.set(t,e)})),e}))},e}(Rtt);function cet(t){return Wet.Kn(t,Iet.store)}function het(t){return Wet.Kn(t,Eet.store)}function det(t){return t.path.L()}function fet(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw v6();e=t.noDocument}return JSON.stringify(e).length}var pet=function(){function t(){this.ua=new met}return t.prototype.Mo=function(t,e){return this.ua.add(e),$9.resolve()},t.prototype.Kr=function(t,e){return $9.resolve(this.ua.getEntries(e))},t}(),met=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new s8(j6.D),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.F(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new s8(j6.D)).L()},t}(),get=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;y6(n<r&&n>=0&&r<=10);var o=new J9("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(yet.store)}(t),function(t){t.createObjectStore(bet.store,{keyPath:bet.keyPath}),t.createObjectStore(wet.store,{keyPath:wet.keyPath,autoIncrement:!0}).createIndex(wet.userMutationsIndex,wet.userMutationsKeyPath,{unique:!0}),t.createObjectStore(_et.store)}(t),Oet(t),function(t){t.createObjectStore(Eet.store)}(t));var s=$9.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Tet.store),t.deleteObjectStore(ket.store),t.deleteObjectStore(Aet.store)}(t),Oet(t)),s=s.next((function(){return function(t){var e=t.store(Aet.store),n=new Aet(0,0,L6.min().v(),0);return e.put(Aet.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(wet.store).ts().next((function(n){t.deleteObjectStore(wet.store),t.createObjectStore(wet.store,{keyPath:wet.keyPath,autoIncrement:!0}).createIndex(wet.userMutationsIndex,wet.userMutationsKeyPath,{unique:!0});var r=e.store(wet.store),i=n.map((function(t){return r.put(t)}));return $9.kn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Net.store,{keyPath:Net.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Iet.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Eet.store);e.createIndex(Eet.readTimeIndex,Eet.readTimeIndexPath,{unique:!1}),e.createIndex(Eet.collectionReadTimeIndex,Eet.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Eet.store).rs((function(t,n){e+=fet(n)})).next((function(){var n=new Iet(e);return t.store(Iet.store).put(Iet.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(bet.store),r=t.store(wet.store);return n.ts().next((function(n){return $9.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(wet.userMutationsIndex,i).next((function(r){return $9.forEach(r,(function(r){y6(r.userId===n.userId);var i=Jtt(e.serializer,r);return ret(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Tet.store),n=t.store(Eet.store);return t.store(Aet.store).get(Aet.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new j6(n),s=function(t){return[0,Utt(t)]}(o);r.push(e.get(s).next((function(n){return n?$9.resolve():function(n){return e.put(new Tet(0,Utt(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return $9.kn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ret.store,{keyPath:Ret.keyPath});var n=e.store(Ret.store),r=new met,i=function(t){if(r.add(t)){var e=t.O(),i=t.F();return n.put({collectionId:e,parent:Utt(i)})}};return e.store(Eet.store).rs({ss:!0},(function(t,e){var n=new j6(t);return i(n.F())})).next((function(){return e.store(_et.store).rs({ss:!0},(function(t,e){var n=qtt(t[1]);return i(n.F())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(ket.store);return n.rs((function(t,r){var i=Ztt(r),o=tet(e.serializer,i);return n.put(o)}))},t}(),vet=function(t,e){this.seconds=t,this.nanoseconds=e},yet=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};yet.store="owner",yet.key="owner";var bet=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};bet.store="mutationQueues",bet.keyPath="userId";var wet=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};wet.store="mutations",wet.keyPath="batchId",wet.userMutationsIndex="userMutationsIndex",wet.userMutationsKeyPath=["userId","batchId"];var _et=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Utt(e)]},t.key=function(t,e,n){return[t,Utt(e),n]},t}();_et.store="documentMutations",_et.PLACEHOLDER=new _et;var xet=function(t,e){this.path=t,this.readTime=e},Cet=function(t,e){this.path=t,this.version=e},Eet=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Eet.store="remoteDocuments",Eet.readTimeIndex="readTimeIndex",Eet.readTimeIndexPath="readTime",Eet.collectionReadTimeIndex="collectionReadTimeIndex",Eet.collectionReadTimeIndexPath=["parentPath","readTime"];var Iet=function(t){this.byteSize=t};Iet.store="remoteDocumentGlobal",Iet.key="remoteDocumentGlobalKey";var ket=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ket.store="targets",ket.keyPath="targetId",ket.queryTargetsIndexName="queryTargetsIndex",ket.queryTargetsKeyPath=["canonicalId","targetId"];var Tet=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Tet.store="targetDocuments",Tet.keyPath=["targetId","path"],Tet.documentTargetsIndex="documentTargetsIndex",Tet.documentTargetsKeyPath=["path","targetId"];var Aet=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Aet.key="targetGlobalKey",Aet.store="targetGlobal";var Ret=function(t,e){this.collectionId=t,this.parent=e};function Oet(t){t.createObjectStore(Tet.store,{keyPath:Tet.keyPath}).createIndex(Tet.documentTargetsIndex,Tet.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ket.store,{keyPath:ket.keyPath}).createIndex(ket.queryTargetsIndexName,ket.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Aet.store)}Ret.store="collectionParents",Ret.keyPath=["collectionId","parent"];var Net=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Net.store="clientMetadata",Net.keyPath="clientId";var Det=Object(uR.g)(Object(uR.g)(Object(uR.g)([bet.store,wet.store,_et.store,Eet.store,ket.store,yet.store,Aet.store,Tet.store],[Net.store]),[Iet.store]),[Ret.store]),Pet=function(){function t(){this.la=new met}return t.prototype.Mo=function(t,e){var n=this;if(!this.la.has(e)){var r=e.O(),i=e.F();t.pr((function(){n.la.add(e)}));var o={collectionId:r,parent:Utt(i)};return Met(t).put(o)}return $9.resolve()},t.prototype.Kr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[E6(e),""],!1,!0);return Met(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(qtt(o.parent))}return n}))},t}();function Met(t){return Wet.Kn(t,Ret.store)}var Fet=function(){function t(t){this._a=t}return t.prototype.next=function(){return this._a+=2,this._a},t.fa=function(){return new t(0)},t.da=function(){return new t(-1)},t}(),Let=function(){function t(t,e){this.No=t,this.serializer=e}return t.prototype.wa=function(t){var e=this;return this.Ea(t).next((function(n){var r=new Fet(n.highestTargetId);return n.highestTargetId=r.next(),e.Ta(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ia=function(t){return this.Ea(t).next((function(t){return L6.V(new F6(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ma=function(t){return this.Ea(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Aa=function(t,e,n){var r=this;return this.Ea(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.v()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ta(t,i)}))},t.prototype.Ra=function(t,e){var n=this;return this.Pa(t,e).next((function(){return n.Ea(t).next((function(r){return r.targetCount+=1,n.ga(e,r),n.Ta(t,r)}))}))},t.prototype.Va=function(t,e){return this.Pa(t,e)},t.prototype.ya=function(t,e){var n=this;return this.pa(t,e.targetId).next((function(){return Bet(t).delete(e.targetId)})).next((function(){return n.Ea(t)})).next((function(e){return y6(e.targetCount>0),e.targetCount-=1,n.Ta(t,e)}))},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return Bet(t).rs((function(s,a){var u=Ztt(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.ya(t,u)))})).next((function(){return $9.kn(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return Bet(t).rs((function(t,n){var r=Ztt(n);e(r)}))},t.prototype.Ea=function(t){return jet(t).get(Aet.key).next((function(t){return y6(null!==t),t}))},t.prototype.Ta=function(t,e){return jet(t).put(Aet.key,e)},t.prototype.Pa=function(t,e){return Bet(t).put(tet(this.serializer,e))},t.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.ba=function(t){return this.Ea(t).next((function(t){return t.targetCount}))},t.prototype.va=function(t,e){var n=K6(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Bet(t).rs({range:r,index:ket.queryTargetsIndexName},(function(t,n,r){var o=Ztt(n);X6(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Sa=function(t,e,n){var r=this,i=[],o=Vet(t);return e.forEach((function(e){var s=Utt(e.path);i.push(o.put(new Tet(n,s))),i.push(r.No.Da(t,n,e))})),$9.kn(i)},t.prototype.Ca=function(t,e,n){var r=this,i=Vet(t);return $9.forEach(e,(function(e){var o=Utt(e.path);return $9.kn([i.delete([n,o]),r.No.Na(t,n,e)])}))},t.prototype.pa=function(t,e){var n=Vet(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xa=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Vet(t),i=m8();return r.rs({range:n,ss:!0},(function(t,e,n){var r=qtt(t[1]),o=new z6(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ho=function(t,e){var n=Utt(e.path),r=IDBKeyRange.bound([n],[E6(n)],!1,!0),i=0;return Vet(t).rs({index:Tet.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return Bet(t).get(e).next((function(t){return t?Ztt(t):null}))},t}();function Bet(t){return Wet.Kn(t,ket.store)}function jet(t){return Wet.Kn(t,Aet.store)}function Vet(t){return Wet.Kn(t,Tet.store)}var Uet="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",zet=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Fa=n,r}return Object(uR.c)(e,t),e}(Ntt),Wet=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=s,this.document=a,this.ka=c,this.Oa=l,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.Ln())throw new l6(c6.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new Get(this,i),this.Qa=n+"main",this.serializer=new Htt(u),this.Wa=new K9(this.Qa,10,new get(this.serializer)),this.ja=new Let(this.No,this.serializer),this.Dr=new Pet,this.vr=function(t,e){return new aet(t,e)}(this.serializer,this.Dr),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===l&&p6("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Kn=function(t,e){if(t instanceof zet)return K9.Kn(t.Wo,e);throw v6()},t.prototype.start=function(){var t=this;return this.za().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new l6(c6.FAILED_PRECONDITION,Uet);return t.Ha(),t.Ja(),t.Ya(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.ja.ma(e)}))})).then((function(e){t.Ma=new vtt(e,t.ka)})).then((function(){t.$a=!0})).catch((function(e){return t.Wa&&t.Wa.close(),Promise.reject(e)}))},t.prototype.Xa=function(t){var e=this;return this.Ka=function(n){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return this.Ii?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Za=function(t){var e=this;this.Wa.jn((function(n){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.za=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Het(e).put(new Net(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.eh(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.Ka(!1)})))}))})).next((function(){return t.nh(e)})).next((function(n){return t.isPrimary&&!n?t.sh(e).next((function(){return!1})):!!n&&t.ih(e).next((function(){return!0}))}))})).catch((function(e){if(Q9(e))return f6("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return f6("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.eh=function(t){var e=this;return qet(t).get(yet.key).next((function(t){return $9.resolve(e.rh(t))}))},t.prototype.oh=function(t){return Het(t).delete(this.clientId)},t.prototype.ah=function(){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i=this;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Kn(e,Net.store);return n.ts().next((function(t){var e=i.uh(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return $9.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)this.Ga.removeItem(this.lh(r[n].clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,(function(){return t.za().then((function(){return t.ah()})).then((function(){return t.Ya()}))}))},t.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nh=function(t){var e=this;return this.Oa?$9.resolve(!0):qet(t).get(yet.key).next((function(n){if(null!==n&&e.hh(n.leaseTimestampMs,5e3)&&!e._h(n.ownerId)){if(e.rh(n)&&e.networkEnabled)return!0;if(!e.rh(n)){if(!n.allowTabSynchronization)throw new l6(c6.FAILED_PRECONDITION,Uet);return!1}}return!(!e.networkEnabled||!e.inForeground)||Het(t).ts().next((function(t){return void 0===e.uh(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&f6("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Di=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t=this;return Object(uR.d)(this,(function(e){switch(e.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[yet.store,Net.store],(function(e){var n=new zet(e,vtt.ai);return t.sh(n).next((function(){return t.oh(n)}))}))];case 1:return e.sent(),this.Wa.close(),this.Eh(),[2]}}))}))},t.prototype.uh=function(t,e){var n=this;return t.filter((function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)}))},t.prototype.pi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Het(e).ts().next((function(e){return t.uh(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Th=function(t){return eet.Fo(t,this.serializer,this.Dr,this.No)},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.Ah=function(){return this.Dr},t.prototype.runTransaction=function(t,e,n){var r,i=this;return f6("IndexedDbPersistence","Starting transaction:",t),this.Wa.runTransaction(t,"readonly"===e?"readonly":"readwrite",Det,(function(o){return r=new zet(o,i.Ma?i.Ma.next():vtt.ai),"readwrite-primary"===e?i.eh(r).next((function(t){return!!t||i.nh(r)})).next((function(e){if(!e)throw p6("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.fn.Cs((function(){return i.Ka(!1)})),new l6(c6.FAILED_PRECONDITION,Ott);return n(r)})).next((function(t){return i.ih(r).next((function(){return t}))})):i.Rh(r).next((function(){return n(r)}))})).then((function(t){return r.br(),t}))},t.prototype.Rh=function(t){var e=this;return qet(t).get(yet.key).next((function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new l6(c6.FAILED_PRECONDITION,Uet)}))},t.prototype.ih=function(t){var e=new yet(this.clientId,this.allowTabSynchronization,Date.now());return qet(t).put(yet.key,e)},t.Ln=function(){return K9.Ln()},t.prototype.sh=function(t){var e=this,n=qet(t);return n.get(yet.key).next((function(t){return e.rh(t)?(f6("IndexedDbPersistence","Releasing primary lease."),n.delete(yet.key)):$9.resolve()}))},t.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(p6("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},t.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},t.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws((function(){return e.Di()}))},this.window.addEventListener("unload",this.La))},t.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},t.prototype._h=function(t){var e;try{var n=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return f6("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return p6("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){p6("Failed to set zombie client id.",t)}},t.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},t.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function qet(t){return Wet.Kn(t,yet.store)}function Het(t){return Wet.Kn(t,Net.store)}var Get=function(){function t(t,e){this.db=t,this.wo=new Vtt(this,e)}return t.prototype.Po=function(t){var e=this.Ph(t);return this.db.Ih().ba(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Ph=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},t.prototype.yo=function(t,e){return this.gh(t,(function(t,n){return e(n)}))},t.prototype.Da=function(t,e,n){return $et(t,n)},t.prototype.Na=function(t,e,n){return $et(t,n)},t.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},t.prototype.Go=function(t,e){return $et(t,e)},t.prototype.Vh=function(t,e){return function(t,e){var n=!1;return set(t).os((function(r){return net(t,r,e).next((function(t){return t&&(n=!0),$9.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.bo=function(t,e){var n=this,r=this.db.mh().ra(),i=[],o=0;return this.gh(t,(function(s,a){if(a<=e){var u=n.Vh(t,s).next((function(e){if(!e)return o++,r.Rr(t,s).next((function(){return r.Ar(s),Vet(t).delete([0,Utt(s.path)])}))}));i.push(u)}})).next((function(){return $9.kn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.Fa);return this.db.Ih().Va(t,n)},t.prototype.yh=function(t,e){return $et(t,e)},t.prototype.gh=function(t,e){var n,r=Vet(t),i=vtt.ai;return r.rs({index:Tet.documentTargetsIndex},(function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==vtt.ai&&e(new z6(qtt(n)),i),i=s,n=o):i=vtt.ai})).next((function(){i!==vtt.ai&&e(new z6(qtt(n)),i)}))},t.prototype.So=function(t){return this.db.mh().aa(t)},t}();function $et(t,e){return Vet(t).put(function(t,e){return new Tet(0,Utt(t.path),e)}(e,t.Fa))}function Ket(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Xet=function(){function t(t,e,n){this.persistence=t,this.ph=e,this.bh=new r8(x6),this.Sh=new M6((function(t){return K6(t)}),X6),this.Dh=L6.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new Dtt(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}return t.prototype.mo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.vo(n,e.bh)}))},t}();function Yet(t,e){var n=b6(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ch.ra({oa:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=$9.resolve();return o.forEach((function(t){s=s.next((function(){return r.Rr(e,t)})).next((function(e){var o=e,s=n.dr.get(t);y6(null!==s),(!o||o.version.h(s)<0)&&(o=i.hr(t,o,n))&&r.Ir(o,n._r)}))})),s.next((function(){return t.Sr.Qo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Nh.Or(t,r)}))}))}function Qet(t){var e=b6(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ja.Ia(t)}))}function Jet(t,e){var n=b6(t),r=e.nt,i=n.bh;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ch.ra({oa:!0});i=n.bh;var s=[];e.zt.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.ja.Ca(t,e.se,o).next((function(){return n.ja.Sa(t,e.ee,o)})));var u=e.resumeToken;if(u.o()>0){var c=a.it(u,r).st(t.Fa);i=i.ot(o,c),function(t,e,n){return y6(e.resumeToken.o()>0),0===t.resumeToken.o()||e.nt.p()-t.nt.p()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(a,c,e)&&s.push(n.ja.Va(t,c))}}}));var a=c8(),u=m8();if(e.Jt.forEach((function(t,e){u=u.add(t)})),s.push(o.getEntries(t,u).next((function(i){e.Jt.forEach((function(u,c){var l=i.get(u);c instanceof c9&&c.version.isEqual(L6.min())?(o.Ar(u,r),a=a.ot(u,c)):null==l||c.version.h(l.version)>0||0===c.version.h(l.version)&&l.hasPendingWrites?(o.Ir(c,r),a=a.ot(u,c)):f6("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.Yt.has(u)&&s.push(n.persistence.No.yh(t,u))}))}))),!r.isEqual(L6.min())){var c=n.ja.Ia(t).next((function(e){return n.ja.Aa(t,t.Fa,r)}));s.push(c)}return $9.kn(s).next((function(){return o.apply(t)})).next((function(){return n.Nh.Mr(t,a)}))})).then((function(t){return n.bh=i,t}))}function Zet(t,e){var n=b6(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Sr.Bo(t,e)}))}function tnt(t,e){var n=b6(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ja.va(t,e).next((function(i){return i?$9.resolve(r=i):n.ja.wa(t).next((function(i){return r=new Z6(e,i,0,t.Fa),n.ja.Ra(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.bh.get(t.targetId);return(null===r||t.nt.h(r.nt)>0)&&(n.bh=n.bh.ot(t.targetId,t),n.Sh.set(e,t.targetId)),t}))}function ent(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:r=b6(t),i=r.bh.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.No.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Q9(s=a.sent()))throw s;return f6("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.bh=r.bh.remove(e),r.Sh.delete(i.target),[2]}}))}))}function nnt(t,e,n){var r=b6(t),i=L6.min(),o=m8();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=b6(t),i=r.Sh.get(n);return void 0!==i?$9.resolve(r.bh.get(i)):r.ja.va(e,n)}(r,t,w9(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ja.xa(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.ph.Lr(t,e,n?i:L6.min(),n?o:m8())})).next((function(t){return{documents:t,Fh:o}}))}))}function rnt(t,e){var n=b6(t),r=b6(n.ja),i=n.bh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function int(t){var e=b6(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=b6(t),i=c8(),o=Ktt(n),s=het(e),a=IDBKeyRange.lowerBound(o,!0);return s.rs({index:Eet.readTimeIndex,range:a},(function(t,e){var n=Gtt(r.serializer,e);i=i.ot(n.key,n),o=e.readTime})).next((function(){return{kh:i,readTime:Xtt(o)}}))}(e.Ch,t,e.Dh)})).then((function(t){var n=t.kh;return e.Dh=t.readTime,n}))}function ont(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){return[2,(e=b6(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=het(t),n=L6.min();return e.rs({index:Eet.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Xtt(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Dh=t}))]}))}))}function snt(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){if(t.code!==c6.FAILED_PRECONDITION||t.message!==Ott)throw t;return f6("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var ant=function(){function t(){this.Oh=new s8(unt.Mh),this.$h=new s8(unt.Lh)}return t.prototype.P=function(){return this.Oh.P()},t.prototype.Da=function(t,e){var n=new unt(t,e);this.Oh=this.Oh.add(n),this.$h=this.$h.add(n)},t.prototype.Bh=function(t,e){var n=this;t.forEach((function(t){return n.Da(t,e)}))},t.prototype.Na=function(t,e){this.qh(new unt(t,e))},t.prototype.Uh=function(t,e){var n=this;t.forEach((function(t){return n.Na(t,e)}))},t.prototype.Kh=function(t){var e=this,n=new z6(new j6([])),r=new unt(n,t),i=new unt(n,t+1),o=[];return this.$h.xt([r,i],(function(t){e.qh(t),o.push(t.key)})),o},t.prototype.Qh=function(){var t=this;this.Oh.forEach((function(e){return t.qh(e)}))},t.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},t.prototype.Wh=function(t){var e=new z6(new j6([])),n=new unt(e,t),r=new unt(e,t+1),i=m8();return this.$h.xt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ho=function(t){var e=new unt(t,0),n=this.Oh.kt(e);return null!==n&&t.isEqual(n.key)},t}(),unt=function(){function t(t,e){this.key=t,this.jh=e}return t.Mh=function(t,e){return z6.D(t.key,e.key)||x6(t.jh,e.jh)},t.Lh=function(t,e){return x6(t.jh,e.jh)||z6.D(t.key,e.key)},t}(),cnt=function(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t},lnt=function(){function t(){this.zh=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Hh=function(){},t.prototype.Jh=function(t){this.zh=t,t(gtt.UNAUTHENTICATED)},t.prototype.Yh=function(){this.zh=null},t}(),hnt=function(){function t(t){var e=this;this.Xh=null,this.currentUser=gtt.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then((function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.tc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.tc!==e?(f6("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(y6("string"==typeof n.accessToken),new cnt(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Hh=function(){this.forceRefresh=!0},t.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},t.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},t.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return y6(null===t||"string"==typeof t),new gtt(t)},t}(),dnt=function(){function t(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=gtt.ni}return Object.defineProperty(t.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),fnt=function(){function t(t,e){this.nc=t,this.sc=e}return t.prototype.getToken=function(){return Promise.resolve(new dnt(this.nc,this.sc))},t.prototype.Jh=function(t){t(gtt.ni)},t.prototype.Yh=function(){},t.prototype.Hh=function(){},t}(),pnt=function(){function t(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new G9(t,e)}return t.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.uc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.lc()},t.prototype.stop=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype._c=function(){this.state=0,this.Vs.reset()},t.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,(function(){return t.dc()})))},t.prototype.wc=function(t){this.Ec(),this.stream.send(t)},t.prototype.dc=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){return this.uc()?[2,this.close(0)]:[2]}))}))},t.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},t.prototype.close=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(n){switch(n.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==t?this.Vs.reset():e&&e.code===c6.RESOURCE_EXHAUSTED?(p6(e.toString()),p6("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):e&&e.code===c6.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ic(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Tc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.mc(this.ac),n=this.ac;this.oc.getToken().then((function(e){t.ac===n&&t.Ac(e)}),(function(n){e((function(){var e=new l6(c6.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Rc(e)}))}))},t.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc((function(){n((function(){return e.state=2,e.listener.gc()}))})),this.stream.Ic((function(t){n((function(){return e.Rc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn((function(){return Object(uR.b)(t,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Rc=function(t){return f6("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.mc=function(t){var e=this;return function(n){e.fn.ws((function(){return e.ac===t?n():(f6("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),mnt=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(uR.c)(e,t),e.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},e.prototype.onMessage=function(t){this.Vs.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:v6()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ke?(y6(void 0===e||"string"==typeof e),S6.fromBase64String(e||"")):(y6(void 0===e||e instanceof Uint8Array),S6.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(t){var e=void 0===t.code?c6.UNKNOWN:n8(t.code);return new l6(e,t.message||"")}(s);n=new S8(r,i,o,a||null)}else if("documentChange"in e){var u=e.documentChange,c=a7(t,u.document.name),l=r7(u.document.updateTime),h=new i9({mapValue:{fields:u.document.fields}}),d=new u9(c,l,h,{});n=new C8(u.targetIds||[],u.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){var f=e.documentDelete,p=a7(t,f.document),m=f.readTime?r7(f.readTime):L6.min(),g=new c9(p,m);n=new C8([],f.removedTargetIds||[],g.key,g)}else if("documentRemove"in e){var v=e.documentRemove,y=a7(t,v.document);n=new C8([],v.removedTargetIds||[],y,null)}else{if(!("filter"in e))return v6();var b=e.filter,w=new t8(b.count||0);n=new E8(b.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return L6.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?L6.min():e.readTime?r7(e.readTime):L6.min()}(t);return this.listener.yc(e,n)},e.prototype.bc=function(t){var e={};e.database=l7(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Y6(r)?{documents:m7(t,r)}:{query:g7(t,r)}).targetId=e.targetId,e.resumeToken.o()>0&&(n.resumeToken=e7(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return v6()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.wc(e)},e.prototype.vc=function(t){var e={};e.database=l7(this.serializer),e.removeTarget=t,this.wc(e)},e}(pnt),gnt=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Sc=!1,s}return Object(uR.c)(e,t),Object.defineProperty(e.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Tc=function(){this.Sc&&this.Cc([])},e.prototype.Pc=function(t){return this.rc.Vc("Write",t)},e.prototype.onMessage=function(t){if(y6(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=function(t,e){return t&&t.length>0?(y6(void 0!==e),t.map((function(t){return function(t,e){var n=r7(t.updateTime?t.updateTime:e);n.isEqual(L6.min())&&(n=r7(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new U7(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=r7(t.commitTime);return this.listener.Nc(n,e)}return y6(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},e.prototype.Fc=function(){var t={};t.database=l7(this.serializer),this.wc(t)},e.prototype.Cc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return f7(e.serializer,t)}))};this.wc(n)},e}(pnt),vnt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.rc=n,i.serializer=r,i.kc=!1,i}return Object(uR.c)(e,t),e.prototype.Oc=function(){if(this.kc)throw new l6(c6.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mc=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.Mc(t,e,n,i)})).catch((function(t){throw t.code===c6.UNAUTHENTICATED&&r.credentials.Hh(),t}))},e.prototype.$c=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.$c(t,e,n,i)})).catch((function(t){throw t.code===c6.UNAUTHENTICATED&&r.credentials.Hh(),t}))},e.prototype.terminate=function(){this.kc=!1},e}((function(){})),ynt=function(){function t(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}return t.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,(function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()})))},t.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,this.Lc>=1&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},t.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},t.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},t.prototype.Qc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qc?(p6(e),this.qc=!1):f6("OnlineStateTracker",e)},t.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},t}(),bnt=function(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu((function(t){n.ws((function(){return Object(uR.b)(o,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return Ant(this)?(f6("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return(e=b6(t)).Xc.add(4),[4,_nt(e)];case 1:return n.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,wnt(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.nu=new ynt(n,r)};function wnt(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:if(!Ant(t))return[3,4];e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function _nt(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function xnt(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return e=b6(t),f6("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,_nt(e)];case 1:return n.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}}))}))}function Cnt(t,e){var n=b6(t);n.Yc.has(e.targetId)||(n.Yc.set(e.targetId,e),Tnt(n)?knt(n):qnt(n).uc()&&Snt(n,e))}function Ent(t,e){var n=b6(t),r=qnt(n);n.Yc.delete(e),r.uc()&&Int(n,e),0===n.Yc.size&&(r.uc()?r.fc():Ant(n)&&n.nu.set("Unknown"))}function Snt(t,e){t.su.me(e.targetId),qnt(t).bc(e)}function Int(t,e){t.su.me(e),qnt(t).vc(e)}function knt(t){t.su=new k8({qe:function(e){return t.Hc.qe(e)},Ue:function(e){return t.Yc.get(e)||null}}),qnt(t).start(),t.nu.Uc()}function Tnt(t){return Ant(t)&&!qnt(t).cc()&&t.Yc.size>0}function Ant(t){return 0===b6(t).Xc.size}function Rnt(t){t.su=void 0}function Ont(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return t.Yc.forEach((function(e,n){Snt(t,e)})),[2]}))}))}function Nnt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(n){return Rnt(t),Tnt(t)?(t.nu.Wc(e),knt(t)):t.nu.set("Unknown"),[2]}))}))}function Dnt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:if(t.nu.set("Online"),!(e instanceof S8&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Yc.has(o=i[r])?[4,t.Hc.iu(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Yc.delete(o),t.su.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),f6("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Pnt(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof C8?t.su.be(e):e instanceof E8?t.su.ke(e):t.su.De(e),n.isEqual(L6.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Qet(t.Gc)];case 8:return i=s.sent(),n.h(i)>=0?[4,function(t,e){var n=t.su.$e(e);return n.zt.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.Yc.get(r);i&&t.Yc.set(r,i.it(n.resumeToken,e))}})),n.Ht.forEach((function(e){var n=t.Yc.get(e);if(n){t.Yc.set(e,n.it(S6.u,n.nt)),Int(t,e);var r=new Z6(n.target,e,1,n.sequenceNumber);Snt(t,r)}})),t.Hc.ru(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return f6("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Pnt(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function Pnt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:if(!Q9(e))throw e;return t.Xc.add(1),[4,_nt(t)];case 1:return i.sent(),t.nu.set("Offline"),n||(n=function(){return Qet(t.Gc)}),t.hs.Cs((function(){return Object(uR.b)(r,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return f6("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Xc.delete(1),[4,wnt(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Mnt(t,e){return e().catch((function(n){return Pnt(t,n,e)}))}function Fnt(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:e=b6(t),n=Hnt(e),r=e.Jc.length>0?e.Jc[e.Jc.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Ant(t)&&t.Jc.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Zet(e.Gc,r)];case 3:return null===(i=s.sent())?(0===e.Jc.length&&n.fc(),[3,7]):(r=i.batchId,function(t,e){t.Jc.push(e);var n=Hnt(t);n.uc()&&n.Dc&&n.Cc(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Pnt(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Lnt(e)&&Bnt(e),[2]}}))}))}function Lnt(t){return Ant(t)&&!Hnt(t).cc()&&t.Jc.length>0}function Bnt(t){Hnt(t).start()}function jnt(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return Hnt(t).Fc(),[2]}))}))}function Vnt(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){for(e=Hnt(t),n=0,r=t.Jc;n<r.length;n++)e.Cc(r[n].mutations);return[2]}))}))}function Unt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return r=t.Jc.shift(),i=Att.from(r,e,n),[4,Mnt(t,(function(){return t.Hc.ou(i)}))];case 1:return o.sent(),[4,Fnt(t)];case 2:return o.sent(),[2]}}))}))}function znt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(n){switch(n.label){case 0:return e&&Hnt(t).Dc?[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return e8(r=e.code)&&r!==c6.ABORTED?(n=t.Jc.shift(),Hnt(t)._c(),[4,Mnt(t,(function(){return t.Hc.au(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Fnt(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Lnt(t)&&Bnt(t),[2]}}))}))}function Wnt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return n=b6(t),e?(n.Xc.delete(2),[4,wnt(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Xc.add(2),[4,_nt(n)]);case 3:r.sent(),n.nu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function qnt(t){var e=this;return t.hu||(t.hu=function(t,e,n){var r=b6(t);return r.Oc(),new mnt(e,r.rc,r.credentials,r.serializer,n)}(t.zc,t.hs,{gc:Ont.bind(null,t),Ic:Nnt.bind(null,t),yc:Dnt.bind(null,t)}),t.Zc.push((function(n){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return n?(t.hu._c(),Tnt(t)?knt(t):t.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.hu.stop()];case 2:e.sent(),Rnt(t),e.label=3;case 3:return[2]}}))}))}))),t.hu}function Hnt(t){var e=this;return t.cu||(t.cu=function(t,e,n){var r=b6(t);return r.Oc(),new gnt(e,r.rc,r.credentials,r.serializer,n)}(t.zc,t.hs,{gc:jnt.bind(null,t),Ic:znt.bind(null,t),xc:Vnt.bind(null,t),Nc:Unt.bind(null,t)}),t.Zc.push((function(n){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return n?(t.cu._c(),[4,Fnt(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.cu.stop()];case 3:e.sent(),t.Jc.length>0&&(f6("RemoteStore","Stopping write stream with "+t.Jc.length+" pending writes"),t.Jc=[]),e.label=4;case 4:return[2]}}))}))}))),t.cu}var Gnt=function(t){this.key=t},$nt=function(t){this.key=t},Knt=function(){function t(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=m8(),this.Qt=m8(),this.fu=T9(t),this.du=new y8(this.fu)}return Object.defineProperty(t.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),t.prototype.Eu=function(t,e){var n=this,r=e?e.Tu:new b8,i=e?e.du:this.du,o=e?e.Qt:this.Qt,s=i,a=!1,u=p9(this.query)&&i.size===this.query.limit?i.last():null,c=m9(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var l=i.get(t),h=e instanceof u9?e:null;h&&(h=k9(n.query,h)?h:null);var d=!!l&&n.Qt.has(l.key),f=!!h&&(h.Ye||n.Qt.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data().isEqual(h.data())?d!==f&&(r.track({type:3,doc:h}),p=!0):n.Iu(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.fu(h,u)>0||c&&n.fu(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(a=!0)),p&&(h?(s=s.add(h),o=f?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),p9(this.query)||m9(this.query))for(;s.size>this.query.limit;){var l=p9(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{du:s,Tu:r,mu:a,Qt:o}},t.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.Vr=function(t,e,n){var r=this,i=this.du;this.du=t.du,this.Qt=t.Qt;var o=t.Tu.Ut();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return v6()}};return n(t)-n(e)}(t.type,e.type)||r.fu(t.doc,e.doc)})),this.Au(n);var s=e?this.Ru():[],a=0===this._u.size&&this.te?1:0,u=a!==this.lu;return this.lu=a,0!==o.length||u?{snapshot:new w8(this.query,t.du,i,o,t.Qt,0===a,u,!1),Pu:s}:{Pu:s}},t.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new b8,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},t.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},t.prototype.Au=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uu=e.uu.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uu=e.uu.delete(t)})),this.te=t.te)},t.prototype.Ru=function(){var t=this;if(!this.te)return[];var e=this._u;this._u=m8(),this.du.forEach((function(e){t.gu(e.key)&&(t._u=t._u.add(e.key))}));var n=[];return e.forEach((function(e){t._u.has(e)||n.push(new $nt(e))})),this._u.forEach((function(t){e.has(t)||n.push(new Gnt(t))})),n},t.prototype.Vu=function(t){this.uu=t.Fh,this._u=m8();var e=this.Eu(t.documents);return this.Vr(e,!0)},t.prototype.yu=function(){return w8.Gt(this.query,this.du,this.Qt,0===this.lu)},t}(),Xnt=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ynt=function(t){this.key=t,this.pu=!1},Qnt=function(){function t(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new M6((function(t){return S9(t)}),E9),this.xu=new Map,this.Fu=[],this.ku=new r8(z6.D),this.Ou=new Map,this.Mu=new ant,this.$u={},this.Lu=new Map,this.Bu=Fet.da(),this.onlineState="Unknown",this.qu=void 0}return Object.defineProperty(t.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),t}();function Jnt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return n=Ert(t),(i=n.Nu.get(e))?(n.Su.$i(i.targetId),r=i.view.yu(),[3,4]):[3,1];case 1:return[4,tnt(n.Gc,w9(e))];case 2:return o=a.sent(),s=n.Su.$i(o.targetId),[4,Znt(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.Uu&&Cnt(n.bu,o),a.label=4;case 4:return[2,r]}}))}))}function Znt(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Object(uR.d)(this,(function(l){switch(l.label){case 0:return t.Ku=function(e,n,r){return function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return(i=e.view.Eu(n)).mu?[4,nnt(t.Gc,e.query,!1).then((function(t){return e.view.Eu(t.documents,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.zt.get(e.targetId),s=e.view.Vr(i,t.Uu,o),[2,(lrt(t,e.targetId,s.Pu),s.snapshot)]}}))}))}(t,e,n,r)},[4,nnt(t.Gc,e,!0)];case 1:return i=l.sent(),o=new Knt(e,i.Fh),s=o.Eu(i.documents),a=x8.Zt(n,r&&"Offline"!==t.onlineState),u=o.Vr(s,t.Uu,a),lrt(t,n,u.Pu),c=new Xnt(e,n,o),[2,(t.Nu.set(e,c),t.xu.has(n)?t.xu.get(n).push(e):t.xu.set(n,[e]),u.snapshot)]}}))}))}function trt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return n=b6(t),r=n.Nu.get(e),(i=n.xu.get(r.targetId)).length>1?[2,(n.xu.set(r.targetId,i.filter((function(t){return!E9(t,e)}))),void n.Nu.delete(e))]:n.Uu?(n.Su.Bi(r.targetId),n.Su.xi(r.targetId)?[3,2]:[4,ent(n.Gc,r.targetId,!1).then((function(){n.Su.Ui(r.targetId),Ent(n.bu,r.targetId),urt(n,r.targetId)})).catch(snt)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return urt(n,r.targetId),[4,ent(n.Gc,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function ert(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:n=b6(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Jet(n.Gc,e)];case 2:return r=i.sent(),e.zt.forEach((function(t,e){var r=n.Ou.get(e);r&&(y6(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?r.pu=!0:t.ne.size>0?y6(r.pu):t.se.size>0&&(y6(r.pu),r.pu=!1))})),[4,frt(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,snt(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function nrt(t,e,n){var r=b6(t);if(r.Uu&&0===n||!r.Uu&&1===n){var i=[];r.Nu.forEach((function(t,n){var r=n.view.Ks(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=b6(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Ks(e)&&(r=!0)})),r&&ptt(n)}(r.vu,e),i.length&&r.Cu.yc(i),r.onlineState=e,r.Uu&&r.Su.ji(e)}}function rrt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:return(r=b6(t)).Su.Ki(e,"rejected",n),i=r.Ou.get(e),(o=i&&i.key)?(s=(s=new r8(z6.D)).ot(o,new c9(o,L6.min())),a=m8().add(o),u=new _8(L6.min(),new Map,new s8(x6),s,a),[4,ert(r,u)]):[3,2];case 1:return c.sent(),r.ku=r.ku.remove(o),r.Ou.delete(e),drt(r),[3,4];case 2:return[4,ent(r.Gc,e,!1).then((function(){return urt(r,e,n)})).catch(snt)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function irt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:n=b6(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Yet(n.Gc,e)];case 2:return i=o.sent(),art(n,r,null),srt(n,r),n.Su.Oi(r,"acknowledged"),[4,frt(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,snt(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ort(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:r=b6(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=b6(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Sr.$o(t,e).next((function(e){return y6(null!==e),r=e.keys(),n.Sr.Qo(t,e)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Nh.Or(t,r)}))}))}(r.Gc,e)];case 2:return i=o.sent(),art(r,e,n),srt(r,e),r.Su.Oi(e,"rejected",n),[4,frt(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,snt(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function srt(t,e){(t.Lu.get(e)||[]).forEach((function(t){t.resolve()})),t.Lu.delete(e)}function art(t,e,n){var r=b6(t),i=r.$u[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i}}function urt(t,e,n){void 0===n&&(n=null),t.Su.Bi(e);for(var r=0,i=t.xu.get(e);r<i.length;r++){var o=i[r];t.Nu.delete(o),n&&t.Cu.Qu(o,n)}t.xu.delete(e),t.Uu&&t.Mu.Kh(e).forEach((function(e){t.Mu.Ho(e)||crt(t,e)}))}function crt(t,e){var n=t.ku.get(e);null!==n&&(Ent(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),drt(t))}function lrt(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Gnt?(t.Mu.Da(o.key,e),hrt(t,o)):o instanceof $nt?(f6("SyncEngine","Document no longer in limbo: "+o.key),t.Mu.Na(o.key,e),t.Mu.Ho(o.key)||crt(t,o.key)):v6()}}function hrt(t,e){var n=e.key;t.ku.get(n)||(f6("SyncEngine","New document in limbo: "+n),t.Fu.push(n),drt(t))}function drt(t){for(;t.Fu.length>0&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new Ynt(e)),t.ku=t.ku.ot(e,n),Cnt(t.bu,new Z6(w9(f9(e.path)),n,2,vtt.ai))}}function frt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return r=b6(t),i=[],o=[],s=[],r.Nu.P()?[3,3]:(r.Nu.forEach((function(t,a){s.push(r.Ku(a,e,n).then((function(t){if(t){r.Uu&&r.Su.Ki(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Ptt.zr(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.Cu.yc(i),[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Object(uR.d)(this,(function(l){switch(l.label){case 0:n=b6(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return $9.forEach(e,(function(e){return $9.forEach(e.jr,(function(r){return n.persistence.No.Da(t,e.targetId,r)})).next((function(){return $9.forEach(e.Gr,(function(r){return n.persistence.No.Na(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Q9(r=l.sent()))throw r;return f6("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.bh.get(a),c=u.rt(u.nt),n.bh=n.bh.ot(a,c));return[2]}}))}))}(r.Gc,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function prt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return(n=b6(t)).currentUser.isEqual(e)?[3,3]:(f6("SyncEngine","User change. New user:",e.ti()),[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return n=b6(t),r=n.Sr,i=n.Nh,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Sr.Uo(t).next((function(s){return o=s,r=n.persistence.Th(e),i=new Dtt(n.Ch,r,n.persistence.Ah()),r.Uo(t)})).next((function(e){for(var n=[],r=[],s=m8(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++)s=s.add(h[l].key)}for(var d=0,f=e;d<f.length;d++){var p=f[d];r.push(p.batchId);for(var m=0,g=p.mutations;m<g.length;m++)s=s.add(g[m].key)}return i.Or(t,s).next((function(t){return{Wu:t,ju:n,Gu:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Sr=r,n.Nh=i,n.ph.xh(n.Nh),o)]}}))}))}(n.Gc,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Lu.forEach((function(t){t.forEach((function(t){t.reject(new l6(c6.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Lu.clear()}(n),n.Su.Wi(e,r.ju,r.Gu),[4,frt(n,r.Wu)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function mrt(t,e){var n=b6(t),r=n.Ou.get(e);if(r&&r.pu)return m8().add(r.key);var i=m8(),o=n.xu.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Nu.get(a[s]);i=i.Ot(u.view.wu)}return i}function grt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return[4,nnt((n=b6(t)).Gc,e.query,!0)];case 1:return r=o.sent(),i=e.view.Vu(r),[2,(n.Uu&&lrt(n,e.targetId,i.Pu),i)]}}))}))}function vrt(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=b6(t),r=b6(n.Sr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Lo(t,e).next((function(e){return e?n.Nh.Or(t,e):$9.resolve(null)}))}))}((i=b6(t)).Gc,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Fnt(i.bu)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(art(i,e,r||null),srt(i,e),function(t,e){b6(b6(t).Sr).jo(e)}(i.Gc,e)):v6(),s.label=4;case 4:return[4,frt(i,o)];case 5:return s.sent(),[3,7];case 6:f6("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function yrt(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:return Ert(n=b6(t)),Srt(n),!0!==e||!0===n.qu?[3,3]:(r=n.Su.Ci(),[4,brt(n,r.L())]);case 1:return i=c.sent(),n.qu=!0,[4,Wnt(n.bu,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Cnt(n.bu,s[o]);return[3,7];case 3:return!1!==e||!1===n.qu?[3,7]:(a=[],u=Promise.resolve(),n.xu.forEach((function(t,e){n.Su.qi(e)?a.push(e):u=u.then((function(){return urt(n,e),ent(n.Gc,e,!0)})),Ent(n.bu,e)})),[4,u]);case 4:return c.sent(),[4,brt(n,a)];case 5:return c.sent(),function(t){var e=b6(t);e.Ou.forEach((function(t,n){Ent(e.bu,n)})),e.Mu.Qh(),e.Ou=new Map,e.ku=new r8(z6.D)}(n),n.qu=!1,[4,Wnt(n.bu,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function brt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,d,f,p;return Object(uR.d)(this,(function(m){switch(m.label){case 0:n=b6(t),r=[],i=[],o=0,s=e,m.label=1;case 1:return o<s.length?(u=void 0,(c=n.xu.get(a=s[o]))&&0!==c.length?[4,tnt(n.Gc,w9(c[0]))]:[3,7]):[3,13];case 2:u=m.sent(),l=0,h=c,m.label=3;case 3:return l<h.length?(d=n.Nu.get(h[l]),[4,grt(n,d)]):[3,6];case 4:(f=m.sent()).snapshot&&i.push(f.snapshot),m.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,rnt(n.Gc,a)];case 8:return p=m.sent(),[4,tnt(n.Gc,p)];case 9:return u=m.sent(),[4,Znt(n,wrt(p),a,!1)];case 10:m.sent(),m.label=11;case 11:r.push(u),m.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Cu.yc(i),r)]}}))}))}function wrt(t){return d9(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function _rt(t){var e=b6(t);return b6(b6(e.Gc).persistence).pi()}function xrt(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return(i=b6(t)).qu?(f6("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.xu.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,int(i.Gc)];case 3:return o=a.sent(),s=_8.Xt(e,"current"===n),[4,frt(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,ent(i.Gc,e,!0)];case 6:return a.sent(),urt(i,e,r),[3,8];case 7:v6(),a.label=8;case 8:return[2]}}))}))}function Crt(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h;return Object(uR.d)(this,(function(d){switch(d.label){case 0:if(!(r=Ert(t)).qu)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?r.xu.has(s=o[i])?(f6("SyncEngine","Adding an already active target "+s),[3,5]):[4,rnt(r.Gc,s)]:[3,6];case 2:return a=d.sent(),[4,tnt(r.Gc,a)];case 3:return u=d.sent(),[4,Znt(r,wrt(a),u.targetId,!1)];case 4:d.sent(),Cnt(r.bu,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return r.xu.has(t)?[4,ent(r.Gc,t,!1).then((function(){Ent(r.bu,t),urt(r,t)})).catch(snt)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,d.label=7;case 7:return l<h.length?[5,c(h[l])]:[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Ert(t){var e=b6(t);return e.bu.Hc.ru=ert.bind(null,e),e.bu.Hc.qe=mrt.bind(null,e),e.bu.Hc.iu=rrt.bind(null,e),e.Cu.yc=dtt.bind(null,e.vu),e.Cu.Qu=ftt.bind(null,e.vu),e}function Srt(t){var e=b6(t);return e.bu.Hc.ou=irt.bind(null,e),e.bu.Hc.au=ort.bind(null,e),e}var Irt=function(){function t(){}return t.prototype.xh=function(t){this.zu=t},t.prototype.Lr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.on.length||1===t.on.length&&t.on[0].field.W())}(e)||n.isEqual(L6.min())?this.Hu(t,e):this.zu.Or(t,r).next((function(o){var s=i.Ju(e,o);return(p9(e)||m9(e))&&i.mu(e.an,s,r,n)?i.Hu(t,e):(d6()<=c2.a.DEBUG&&f6("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),I9(e)),i.zu.Lr(t,e,n).next((function(t){return s.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Ju=function(t,e){var n=new s8(T9(t));return e.forEach((function(e,r){r instanceof u9&&k9(t,r)&&(n=n.add(r))})),n},t.prototype.mu=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.h(r)>0)},t.prototype.Hu=function(t,e){return d6()<=c2.a.DEBUG&&f6("IndexFreeQueryEngine","Using full collection scan to execute query:",I9(e)),this.zu.Lr(t,e,L6.min())},t}(),krt=function(){function t(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new s8(unt.Mh)}return t.prototype.ko=function(t){return $9.resolve(0===this.Sr.length)},t.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++;var o=new Ttt(i,e,n,r);this.Sr.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Xu=this.Xu.add(new unt(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return $9.resolve(o)},t.prototype.$o=function(t,e){return $9.resolve(this.Zu(e))},t.prototype.Bo=function(t,e){var n=this.tl(e+1),r=n<0?0:n;return $9.resolve(this.Sr.length>r?this.Sr[r]:null)},t.prototype.qo=function(){return $9.resolve(0===this.Sr.length?-1:this.Yu-1)},t.prototype.Uo=function(t){return $9.resolve(this.Sr.slice())},t.prototype.Nr=function(t,e){var n=this,r=new unt(e,0),i=new unt(e,Number.POSITIVE_INFINITY),o=[];return this.Xu.xt([r,i],(function(t){var e=n.Zu(t.jh);o.push(e)})),$9.resolve(o)},t.prototype.$r=function(t,e){var n=this,r=new s8(x6);return e.forEach((function(t){var e=new unt(t,0),i=new unt(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,i],(function(t){r=r.add(t.jh)}))})),$9.resolve(this.el(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;z6.X(i)||(i=i.child(""));var o=new unt(new z6(i),0),s=new s8(x6);return this.Xu.Ft((function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(s=s.add(t.jh)),!0)}),o),$9.resolve(this.el(s))},t.prototype.el=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Zu(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;y6(0===this.nl(e.batchId,"removed")),this.Sr.shift();var r=this.Xu;return $9.forEach(e.mutations,(function(i){var o=new unt(i.key,e.batchId);return r=r.delete(o),n.No.Go(t,i.key)})).next((function(){n.Xu=r}))},t.prototype.jo=function(t){},t.prototype.Ho=function(t,e){var n=new unt(e,0),r=this.Xu.kt(n);return $9.resolve(e.isEqual(r&&r.key))},t.prototype.zo=function(t){return $9.resolve()},t.prototype.nl=function(t,e){return this.tl(t)},t.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},t.prototype.Zu=function(t){var e=this.tl(t);return e<0||e>=this.Sr.length?null:this.Sr[e]},t}(),Trt=function(){function t(t,e){this.Dr=t,this.sl=e,this.docs=new r8(z6.D),this.size=0}return t.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:s,readTime:n}),this.size+=s-o,this.Dr.Mo(t,r.path.F())},t.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Rr=function(t,e){var n=this.docs.get(e);return $9.resolve(n?n.ta:null)},t.prototype.getEntries=function(t,e){var n=this,r=l8();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)})),$9.resolve(r)},t.prototype.Lr=function(t,e,n){for(var r=d8(),i=new z6(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),a=s.value,u=a.ta,c=a.readTime;if(!e.path.M(s.key.path))break;c.h(n)<=0||u instanceof u9&&k9(e,u)&&(r=r.ot(u.key,u))}return $9.resolve(r)},t.prototype.il=function(t,e){return $9.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ra=function(t){return new Art(this)},t.prototype.aa=function(t){return $9.resolve(this.size)},t}(),Art=function(t){function e(e){var n=this;return(n=t.call(this)||this).ha=e,n}return Object(uR.c)(e,t),e.prototype.Vr=function(t){var e=this,n=[];return this.wr.forEach((function(r,i){i?n.push(e.ha.Ir(t,i,e.readTime)):e.ha.Ar(r)})),$9.kn(n)},e.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},e.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},e}(Rtt),Rrt=function(){function t(t){this.persistence=t,this.rl=new M6((function(t){return K6(t)}),X6),this.lastRemoteSnapshotVersion=L6.min(),this.highestTargetId=0,this.ol=0,this.al=new ant,this.targetCount=0,this.hl=Fet.fa()}return t.prototype.Ce=function(t,e){return this.rl.forEach((function(t,n){return e(n)})),$9.resolve()},t.prototype.Ia=function(t){return $9.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ma=function(t){return $9.resolve(this.ol)},t.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),$9.resolve(this.highestTargetId)},t.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),$9.resolve()},t.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Fet(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},t.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,$9.resolve()},t.prototype.Va=function(t,e){return this.Pa(e),$9.resolve()},t.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),this.targetCount-=1,$9.resolve()},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return this.rl.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.rl.delete(s),o.push(r.pa(t,a.targetId)),i++)})),$9.kn(o).next((function(){return i}))},t.prototype.ba=function(t){return $9.resolve(this.targetCount)},t.prototype.va=function(t,e){var n=this.rl.get(e)||null;return $9.resolve(n)},t.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),$9.resolve()},t.prototype.Ca=function(t,e,n){this.al.Uh(e,n);var r=this.persistence.No,i=[];return r&&e.forEach((function(e){i.push(r.Go(t,e))})),$9.kn(i)},t.prototype.pa=function(t,e){return this.al.Kh(e),$9.resolve()},t.prototype.xa=function(t,e){var n=this.al.Wh(e);return $9.resolve(n)},t.prototype.Ho=function(t,e){return $9.resolve(this.al.Ho(e))},t}(),Ort=function(){function t(t){var e=this;this.cl={},this.Ma=new vtt(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new Rrt(this),this.Dr=new pet,this.vr=function(t,n){return new Trt(t,(function(t){return e.No.ul(t)}))}(this.Dr)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Za=function(){},t.prototype.th=function(){},t.prototype.Ah=function(){return this.Dr},t.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new krt(this.Dr,this.No),this.cl[t.ti()]=e),e},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.runTransaction=function(t,e,n){var r=this;f6("MemoryPersistence","Starting transaction:",t);var i=new Nrt(this.Ma.next());return this.No.ll(),n(i).next((function(t){return r.No._l(i).next((function(){return t}))})).xn().then((function(t){return i.br(),t}))},t.prototype.fl=function(t,e){return $9.On(Object.values(this.cl).map((function(n){return function(){return n.Ho(t,e)}})))},t}(),Nrt=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fa=e,n}return Object(uR.c)(e,t),e}(Ntt),Drt=function(){function t(t){this.persistence=t,this.dl=new ant,this.wl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw v6()},enumerable:!1,configurable:!0}),t.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),$9.resolve()},t.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),$9.resolve()},t.prototype.Go=function(t,e){return this.Tl.add(e.toString()),$9.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach((function(t){return n.Tl.add(t.toString())}));var r=this.persistence.Ih();return r.xa(t,e.targetId).next((function(t){t.forEach((function(t){return n.Tl.add(t.toString())}))})).next((function(){return r.ya(t,e)}))},t.prototype.ll=function(){this.wl=new Set},t.prototype._l=function(t){var e=this,n=this.persistence.mh().ra();return $9.forEach(this.Tl,(function(r){var i=z6.H(r);return e.Il(t,i).next((function(t){t||n.Ar(i)}))})).next((function(){return e.wl=null,n.apply(t)}))},t.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next((function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())}))},t.prototype.ul=function(t){return 0},t.prototype.Il=function(t,e){var n=this;return $9.On([function(){return $9.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},t}(),Prt=function(){function t(t){this.ml=t.ml,this.Al=t.Al}return t.prototype.gc=function(t){this.Rl=t},t.prototype.Ic=function(t){this.Pl=t},t.prototype.onMessage=function(t){this.gl=t},t.prototype.close=function(){this.Al()},t.prototype.send=function(t){this.ml(t)},t.prototype.Vl=function(){this.Rl()},t.prototype.yl=function(t){this.Pl(t)},t.prototype.pl=function(t){this.gl(t)},t}(),Mrt={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Frt=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.T=e.T,n}return Object(uR.c)(e,t),e.prototype.Nl=function(t,e,n,r){return new Promise((function(i,o){var s=new a6;s.listenOnce(o6.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case i6.NO_ERROR:var e=s.getResponseJson();f6("Connection","XHR received:",JSON.stringify(e)),i(e);break;case i6.TIMEOUT:f6("Connection",'RPC "'+t+'" timed out'),o(new l6(c6.DEADLINE_EXCEEDED,"Request time out"));break;case i6.HTTP_ERROR:var n=s.getStatus();if(f6("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(c6).indexOf(e)>=0?e:c6.UNKNOWN}(r.status);o(new l6(a,r.message))}else o(new l6(c6.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new l6(c6.UNAVAILABLE,"Connection failed."));break;default:v6()}}finally{f6("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Vc=function(t,e){var n=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Z5,i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(i.initMessageHeaders,e),Object(l2.x)()||Object(l2.A)()||Object(l2.t)()||Object(l2.v)()||Object(l2.B)()||Object(l2.s)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");f6("Connection","Creating WebChannel: "+o,i);var s=r.createWebChannel(o,i),a=!1,u=!1,c=new Prt({ml:function(t){u?f6("Connection","Not sending because WebChannel is closed:",t):(a||(f6("Connection","Opening WebChannel transport."),s.open(),a=!0),f6("Connection","WebChannel sending:",t),s.send(t))},Al:function(){return s.close()}}),l=function(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(s6.EventType.OPEN,(function(){u||f6("Connection","WebChannel transport opened.")})),l(s6.EventType.CLOSE,(function(){u||(u=!0,f6("Connection","WebChannel transport closed"),c.yl())})),l(s6.EventType.ERROR,(function(t){u||(u=!0,m6("Connection","WebChannel transport errored:",t),c.yl(new l6(c6.UNAVAILABLE,"The operation could not be completed")))})),l(s6.EventType.MESSAGE,(function(t){var e;if(!u){var n=t.data[0];y6(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){f6("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Q6[t];if(void 0!==e)return n8(e)}(i),a=r.message;void 0===o&&(o=c6.INTERNAL,a="Unknown error status: "+i+" with message "+r.message),u=!0,c.yl(new l6(o,a)),s.close()}else f6("Connection","WebChannel received:",n),c.pl(n)}})),setTimeout((function(){c.Vl()}),0),c},e}(function(){function t(t){this.bl=t,this._=t._,this.vl=(t.ssl?"https":"http")+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}return t.prototype.Mc=function(t,e,n,r){var i=this.Dl(t,e);f6("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(t,i,o,n).then((function(t){return f6("RestConnection","Received: ",t),t}),(function(e){throw m6("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},t.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},t.prototype.Dl=function(t,e){return this.vl+"/v1/"+e+":"+Mrt[t]},t}()),Lrt=function(){function t(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}return t.prototype.eu=function(t){this.Ml.push(t)},t.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},t.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},t.prototype.Fl=function(){f6("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){f6("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Brt=function(){function t(){}return t.prototype.eu=function(t){},t.prototype.Di=function(){},t}();function jrt(t){return new Y8(t,!0)}var Vrt=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return this.Su=this.Ll(t),this.persistence=this.Bl(t),[4,this.persistence.start()];case 1:return e.sent(),this.ql=this.Ul(t),this.Gc=this.Kl(t),[2]}}))}))},t.prototype.Ul=function(t){return null},t.prototype.Kl=function(t){return e=this.persistence,n=new Irt,new Xet(e,n,t.Ql);var e,n},t.prototype.Bl=function(t){return new Ort(Drt.El)},t.prototype.Ll=function(t){return new ktt},t.prototype.terminate=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}}))}))},t}(),Urt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(uR.c)(e,t),e.prototype.initialize=function(e){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,ont(this.Gc)];case 2:return n.sent(),[4,this.Wl.initialize(this,e)];case 3:return n.sent(),[4,Srt(this.Wl.fi)];case 4:return n.sent(),[4,Fnt(this.Wl.bu)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ul=function(t){return new jtt(this.persistence.No.wo,t.hs)},e.prototype.Bl=function(t){var e=Ket(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?Btt.ao(this.cacheSizeBytes):Btt.fo,r=jrt(t.bl._);return new Wet(this.synchronizeTabs,e,t.clientId,n,t.hs,rtt(),itt(),r,this.Su,!!this.forceOwnership)},e.prototype.Ll=function(t){return new ktt},e}(Vrt),zrt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Wl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(uR.c)(e,t),e.prototype.initialize=function(e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Wl.fi,this.Su instanceof Itt?(this.Su.fi={er:vrt.bind(null,n),nr:xrt.bind(null,n),sr:Crt.bind(null,n),pi:_rt.bind(null,n)},[4,this.Su.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Xa((function(t){return Object(uR.b)(r,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return[4,yrt(this.Wl.fi,t)];case 1:return e.sent(),this.ql&&(t&&!this.ql.Ii?this.ql.start(this.Gc):t||this.ql.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Ll=function(t){var e=rtt();if(!Itt.Ln(e))throw new l6(c6.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ket(t.bl._,t.bl.persistenceKey);return new Itt(e,t.hs,n,t.clientId,t.Ql)},e}(Urt),Wrt=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return this.Gc?[3,2]:(this.Gc=t.Gc,this.Su=t.Su,this.zc=this.jl(e),this.bu=this.Gl(e),this.vu=this.zl(e),this.fi=this.Hl(e,!t.synchronizeTabs),this.Su.di=function(t){return nrt(n.fi,t,1)},this.bu.Hc.Jl=prt.bind(null,this.fi),[4,Wnt(this.bu,this.fi.Uu)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.zl=function(t){return new ctt},t.prototype.jl=function(t){var e=jrt(t.bl._),n=new Frt(t.bl);return function(t,e,n){return new vnt(t,e,n)}(t.credentials,n,e)},t.prototype.Gl=function(t){var e,n,r,i,o,s=this;return e=this.Gc,n=this.zc,r=t.hs,i=function(t){return nrt(s.fi,t,0)},o=Lrt.Ln()?new Lrt:new Brt,new bnt(e,n,r,i,o)},t.prototype.Hl=function(t,e){return function(t,e,n,r,i,o,s){var a=new Qnt(t,e,n,r,i,o);return s&&(a.qu=!0),a}(this.Gc,this.bu,this.vu,this.Su,t.Ql,t.Du,e)},t.prototype.terminate=function(){return xnt(this.bu)},t}(),qrt=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Xl=function(){this.muted=!0},t.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function Hrt(t,e,n){if(!n)throw new l6(c6.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Grt(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new l6(c6.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function $rt(t,e,n,r){if(!0===e&&!0===r)throw new l6(c6.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Krt(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":v6()}function Xrt(t,e){if(e<=0)throw new l6(c6.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Yrt=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new l6(c6.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new U6(t)},Qrt=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return Object(uR.c)(e,t),e.documentId=function(){return new e(U6.j().B())},e.prototype.isEqual=function(t){return t instanceof e&&this.Zl.isEqual(t.Zl)},e}(Yrt),Jrt=new RegExp("[~\\*/\\[\\]]"),Zrt=function(t){this.t_=t},tit=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.e_=function(t){if(2!==t.n_)throw t.s_(1===t.n_?this.t_+"() can only appear at the top level of your update data":this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Zrt);function eit(t,e,n){return new fit({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var nit=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.e_=function(t){return new V7(t.path,new O7)},e.prototype.isEqual=function(t){return t instanceof e},e}(Zrt),rit=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return Object(uR.c)(e,t),e.prototype.e_=function(t){var e=eit(this,t,!0),n=this.o_.map((function(t){return bit(t,e)})),r=new N7(n);return new V7(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Zrt),iit=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return Object(uR.c)(e,t),e.prototype.e_=function(t){var e=eit(this,t,!0),n=this.o_.map((function(t){return bit(t,e)})),r=new P7(n);return new V7(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Zrt),oit=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return Object(uR.c)(e,t),e.prototype.e_=function(t){var e=new F7(t.serializer,Z8(t.serializer,this.a_));return new V7(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Zrt),sit=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new l6(c6.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new l6(c6.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},t.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},t.prototype.g=function(t){return x6(this.h_,t.h_)||x6(this.c_,t.c_)},t}(),ait=function(t){this.u_=t},uit=/^__.*__$/,cit=function(t,e,n){this.l_=t,this.__=e,this.f_=n},lit=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[];return n.push(null!==this.Qe?new Q7(t,this.data,this.Qe,e):new Y7(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Z7(t,this.fieldTransforms)),n},t}(),hit=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[new Q7(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new Z7(t,this.fieldTransforms)),n},t}();function dit(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw v6()}}var fit=function(){function t(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),t.prototype.E_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.T_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.I_(t),r},t.prototype.m_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.w_(),r},t.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},t.prototype.s_=function(t){return Sit(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.M(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.M(e.field)}))},t.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},t.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(dit(this.n_)&&uit.test(t))throw this.s_('Document fields cannot begin and end with "__"')},t}(),pit=function(){function t(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||jrt(t)}return t.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new fit({n_:t,methodName:e,i_:n,path:U6.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},t}();function mit(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);xit("Data must be an object, but it was:",s,r);var a,u,c=wit(r,s);if(o.merge)a=new j7(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,d=o.mergeFields;h<d.length;h++){var f=d[h],p=void 0;if(f instanceof Yrt)p=f.Zl;else{if("string"!=typeof f)throw v6();p=Eit(e,f,n)}if(!s.contains(p))throw new l6(c6.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Iit(l,p)||l.push(p)}a=new j7(l),u=s.fieldTransforms.filter((function(t){return a.Je(t.field)}))}else a=null,u=s.fieldTransforms;return new lit(new i9(c),a,u)}function git(t,e,n,r){var i=t.P_(1,e,n);xit("Data must be an object, but it was:",i,r);var o=[],s=new o9;D6(r,(function(t,r){var a=Eit(e,t,n),u=i.m_(a);if(r instanceof tit||r instanceof ait&&r.u_ instanceof tit)o.push(a);else{var c=bit(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new j7(o);return new hit(s.Xe(),a,i.fieldTransforms)}function vit(t,e,n,r,i,o){var s=t.P_(1,e,n),a=[Cit(e,r,n)],u=[i];if(o.length%2!=0)throw new l6(c6.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Cit(e,o[c])),u.push(o[c+1]);for(var l=[],h=new o9,d=a.length-1;d>=0;--d)if(!Iit(l,a[d])){var f=a[d],p=u[d],m=s.m_(f);if(p instanceof tit||p instanceof ait&&p.u_ instanceof tit)l.push(f);else{var g=bit(p,m);null!=g&&(l.push(f),h.set(f,g))}}var v=new j7(l);return new hit(h.Xe(),v,s.fieldTransforms)}function yit(t,e,n,r){return void 0===r&&(r=!1),bit(n,t.P_(r?4:3,e))}function bit(t,e){if(t instanceof ait&&(t=t.u_),_it(t))return xit("Unsupported field value:",e,t),wit(t,e);if(t instanceof Zrt)return function(t,e){if(!dit(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");var n=t.e_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.r_&&4!==e.n_)throw e.s_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=bit(o[i],e.A_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Z8(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=F6.fromDate(t);return{timestampValue:t7(e.serializer,n)}}if(t instanceof F6){var r=new F6(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:t7(e.serializer,r)}}if(t instanceof sit)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof I6)return{bytesValue:e7(e.serializer,t.l)};if(t instanceof cit){var i=e._,o=t.l_;if(!o.isEqual(i))throw e.s_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:i7(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+Krt(t))}(t,e)}function wit(t,e){var n={};return P6(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):D6(t,(function(t,r){var i=bit(r,e.T_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function _it(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof F6||t instanceof sit||t instanceof I6||t instanceof cit||t instanceof Zrt)}function xit(t,e,n){if(!_it(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Krt(n);throw e.s_("an object"===r?t+" a custom object":t+" "+r)}}function Cit(t,e,n){if(e instanceof Yrt)return e.Zl;if("string"==typeof e)return Eit(t,e);throw Sit("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Eit(t,e,n){try{return function(t){if(t.search(Jrt)>=0)throw new l6(c6.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Qrt.bind.apply(Qrt,Object(uR.g)([void 0],t.split("."))))}catch(e){throw new l6(c6.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw Sit((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Sit(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new l6(c6.INVALID_ARGUMENT,(a+=". ")+t+u)}function Iit(t,e){return t.some((function(t){return t.isEqual(e)}))}var kit=function(){function t(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}return t.prototype.b_=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:if(this.v_(),this.mutations.length>0)throw new l6(c6.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return n=b6(t),r=l7(n.serializer)+"/documents",i={documents:e.map((function(t){return s7(n.serializer,t)}))},[4,n.$c("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){y6(!!e.found);var n=a7(t,e.found.name),r=r7(e.found.updateTime),i=new i9({mapValue:{fields:e.found.fields}});return new u9(n,r,i,{})}(t,e):"missing"in e?function(t,e){y6(!!e.missing),y6(!!e.readTime);var n=a7(t,e.missing),r=r7(e.readTime);return new c9(n,r)}(t,e):v6()}(n.serializer,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());y6(!!e),a.push(e)})),a)]}}))}))}(this.zc,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof c9||t instanceof u9?n.S_(t):v6()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},t.prototype.delete=function(t){this.write([new n9(t,this.Ge(t))]),this.p_.add(t.toString())},t.prototype.commit=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e=this;return Object(uR.d)(this,(function(n){switch(n.label){case 0:if(this.v_(),this.y_)throw this.y_;return t=this.g_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=z6.H(n);e.mutations.push(new r9(r,e.Ge(r)))})),[4,function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return n=b6(t),r=l7(n.serializer)+"/documents",i={writes:e.map((function(t){return f7(n.serializer,t)}))},[4,n.Mc("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.zc,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},t.prototype.S_=function(t){var e;if(t instanceof u9)e=t.version;else{if(!(t instanceof c9))throw v6();e=L6.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new l6(c6.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?z7.updateTime(e):z7.ze()},t.prototype.D_=function(t){var e=this.g_.get(t.toString());if(!this.p_.has(t.toString())&&e){if(e.isEqual(L6.min()))throw new l6(c6.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return z7.updateTime(e)}return z7.exists(!0)},t.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},t.prototype.v_=function(){},t}(),Tit=function(){function t(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new G9(this.hs,"transaction_retry")}return t.prototype.run=function(){this.N_()},t.prototype.N_=function(){var t=this;this.Vs.Pn((function(){return Object(uR.b)(t,void 0,void 0,(function(){var t,e,n=this;return Object(uR.d)(this,(function(r){return t=new kit(this.zc),(e=this.x_(t))&&e.then((function(e){n.hs.ws((function(){return t.commit().then((function(){n.ls.resolve(e)})).catch((function(t){n.F_(t)}))}))})).catch((function(t){n.F_(t)})),[2]}))}))}))},t.prototype.x_=function(t){try{var e=this.updateFunction(t);return!W6(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},t.prototype.F_=function(t){var e=this;this.C_>0&&this.k_(t)?(this.C_-=1,this.hs.ws((function(){return e.N_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.k_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!e8(e)}return!1},t}(),Ait=function(){function t(t,e){this.credentials=t,this.hs=e,this.clientId=_6.t(),this.O_=new H9}return t.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new H9,o=!1;return this.credentials.Jh((function(t){if(!o)return o=!0,f6("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject);r.hs.Cs((function(){return function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return(n=b6(t)).hs.Fs(),f6("RemoteStore","RemoteStore received new credentials"),r=Ant(n),n.Xc.add(3),[4,_nt(n)];case 1:return i.sent(),r&&n.nu.set("Unknown"),[4,n.Hc.Jl(e)];case 2:return i.sent(),n.Xc.delete(3),[4,wnt(n)];case 3:return i.sent(),[2]}}))}))}(r.bu,t)}))})),this.hs.ws((function(){return r.O_.promise})),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!0),function(t){var e=b6(t);return e.Xc.delete(0),wnt(e)}(t.bu)}))},t.prototype.L_=function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s=this;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,t.initialize(i={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:n,Du:100})];case 1:return a.sent(),[4,e.initialize(t,i)];case 2:return a.sent(),this.persistence=t.persistence,this.Su=t.Su,this.Gc=t.Gc,this.ql=t.ql,this.zc=e.zc,this.bu=e.bu,this.fi=e.fi,this.B_=e.vu,this.B_.Us=Jnt.bind(null,this.fi),this.B_.Ws=trt.bind(null,this.fi),this.persistence.Za((function(){return Object(uR.b)(s,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,4];case 3:if(o=a.sent(),r.reject(o),!function(t){return"FirebaseError"===t.name?t.code===c6.FAILED_PRECONDITION||t.code===c6.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.L_(new Vrt,new Wrt,n,r))];case 4:return[2]}}))}))},t.prototype.M_=function(){if(this.hs.ps)throw new l6(c6.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!1),function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return(e=b6(t)).Xc.add(0),[4,_nt(e)];case 1:return n.sent(),e.nu.set("Offline"),[2]}}))}))}(t.bu)}))},t.prototype.terminate=function(){var t=this;this.hs.Ds();var e=new H9;return this.hs.bs((function(){return Object(uR.b)(t,void 0,void 0,(function(){var t,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,xnt(this.bu)];case 1:return r.sent(),[4,this.Su.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yh(),e.resolve(),[3,5];case 4:return t=r.sent(),n=att(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new H9;return this.hs.ws((function(){return function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:Ant((n=b6(t)).bu)||f6("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=b6(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Sr.qo(t)}))}(n.Gc)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Lu.get(r)||[]).push(e),n.Lu.set(r,i),[3,4]);case 3:return o=a.sent(),s=att(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}(t.fi,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new qrt(n),o=new mtt(t,i,e);return this.hs.ws((function(){return ltt(r.B_,o)})),function(){i.Xl(),r.hs.ws((function(){return htt(r.B_,o)}))}},t.prototype.q_=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return r.sent(),e=new H9,[2,(this.hs.ws((function(){return function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=b6(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Nh.Cr(t,e)}))}(t,e)];case 1:return(r=s.sent())instanceof u9?n.resolve(r):r instanceof c9?n.resolve(null):n.reject(new l6(c6.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=att(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.U_=function(t,e){return void 0===e&&(e={}),Object(uR.b)(this,void 0,void 0,(function(){var n,r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new H9,[2,(this.hs.ws((function(){return function(t,e,n,r,i){var o=new qrt({next:function(o){e.ws((function(){return htt(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new l6(c6.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new l6(c6.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new mtt(f9(n.path),o,{includeMetadataChanges:!0,Xs:!0});return ltt(t,s)}(r.B_,r.hs,t,e,n)})),n.promise)]}}))}))},t.prototype.K_=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return r.sent(),e=new H9,[2,(this.hs.ws((function(){return function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,nnt(t,e,!0)];case 1:return r=c.sent(),i=new Knt(e,r.Fh),o=i.Eu(r.documents),s=i.Vr(o,!1),n.resolve(s.snapshot),[3,3];case 2:return a=c.sent(),u=att(a,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.Q_=function(t,e){return void 0===e&&(e={}),Object(uR.b)(this,void 0,void 0,(function(){var n,r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new H9,[2,(this.hs.ws((function(){return function(t,e,n,r,i){var o=new qrt({next:function(n){e.ws((function(){return htt(t,s)})),n.fromCache&&"server"===r.source?i.reject(new l6(c6.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new mtt(n,o,{includeMetadataChanges:!0,Xs:!0});return ltt(t,s)}(r.B_,r.hs,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.M_();var n=new H9;return this.hs.ws((function(){return function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:r=Srt(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=b6(t),i=F6.now(),o=e.reduce((function(t,e){return t.add(e.key)}),m8());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Nh.Or(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=$7(c,n.get(c.key));null!=l&&s.push(new Q7(c.key,l,s9(l.proto.mapValue),z7.exists(!0)))}return r.Sr.Oo(t,i,s,e)}))})).then((function(t){var e=t.lr(n);return{batchId:t.batchId,wr:e}}))}(r.Gc,e)];case 2:return i=a.sent(),r.Su.Fi(i.batchId),function(t,e,n){var r=t.$u[t.currentUser.ti()];r||(r=new r8(x6)),r=r.ot(e,n),t.$u[t.currentUser.ti()]=r}(r,i.batchId,n),[4,frt(r,i.wr)];case 3:return a.sent(),[4,Fnt(r.bu)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=att(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}(e.fi,t,n)})),n.promise},t.prototype._=function(){return this.bl._},t.prototype.W_=function(t){var e=this;this.M_();var n=new qrt(t);return this.hs.ws((function(){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){return[2,function(t,e){b6(t).qs.add(e),e.next()}(this.B_,n)]}))}))})),function(){n.Xl(),e.hs.ws((function(){return Object(uR.b)(e,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){return[2,function(t,e){b6(t).qs.delete(e)}(this.B_,n)]}))}))}))}},Object.defineProperty(t.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.M_();var n=new H9;return this.hs.ws((function(){return new Tit(e.hs,e.zc,t,n).run(),Promise.resolve()})),n.promise},t}();function Rit(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Oit=function(){function t(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}return t.prototype.J_=function(t){switch(D8(t)){case 0:return null;case 1:return t.booleanValue;case 2:return V8(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(U8(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw v6()}},t.prototype.nf=function(t){var e=this,n={};return D6(t.fields||{},(function(t,r){n[t]=e.J_(r)})),n},t.prototype.tf=function(t){return new sit(V8(t.latitude),V8(t.longitude))},t.prototype.ef=function(t){var e=this;return(t.values||[]).map((function(t){return e.J_(t)}))},t.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return R8(n)?t(n):n}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(O8(t));default:return null}},t.prototype.Y_=function(t){var e=j8(t);return new F6(e.seconds,e.nanos)},t.prototype.Z_=function(t){var e=j6.q(t);y6(I7(e));var n=new O6(e.get(1),e.get(3)),r=new z6(e.N(5));return n.isEqual(this._)||p6("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(r)},t}(),Nit=Btt.uo,Dit=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new l6(c6.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=Btt._o;else{if(t.cacheSizeBytes!==Nit&&t.cacheSizeBytes<Btt.lo)throw new l6(c6.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Btt.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,$rt("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Pit="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Mit=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){throw new l6(c6.FAILED_PRECONDITION,Pit)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new l6(c6.FAILED_PRECONDITION,Pit)},t.prototype.clearIndexedDbPersistence=function(t){throw new l6(c6.FAILED_PRECONDITION,Pit)},t}(),Fit=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){var n=new Wrt,r=new Urt(n,t.sf().cacheSizeBytes,e);return t.if(r,n)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new Wrt,n=new zrt(e,t.sf().cacheSizeBytes);return t.if(n,e)},t.prototype.clearIndexedDbPersistence=function(t){var e=this,n=new H9;return t.rf.bs((function(){return Object(uR.b)(e,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return K9.Ln()?[4,K9.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(Ket(t.l_,t.af))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},t}(),Lit=function(){function t(e,n,r){var i=this;if(void 0===r&&(r=new Mit),this.hf=r,this.cf=null,this.rf=new stt,this.INTERNAL={delete:function(){return Object(uR.b)(i,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var o=e;this.cf=o,this.l_=t._f(o),this.af=o.name,this.ff=new hnt(n)}else{var s=e;if(!s.projectId)throw new l6(c6.INVALID_ARGUMENT,"Must provide projectId");this.l_=new O6(s.projectId,s.database),this.af="[DEFAULT]",this.ff=new lnt}this.df=new Dit({})}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new pit(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;var e=new Dit(t);if(this.lf&&!this.df.isEqual(e))throw new l6(c6.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.df=e,void 0!==e.credentials&&(this.ff=function(t){if(!t)return new lnt;switch(t.type){case"gapi":var e=t.client;return y6(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new fnt(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new l6(c6.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&m6("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},t.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},t.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},t.prototype.enablePersistence=function(t){if(this.lf)throw new l6(c6.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&$rt("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){if(void 0!==this.lf&&!this.lf.j_)throw new l6(c6.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){return this.uf(),Rit(t)?this.lf.W_(t):this.lf.W_({next:t})},t.prototype.uf=function(){return this.lf||this.if(new Vrt,new Wrt),this.lf},t.prototype.If=function(){return new R6(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},t.prototype.if=function(t,e){var n=this.If();return this.lf=new Ait(this.ff,this.rf),this.lf.start(n,t,e)},t._f=function(t){if(!Object.prototype.hasOwnProperty.call(t.options,"projectId"))throw new l6(c6.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e=t.options.projectId;if(!e||"string"!=typeof e)throw new l6(c6.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new O6(e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.cf)throw new l6(c6.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return Hrt("Firestore.collection","path",t),this.uf(),new Yit(j6.q(t),this,null)},t.prototype.doc=function(t){return Hrt("Firestore.doc","path",t),this.uf(),Vit.mf(j6.q(t),this,null)},t.prototype.collectionGroup=function(t){if(Hrt("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new l6(c6.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Kit(function(t){return new h9(j6.U(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return this.uf().transaction((function(n){return t(new Bit(e,n))}))},t.prototype.batch=function(){return this.uf(),new jit(this)},t.prototype.sf=function(){return this.df},t}(),Bit=function(){function t(t,e){this.Af=t,this.Rf=e}return t.prototype.get=function(t){var e=this,n=Qit(0,t,this.Af);return this.Rf.b_([n.__]).then((function(t){if(!t||1!==t.length)return v6();var r=t[0];if(r instanceof c9)return new zit(e.Af,n.__,null,!1,!1,n.f_);if(r instanceof u9)return new zit(e.Af,n.__,r,!1,!1,n.f_);throw v6()}))},t.prototype.set=function(t,e,n){var r=Qit(0,t,this.Af);n=Grt("Transaction.set",n);var i=Zit(r.f_,e,n),o=mit(this.Af.wf,"Transaction.set",r.__,i,null!==r.f_,n);return this.Rf.set(r.__,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Qrt?(r=Qit(0,t,this.Af),i=vit(this.Af.wf,"Transaction.update",r.__,e,n,o)):(r=Qit(0,t,this.Af),i=git(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,i),this},t.prototype.delete=function(t){var e=Qit(0,t,this.Af);return this.Rf.delete(e.__),this},t}(),jit=function(){function t(t){this.Af=t,this.Pf=[],this.gf=!1}return t.prototype.set=function(t,e,n){this.Vf();var r=Qit(0,t,this.Af);n=Grt("WriteBatch.set",n);var i=Zit(r.f_,e,n),o=mit(this.Af.wf,"WriteBatch.set",r.__,i,null!==r.f_,n);return this.Pf=this.Pf.concat(o.d_(r.__,z7.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Vf(),"string"==typeof e||e instanceof Qrt?(r=Qit(0,t,this.Af),i=vit(this.Af.wf,"WriteBatch.update",r.__,e,n,o)):(r=Qit(0,t,this.Af),i=git(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(i.d_(r.__,z7.exists(!0))),this},t.prototype.delete=function(t){this.Vf();var e=Qit(0,t,this.Af);return this.Pf=this.Pf.concat(new n9(e.__,z7.ze())),this},t.prototype.commit=function(){return this.Vf(),this.gf=!0,this.Pf.length>0?this.Af.uf().write(this.Pf):Promise.resolve()},t.prototype.Vf=function(){if(this.gf)throw new l6(c6.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Vit=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.l_,e,r)||this).__=e,i.firestore=n,i.f_=r,i.lf=i.firestore.uf(),i}return Object(uR.c)(e,t),e.mf=function(t,n,r){if(t.length%2!=0)throw new l6(c6.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new e(new z6(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Yit(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(Hrt("DocumentReference.collection","path",t),!t)throw new l6(c6.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=j6.q(t);return new Yit(this.__.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){return t instanceof e&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},e.prototype.set=function(t,e){e=Grt("DocumentReference.set",e);var n=Zit(this.f_,t,e),r=mit(this.firestore.wf,"DocumentReference.set",this.__,n,null!==this.f_,e);return this.lf.write(r.d_(this.__,z7.ze()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Qrt?vit(this.firestore.wf,"DocumentReference.update",this.__,t,e,r):git(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(n.d_(this.__,z7.exists(!0)))},e.prototype.delete=function(){return this.lf.write([new n9(this.__,z7.ze())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Rit(i[a])||(s=i[a],a++);var u={includeMetadataChanges:s.includeMetadataChanges};if(Rit(i[a])){var c=i[a];i[a]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[a+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[a+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}var l={next:function(t){i[a]&&i[a](r.yf(t))},error:i[a+1],complete:i[a+2]};return this.lf.listen(f9(this.__.path),u,l)},e.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then((function(t){return new zit(e.firestore,e.__,t,!0,t instanceof u9&&t.Ye,e.f_)})):n.U_(this.__,t).then((function(t){return e.yf(t)}))},e.prototype.withConverter=function(t){return new e(this.__,this.firestore,t)},e.prototype.yf=function(t){var e=t.docs.get(this.__);return new zit(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},e}(cit),Uit=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),zit=function(){function t(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}return t.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new Wit(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new Oit(this.Af.l_,t.serverTimestamps||"none",(function(t){return new Vit(t,e.Af,null)}),(function(t){return new A6(t)})).J_(this.pf.rn())}},t.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf){var r=this.pf.data().field(Cit("DocumentSnapshot.get",t,this.__));if(null!==r)return new Oit(this.Af.l_,e.serverTimestamps||"none",(function(t){return new Vit(t,n.Af,n.f_)}),(function(t){return new A6(t)})).J_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Vit(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Uit(this.vf,this.bf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&this.bf===e.bf&&this.__.isEqual(e.__)&&(null===this.pf?null===e.pf:this.pf.isEqual(e.pf))&&this.f_===e.f_},t}(),Wit=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(zit);function qit(t,e,n){if("string"==typeof n){if(""===n)throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!y9(e)&&-1!==n.indexOf("/"))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(j6.q(n));if(!z6.X(r))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return z8(t,new z6(r))}if(n instanceof cit)return z8(t,n.__);throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Krt(n)+".")}function Hit(t,e){if(!Array.isArray(t)||0===t.length)throw new l6(c6.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new l6(c6.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Git(t,e,n){if(!n.isEqual(e))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function $it(t){if(m9(t)&&0===t.on.length)throw new l6(c6.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kit=function(){function t(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}return t.prototype.where=function(e,n,r){var i=Cit("Query.where",e),o=function(t,e,n,r,i,o,s){var a;if(i.W()){if("array-contains"===o||"array-contains-any"===o)throw new l6(c6.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Hit(s,o);for(var u=[],c=0,l=s;c<l.length;c++)u.push(qit(r,t,l[c]));a={arrayValue:{values:u}}}else a=qit(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Hit(s,o),a=yit(n,"Query.where",s,"in"===o||"not-in"===o);var h=A9.create(i,o,a);return function(t,e){if(e.un()){var n=v9(t);if(null!==n&&!n.isEqual(e.field))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=g9(t);null!==r&&Git(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new l6(c6.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,h),h}(this.Sf,0,this.firestore.wf,this.firestore.l_,i,n,r);return new t(function(t,e){var n=t.filters.concat([e]);return new h9(t.path,t.collectionGroup,t.on.slice(),n,t.limit,t.an,t.startAt,t.endAt)}(this.Sf,o),this.firestore,this.f_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new l6(c6.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Cit("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new l6(c6.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new l6(c6.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new z9(e,n);return function(t,e){if(null===g9(t)){var n=v9(t);null!==n&&Git(0,n,e.field)}}(t,r),r}(this.Sf,i,r);return new t(function(t,e){var n=t.on.concat([e]);return new h9(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(this.Sf,o),this.firestore,this.f_)},t.prototype.limit=function(e){return Xrt("Query.limit",e),new t(_9(this.Sf,e,"F"),this.firestore,this.f_)},t.prototype.limitToLast=function(e){return Xrt("Query.limitToLast",e),new t(_9(this.Sf,e,"L"),this.firestore,this.f_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAt",e,n,!0);return new t(x9(this.Sf,i),this.firestore,this.f_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAfter",e,n,!1);return new t(x9(this.Sf,i),this.firestore,this.f_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endBefore",e,n,!0);return new t(C9(this.Sf,i),this.firestore,this.f_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endAt",e,n,!1);return new t(C9(this.Sf,i),this.firestore,this.f_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&E9(this.Sf,e.Sf)&&this.f_===e.f_},t.prototype.withConverter=function(e){return new t(this.Sf,this.firestore,e)},t.prototype.Df=function(t,e,n,r){if(e instanceof zit)return function(t,e,n,r,i){if(!r)throw new l6(c6.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=b9(t);s<a.length;s++){var u=a[s];if(u.field.W())o.push(z8(e,r.key));else{var c=r.field(u.field);if(R8(c))throw new l6(c6.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.B();throw new l6(c6.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new B9(o,i)}(this.Sf,this.firestore.l_,t,e.pf,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new l6(c6.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.W()){if("string"!=typeof c)throw new l6(c6.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!y9(t)&&-1!==c.indexOf("/"))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(j6.q(c));if(!z6.X(l))throw new l6(c6.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new z6(l);a.push(z8(e,h))}else{var d=yit(n,r,c);a.push(d)}}return new B9(a,o)}(this.Sf,this.firestore.l_,this.firestore.wf,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s={},a=0;if("object"!=typeof i[a]||Rit(i[a])||(s=i[a],a++),Rit(i[a])){var u=i[a];i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)}var c={next:function(t){i[a]&&i[a](new Xit(r.firestore,r.Sf,t,r.f_))},error:i[a+1],complete:i[a+2]};return $it(this.Sf),this.firestore.uf().listen(this.Sf,s,c)},t.prototype.get=function(t){var e=this;$it(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then((function(t){return new Xit(e.firestore,e.Sf,t,e.f_)}))},t}(),Xit=function(){function t(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new Uit(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Nf.docs.forEach((function(r){t.call(e,n.kf(r,n.metadata.fromCache,n.Nf.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Kit(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=!(!t||!t.includeMetadataChanges);if(e&&this.Nf.jt)throw new l6(c6.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===e||(this.xf=function(t,e,n){if(t.Kt.P()){var r=0;return t.docChanges.map((function(e){return{type:"added",doc:n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),oldIndex:-1,newIndex:r++}}))}var i=t.Kt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:Jit(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Nf,e,this.kf.bind(this)),this.Ff=e),this.xf},t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&E9(this.Cf,e.Cf)&&this.Nf.isEqual(e.Nf)&&this.f_===e.f_},t.prototype.kf=function(t,e,n){return new Wit(this.Af,t.key,t,e,n,this.f_)},t}(),Yit=function(t){function e(e,n,r){var i=this;if((i=t.call(this,f9(e),n,r)||this).Of=e,e.length%2!=1)throw new l6(c6.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.B()+" has "+e.length);return i}return Object(uR.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new Vit(new z6(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){0===arguments.length&&(t=_6.t()),Hrt("CollectionReference.doc","path",t);var e=j6.q(t);return Vit.mf(this.Sf.path.child(e),this.firestore,this.f_)},e.prototype.add=function(t){var e=this.f_?this.f_.toFirestore(t):t,n=this.doc();return new Vit(n.__,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Of,this.firestore,t)},e}(Kit);function Qit(t,e,n){var r=function(t,e){if(!(t instanceof e)){if(e.name===t.constructor.name)throw new l6(c6.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Krt(t);throw new l6(c6.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}(e,Vit);if(r.firestore!==n)throw new l6(c6.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function Jit(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return v6()}}function Zit(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var tot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(uR.c)(e,t),e.serverTimestamp=function(){var t=new nit("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new tit("deleteField");return t.t_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rit("arrayUnion",t)}).apply(void 0,t);return r.t_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new iit("arrayRemove",t)}).apply(void 0,t);return r.t_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new oit("increment",t)}(t);return n.t_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},e}(ait),eot={Firestore:Lit,GeoPoint:sit,Timestamp:F6,Blob:A6,Transaction:Bit,WriteBatch:jit,DocumentReference:Vit,DocumentSnapshot:zit,Query:Kit,QueryDocumentSnapshot:Wit,QuerySnapshot:Xit,CollectionReference:Yit,FieldPath:Qrt,FieldValue:tot,setLogLevel:function(t){h6.setLogLevel(t)},CACHE_SIZE_UNLIMITED:Nit};!function(t){!function(t,e){t.INTERNAL.registerComponent(new u6.a("firestore",(function(t){return function(t,e){return new Lit(t,e,new Fit)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},eot)))}(t),t.registerVersion("@firebase/firestore","2.0.0")}(u2.a);var not={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},rot=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Object(uR.c)(e,t),e}(Error),iot=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t;return Object(uR.d)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(e){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function oot(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var sot,aot,uot,cot=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return oot(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?oot(t,(function(t){return e.decode(t)})):t},t}(),lot=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new cot,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new iot(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var s=new URL(r);this.customDomain=s.origin,this.region="us-central1"}catch(a){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,d;return Object(uR.d)(this,(function(f){switch(f.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=f.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new rot("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(n.timeout||7e4),u=a.timer,c=a.promise,[4,Promise.race([hot(u,this.postJSON(r,i,o)),c,hot(u,this.cancelAllRequests)])];case 2:if(!(l=f.sent()))throw new rot("cancelled","Firebase Functions instance was deleted.");if(h=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!not[a])return new rot("internal","internal");r=not[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(c){}return"ok"===r?null:new rot(r,i,o)}(l.status,l.json,this.serializer))throw h;if(!l.json)throw new rot("internal","Response is not valid JSON object.");if(void 0===(d=l.json.data)&&(d=l.json.result),void 0===d)throw new rot("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function hot(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}sot=u2.a,aot=fetch.bind(self),uot={Functions:lot},sot.INTERNAL.registerComponent(new u6.a("functions",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new lot(n,r,i,e,aot)}),"PUBLIC").setServiceProps(uot).setMultipleInstances(!0)),u2.a.registerVersion("@firebase/functions","0.6.0");var dot,fot=n("nbvr"),pot=((dot={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',dot["not-registered"]="Firebase Installation is not registered.",dot["installation-not-found"]="Firebase Installation not found.",dot["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',dot["app-offline"]="Could not process request. Application offline.",dot["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",dot),mot=new l2.b("installations","Installations",pot);function got(t){return t instanceof l2.c&&t.code.includes("request-failed")}function vot(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function yot(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function bot(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),[2,mot.create("request-failed",{requestName:t,serverCode:(r=n.error).code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function wot(t){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey})}function _ot(t,e){var n=e.refreshToken,r=wot(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function xot(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Cot(t,e){var n=e.fid;return Object(uR.b)(this,void 0,void 0,(function(){var e,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return e=vot(t),r=wot(t),i={method:"POST",headers:r,body:JSON.stringify({fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:"w:0.4.18"})},[4,xot((function(){return fetch(e,i)}))];case 1:return(o=a.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,{fid:(s=a.sent()).fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:yot(s.authToken)}];case 3:return[4,bot("Create Installation",o)];case 4:throw a.sent()}}))}))}function Eot(t){return new Promise((function(e){setTimeout(e,t)}))}var Sot=/^[cdef][\w-]{21}$/;function Iot(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,Object(uR.f)(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Sot.test(e)?e:""}catch(Ult){return""}}function kot(t){return t.appName+"!"+t.appId}var Tot=new Map;function Aot(t,e){var n=kot(t);Rot(n,e),function(t,e){var n=Not();n&&n.postMessage({key:t,fid:e}),Dot()}(n,e)}function Rot(t,e){var n,r,i=Tot.get(t);if(i)try{for(var o=Object(uR.h)(i),s=o.next();!s.done;s=o.next())(0,s.value)(e)}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var Oot=null;function Not(){return!Oot&&"BroadcastChannel"in self&&((Oot=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Rot(t.data.key,t.data.fid)}),Oot}function Dot(){0===Tot.size&&Oot&&(Oot.close(),Oot=null)}var Pot,Mot="firebase-installations-store",Fot=null;function Lot(){return Fot||(Fot=Object(fot.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Mot)}}))),Fot}function Bot(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return n=kot(t),[4,Lot()];case 1:return r=a.sent(),i=r.transaction(Mot,"readwrite"),[4,(o=i.objectStore(Mot)).get(n)];case 2:return s=a.sent(),[4,o.put(e,n)];case 3:return a.sent(),[4,i.complete];case 4:return a.sent(),s&&s.fid===e.fid||Aot(t,e.fid),[2,e]}}))}))}function jot(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return e=kot(t),[4,Lot()];case 1:return n=i.sent(),[4,(r=n.transaction(Mot,"readwrite")).objectStore(Mot).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Vot(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return n=kot(t),[4,Lot()];case 1:return r=u.sent(),i=r.transaction(Mot,"readwrite"),[4,(o=i.objectStore(Mot)).get(n)];case 2:return s=u.sent(),void 0!==(a=e(s))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(a,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!a||s&&s.fid===a.fid||Aot(t,a.fid),[2,a]}}))}))}function Uot(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,Vot(t,(function(n){var r=function(t){return qot(t||{fid:Iot(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(mot.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Cot(t,e)];case 1:return n=i.sent(),[2,Bot(t,n)];case 2:return got(r=i.sent())&&409===r.customData.serverCode?[4,jot(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Bot(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:zot(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function zot(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return[4,Wot(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Eot(100)];case 3:return o.sent(),[4,Wot(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Uot(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function Wot(t){return Vot(t,(function(t){if(!t)throw mot.create("installation-not-found");return qot(t)}))}function qot(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Hot(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Object(uR.b)(this,void 0,void 0,(function(){var t,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return t=function(t,e){var n=e.fid;return vot(t)+"/"+n+"/authTokens:generate"}(n,e),i=_ot(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),s={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:"w:0.4.18"}})},[4,xot((function(){return fetch(t,s)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,yot(u.sent())];case 3:return[4,bot("Generate Auth Token",a)];case 4:throw u.sent()}}))}))}function Got(t,e){return void 0===e&&(e=!1),Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return[4,Vot(t.appConfig,(function(r){if(!Kot(r))throw mot.create("not-registered");var i,o=r.authToken;if(!e&&2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i))return r;if(1===o.requestStatus)return n=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,$ot(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Eot(100)];case 3:return i.sent(),[4,$ot(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,Got(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw mot.create("app-offline");var s=function(t){var e={requestStatus:1,requestTime:Date.now()};return Object(uR.a)(Object(uR.a)({},t),{authToken:e})}(r);return n=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,Hot(t,e)];case 1:return n=o.sent(),i=Object(uR.a)(Object(uR.a)({},e),{authToken:n}),[4,Bot(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!got(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,jot(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=Object(uR.a)(Object(uR.a)({},e),{authToken:{requestStatus:0}}),[4,Bot(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,s),s}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function $ot(t){return Vot(t,(function(t){if(!Kot(t))throw mot.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object(uR.a)(Object(uR.a)({},t),{authToken:{requestStatus:0}}):t}))}function Kot(t){return void 0!==t&&2===t.registrationStatus}function Xot(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,Uot(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Yot(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return n=function(t,e){var n=e.fid;return vot(t)+"/"+n}(t,e),r=_ot(t,e),i={method:"DELETE",headers:r},[4,xot((function(){return fetch(n,i)}))];case 1:return(o=s.sent()).ok?[3,3]:[4,bot("Delete Installation",o)];case 2:throw s.sent();case 3:return[2]}}))}))}function Qot(t){return mot.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new u6.a("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Qot("App Configuration");if(!t.name)throw Qot("App Name");try{for(var r=Object(uR.h)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Qot(o)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,Uot(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Got(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,Xot(t.appConfig)];case 1:return n.sent(),[4,Got(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,Vot(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw mot.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw mot.create("app-offline");case 3:return[4,Yot(e,n)];case 4:return r.sent(),[4,jot(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){Not();var n=kot(t),r=Tot.get(n);r||(r=new Set,Tot.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=kot(t),r=Tot.get(n);r&&(r.delete(e),0===r.size&&Tot.delete(n),Dot())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.18")}(u2.a);var Jot=((Pot={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Pot["only-available-in-window"]="This method is available in a Window context.",Pot["only-available-in-sw"]="This method is available in a service worker context.",Pot["permission-default"]="The notification permission was not granted and dismissed instead.",Pot["permission-blocked"]="The notification permission was not granted and blocked instead.",Pot["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Pot["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Pot["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Pot["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Pot["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Pot["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Pot["token-update-no-token"]="FCM returned no token when updating the user to push.",Pot["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Pot["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Pot["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Pot["invalid-vapid-key"]="The public VAPID key must be a string.",Pot["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Pot),Zot=new l2.b("messaging","Messaging",Jot),tst="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",est=function(t){return t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",t}({});function nst(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Object(uR.f)(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rst(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function ist(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes("fcm_token_details_db"))return[2,null];r.label=2;case 2:return e=null,[4,Object(fot.openDb)("fcm_token_details_db",5,(function(r){return Object(uR.b)(n,void 0,void 0,(function(){var n,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains("fcm_token_object_Store")?[4,(n=r.transaction.objectStore("fcm_token_object_Store")).index("fcmSenderId").get(t)]:[2];case 1:return i=a.sent(),[4,n.clear()];case 2:if(a.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(s=o.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:nst(o.vapidKey)}}}else 3===r.oldVersion?e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:nst(o.auth),p256dh:nst(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:nst(o.vapidKey)}}:4===r.oldVersion&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:nst(o.auth),p256dh:nst(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:nst(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,Object(fot.deleteDb)("fcm_token_details_db")];case 4:return r.sent(),[4,Object(fot.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,Object(fot.deleteDb)("undefined")];case 6:return r.sent(),[2,ost(e)?e:null]}}))}))}function ost(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var sst=null;function ast(){return sst||(sst=Object(fot.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore("firebase-messaging-store")}}))),sst}function ust(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return e=hst(t),[4,ast()];case 1:return[4,i.sent().transaction("firebase-messaging-store").objectStore("firebase-messaging-store").get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,ist(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,cst(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function cst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return n=hst(t),[4,ast()];case 1:return r=o.sent(),[4,(i=r.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function lst(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return e=hst(t),[4,ast()];case 1:return n=i.sent(),[4,(r=n.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function hst(t){return t.appConfig.appId}function dst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return[4,gst(t)];case 1:n=a.sent(),r=vst(e),i={method:"POST",headers:n,body:JSON.stringify(r)},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(mst(t.appConfig),i)];case 3:return[4,a.sent().json()];case 4:return o=a.sent(),[3,6];case 5:throw s=a.sent(),Zot.create("token-subscribe-failed",{errorInfo:s});case 6:if(o.error)throw Zot.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw Zot.create("token-subscribe-no-token");return[2,o.token]}}))}))}function fst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return[4,gst(t)];case 1:n=a.sent(),r=vst(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(mst(t.appConfig)+"/"+e.token,i)];case 3:return[4,a.sent().json()];case 4:return o=a.sent(),[3,6];case 5:throw s=a.sent(),Zot.create("token-update-failed",{errorInfo:s});case 6:if(o.error)throw Zot.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw Zot.create("token-update-no-token");return[2,o.token]}}))}))}function pst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return[4,gst(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(mst(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw Zot.create("token-unsubscribe-failed",{errorInfo:i.error.message});return[3,6];case 5:throw o=s.sent(),Zot.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}}))}))}function mst(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function gst(t){var e=t.appConfig,n=t.installations;return Object(uR.b)(this,void 0,void 0,(function(){var t;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function vst(t){var e=t.vapidKey,n={web:{endpoint:t.endpoint,auth:t.auth,p256dh:t.p256dh}};return e!==tst&&(n.web.applicationPubKey=e),n}function yst(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:if("granted"!==Notification.permission)throw Zot.create("permission-blocked");return[4,xst(e,n)];case 1:return r=a.sent(),[4,ust(t)];case 2:return i=a.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:nst(r.getKey("auth")),p256dh:nst(r.getKey("p256dh"))},i?[3,3]:[2,_st(t,o)];case 3:if(l=(c=o).endpoint===(u=i.subscriptionOptions).endpoint,c.vapidKey===u.vapidKey&&l&&c.auth===u.auth&&c.p256dh===u.p256dh)return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,pst(t,i.token)];case 5:return a.sent(),[3,7];case 6:return s=a.sent(),console.warn(s),[3,7];case 7:return[2,_st(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,wst({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l}))}))}function bst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,ust(t)];case 1:return(n=i.sent())?[4,pst(t,n.token)]:[3,4];case 2:return i.sent(),[4,lst(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function wst(t,e,n){return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,5]),[4,fst(e,t)];case 1:return r=s.sent(),i=Object(uR.a)(Object(uR.a)({},t),{token:r,createTime:Date.now()}),[4,cst(e,i)];case 2:return s.sent(),[2,r];case 3:return o=s.sent(),[4,bst(e,n)];case 4:throw s.sent(),o;case 5:return[2]}}))}))}function _st(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,dst(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,cst(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function xst(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:rst(e)})]}}))}))}function Cst(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Est(t){return new Promise((function(e){setTimeout(e,t)}))}var Sst=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw Zot.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,ust(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:tst,r.label=2;case 2:return[2,yst(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return bst(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw Zot.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Zot.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Zot.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw Zot.create("only-available-in-window")},t.prototype.onMessage=function(){throw Zot.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw Zot.create("only-available-in-window")},t.prototype.onPush=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t))?[4,Ast()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Tst(n,e)]:(r=!1,e.notification?[4,Rst(Ist(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[2])}}))}))},t.prototype.onSubChange=function(t){var e,n;return Object(uR.b)(this,void 0,void 0,(function(){var r;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,bst(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,ust(this.firebaseDependencies)];case 3:return r=i.sent(),[4,bst(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,yst(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:tst)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return Object(uR.b)(this,void 0,void 0,(function(){var r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r;return(null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action)||(Cst(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),s=new URL(self.location.origin),o.host!==s.host?[2]:[4,kst(o)]):[2]):[2];case 1:return(a=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return a=u.sent(),[4,Est(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,a.focus()];case 5:a=u.sent(),u.label=6;case 6:return a?(r.messageType=est.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,a.postMessage(r)]):[2]}}))}))},t}();function Ist(t){var e,n=Object(uR.a)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function kst(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return[4,Ast()];case 1:e=u.sent();try{for(n=Object(uR.h)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(c){s={error:c}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return[2,null]}}))}))}function Tst(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=est.PUSH_RECEIVED;try{for(var i=Object(uR.h)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Ast(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Rst(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Ost=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===est.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),Cst(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw Zot.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,yst(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=tst),[2]}))}))},t.prototype.updateSwReg=function(t){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw Zot.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),Zot.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,bst(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t;return Object(uR.d)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw Zot.create("denied"===t?"permission-blocked":"permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Zot.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Zot.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Zot.create("invalid-sw-registration");if(this.swRegistration)throw Zot.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw Zot.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw Zot.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case est.NOTIFICATION_CLICKED:return"notification_open";case est.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Nst(t){return Zot.create("missing-app-config-values",{valueName:t})}var Dst={isSupported:Pst};function Pst(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}u2.a.INTERNAL.registerComponent(new u6.a("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Nst("App Configuration Object");if(!t.name)throw Nst("App Name");var r=t.options;try{for(var i=Object(uR.h)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw Nst(s)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Pst())throw Zot.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Sst(n):new Ost(n)}),"PUBLIC").setServiceProps(Dst));var Mst=function(t){function e(n,r){var i=t.call(this,Fst(n),"Firebase Storage: "+r)||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return Object(uR.c)(e,t),e.prototype.codeEquals=function(t){return Fst(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(l2.c);function Fst(t){return"storage/"+t}function Lst(){return new Mst("unknown","An unknown error occurred, please check the error payload for server response.")}function Bst(){return new Mst("canceled","User canceled the upload/download.")}function jst(){return new Mst("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Vst(){return new Mst("app-deleted","The Firebase app was deleted.")}function Ust(t,e){return new Mst("invalid-format","String does not match format '"+t+"': "+e)}function zst(t){throw new Mst("internal-error","Internal error: "+t)}var Wst={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},qst=function(){return function(t,e){this.data=t,this.contentType=e||null}}();function Hst(t,e){switch(t){case Wst.RAW:return new qst(Gst(e));case Wst.BASE64:case Wst.BASE64URL:return new qst($st(t,e));case Wst.DATA_URL:return new qst((n=new Kst(e)).base64?$st(Wst.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(n){throw Ust(Wst.DATA_URL,"Malformed data URL.")}return Gst(e)}(n.rest),function(t){return new Kst(t).contentType}(e))}var n;throw Lst()}function Gst(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1))){var i=r,o=t.charCodeAt(++n);e.push(240|(r=65536|(1023&i)<<10|1023&o)>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function $st(t,e){switch(t){case Wst.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw Ust(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Wst.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw Ust(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(c){throw Ust(t,"Invalid character found")}for(var a=new Uint8Array(s.length),u=0;u<s.length;u++)a[u]=s.charCodeAt(u);return a}var Kst=function(){return function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Ust(Wst.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r=e[1]||null;null!=r&&(this.base64=(n=r).length>=";base64".length&&";base64"===n.substring(n.length-";base64".length),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)}}(),Xst={STATE_CHANGED:"state_changed"},Yst={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qst(t){switch(t){case"running":case"pausing":case"canceling":return Yst.RUNNING;case"paused":return Yst.PAUSED;case"success":return Yst.SUCCESS;case"canceled":return Yst.CANCELED;case"error":default:return Yst.ERROR}}function Jst(t){return null!=t}function Zst(t){return"string"==typeof t||t instanceof String}function tat(t){return eat()&&t instanceof Blob}function eat(){return"undefined"!=typeof Blob}function nat(t,e,n,r){if(r<e)throw new Mst("invalid-argument","Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw new Mst("invalid-argument","Invalid value for '"+t+"'. Expected "+n+" or less.")}var rat=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}({}),iat=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=rat.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=rat.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=rat.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw zst("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),Jst(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return Jst(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw zst("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw zst("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw zst("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){Jst(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){Jst(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),oat=function(){function t(){}return t.prototype.createXhrIo=function(){return new iat},t}();function sat(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function aat(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=sat();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(eat())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}var uat=function(){function t(t,e){var n=0,r="";tat(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(tat(this.data_)){var r=(o=e,s=n,(i=this.data_).webkitSlice?i.webkitSlice(o,s):i.mozSlice?i.mozSlice(o,s):i.slice?i.slice(o,s):null);return null===r?null:new t(r)}var i,o,s;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(eat()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(aat.apply(null,r))}var i=e.map((function(t){return Zst(t)?Hst(Wst.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var s=new Uint8Array(o),a=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)s[a++]=t[e]})),new t(s,!0)},t.prototype.uploadData=function(){return this.data_},t}(),cat=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(r){return new t(e,"")}if(""===n.path)return n;throw new Mst("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function i(t){t.path_=decodeURIComponent(t.path)}for(var o="firebasestorage.googleapis.com".replace(/[.]/g,"\\."),s=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:i}],a=0;a<s.length;a++){var u=s[a],c=u.regex.exec(e);if(c){var l=c[u.indices.path];l||(l=""),n=new t(c[u.indices.bucket],l),u.postModify(n);break}}if(null==n)throw function(t){return new Mst("invalid-url","Invalid URL '"+t+"'.")}(e);return n},t}();function lat(t){var e,n;try{e=JSON.parse(t)}catch(r){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function hat(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function dat(t){return"https://firebasestorage.googleapis.com/v0"+t}function fat(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}function pat(t,e){return e}var mat=function(){return function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||pat}}(),gat=null;function vat(t,e,n){var r=lat(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=new cat(t.bucket,t.fullPath);return e.makeStorageReference(n)}})}(r,t),r}(t,r,n)}function yat(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var bat=function(){return function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}();function wat(t){if(!t)throw Lst()}function _at(t,e){return function(n,r){var i=vat(t,r,e);return wat(null!==i),i}}function xat(t){return function(e,n){var r;return(r=401===e.getStatus()?new Mst("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?new Mst("quota-exceeded","Quota for bucket '"+t.bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/."):403===e.getStatus()?new Mst("unauthorized","User does not have permission to access '"+t.path+"'."):n).serverResponse=n.serverResponse,r}}function Cat(t){var e=xat(t);return function(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=new Mst("object-not-found","Object '"+t.path+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Eat(t,e,n){var r=dat(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new bat(r,"GET",_at(t,n),i);return o.errorHandler=Cat(e),o}function Sat(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var Iat=function(){return function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}}();function kat(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(r){wat(!1)}return wat(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Tat=function(){return function(t,e,n){if("function"==typeof t||Jst(e)||Jst(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}}(),Aat=function(){return function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}}();function Rat(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Oat=function(){function t(t,e,n,r,i,o){var s=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.service_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_="running",this.errorHandler_=function(t){s.request_=null,s.chunkMultiplier_=1,t.codeEquals("canceled")?(s.needToFetchStatus_=!0,s.completeTransitions_()):(s.error_=t,s.transition_("error"))},this.metadataErrorHandler_=function(t){s.request_=null,t.codeEquals("canceled")?s.completeTransitions_():(s.error_=t,s.transition_("error"))},this.promise_=new Promise((function(t,e){s.resolve_=t,s.reject_=e,s.start_()})),this.promise_.then(null,(function(){}))}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){"running"===this.state_&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.service_.getAuthToken().then((function(n){switch(e.state_){case"running":t(n);break;case"canceling":e.transition_("canceled");break;case"pausing":e.transition_("paused")}}))},t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s=Sat(e,r,i),a={name:s.fullPath},u=dat(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},l=yat(s,n),h=new bat(u,"POST",(function(t){var e;kat(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){wat(!1)}return wat(Zst(e)),e}),t.maxUploadRetryTime);return h.urlParams=a,h.headers=c,h.body=l,h.errorHandler=xat(e),h}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_((function(n){var r=function(t,e,n,r){var i=new bat(n,"POST",(function(t){var e=kat(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){wat(!1)}n||wat(!1);var i=Number(n);return wat(!isNaN(i)),new Iat(i,r.size(),"final"===e)}),t.maxUploadRetryTime);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=xat(e),i}(t.service_,t.location_,e,t.blob_),i=t.service_.makeRequest(r,n);t.request_=i,i.getPromise().then((function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new Iat(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=function(t,e,n,r,i,o,s,a){var u=new Iat(0,0);if(s?(u.current=s.current,u.total=s.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Mst("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,d={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},f=r.slice(h,h+l);if(null===f)throw jst();var p=new bat(n,"POST",(function(t,n){var i,s=kat(t,["active","final"]),a=u.current+l,c=r.size();return i="final"===s?_at(e,o)(t,n):null,new Iat(a,c,"final"===s,i)}),e.maxUploadRetryTime);return p.headers=d,p.body=f.uploadData(),p.progressCallback=a||null,p.errorHandler=xat(t),p}(t.location_,t.service_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(a){return t.error_=a,void t.transition_("error")}var s=t.service_.makeRequest(o,i);t.request_=s,s.getPromise().then((function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_("success")):t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=Eat(t.service_,t.location_,t.mappings_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.transition_("success")}),t.metadataErrorHandler_)}))},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+a;var u=Sat(e,r,i),c=yat(u,n),l=uat.getBlob("--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",r,"\r\n--"+a+"--");if(null===l)throw jst();var h={name:u.fullPath},d=dat(o),f=t.maxUploadRetryTime,p=new bat(d,"POST",_at(t,n),f);return p.urlParams=h,p.headers=s,p.body=l.uploadData(),p.errorHandler=xat(e),p}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_("success")}),t.errorHandler_)}))},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case"canceling":case"pausing":this.state_=t,null!==this.request_&&this.request_.cancel();break;case"running":var e="paused"===this.state_;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case"paused":this.state_=t,this.notifyObservers_();break;case"canceled":this.error_=Bst(),this.state_=t,this.notifyObservers_();break;case"error":case"success":this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case"pausing":this.transition_("paused");break;case"canceling":this.transition_("canceled");break;case"running":this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Qst(this.state_);return new Aat(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Tat(e,n,r);return this.addObserver_(o),function(){i.removeObserver_(o)}},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach((function(e){t.notifyObserver_(e)}))},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(Qst(this.state_)){case Yst.SUCCESS:Rat(this.resolve_.bind(null,this.snapshot))();break;case Yst.CANCELED:case Yst.ERROR:Rat(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(Qst(this.state_)){case Yst.RUNNING:case Yst.PAUSED:t.next&&Rat(t.next.bind(t,this.snapshot))();break;case Yst.SUCCESS:t.complete&&Rat(t.complete.bind(t))();break;case Yst.CANCELED:case Yst.ERROR:t.error&&Rat(t.error.bind(t,this.error_))();break;default:t.error&&Rat(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){var t="paused"===this.state_||"pausing"===this.state_;return t&&this.transition_("running"),t},t.prototype.pause=function(){var t="running"===this.state_;return t&&this.transition_("pausing"),t},t.prototype.cancel=function(){var t="running"===this.state_||"pausing"===this.state_;return t&&this.transition_("canceling"),t},t}(),Nat=function(){function t(t,e){this.service=t,this.location=e instanceof cat?e:cat.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return function(){if(gat)return gat;var t=[];t.push(new mat("bucket")),t.push(new mat("generation")),t.push(new mat("metageneration")),t.push(new mat("name","fullPath",!0));var e=new mat("name");e.xform=function(t,e){return function(t){return!Zst(t)||t.length<2?t:hat(t)}(e)},t.push(e);var n=new mat("size");return n.xform=function(t,e){return Jst(e)?Number(e):e},t.push(n),t.push(new mat("timeCreated")),t.push(new mat("updated")),t.push(new mat("md5Hash",null,!0)),t.push(new mat("cacheControl",null,!0)),t.push(new mat("contentDisposition",null,!0)),t.push(new mat("contentEncoding",null,!0)),t.push(new mat("contentLanguage",null,!0)),t.push(new mat("contentType",null,!0)),t.push(new mat("metadata","customMetadata",!0)),gat=t}()},t.prototype.child=function(t){var e=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new cat(this.location.bucket,e);return this.newRef(this.service,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new cat(this.location.bucket,t);return this.newRef(this.service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new cat(this.location.bucket,"");return this.newRef(this.service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return hat(this.location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.service},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),this.throwIfRoot_("put"),new Oat(this,this.service,this.location,this.mappings(),new uat(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Wst.RAW),this.throwIfRoot_("putString");var r=Hst(e,t),i=Object.assign({},n);return!Jst(i.contentType)&&Jst(r.contentType)&&(i.contentType=r.contentType),new Oat(this,this.service,this.location,this.mappings(),new uat(r.data,!0),i)},t.prototype.delete=function(){var t=this;return this.throwIfRoot_("delete"),this.service.getAuthToken().then((function(e){var n=function(t,e){var n=dat(e.fullServerUrl()),r=new bat(n,"DELETE",(function(t,e){}),t.maxOperationRetryTime);return r.successCodes=[200,204],r.errorHandler=Cat(e),r}(t.service,t.location);return t.service.makeRequest(n,e).getPromise()}))},t.prototype.listAll=function(){var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))},t.prototype.listAllHelper=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return[4,this.list({pageToken:e})];case 1:return n=o.sent(),(r=t.prefixes).push.apply(r,n.prefixes),(i=t.items).push.apply(i,n.items),null==n.nextPageToken?[3,3]:[4,this.listAllHelper(t,n.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.prototype.list=function(t){var e=this,n=t||{};return"number"==typeof n.maxResults&&nat("options.maxResults",1,1e3,n.maxResults),this.service.getAuthToken().then((function(t){var r=function(t,e,n,r,i){var o={};o.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var s=dat(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,u=new bat(s,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=lat(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var s=o[i].replace(/\/$/,""),a=t.makeStorageReference(new cat(e,s));r.prefixes.push(a)}if(n.items)for(var u=0,c=n.items;u<c.length;u++)a=t.makeStorageReference(new cat(e,c[u].name)),r.items.push(a);return r}(t,e,r)}(t,e,r);return wat(null!==i),i}}(t,e.bucket),a);return u.urlParams=o,u.errorHandler=xat(e),u}(e.service,e.location,"/",n.pageToken,n.maxResults);return e.service.makeRequest(r,t).getPromise()}))},t.prototype.getMetadata=function(){var t=this;return this.throwIfRoot_("getMetadata"),this.service.getAuthToken().then((function(e){var n=Eat(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise()}))},t.prototype.updateMetadata=function(t){var e=this;return this.throwIfRoot_("updateMetadata"),this.service.getAuthToken().then((function(n){var r=function(t,e,n,r){var i=dat(e.fullServerUrl()),o=yat(n,r),s=t.maxOperationRetryTime,a=new bat(i,"PATCH",_at(t,r),s);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=Cat(e),a}(e.service,e.location,t,e.mappings());return e.service.makeRequest(r,n).getPromise()}))},t.prototype.getDownloadURL=function(){var t=this;return this.throwIfRoot_("getDownloadURL"),this.service.getAuthToken().then((function(e){var n=function(t,e,n){var r=dat(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new bat(r,"GET",function(t,e){return function(n,r){var i=vat(t,r,e);return wat(null!==i),function(t,e){var n=lat(e);if(null===n)return null;if(!Zst(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.fullPath;return dat("/b/"+i(t.bucket)+"/o/"+i(n))+fat({alt:"media",token:e})}))[0]}(i,r)}}(t,n),i);return o.errorHandler=Cat(e),o}(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new Mst("no-download-url","The given file does not have any download URLs.");return t}))}))},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new Mst("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Dat=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),Pat=function(){function t(t,e,n,r,i,o,s,a,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=s,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,s=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(s,s.getResponseText());void 0!==a?i(a):i()}catch(u){o(u)}else null!==s?((r=Lst()).serverResponse=s.getResponseText(),o(t.errorCallback_?t.errorCallback_(s,r):r)):o(r=n.canceled?t.appDelete_?Vst():Bst():new Mst("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new Mat(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,s=!1,a=0;function u(){return 2===a}var c=!1;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new Mat(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===rat.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var s=-1!==t.successCodes_.indexOf(o);e(!0,new Mat(s,n))}else{var a=n.getErrorCode()===rat.ABORT;e(!1,new Mat(!1,null,a))}}))}function i(e){null!==t.progressCallback_&&t.progressCallback_(e.loaded,e.lengthComputable?e.total:-1)}}(d,u())}),e)}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)l.call.apply(l,Object(uR.g)([null,t],e));else{var r,o=u()||s;o?l.call.apply(l,Object(uR.g)([null,t],e)):(i<64&&(i*=2),1===a?(a=2,r=0):r=1e3*(i+Math.random()),h(r))}}var f=!1;function p(t){f||(f=!0,c||(null!==o?(t||(a=2),clearTimeout(o),h(0)):t||(a=1)))}return h(0),setTimeout((function(){s=!0,p(!0)}),r),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),Mat=function(){return function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}}(),Fat=function(){function t(e,n,r,i){var o;this.bucket_=null,this.appId_=null,this.deleted_=!1,this.app_=e,this.authProvider_=n,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e5,this.requests_=new Set,this.pool_=r,this.bucket_=null!=i?cat.makeFromBucketSpec(i):t.extractBucket_(null===(o=this.app_)||void 0===o?void 0:o.options),this.internals_=new Lat(this)}return t.extractBucket_=function(t){var e=null==t?void 0:t.storageBucket;return null==e?null:cat.makeFromBucketSpec(e)},t.prototype.getAuthToken=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return(t=this.authProvider_.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requests_.forEach((function(t){return t.cancel()})),this.requests_.clear()},t.prototype.makeStorageReference=function(t){return new Nat(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this.deleted_)return new Dat(Vst());var r=function(t,e,n,r){var i=fat(t.urlParams),o=t.url+i,s=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(s,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(s,n),function(t){t["X-Firebase-Storage-Version"]="webjs/"+(void 0!==u2.a?u2.a.SDK_VERSION:"AppManager")}(s),new Pat(o,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this.appId_,e,this.pool_);return this.requests_.add(r),r.getPromise().then((function(){return n.requests_.delete(r)}),(function(){return n.requests_.delete(r)})),r},t.prototype.ref=function(t){if(/^[A-Za-z]+:\/\//.test(t))throw new Mst("invalid-argument","Expected child path but got a URL, use refFromURL instead.");if(null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new Nat(this,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){if(!/^[A-Za-z]+:\/\//.test(t))throw new Mst("invalid-argument","Expected full URL but got a child path, use ref instead.");try{cat.makeFromUrl(t)}catch(e){throw new Mst("invalid-argument","Expected valid full URL but got an invalid one.")}return new Nat(this,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.maxUploadRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){nat("time",0,Number.POSITIVE_INFINITY,t),this.maxUploadRetryTime_=t},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.maxOperationRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){nat("time",0,Number.POSITIVE_INFINITY,t),this.maxOperationRetryTime_=t},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!1,configurable:!0}),t}(),Lat=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.deleteApp(),Promise.resolve()},t}();function Bat(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new Fat(n,r,new oat,e)}function jat(t){var e={TaskState:Yst,TaskEvent:Xst,StringFormat:Wst,Storage:Fat,Reference:Nat};t.INTERNAL.registerComponent(new u6.a("storage",Bat,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.4.0")}jat(u2.a);var Vat,Uat,zat,Wat=((Vat={})["trace started"]="Trace {$traceName} was started before.",Vat["trace stopped"]="Trace {$traceName} is not running.",Vat["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Vat["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Vat["no window"]="Window is not available.",Vat["no app id"]="App id is not available.",Vat["no project id"]="Project id is not available.",Vat["no api key"]="Api key is not available.",Vat["invalid cc log"]="Attempted to queue invalid cc event",Vat["FB not default"]="Performance can only start when Firebase app instance is the default one.",Vat["RC response not ok"]="RC response is not ok",Vat["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Vat["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Vat["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Vat["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Vat),qat=new l2.b("performance","Performance",Wat),Hat=new c2.b("Performance");Hat.logLevel=c2.a.INFO;var Gat,$at=function(){function t(t){if(this.window=t,!t)throw qat.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Object(l2.w)()||(Hat.info("IndexedDB is not supported by current browswer"),!1):(Hat.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++)e(r[n])})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Uat&&(Uat=new t(zat)),Uat},t}();function Kat(t,e){var n=t.length-e.length;if(n<0||n>1)throw qat.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Xat,Yat=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Kat("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Kat("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw qat.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw qat.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw qat.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Gat&&(Gat=new t),Gat},t}();function Qat(){return Xat}var Jat=function(t){return t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN",t}({}),Zat=["firebase_","google_","ga_"],tut=new RegExp("^[a-zA-Z]\\w*$");function eut(){var t=$at.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function nut(){switch($at.getInstance().document.visibilityState){case"visible":return Jat.VISIBLE;case"hidden":return Jat.HIDDEN;default:return Jat.UNKNOWN}}function rut(){var t=$at.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function iut(t){if(!t)return t;var e=Yat.getInstance(),n=t.entries||{};return e.loggingEnabled=void 0===n.fpr_enabled||"true"===String(n.fpr_enabled),n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=out(e.tracesSamplingRate),e.logNetworkAfterSampling=out(e.networkRequestsSamplingRate),t}function out(t){return Math.random()<=t}var sut,aut=1;function uut(){return aut=2,sut=sut||function(){var t=$at.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=Yat.getInstance().installationsService.getId()).then((function(t){Xat=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=$at.getInstance().localStorage;if(t){var e=t.getItem("@firebase/performance/configexpire");if(e&&Number(e)>Date.now()){var n=t.getItem("@firebase/performance/config");if(n)try{return JSON.parse(n)}catch(Ult){return}}}}();return e?(iut(e),Promise.resolve()):function(t){return(e=Yat.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Yat.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Yat.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Yat.getInstance().getAppId(),app_version:"0.4.3",sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw qat.create("RC response not ok")}))})).catch((function(){Hat.info("Could not fetch config, will use default configs")}));var e}(t).then(iut).then((function(t){return function(t){var e=$at.getInstance().localStorage;t&&e&&(e.setItem("@firebase/performance/config",JSON.stringify(t)),e.setItem("@firebase/performance/configexpire",String(Date.now()+60*Yat.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return cut()}),(function(){return cut()}))}function cut(){aut=3}var lut,hut=3,dut=[],fut=!1;function put(t){if(!t.eventTime||!t.message)throw qat.create("invalid cc log");dut=Object(uR.g)(dut,[t])}function mut(t,e){var n;lut||(n=yut,lut=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(void 0,t);put({message:r,eventTime:Date.now()})}),lut(t,e)}function gut(t){var e=Yat.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&$at.getInstance().requiredApisAvailable()&&(t.isAuto&&nut()!==Jat.VISIBLE||(3===aut?vut(t):uut().then((function(){return vut(t)}),(function(){return vut(t)}))))}function vut(t){if(Qat()){var e=Yat.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return mut(t,1)}),0)}}function yut(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:but(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:but(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function but(){return{google_app_id:Yat.getInstance().getAppId(),app_instance_id:Qat(),web_app_info:{sdk_version:"0.4.3",page_url:$at.getInstance().getUrl(),service_worker_status:eut(),visibility_state:nut(),effective_connection_type:rut()},application_process_state:0}}var wut=["_fp","_fcp","_fid"],_ut=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=$at.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw qat.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw qat.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),gut(this)},t.prototype.record=function(t,e,n){if(t<=0)throw qat.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw qat.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object(uR.a)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}gut(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),this.putMetric(t,void 0===this.counters[t]?e:this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||t.length>100)&&(e&&e.startsWith("_wt_")&&wut.indexOf(t)>-1||!t.startsWith("_"))}(t,this.name))throw qat.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Hat.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=function(t){return!(0===t.length||t.length>40||Zat.some((function(e){return t.startsWith(e)}))||!t.match(tut))}(t),r=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw qat.create("invalid attribute name",{attributeName:t});if(!r)throw qat.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Object(uR.a)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=$at.getInstance().getUrl();if(i){var o=new t("_wt_"+i,!0),s=Math.floor(1e3*$at.getInstance().getTimeOrigin());if(o.setStartTime(s),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var a=n.find((function(t){return"first-paint"===t.name}));a&&a.startTime&&o.putMetric("_fp",Math.floor(1e3*a.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))}gut(o)}},t.createUserTimingTrace=function(e){gut(new t(e,!1,e))},t}();function xut(t){var e=t;if(e&&void 0!==e.responseStart){var n=$at.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Yat.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return mut(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Cut(){Qat()&&(setTimeout((function(){return function(){var t=$at.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){_ut.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),_ut.createOobTrace(e,n,t))}))}else _ut.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=$at.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)xut(n[e]);t.setupObserver("resource",xut)}()}),0),setTimeout((function(){return function(){for(var t=$at.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)Eut(n[e]);t.setupObserver("measure",Eut)}()}),0))}function Eut(t){var e=t.name;"FB-PERF-TRACE-MEASURE"!==e.substring(0,"FB-PERF-TRACE-MEASURE".length)&&_ut.createUserTimingTrace(e)}var Sut=function(){function t(t){this.app=t,$at.getInstance().requiredApisAvailable()&&Object(l2.N)().then((function(t){t&&(fut||(function t(e){setTimeout((function(){if(0!==hut)return dut.length?void function(){var e=Object(uR.g)(dut);dut=[];var n=e.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}));(function(e,n){return function(t){var e=Yat.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(e).then((function(t){return t.ok||Hat.info("Call to Firebase backend failed."),t.json()})).then((function(e){var r=Number(e.nextRequestWaitMillis),i=1e4;isNaN(r)||(i=Math.max(r,i));var o=e.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(dut=Object(uR.g)(n,dut),Hat.info("Retry transport request later.")),hut=3,t(i)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Yat.getInstance().logSource,log_event:n},e).catch((function(){dut=Object(uR.g)(e,dut),hut--,Hat.info("Tries left: "+hut+"."),t(1e4)}))}():t(1e4)}),e)}(5500),fut=!0),uut().then(Cut,Cut))})).catch((function(t){Hat.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new _ut(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Yat.getInstance().instrumentationEnabled},set:function(t){Yat.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Yat.getInstance().dataCollectionEnabled},set:function(t){Yat.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new u6.a("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw qat.create("FB not default");if("undefined"==typeof window)throw qat.create("no window");return function(t){zat=t}(window),Yat.getInstance().firebaseAppInstance=t,Yat.getInstance().installationsService=e,new Sut(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance","0.4.3")}(u2.a);var Iut,kut="https://www.googletagmanager.com/gtag/js",Tut=function(t){return t.EVENT="event",t.SET="set",t.CONFIG="config",t}({}),Aut=function(t){return t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results",t}({}),Rut=new c2.b("@firebase/analytics");function Out(t,e,n,r,i,o){return Object(uR.b)(this,void 0,void 0,(function(){var s,a,u,c;return Object(uR.d)(this,(function(l){switch(l.label){case 0:s=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),s?[4,e[s]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return a=l.sent(),(u=a.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),Rut.error(c),[3,8];case 8:return t(Tut.CONFIG,i,o),[2]}}))}))}function Nut(t,e,n,r,i){return Object(uR.b)(this,void 0,void 0,(function(){var o,s,a,u,c,l,h;return Object(uR.d)(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),o=[],i&&i.send_to?(s=i.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(a=d.sent(),u=function(t){var n=a.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=s;c<l.length&&"break"!==u(l[c]);c++);d.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return d.sent(),t(Tut.EVENT,r,i||{}),[3,5];case 4:return h=d.sent(),Rut.error(h),[3,5];case 5:return[2]}}))}))}var Dut=((Iut={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Iut["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Iut["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Iut["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Iut["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Iut["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Iut["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Iut["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Iut["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Iut),Put=new l2.b("analytics","Analytics",Dut),Mut=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Fut(t){var e;return Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return n=t.appId,r={method:"GET",headers:(c=t.apiKey,new Headers({Accept:"application/json","x-goog-api-key":c}))},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(i,r)];case 1:if(200===(o=u.sent()).status||304===o.status)return[3,6];s="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return a=u.sent(),(null===(e=a.error)||void 0===e?void 0:e.message)&&(s=a.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw Put.create("config-fetch-failed",{httpStatus:o.status,responseMessage:s});case 6:return[2,o.json()]}var c}))}))}function Lut(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=Mut),Object(uR.b)(this,void 0,void 0,(function(){var e,s,a,u,c,l,h;return Object(uR.d)(this,(function(d){switch(d.label){case 0:e=t.appId,s=t.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,But(n,i)];case 2:return d.sent(),[3,4];case 3:if(a=d.sent(),s)return Rut.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:e,measurementId:s}];throw a;case 4:return d.trys.push([4,6,,7]),[4,Fut(t)];case 5:return u=d.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof l2.c&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=d.sent())){if(r.deleteThrottleMetadata(e),s)return Rut.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:s}];throw c}return l=503===Number(c.customData.httpStatus)?Object(l2.j)(o,r.intervalMillis,30):Object(l2.j)(o,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:o+1},r.setThrottleMetadata(e,h),Rut.debug("Calling attemptFetch again in "+l+" millis"),[2,Lut(t,h,n,r)];case 7:return[2]}}))}))}function But(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(Put.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var jut,Vut,Uut=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),zut={},Wut=[],qut={},Hut="dataLayer",Gut="gtag",$ut=!1;function Kut(t){if($ut)throw Put.create("already-initialized");t.dataLayerName&&(Hut=t.dataLayerName),t.gtagName&&(Gut=t.gtagName)}function Xut(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:if(Object(l2.s)())return[2,!1];if(!Object(l2.e)())return[2,!1];if(!Object(l2.w)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(l2.N)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new u6.a("analytics",(function(t){return function(t,e){!function(){var t=[];if(Object(l2.s)()&&t.push("This is a browser extension environment."),Object(l2.e)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=Put.create("invalid-analytics-context",{errorInfo:e});Rut.warn(n.message)}}();var n=t.options.appId;if(!n)throw Put.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Put.create("no-api-key");Rut.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=zut[n])throw Put.create("already-exists",{id:n});if(!$ut){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(kut))return r}return null})()||function(t){var e=document.createElement("script");e.src=kut+"?l="+t,e.async=!0,document.head.appendChild(e)}(Hut),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Hut);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,s){return Object(uR.b)(this,void 0,void 0,(function(){var a;return Object(uR.d)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Tut.EVENT?[3,2]:[4,Nut(t,e,n,o,s)];case 1:return u.sent(),[3,5];case 2:return i!==Tut.CONFIG?[3,4]:[4,Out(t,e,n,r,o,s)];case 3:return u.sent(),[3,5];case 4:t(Tut.SET,o),u.label=5;case 5:return[3,7];case 6:return a=u.sent(),Rut.error(a),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(zut,Wut,qut,Hut,Gut);Vut=r.wrappedGtag,jut=r.gtagCore,$ut=!0}return zut[n]=function(t,e,n,r,i){return Object(uR.b)(this,void 0,void 0,(function(){var o,s,a,u,c,l,h;return Object(uR.d)(this,(function(d){switch(d.label){case 0:return(o=function(t,e,n){return void 0===e&&(e=Mut),Object(uR.b)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u=this;return Object(uR.d)(this,(function(c){if(i=(n=t.options).apiKey,o=n.measurementId,!(r=n.appId))throw Put.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw Put.create("no-api-key")}return s=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Uut,setTimeout((function(){return Object(uR.b)(u,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){return a.abort(),[2]}))}))}),6e4),[2,Lut({appId:r,apiKey:i,measurementId:o},s,a,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Rut.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Rut.error(t)})),e.push(o),s=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t;return Object(uR.d)(this,(function(e){switch(e.label){case 0:return Object(l2.w)()?[3,1]:(Rut.warn(Put.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,Object(l2.N)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Rut.warn(Put.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([o,s])];case 1:return a=d.sent(),u=a[0],c=a[1],i("js",new Date),(h={}).origin="firebase",h.update=!0,l=h,null!=c&&(l.firebase_id=c),i(Tut.CONFIG,u.measurementId,l),[2,u.measurementId]}}))}))}(t,Wut,qut,e,jut),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return Object(uR.b)(this,void 0,void 0,(function(){var o,s;return Object(uR.d)(this,(function(a){switch(a.label){case 0:return i&&i.global?(t(Tut.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=a.sent(),s=Object(uR.a)(Object(uR.a)({},r),{send_to:o}),t(Tut.EVENT,n,s),a.label=3;case 3:return[2]}}))}))})(Vut,zut[n],t,e,r).catch((function(t){return Rut.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Tut.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Tut.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(Vut,zut[n],t,e).catch((function(t){return Rut.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i;return Object(uR.d)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Tut.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Tut.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(Vut,zut[n],t,e).catch((function(t){return Rut.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return Object(uR.b)(this,void 0,void 0,(function(){var i,o,s,a,u;return Object(uR.d)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,s=Object.keys(n);o<s.length;o++)i["user_properties."+(a=s[o])]=n[a];return t(Tut.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Tut.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(Vut,zut[n],t,e).catch((function(t){return Rut.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(zut[n],t).catch((function(t){return Rut.error(t)}))},INTERNAL:{delete:function(){return delete zut[n],Promise.resolve()}}}}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Kut,EventName:Aut,isSupported:Xut})),t.INTERNAL.registerComponent(new u6.a("analytics-internal",(function(t){try{return{logEvent:t.getProvider("analytics").getImmediate().logEvent}}catch(e){throw Put.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.1")}(u2.a);var Yut,Qut=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}}))}))},t}(),Jut=((Yut={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",Yut["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",Yut["registration-api-key"]="Undefined API key. Check Firebase app initialization.",Yut["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",Yut["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Yut["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Yut["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Yut["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",Yut["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Yut["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',Yut["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',Yut["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Yut["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Yut),Zut=new l2.b("remoteconfig","Remote Config",Jut),tct=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,l,h,d,f,p,m,g;return Object(uR.d)(this,(function(v){switch(v.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=v.sent(),n=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",r=n+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,i={sdk_version:this.sdkVersion,app_instance_id:e[0],app_instance_id_token:e[1],app_id:this.appId,language_code:(void 0===y&&(y=navigator),y.languages&&y.languages[0]||y.language)},o={method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},body:JSON.stringify(i)},s=fetch(r,o),a=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),v.label=2;case 2:return v.trys.push([2,5,,6]),[4,Promise.race([s,a])];case 3:return v.sent(),[4,s];case 4:return u=v.sent(),[3,6];case 5:throw c=v.sent(),l="fetch-client-network","AbortError"===c.name&&(l="fetch-timeout"),Zut.create(l,{originalErrorMessage:c.message});case 6:if(h=u.status,d=u.headers.get("ETag")||void 0,200!==u.status)return[3,11];m=void 0,v.label=7;case 7:return v.trys.push([7,9,,10]),[4,u.json()];case 8:return m=v.sent(),[3,10];case 9:throw g=v.sent(),Zut.create("fetch-client-parse",{originalErrorMessage:g.message});case 10:f=m.entries,p=m.state,v.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===p?h=500:"NO_CHANGE"===p?h=304:"NO_TEMPLATE"!==p&&"EMPTY_CONFIG"!==p||(f={}),304!==h&&200!==h)throw Zut.create("fetch-status",{httpStatus:h});return[2,{status:h,eTag:d,config:f}]}var y}))}))},t}(),ect=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),nct=["1","true","t","yes","y","on"],rct=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&nct.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),ict=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=c2.a.DEBUG;break;case"silent":this._logger.logLevel=c2.a.SILENT;break;default:this._logger.logLevel=c2.a.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e,n;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),n=t[1],(e=t[0])&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e,n,r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:t=new ect,setTimeout((function(){return Object(uR.b)(r,void 0,void 0,(function(){return Object(uR.d)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=(o=e)instanceof l2.c&&-1!==o.code.indexOf("fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}var o}))}))},t.prototype.fetchAndActivate=function(){return Object(uR.b)(this,void 0,void 0,(function(){return Object(uR.d)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(Object(uR.a)(Object(uR.a)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new rct("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new rct("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new rct("static"))},t}();function oct(t,e){var n=t.target.error||void 0;return Zut.create(e,{originalErrorMessage:n&&n.message})}var sct=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(oct(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore("app_namespace_store",{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readonly").objectStore("app_namespace_store"),s=n.createCompositeKey(t);try{var a=o.get(s);a.onerror=function(t){i(oct(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(u){i(Zut.create("storage-get",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Object(uR.b)(this,void 0,void 0,(function(){var n,r=this;return Object(uR.d)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var s=n.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=r.createCompositeKey(t);try{var u=s.put({compositeKey:a,value:e});u.onerror=function(t){o(oct(t,"storage-set"))},u.onsuccess=function(){i()}}catch(c){o(Zut.create("storage-set",{originalErrorMessage:c&&c.message}))}}))]}}))}))},t.prototype.delete=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e,n=this;return Object(uR.d)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),s=n.createCompositeKey(t);try{var a=o.delete(s);a.onerror=function(t){i(oct(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(u){i(Zut.create("storage-delete",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),act=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Object(uR.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function uct(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(Zut.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var cct,lct=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Object(uR.b)(this,void 0,void 0,(function(){var e;return Object(uR.d)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return Object(uR.b)(this,void 0,void 0,(function(){var e,i,o;return Object(uR.d)(this,(function(s){switch(s.label){case 0:return[4,uct(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof l2.c&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+Object(l2.j)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}();(cct=u2.a).INTERNAL.registerComponent(new u6.a("remoteConfig",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw Zut.create("registration-window");var i=n.options,o=i.projectId,s=i.apiKey,a=i.appId;if(!o)throw Zut.create("registration-project-id");if(!s)throw Zut.create("registration-api-key");if(!a)throw Zut.create("registration-app-id");var u=new sct(a,n.name,e=e||"firebase"),c=new act(u),l=new c2.b("@firebase/remote-config");l.logLevel=c2.a.ERROR;var h=new tct(r,cct.SDK_VERSION,e,o,s,a),d=new lct(h,u),f=new Qut(d,u,c,l),p=new ict(n,f,c,u,l);return p.ensureInitialized(),p}),"PUBLIC").setMultipleInstances(!0)),cct.registerVersion("@firebase/remote-config","0.1.29"),u2.a.registerVersion("firebase","8.0.0","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),u2.a.registerVersion("firebase","8.0.0");class hct extends C{constructor(t,e=0,n=B_){super(),this.source=t,this.delayTime=e,this.scheduler=n,(!q_(e)||e<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=B_)}static create(t,e=0,n=B_){return new hct(t,e,n)}static dispatch(t){const{source:e,subscriber:n}=t;return this.add(e.subscribe(n))}_subscribe(t){return this.scheduler.schedule(hct.dispatch,this.delayTime,{source:this.source,subscriber:t})}}class dct{constructor(t,e){this.scheduler=t,this.delay=e}call(t,e){return new hct(e,this.delay,this.scheduler).subscribe(t)}}function fct(){}u2.a.registerVersion("firebase","8.0.0","app");class pct{constructor(t,e=J_){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,n){const r=this.zone;return this.delegate.schedule((function(e){r.runGuarded(()=>{t.apply(this,[e])})}),e,n)}}class mct{constructor(t){this.zone=t,this.task=null}call(t,e){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",fct,{},fct,fct)),e.pipe(Hf({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class gct{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new pct(Zone.current)),this.insideAngular=t.run(()=>new pct(Zone.current,lb))}}const vct=new zt("angularfire2.app.options"),yct=new zt("angularfire2.app.nameOrConfig"),bct=new $a("6.0.4");function wct(t,e,n){const r="object"==typeof n&&n||{};return r.name=r.name||"string"==typeof n&&n||"[DEFAULT]",u2.a.apps.filter(t=>t&&t.name===r.name)[0]||e.runOutsideAngular(()=>u2.a.initializeApp(t,r))}const _ct={provide:class{},useFactory:wct,deps:[vct,xc,[new ut,yct]]};let xct=(()=>{class t{constructor(t){u2.a.registerVersion("angularfire",bct.full,t.toString()),u2.a.registerVersion("angular",Ka.full)}static initializeApp(e,n){return{ngModule:t,providers:[{provide:vct,useValue:e},{provide:yct,useValue:n}]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(sc))},providers:[_ct]}),t})();function Cct(t){const e=function(t){return new C(e=>{const n=t=>e.next(t);return t.on("state_changed",n,t=>e.error(t),()=>{n(t.snapshot),e.complete()}),()=>t.cancel()})}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(V(t=>t.bytesTransferred/t.totalBytes*100))}}function Ect(t,e,n){return{getDownloadURL:()=>Zd(void 0).pipe(nx(e.outsideAngular),Mf(()=>t.getDownloadURL()),n),getMetadata:()=>Zd(void 0).pipe(nx(e.outsideAngular),Mf(()=>t.getMetadata()),n),delete:()=>q(t.delete()),child:r=>Ect(t.child(r),e,n),updateMetadata:e=>q(t.updateMetadata(e)),put:(e,n)=>Cct(t.put(e,n)),putString:(e,n,r)=>Cct(t.putString(e,n,r)),listAll:()=>q(t.listAll())}}const Sct=new zt("angularfire2.storageBucket");let Ict=(()=>{class t{constructor(t,e,n,r,i){var o;this.schedulers=new gct(i),this.keepUnstableUntilFirst=(o=this.schedulers,function(t){return(t=t.lift(new mct(o.ngZone))).pipe(function(t,e=0){return function(n){return n.lift(new dct(t,e))}}(o.outsideAngular),nx(o.insideAngular))}),this.storage=i.runOutsideAngular(()=>{const r=wct(t,i,e);return jat&&jat(u2.a),r.storage(n||void 0)})}ref(t){return Ect(this.storage.ref(t),this.schedulers,this.keepUnstableUntilFirst)}upload(t,e,n){return Ect(this.storage.ref(t),this.schedulers,this.keepUnstableUntilFirst).put(e,n)}}return t.\u0275fac=function(e){return new(e||t)(Jt(vct),Jt(yct,8),Jt(Sct,8),Jt(sc),Jt(xc))},t.\u0275prov=pt({factory:function(){return new t(Jt(vct),Jt(yct,8),Jt(Sct,8),Jt(sc),Jt(xc))},token:t,providedIn:"any"}),t})(),kct=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[Ict]}),t})(),Tct=(()=>{class t{constructor(t){this.storage=t}nuevo(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({name:t.name,surname:t.surname,team_id:t.team_id,photo:t.photo})});return yield(yield r).json()}))}tareaCloudStorage(t,e){return this.storage.upload(t,e)}referenciaCloudStorage(t){return this.storage.ref(t)}downloadCloudStorage(t){return Object(uR.b)(this,void 0,void 0,(function*(){try{return yield u2.a.storage().ref().child(t).getDownloadURL()}catch(e){return}}))}downloadCloudStorageDatos(t){return Object(uR.b)(this,void 0,void 0,(function*(){try{return yield u2.a.storage().ref().child(t).getMetadata()}catch(e){return}}))}expulsar(t,e){return Object(uR.b)(this,void 0,void 0,(function*(){let n=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const r=yield n.json(),i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/bans",{method:"POST",headers:{"Content-Type":"application/json",Authorization:r,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({date:new Date,matches:e,player_id:t.id})});return yield(yield i).json()}))}get(){return Object(uR.b)(this,void 0,void 0,(function*(){let t=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const e=yield t.json(),n=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players",{method:"GET",headers:{Authorization:e,"Access-Control-Allow-Origin":"*"}});return yield(yield n).json()}))}getPorEquipo(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams/"+t,{method:"GET",headers:{Authorization:n,"Access-Control-Allow-Origin":"*"}});return yield(yield r).json()}))}eliminar(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e=yield fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});const n=yield e.json(),r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players/"+t,{method:"DELETE",headers:{Authorization:n,"Access-Control-Allow-Origin":"*"}});return yield(yield r).json()}))}}return t.\u0275fac=function(e){return new(e||t)(Jt(Ict))},t.\u0275prov=pt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Act(t,e){1&t&&(ks(0,"div",2),As(1,"mat-spinner"),Ts())}function Rct(t,e){if(1&t){const t=Ds();ks(0,"div",10),ks(1,"button",14),Fs("click",(function(){return Ze(t),Us(),_s(5).click()})),fa(2,"Subir foto del equipo"),Ts(),Ts()}}function Oct(t,e){if(1&t){const t=Ds();ks(0,"div",10),ks(1,"button",15),Fs("click",(function(){return Ze(t),Us(),_s(5).click()})),fa(2,"Subir foto del equipo"),Ts(),Ts()}}function Nct(t,e){if(1&t&&(ks(0,"mat-option",16),fa(1),Ts()),2&t){const t=e.$implicit;Ss("value",t),di(1),pa(t.name)}}function Dct(t,e){if(1&t){const t=Ds();ks(0,"div"),ks(1,"div",5),ks(2,"h2"),fa(3,"Comprobar jugadores sancionados"),Ts(),ks(4,"input",6,7),Fs("change",(function(e){return Ze(t),Us(2).leerFoto(e.target.files[0])})),Ts(),Ts(),ks(6,"div",8),ws(7,Rct,3,0,"div",9),ws(8,Oct,3,0,"div",9),ks(9,"div",10),ks(10,"mat-form-field",11),ks(11,"mat-select",12),Fs("ngModelChange",(function(e){return Ze(t),Us(2).equipoSeleccionado=e})),ws(12,Nct,2,2,"mat-option",13),Ts(),Ts(),Ts(),Ts(),Ts()}if(2&t){const t=Us(2);di(7),Ss("ngIf",null!=t.equipoSeleccionado),di(1),Ss("ngIf",null==t.equipoSeleccionado),di(3),Ss("ngModel",t.equipoSeleccionado),di(1),Ss("ngForOf",t.listaEquipos)}}function Pct(t,e){1&t&&(ks(0,"div",23),fa(1," Ajustando tama\xf1o de imagen seleccionada. "),Ts())}function Mct(t,e){if(1&t&&(ks(0,"div",23),fa(1),Ts()),2&t){const t=Us(3);di(1),ga(" Descargando jugadores de base de datos ",t.jugadoresDescargados," / ",t.totalJugadoresADescargar," ")}}function Fct(t,e){1&t&&(ks(0,"div",23),fa(1," Cargando imagen seleccionada "),Ts())}function Lct(t,e){if(1&t&&(ks(0,"div",23),fa(1),Ts()),2&t){const t=Us(3);di(1),ga(" Comparando caras con base de datos ",t.carasProcesadas," / ",t.cantidadCarasDetectadas," ")}}function Bct(t,e){1&t&&(ks(0,"div",23),fa(1," Proceso terminado "),Ts())}function jct(t,e){if(1&t&&(ks(0,"div"),ks(1,"div",17),ws(2,Pct,2,0,"div",18),ws(3,Mct,2,2,"div",18),ws(4,Fct,2,0,"div",18),ws(5,Lct,2,2,"div",18),ws(6,Bct,2,0,"div",18),ks(7,"div"),As(8,"mat-progress-spinner",19),Ts(),ks(9,"div",20),As(10,"div",21),Ts(),ks(11,"div",22),ks(12,"mat-card"),fa(13,"Recuadro verde: Jugador habilitado - Recuadro rojo: Jugador no habilitado - Recuadro azul: Jugador no registrado en base de datos. "),Ts(),Ts(),Ts(),Ts()),2&t){const t=Us(2);di(2),Ss("ngIf",0==t.progreso),di(1),Ss("ngIf",t.progreso>0&&t.progreso<39),di(1),Ss("ngIf",39==t.progreso),di(1),Ss("ngIf",t.progreso>=40&&t.progreso<100),di(1),Ss("ngIf",100===t.progreso),di(2),Ss("value",t.progreso)}}function Vct(t,e){if(1&t&&(ks(0,"div",3),ws(1,Dct,13,4,"div",4),ws(2,jct,14,6,"div",4),Ts()),2&t){const t=Us();di(1),Ss("ngIf",!t.loader),di(1),Ss("ngIf",t.loader)}}let Uct=(()=>{class t{constructor(t,e){this.equiposService=t,this.jugadorService=e,this.listaEquipos=[],this.cargaPendientes=!0,this.jugadoresDetectados=[],this.loader=!1,this.cantidadCarasDetectadas=0,this.carasProcesadas=0,this.progreso=0,this.listaPintados=[],this.listaFotosBaseDatos=[],this.jugadoresDescargados=0,this.totalJugadoresADescargar=0}leerFoto(t){return Object(uR.b)(this,void 0,void 0,(function*(){let e,n;this.progreso=0,window.matchMedia("(min-width: 600px)").matches?(e=900,n=600):(e=600,n=300),this.loader=!0,this.resizeImage(t,e,n).then(t=>Object(uR.b)(this,void 0,void 0,(function*(){const e=yield this.jugadorService.getPorEquipo(this.equipoSeleccionado.id);this.progreso=1,this.totalJugadoresADescargar=e.length;const n=38/this.totalJugadoresADescargar;for(let t=0;t<e.length;t++){const r=e[t];if(void 0!==r.photo){const t=yield this.jugadorService.downloadCloudStorage(r.photo),e=yield fetch(t),i=yield e.blob();this.listaFotosBaseDatos.push({jugador:r,foto:i}),this.jugadoresDescargados=this.jugadoresDescargados+1,this.progreso=this.progreso+n}}Promise.all([Q1.ssdMobilenetv1.loadFromUri("assets/weights"),Q1.faceRecognitionNet.loadFromUri("assets/weights"),Q1.faceLandmark68Net.loadFromUri("assets/weights")]).then(e=>Object(uR.b)(this,void 0,void 0,(function*(){this.progreso=39;const e=document.getElementById("imagenpintada");e.style.position="relative";const n=yield h0(t);e.append(n);const r=p0(n);document.getElementById("caras").append(r);const i={width:n.width,height:n.height};!function(t,e,n){void 0===n&&(n=!1);var r=n?d0(e):e,i=r.height;t.width=r.width,t.height=i}(r,i);const o=yield o2(n).withFaceLandmarks().withFaceDescriptors();this.cantidadCarasDetectadas=o.length,this.carasProcesadas=0,this.progreso=40;const s=60/this.cantidadCarasDetectadas,a=function t(e,n){var r=new CZ(n.width,n.height),i=r.width,o=r.height;if(i<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:i,height:o}));if(Array.isArray(e))return e.map((function(e){return t(e,{width:i,height:o})}));if(n1(e)){var s=e.detection.forSize(i,o),a=e.unshiftedLandmarks.forSize(s.box.width,s.box.height);return r1(B0(e,s),a)}return L0(e)?B0(e,e.detection.forSize(i,o)):e instanceof t1||e instanceof F0?e.forSize(i,o):e}(o,i);for(let t=0;t<o.length;t++){const e=o[t];for(let t=0;t<this.listaFotosBaseDatos.length;t++){const n=this.listaFotosBaseDatos[t],i=yield h0(n.foto),o=yield o2(i).withFaceLandmarks().withFaceDescriptors(),s=s2(e.descriptor,o[0].descriptor);if(s<.5){this.jugadoresDetectados.push(n),console.log("Es la misma persona");for(let t=0;t<a.length;t++){const i=a[t];if(e.descriptor===i.descriptor){this.listaPintados.push(i.descriptor),null===n.jugador.ban?new a2.DrawBox(i.detection.box,{label:n.jugador.name+" "+n.jugador.surname,boxColor:"green"}).draw(r):new a2.DrawBox(i.detection.box,{label:n.jugador.name+" "+n.jugador.surname,boxColor:"red"}).draw(r);break}}}s>=.5&&console.log("No es la misma persona")}this.progreso=this.progreso+s,this.carasProcesadas=this.carasProcesadas+1}for(let t=0;t<a.length;t++){const e=a[t];let n=!1;for(let t=0;t<this.listaPintados.length;t++)this.listaPintados[t]===e.descriptor&&(n=!0);n||new a2.DrawBox(e.detection.box,{label:"Jugador no registrado",boxColor:"blue"}).draw(r)}this.progreso=100,console.log(this.jugadoresDetectados)})))})))}))}resizeImage(t,e,n){return new Promise((r,i)=>{let o=new Image;o.src=URL.createObjectURL(t),o.onload=()=>{let i,s,a=o.width,u=o.height;a<=e&&u<=n&&r(t),a>u?(s=u*(e/a),i=e):(i=a*(n/u),s=n);let c=document.createElement("canvas");c.width=i,c.height=s,c.getContext("2d").drawImage(o,0,0,i,s),c.toBlob(r,t.type)},o.onerror=i})}cargarTabla(){return Object(uR.b)(this,void 0,void 0,(function*(){this.listaEquipos=yield this.equiposService.get(),console.log(this.listaEquipos),this.cargaPendientes=!1}))}ngOnInit(){this.cargarTabla()}}return t.\u0275fac=function(e){return new(e||t)(xs(mR),xs(Tct))},t.\u0275cmp=ve({type:t,selectors:[["app-comprobar-sancionados"]],decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenedor",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenedor"],[4,"ngIf"],[1,"titulo"],["type","file","id","file","accept",".jpg, .jpeg",1,"invisible",3,"change"],["fileInput",""],[1,"inner-container"],["class","container-item",4,"ngIf"],[1,"container-item"],["appearance","fill",1,"select"],["placeholder","Seleccionar equipo",3,"ngModel","ngModelChange"],["value","null",3,"value",4,"ngFor","ngForOf"],["type","button","color","primary","mat-raised-button","",3,"click"],["type","button","color","primary","disabled","","mat-raised-button","",3,"click"],["value","null",3,"value"],["fxLayoutAlign","center center","fxFill","","fxLayout","column","fxLayoutGap","20px"],["class","descripcionProgreso",4,"ngIf"],["mode","determinate",3,"value"],["id","imagenpintada",1,"imagen"],["id","caras",1,"canvas"],[1,"aviso"],[1,"descripcionProgreso"]],template:function(t,e){1&t&&(ws(0,Act,2,0,"div",0),ws(1,Vct,3,2,"div",1)),2&t&&(Ss("ngIf",e.cargaPendientes),di(1),Ss("ngIf",!e.cargaPendientes))},directives:[kl,KA,zA,ok,PC,tE,Ph,Ld,Sl,k_,r_,EA,OA,ik,XI],styles:[".canvas[_ngcontent-%COMP%]{z-index:100;color:red}.canvas[_ngcontent-%COMP%], canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.contenedor[_ngcontent-%COMP%]{padding-top:100px}.inner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.container-item[_ngcontent-%COMP%]{padding:0 30px}.select[_ngcontent-%COMP%]{margin-top:1.34375em}.titulo[_ngcontent-%COMP%]{align-content:center;font-family:Roboto,sans-serif}.importar[_ngcontent-%COMP%], .titulo[_ngcontent-%COMP%]{text-align:center}.descripcionProgreso[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.invisible[_ngcontent-%COMP%]{opacity:0}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:50px}.titulosfilas[_ngcontent-%COMP%]{text-align:center;font-size:14px}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.button-row[_ngcontent-%COMP%]{text-align:center;padding-top:50px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important}.botonModelo[_ngcontent-%COMP%]{text-align:center;margin-top:5%}@media only screen and (min-width:600px){.aviso[_ngcontent-%COMP%]{bottom:20px;position:absolute;left:28%;font-weight:500;font-size:16px;width:50%}}@media only screen and (max-width:600px){.aviso[_ngcontent-%COMP%]{bottom:20px;position:absolute;font-weight:500;font-size:14px;width:90%}}"]}),t})();function zct(t,e){1&t&&(ks(0,"th",18),fa(1," Nombre "),Ts())}function Wct(t,e){if(1&t&&(ks(0,"td",19),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ga(" ",t.name," ",t.surname," ")}}function qct(t,e){1&t&&(ks(0,"th",18),fa(1," Fecha de sanci\xf3n "),Ts())}function Hct(t,e){if(1&t&&(ks(0,"td",19),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.ban.date," ")}}function Gct(t,e){1&t&&(ks(0,"th",18),fa(1," Partidos restantes "),Ts())}function $ct(t,e){if(1&t&&(ks(0,"td",19),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.ban.matches," ")}}function Kct(t,e){1&t&&(ks(0,"th",20),fa(1,"Acciones"),Ts())}function Xct(t,e){if(1&t){const t=Ds();ks(0,"td",21),ks(1,"button",22),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us().verJugadores(n)})),ks(2,"mat-icon"),fa(3," info "),Ts(),Ts(),Ts()}}function Yct(t,e){1&t&&As(0,"tr",23)}function Qct(t,e){1&t&&As(0,"tr",24)}const Jct=function(){return[10,20,50]};let Zct=(()=>{class t{constructor(t,e,n){this.dialog=t,this.router=e,this.jugadoresService=n,this.cargaPendientes=!0,this.displayedColumns=["nombre","fecha-sancion","partidosRestantes","acciones"],this.dataSource=new aT,this.verificarAcceso=!0,this.enBlanco=!1}set matSort(t){this.sort=t,this.setDataSourceAttributes()}set matPaginator(t){this.paginator=t,this.setDataSourceAttributes()}setDataSourceAttributes(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}determinarCantidadItem(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}verJugadores(t){}eliminar(t){}nuevo(){}cargarTabla(){return Object(uR.b)(this,void 0,void 0,(function*(){const t=yield this.jugadoresService.get();this.dataSource.data=t.filter((t,e,n)=>null!==t.ban),console.log(t),this.cargaPendientes=!1}))}ngOnInit(){this.cargarTabla()}}return t.\u0275fac=function(e){return new(e||t)(xs(iI),xs(dg),xs(Tct))},t.\u0275cmp=ve({type:t,selectors:[["app-sancionados-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(FS,!0),Hu(RE,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:28,vars:6,consts:[[1,"contenido"],[1,"titulo"],[1,"filtro"],["matInput","",3,"keyup"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","fecha-sancion"],["matColumnDef","partidosRestantes"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Informe",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(ks(0,"div",0),As(1,"br"),ks(2,"div",1),ks(3,"h2"),fa(4,"Jugadores sancionados"),Ts(),Ts(),ks(5,"div",2),ks(6,"mat-form-field"),ks(7,"mat-label"),fa(8,"Filtro"),Ts(),ks(9,"input",3),Fs("keyup",(function(t){return e.applyFilter(t)})),Ts(),Ts(),Ts(),ks(10,"div",4),ks(11,"table",5,6),Rs(13,7),ws(14,zct,2,0,"th",8),ws(15,Wct,2,2,"td",9),Os(),Rs(16,10),ws(17,qct,2,0,"th",8),ws(18,Hct,2,1,"td",9),Os(),Rs(19,11),ws(20,Gct,2,0,"th",8),ws(21,$ct,2,1,"td",9),Os(),Rs(22,12),ws(23,Kct,2,0,"th",13),ws(24,Xct,4,0,"td",14),Os(),ws(25,Yct,1,0,"tr",15),ws(26,Qct,1,0,"tr",16),Ts(),As(27,"mat-paginator",17),Ts(),Ts()),2&t&&(di(11),Ss("dataSource",e.dataSource),di(14),Ss("matHeaderRowDef",e.displayedColumns),di(1),Ss("matRowDefColumns",e.displayedColumns),di(1),Ss("pageSizeOptions",Au(5,Jct))("pageSize",e.itemPorPagina))},directives:[PC,SC,bI,zk,FS,Kk,Gk,qk,Jk,tT,RE,Yk,qS,Qk,k_,gE,SS,nT,iT],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),t})(),tlt=(()=>{class t{constructor(t,e){this.data=t,this.jugadorService=e,this.cargandoDatos=!0,this.jugador=JSON.parse(t)}descargarImagen(){return Object(uR.b)(this,void 0,void 0,(function*(){const t=this.jugador.photo;this.rutaDescarga=yield this.jugadorService.downloadCloudStorage(t),this.cargandoDatos=!1}))}ngOnInit(){this.descargarImagen()}}return t.\u0275fac=function(e){return new(e||t)(xs(tI),xs(Tct))},t.\u0275cmp=ve({type:t,selectors:[["app-ver-imagen"]],decls:2,vars:1,consts:[["alt","","width","600","height","600",3,"src"]],template:function(t,e){1&t&&(ks(0,"div"),As(1,"img",0),Ts()),2&t&&(di(1),Hs("src",e.rutaDescarga,Yr))},styles:[""]}),t})(),elt=(()=>{class t{constructor(){this.fechas=0}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ve({type:t,selectors:[["app-expulsar-jugador"]],decls:12,vars:4,consts:[["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["type","number","matInput","","placeholder","Cantidad de fechas",1,"texto",3,"ngModel","ngModelChange"],["nombre",""],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","mat-dialog-close"],["mat-raised-button","","color","warn",3,"mat-dialog-close"]],template:function(t,e){1&t&&(ks(0,"div",0),ks(1,"mat-form-field",1),ks(2,"input",2,3),Fs("ngModelChange",(function(t){return e.fechas=t})),Ts(),Ts(),Ts(),ks(4,"div",4),ks(5,"button",5),ks(6,"mat-icon"),fa(7,"save"),Ts(),Ts(),fa(8," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),ks(9,"a",6),ks(10,"mat-icon"),fa(11,"cancel"),Ts(),Ts(),Ts()),2&t&&(di(2),Ss("ngModel",e.fechas),di(3),Ss("disabled",e.fechas-0<=0)("mat-dialog-close",e.fechas),di(4),Ss("mat-dialog-close",-5))},directives:[EA,OA,PC,$h,bI,kh,Ph,Ld,k_,sI,SS,T_],styles:[""]}),t})();function nlt(t,e){1&t&&(ks(0,"div",2),As(1,"mat-spinner"),Ts())}function rlt(t,e){1&t&&(ks(0,"th",25),fa(1," Nombre "),Ts())}function ilt(t,e){if(1&t&&(ks(0,"td",26),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.name," ")}}function olt(t,e){1&t&&(ks(0,"th",25),fa(1," Apellido "),Ts())}function slt(t,e){if(1&t&&(ks(0,"td",26),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.surname," ")}}function alt(t,e){1&t&&(ks(0,"th",25),fa(1," Foto "),Ts())}function ult(t,e){if(1&t){const t=Ds();ks(0,"td",26),ks(1,"button",27),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).verFoto(n)})),ks(2,"mat-icon"),fa(3,"account_box "),Ts(),Ts(),Ts()}}function clt(t,e){1&t&&(ks(0,"th",25),fa(1," Inhabilitado "),Ts())}function llt(t,e){if(1&t&&(ks(0,"td",26),fa(1),Ts()),2&t){const t=e.$implicit,n=Us(2);di(1),ma(" ",n.comprobarHabilitacion(t)," ")}}function hlt(t,e){1&t&&(ks(0,"th",25),fa(1," Desde "),Ts())}function dlt(t,e){if(1&t&&(ks(0,"td",26),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.desde," ")}}function flt(t,e){1&t&&(ks(0,"th",25),fa(1," Partidos por cumplir "),Ts())}function plt(t,e){if(1&t&&(ks(0,"td",26),fa(1),Ts()),2&t){const t=e.$implicit;di(1),ma(" ",t.partidosCumplir," ")}}function mlt(t,e){1&t&&(ks(0,"th",28),fa(1,"Acciones"),Ts())}function glt(t,e){if(1&t){const t=Ds();ks(0,"button",33),Fs("click",(function(){Ze(t);const e=Us().$implicit;return Us(2).expulsar(e)})),ks(1,"mat-icon"),fa(2,"clear"),Ts(),Ts()}}function vlt(t,e){if(1&t){const t=Ds();ks(0,"td",29),ks(1,"button",30),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).editar(n)})),ks(2,"mat-icon"),fa(3,"create"),Ts(),Ts(),ws(4,glt,3,0,"button",31),ks(5,"button",32),Fs("click",(function(){Ze(t);const n=e.$implicit;return Us(2).eliminar(n)})),ks(6,"mat-icon"),fa(7,"delete_forever"),Ts(),Ts(),Ts()}if(2&t){const t=e.$implicit;di(4),Ss("ngIf",null===t.ban)}}function ylt(t,e){1&t&&As(0,"tr",34)}function blt(t,e){1&t&&As(0,"tr",35)}const wlt=function(){return[10,20,50]};function _lt(t,e){if(1&t){const t=Ds();ks(0,"div",3),As(1,"br"),ks(2,"div",4),ks(3,"h2"),fa(4),Ts(),Ts(),ks(5,"mat-grid-list",5),ks(6,"mat-grid-tile"),ks(7,"mat-form-field"),ks(8,"mat-label"),fa(9,"Filtro"),Ts(),ks(10,"input",6),Fs("keyup",(function(e){return Ze(t),Us().applyFilter(e)})),Ts(),Ts(),Ts(),ks(11,"mat-grid-tile"),ks(12,"button",7),Fs("click",(function(){return Ze(t),Us().nuevo()})),fa(13," Agregar nuevo jugador "),Ts(),Ts(),Ts(),ks(14,"div",8),ks(15,"table",9,10),Rs(17,11),ws(18,rlt,2,0,"th",12),ws(19,ilt,2,1,"td",13),Os(),Rs(20,14),ws(21,olt,2,0,"th",12),ws(22,slt,2,1,"td",13),Os(),Rs(23,15),ws(24,alt,2,0,"th",12),ws(25,ult,4,0,"td",13),Os(),Rs(26,16),ws(27,clt,2,0,"th",12),ws(28,llt,2,1,"td",13),Os(),Rs(29,17),ws(30,hlt,2,0,"th",12),ws(31,dlt,2,1,"td",13),Os(),Rs(32,18),ws(33,flt,2,0,"th",12),ws(34,plt,2,1,"td",13),Os(),Rs(35,19),ws(36,mlt,2,0,"th",20),ws(37,vlt,8,1,"td",21),Os(),ws(38,ylt,1,0,"tr",22),ws(39,blt,1,0,"tr",23),Ts(),As(40,"mat-paginator",24),Ts(),Ts()}if(2&t){const t=Us();di(4),ma("Jugadores de ",t.nombreEquipo,""),di(11),Ss("dataSource",t.dataSource),di(23),Ss("matHeaderRowDef",t.displayedColumns),di(1),Ss("matRowDefColumns",t.displayedColumns),di(1),Ss("pageSizeOptions",Au(6,wlt))("pageSize",t.itemPorPagina)}}let xlt=(()=>{class t{constructor(t,e,n,r,i){this.dialog=t,this.router=e,this.route=n,this.equiposService=r,this.jugadoresServices=i,this.cargaPendientes=!0,this.displayedColumns=["nombre","apellido","foto","inhabilitado","desde","partidosCumplir","acciones"],this.dataSource=new aT,this.tablaEquipos=[{nombre:"Lucas Pratto",inhabilitado:!1,desde:"-",partidosCumplir:"-"},{nombre:"Juan Fernando Quintero",inhabilitado:!0,desde:"18/08/2020",partidosCumplir:"2"},{nombre:"Gonzalo Martinez",inhabilitado:!1,desde:"-",partidosCumplir:"-"}],this.verificarAcceso=!0,this.enBlanco=!1}set matSort(t){this.sort=t,this.setDataSourceAttributes()}set matPaginator(t){this.paginator=t,this.setDataSourceAttributes()}setDataSourceAttributes(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}comprobarHabilitacion(t){return null!==t.ban?(t.desde=t.ban.date,t.partidosCumplir=t.ban.matches,"Si"):(t.desde="-",t.partidosCumplir="-","No")}determinarCantidadItem(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}eliminar(t){this.dialog.open(fR).afterClosed().subscribe(e=>Object(uR.b)(this,void 0,void 0,(function*(){e&&(yield this.jugadoresServices.eliminar(t.id),location.reload())})))}editar(t){}nuevo(){this.router.navigate(["main/jugadores-crear/"+this.nombreEquipo])}cargarTabla(){return Object(uR.b)(this,void 0,void 0,(function*(){this.dataSource.data=yield this.jugadoresServices.getPorEquipo(+this.idEquipo),console.log(this.dataSource.data),this.cargaPendientes=!1}))}expulsar(t){this.dialog.open(elt).afterClosed().subscribe(e=>Object(uR.b)(this,void 0,void 0,(function*(){e>0&&(this.cargaPendientes=!0,yield this.jugadoresServices.expulsar(t,e),this.cargarTabla())})))}verFoto(t){this.dialog.open(tlt,{data:JSON.stringify(t)})}traerNombreEquipo(){return Object(uR.b)(this,void 0,void 0,(function*(){const t=yield this.equiposService.get();for(let e=0;e<t.length;e++){const n=t[e];n.id===+this.idEquipo&&(this.nombreEquipo=n.name)}}))}ngOnInit(){this.route.params.forEach(t=>{this.idEquipo=t.equipo}),this.traerNombreEquipo(),this.cargarTabla()}}return t.\u0275fac=function(e){return new(e||t)(xs(iI),xs(dg),xs(im),xs(mR),xs(Tct))},t.\u0275cmp=ve({type:t,selectors:[["app-jugadores-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(FS,!0),Hu(RE,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["cols","2","rowHeight","100px"],["matInput","",3,"keyup"],["mat-raised-button","","color","primary",3,"click"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","apellido"],["matColumnDef","foto"],["matColumnDef","inhabilitado"],["matColumnDef","desde"],["matColumnDef","partidosCumplir"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-button","","color","accent","matTooltip","Foto jugador",3,"click"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Editar",3,"click"],["mat-button","","color","warn","matTooltip","Expulsar",3,"click",4,"ngIf"],["mat-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-button","","color","warn","matTooltip","Expulsar",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(ws(0,nlt,2,0,"div",0),ws(1,_lt,41,7,"div",1)),2&t&&(Ss("ngIf",e.cargaPendientes),di(1),Ss("ngIf",!e.cargaPendientes))},directives:[kl,KA,zA,ok,b_,c_,PC,SC,bI,k_,zk,FS,Kk,Gk,qk,Jk,tT,RE,Yk,qS,Qk,gE,SS,nT,iT],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),t})();function Clt(t,e){1&t&&(ks(0,"span"),fa(1,"Por favor ingrese un nombre"),Ts())}let Elt=(()=>{class t{constructor(t,e,n,r){this.router=t,this.formBuilder=e,this.equiposService=n,this.dialog=r}cancel(){this.router.navigate(["main/equipos-tabla"])}nuevo(t){return Object(uR.b)(this,void 0,void 0,(function*(){yield this.equiposService.nuevo(t),this.router.navigate(["main/equipos-tabla"])}))}ngOnInit(){return Object(uR.b)(this,void 0,void 0,(function*(){this.equiposForm=this.formBuilder.group({nombre:[null,Vh.required]})}))}}return t.\u0275fac=function(e){return new(e||t)(xs(dg),xs(Yd),xs(mR),xs(iI))},t.\u0275cmp=ve({type:t,selectors:[["app-equipos-crear"]],decls:19,vars:3,consts:[[3,"formGroup"],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto"],["nombre",""],[4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){if(1&t){const t=Ds();ks(0,"form",0),ks(1,"div",1),ks(2,"div",2),ks(3,"h2"),fa(4,"Crear equipo"),Ts(),Ts(),ks(5,"div",3),ks(6,"mat-form-field",4),As(7,"input",5,6),ks(9,"mat-error"),ws(10,Clt,2,0,"span",7),Ts(),Ts(),Ts(),ks(11,"div",8),ks(12,"button",9),Fs("click",(function(){Ze(t);const n=_s(8);return e.nuevo(n.value)})),ks(13,"mat-icon"),fa(14,"save"),Ts(),Ts(),fa(15," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),ks(16,"a",10),Fs("click",(function(){return e.cancel()})),ks(17,"mat-icon"),fa(18,"cancel"),Ts(),Ts(),Ts(),Ts(),Ts()}2&t&&(Ss("formGroup",e.equiposForm),di(10),Ss("ngIf",!e.equiposForm.get("nombre").valid&&e.equiposForm.get("nombre").touched),di(2),Ss("disabled",!e.equiposForm.valid))},directives:[Bd,Mh,Ud,EA,OA,PC,bI,kh,Ph,Kd,bC,kl,k_,SS,T_],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.button-row[_ngcontent-%COMP%]{margin:10px 0}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),t})();function Slt(t,e){1&t&&(ks(0,"div",3),As(1,"mat-spinner"),Ts())}function Ilt(t,e){1&t&&(ks(0,"span"),fa(1,"Por favor ingrese un nombre"),Ts())}function klt(t,e){1&t&&(ks(0,"span"),fa(1,"Por favor ingrese un apellido"),Ts())}function Tlt(t,e){if(1&t){const t=Ds();ks(0,"div",17),ks(1,"input",18,19),Fs("change",(function(e){return Ze(t),Us(2).subirFoto(e)})),Ts(),ks(3,"div",20),ks(4,"div"),ks(5,"button",21),Fs("click",(function(){Ze(t);const e=_s(2);return Us(2).abrirExplorador(e)})),fa(6,"Seleccionar imagen"),Ts(),Ts(),Ts(),Ts()}}function Alt(t,e){1&t&&(ks(0,"div",17),fa(1," Foto subida con \xe9xito. "),Ts())}function Rlt(t,e){if(1&t){const t=Ds();ks(0,"div",4),ks(1,"div",5),ks(2,"h2"),fa(3),Ts(),Ts(),ks(4,"div",6),ks(5,"mat-form-field",7),As(6,"input",8,9),ks(8,"mat-error"),ws(9,Ilt,2,0,"span",10),Ts(),Ts(),ks(10,"mat-form-field",7),As(11,"input",11,12),ks(13,"mat-error"),ws(14,klt,2,0,"span",10),Ts(),Ts(),ws(15,Tlt,7,0,"div",13),ws(16,Alt,2,0,"div",13),Ts(),ks(17,"div",14),ks(18,"button",15),Fs("click",(function(){Ze(t);const e=_s(7),n=_s(12);return Us().nuevo(e.value,n.value)})),ks(19,"mat-icon"),fa(20,"save"),Ts(),Ts(),fa(21," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),ks(22,"a",16),Fs("click",(function(){return Ze(t),Us().cancel()})),ks(23,"mat-icon"),fa(24,"cancel"),Ts(),Ts(),Ts(),Ts()}if(2&t){const t=Us();di(3),ma("Crear jugador de ",t.nombreEquipo,""),di(6),Ss("ngIf",!t.jugadoresForm.get("nombre").valid&&t.jugadoresForm.get("nombre").touched),di(5),Ss("ngIf",!t.jugadoresForm.get("apellido").valid&&t.jugadoresForm.get("apellido").touched),di(1),Ss("ngIf",!t.fotoSubida),di(1),Ss("ngIf",t.fotoSubida),di(2),Ss("disabled",!t.jugadoresForm.valid||!t.fotoSubida)}}let Olt=(()=>{class t{constructor(t,e,n,r,i,o){this.router=t,this.formBuilder=e,this.jugadoresService=n,this.dialog=r,this.route=i,this.equiposService=o,this.cantidad=0,this.fechaDesde=new Date,this.sancionado="2",this.cargaPendientes=!0,this.fotoSubida=!1}cancel(){this.router.navigate(["main/jugadores-tabla/"+this.nombreEquipo])}nuevo(t,e){return Object(uR.b)(this,void 0,void 0,(function*(){const n={};n.name=t,n.surname=e,n.status="unbanned",n.team_id=this.idEquipo,n.photo=this.rutaArchivo,yield this.jugadoresService.nuevo(n),this.router.navigate(["main/jugadores-tabla/"+this.idEquipo])}))}cargarIdEquipo(){return Object(uR.b)(this,void 0,void 0,(function*(){const t=yield this.equiposService.get();for(let e=0;e<t.length;e++){const n=t[e];n.name===this.nombreEquipo&&(this.idEquipo=n.id)}this.cargaPendientes=!1,console.log(this.idEquipo)}))}abrirExplorador(t){t.click()}subirFoto(t){for(let e=0;e<t.target.files.length;e++){let n=new FormData;this.nombreArchivo=t.target.files[e].name,n.delete("archivo"),n.append("archivo",t.target.files[e],t.target.files[e].name);let r=n.get("archivo");this.rutaArchivo="imagenes/"+this.idEquipo+"/"+this.nombreArchivo,this.jugadoresService.referenciaCloudStorage(this.rutaArchivo),this.jugadoresService.tareaCloudStorage(this.rutaArchivo,r).percentageChanges().subscribe(t=>{let e;e=Math.round(t)}),this.fotoSubida=!0}}ngOnInit(){return Object(uR.b)(this,void 0,void 0,(function*(){this.jugadoresForm=this.formBuilder.group({nombre:[null,Vh.required],apellido:[null,Vh.required]}),this.route.params.forEach(t=>{this.nombreEquipo=t.equipo}),this.cargarIdEquipo()}))}}return t.\u0275fac=function(e){return new(e||t)(xs(dg),xs(Yd),xs(Tct),xs(iI),xs(im),xs(mR))},t.\u0275cmp=ve({type:t,selectors:[["app-jugadores-crear"]],decls:3,vars:3,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],[3,"formGroup"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto"],["nombre",""],[4,"ngIf"],["matInput","","placeholder","Apellido","formControlName","apellido",1,"texto"],["apellido",""],["class","botonFoto",4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"],[1,"botonFoto"],["type","file","id","file",1,"invisible",3,"change"],["fileInput",""],["fxLayoutGap","20px",1,"importar"],["type","button","color","primary","mat-raised-button","",3,"click"]],template:function(t,e){1&t&&(ws(0,Slt,2,0,"div",0),ks(1,"form",1),ws(2,Rlt,25,6,"div",2),Ts()),2&t&&(Ss("ngIf",e.cargaPendientes),di(1),Ss("formGroup",e.jugadoresForm),di(1),Ss("ngIf",!e.cargaPendientes))},directives:[kl,Bd,Mh,Ud,KA,zA,ok,EA,OA,PC,bI,kh,Ph,Kd,bC,k_,SS,T_],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.botonFoto[_ngcontent-%COMP%]{text-align:center}.button-row[_ngcontent-%COMP%]{margin:10px 0}.invisible[_ngcontent-%COMP%]{opacity:0;top:2px;position:absolute}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),t})();function Nlt(t,e){1&t&&(ks(0,"div",3),As(1,"mat-spinner"),Ts())}function Dlt(t,e){1&t&&(ks(0,"span"),fa(1,"Por favor ingrese un nombre"),Ts())}function Plt(t,e){if(1&t){const t=Ds();ks(0,"div",4),ks(1,"div",5),ks(2,"h2"),fa(3,"Editar equipo"),Ts(),Ts(),ks(4,"div",6),ks(5,"mat-form-field",7),ks(6,"input",8,9),Fs("ngModelChange",(function(e){return Ze(t),Us().nombreEquipo=e})),Ts(),ks(8,"mat-error"),ws(9,Dlt,2,0,"span",10),Ts(),Ts(),Ts(),ks(10,"div",11),ks(11,"button",12),Fs("click",(function(){Ze(t);const e=_s(7);return Us().editar(e.value)})),ks(12,"mat-icon"),fa(13,"save"),Ts(),Ts(),fa(14," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),ks(15,"a",13),Fs("click",(function(){return Ze(t),Us().cancel()})),ks(16,"mat-icon"),fa(17,"cancel"),Ts(),Ts(),Ts(),Ts()}if(2&t){const t=Us();di(6),Ss("ngModel",t.nombreEquipo),di(3),Ss("ngIf",!t.equiposForm.get("nombre").valid&&t.equiposForm.get("nombre").touched),di(2),Ss("disabled",!t.equiposForm.valid)}}const Mlt=[{path:"login",component:dR,pathMatch:"full",data:{title:"Loguear usuario"}},{path:"",component:dR,pathMatch:"full",data:{title:"Loguear usuario"}},{path:"main",component:oR,data:{title:"main"},canActivate:[aR],children:[{path:"home",component:sR,data:{title:"home"},canActivate:[aR]},{path:"equipos-tabla",component:SR,data:{title:"home"},canActivate:[aR]},{path:"sancionados-tabla",component:Zct,data:{title:"home"},canActivate:[aR]},{path:"comprobar-sancionados",component:Uct,data:{title:"home"},canActivate:[aR]},{path:"jugadores-tabla/:equipo",component:xlt,data:{title:"home"},canActivate:[aR]},{path:"equipos-crear",component:Elt,data:{title:"home"},canActivate:[aR]},{path:"equipos-editar/:id",component:(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.formBuilder=e,this.equiposService=n,this.dialog=r,this.route=i,this.cargaPendientes=!0}cancel(){this.router.navigate(["main/equipos-tabla"])}editar(t){return Object(uR.b)(this,void 0,void 0,(function*(){const t={id:+this.idEquipo,name:this.nombreEquipo};yield this.equiposService.editar(t),this.router.navigate(["main/equipos-tabla"])}))}cargarNombreEquipo(){return Object(uR.b)(this,void 0,void 0,(function*(){const t=yield this.equiposService.get();for(let e=0;e<t.length;e++){const n=t[e];n.id===+this.idEquipo&&(this.nombreEquipo=n.name)}this.cargaPendientes=!1}))}ngOnInit(){return Object(uR.b)(this,void 0,void 0,(function*(){this.equiposForm=this.formBuilder.group({nombre:[null,Vh.required]}),this.route.params.forEach(t=>{this.idEquipo=t.id}),this.cargarNombreEquipo()}))}}return t.\u0275fac=function(e){return new(e||t)(xs(dg),xs(Yd),xs(mR),xs(iI),xs(im))},t.\u0275cmp=ve({type:t,selectors:[["app-equipos-editar"]],decls:3,vars:3,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],[3,"formGroup"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto",3,"ngModel","ngModelChange"],["nombre",""],[4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(ws(0,Nlt,2,0,"div",0),ks(1,"form",1),ws(2,Plt,18,3,"div",2),Ts()),2&t&&(Ss("ngIf",e.cargaPendientes),di(1),Ss("formGroup",e.equiposForm),di(1),Ss("ngIf",!e.cargaPendientes))},directives:[kl,Bd,Mh,Ud,KA,zA,ok,EA,OA,PC,bI,kh,Ph,Kd,bC,k_,SS,T_],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.button-row[_ngcontent-%COMP%]{margin:10px 0}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),t})(),data:{title:"home"},canActivate:[aR]},{path:"jugadores-crear/:equipo",component:Olt,data:{title:"home"},canActivate:[aR]}]}];let Flt=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[Sg.forRoot(Mlt)],Sg]}),t})(),Llt=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[FT]]}),t})(),Blt=(()=>{class t{}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)},imports:[[FT]]}),t})(),jlt=(()=>{class t{constructor(t,e){Ul(e)&&!t&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}static withConfig(e,n=[]){return{ngModule:t,providers:e.serverLoaded?[{provide:VT,useValue:Object.assign(Object.assign({},jT),e)},{provide:zT,useValue:n,multi:!0},{provide:UT,useValue:!0}]:[{provide:VT,useValue:Object.assign(Object.assign({},jT),e)},{provide:zT,useValue:n,multi:!0}]}}}return t.\u0275mod=_e({type:t}),t.\u0275inj=mt({factory:function(e){return new(e||t)(Jt(UT),Jt(sc))},imports:[[iR,Llt,Blt],iR,Llt,Blt]}),t})();u2.a.initializeApp(Jc);let Vlt=(()=>{class t{}return t.\u0275mod=_e({type:t,bootstrap:[Pg]}),t.\u0275inj=mt({factory:function(e){return new(e||t)},providers:[pR],imports:[[bh,Flt,ib,xct.initializeApp(Jc),DT,jlt,Jd,Qd,lS,kct]]}),t})();(function(){if(Er)throw new Error("Cannot enable prod mode after platform setup.");Cr=!1})(),vh().bootstrapModule(Vlt).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);