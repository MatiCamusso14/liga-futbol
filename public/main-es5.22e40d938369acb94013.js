function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _construct(t,e,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6Yf":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a}));var r=n("mrSG"),i=n("qOnz"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Object(r.a)({identifier:"[DEFAULT]",optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);try{var o=this.getOrInitializeService(i);if(!o){if(n)return null;throw Error("Service "+this.name+" is not available")}return o}catch(a){if(n)return null;throw a}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService("[DEFAULT]")}catch(l){}try{for(var i=Object(r.h)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=Object(r.e)(o.value,2),s=a[1],u=this.normalizeInstanceIdentifier(a[0]);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(l){}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Object(r.f)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}(),s=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"3UD+":function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},4:function(t,e){},5:function(t,e){},6:function(t,e){},"6Uf2":function(t,e,n){"use strict";(function(t){var e,r=n("zIRd"),i=n("mrSG"),o=n("qOnz"),a=n("q/0M"),s=n("/6Yf"),u=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Object(o.J)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Object(o.D)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),c=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return Object(o.k)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new u(e)}}catch(n){}return new c},h=l("localStorage"),f=l("sessionStorage"),d=new a.b("@firebase/database"),p=(e=1,function(){return e++}),v=function(t){var e=Object(o.I)(t),n=new o.d;n.update(e);var r=n.digest();return o.h.encodeByteArray(r)},m=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=0;i<e.length;i++){var a=e[i];Array.isArray(a)||a&&"object"==typeof a&&"number"==typeof a.length?r+=t.apply(null,a):r+="object"==typeof a?Object(o.J)(a):a,r+=" "}return r},g=null,y=!0,b=function(t,e){Object(o.f)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(d.logLevel=a.a.VERBOSE,g=d.log.bind(d),e&&f.set("logging_enabled",!0)):"function"==typeof t?g=t:(g=null,f.remove("logging_enabled"))},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===y&&(y=!1,null===g&&!0===f.get("logging_enabled")&&b(!0)),g){var n=m.apply(null,t);g(n)}},w=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];_.apply(void 0,Object(i.f)([t],e))}},x=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,Object(i.f)(t));d.error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,Object(i.f)(t));throw d.error(n),new Error(n)},k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+m.apply(void 0,Object(i.f)(t));d.warn(n)},E=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},S="[MIN_NAME]",I="[MAX_NAME]",T=function(t,e){if(t===e)return 0;if(t===S||e===I)return-1;if(e===S||t===I)return 1;var n=G(t),r=G(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},A=function(t,e){return t===e?0:t<e?-1:1},R=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Object(o.J)(e))},O=function t(e){if("object"!=typeof e||null===e)return Object(o.J)(e);var n=[];for(var r in e)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=Object(o.J)(n[a]),i+=":",i+=t(e[n[a]]);return i+"}"},N=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function D(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var P,M,F,L,B,j,V,U,z,W,q=function(t){var e,n,r,i,a;Object(o.f)(!E(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},H=new RegExp("^-?(0*)\\d{1,10}$"),G=function(t){if(H.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},K=function(t){try{t()}catch(e){setTimeout((function(){throw k("Exception was thrown by user callback.",e.stack||""),e}),Math.floor(0))}},X=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},$=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=T(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Y=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(o.H)(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Object(o.H)(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Object(o.H)(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Q=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=h.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&h.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(Object(o.f)("string"==typeof t,"typeof type must == string"),Object(o.f)("object"==typeof e,"typeof params must == object"),"websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return D(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),J=function(t,e){var n=Z(t),r=n.namespace;return"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&k("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Q(n.host,n.secure,r,e,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new $(n.pathString)}},Z=function(t){var e="",n="",r="",o="",a="",s=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(o=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(h,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var o=Object(i.h)(t.split("&")),a=o.next();!a.done;a=o.next()){var s=a.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):k("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),a=r}"ns"in d&&(a=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:o,namespace:a}},tt=/[\[\].#$\/\u0000-\u001F\u007F]/,et=/[\[\].#$\u0000-\u001F\u007F]/,nt=function(t){return"string"==typeof t&&0!==t.length&&!tt.test(t)},rt=function(t){return"string"==typeof t&&0!==t.length&&!et.test(t)},it=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!E(t)||t&&"object"==typeof t&&Object(o.k)(t,".sv")},ot=function(t,e,n,r,i){i&&void 0===n||at(Object(o.o)(t,e,i),n,r)},at=function t(e,n,r){var i=r instanceof $?new Y(r,e):r;if(void 0===n)throw new Error(e+"contains undefined "+i.toErrorString());if("function"==typeof n)throw new Error(e+"contains a function "+i.toErrorString()+" with contents = "+n.toString());if(E(n))throw new Error(e+"contains "+n.toString()+" "+i.toErrorString());if("string"==typeof n&&n.length>10485760/3&&Object(o.H)(n)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+i.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,s=!1;if(D(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!nt(n)))throw new Error(e+" contains an invalid key ("+n+") "+i.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');i.push(n),t(e,r,i),i.pop()})),a&&s)throw new Error(e+' contains ".value" child '+i.toErrorString()+" in addition to actual children.")}},st=function(t,e,n,r,i){if(!i||void 0!==n){var a=Object(o.o)(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(a+" must be an object containing the children to replace.");var s=[];D(n,(function(t,e){var n=new $(t);if(at(a,e,r.child(n)),".priority"===n.getBack()&&!it(e))throw new Error(a+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!nt(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort($.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(a,s)}},ut=function(t,e,n,r){if(!r||void 0!==n){if(E(n))throw new Error(Object(o.o)(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!it(n))throw new Error(Object(o.o)(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ct=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(o.o)(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},lt=function(t,e,n,r){if(!(r&&void 0===n||nt(n)))throw new Error(Object(o.o)(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ht=function(t,e,n,r){if(!(r&&void 0===n||rt(n)))throw new Error(Object(o.o)(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ft=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ht(t,e,n,r)},dt=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},pt=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!nt(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),rt(t)}(r))throw new Error(Object(o.o)(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},vt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(o.o)(t,e,r)+"must be a boolean.")},mt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Object(o.K)("OnDisconnect.cancel",0,1,arguments.length),Object(o.L)("OnDisconnect.cancel",1,t,!0);var e=new o.a;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Object(o.K)("OnDisconnect.remove",0,1,arguments.length),dt("OnDisconnect.remove",this.path_),Object(o.L)("OnDisconnect.remove",1,t,!0);var e=new o.a;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Object(o.K)("OnDisconnect.set",1,2,arguments.length),dt("OnDisconnect.set",this.path_),ot("OnDisconnect.set",1,t,this.path_,!1),Object(o.L)("OnDisconnect.set",2,e,!0);var n=new o.a;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Object(o.K)("OnDisconnect.setWithPriority",2,3,arguments.length),dt("OnDisconnect.setWithPriority",this.path_),ot("OnDisconnect.setWithPriority",1,t,this.path_,!1),ut("OnDisconnect.setWithPriority",2,e,!1),Object(o.L)("OnDisconnect.setWithPriority",3,n,!0);var r=new o.a;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Object(o.K)("OnDisconnect.update",1,2,arguments.length),dt("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}st("OnDisconnect.update",1,t,this.path_,!1),Object(o.L)("OnDisconnect.update",2,e,!0);var i=new o.a;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),gt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Object(o.K)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),yt=(P="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",M=0,F=[],function(t){var e,n=t===M;M=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=P.charAt(t%64),t=Math.floor(t/64);Object(o.f)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===F[e];e--)F[e]=0;F[e]++}else for(e=0;e<12;e++)F[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=P.charAt(F[e]);return Object(o.f)(20===i.length,"nextPushId: Length should be 20."),i}),bt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),_t=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new bt(S,t),r=new bt(S,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return bt.MIN},t}(),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return L},set:function(t){L=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return T(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Object(o.g)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return new bt(I,L)},e.prototype.makePost=function(t,e){return Object(o.f)("string"==typeof t,"KeyIndex indexValue must always be a string."),new bt(t,L)},e.prototype.toString=function(){return".key"},e}(_t),xt=new wt,Ct=function(t){return"number"==typeof t?"number:"+q(t):"string:"+t},kt=function(t){if(t.isLeafNode()){var e=t.val();Object(o.f)("string"==typeof e||"number"==typeof e||"object"==typeof e&&Object(o.k)(e,".sv"),"Priority must be a string or number.")}else Object(o.f)(t===B||t.isEmpty(),"priority of unexpected type.");Object(o.f)(t===B||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Et=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Object(o.f)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),kt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return j},set:function(t){j=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(o.f)(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ct(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?q(this.value_):this.value_,this.lazyHash_=v(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Object(o.f)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return Object(o.f)(i>=0,"Unknown leaf type: "+n),Object(o.f)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),St=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?T(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return new bt(I,new Et("[PRIORITY-POST]",U))},e.prototype.makePost=function(t,e){var n=V(t);return new bt(e,new Et("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(_t)),It=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Tt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Rt.EMPTY_NODE,this.right=null!=o?o:Rt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Rt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Rt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),At=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Tt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Rt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Tt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new It(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new It(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new It(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new It(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new At,t}(),Ot=Math.log(2),Nt=function(){function t(t){this.count=parseInt(Math.log(t+1)/Ot,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Dt=function(t,e,n,r){t.sort(e);var i=function(e){for(var r=null,i=null,o=t.length,a=function(e,r){var i=o-e,a=o;o-=e;var u=function e(r,i){var o,a,s=i-r;if(0===s)return null;if(1===s)return o=t[r],a=n?n(o):o,new Tt(a,o.node,Tt.BLACK,null,null);var u=parseInt(s/2,10)+r,c=e(r,u),l=e(u+1,i);return o=t[u],a=n?n(o):o,new Tt(a,o.node,Tt.BLACK,c,l)}(i+1,a),c=t[i],l=n?n(c):c;s(new Tt(l,c.node,r,null,u))},s=function(t){r?(r.left=t,r=t):(i=t,r=t)},u=0;u<e.count;++u){var c=e.nextBitIsOne(),l=Math.pow(2,e.count-(u+1));c?a(l,Tt.BLACK):(a(l,Tt.BLACK),a(l,Tt.RED))}return i}(new Nt(t.length));return new Rt(r||e,i)},Pt={},Mt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Object(o.f)(Pt&&St,"ChildrenNode.ts has not been loaded"),z=z||new t({".priority":Pt},{".priority":St})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=Object(o.G)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Rt?e:null},t.prototype.hasIndex=function(t){return Object(o.k)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Object(o.f)(e!==xt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,a=[],s=!1,u=n.getIterator(bt.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),a.push(c),c=u.getNext();r=s?Dt(a,e.getCompare()):Pt;var l=e.toString(),h=Object(i.a)({},this.indexSet_);h[l]=e;var f=Object(i.a)({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Object(o.E)(this.indexes_,(function(t,i){var a=Object(o.G)(r.indexSet_,i);if(Object(o.f)(a,"Missing index implementation for "+i),t===Pt){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(bt.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),Dt(s,a.getCompare())}return Pt}var l=n.get(e.name),h=t;return l&&(h=h.remove(new bt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Object(o.E)(this.indexes_,(function(t){if(t===Pt)return t;var r=n.get(e.name);return r?t.remove(new bt(e.name,r)):t})),this.indexSet_)},t}();function Ft(t,e){return T(t.name,e.name)}function Lt(t,e){return T(t,e)}var Bt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&kt(this.priorityNode_),this.children_.isEmpty()&&Object(o.f)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return W||(W=new t(new Rt(Lt),null,Mt.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||W},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?W:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Object(o.f)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new bt(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?W:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Object(o.f)(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(St,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Ct(this.getPriority().val())+":"),this.forEachChild(St,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":v(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new bt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new bt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new bt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,bt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,bt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===jt?-1:0},t.prototype.withIndex=function(e){if(e===xt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===xt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(St),r=e.getIterator(St),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===xt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),jt=new(function(t){function e(){return t.call(this,new Rt(Lt),Bt.EMPTY_NODE,Mt.Default)||this}return Object(i.c)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Bt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Bt));function Vt(t,e){if(void 0===e&&(e=null),null===t)return Bt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Object(o.f)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Et(t,Vt(e));if(t instanceof Array){var n=Bt.EMPTY_NODE;return D(t,(function(e,r){if(Object(o.k)(t,e)&&"."!==e.substring(0,1)){var i=Vt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(Vt(e))}var r=[],i=!1;if(D(t,(function(t,e){if("."!==t.substring(0,1)){var n=Vt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new bt(t,n)))}})),0===r.length)return Bt.EMPTY_NODE;var a=Dt(r,Ft,(function(t){return t.name}),Lt);if(i){var s=Dt(r,St.getCompare());return new Bt(a,Vt(e),new Mt({".priority":s},{".priority":St}))}return new Bt(a,Vt(e),Mt.Default)}Object.defineProperties(bt,{MIN:{value:new bt(S,Bt.EMPTY_NODE)},MAX:{value:new bt(I,jt)}}),wt.__EMPTY_NODE=Bt.EMPTY_NODE,Et.__childrenNodeConstructor=Bt,B=jt,U=jt,function(t){V=t}(Vt);var Ut,zt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?T(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return bt.MIN},e.prototype.maxPost=function(){return bt.MAX},e.prototype.makePost=function(t,e){var n=Vt(t);return new bt(e,n)},e.prototype.toString=function(){return".value"},e}(_t)),Wt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Object(o.f)(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return Object(i.c)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?T(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Vt(t),r=Bt.EMPTY_NODE.updateChild(this.indexPath_,n);return new bt(e,r)},e.prototype.maxPost=function(){var t=Bt.EMPTY_NODE.updateChild(this.indexPath_,jt);return new bt(I,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(_t),qt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Object(o.K)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Object(o.K)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Object(o.K)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Object(o.K)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Object(o.K)("DataSnapshot.child",0,1,arguments.length),e=String(e),ht("DataSnapshot.child",1,e,!1);var n=new $(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,St)},t.prototype.hasChild=function(t){Object(o.K)("DataSnapshot.hasChild",1,1,arguments.length),ht("DataSnapshot.hasChild",1,t,!1);var e=new $(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Object(o.K)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(Object(o.K)("DataSnapshot.forEach",1,1,arguments.length),Object(o.L)("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),St))}))},t.prototype.hasChildren=function(){return Object(o.K)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Object(o.K)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Object(o.K)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Ht=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(o.J)(this.snapshot.exportVal())},t}(),Gt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Kt=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Ht("value",this,new qt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.f)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Gt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Xt=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,Object(o.k)(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Gt(this,t,e):null},t.prototype.createEvent=function(t,e){Object(o.f)(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Ht(t.type,this,new qt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.f)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var a=r[0],s=i[0];return!(s!==a||e.callbacks_[a]&&this.callbacks_[s]&&e.callbacks_[a]!==this.callbacks_[s])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),$t=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.f)(Ut,"Reference.ts has not been loaded"),Ut},set:function(t){Ut=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===xt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==S)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==I)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===St){if(null!=e&&!it(e)||null!=n&&!it(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(o.f)(t.getIndex()instanceof Wt||t.getIndex()===zt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Object(o.K)("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Object(o.K)("Query.on",2,4,arguments.length),ct("Query.on",1,e,!1),Object(o.L)("Query.on",2,n,!1);var a=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,a.cancel,a.context);else{var s={};s[e]=n,this.onChildEvent(s,a.cancel,a.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Kt(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Xt(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Object(o.K)("Query.off",0,3,arguments.length),ct("Query.off",1,t,!0),Object(o.L)("Query.off",2,e,!0),Object(o.M)("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var a=e||null;r=new Kt(a,null,n||null)}else t&&(e&&((i={})[t]=e),r=new Xt(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var a=this;Object(o.K)("Query.once",1,4,arguments.length),ct("Query.once",1,e,!1),Object(o.L)("Query.once",2,n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new o.a;c.promise.catch((function(){}));var l=function t(r){u&&(u=!1,a.off(e,t),n&&n.bind(s.context)(r),c.resolve(r))};return this.on(e,l,(function(t){a.off(e,l),s.cancel&&s.cancel.bind(s.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if(Object(o.K)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Object(o.K)("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Object(o.K)("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ht("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new $(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Wt(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Object(o.K)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(xt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Object(o.K)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(St);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Object(o.K)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(zt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Object(o.K)("Query.startAt",0,2,arguments.length),ot("Query.startAt",1,e,this.path,!0),lt("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Object(o.K)("Query.endAt",0,2,arguments.length),ot("Query.endAt",1,e,this.path,!0),lt("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Object(o.K)("Query.equalTo",1,2,arguments.length),ot("Query.equalTo",1,t,this.path,!1),lt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Object(o.K)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Object(o.K)("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=O(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Object(o.K)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),a=this.queryIdentifier()===e.queryIdentifier();return r&&i&&a},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,Object(o.L)(t,3,r.cancel,!0),r.context=n,Object(o.M)(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Object(o.o)(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Yt=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Qt=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),Jt=function(t,e,n){return t&&"object"==typeof t?(Object(o.f)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Zt(t[".sv"],e,n):"object"==typeof t[".sv"]?te(t[".sv"],e):void Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Zt=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Object(o.f)(!1,"Unexpected server value: "+t)}},te=function(t,e,n){t.hasOwnProperty("increment")||Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&Object(o.f)(!1,"Unexpected increment value: "+r);var i=e.node();if(Object(o.f)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},ee=function(t,e,n,r){return re(e,new Qt(n,t),r)},ne=function(t,e,n){return re(t,new Yt(e),n)};function re(t,e,n){var r,i=t.getPriority().val(),o=Jt(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=Jt(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Et(s,Vt(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Et(o))),u.forEachChild(St,(function(t,i){var o=re(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var ie,oe,ae=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(St,(function(t,e){n.remember(new $(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new $(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}(),se=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}({}),ue=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Object(o.f)(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),ce=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=se.ACK_USER_WRITE,this.source=ue.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Object(o.f)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new $(e));return new t($.Empty,n,this.revert)}return Object(o.f)(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),le=function(){function t(t,e){void 0===e&&(ie||(ie=new Rt(A)),e=ie),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return D(e,(function(t,e){n=n.set(new $(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:$.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new $(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_($.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,$.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,$.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_($.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),he=function(){function t(t,e){this.source=t,this.path=e,this.type=se.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,$.Empty):new t(this.source,this.path.popFront())},t}(),fe=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=se.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,$.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),de=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=se.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new $(e));return n.isEmpty()?null:n.value?new fe(this.source,$.Empty,n.value):new t(this.source,$.Empty,n)}return Object(o.f)(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),pe=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),ve=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new pe(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new pe(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new pe(Bt.EMPTY_NODE,!1,!1),new pe(Bt.EMPTY_NODE,!1,!1)),t}(),me=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),ge=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){Object(o.f)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(me.childRemovedChange(e,s)):Object(o.f)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(me.childAddedChange(e,n)):a.trackChildChange(me.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(St,(function(t,r){e.hasChild(t)||n.trackChildChange(me.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(St,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(me.childChangedChange(e,r,i))}else n.trackChildChange(me.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Bt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),ye=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Object(o.f)(e===me.CHILD_ADDED||e===me.CHILD_CHANGED||e===me.CHILD_REMOVED,"Only child changes supported for tracking"),Object(o.f)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===me.CHILD_ADDED&&i===me.CHILD_REMOVED)this.changeMap.set(n,me.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===me.CHILD_REMOVED&&i===me.CHILD_ADDED)this.changeMap.delete(n);else if(e===me.CHILD_REMOVED&&i===me.CHILD_CHANGED)this.changeMap.set(n,me.childRemovedChange(n,r.oldSnap));else if(e===me.CHILD_CHANGED&&i===me.CHILD_ADDED)this.changeMap.set(n,me.childAddedChange(n,t.snapshotNode));else{if(e!==me.CHILD_CHANGED||i!==me.CHILD_CHANGED)throw Object(o.g)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,me.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),be=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),_e=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new pe(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),we=function(t,e){this.viewCache=t,this.changes=e},xe=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){Object(o.f)(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Object(o.f)(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var a,s,u=new ye;if(n.type===se.OVERWRITE){var c=n;c.source.fromUser?a=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(Object(o.f)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),a=this.applyServerOverwrite_(e,c.path,c.snap,r,i,s,u))}else if(n.type===se.MERGE){var l=n;l.source.fromUser?a=this.applyUserMerge_(e,l.path,l.children,r,i,u):(Object(o.f)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.getServerCache().isFiltered(),a=this.applyServerMerge_(e,l.path,l.children,r,i,s,u))}else if(n.type===se.ACK_USER_WRITE){var h=n;a=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==se.LISTEN_COMPLETE)throw Object(o.g)("Unknown operation type: "+n.type);a=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,a,f),new we(a,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(me.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var a=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,u=void 0;if(e.isEmpty())if(Object(o.f)(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=n.calcCompleteEventChildren(c instanceof Bt?c:Bt.EMPTY_NODE);s=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=e.getFront();if(".priority"===f){Object(o.f)(1===e.getLength(),"Can't have a priority with additional path components");var d=a.getNode();u=t.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(e,d,u);s=null!=p?this.filter_.updatePriority(d,p):a.getNode()}else{var v=e.popFront(),m=void 0;if(a.isCompleteForChild(f)){u=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,a.getNode(),u);m=null!=g?a.getNode().getImmediateChild(f).updateChild(v,g):a.getNode().getImmediateChild(f)}else m=n.calcCompleteChild(f,t.getServerCache());s=null!=m?this.filter_.updateChild(a.getNode(),f,m,v,r,i):a.getNode()}}return t.updateEventSnap(s,a.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),d=u.getNode().getImmediateChild(h).updateChild(f,n);s=".priority"===h?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),h,d,f,be,null)}var p=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),v=new _e(r,p,i);return this.generateEventCacheAfterServerEvent_(p,e,r,v,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new _e(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),d=void 0;if(h.isEmpty())d=n;else{var p=c.getCompleteChild(l);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):Bt.EMPTY_NODE}if(f.equals(d))a=t;else{var v=this.filter_.updateChild(u.getNode(),l,d,h,c,o);a=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))})),r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:le.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new $(e),h,r,i,o,a)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new $(e),f,r,i,o,a)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=le.Empty;return s.getNode().forEachChild(xt,(function(t,e){u=u.set(new $(t),e)})),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=le.Empty;return n.foreach((function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,be,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var a;if(null!=n.shadowingWrite(e))return t;var s=new _e(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Object(o.f)(h instanceof Bt,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}c=this.filter_.updateFullNode(u,l=l,i)}else{var f=e.getFront(),d=n.calcCompleteChild(f,t.getServerCache());null==d&&t.getServerCache().isCompleteForChild(f)&&(d=u.getImmediateChild(f)),(c=null!=d?this.filter_.updateChild(u,f,d,e.popFront(),s,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,Bt.EMPTY_NODE,e.popFront(),s,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,a,i))}return a=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite($.Empty),t.updateEventSnap(c,a,this.filter_.filtersNodes())},t}(),Ce=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===me.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(me.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,me.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,me.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,me.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,me.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,me.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter((function(t){return t.type===e}));a.sort(this.compareChanges_.bind(this)),a.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Object(o.g)("Should only compare child_ events.");var n=new bt(t.childName,t.snapshotNode),r=new bt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),ke=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new ge(n.getIndex()),i=n.getNodeFilter();this.processor_=new xe(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(Bt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Bt.EMPTY_NODE,a.getNode(),null),c=new pe(s,o.isFullyInitialized(),r.filtersNodes()),l=new pe(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new ve(l,c),this.eventGenerator_=new Ce(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){Object(o.f)(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){var i=t.createCancelEvent(e=e,r);i&&n.push(i)}))}if(t){for(var i=[],a=0;a<this.eventRegistrations_.length;++a){var s=this.eventRegistrations_[a];if(s.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(a+1));break}}else i.push(s)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===se.MERGE&&null!==t.source.queryId&&(Object(o.f)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Object(o.f)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Object(o.f)(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(St,(function(t,e){n.push(me.childAddedChange(t,e))})),e.isFullyInitialized()&&n.push(me.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){return this.eventGenerator_.generateEventsForChanges(t,e,n?[n]:this.eventRegistrations_)},t}(),Ee=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.f)(oe,"Reference.ts has not been loaded"),oe},set:function(t){Object(o.f)(!oe,"__referenceConstructor has already been defined"),oe=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,a,s=t.source.queryId;if(null!==s){var u=this.views.get(s);return Object(o.f)(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var l=Object(i.h)(this.views.values()),h=l.next();!h.done;h=l.next())c=c.concat((u=h.value).applyOperation(t,e,n))}catch(f){r={error:f}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=this.views.get(o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof Bt?(s=n.calcCompleteEventChildren(r),u=!1):(s=Bt.EMPTY_NODE,u=!1);var c=new ve(new pe(s,u,!1),new pe(r,i,!1));a=new ke(t,c),this.views.set(o,a)}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var o,a,s=e.queryIdentifier(),u=[],c=[],l=this.hasCompleteView();if("default"===s)try{for(var h=Object(i.h)(this.views.entries()),f=h.next();!f.done;f=h.next()){var d,p=Object(i.e)(f.value,2),v=p[0];c=c.concat((d=p[1]).removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(v),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery()))}}catch(m){o={error:m}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}else(d=this.views.get(s))&&(c=c.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(s),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery())));return l&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=Object(i.h)(this.views.values()),o=r.next();!o.done;o=r.next()){var a=o.value;a.getQuery().getQueryParams().loadsAllData()||n.push(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var o=Object(i.h)(this.views.values()),a=o.next();!a.done;a=o.next())r=r||a.value.getCompleteServerCache(t)}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=Object(i.h)(this.views.values()),r=n.next();!r.done;r=n.next()){var o=r.value;if(o.getQuery().getQueryParams().loadsAllData())return o}}catch(a){t={error:a}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Se=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new le(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=$.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new le(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return D(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,le.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild($.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(St,(function(e,n){t.push(new bt(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new bt(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new le(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal((function(n,a){".priority"===n?(Object(o.f)(null!==a.value,"Priority writes must always be leaf nodes"),i=a.value):r=t(e.child(n),a,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r}($.Empty,this.writeTree_,t)},t.Empty=new t(new le(null)),t}(),Ie=function(){function t(){this.visibleWrites_=Se.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Te(t,this)},t.prototype.addOverwrite=function(t,e,n,r){Object(o.f)(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){Object(o.f)(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));Object(o.f)(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,a=!1,s=this.allWrites_.length-1;i&&s>=0;){var u=this.allWrites_[s];u.visible&&(s>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(a=!0)),s--}return!!i&&(a?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):D(r.children,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})),!0))},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);return!i&&o.isEmpty()?n:i||null!=n||o.hasCompleteWrite($.Empty)?t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e).apply(n||Bt.EMPTY_NODE):null}var a=this.visibleWrites_.getCompleteNode(e);if(null!=a)return a;var s=this.visibleWrites_.childCompoundWrite(e);return s.isEmpty()?n:null!=n||s.hasCompleteWrite($.Empty)?s.apply(n||Bt.EMPTY_NODE):null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Bt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(St,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(St,(function(t,e){var r=i.childCompoundWrite(new $(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Object(o.f)(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?r.getChild(e):a.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode($.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,$.Empty),this.lastWriteId_=this.allWrites_.length>0?this.allWrites_[this.allWrites_.length-1].writeId:-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Se.Empty,i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)n.contains(s)?(u=$.relativePath(n,s),r=r.addWrite(u,a.snap)):s.contains(n)&&(u=$.relativePath(s,n),r=r.addWrite($.Empty,a.snap.getChild(u)));else{if(!a.children)throw Object(o.g)("WriteRecord should have .snap or .children");if(n.contains(s))u=$.relativePath(n,s),r=r.addWrites(u,a.children);else if(s.contains(n))if((u=$.relativePath(s,n)).isEmpty())r=r.addWrites($.Empty,a.children);else{var c=Object(o.G)(a.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite($.Empty,l)}}}}}return r},t}(),Te=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Ae=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=le.Empty,this.pendingWriteTree_=new Ie,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new fe(ue.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=le.fromObject(e);return this.applyOperationToSyncPoints_(new de(ue.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=le.Empty;return null!=n.snap?r=r.set($.Empty,!0):D(n.children,(function(t,e){r=r.set(new $(t),e)})),this.applyOperationToSyncPoints_(new ce(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new fe(ue.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=le.fromObject(e);return this.applyOperationToSyncPoints_(new de(ue.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new he(ue.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=$.relativePath(a,e),c=new fe(ue.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=$.relativePath(a,e),c=le.fromObject(n),l=new de(ue.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=$.relativePath(o,e),u=new he(ue.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,a=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=$.relativePath(t,r);i=i||e.getCompleteServerCache(n),a=a||e.hasCompleteView()}));var s,u=this.syncPointTree_.get(r);u?(a=a||u.hasCompleteView(),i=i||u.getCompleteServerCache($.Empty)):(u=new Ee,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?s=!0:(s=!1,i=Bt.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache($.Empty);n&&(i=i.updateImmediateChild(t,n))})));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);Object(o.f)(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(l,h),this.tagToQueryMap.set(h,l)}var f=this.pendingWriteTree_.childWrites(r),d=u.addEventRegistration(e,n,f,i,s);if(!c&&!a){var p=u.viewForQuery(e);d=d.concat(this.setupListener_(e,p))}return d},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),h=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(f),p=0;p<d.length;++p){var v=d[p],m=v.getQuery(),g=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(m),this.tagForQuery_(m),g.hashFn,g.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}))),this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=$.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),D(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),a=this.createListenerForView_(n),s=this.listenProvider_.startListening(t.queryForListening_(e),i,a.hashFn,a.onComplete),u=this.syncPointTree_.subtree(r);if(i)Object(o.f)(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),D(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return s},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Bt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return Object(o.f)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new $(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Object(o.f)(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites($.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get($.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache($.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get($.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache($.Empty));var a=[];return e.children.inorderTraversal((function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))})),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),Re=function(){function t(){this.rootNode_=Bt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Oe=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),Object(o.k)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return Object(o.m)(this.counters_)},t}(),Ne=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Oe),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),De=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=Object(i.a)({},t);return this.last_&&D(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Pe=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new De(t);var n=1e4+2e4*Math.random();X(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;D(e,(function(e,i){i>0&&Object(o.k)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),X(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Me=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new Fe(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),Fe=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();g&&_("event: "+e.toString()),K(n)}}},t.prototype.getPath=function(){return this.path_},t}(),Le=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Object(o.f)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=Object(i.f)(this.listeners_[t]),o=0;o<r.length;o++)r[o].callback.apply(r[o].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Object(o.f)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Be=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.f)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Le),je=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(o.x)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.f)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Le),Ve=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&K((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Ue=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=w(t),this.stats_=Ne.getCollection(e),this.urlFn=function(t){return e.connectionURL("long_polling",t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Ve(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(Object(o.z)()||"complete"===document.readyState)t();else{var e=!1,n=function n(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new ze((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,5),o=r[0],a=r[1],s=r[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===o)n.id=a,n.password=s;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,2),o=r[0],a=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(o,a)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(Object(o.z)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=Object(o.J)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=Object(o.i)(e),r=N(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!Object(o.z)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=Object(o.J)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),ze=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(o.z)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=p(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(u){_("frame writing exception"),u.stack&&_(u.stack),_(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||_("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(e+=n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;Object(o.z)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){_("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),We="";function qe(t){We=t}var He=null;"undefined"!=typeof MozWebSocket?He=MozWebSocket:"undefined"!=typeof WebSocket&&(He=WebSocket);var Ge=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=w(this.connId),this.stats_=Ne.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!Object(o.z)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL("websocket",r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,h.set("previous_websocket_failure",!0);try{if(Object(o.z)()){var r={headers:{"User-Agent":"Firebase/5/"+We+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}},i=process.env,a=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;a&&(r.proxy={origin:a}),this.mySock=new He(this.connURL,[],r)}else this.mySock=new He(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||""}})}catch(u){this.log_("Error instantiating WebSocket.");var s=u.message||u.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==He&&!t.forceDisallow_},t.previouslyFailed=function(){return h.isInMemoryStorage||!0===h.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){h.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=Object(o.D)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Object(o.f)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=Object(o.J)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=N(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Ke=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Ue,Ge]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,o=Ge&&Ge.isAvailable(),a=o&&!Ge.previouslyFailed();if(e.webSocketOnly&&(o||k("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),a=!0),a)this.transports_=[Ge];else{var s=this.transports_=[];try{for(var u=Object(i.h)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Xe=function(){function t(t,e,n,r,i,o,a,s){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=w("c:"+this.id+":"),this.transportManager_=new Ke(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=X((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=R("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?x("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):x("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&k("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),X((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):X((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(h.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),$e=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),Ye=function(t){function e(n,r,i,a,s,u,c){var l=t.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=s,l.authTokenProvider_=u,l.authOverride_=c,l.id=e.nextPersistentConnectionId_++,l.log_=w("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingPutCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=1e3,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!Object(o.z)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),Be.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&je.getInstance().on("online",l.onOnline_,l),l}return Object(i.c)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(Object(o.J)(i)),Object(o.f)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),a=t.path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),Object(o.f)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Object(o.f)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&Object(o.k)(t,"w")){var n=Object(o.G)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();k("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||Object(o.q)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=Object(o.C)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Object(o.f)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){"ok"!==t.s&&e.log_("reportStats","Error sending stats: "+t.d)}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+Object(o.J)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):x("Unrecognized action received from server: "+Object(o.J)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Object(o.f)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+e.nextConnectionId_++,s=this,u=this.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,i())};this.realtime_={close:h,sendRequest:function(t){Object(o.f)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(t){c?_("getToken() completed but was canceled"):(_("getToken() completed. Creating connection."),s.authToken_=t&&t.accessToken,l=new Xe(a,s.repoInfo_,s.applicationId_,n,r,i,(function(t){k(t+" ("+s.repoInfo_.toString()+")"),s.interrupt("server_kill")}),u))})).then(null,(function(e){s.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&k(e),h())}))}},e.prototype.interrupt=function(t){_("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){_("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Object(o.u)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return O(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new $(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){_("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var o=Object(i.h)(this.listens.values()),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var u=(n=void 0,Object(i.h)(s.values())),c=u.next();!c.done;c=u.next())this.sendListen_(c.value)}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";Object(o.z)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+We.replace(/\./g,"-")]=1,Object(o.x)()?t["framework.cordova"]=1:Object(o.A)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=je.getInstance().currentlyOnline();return Object(o.u)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}($e),Qe=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=w("p:rest:"),i.listens_={},i}return Object(i.c)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Object(o.f)(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t.path.toString();this.log_("Listen called for "+s+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),Object(o.G)(a.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var a=i&&i.accessToken;a&&(e.auth=a);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+Object(o.F)(e);r.log_("Sending REST request for "+s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+s+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=Object(o.D)(u.responseText)}catch(e){k("Failed to parse JSON response for "+s+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&k("Got unsuccessful REST response for "+s+" Status: "+u.status),n(u.status);n=null}},u.open("GET",s,!0),u.send()}))},e}($e),Je=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Me,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new ae,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.start=function(){var t=this;if(this.stats_=Ne.getCollection(this.repoInfo_),this.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new Qe(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(o.J)(e)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}this.persistentConnection_=new Ye(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),this.statsReporter_=Ne.getOrCreateReporter(this.repoInfo_,(function(){return new Pe(t.stats_,t.server_)})),this.transactionsInit_(),this.infoData_=new Re,this.infoSyncTree_=new Ae({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e.path);return a.isEmpty()||(o=t.infoSyncTree_.applyServerOverwrite(e.path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Ae({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);t.eventQueue_.raiseEventsForChangedPath(e.path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})},t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new $(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new $(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var a=[];if(r)if(n){var s=Object(o.E)(e,(function(t){return Vt(t)}));a=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var u=Vt(e);a=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=Object(o.E)(e,(function(t){return Vt(t)}));a=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=Vt(e);a=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;a.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,a)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;D(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new $("/.info/"+t),r=Vt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=Vt(e,n),s=this.serverSyncTree_.calcCompleteEventCache(t),u=ne(a,s,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),a.val(!0),(function(e,n){var o="ok"===e;o||k("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)}));var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(D(e,(function(e,n){i=!1,a[e]=ee(t.child(e),Vt(n),r.serverSyncTree_,o)})),i)_("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||k("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)})),D(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new ae;this.onDisconnect_.forEachTree($.Empty,(function(r,i){var o=ee(r,i,t.serverSyncTree_,e);n.remember(r,o)}));var r=[];n.forEachTree($.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new ae,this.eventQueue_.raiseEventsForChangedPath($.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Vt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Vt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(Object(o.u)(e))return _("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&D(e,(function(e,n){var i=Vt(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new De(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);D(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),_.apply(void 0,Object(i.f)([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&K((function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new hn(this))},enumerable:!1,configurable:!0}),t}(),Ze=function(){function t(e){this.indexedFilter_=new ge(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new bt(e,n))||(n=Bt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Bt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Bt.EMPTY_NODE);var i=this;return e.forEachChild(St,(function(t,e){i.matches(new bt(t,e))||(r=r.updateImmediateChild(t,Bt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),tn=function(){function t(t){this.rangedFilter_=new Ze(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new bt(e,n))||(n=Bt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Bt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Bt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Bt.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Bt.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;Object(o.f)(u.numChildren()===this.limit_,"");var c=new bt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(me.childChangedChange(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(me.childRemovedChange(e,f));var v=u.updateImmediateChild(e,Bt.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(me.childAddedChange(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(me.childRemovedChange(l.name,l.node)),i.trackChildChange(me.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,Bt.EMPTY_NODE)):t},t}(),en=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=St}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:S},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:I},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Object(o.f)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==St&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===St},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new ge(this.getIndex()):this.hasLimit()?new tn(this):new Ze(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===St?e=n.PRIORITY_INDEX:this.index_===zt?e=n.VALUE_INDEX:this.index_===xt?e=n.KEY_INDEX:(Object(o.f)(this.index_ instanceof Wt,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=Object(o.J)(e),this.startSet_&&(r[n.START_AT]=Object(o.J)(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+Object(o.J)(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=Object(o.J)(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+Object(o.J)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),nn=function(t){function e(e,n){if(!(e instanceof Je))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,en.DEFAULT,!1)||this}return Object(i.c)(e,t),e.prototype.getKey=function(){return Object(o.K)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return Object(o.K)("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof $||(null===this.path.getFront()?ft("Reference.child",1,t,!1):ht("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){Object(o.K)("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Object(o.K)("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Object(o.K)("Reference.set",1,2,arguments.length),dt("Reference.set",this.path),ot("Reference.set",1,t,this.path,!1),Object(o.L)("Reference.set",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Object(o.K)("Reference.update",1,2,arguments.length),dt("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}st("Reference.update",1,t,this.path,!1),Object(o.L)("Reference.update",2,e,!0);var i=new o.a;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Object(o.K)("Reference.setWithPriority",2,3,arguments.length),dt("Reference.setWithPriority",this.path),ot("Reference.setWithPriority",1,t,this.path,!1),ut("Reference.setWithPriority",2,e,!1),Object(o.L)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.a;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Object(o.K)("Reference.remove",0,1,arguments.length),dt("Reference.remove",this.path),Object(o.L)("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Object(o.K)("Reference.transaction",1,3,arguments.length),dt("Reference.transaction",this.path),Object(o.L)("Reference.transaction",1,t,!1),Object(o.L)("Reference.transaction",2,e,!0),vt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new o.a;"function"==typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new gt(n,i)),"function"==typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){Object(o.K)("Reference.setPriority",1,2,arguments.length),dt("Reference.setPriority",this.path),ut("Reference.setPriority",1,t,!1),Object(o.L)("Reference.setPriority",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Object(o.K)("Reference.push",0,2,arguments.length),dt("Reference.push",this.path),ot("Reference.push",1,t,this.path,!0),Object(o.L)("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=yt(r),a=this.child(i),s=this.child(i);return n=null!=t?a.set(t,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),a},e.prototype.onDisconnect=function(){return dt("Reference.onDisconnect",this.path),new mt(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}($t);$t.__referenceConstructor=nn,Ee.__referenceConstructor=nn;var rn=function(){this.children={},this.childCount=0,this.value=null},on=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new rn),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof $?e:new $(e),r=this,i=n.getFront();null!==i;)r=new t(i,r,Object(o.G)(r.node_.children,i)||new rn),i=(n=n.popFront()).getFront();return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){Object(o.f)(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;D(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new $(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=Object(o.k)(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}(),an=function(t){return t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT",t}({});Je.MAX_TRANSACTION_RETRIES_=25,Je.prototype.transactionsInit_=function(){this.transactionQueueTree_=new on},Je.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},a=new nn(this,t);a.on("value",i);var s={path:t,update:e,onComplete:n,status:null,order:p(),applyLocally:r,retryCount:0,unwatcher:function(){a.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);s.currentInputSnapshot=u;var c=s.update(u.val());if(void 0===c){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var l=new qt(s.currentInputSnapshot,new nn(this,s.path),St);s.onComplete(null,!1,l)}}else{at("transaction failed: Data returned ",c,s.path),s.status=an.RUN;var h=this.transactionQueueTree_.subTree(t),f=h.getValue()||[];f.push(s),h.setValue(f);var d=void 0;"object"==typeof c&&null!==c&&Object(o.k)(c,".priority")?(d=Object(o.G)(c,".priority"),Object(o.f)(it(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(this.serverSyncTree_.calcCompleteEventCache(t)||Bt.EMPTY_NODE).getPriority().val(),d=d;var v=this.generateServerValues(),m=Vt(c,d),g=ne(m,u,v);s.currentOutputSnapshotRaw=m,s.currentOutputSnapshotResolved=g,s.currentWriteId=this.getNextWriteId_();var y=this.serverSyncTree_.applyUserOverwrite(t,g,s.currentWriteId,s.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,y),this.sendReadyTransactions_()}},Je.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Bt.EMPTY_NODE},Je.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Object(o.f)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===an.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},Je.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),a=i,s=i.hash(),u=0;u<e.length;u++){var c=e[u];Object(o.f)(c.status===an.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=an.SENT,c.retryCount++;var l=$.relativePath(t,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=t;this.server_.put(f.toString(),h,(function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=an.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new nn(n,e[a].path),c=new qt(s,u,St);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),a=0;a<o.length;a++)K(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status=e[a].status===an.SENT_NEEDS_ABORT?an.NEEDS_ABORT:an.RUN;else for(k("transaction at "+f.toString()+" failed: "+r),a=0;a<e.length;a++)e[a].status=an.NEEDS_ABORT,e[a].abortReason=r;n.rerunTransactions_(t)}}),s)},Je.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},Je.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter((function(t){return t.status===an.RUN})).map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var s=t[a],u=$.relativePath(e,s.path),c=!1,l=void 0;if(Object(o.f)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===an.NEEDS_ABORT)c=!0,l=s.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===an.RUN)if(s.retryCount>=Je.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var h=this.getLatestState_(s.path,i);s.currentInputSnapshot=h;var f=t[a].update(h.val());if(void 0!==f){at("transaction failed: Data returned ",f,s.path);var d=Vt(f);"object"==typeof f&&null!=f&&Object(o.k)(f,".priority")||(d=d.updatePriority(h.getPriority()));var p=s.currentWriteId,v=this.generateServerValues(),m=ne(d,h,v);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(p),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else c=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],c&&(t[a].status=an.COMPLETED,setTimeout(t[a].unwatcher,Math.floor(0)),t[a].onComplete))if("nodata"===l){var g=new nn(this,t[a].path),y=new qt(t[a].currentInputSnapshot,g,St);n.push(t[a].onComplete.bind(null,null,!1,y))}else n.push(t[a].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<n.length;a++)K(n[a]);this.sendReadyTransactions_()}},Je.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},Je.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},Je.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},Je.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==an.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},Je.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},Je.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,a=0;a<e.length;a++)e[a].status===an.SENT_NEEDS_ABORT||(e[a].status===an.SENT?(Object(o.f)(i===a-1,"All SENT items should be at beginning of queue."),i=a,e[a].status=an.SENT_NEEDS_ABORT,e[a].abortReason="set"):(Object(o.f)(e[a].status===an.RUN,"Unexpected transaction status in abort"),e[a].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[a].currentWriteId,!0)),e[a].onComplete&&n.push(e[a].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),a=0;a<n.length;a++)K(n[a])}};var sn,un=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';k(t+="credential"in this.app_.options?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},t}(),cn=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),ln=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return sn||(sn=new t),sn},t.prototype.interrupt=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[s]))),c=u.next();!c.done;c=u.next())this.repos_[s][c.value].interrupt()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[s]))),c=u.next();!c.done;c=u.next())this.repos_[s][c.value].resume()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.applyEmulatorSettings=function(t,e,n){t.repoInfo_=new Q(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new cn)},t.prototype.databaseFromApp=function(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,a=J(i,r),s=a.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,s=(a=J(i="http://"+u+"?ns="+s.namespace,r)).repoInfo):o=!a.repoInfo.secure;var c=r&&o?new cn:new un(t,e);return pt("Invalid Firebase Database URL",1,a),a.path.isEmpty()||C("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(s,t,c).database},t.prototype.deleteRepo=function(t){var e=Object(o.G)(this.repos_,t.app.name);e&&Object(o.G)(e,t.key)===t||C("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.key]},t.prototype.createRepo=function(t,e,n){var r=Object(o.G)(this.repos_,e.name);r||(this.repos_[e.name]=r={});var i=Object(o.G)(r,t.toURLString());return i&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Je(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),hn=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return Object(i.b)(e,void 0,void 0,(function(){return Object(i.d)(this,(function(t){return this.checkDeleted_("delete"),ln.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]}))}))}},t instanceof Je||C("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new nn(this.repo_,$.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?C("Cannot call useEmulator() after instance has already been initialized."):ln.getInstance().applyEmulatorSettings(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),Object(o.K)("database.ref",0,1,arguments.length),t instanceof nn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Object(o.K)(e,1,1,arguments.length);var n=J(t,this.repo_.repoInfo_.nodeAdmin);pt(e,1,n);var r=n.repoInfo;return r.isCustomHost()||r.host===this.repo_.repoInfo_.host||C(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&C("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Object(o.K)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Object(o.K)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),fn=Object.freeze({__proto__:null,forceLongPolling:function(){Ge.forceDisallow(),Ue.forceAllow()},forceWebSockets:function(){Ue.forceDisallow()},isWebSocketsAvailable:function(){return Ge.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.customAuthImpl,i=t.namespace,o=t.nodeAdmin,a=void 0!==o&&o;qe(t.version);var u=new s.c("auth-internal",new s.b("database-standalone"));return u.setComponent(new s.a("auth-internal",(function(){return r}),"PRIVATE")),{instance:ln.getInstance().databaseFromApp(e,u,n,a),namespace:i}}}),dn=Ye;Ye.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ye.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var pn=Object.freeze({__proto__:null,DataConnection:dn,RealTimeConnection:Xe,hijackHash:function(t){var e=Ye.prototype.put;return Ye.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Ye.prototype.put=e}},ConnectionTarget:Q,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){ln.getInstance().forceRestClient(t)}}),vn=hn.ServerValue;!function(e){qe(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new s.a("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return ln.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:nn,Query:$t,Database:hn,DataSnapshot:qt,enableLogging:b,INTERNAL:fn,ServerValue:vn,TEST_ACCESS:pn}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.7.0"),Object(o.z)()&&(t.exports=n)}(r.a)}).call(this,n("3UD+")(t))},7:function(t,e){},mrSG:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return h}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}},nbvr:function(t,e,n){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return d}));var o=[],a=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),s={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},u=a.INFO,c=((i={})[a.DEBUG]="log",i[a.VERBOSE]="log",i[a.INFO]="info",i[a.WARN]="warn",i[a.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.DEBUG],t)),this._logHandler.apply(this,r([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.VERBOSE],t)),this._logHandler.apply(this,r([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.INFO],t)),this._logHandler.apply(this,r([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.WARN],t)),this._logHandler.apply(this,r([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.ERROR],t)),this._logHandler.apply(this,r([this,a.ERROR],t))},t}();function f(t){o.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:a[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return I})),n.d(e,"c",(function(){return S})),n.d(e,"d",(function(){return V})),n.d(e,"e",(function(){return E})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return u})),n.d(e,"j",(function(){return Y})),n.d(e,"k",(function(){return M})),n.d(e,"l",(function(){return U})),n.d(e,"m",(function(){return l})),n.d(e,"n",(function(){return h})),n.d(e,"o",(function(){return H})),n.d(e,"p",(function(){return d})),n.d(e,"q",(function(){return P})),n.d(e,"r",(function(){return m})),n.d(e,"s",(function(){return g})),n.d(e,"t",(function(){return b})),n.d(e,"u",(function(){return L})),n.d(e,"v",(function(){return _})),n.d(e,"w",(function(){return C})),n.d(e,"x",(function(){return p})),n.d(e,"y",(function(){return v})),n.d(e,"z",(function(){return x})),n.d(e,"A",(function(){return y})),n.d(e,"B",(function(){return w})),n.d(e,"C",(function(){return D})),n.d(e,"D",(function(){return R})),n.d(e,"E",(function(){return B})),n.d(e,"F",(function(){return j})),n.d(e,"G",(function(){return F})),n.d(e,"H",(function(){return $})),n.d(e,"I",(function(){return X})),n.d(e,"J",(function(){return O})),n.d(e,"K",(function(){return q})),n.d(e,"L",(function(){return G})),n.d(e,"M",(function(){return K})),n.d(e,"N",(function(){return k}));var r=n("mrSG"),i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,a||(l=64)),r.push(n[o>>2],n[(3&o)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();r.push(o<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){var e=a(t);return s.encodeByteArray(e,!0)},c=function(t){try{return s.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())}function v(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function m(){return"object"==typeof self&&self.self===self}function g(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function b(){return d().indexOf("Electron/")>=0}function _(){var t=d();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return d().indexOf("MSAppHost/")>=0}function x(){return!1}function C(){return"indexedDB"in self&&null!=indexedDB}function k(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))}function E(){return!(!navigator||!navigator.cookieEnabled)}var S=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,I.prototype.create),o}return Object(r.c)(e,t),e}(Error),I=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?T(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new S(i,s,r);return u},t}();function T(t,e){return t.replace(A,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var A=/\{\$([^}]+)}/g;function R(t){return JSON.parse(t)}function O(t){return JSON.stringify(t)}var N=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=R(c(o[0])||""),n=R(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}},D=function(t){var e=N(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},P=function(t){var e=N(t).claims;return"object"==typeof e&&!0===e.admin};function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function L(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function B(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function j(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}var V=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^s&(u^c),o=1518500249):(i=s^u^c,o=1859775393):r<60?(i=s&u|c&(s|u),o=2400959708):(i=s^u^c,o=3395469782);var h=(a<<5|a>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function U(t,e){var n=new z(t,e);return n.subscribe.bind(n)}var z=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=W),void 0===r.error&&(r.error=W),void 0===r.complete&&(r.complete=W);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function W(){}var q=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function H(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}function G(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(H(t,e,r)+"must be a valid function.")}function K(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(H(t,e,r)+"must be a valid context object.")}var X=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var a=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},$=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function Y(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}},zIRd:function(t,e,n){"use strict";var r,i,o=n("mrSG"),a=n("qOnz"),s=n("/6Yf"),u=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a.b("app","Firebase",c),h=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),f=new u.b("@firebase/app"),d=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(a.m)(t),this.container=new s.b(e.name),this._addComponent(new s.a("app",(function(){return u}),"PUBLIC"));try{for(var c=Object(o.h)(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next())this._addComponent(l.value)}catch(h){r={error:h}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){f.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();d.prototype.name&&d.prototype.options||d.prototype.delete||console.log("dc");var p=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if(Object(a.k)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=h[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void f.warn(u.join(" "))}c(new s.a(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.c,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument",{appName:name});Object(u.d)(t,e)},apps:null,SDK_VERSION:"8.0.0",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||"[DEFAULT]",!Object(a.k)(e,t))throw l.create("no-app",{appName:t});return e[t]}function c(s){var u,c,h=s.name;if(n.has(h))return f.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var d=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw l.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==s.serviceProps&&Object(a.n)(d,s.serviceProps),r[h]=d,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?t:[])}}try{for(var p=Object(o.h)(Object.keys(e)),v=p.next();!v.done;v=p.next())e[v.value]._addComponent(s)}catch(m){u={error:m}}finally{try{v&&!v.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(d);return e.INTERNAL=Object(o.a)(Object(o.a)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(a.n)(e,t)},createSubscribe:a.l,ErrorFactory:a.b,deepExtend:a.n}),e}(),v=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(Object(a.r)()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var g=p.initializeApp;p.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(a.y)()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),g.apply(void 0,t)};var y=p;!function(t,e){t.INTERNAL.registerComponent(new s.a("platform-logger",(function(t){return new v(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.12",void 0),t.registerVersion("fire-js","")}(y),e.a=y},zUnb:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"DrawBoxOptions",(function(){return _4})),n.d(r,"DrawBox",(function(){return w4})),n.d(r,"AnchorPosition",(function(){return g4})),n.d(r,"DrawTextFieldOptions",(function(){return y4})),n.d(r,"DrawTextField",(function(){return b4}));var i={};n.r(i),n.d(i,"getModelUris",(function(){return O4})),n.d(i,"convLayer",(function(){return x4})),n.d(i,"disposeUnusedWeightTensors",(function(){return C4})),n.d(i,"extractConvParamsFactory",(function(){return k4})),n.d(i,"extractFCParamsFactory",(function(){return E4})),n.d(i,"extractSeparableConvParamsFactory",(function(){return I4})),n.d(i,"loadSeparableConvParamsFactory",(function(){return T4})),n.d(i,"extractWeightEntryFactory",(function(){return A4})),n.d(i,"extractWeightsFactory",(function(){return R4})),n.d(i,"SeparableConvParams",(function(){return S4})),n.d(i,"TinyYolov2",(function(){return n5})),n.d(i,"TinyYolov2SizeType",(function(){return t5})),n.d(i,"TinyYolov2Options",(function(){return e5})),n.d(i,"validateConfig",(function(){return Y4}));var o={};function a(t){return"function"==typeof t}n.r(o),n.d(o,"drawContour",(function(){return r5})),n.d(o,"drawDetections",(function(){return s5})),n.d(o,"drawFaceExpressions",(function(){return w5})),n.d(o,"DrawFaceLandmarksOptions",(function(){return S5})),n.d(o,"DrawFaceLandmarks",(function(){return I5})),n.d(o,"drawFaceLandmarks",(function(){return T5}));var s=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else s&&console.log("RxJS: Back to a better error behavior. Thank you. <3");s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function c(t){setTimeout((function(){throw t}),0)}var l={closed:!0,next:function(t){},error:function(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete:function(){}},h=Array.isArray||function(t){return t&&"number"==typeof t.length};function f(t){return null!==t&&"object"==typeof t}var d,p=function(){function t(t){return Error.call(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map((function(t,e){return"".concat(e+1,") ").concat(t.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),v=((d=function(){function t(e){_classCallCheck(this,t),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return _createClass(t,[{key:"unsubscribe",value:function(){var e;if(!this.closed){var n=this._parentOrParents,r=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var o=0;o<n.length;++o)n[o].remove(this);if(a(r))try{r.call(this)}catch(l){e=l instanceof p?m(l.errors):[l]}if(h(i))for(var s=-1,u=i.length;++s<u;){var c=i[s];if(f(c))try{c.unsubscribe()}catch(l){e=e||[],l instanceof p?e=e.concat(m(l.errors)):e.push(l)}}if(e)throw new p(e)}}},{key:"add",value:function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n}},{key:"remove",value:function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}]),t}()).EMPTY=function(t){return t.closed=!0,t}(new d),d);function m(t){return t.reduce((function(t,e){return t.concat(e instanceof p?e.errors:e)}),[])}var g="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),y=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;switch(_classCallCheck(this,n),(o=e.call(this)).syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=l;break;case 1:if(!t){o.destination=l;break}if("object"==typeof t){t instanceof n?(o.syncErrorThrowable=t.syncErrorThrowable,o.destination=t,t.add(_assertThisInitialized(o))):(o.syncErrorThrowable=!0,o.destination=new b(_assertThisInitialized(o),t));break}default:o.syncErrorThrowable=!0,o.destination=new b(_assertThisInitialized(o),t,r,i)}return o}return _createClass(n,[{key:g,value:function(){return this}},{key:"next",value:function(t){this.isStopped||this._next(t)}},{key:"error",value:function(t){this.isStopped||(this.isStopped=!0,this._error(t))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(t){this.destination.next(t)}},{key:"_error",value:function(t){this.destination.error(t),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}],[{key:"create",value:function(t,e,r){var i=new n(t,e,r);return i.syncErrorThrowable=!1,i}}]),n}(v),b=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var s,u;_classCallCheck(this,n),(s=e.call(this))._parentSubscriber=t;var c=_assertThisInitialized(s);return a(r)?u=r:r&&(u=r.next,i=r.error,o=r.complete,r!==l&&(a((c=Object.create(r)).unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(_assertThisInitialized(s)))),s._context=c,s._next=u,s._error=i,s._complete=o,s}return _createClass(n,[{key:"next",value:function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}},{key:"error",value:function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;c(t)}}}},{key:"complete",value:function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw n;c(n)}}},{key:"__tryOrSetError",value:function(t,e,n){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(c(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}]),n}(y),_="function"==typeof Symbol&&Symbol.observable||"@@observable";function w(t){return t}function x(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return C(e)}function C(t){return 0===t.length?w:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var k,E=((k=function(){function t(e){_classCallCheck(this,t),this._isScalar=!1,e&&(this._subscribe=e)}return _createClass(t,[{key:"lift",value:function(e){var n=new t;return n.source=this,n.operator=e,n}},{key:"subscribe",value:function(t,e,n){var r=this.operator,i=function(t,e,n){if(t){if(t instanceof y)return t;if(t[g])return t[g]()}return t||e||n?new y(t,e,n):new y(l)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||u.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),u.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}},{key:"_trySubscribe",value:function(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof y?r:null}return!0}(t)?t.error(e):console.warn(e)}}},{key:"forEach",value:function(t,e){var n=this;return new(e=S(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(n){r(n),i&&i.unsubscribe()}}),r,e)}))}},{key:"_subscribe",value:function(t){var e=this.source;return e&&e.subscribe(t)}},{key:_,value:function(){return this}},{key:"pipe",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?this:C(e)(this)}},{key:"toPromise",value:function(t){var e=this;return new(t=S(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))}}]),t}()).create=function(t){return new k(t)},k);function S(t){if(t||(t=u.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var I,T=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),A=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).subject=t,i.subscriber=r,i.closed=!1,i}return _createClass(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}}}]),n}(v),R=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).destination=t,r}return n}(y),O=((I=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return _createClass(n,[{key:g,value:function(){return new R(this)}},{key:"lift",value:function(t){var e=new N(this,this);return e.operator=t,e}},{key:"next",value:function(t){if(this.closed)throw new T;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)}},{key:"error",value:function(t){if(this.closed)throw new T;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new T;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(t){if(this.closed)throw new T;return _get(_getPrototypeOf(n.prototype),"_trySubscribe",this).call(this,t)}},{key:"_subscribe",value:function(t){if(this.closed)throw new T;return this.hasError?(t.error(this.thrownError),v.EMPTY):this.isStopped?(t.complete(),v.EMPTY):(this.observers.push(t),new A(this,t))}},{key:"asObservable",value:function(){var t=new E;return t.source=this,t}}]),n}(E)).create=function(t,e){return new N(t,e)},I),N=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).destination=t,i.source=r,i}return _createClass(n,[{key:"next",value:function(t){var e=this.destination;e&&e.next&&e.next(t)}},{key:"error",value:function(t){var e=this.destination;e&&e.error&&this.destination.error(t)}},{key:"complete",value:function(){var t=this.destination;t&&t.complete&&this.destination.complete()}},{key:"_subscribe",value:function(t){return this.source?this.source.subscribe(t):v.EMPTY}}]),n}(O);function D(t){return t&&"function"==typeof t.schedule}var P=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this)).parent=t,o.outerValue=r,o.outerIndex=i,o.index=0,o}return _createClass(n,[{key:"_next",value:function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}},{key:"_error",value:function(t){this.parent.notifyError(t,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(y),M=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};var F="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",L=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function B(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var j=function(t){if(t&&"function"==typeof t[_])return r=t,function(t){var e=r[_]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(L(t))return M(t);if(B(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,c),t};if(t&&"function"==typeof t[F])return e=t,function(t){for(var n=e[F]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,i=f(t)?"an invalid object":"'".concat(t,"'");throw new TypeError("You provided ".concat(i," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function V(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new P(t,n,r);if(!i.closed)return e instanceof E?e.subscribe(i):j(e)(i)}var U=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}},{key:"notifyError",value:function(t,e){this.destination.error(t)}},{key:"notifyComplete",value:function(t){this.destination.complete()}}]),n}(y);function z(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new W(t,e))}}var W=function(){function t(e,n){_classCallCheck(this,t),this.project=e,this.thisArg=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new q(t,this.project,this.thisArg))}}]),t}(),q=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t)).project=r,o.count=0,o.thisArg=i||_assertThisInitialized(o),o}return _createClass(n,[{key:"_next",value:function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}]),n}(y);function H(t,e){return new E((function(n){var r=new v,i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function G(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[_]}(t))return function(t,e){return new E((function(n){var r=new v;return r.add(e.schedule((function(){var i=t[_]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(B(t))return function(t,e){return new E((function(n){var r=new v;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(L(t))return H(t,e);if(function(t){return t&&"function"==typeof t[F]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new E((function(n){var r,i=new v;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(e.schedule((function(){r=t[F](),i.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(o){return void n.error(o)}e?n.complete():(n.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof E?t:new E(j(t))}function K(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof e?function(r){return r.pipe(K((function(n,r){return G(t(n,r)).pipe(z((function(t,i){return e(n,t,r,i)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new X(t,n))})}var X=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,t),this.project=e,this.concurrent=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new $(t,this.project,this.concurrent))}}]),t}(),$=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,n),(i=e.call(this,t)).project=r,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return _createClass(n,[{key:"_next",value:function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}},{key:"_tryNext",value:function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}},{key:"_innerSub",value:function(t,e,n){var r=new P(this,e,n),i=this.destination;i.add(r);var o=V(this,t,void 0,void 0,r);o!==r&&i.add(o)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}},{key:"notifyComplete",value:function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(U);function Y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return K(w,t)}function Q(t,e){return e?H(t,e):new E(M(t))}function J(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Number.POSITIVE_INFINITY,i=null,o=e[e.length-1];return D(o)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(r=e.pop())):"number"==typeof o&&(r=e.pop()),null===i&&1===e.length&&e[0]instanceof E?e[0]:Y(r)(Q(e,i))}function Z(){return function(t){return t.lift(new et(t))}}var tt,et=function(){function t(e){_classCallCheck(this,t),this.connectable=e}return _createClass(t,[{key:"call",value:function(t,e){var n=this.connectable;n._refCount++;var r=new nt(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),t}(),nt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).connectable=r,i}return _createClass(n,[{key:"_unsubscribe",value:function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(y),rt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(tt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).source=t,i.subjectFactory=r,i._refCount=0,i._isComplete=!1,i}return _createClass(n,[{key:"_subscribe",value:function(t){return this.getSubject().subscribe(t)}},{key:"getSubject",value:function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new v).add(this.source.subscribe(new it(this.getSubject(),this))),t.closed&&(this._connection=null,t=v.EMPTY)),t}},{key:"refCount",value:function(){return Z()(this)}}]),n}(E).prototype)._subscribe},_isComplete:{value:tt._isComplete,writable:!0},getSubject:{value:tt.getSubject},connect:{value:tt.connect},refCount:{value:tt.refCount}},it=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).connectable=r,i}return _createClass(n,[{key:"_error",value:function(t){this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_error",this).call(this,t)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}]),n}(R);function ot(){return new O}function at(){return function(t){return Z()((e=ot,function(t){var n;n="function"==typeof e?e:function(){return e};var r=Object.create(t,rt);return r.source=t,r.subjectFactory=n,r})(t));var e}}function st(t){return{toString:t}.toString()}function ut(t,e,n){return st((function(){var r=function(t){return function(){if(t){var e=t.apply(void 0,arguments);for(var n in e)this[n]=e[n]}}}(e);function i(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this instanceof i)return r.apply(this,e),this;var o=_construct(i,e);return a.annotation=o,a;function a(t,e,n){for(var r=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(o),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}))}var ct=ut("Inject",(function(t){return{token:t}})),lt=ut("Optional"),ht=ut("Self"),ft=ut("SkipSelf"),dt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function pt(t){for(var e in t)if(t[e]===pt)return e;throw Error("Could not find renamed property on target object.")}function vt(t,e){for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function mt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function gt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function yt(t){return bt(t,t[wt])||bt(t,t[kt])}function bt(t,e){return e&&e.token===t?e:null}function _t(t){return t&&(t.hasOwnProperty(xt)||t.hasOwnProperty(Et))?t[xt]:null}var wt=pt({"\u0275prov":pt}),xt=pt({"\u0275inj":pt}),Ct=pt({"\u0275provFallback":pt}),kt=pt({ngInjectableDef:pt}),Et=pt({ngInjectorDef:pt});function St(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(St).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return"".concat(t.overriddenName);if(t.name)return"".concat(t.name);var e=t.toString();if(null==e)return""+e;var n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function It(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}var Tt=pt({__forward_ref__:pt});function At(t){return t.__forward_ref__=At,t.toString=function(){return St(this())},t}function Rt(t){return Ot(t)?t():t}function Ot(t){return"function"==typeof t&&t.hasOwnProperty(Tt)&&t.__forward_ref__===At}var Nt,Dt="undefined"!=typeof globalThis&&globalThis,Pt="undefined"!=typeof window&&window,Mt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ft="undefined"!=typeof global&&global,Lt=Dt||Ft||Pt||Mt,Bt=pt({"\u0275cmp":pt}),jt=pt({"\u0275dir":pt}),Vt=pt({"\u0275pipe":pt}),Ut=pt({"\u0275mod":pt}),zt=pt({"\u0275loc":pt}),Wt=pt({"\u0275fac":pt}),qt=pt({__NG_ELEMENT_ID__:pt}),Ht=function(){function t(e,n){_classCallCheck(this,t),this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=mt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(t,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),t}(),Gt=new Ht("INJECTOR",-1),Kt={},Xt=/\n/gm,$t=pt({provide:String,useValue:pt}),Yt=void 0;function Qt(t){var e=Yt;return Yt=t,e}function Jt(t){var e=Nt;return Nt=t,e}function Zt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt.Default;if(void 0===Yt)throw new Error("inject() must be called from an injection context");return null===Yt?ne(t,void 0,e):Yt.get(t,e&dt.Optional?null:void 0,e)}function te(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt.Default;return(Nt||Zt)(Rt(t),e)}var ee=te;function ne(t,e,n){var r=yt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&dt.Optional)return null;if(void 0!==e)return e;throw new Error("Injector: NOT_FOUND [".concat(St(t),"]"))}function re(t){for(var e=[],n=0;n<t.length;n++){var r=Rt(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,o=dt.Default,a=0;a<r.length;a++){var s=r[a];s instanceof lt||"Optional"===s.ngMetadataName||s===lt?o|=dt.Optional:s instanceof ft||"SkipSelf"===s.ngMetadataName||s===ft?o|=dt.SkipSelf:s instanceof ht||"Self"===s.ngMetadataName||s===ht?o|=dt.Self:i=s instanceof ct||s===ct?s.token:s}e.push(te(i,o))}else e.push(te(r))}return e}var ie=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kt;if(e===Kt){var n=new Error("NullInjectorError: No provider for ".concat(St(t),"!"));throw n.name="NullInjectorError",n}return e}}]),t}(),oe=function t(){_classCallCheck(this,t)},ae=function t(){_classCallCheck(this,t)};function se(t,e){t.forEach((function(t){return Array.isArray(t)?se(t,e):e(t)}))}function ue(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ce(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function le(t,e){for(var n=[],r=0;r<t;r++)n.push(e);return n}function he(t,e,n){var r=de(t,e);return r>=0?t[1|r]=n:function(t,e,n,r){var i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r=~r,e,n),r}function fe(t,e){var n=de(t,e);if(n>=0)return t[1|n]}function de(t,e){return function(t,e,n){for(var r=0,i=t.length>>1;i!==r;){var o=r+(i-r>>1),a=t[o<<1];if(e===a)return o<<1;a>e?i=o:r=o+1}return~(i<<1)}(t,e)}var pe=function(){var t={OnPush:0,Default:1};return t[t.OnPush]="OnPush",t[t.Default]="Default",t}(),ve=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),me={},ge=[],ye=0;function be(t){return st((function(){var e=t.type,n=e.prototype,r={},i={type:e,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:t.changeDetection===pe.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||ge,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||ve.Emulated,id:"c",styles:t.styles||ge,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.directives,a=t.features,s=t.pipes;return i.id+=ye++,i.inputs=ke(t.inputs,r),i.outputs=ke(t.outputs),a&&a.forEach((function(t){return t(i)})),i.directiveDefs=o?function(){return("function"==typeof o?o():o).map(_e)}:null,i.pipeDefs=s?function(){return("function"==typeof s?s():s).map(we)}:null,i}))}function _e(t){return Se(t)||function(t){return t[jt]||null}(t)}function we(t){return function(t){return t[Vt]||null}(t)}var xe={};function Ce(t){var e={type:t.type,bootstrap:t.bootstrap||ge,declarations:t.declarations||ge,imports:t.imports||ge,exports:t.exports||ge,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&st((function(){xe[t.id]=t.type})),e}function ke(t,e){if(null==t)return me;var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}var Ee=be;function Se(t){return t[Bt]||null}function Ie(t,e){return t.hasOwnProperty(Wt)?t[Wt]:null}function Te(t,e){var n=t[Ut]||null;if(!n&&!0===e)throw new Error("Type ".concat(St(t)," does not have '\u0275mod' property."));return n}function Ae(t){return Array.isArray(t)&&"object"==typeof t[1]}function Re(t){return Array.isArray(t)&&!0===t[1]}function Oe(t){return 0!=(8&t.flags)}function Ne(t){return 2==(2&t.flags)}function De(t){return 1==(1&t.flags)}function Pe(t){return null!==t.template}function Me(t){return 0!=(512&t[2])}var Fe=void 0;function Le(t){return!!t.listen}var Be={createRenderer:function(t,e){return void 0!==Fe?Fe:"undefined"!=typeof document?document:void 0}};function je(t){for(;Array.isArray(t);)t=t[0];return t}function Ve(t,e){return je(e[t+19])}function Ue(t,e){return je(e[t.index])}function ze(t,e){return t.data[e+19]}function We(t,e){return t[e+19]}function qe(t,e){var n=e[t];return Ae(n)?n:n[0]}function He(t){var e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Ge(t){return 4==(4&t[2])}function Ke(t){return 128==(128&t[2])}function Xe(t,e){return null===t||null==e?null:t[e]}function $e(t){t[18]=0}var Ye={lFrame:yn(null),bindingsEnabled:!0,checkNoChangesMode:!1};function Qe(){return Ye.bindingsEnabled}function Je(){return Ye.lFrame.lView}function Ze(){return Ye.lFrame.tView}function tn(t){Ye.lFrame.contextLView=t}function en(){return Ye.lFrame.previousOrParentTNode}function nn(t,e){Ye.lFrame.previousOrParentTNode=t,Ye.lFrame.isParent=e}function rn(){return Ye.lFrame.isParent}function on(){Ye.lFrame.isParent=!1}function an(){return Ye.checkNoChangesMode}function sn(t){Ye.checkNoChangesMode=t}function un(){var t=Ye.lFrame,e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function cn(){return Ye.lFrame.bindingIndex}function ln(){return Ye.lFrame.bindingIndex++}function hn(t){var e=Ye.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function fn(t,e){var n=Ye.lFrame;n.bindingIndex=n.bindingRootIndex=t,n.currentDirectiveIndex=e}function dn(){return Ye.lFrame.currentQueryIndex}function pn(t){Ye.lFrame.currentQueryIndex=t}function vn(t,e){var n=gn();Ye.lFrame=n,n.previousOrParentTNode=e,n.lView=t}function mn(t,e){var n=gn(),r=t[1];Ye.lFrame=n,n.previousOrParentTNode=e,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex}function gn(){var t=Ye.lFrame,e=null===t?null:t.child;return null===e?yn(t):e}function yn(t){var e={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function bn(){var t=Ye.lFrame;return Ye.lFrame=t.parent,t.previousOrParentTNode=null,t.lView=null,t}var _n=bn;function wn(){var t=bn();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.currentSanitizer=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function xn(){return Ye.lFrame.selectedIndex}function Cn(t){Ye.lFrame.selectedIndex=t}function kn(){var t=Ye.lFrame;return ze(t.tView,t.selectedIndex)}function En(){Ye.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function Sn(){Ye.lFrame.currentNamespace=null}function In(t,e){for(var n=e.directiveStart,r=e.directiveEnd;n<r;n++){var i=t.data[n];i.afterContentInit&&(t.contentHooks||(t.contentHooks=[])).push(-n,i.afterContentInit),i.afterContentChecked&&((t.contentHooks||(t.contentHooks=[])).push(n,i.afterContentChecked),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i.afterContentChecked)),i.afterViewInit&&(t.viewHooks||(t.viewHooks=[])).push(-n,i.afterViewInit),i.afterViewChecked&&((t.viewHooks||(t.viewHooks=[])).push(n,i.afterViewChecked),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,i.afterViewChecked)),null!=i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(n,i.onDestroy)}}function Tn(t,e,n){On(t,e,3,n)}function An(t,e,n,r){(3&t[2])===n&&On(t,e,n,r)}function Rn(t,e){var n=t[2];(3&n)===e&&(n&=1023,n+=1,t[2]=n)}function On(t,e,n,r){for(var i=null!=r?r:-1,o=0,a=void 0!==r?65535&t[18]:0;a<e.length;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=r&&o>=r)break}else e[a]<0&&(t[18]+=65536),(o<i||-1==i)&&(Nn(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function Nn(t,e,n,r){var i=n[r]<0,o=n[r+1],a=t[i?-n[r]:n[r]];i?t[2]>>10<t[18]>>16&&(3&t[2])===e&&(t[2]+=1024,o.call(a)):o.call(a)}var Dn=function t(e,n,r){_classCallCheck(this,t),this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r};function Pn(t,e,n){for(var r=Le(t),i=0;i<n.length;){var o=n[i];if("number"==typeof o){if(0!==o)break;i++;var a=n[i++],s=n[i++],u=n[i++];r?t.setAttribute(e,s,u,a):e.setAttributeNS(a,s,u)}else{var c=o,l=n[++i];Fn(c)?r&&t.setProperty(e,c,l):r?t.setAttribute(e,c,l):e.setAttribute(c,l),i++}}return i}function Mn(t){return 3===t||4===t||6===t}function Fn(t){return 64===t.charCodeAt(0)}function Ln(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else for(var n=-1,r=0;r<e.length;r++){var i=e[r];"number"==typeof i?n=i:0===n||Bn(t,n,i,null,-1===n||2===n?e[++r]:null)}return t}function Bn(t,e,n,r,i){var o=0,a=t.length;if(-1===e)a=-1;else for(;o<t.length;){var s=t[o++];if("number"==typeof s){if(s===e){a=-1;break}if(s>e){a=o-1;break}}}for(;o<t.length;){var u=t[o];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,e),o=a+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function jn(t){return-1!==t}function Vn(t){return 32767&t}function Un(t){return t>>16}function zn(t,e){for(var n=Un(t),r=e;n>0;)r=r[15],n--;return r}function Wn(t){return"string"==typeof t?t:null==t?"":""+t}function qn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Wn(t)}var Hn=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Lt);function Gn(t){return{name:"body",target:t.ownerDocument.body}}function Kn(t){return t instanceof Function?t():t}var Xn=!0;function $n(t){var e=Xn;return Xn=t,e}var Yn=0;function Qn(t,e){var n=Zn(t,e);if(-1!==n)return n;var r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Jn(r.data,t),Jn(e,null),Jn(r.blueprint,null));var i=tr(t,e),o=t.injectorIndex;if(jn(i))for(var a=Vn(i),s=zn(i,e),u=s[1].data,c=0;c<8;c++)e[o+c]=s[a+c]|u[a+c];return e[o+8]=i,o}function Jn(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Zn(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null==e[t.injectorIndex+8]?-1:t.injectorIndex}function tr(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;for(var n=e[6],r=1;n&&-1===n.injectorIndex;)n=(e=e[15])?e[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function er(t,e,n){!function(t,e,n){var r="string"!=typeof n?n[qt]:n.charCodeAt(0)||0;null==r&&(r=n[qt]=Yn++);var i=255&r,o=1<<i,a=64&i,s=32&i,u=e.data;128&i?a?s?u[t+7]|=o:u[t+6]|=o:s?u[t+5]|=o:u[t+4]|=o:a?s?u[t+3]|=o:u[t+2]|=o:s?u[t+1]|=o:u[t]|=o}(t,e,n)}function nr(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:dt.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==t){var o=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;var e=t[qt];return"number"==typeof e&&e>0?255&e:e}(n);if("function"==typeof o){vn(e,t);try{var a=o();if(null!=a||r&dt.Optional)return a;throw new Error("No provider for ".concat(qn(n),"!"))}finally{_n()}}else if("number"==typeof o){if(-1===o)return new cr(t,e);var s=null,u=Zn(t,e),c=-1,l=r&dt.Host?e[16][6]:null;for((-1===u||r&dt.SkipSelf)&&(c=-1===u?tr(t,e):e[u+8],ur(r,!1)?(s=e[1],u=Vn(c),e=zn(c,e)):u=-1);-1!==u;){c=e[u+8];var h=e[1];if(sr(o,u,h.data)){var f=ir(u,e,n,s,r,l);if(f!==rr)return f}ur(r,e[1].data[u+8]===l)&&sr(o,u,e)?(s=h,u=Vn(c),e=zn(c,e)):u=-1}}}if(r&dt.Optional&&void 0===i&&(i=null),0==(r&(dt.Self|dt.Host))){var d=e[9],p=Jt(void 0);try{return d?d.get(n,i,r&dt.Optional):ne(n,i,r&dt.Optional)}finally{Jt(p)}}if(r&dt.Optional)return i;throw new Error("NodeInjector: NOT_FOUND [".concat(qn(n),"]"))}var rr={};function ir(t,e,n,r,i,o){var a=e[1],s=a.data[t+8],u=or(s,a,n,null==r?Ne(s)&&Xn:r!=a&&3===s.type,i&dt.Host&&o===s);return null!==u?ar(e,a,u,s):rr}function or(t,e,n,r,i){for(var o=t.providerIndexes,a=e.data,s=65535&o,u=t.directiveStart,c=o>>16,l=i?s+c:t.directiveEnd,h=r?s:s+c;h<l;h++){var f=a[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=a[u];if(d&&Pe(d)&&d.type===n)return u}return null}function ar(t,e,n,r){var i=t[n],o=e.data;if(i instanceof Dn){var a=i;if(a.resolving)throw new Error("Circular dep for ".concat(qn(o[n])));var s,u=$n(a.canSeeViewProviders);a.resolving=!0,a.injectImpl&&(s=Jt(a.injectImpl)),vn(t,r);try{i=t[n]=a.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){var r=e.onChanges,i=e.onInit,o=e.doCheck;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)),i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{a.injectImpl&&Jt(s),$n(u),a.resolving=!1,_n()}}return i}function sr(t,e,n){var r=64&t,i=32&t;return!!((128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e])&1<<t)}function ur(t,e){return!(t&dt.Self||t&dt.Host&&e)}var cr=function(){function t(e,n){_classCallCheck(this,t),this._tNode=e,this._lView=n}return _createClass(t,[{key:"get",value:function(t,e){return nr(this._tNode,this._lView,t,void 0,e)}}]),t}();function lr(t){return st((function(){var e=Object.getPrototypeOf(t.prototype).constructor,n=e[Wt]||function t(e){var n=e;if(Ot(e))return function(){var e=t(Rt(n));return e?e():null};var r=Ie(n);if(null===r){var i=_t(n);r=i&&i.factory}return r||null}(e);return null!==n?n:function(t){return new t}}))}function hr(t){return t.ngDebugContext}function fr(t){return t.ngOriginalError}function dr(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t.error.apply(t,n)}var pr=function(){function t(){_classCallCheck(this,t),this._console=console}return _createClass(t,[{key:"handleError",value:function(t){var e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||dr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(t){return t?hr(t)?hr(t):this._findContext(fr(t)):null}},{key:"_findOriginalError",value:function(t){for(var e=fr(t);e&&fr(e);)e=fr(e);return e}}]),t}(),vr=function(){function t(e){_classCallCheck(this,t),this.changingThisBreaksApplicationSecurity=e}return _createClass(t,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),t}(),mr=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(vr),gr=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(vr),yr=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(vr),br=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(vr),_r=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(vr);function wr(t){return t instanceof vr?t.changingThisBreaksApplicationSecurity:t}function xr(t,e){var n=Cr(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error("Required a safe ".concat(e,", got a ").concat(n," (see http://g.co/ng/security#xss)"))}return n===e}function Cr(t){return t instanceof vr&&t.getTypeName()||null}var kr=!0,Er=!1;function Sr(){return Er=!0,kr}var Ir=function(){function t(e){_classCallCheck(this,t),this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");var n=this.inertDocument.body;if(null==n){var r=this.inertDocument.createElement("html");this.inertDocument.appendChild(r),n=this.inertDocument.createElement("body"),r.appendChild(n)}n.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!n.querySelector||n.querySelector("svg")?(n.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=n.querySelector&&n.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(t,[{key:"getInertBodyElement_XHR",value:function(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(r){return null}var e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);var n=e.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(t){t="<body><remove></remove>"+t+"</body>";try{var e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(t){var e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=t,e;var n=this.inertDocument.createElement("body");return n.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(t){for(var e=t.attributes,n=e.length-1;0<n;n--){var r=e.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||t.removeAttribute(r)}for(var i=t.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),t}(),Tr=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Ar=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Rr(t){return(t=String(t)).match(Tr)||t.match(Ar)?t:(Sr()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(t," (see http://g.co/ng/security#xss)")),"unsafe:"+t)}function Or(t){var e,n={},r=_createForOfIteratorHelper(t.split(","));try{for(r.s();!(e=r.n()).done;){n[e.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function Nr(){for(var t={},e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)a.hasOwnProperty(s)&&(t[s]=!0)}return t}var Dr,Pr=Or("area,br,col,hr,img,wbr"),Mr=Or("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Fr=Or("rp,rt"),Lr=Nr(Fr,Mr),Br=Nr(Pr,Nr(Mr,Or("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Nr(Fr,Or("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Lr),jr=Or("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Vr=Or("srcset"),Ur=Nr(jr,Vr,Or("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Or("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),zr=Or("script,style,template"),Wr=function(){function t(){_classCallCheck(this,t),this.sanitizedSomething=!1,this.buf=[]}return _createClass(t,[{key:"sanitizeChildren",value:function(t){for(var e=t.firstChild,n=!0;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);var r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(t){var e=t.nodeName.toLowerCase();if(!Br.hasOwnProperty(e))return this.sanitizedSomething=!0,!zr.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);for(var n,r=t.attributes,i=0;i<r.length;i++){var o=r.item(i),a=o.name,s=a.toLowerCase();if(Ur.hasOwnProperty(s)){var u=o.value;jr[s]&&(u=Rr(u)),Vr[s]&&(n=u,u=(n=String(n)).split(",").map((function(t){return Rr(t.trim())})).join(", ")),this.buf.push(" ",a,'="',Gr(u),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(t){var e=t.nodeName.toLowerCase();Br.hasOwnProperty(e)&&!Pr.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}},{key:"chars",value:function(t){this.buf.push(Gr(t))}},{key:"checkClobberedElement",value:function(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(t.outerHTML));return e}}]),t}(),qr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Hr=/([^\#-~ |!])/g;function Gr(t){return t.replace(/&/g,"&amp;").replace(qr,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(Hr,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Kr(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Xr=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}(),$r=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Yr=/^url\(([^)]+)\)$/;function Qr(t){var e,n=(e=Je())&&e[12];return n?n.sanitize(Xr.URL,t)||"":xr(t,"URL")?wr(t):Rr(Wn(t))}function Jr(t,e){t.__ngContext__=e}function Zr(t){throw new Error("Multiple components match node with tagname ".concat(t.tagName))}function ti(){throw new Error("Cannot mix multi providers and regular providers")}function ei(t,e,n){for(var r=t.length;;){var i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){var o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}function ni(t,e,n){for(var r=0;r<t.length;){var i=t[r++];if(n&&"class"===i){if(-1!==ei((i=t[r]).toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function ri(t,e,n){return e===(0!==t.type||n?t.tagName:"ng-template")}function ii(t,e,n){for(var r=4,i=t.attrs||[],o=function(t){for(var e=0;e<t.length;e++)if(Mn(t[e]))return e;return t.length}(i),a=!1,s=0;s<e.length;s++){var u=e[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!ri(t,u,n)||""===u&&1===e.length){if(oi(r))return!1;a=!0}}else{var c=8&r?u:e[++s];if(8&r&&null!==t.attrs){if(!ni(t.attrs,c,n)){if(oi(r))return!1;a=!0}continue}var l=ai(8&r?"class":u,i,0==t.type&&"ng-template"!==t.tagName,n);if(-1===l){if(oi(r))return!1;a=!0;continue}if(""!==c){var h;h=l>o?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==ei(f,c,0)||2&r&&c!==h){if(oi(r))return!1;a=!0}}}}else{if(!a&&!oi(r)&&!oi(u))return!1;if(a&&oi(u))continue;a=!1,r=u|1&r}}return oi(r)||a}function oi(t){return 0==(1&t)}function ai(t,e,n,r){if(null===e)return-1;var i=0;if(r||!n){for(var o=!1;i<e.length;){var a=e[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){for(var s=e[++i];"string"==typeof s;)s=e[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function(t,e){var n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){if(t[n]===e)return n;n++}return-1}(e,t)}function si(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<e.length;r++)if(ii(t,e[r],n))return!0;return!1}function ui(t,e){t:for(var n=0;n<e.length;n++){var r=e[n];if(t.length===r.length){for(var i=0;i<t.length;i++)if(t[i]!==r[i])continue t;return!0}}return!1}function ci(t,e){return t?":not("+e.trim()+")":e}function li(t){for(var e=t[0],n=1,r=2,i="",o=!1;n<t.length;){var a=t[n];if("string"==typeof a)if(2&r){var s=t[++n];i+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""===i||oi(a)||(e+=ci(o,i),i=""),r=a,o=o||!oi(r);n++}return""!==i&&(e+=ci(o,i)),e}var hi={};function fi(t){var e=t[3];return Re(e)?e[3]:e}function di(t){pi(Ze(),Je(),xn()+t,an())}function pi(t,e,n,r){if(!r)if(3==(3&e[2])){var i=t.preOrderCheckHooks;null!==i&&Tn(e,i,n)}else{var o=t.preOrderHooks;null!==o&&An(e,o,0,n)}Cn(n)}function vi(t,e){return t<<17|e<<2}function mi(t){return t>>17&32767}function gi(t){return 2|t}function yi(t){return(131068&t)>>2}function bi(t,e){return-131069&t|e<<2}function _i(t){return 1|t}function wi(t,e){var n=t.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1];if(-1!==o){var a=t.data[o];pn(i),a.contentQueries(2,e[o],o)}}}function xi(t,e,n){return Le(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Ci(t,e,n,r,i,o,a,s,u,c){var l=e.blueprint.slice();return l[0]=i,l[2]=140|r,$e(l),l[3]=l[15]=t,l[8]=n,l[10]=a||t&&t[10],l[11]=s||t&&t[11],l[12]=u||t&&t[12]||null,l[9]=c||t&&t[9]||null,l[6]=o,l[16]=2==e.type?t[16]:l,l}function ki(t,e,n,r,i,o){var a=n+19,s=t.data[a]||function(t,e,n,r,i,o){var a=en(),s=rn(),u=s?a:a&&a.parent,c=t.data[n]=Pi(0,u&&u!==e?u:null,r,n,i,o);return null===t.firstChild&&(t.firstChild=c),a&&(!s||null!=a.child||null===c.parent&&2!==a.type?s||(a.next=c):a.child=c),c}(t,e,a,r,i,o);return nn(s,!0),s}function Ei(t,e,n){mn(e,e[6]);try{var r=t.viewQuery;null!==r&&ro(1,r,n);var i=t.template;null!==i&&Ti(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&wi(t,e),t.staticViewQueries&&ro(2,t.viewQuery,n);var o=t.components;null!==o&&function(t,e){for(var n=0;n<e.length;n++)Ji(t,e[n])}(e,o)}finally{e[2]&=-5,wn()}}function Si(t,e,n,r){var i=e[2];if(256!=(256&i)){mn(e,e[6]);var o=an();try{$e(e),Ye.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Ti(t,e,n,2,r);var a=3==(3&i);if(!o)if(a){var s=t.preOrderCheckHooks;null!==s&&Tn(e,s,null)}else{var u=t.preOrderHooks;null!==u&&An(e,u,0,null),Rn(e,0)}if(function(t){for(var e=t[13];null!==e;){var n=void 0;if(Re(e)&&(n=e[2])>>1==-1){for(var r=9;r<e.length;r++){var i=e[r],o=i[1];Ke(i)&&Si(o,i,o.template,i[8])}0!=(1&n)&&Yi(e,t[16])}e=e[4]}}(e),null!==t.contentQueries&&wi(t,e),!o)if(a){var c=t.contentCheckHooks;null!==c&&Tn(e,c)}else{var l=t.contentHooks;null!==l&&An(e,l,1),Rn(e,1)}!function(t,e){try{var n=t.expandoInstructions;if(null!==n)for(var r=t.expandoStartIndex,i=-1,o=0;o<n.length;o++){var a=n[o];"number"==typeof a?a<=0?(Cn(0-a),i=r+=9+n[++o]):r+=a:(null!==a&&(fn(r,i),a(2,e[i])),i++)}}finally{Cn(-1)}}(t,e);var h=t.components;null!==h&&function(t,e){for(var n=0;n<e.length;n++)Qi(t,e[n])}(e,h);var f=t.viewQuery;if(null!==f&&ro(2,f,r),!o)if(a){var d=t.viewCheckHooks;null!==d&&Tn(e,d)}else{var p=t.viewHooks;null!==p&&An(e,p,2),Rn(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73)}finally{wn()}}}function Ii(t,e,n,r){var i=e[10],o=!an(),a=Ge(e);try{o&&!a&&i.begin&&i.begin(),a&&Ei(t,e,r),Si(t,e,n,r)}finally{o&&!a&&i.end&&i.end()}}function Ti(t,e,n,r,i){var o=xn();try{Cn(-1),2&r&&e.length>19&&pi(t,e,0,an()),n(r,i)}finally{Cn(o)}}function Ai(t,e,n){if(Oe(e))for(var r=e.directiveEnd,i=e.directiveStart;i<r;i++){var o=t.data[i];o.contentQueries&&o.contentQueries(1,n[i],i)}}function Ri(t,e,n){Qe()&&(function(t,e,n,r){var i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Qn(n,e),Jr(r,e);for(var a=n.initialInputs,s=i;s<o;s++){var u=t.data[s],c=Pe(u);c&&Gi(e,n,u);var l=ar(e,t,s,n);Jr(l,e),null!==a&&Ki(0,s-i,l,u,0,a),c&&(qe(n.index,e)[8]=l)}}(t,e,n,Ue(n,e)),128==(128&n.flags)&&function(t,e,n){var r=n.directiveStart,i=n.directiveEnd,o=t.expandoInstructions,a=t.firstCreatePass,s=n.index-19;try{Cn(s);for(var u=r;u<i;u++){var c=t.data[u],l=e[u];null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs?Vi(c,l):a&&o.push(null)}}finally{Cn(-1)}}(t,e,n))}function Oi(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ue,r=e.localNames;if(null!==r)for(var i=e.index+1,o=0;o<r.length;o+=2){var a=r[o+1],s=-1===a?n(e,t):t[a];t[i++]=s}}function Ni(t){return t.tView||(t.tView=Di(1,-1,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts))}function Di(t,e,n,r,i,o,a,s,u,c){var l=19+r,h=l+i,f=function(t,e){for(var n=[],r=0;r<e;r++)n.push(r<t?null:hi);return n}(l,h);return f[1]={type:t,id:e,blueprint:f,template:n,queries:null,viewQuery:s,node:null,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:c}}function Pi(t,e,n,r,i,o){return{type:n,index:r,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Mi(t,e,n){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function Fi(t,e,n,r,i,o,a,s){var u,c=Ue(e,n),l=e.inputs;!s&&null!=l&&(u=l[r])?(co(t,n,u,r,i),Ne(e)&&function(t,e){var n=qe(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3===e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=a?a(i,e.tagName||"",r):i,Le(o)?o.setProperty(c,r,i):Fn(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function Li(t,e,n,r){var i=!1;if(Qe()){var o=function(t,e,n){var r=t.directiveRegistry,i=null;if(r)for(var o=0;o<r.length;o++){var a=r[o];si(n,a.selectors,!1)&&(i||(i=[]),er(Qn(n,e),t,a.type),Pe(a)?(2&n.flags&&Zr(n),zi(t,n),i.unshift(a)):i.push(a))}return i}(t,e,n),a=null===r?null:{"":-1};if(null!==o){var s=0;i=!0,qi(n,t.data.length,o.length);for(var u=0;u<o.length;u++){var c=o[u];c.providersResolver&&c.providersResolver(c)}Ui(t,n,o.length);for(var l=!1,h=!1,f=0;f<o.length;f++){var d=o[f];n.mergedAttrs=Ln(n.mergedAttrs,d.hostAttrs),Hi(t,e,d),Wi(t.data.length-1,d,a),null!==d.contentQueries&&(n.flags|=8),null===d.hostBindings&&null===d.hostAttrs&&0===d.hostVars||(n.flags|=128),!l&&(d.onChanges||d.onInit||d.doCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index-19),l=!0),h||!d.onChanges&&!d.doCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index-19),h=!0),Bi(t,d),s+=d.hostVars}!function(t,e){for(var n=e.directiveEnd,r=t.data,i=e.attrs,o=[],a=null,s=null,u=e.directiveStart;u<n;u++){var c=r[u],l=c.inputs;o.push(null!==i?Xi(l,i):null),a=Mi(l,u,a),s=Mi(c.outputs,u,s)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=s}(t,n),ji(t,e,s)}a&&function(t,e,n){if(e)for(var r=t.localNames=[],i=0;i<e.length;i+=2){var o=n[e[i+1]];if(null==o)throw new Error("Export of name '".concat(e[i+1],"' not found!"));r.push(e[i],o)}}(n,r,a)}return n.mergedAttrs=Ln(n.mergedAttrs,n.attrs),i}function Bi(t,e){var n=t.expandoInstructions;n.push(e.hostBindings),0!==e.hostVars&&n.push(e.hostVars)}function ji(t,e,n){for(var r=0;r<n;r++)e.push(hi),t.blueprint.push(hi),t.data.push(null)}function Vi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Ui(t,e,n){var r=19-e.index,i=t.data.length-(65535&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(r,i,n)}function zi(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Wi(t,e,n){if(n){if(e.exportAs)for(var r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Pe(e)&&(n[""]=t)}}function qi(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Hi(t,e,n){t.data.push(n);var r=n.factory||(n.factory=Ie(n.type)),i=new Dn(r,Pe(n),null);t.blueprint.push(i),e.push(i)}function Gi(t,e,n){var r=Ue(e,t),i=Ni(n),o=t[10],a=Zi(t,Ci(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n)));t[e.index]=a}function Ki(t,e,n,r,i,o){var a=o[e];if(null!==a)for(var s=r.setInput,u=0;u<a.length;){var c=a[u++],l=a[u++],h=a[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function Xi(t,e){for(var n=null,r=0;r<e.length;){var i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function $i(t,e,n,r){return new Array(t,!0,-2,e,null,null,r,n,null)}function Yi(t,e){for(var n=t[5],r=0;r<n.length;r++){var i=n[r],o=i[3][3][16];if(o!==e&&0==(16&o[2])){var a=i[1];Si(a,i,a.template,i[8])}}}function Qi(t,e){var n=qe(e,t);if(Ke(n)&&80&n[2]){var r=n[1];Si(r,n,r.template,n[8])}}function Ji(t,e){var n=qe(e,t),r=n[1];!function(t,e){for(var n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Ei(r,n,n[8])}function Zi(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function to(t){for(;t;){t[2]|=64;var e=fi(t);if(Me(t)&&!e)return t;t=e}return null}function eo(t,e,n){var r=e[10];r.begin&&r.begin();try{Si(t,e,t.template,n)}catch(i){throw uo(e,i),i}finally{r.end&&r.end()}}function no(t){!function(t){for(var e=0;e<t.components.length;e++){var n=t.components[e],r=He(n),i=r[1];Ii(i,r,i.template,n)}}(t[8])}function ro(t,e,n){pn(0),e(t,n)}var io=Promise.resolve(null);function oo(t){return t[7]||(t[7]=[])}function ao(t){return t.cleanup||(t.cleanup=[])}function so(t,e){return function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(e[t.index])[11]}function uo(t,e){var n=t[9],r=n?n.get(pr,null):null;r&&r.handleError(e)}function co(t,e,n,r,i){for(var o=0;o<n.length;){var a=n[o++],s=n[o++],u=e[a],c=t.data[a];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function lo(t,e,n){var r=Ve(e,t),i=t[11];Le(i)?i.setValue(r,n):r.textContent=n}function ho(t,e){var n=e[3];return-1===t.index?Re(n)?n:null:n}function fo(t,e){var n=ho(t,e);return n?Eo(e[11],n[7]):null}function po(t,e,n,r,i){if(null!=r){var o,a=!1;Re(r)?o=r:Ae(r)&&(a=!0,r=r[0]);var s=je(r);0===t&&null!==n?null==i?Co(e,n,s):xo(e,n,s,i||null):1===t&&null!==n?xo(e,n,s,i||null):2===t?function(t,e,n){var r=Eo(t,e);r&&function(t,e,n,r){Le(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,s,a):3===t&&e.destroyNode(s),null!=o&&function(t,e,n,r,i){var o=n[7];o!==je(n)&&po(e,t,r,o,i);for(var a=9;a<n.length;a++){var s=n[a];Ro(s[1],s,t,e,r,o)}}(e,t,o,n,i)}}function vo(t,e,n,r){var i=fo(t.node,e);i&&Ro(t,e,e[11],n?1:2,i,r)}function mo(t,e){var n=t[5],r=n.indexOf(e);n.splice(r,1)}function go(t,e){if(!(t.length<=9)){var n=9+e,r=t[n];if(r){var i=r[17];null!==i&&i!==t&&mo(i,r),e>0&&(t[n-1][4]=r[4]);var o=ce(t,9+e);vo(r[1],r,!1,null);var a=o[5];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function yo(t,e){if(!(256&e[2])){var n=e[11];Le(n)&&n.destroyNode&&Ro(t,e,n,3,null,null),function(t){var e=t[13];if(!e)return _o(t[1],t);for(;e;){var n=null;if(Ae(e))n=e[13];else{var r=e[9];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Ae(e)&&_o(e[1],e),e=bo(e,t);null===e&&(e=t),Ae(e)&&_o(e[1],e),n=e&&e[4]}e=n}}(e)}}function bo(t,e){var n;return Ae(t)&&(n=t[6])&&2===n.type?ho(n,t):t[3]===e?null:t[3]}function _o(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){var n;if(null!=t&&null!=(n=t.destroyHooks))for(var r=0;r<n.length;r+=2){var i=e[n[r]];i instanceof Dn||n[r+1].call(i)}}(t,e),function(t,e){var n=t.cleanup;if(null!==n){for(var r=e[7],i=0;i<n.length-1;i+=2)if("string"==typeof n[i]){var o=n[i+1],a="function"==typeof o?o(e):je(e[o]),s=r[n[i+2]],u=n[i+3];"boolean"==typeof u?a.removeEventListener(n[i],s,u):u>=0?r[u]():r[-u].unsubscribe(),i+=2}else n[i].call(r[n[i+1]]);e[7]=null}}(t,e);var n=e[6];n&&3===n.type&&Le(e[11])&&e[11].destroy();var r=e[17];if(null!==r&&Re(e[3])){r!==e[3]&&mo(r,e);var i=e[5];null!==i&&i.detachView(t)}}}function wo(t,e,n){for(var r=e.parent;null!=r&&(4===r.type||5===r.type);)r=(e=r).parent;if(null==r){var i=n[6];return 2===i.type?fo(i,n):n[0]}if(e&&5===e.type&&4&e.flags)return Ue(e,n).parentNode;if(2&r.flags){var o=t.data,a=o[o[r.index].directiveStart].encapsulation;if(a!==ve.ShadowDom&&a!==ve.Native)return null}return Ue(r,n)}function xo(t,e,n,r){Le(t)?t.insertBefore(e,n,r):e.insertBefore(n,r,!0)}function Co(t,e,n){Le(t)?t.appendChild(e,n):e.appendChild(n)}function ko(t,e,n,r){null!==r?xo(t,e,n,r):Co(t,e,n)}function Eo(t,e){return Le(t)?t.parentNode(e):e.parentNode}function So(t,e){if(2===t.type){var n=ho(t,e);return null===n?null:To(n.indexOf(e,9)-9,n)}return 4===t.type||5===t.type?Ue(t,e):null}function Io(t,e,n,r){var i=wo(t,r,e);if(null!=i){var o=e[11],a=So(r.parent||e[6],e);if(Array.isArray(n))for(var s=0;s<n.length;s++)ko(o,i,n[s],a);else ko(o,i,n,a)}}function To(t,e){var n=9+t+1;if(n<e.length){var r=e[n],i=r[1].firstChild;if(null!==i)return function t(e,n){if(null!==n){var r=n.type;if(3===r)return Ue(n,e);if(0===r)return To(-1,e[n.index]);if(4===r||5===r){var i=n.child;if(null!==i)return t(e,i);var o=e[n.index];return Re(o)?To(-1,o):je(o)}var a=e[16],s=a[6],u=fi(a),c=s.projection[n.projection];return null!=c?t(u,c):t(e,n.next)}return null}(r,i)}return e[7]}function Ao(t,e,n,r,i,o,a){for(;null!=n;){var s=r[n.index],u=n.type;a&&0===e&&(s&&Jr(je(s),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(Ao(t,e,n.child,r,i,o,!1),po(e,t,i,s,o)):1===u?Oo(t,e,r,n,i,o):po(e,t,i,s,o)),n=a?n.projectionNext:n.next}}function Ro(t,e,n,r,i,o){Ao(n,r,t.node.child,e,i,o,!1)}function Oo(t,e,n,r,i,o){var a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)po(e,t,i,s[u],o);else Ao(t,e,s,a[3],i,o,!0)}function No(t,e,n){Le(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Do(t,e,n){Le(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}var Po,Mo,Fo,Lo=function(){function t(e,n){_classCallCheck(this,t),this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}return _createClass(t,[{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}yo(this._lView[1],this._lView)}},{key:"onDestroy",value:function(t){var e,n,r;e=this._lView[1],r=t,oo(n=this._lView).push(r),e.firstCreatePass&&ao(e).push(n[7].length-1,null)}},{key:"markForCheck",value:function(){to(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){eo(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(t,e,n){sn(!0);try{eo(t,e,n)}finally{sn(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}},{key:"detachFromAppRef",value:function(){var t;this._appRef=null,Ro(this._lView[1],t=this._lView,t[11],2,null,null)}},{key:"attachToAppRef",value:function(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}},{key:"rootNodes",get:function(){var t=this._lView;return null==t[0]?function t(e,n,r,i){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==r;){var a=n[r.index];if(null!==a&&i.push(je(a)),Re(a))for(var s=9;s<a.length;s++){var u=a[s],c=u[1].firstChild;null!==c&&t(u[1],u,c,i)}var l=r.type;if(4===l||5===l)t(e,n,r.child,i);else if(1===l){var h=n[16],f=h[6],d=fi(h),p=f.projection[r.projection];null!==p&&null!==d&&t(d[1],d,p,i,!0)}r=o?r.projectionNext:r.next}return i}(t[1],t,t[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}}]),t}(),Bo=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t))._view=t,r}return _createClass(n,[{key:"detectChanges",value:function(){no(this._view)}},{key:"checkNoChanges",value:function(){!function(t){sn(!0);try{no(t)}finally{sn(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(Lo);function jo(t,e,n){return Po||(Po=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(t)),new Po(Ue(e,n))}function Vo(t,e,n,r){return Mo||(Mo=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this))._declarationView=t,o._declarationTContainer=r,o.elementRef=i,o}return _createClass(n,[{key:"createEmbeddedView",value:function(t){var e=this._declarationTContainer.tViews,n=Ci(this._declarationView,e,t,16,null,e.node);n[17]=this._declarationView[this._declarationTContainer.index];var r=this._declarationView[5];null!==r&&(n[5]=r.createEmbeddedView(e)),Ei(e,n,t);var i=new Lo(n);return i._tViewNode=n[6],i}}]),n}(t)),0===n.type?new Mo(r,n,jo(e,n,r)):null}function Uo(t,e,n,r){var i;Fo||(Fo=function(t){_inherits(r,t);var n=_createSuper(r);function r(t,e,i){var o;return _classCallCheck(this,r),(o=n.call(this))._lContainer=t,o._hostTNode=e,o._hostView=i,o}return _createClass(r,[{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}},{key:"createEmbeddedView",value:function(t,e,n){var r=t.createEmbeddedView(e||{});return this.insert(r,n),r}},{key:"createComponent",value:function(t,e,n,r,i){var o=n||this.parentInjector;if(!i&&null==t.ngModule&&o){var a=o.get(oe,null);a&&(i=a)}var s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}},{key:"insert",value:function(t,e){var n=t._lView,r=n[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Re(n[3])){var i=this.indexOf(t);if(-1!==i)this.detach(i);else{var o=n[3],a=new Fo(o,o[6],o[3]);a.detach(a.indexOf(t))}}var s=this._adjustIndex(e);return function(t,e,n,r){var i=9+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-9?(e[4]=n[i],ue(n,9+r,e)):(n.push(e),e[4]=null),e[3]=n;var a=e[17];null!==a&&n!==a&&function(t,e){var n=t[5],r=e[3][3][16];16!=(16&r[2])&&e[16]!==r&&(t[2]|=1),null===n?t[5]=[e]:n.push(e)}(a,e);var s=e[5];null!==s&&s.insertView(t),e[2]|=128}(r,n,this._lContainer,s),vo(r,n,!0,To(s,this._lContainer)),t.attachToViewContainerRef(this),ue(this._lContainer[8],s,t),t}},{key:"move",value:function(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}},{key:"indexOf",value:function(t){var e=this._lContainer[8];return null!==e?e.indexOf(t):-1}},{key:"remove",value:function(t){this.allocateContainerIfNeeded();var e=this._adjustIndex(t,-1);(function(t,e){var n=go(t,e);n&&yo(n[1],n)})(this._lContainer,e),ce(this._lContainer[8],e)}},{key:"detach",value:function(t){this.allocateContainerIfNeeded();var e=this._adjustIndex(t,-1),n=go(this._lContainer,e);return n&&null!=ce(this._lContainer[8],e)?new Lo(n):null}},{key:"_adjustIndex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==t?this.length+e:t}},{key:"allocateContainerIfNeeded",value:function(){null===this._lContainer[8]&&(this._lContainer[8]=[])}},{key:"element",get:function(){return jo(e,this._hostTNode,this._hostView)}},{key:"injector",get:function(){return new cr(this._hostTNode,this._hostView)}},{key:"parentInjector",get:function(){var t=tr(this._hostTNode,this._hostView),e=zn(t,this._hostView),n=function(t,e,n){if(n.parent&&-1!==n.parent.injectorIndex){for(var r=n.parent.injectorIndex,i=n.parent;null!=i.parent&&r==i.parent.injectorIndex;)i=i.parent;return i}for(var o=Un(t),a=e,s=e[6];o>1;)s=(a=a[15])[6],o--;return s}(t,this._hostView,this._hostTNode);return jn(t)&&null!=n?new cr(n,e):new cr(null,this._hostView)}},{key:"length",get:function(){return this._lContainer.length-9}}]),r}(t));var o=r[n.index];if(Re(o))(function(t,e){t[2]=-2})(i=o);else{var a;if(4===n.type)a=je(o);else if(a=r[11].createComment(""),Me(r)){var s=r[11],u=Ue(n,r);xo(s,Eo(s,u),a,function(t,e){return Le(t)?t.nextSibling(e):e.nextSibling}(s,u))}else Io(r[1],r,a,n);r[n.index]=i=$i(o,r,a,n),Zi(r,i)}return new Fo(i,n,r)}function zo(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e,n){if(!n&&Ne(t)){var r=qe(t.index,e);return new Lo(r,r)}return 3===t.type||0===t.type||4===t.type||5===t.type?new Lo(e[16],e):null}(en(),Je(),t)}var Wo=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return qo()},t}(),qo=zo,Ho=new Ht("Set Injector scope."),Go={},Ko={},Xo=[],$o=void 0;function Yo(){return void 0===$o&&($o=new ie),$o}function Qo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Jo(t,n,e||Yo(),r)}var Jo=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,t),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var a=[];n&&se(n,(function(t){return i.processProvider(t,e,n)})),se([e],(function(t){return i.processInjectorType(t,[],a)})),this.records.set(Gt,ea(void 0,this));var s=this.records.get(Ho);this.scope=null!=s?s.value:null,this.source=o||("object"==typeof e?null:St(e))}return _createClass(t,[{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(t){return t.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dt.Default;this.assertNotDestroyed();var r,i=Qt(this);try{if(!(n&dt.SkipSelf)){var o=this.records.get(t);if(void 0===o){var a=("function"==typeof(r=t)||"object"==typeof r&&r instanceof Ht)&&yt(t);o=a&&this.injectableDefInScope(a)?ea(Zo(t),Go):null,this.records.set(t,o)}if(null!=o)return this.hydrate(t,o)}return(n&dt.Self?Yo():this.parent).get(t,e=n&dt.Optional&&e===Kt?null:e)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(St(t)),i)throw s;return function(t,e,n,r){var i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;var i=St(e);if(Array.isArray(e))i=e.map(St).join(" -> ");else if("object"==typeof e){var o=[];for(var a in e)if(e.hasOwnProperty(a)){var s=e[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):St(s)))}i="{".concat(o.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(t.replace(Xt,"\n  "))}("\n"+t.message,i,"R3InjectorError",r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(s,t,0,this.source)}throw s}finally{Qt(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var t=this;this.injectorDefTypes.forEach((function(e){return t.get(e)}))}},{key:"toString",value:function(){var t=[];return this.records.forEach((function(e,n){return t.push(St(n))})),"R3Injector[".concat(t.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(t,e,n){var r=this;if(!(t=Rt(t)))return!1;var i=_t(t),o=null==i&&t.ngModule||void 0,a=void 0===o?t:o,s=-1!==n.indexOf(a);if(void 0!==o&&(i=_t(o)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(a);try{se(i.imports,(function(t){r.processInjectorType(t,e,n)&&(void 0===u&&(u=[]),u.push(t))}))}finally{}if(void 0!==u)for(var c=function(t){var e=u[t],n=e.ngModule,i=e.providers;se(i,(function(t){return r.processProvider(t,n,i||Xo)}))},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(a),this.records.set(a,ea(i.factory,Go));var h=i.providers;if(null!=h&&!s){var f=t;se(h,(function(t){return r.processProvider(t,f,h)}))}return void 0!==o&&void 0!==t.providers}},{key:"processProvider",value:function(t,e,n){var r=ra(t=Rt(t))?t:Rt(t&&t.provide),i=function(t,e,n){return na(t)?ea(void 0,t.useValue):ea(ta(t,e,n),Go)}(t,e,n);if(ra(t)||!0!==t.multi){var o=this.records.get(r);o&&void 0!==o.multi&&ti()}else{var a=this.records.get(r);a?void 0===a.multi&&ti():((a=ea(void 0,Go,!0)).factory=function(){return re(a.multi)},this.records.set(r,a)),r=t,a.multi.push(t)}this.records.set(r,i)}},{key:"hydrate",value:function(t,e){var n;return e.value===Ko?function(t){throw new Error("Cannot instantiate cyclic dependency! ".concat(t))}(St(t)):e.value===Go&&(e.value=Ko,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}},{key:"injectableDefInScope",value:function(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}},{key:"destroyed",get:function(){return this._destroyed}}]),t}();function Zo(t){var e=yt(t),n=null!==e?e.factory:Ie(t);if(null!==n)return n;var r=_t(t);if(null!==r)return r.factory;if(t instanceof Ht)throw new Error("Token ".concat(St(t)," is missing a \u0275prov definition."));if(t instanceof Function)return function(t){var e=t.length;if(e>0){var n=le(e,"?");throw new Error("Can't resolve all parameters for ".concat(St(t),": (").concat(n.join(", "),")."))}var r=function(t){var e=t&&(t[wt]||t[kt]||t[Ct]&&t[Ct]());if(e){var n=function(t){if(t.hasOwnProperty("name"))return t.name;var e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in v10. Please add @Injectable() to the "'.concat(n,'" class.')),e}return null}(t);return null!==r?function(){return r.factory(t)}:function(){return new t}}(t);throw new Error("unreachable")}function ta(t,e,n){var r,i=void 0;if(ra(t)){var o=Rt(t);return Ie(o)||Zo(o)}if(na(t))i=function(){return Rt(t.useValue)};else if((r=t)&&r.useFactory)i=function(){return t.useFactory.apply(t,_toConsumableArray(re(t.deps||[])))};else if(function(t){return!(!t||!t.useExisting)}(t))i=function(){return te(Rt(t.useExisting))};else{var a=Rt(t&&(t.useClass||t.provide));if(a||function(t,e,n){var r="";throw t&&e&&(r=" - only instances of Provider and Type are allowed, got: [".concat(e.map((function(t){return t==n?"?"+n+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(St(t),"'")+r)}(e,n,t),!function(t){return!!t.deps}(t))return Ie(a)||Zo(a);i=function(){return _construct(a,_toConsumableArray(re(t.deps)))}}return i}function ea(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:t,value:e,multi:n?[]:void 0}}function na(t){return null!==t&&"object"==typeof t&&$t in t}function ra(t){return"function"==typeof t}var ia=function(t,e,n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=Qo(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)},oa=function(){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"create",value:function(t,e){return Array.isArray(t)?ia(t,e,""):ia(t.providers,t.parent,t.name||"")}}]),t}();return t.THROW_IF_NOT_FOUND=Kt,t.NULL=new ie,t.\u0275prov=mt({token:t,providedIn:"any",factory:function(){return te(Gt)}}),t.__NG_ELEMENT_ID__=-1,t}(),aa=new Ht("AnalyzeForEntryComponents"),sa=new Map,ua=new Set;function ca(t){return"string"==typeof t?t:t.text()}function la(t,e){for(var n=t.styles,r=t.classes,i=0,o=0;o<e.length;o++){var a=e[o];"number"==typeof a?i=a:1==i?r=It(r,a):2==i&&(n=It(n,a+": "+e[++o]+";"))}null!==n&&(t.styles=n),null!==r&&(t.classes=r)}var ha=null;function fa(){if(!ha){var t=Lt.Symbol;if(t&&t.iterator)ha=t.iterator;else for(var e=Object.getOwnPropertyNames(Map.prototype),n=0;n<e.length;++n){var r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(ha=r)}}return ha}function da(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}var pa=function(){function t(e){_classCallCheck(this,t),this.wrapped=e}return _createClass(t,null,[{key:"wrap",value:function(e){return new t(e)}},{key:"unwrap",value:function(e){return t.isWrapped(e)?e.wrapped:e}},{key:"isWrapped",value:function(e){return e instanceof t}}]),t}();function va(t){return!!ma(t)&&(Array.isArray(t)||!(t instanceof Map)&&fa()in t)}function ma(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ga(t,e,n){return t[e]=n}function ya(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function ba(t,e,n,r){var i=Je();return ya(i,ln(),e)&&(Ze(),function(t,e,n,r,i,o){var a=Ue(t,e),s=e[11];if(null==r)Le(s)?s.removeAttribute(a,n,o):a.removeAttribute(n);else{var u=null==i?Wn(r):i(r,t.tagName||"",n);Le(s)?s.setAttribute(a,n,u,o):o?a.setAttributeNS(o,n,u):a.setAttribute(n,u)}}(kn(),i,t,e,n,r)),ba}function _a(t,e,n,r){return ya(t,ln(),n)?e+Wn(n)+r:hi}function wa(t,e,n,r,i,o,a,s){var u=Je(),c=Ze(),l=t+19,h=c.firstCreatePass?function(t,e,n,r,i,o,a,s,u){var c=e.consts,l=ki(e,n[6],t,0,a||null,Xe(c,s));Li(e,n,l,Xe(c,u)),In(e,l);var h=l.tViews=Di(2,-1,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c),f=Pi(0,null,2,-1,null,null);return f.injectorIndex=l.injectorIndex,h.node=f,null!==e.queries&&(e.queries.template(e,l),h.queries=e.queries.embeddedTView(l)),l}(t,c,u,e,n,r,i,o,a):c.data[l];nn(h,!1);var f=u[11].createComment("");Io(c,u,f,h),Jr(f,u),Zi(u,u[l]=$i(f,u,f,h)),De(h)&&Ri(c,u,h),null!=a&&Oi(u,h,s)}function xa(t){return We(Ye.lFrame.contextLView,t)}function Ca(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt.Default,n=Je();return null==n?te(t,e):nr(en(),n,Rt(t),e)}function ka(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;var n=t.attrs;if(n)for(var r=n.length,i=0;i<r;){var o=n[i];if(Mn(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(o===e)return n[i+1];i+=2}}return null}(en(),t)}function Ea(){throw new Error("invalid")}function Sa(t,e,n){var r=Je();return ya(r,ln(),e)&&Fi(Ze(),kn(),r,t,e,r[11],n,!1),Sa}function Ia(t,e,n,r,i){var o=i?"class":"style";co(t,n,e.inputs[o],o,r)}function Ta(t,e,n,r){var i=Je(),o=Ze(),a=19+t,s=i[11],u=i[a]=xi(e,s,Ye.lFrame.currentNamespace),c=o.firstCreatePass?function(t,e,n,r,i,o,a){var s=e.consts,u=Xe(s,o),c=ki(e,n[6],t,3,i,u);return Li(e,n,c,Xe(s,a)),null!==c.mergedAttrs&&la(c,c.mergedAttrs),null!==e.queries&&e.queries.elementStart(e,c),c}(t,o,i,0,e,n,r):o.data[a];nn(c,!0);var l=c.mergedAttrs;null!==l&&Pn(s,u,l);var h=c.classes;null!==h&&Do(s,u,h);var f=c.styles;null!==f&&No(s,u,f),Io(o,i,u,c),0===Ye.lFrame.elementDepthCount&&Jr(u,i),Ye.lFrame.elementDepthCount++,De(c)&&(Ri(o,i,c),Ai(o,c,i)),null!==r&&Oi(i,c)}function Aa(){var t=en();rn()?on():nn(t=t.parent,!1);var e=t;Ye.lFrame.elementDepthCount--;var n=Ze();n.firstCreatePass&&(In(n,t),Oe(t)&&n.queries.elementEnd(t)),null!==e.classes&&function(t){return 0!=(16&t.flags)}(e)&&Ia(n,e,Je(),e.classes,!0),null!==e.styles&&function(t){return 0!=(32&t.flags)}(e)&&Ia(n,e,Je(),e.styles,!1)}function Ra(t,e,n,r){Ta(t,e,n,r),Aa()}function Oa(t,e,n){var r=Je(),i=Ze(),o=t+19,a=i.firstCreatePass?function(t,e,n,r,i){var o=e.consts,a=Xe(o,r),s=ki(e,n[6],t,4,"ng-container",a);return null!==a&&la(s,a),Li(e,n,s,Xe(o,i)),null!==e.queries&&e.queries.elementStart(e,s),s}(t,i,r,e,n):i.data[o];nn(a,!0);var s=r[o]=r[11].createComment("");Io(i,r,s,a),Jr(s,r),De(a)&&(Ri(i,r,a),Ai(i,a,r)),null!=n&&Oi(r,a)}function Na(){var t=en(),e=Ze();rn()?on():nn(t=t.parent,!1),e.firstCreatePass&&(In(e,t),Oe(t)&&e.queries.elementEnd(t))}function Da(t,e,n){Oa(t,e,n),Na()}function Pa(){return Je()}function Ma(t){return!!t&&"function"==typeof t.then}function Fa(t){return!!t&&"function"==typeof t.subscribe}function La(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=Je(),o=Ze(),a=en();return ja(o,i,i[11],a,t,e,n,r),La}function Ba(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=en(),o=Je(),a=so(i,o);return ja(Ze(),o,a,i,t,e,n,r),Ba}function ja(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,u=De(r),c=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),l=oo(e),h=!0;if(3===r.type){var f=Ue(r,e),d=s?s(f):me,p=d.target||f,v=l.length,m=s?function(t){return s(je(t[r.index])).target}:r.index;if(Le(n)){var g=null;if(!s&&u&&(g=function(t,e,n,r){var i=t.cleanup;if(null!=i)for(var o=0;o<i.length-1;o+=2){var a=i[o];if(a===n&&i[o+1]===r){var s=e[7],u=i[o+2];return s.length>u?s[u]:null}"string"==typeof a&&(o+=2)}return null}(t,e,i,r.index)),null!==g)(g.__ngLastListenerFn__||g).__ngNextListenerFn__=o,g.__ngLastListenerFn__=o,h=!1;else{o=Ua(r,e,o,!1);var y=n.listen(d.name||p,i,o);l.push(o,y),c&&c.push(i,m,v,v+1)}}else o=Ua(r,e,o,!0),p.addEventListener(i,o,a),l.push(o),c&&c.push(i,m,v,a)}var b,_=r.outputs;if(h&&null!==_&&(b=_[i])){var w=b.length;if(w)for(var x=0;x<w;x+=2){var C=e[b[x]][b[x+1]].subscribe(o),k=l.length;l.push(o,C),c&&c.push(i,r.index,k,-(k+1))}}}function Va(t,e,n){try{return!1!==e(n)}catch(r){return uo(t,r),!1}}function Ua(t,e,n,r){return function i(o){if(o===Function)return n;var a=2&t.flags?qe(t.index,e):e;0==(32&e[2])&&to(a);for(var s=Va(e,n,o),u=i.__ngNextListenerFn__;u;)s=Va(e,u,o)&&s,u=u.__ngNextListenerFn__;return r&&!1===s&&(o.preventDefault(),o.returnValue=!1),s}}function za(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t){return(Ye.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ye.lFrame.contextLView))[8]}(t)}function Wa(t,e){for(var n=null,r=function(t){var e=t.attrs;if(null!=e){var n=e.indexOf(5);if(0==(1&n))return e[n+1]}return null}(t),i=0;i<e.length;i++){var o=e[i];if("*"!==o){if(null===r?si(t,o,!0):ui(r,o))return i}else n=i}return n}function qa(t){var e=Je()[16][6];if(!e.projection)for(var n=e.projection=le(t?t.length:1,null),r=n.slice(),i=e.child;null!==i;){var o=t?Wa(i,t):0;null!==o&&(r[o]?r[o].projectionNext=i:n[o]=i,r[o]=i),i=i.next}}function Ha(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Je(),i=Ze(),o=ki(i,r[6],t,1,null,n||null);null===o.projection&&(o.projection=e),on(),function(t,e,n){Oo(e[11],0,e,n,wo(t,n,e),So(n.parent||e[6],e))}(i,r,o)}function Ga(t,e,n){return Ka(t,"",e,"",n),Ga}function Ka(t,e,n,r,i){var o=Je(),a=_a(o,e,n,r);return a!==hi&&Fi(Ze(),kn(),o,t,a,o[11],i,!1),Ka}var Xa=[];function $a(t,e,n,r,i){for(var o=t[n+1],a=null===e,s=r?mi(o):yi(o),u=!1;0!==s&&(!1===u||a);){var c=t[s+1];Ya(t[s],e)&&(u=!0,t[s+1]=r?_i(c):gi(c)),s=r?mi(c):yi(c)}u&&(t[n+1]=r?gi(o):_i(o))}function Ya(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&de(t,e)>=0}var Qa={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Ja(t){return t.substring(Qa.key,Qa.keyEnd)}function Za(t,e){var n=Qa.textEnd;return n===e?-1:(e=Qa.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,Qa.key=e,n),ts(t,e,n))}function ts(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function es(t,e,n){return is(t,e,n,!1),es}function ns(t,e){return is(t,e,null,!0),ns}function rs(t,e){for(var n=function(t){return function(t){Qa.key=0,Qa.keyEnd=0,Qa.value=0,Qa.valueEnd=0,Qa.textEnd=t.length}(t),Za(t,ts(t,0,Qa.textEnd))}(e);n>=0;n=Za(e,n))he(t,Ja(e),!0)}function is(t,e,n,r){var i,o,a=Je(),s=Ze(),u=hn(2);(s.firstUpdatePass&&ss(s,t,u,r),e!==hi&&ya(a,u,e))&&(null==n&&(i=null===(o=Ye.lFrame)?null:o.currentSanitizer)&&(n=i),ls(s,s.data[xn()+19],a,a[11],t,a[u+1]=function(t,e){return null==t||("function"==typeof e?t=e(t):"string"==typeof e?t+=e:"object"==typeof t&&(t=St(wr(t)))),t}(e,n),r,u))}function os(t,e,n,r){var i=Ze(),o=hn(2);i.firstUpdatePass&&ss(i,null,o,r);var a=Je();if(n!==hi&&ya(a,o,n)){var s=i.data[xn()+19];if(ds(s,r)&&!as(i,o)){var u=r?s.classes:s.styles;null!==u&&(n=It(u,n||"")),Ia(i,s,a,n,r)}else!function(t,e,n,r,i,o,a,s){i===hi&&(i=Xa);for(var u=0,c=0,l=0<i.length?i[0]:null,h=0<o.length?o[0]:null;null!==l||null!==h;){var f=u<i.length?i[u+1]:void 0,d=c<o.length?o[c+1]:void 0,p=null,v=void 0;l===h?(u+=2,c+=2,f!==d&&(p=h,v=d)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,v=d),null!==p&&ls(t,e,n,r,p,v,a,s),l=u<i.length?i[u]:null,h=c<o.length?o[c]:null}}(i,s,a,a[11],a[o+1],a[o+1]=function(t,e,n){if(null==n||""===n)return Xa;var r=[],i=wr(n);if(Array.isArray(i))for(var o=0;o<i.length;o++)t(r,i[o],!0);else if("object"==typeof i)for(var a in i)i.hasOwnProperty(a)&&t(r,a,i[a]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,o)}}function as(t,e){return e>=t.expandoStartIndex}function ss(t,e,n,r){var i=t.data;if(null===i[n+1]){var o=i[xn()+19],a=as(t,n);ds(o,r)&&null===e&&!a&&(e=!1),e=function(t,e,n,r){var i=function(t){var e=Ye.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t),o=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=cs(n=us(null,t,e,n,r),e.attrs,r),o=null);else{var a=e.directiveStylingLast;if(-1===a||t[a]!==i)if(n=us(i,t,e,n,r),null===o){var s=function(t,e,n){var r=n?e.classBindings:e.styleBindings;if(0!==yi(r))return t[mi(r)]}(t,e,r);void 0!==s&&Array.isArray(s)&&function(t,e,n,r){t[mi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,s=cs(s=us(null,t,e,s[1],r),e.attrs,r))}else o=function(t,e,n){for(var r=void 0,i=e.directiveEnd,o=1+e.directiveStylingLast;o<i;o++)r=cs(r,t[o].hostAttrs,n);return cs(r,e.attrs,n)}(t,e,r)}return void 0!==o&&(r?e.residualClasses=o:e.residualStyles=o),n}(i,o,e,r),function(t,e,n,r,i,o){var a=o?e.classBindings:e.styleBindings,s=mi(a),u=yi(a);t[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||de(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=mi(t[s+1]);t[r+1]=vi(f,s),0!==f&&(t[f+1]=bi(t[f+1],r)),t[s+1]=131071&t[s+1]|r<<17}else t[r+1]=vi(s,0),0!==s&&(t[s+1]=bi(t[s+1],r)),s=r;else t[r+1]=vi(u,0),0===s?s=r:t[u+1]=bi(t[u+1],r),u=r;l&&(t[r+1]=gi(t[r+1])),$a(t,c,r,!0),$a(t,c,r,!1),function(t,e,n,r,i){var o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof e&&de(o,e)>=0&&(n[r+1]=_i(n[r+1]))}(e,c,t,r,o),a=vi(s,u),o?e.classBindings=a:e.styleBindings=a}(i,o,e,n,a,r)}}function us(t,e,n,r,i){var o=null,a=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<a&&(r=cs(r,(o=e[s]).hostAttrs,i),o!==t);)s++;return null!==t&&(n.directiveStylingLast=s),r}function cs(t,e,n){var r=n?1:2,i=-1;if(null!==e)for(var o=0;o<e.length;o++){var a=e[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),he(t,a,!!n||e[++o]))}return void 0===t?null:t}function ls(t,e,n,r,i,o,a,s){if(3===e.type){var u=t.data,c=u[s+1];fs(1==(1&c)?hs(u,e,n,i,yi(c),a):void 0)||(fs(o)||2==(2&c)&&(o=hs(u,null,n,i,s,a)),function(t,e,n,r,i){var o=Le(t);if(e)i?o?t.addClass(n,r):n.classList.add(r):o?t.removeClass(n,r):n.classList.remove(r);else{var a=-1==r.indexOf("-")?void 0:2;null==i?o?t.removeStyle(n,r,a):n.style.removeProperty(r):o?t.setStyle(n,r,i,a):n.style.setProperty(r,i)}}(r,a,Ve(xn(),n),i,o))}}function hs(t,e,n,r,i,o){for(var a=null===e,s=void 0;i>0;){var u=t[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===hi&&(f=h?Xa:void 0);var d=h?fe(f,r):l===r?f:void 0;if(c&&!fs(d)&&(d=fe(u,r)),fs(d)&&(s=d,a))return s;var p=t[i+1];i=a?mi(p):yi(p)}if(null!==e){var v=o?e.residualClasses:e.residualStyles;null!=v&&(s=fe(v,r))}return s}function fs(t){return void 0!==t}function ds(t,e){return 0!=(t.flags&(e?16:32))}function ps(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Je(),r=Ze(),i=t+19,o=r.firstCreatePass?ki(r,n[6],t,3,null,null):r.data[i],a=n[i]=function(t,e){return Le(e)?e.createText(t):e.createTextNode(t)}(e,n[11]);Io(r,n,a,o),nn(o,!1)}function vs(t){return ms("",t,""),vs}function ms(t,e,n){var r=Je(),i=_a(r,t,e,n);return i!==hi&&lo(r,xn(),i),ms}function gs(t,e,n,r,i){var o=Je(),a=function(t,e,n,r,i,o){var a=function(t,e,n,r){var i=ya(t,e,n);return ya(t,e+1,r)||i}(t,cn(),n,i);return hn(2),a?e+Wn(n)+r+Wn(i)+o:hi}(o,t,e,n,r,i);return a!==hi&&lo(o,xn(),a),gs}function ys(t,e,n){var r=Je();return ya(r,ln(),e)&&Fi(Ze(),kn(),r,t,e,r[11],n,!0),ys}function bs(t,e,n){var r=Je();if(ya(r,ln(),e)){var i=Ze(),o=kn();Fi(i,o,r,t,e,so(o,r),n,!0)}return bs}function _s(t,e){var n=He(t)[1],r=n.data.length-1;In(n,{directiveStart:r,directiveEnd:r+1})}function ws(t){for(var e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0,r=[t];e;){var i=void 0;if(Pe(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);var o=t;o.inputs=xs(t.inputs),o.declaredInputs=xs(t.declaredInputs),o.outputs=xs(t.outputs);var a=i.hostBindings;a&&Es(t,a);var s=i.viewQuery,u=i.contentQueries;if(s&&Cs(t,s),u&&ks(t,u),vt(t.inputs,i.inputs),vt(t.declaredInputs,i.declaredInputs),vt(t.outputs,i.outputs),Pe(i)&&i.data.animation){var c=t.data;c.animation=(c.animation||[]).concat(i.data.animation)}o.afterContentChecked=o.afterContentChecked||i.afterContentChecked,o.afterContentInit=t.afterContentInit||i.afterContentInit,o.afterViewChecked=t.afterViewChecked||i.afterViewChecked,o.afterViewInit=t.afterViewInit||i.afterViewInit,o.doCheck=t.doCheck||i.doCheck,o.onDestroy=t.onDestroy||i.onDestroy,o.onInit=t.onInit||i.onInit}var l=i.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(t),f===ws&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){for(var e=0,n=null,r=t.length-1;r>=0;r--){var i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Ln(i.hostAttrs,n=Ln(n,i.hostAttrs))}}(r)}function xs(t){return t===me?{}:t===ge?[]:t}function Cs(t,e){var n=t.viewQuery;t.viewQuery=n?function(t,r){e(t,r),n(t,r)}:e}function ks(t,e){var n=t.contentQueries;t.contentQueries=n?function(t,r,i){e(t,r,i),n(t,r,i)}:e}function Es(t,e){var n=t.hostBindings;t.hostBindings=n?function(t,r){e(t,r),n(t,r)}:e}var Ss=function(){function t(e,n,r){_classCallCheck(this,t),this.previousValue=e,this.currentValue=n,this.firstChange=r}return _createClass(t,[{key:"isFirstChange",value:function(){return this.firstChange}}]),t}();function Is(t){t.type.prototype.ngOnChanges&&(t.setInput=Ts,t.onChanges=function(){var t=As(this),e=t&&t.current;if(e){var n=t.previous;if(n===me)t.previous=e;else for(var r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}})}function Ts(t,e,n,r){var i=As(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:me,current:null}),o=i.current||(i.current={}),a=i.previous,s=this.declaredInputs[n],u=a[s];o[s]=new Ss(u&&u.currentValue,e,a===me),t[r]=e}function As(t){return t.__ngSimpleChanges__||null}function Rs(t,e,n,r,i){if(t=Rt(t),Array.isArray(t))for(var o=0;o<t.length;o++)Rs(t[o],e,n,r,i);else{var a=Ze(),s=Je(),u=ra(t)?t:Rt(t.provide),c=ta(t),l=en(),h=65535&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>16;if(ra(t)||!t.multi){var p=new Dn(c,i,Ca),v=Ds(u,e,i?h:h+d,f);-1===v?(er(Qn(l,s),a,u),Os(a,t,e.length),e.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=65536),n.push(p),s.push(p)):(n[v]=p,s[v]=p)}else{var m=Ds(u,e,h+d,f),g=Ds(u,e,h,h+d),y=m>=0&&n[m],b=g>=0&&n[g];if(i&&!b||!i&&!y){er(Qn(l,s),a,u);var _=function(t,e,n,r,i){var o=new Dn(t,n,Ca);return o.multi=[],o.index=e,o.componentProviders=0,Ns(o,i,r&&!n),o}(i?Ms:Ps,n.length,i,r,c);!i&&b&&(n[g].providerFactory=_),Os(a,t,e.length),e.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=65536),n.push(_),s.push(_)}else Os(a,t,m>-1?m:g),Ns(n[i?g:m],c,!i&&r);!i&&r&&b&&n[g].componentProviders++}}}function Os(t,e,n){if(ra(e)||e.useClass){var r=(e.useClass||e).prototype.ngOnDestroy;r&&(t.destroyHooks||(t.destroyHooks=[])).push(n,r)}}function Ns(t,e,n){t.multi.push(e),n&&t.componentProviders++}function Ds(t,e,n,r){for(var i=n;i<r;i++)if(e[i]===t)return i;return-1}function Ps(t,e,n,r){return Fs(this.multi,[])}function Ms(t,e,n,r){var i,o=this.multi;if(this.providerFactory){var a=this.providerFactory.componentProviders,s=ar(n,n[1],this.providerFactory.index,r);Fs(o,i=s.slice(0,a));for(var u=a;u<s.length;u++)i.push(s[u])}else Fs(o,i=[]);return i}function Fs(t,e){for(var n=0;n<t.length;n++)e.push((0,t[n])());return e}function Ls(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(t,e,n){var r=Ze();if(r.firstCreatePass){var i=Pe(t);Rs(n,r.data,r.blueprint,i,!0),Rs(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}}Is.ngInherit=!0;var Bs=function t(){_classCallCheck(this,t)},js=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"resolveComponentFactory",value:function(t){throw function(t){var e=Error("No component factory found for ".concat(St(t),". Did you add it to @NgModule.entryComponents?"));return e.ngComponent=t,e}(t)}}]),t}(),Vs=function(){var t=function t(){_classCallCheck(this,t)};return t.NULL=new js,t}(),Us=function(){var t=function t(e){_classCallCheck(this,t),this.nativeElement=e};return t.__NG_ELEMENT_ID__=function(){return zs(t)},t}(),zs=function(t){return jo(t,en(),Je())},Ws=function t(){_classCallCheck(this,t)},qs=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}(),Hs=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return Gs()},t}(),Gs=function(){var t=Je(),e=qe(en().index,t);return function(t){var e=t[11];if(Le(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Ae(e)?e:t)},Ks=function(){var t=function t(){_classCallCheck(this,t)};return t.\u0275prov=mt({token:t,providedIn:"root",factory:function(){return null}}),t}(),Xs=function t(e){_classCallCheck(this,t),this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")},$s=new Xs("9.0.7"),Ys=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"supports",value:function(t){return va(t)}},{key:"create",value:function(t){return new Js(t)}}]),t}(),Qs=function(t,e){return e},Js=function(){function t(e){_classCallCheck(this,t),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Qs}return _createClass(t,[{key:"forEachItem",value:function(t){var e;for(e=this._itHead;null!==e;e=e._next)t(e)}},{key:"forEachOperation",value:function(t){for(var e=this._itHead,n=this._removalsHead,r=0,i=null;e||n;){var o=!n||e&&e.currentIndex<nu(n,r,i)?e:n,a=nu(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);var u=a-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[o.previousIndex]=c-u}}a!==s&&t(o,a,s)}}},{key:"forEachPreviousItem",value:function(t){var e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}},{key:"forEachAddedItem",value:function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}},{key:"forEachMovedItem",value:function(t){var e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}},{key:"forEachRemovedItem",value:function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}},{key:"forEachIdentityChange",value:function(t){var e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}},{key:"diff",value:function(t){if(null==t&&(t=[]),!va(t))throw new Error("Error trying to diff '".concat(St(t),"'. Only arrays and iterables are allowed"));return this.check(t)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(t){var e=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(t)){this.length=t.length;for(var s=0;s<this.length;s++)r=t[s],i=this._trackByFn(s,r),null!==o&&da(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),da(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e(t[n]);else for(var r,i=t[fa()]();!(r=i.next()).done;)e(r.value)}(t,(function(t){i=e._trackByFn(n,t),null!==o&&da(o.trackById,i)?(a&&(o=e._verifyReinsertion(o,t,i,n)),da(o.item,t)||e._addIdentityChange(o,t)):(o=e._mismatch(o,t,i,n),a=!0),o=o._next,n++})),this.length=n;return this._truncate(o),this.collection=t,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(t,e,n,r){var i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(da(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(da(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Zs(e,n),i,r),t}},{key:"_verifyReinsertion",value:function(t,e,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}},{key:"_truncate",value:function(t){for(;null!==t;){var e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);var r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}},{key:"_moveAfter",value:function(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}},{key:"_addAfter",value:function(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}},{key:"_insertAfter",value:function(t,e,n){var r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new eu),this._linkedRecords.put(t),t.currentIndex=n,t}},{key:"_remove",value:function(t){return this._addToRemovals(this._unlink(t))}},{key:"_unlink",value:function(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);var e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}},{key:"_addToMoves",value:function(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}},{key:"_addToRemovals",value:function(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new eu),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}},{key:"_addIdentityChange",value:function(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),t}(),Zs=function t(e,n){_classCallCheck(this,t),this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},tu=function(){function t(){_classCallCheck(this,t),this._head=null,this._tail=null}return _createClass(t,[{key:"add",value:function(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}},{key:"get",value:function(t,e){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&da(n.trackById,t))return n;return null}},{key:"remove",value:function(t){var e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}]),t}(),eu=function(){function t(){_classCallCheck(this,t),this.map=new Map}return _createClass(t,[{key:"put",value:function(t){var e=t.trackById,n=this.map.get(e);n||(n=new tu,this.map.set(e,n)),n.add(t)}},{key:"get",value:function(t,e){var n=this.map.get(t);return n?n.get(t,e):null}},{key:"remove",value:function(t){var e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),t}();function nu(t,e,n){var r=t.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+e+i}var ru=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"supports",value:function(t){return t instanceof Map||ma(t)}},{key:"create",value:function(){return new iu}}]),t}(),iu=function(){function t(){_classCallCheck(this,t),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(t,[{key:"forEachItem",value:function(t){var e;for(e=this._mapHead;null!==e;e=e._next)t(e)}},{key:"forEachPreviousItem",value:function(t){var e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}},{key:"forEachChangedItem",value:function(t){var e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}},{key:"forEachAddedItem",value:function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}},{key:"forEachRemovedItem",value:function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}},{key:"diff",value:function(t){if(t){if(!(t instanceof Map||ma(t)))throw new Error("Error trying to diff '".concat(St(t),"'. Only maps and objects are allowed"))}else t=new Map;return this.check(t)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(t){var e=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(function(t,r){if(n&&n.key===r)e._maybeAddToChanges(n,t),e._appendAfter=n,n=n._next;else{var i=e._getOrCreateRecordForKey(r,t);n=e._insertBeforeOrAppend(n,i)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(t,e){if(t){var n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}},{key:"_getOrCreateRecordForKey",value:function(t,e){if(this._records.has(t)){var n=this._records.get(t);this._maybeAddToChanges(n,e);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new ou(t);return this._records.set(t,o),o.currentValue=e,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(t,e){da(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}},{key:"_addToAdditions",value:function(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}},{key:"_addToChanges",value:function(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}},{key:"_forEach",value:function(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach((function(n){return e(t[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),t}(),ou=function t(e){_classCallCheck(this,t),this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},au=function(){var t=function(){function t(e){_classCallCheck(this,t),this.factories=e}return _createClass(t,[{key:"find",value:function(t){var e,n=this.factories.find((function(e){return e.supports(t)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(t,"' of type '").concat((e=t).name||typeof e,"'"))}}],[{key:"create",value:function(e,n){if(null!=n){var r=n.factories.slice();e=e.concat(r)}return new t(e)}},{key:"extend",value:function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ft,new lt]]}}}]),t}();return t.\u0275prov=mt({token:t,providedIn:"root",factory:function(){return new t([new Ys])}}),t}(),su=function(){var t=function(){function t(e){_classCallCheck(this,t),this.factories=e}return _createClass(t,[{key:"find",value:function(t){var e=this.factories.find((function(e){return e.supports(t)}));if(e)return e;throw new Error("Cannot find a differ supporting object '".concat(t,"'"))}}],[{key:"create",value:function(e,n){if(n){var r=n.factories.slice();e=e.concat(r)}return new t(e)}},{key:"extend",value:function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ft,new lt]]}}}]),t}();return t.\u0275prov=mt({token:t,providedIn:"root",factory:function(){return new t([new ru])}}),t}(),uu=[new ru],cu=new au([new Ys]),lu=new su(uu),hu=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return fu(t,Us)},t}(),fu=function(t,e){return Vo(t,e,en(),Je())},du=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return pu(t,Us)},t}(),pu=function(t,e){return Uo(t,e,en(),Je())},vu={},mu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).ngModule=t,r}return _createClass(n,[{key:"resolveComponentFactory",value:function(t){var e=Se(t);return new bu(e,this.ngModule)}}]),n}(Vs);function gu(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}var yu=new Ht("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Hn}}),bu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).componentDef=t,i.ngModule=r,i.componentType=t.type,i.selector=t.selectors.map(li).join(","),i.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],i.isBoundToModule=!!r,i}return _createClass(n,[{key:"create",value:function(t,e,n,r){var i,o,a=(r=r||this.ngModule)?function(t,e){return{get:function(n,r,i){var o=t.get(n,vu,i);return o!==vu||r===vu?o:e.get(n,r,i)}}}(t,r.injector):t,s=a.get(Ws,Be),u=a.get(Ks,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(t,e,n){if(Le(t))return t.selectRootElement(e,n===ve.ShadowDom);var r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(c,n,this.componentDef.encapsulation):xi(l,s.createRenderer(null,this.componentDef),function(t){var e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),p={components:[],scheduler:Hn,clean:io,playerHandler:null,flags:0},v=Di(0,-1,null,1,0,null,null,null,null,null),m=Ci(null,v,p,f,null,null,s,c,u,a);mn(m,null);try{var g=function(t,e,n,r,i,o){var a=n[1];n[19]=t;var s=ki(a,null,0,3,null,null),u=s.mergedAttrs=e.hostAttrs;null!==u&&(la(s,u),null!==t&&(Pn(i,t,u),null!==s.classes&&Do(i,t,s.classes),null!==s.styles&&No(i,t,s.styles)));var c=r.createRenderer(t,e),l=Ci(n,Ni(e),null,e.onPush?64:16,n[19],s,r,c,void 0);return a.firstCreatePass&&(er(Qn(s,n),a,e.type),zi(a,s),qi(s,n.length,1)),Zi(n,l),n[19]=l}(h,this.componentDef,m,s,c);if(h)if(n)Pn(c,h,["ng-version",$s.full]);else{var y=function(t){for(var e=[],n=[],r=1,i=2;r<t.length;){var o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!oi(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]),b=y.attrs,_=y.classes;b&&Pn(c,h,b),_&&_.length>0&&Do(c,h,_.join(" "))}o=ze(m[1],0),e&&(o.projection=e.map((function(t){return Array.from(t)}))),i=function(t,e,n,r,i){var o=n[1],a=function(t,e,n){var r=en();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Ui(t,r,1),Hi(t,e,n));var i=ar(e,t,e.length-1,r);Jr(i,e);var o=Ue(r,e);return o&&Jr(o,e),i}(o,n,e);r.components.push(a),t[8]=a,i&&i.forEach((function(t){return t(a,e)})),e.contentQueries&&e.contentQueries(1,a,n.length-1);var s=en();if(o.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){Cn(s.index-19);var u=n[1];Bi(u,e),ji(u,n,e.hostVars),Vi(e,a)}return a}(g,this.componentDef,m,p,[_s]),Ei(v,m,null)}finally{wn()}var w=new _u(this.componentType,i,jo(Us,o,m),m,o);return n&&!d||(w.hostView._tViewNode.child=o),w}},{key:"inputs",get:function(){return gu(this.componentDef.inputs)}},{key:"outputs",get:function(){return gu(this.componentDef.outputs)}}]),n}(Bs),_u=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s,u,c,l;return _classCallCheck(this,n),(s=e.call(this)).location=i,s._rootLView=o,s._tNode=a,s.destroyCbs=[],s.instance=r,s.hostView=s.changeDetectorRef=new Bo(o),s.hostView._tViewNode=(u=o[1],c=o,null==(l=u.node)&&(u.node=l=Pi(0,null,2,-1,null,null)),c[6]=l),s.componentType=t,s}return _createClass(n,[{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(t){return t()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(t){this.destroyCbs&&this.destroyCbs.push(t)}},{key:"injector",get:function(){return new cr(this._tNode,this._rootLView)}}]),n}(function(){return function t(){_classCallCheck(this,t)}}()),wu=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},function(t){var e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}],xu={};function Cu(t){return t in xu||(xu[t]=Lt.ng&&Lt.ng.common&&Lt.ng.common.locales&&Lt.ng.common.locales[t]),xu[t]}var ku=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencyCode]="CurrencyCode",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}();function Eu(t){var e;null==(e=t)&&function(t,e,n,r){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined")+" [Expected=> null != ".concat(e," <=Actual]"))}(0,e),"string"==typeof t&&t.toLowerCase().replace(/_/g,"-")}var Su=new Map,Iu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;_classCallCheck(this,n),(i=e.call(this))._parent=r,i._bootstrapComponents=[],i.injector=_assertThisInitialized(i),i.destroyCbs=[],i.componentFactoryResolver=new mu(_assertThisInitialized(i));var o=Te(t),a=t[zt]||null;return a&&Eu(a),i._bootstrapComponents=Kn(o.bootstrap),i._r3Injector=Qo(t,r,[{provide:oe,useValue:_assertThisInitialized(i)},{provide:Vs,useValue:i.componentFactoryResolver}],St(t)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(t),i}return _createClass(n,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oa.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dt.Default;return t===oa||t===oe||t===Gt?this:this._r3Injector.get(t,e,n)}},{key:"destroy",value:function(){var t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach((function(t){return t()})),this.destroyCbs=null}},{key:"onDestroy",value:function(t){this.destroyCbs.push(t)}}]),n}(oe),Tu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).moduleType=t,null!==Te(t)&&function t(e){if(null!==e.\u0275mod.id){var n=e.\u0275mod.id;(function(t,e,n){if(e&&e!==n)throw new Error("Duplicate module registered for ".concat(t," - ").concat(St(e)," vs ").concat(St(e.name)))})(n,Su.get(n),e),Su.set(n,e)}var r=e.\u0275mod.imports;r instanceof Function&&(r=r()),r&&r.forEach((function(e){return t(e)}))}(t),r}return _createClass(n,[{key:"create",value:function(t){return new Iu(this.moduleType,t)}}]),n}(ae);function Au(t,e,n){var r=un()+t,i=Je();return i[r]===hi?ga(i,r,n?e.call(n):e()):function(t,e){return t[e]}(i,r)}function Ru(t,e){var n,r=Ze(),i=t+19;r.firstCreatePass?(n=function(t,e){if(e)for(var n=e.length-1;n>=0;n--){var r=e[n];if(t===r.name)return r}throw new Error("The pipe '".concat(t,"' could not be found!"))}(e,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var o=n.factory||(n.factory=Ie(n.type)),a=Jt(Ca),s=o();return Jt(a),function(t,e,n,r){var i=n+19;i>=t.data.length&&(t.data[i]=null,t.blueprint[i]=null),e[i]=r}(r,Je(),t,s),s}function Ou(t,e,n){var r=Je(),i=We(r,t);return function(t,e){return pa.isWrapped(e)&&(e=pa.unwrap(e),t[cn()]=hi),e}(r,function(t,e){return t[1].data[e+19].pure}(r,t)?function(t,e,n,r,i,o){var a=e+n;return ya(t,a,i)?ga(t,a+1,o?r.call(o,i):r(i)):function(t,e){var n=t[e];return n===hi?void 0:n}(t,a+1)}(r,un(),e,i.transform,n,i):i.transform(n))}var Nu=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,n),(t=e.call(this)).__isAsync=r,t}return _createClass(n,[{key:"emit",value:function(t){_get(_getPrototypeOf(n.prototype),"next",this).call(this,t)}},{key:"subscribe",value:function(t,e,r){var i,o=function(t){return null},a=function(){return null};t&&"object"==typeof t?(i=this.__isAsync?function(e){setTimeout((function(){return t.next(e)}))}:function(e){t.next(e)},t.error&&(o=this.__isAsync?function(e){setTimeout((function(){return t.error(e)}))}:function(e){t.error(e)}),t.complete&&(a=this.__isAsync?function(){setTimeout((function(){return t.complete()}))}:function(){t.complete()})):(i=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)},e&&(o=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)}),r&&(a=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(n.prototype),"subscribe",this).call(this,i,o,a);return t instanceof v&&t.add(s),s}}]),n}(O);function Du(){return this._results[fa()]()}var Pu=function(){function t(){_classCallCheck(this,t),this.dirty=!0,this._results=[],this.changes=new Nu,this.length=0;var e=fa(),n=t.prototype;n[e]||(n[e]=Du)}return _createClass(t,[{key:"map",value:function(t){return this._results.map(t)}},{key:"filter",value:function(t){return this._results.filter(t)}},{key:"find",value:function(t){return this._results.find(t)}},{key:"reduce",value:function(t,e){return this._results.reduce(t,e)}},{key:"forEach",value:function(t){this._results.forEach(t)}},{key:"some",value:function(t){return this._results.some(t)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(t){this._results=function t(e,n){void 0===n&&(n=e);for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),t}(),Mu=function(){function t(e){_classCallCheck(this,t),this.queryList=e,this.matches=null}return _createClass(t,[{key:"clone",value:function(){return new t(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),t}(),Fu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,t),this.queries=e}return _createClass(t,[{key:"createEmbeddedView",value:function(e){var n=e.queries;if(null!==n){for(var r=null!==e.contentQueries?e.contentQueries[0]:n.length,i=[],o=0;o<r;o++){var a=n.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new t(i)}return null}},{key:"insertView",value:function(t){this.dirtyQueriesWithMatches(t)}},{key:"detachView",value:function(t){this.dirtyQueriesWithMatches(t)}},{key:"dirtyQueriesWithMatches",value:function(t){for(var e=0;e<this.queries.length;e++)null!==Zu(t,e).matches&&this.queries[e].setDirty()}}]),t}(),Lu=function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,t),this.predicate=e,this.descendants=n,this.isStatic=r,this.read=i},Bu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,t),this.queries=e}return _createClass(t,[{key:"elementStart",value:function(t,e){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}},{key:"elementEnd",value:function(t){for(var e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}},{key:"embeddedTView",value:function(e){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,null!==n?n.push(o):n=[o])}return null!==n?new t(n):null}},{key:"template",value:function(t,e){for(var n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}},{key:"getByIndex",value:function(t){return this.queries[t]}},{key:"track",value:function(t){this.queries.push(t)}},{key:"length",get:function(){return this.queries.length}}]),t}(),ju=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_classCallCheck(this,t),this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return _createClass(t,[{key:"elementStart",value:function(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}},{key:"elementEnd",value:function(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(t,e){this.elementStart(t,e)}},{key:"embeddedTView",value:function(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}},{key:"isApplyingToNode",value:function(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){for(var e=this._declarationNodeIndex,n=t.parent;null!==n&&4===n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(t,e){if(Array.isArray(this.metadata.predicate))for(var n=this.metadata.predicate,r=0;r<n.length;r++)this.matchTNodeWithReadOption(t,e,Vu(e,n[r]));else{var i=this.metadata.predicate;i===hu?0===e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,or(e,t,i,!1,!1))}}},{key:"matchTNodeWithReadOption",value:function(t,e,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===Us||r===du||r===hu&&0===e.type)this.addMatch(e.index,-2);else{var i=or(e,t,r,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,n)}}},{key:"addMatch",value:function(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}]),t}();function Vu(t,e){var n=t.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Uu(t,e,n,r){return-1===n?function(t,e){return 3===t.type||4===t.type?jo(Us,t,e):0===t.type?Vo(hu,Us,t,e):null}(e,t):-2===n?function(t,e,n){return n===Us?jo(Us,e,t):n===hu?Vo(hu,Us,e,t):n===du?Uo(du,Us,e,t):void 0}(t,e,r):ar(t,t[1],n,e)}function zu(t,e,n,r){var i=e[5].queries[r];if(null===i.matches){for(var o=t.data,a=n.matches,s=[],u=0;u<a.length;u+=2){var c=a[u];s.push(c<0?null:Uu(e,o[c],a[u+1],n.metadata.read))}i.matches=s}return i.matches}function Wu(t){var e=Je(),n=Ze(),r=dn();pn(r+1);var i=Zu(n,r);if(t.dirty&&Ge(e)===i.metadata.isStatic){if(null===i.matches)t.reset([]);else{var o=i.crossesNgTemplate?function t(e,n,r,i){var o=e.queries.getByIndex(r),a=o.matches;if(null!==a)for(var s=zu(e,n,o,r),u=0;u<a.length;u+=2){var c=a[u];if(c>0)i.push(s[u/2]);else{for(var l=a[u+1],h=n[-c],f=9;f<h.length;f++){var d=h[f];d[17]===d[3]&&t(d[1],d,l,i)}if(null!==h[5])for(var p=h[5],v=0;v<p.length;v++){var m=p[v];t(m[1],m,l,i)}}}return i}(n,e,r,[]):zu(n,e,i,r);t.reset(o),t.notifyOnChanges()}return!0}return!1}function qu(t,e,n){Gu(Ze(),Je(),t,e,n,!0)}function Hu(t,e,n){Gu(Ze(),Je(),t,e,n,!1)}function Gu(t,e,n,r,i,o){t.firstCreatePass&&(Ju(t,new Lu(n,r,o,i),-1),o&&(t.staticViewQueries=!0)),Qu(t,e)}function Ku(t,e,n,r){$u(Ze(),Je(),e,n,r,!1,en(),t)}function Xu(t,e,n,r){$u(Ze(),Je(),e,n,r,!0,en(),t)}function $u(t,e,n,r,i,o,a,s){t.firstCreatePass&&(Ju(t,new Lu(n,r,o,i),a.index),function(t,e){var n=t.contentQueries||(t.contentQueries=[]);e!==(t.contentQueries.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,s),o&&(t.staticContentQueries=!0)),Qu(t,e)}function Yu(){return t=Je(),e=dn(),t[5].queries[e].queryList;var t,e}function Qu(t,e){var n=new Pu;!function(t,e,n,r){var i=oo(e);i.push(n),t.firstCreatePass&&ao(t).push(r,i.length-1)}(t,e,n,n.destroy),null===e[5]&&(e[5]=new Fu),e[5].queries.push(new Mu(n))}function Ju(t,e,n){null===t.queries&&(t.queries=new Bu),t.queries.track(new ju(e,n))}function Zu(t,e){return t.queries.getByIndex(e)}var tc=new Ht("Application Initializer"),ec=function(){var t=function(){function t(e){var n=this;_classCallCheck(this,t),this.appInits=e,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(t,e){n.resolve=t,n.reject=e}))}return _createClass(t,[{key:"runInitializers",value:function(){var t=this;if(!this.initialized){var e=[],n=function(){t.done=!0,t.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();Ma(i)&&e.push(i)}Promise.all(e).then((function(){n()})).catch((function(e){t.reject(e)})),0===e.length&&n(),this.initialized=!0}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(te(tc,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}(),nc=new Ht("AppId"),rc={provide:nc,useFactory:function(){return"".concat(ic()).concat(ic()).concat(ic())},deps:[]};function ic(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var oc=new Ht("Platform Initializer"),ac=new Ht("Platform ID"),sc=new Ht("appBootstrapListener"),uc=function(){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"log",value:function(t){console.log(t)}},{key:"warn",value:function(t){console.warn(t)}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}(),cc=new Ht("LocaleId"),lc=new Ht("DefaultCurrencyCode"),hc=function t(e,n){_classCallCheck(this,t),this.ngModuleFactory=e,this.componentFactories=n},fc=function(t){return new Tu(t)},dc=fc,pc=function(t){return Promise.resolve(fc(t))},vc=function(t){var e=fc(t),n=Kn(Te(t).declarations).reduce((function(t,e){var n=Se(e);return n&&t.push(new bu(n)),t}),[]);return new hc(e,n)},mc=vc,gc=function(t){return Promise.resolve(vc(t))},yc=function(){var t=function(){function t(){_classCallCheck(this,t),this.compileModuleSync=dc,this.compileModuleAsync=pc,this.compileModuleAndAllComponentsSync=mc,this.compileModuleAndAllComponentsAsync=gc}return _createClass(t,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(t){}},{key:"getModuleId",value:function(t){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}(),bc=new Ht("compilerOptions"),_c=Promise.resolve(0);function wc(t){"undefined"==typeof Zone?_c.then((function(){t&&t.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}var xc=function(){function t(e){var n,r,i=e.enableLongStackTrace,o=void 0!==i&&i,a=e.shouldCoalesceEventChangeDetection,s=void 0!==a&&a;if(_classCallCheck(this,t),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Nu(!1),this.onMicrotaskEmpty=new Nu(!1),this.onStable=new Nu(!1),this.onError=new Nu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=s,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var t=Lt.requestAnimationFrame,e=Lt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){var n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);var r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,r=!!(n=this).shouldCoalesceEventChangeDetection&&n.nativeRequestAnimationFrame&&function(){!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Lt,(function(){t.lastRequestAnimationFrameId=-1,Sc(t),Ec(t)})),Sc(t))}(n)},n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:r},onInvokeTask:function(t,e,i,o,a,s){try{return Ic(n),t.invokeTask(i,o,a,s)}finally{r&&"eventTask"===o.type&&r(),Tc(n)}},onInvoke:function(t,e,r,i,o,a,s){try{return Ic(n),t.invoke(r,i,o,a,s)}finally{Tc(n)}},onHasTask:function(t,e,r,i){t.hasTask(r,i),e===r&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,Sc(n),Ec(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,e,r,i){return t.handleError(r,i),n.runOutsideAngular((function(){return n.onError.emit(i)})),!1}})}return _createClass(t,[{key:"run",value:function(t,e,n){return this._inner.run(t,e,n)}},{key:"runTask",value:function(t,e,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,kc,Cc,Cc);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}},{key:"runGuarded",value:function(t,e,n){return this._inner.runGuarded(t,e,n)}},{key:"runOutsideAngular",value:function(t){return this._outer.run(t)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!t.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(t.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),t}();function Cc(){}var kc={};function Ec(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular((function(){return t.onStable.emit(null)}))}finally{t.isStable=!0}}}function Sc(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function Ic(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Tc(t){t._nesting--,Ec(t)}var Ac,Rc=function(){function t(){_classCallCheck(this,t),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Nu,this.onMicrotaskEmpty=new Nu,this.onStable=new Nu,this.onError=new Nu}return _createClass(t,[{key:"run",value:function(t,e,n){return t.apply(e,n)}},{key:"runGuarded",value:function(t,e,n){return t.apply(e,n)}},{key:"runOutsideAngular",value:function(t){return t()}},{key:"runTask",value:function(t,e,n,r){return t.apply(e,n)}}]),t}(),Oc=function(){var t=function(){function t(e){var n=this;_classCallCheck(this,t),this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(t,[{key:"_watchAngularEvents",value:function(){var t=this;this._ngZone.onUnstable.subscribe({next:function(){t._didWork=!0,t._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){t._ngZone.onStable.subscribe({next:function(){xc.assertNotInAngularZone(),wc((function(){t._isZoneStable=!0,t._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var t=this;if(this.isStable())wc((function(){for(;0!==t._callbacks.length;){var e=t._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(t._didWork)}t._didWork=!1}));else{var e=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(t){return!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(t){return{source:t.source,creationLocation:t.creationLocation,data:t.data}})):[]}},{key:"addCallback",value:function(t,e,n){var r=this,i=-1;e&&e>0&&(i=setTimeout((function(){r._callbacks=r._callbacks.filter((function(t){return t.timeoutId!==i})),t(r._didWork,r.getPendingTasks())}),e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(t,e,n){return[]}}]),t}();return t.\u0275fac=function(e){return new(e||t)(te(xc))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}(),Nc=function(){var t=function(){function t(){_classCallCheck(this,t),this._applications=new Map,Dc.addToWindow(this)}return _createClass(t,[{key:"registerApplication",value:function(t,e){this._applications.set(t,e)}},{key:"unregisterApplication",value:function(t){this._applications.delete(t)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(t){return this._applications.get(t)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Dc.findTestabilityInTree(this,t,e)}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}(),Dc=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"addToWindow",value:function(t){}},{key:"findTestabilityInTree",value:function(t,e,n){return null}}]),t}()),Pc=function(t,e,n){var r=new Tu(n);if(0===sa.size)return Promise.resolve(r);var i,o,a=(i=t.get(bc,[]).concat(e).map((function(t){return t.providers})),o=[],i.forEach((function(t){return t&&o.push.apply(o,_toConsumableArray(t))})),o);if(0===a.length)return Promise.resolve(r);var s=function(){var t=Lt.ng;if(!t||!t.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return t.\u0275compilerFacade}(),u=oa.create({providers:a}).get(s.ResourceLoader);return function(t){var e=[],n=new Map;function r(t){var e=n.get(t);if(!e){var r=function(t){return Promise.resolve(u.get(t))}(t);n.set(t,e=r.then(ca))}return e}return sa.forEach((function(t,n){var i=[];t.templateUrl&&i.push(r(t.templateUrl).then((function(e){t.template=e})));var o=t.styleUrls,a=t.styles||(t.styles=[]),s=t.styles.length;o&&o.forEach((function(e,n){a.push(""),i.push(r(e).then((function(r){a[s+n]=r,o.splice(o.indexOf(e),1),0==o.length&&(t.styleUrls=void 0)})))}));var u=Promise.all(i).then((function(){return function(t){ua.delete(t)}(n)}));e.push(u)})),sa=new Map,Promise.all(e).then((function(){}))}().then((function(){return r}))},Mc=new Ht("AllowMultipleToken"),Fc=function t(e,n){_classCallCheck(this,t),this.name=e,this.token=n};function Lc(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(e),i=new Ht(r);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=Bc();if(!o||o.injector.get(Mc,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{var a=n.concat(e).concat({provide:i,useValue:!0},{provide:Ho,useValue:"platform"});!function(t){if(Ac&&!Ac.destroyed&&!Ac.injector.get(Mc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ac=t.get(jc);var e=t.get(oc,null);e&&e.forEach((function(t){return t()}))}(oa.create({providers:a,name:r}))}return function(t){var e=Bc();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function Bc(){return Ac&&!Ac.destroyed?Ac:null}var jc=function(){var t=function(){function t(e){_classCallCheck(this,t),this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(t,[{key:"bootstrapModuleFactory",value:function(t,e){var n,r,i=this,o=(n=e?e.ngZone:void 0,r=e&&e.ngZoneEventCoalescing||!1,"noop"===n?new Rc:("zone.js"===n?void 0:n)||new xc({enableLongStackTrace:Sr(),shouldCoalesceEventChangeDetection:r})),a=[{provide:xc,useValue:o}];return o.run((function(){var e=oa.create({providers:a,parent:i.injector,name:t.moduleType.name}),n=t.create(e),r=n.injector.get(pr,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return Wc(i._modules,n)})),o.runOutsideAngular((function(){return o.onError.subscribe({next:function(t){r.handleError(t)}})})),function(t,e,r){try{var o=((a=n.injector.get(ec)).runInitializers(),a.donePromise.then((function(){return Eu(n.injector.get(cc,"en-US")||"en-US"),i._moduleDoBootstrap(n),n})));return Ma(o)?o.catch((function(n){throw e.runOutsideAngular((function(){return t.handleError(n)})),n})):o}catch(s){throw e.runOutsideAngular((function(){return t.handleError(s)})),s}var a}(r,o)}))}},{key:"bootstrapModule",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Vc({},n);return Pc(this.injector,r,t).then((function(t){return e.bootstrapModuleFactory(t,r)}))}},{key:"_moduleDoBootstrap",value:function(t){var e=t.injector.get(zc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach((function(t){return e.bootstrap(t)}));else{if(!t.instance.ngDoBootstrap)throw new Error("The module ".concat(St(t.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}},{key:"onDestroy",value:function(t){this._destroyListeners.push(t)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(t){return t.destroy()})),this._destroyListeners.forEach((function(t){return t()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),t}();return t.\u0275fac=function(e){return new(e||t)(te(oa))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}();function Vc(t,e){return Array.isArray(e)?e.reduce(Vc,t):Object.assign(Object.assign({},t),e)}var Uc,zc=((Uc=function(){function t(e,n,r,i,o,a){var s=this;_classCallCheck(this,t),this._zone=e,this._console=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Sr(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new E((function(t){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){t.next(s._stable),t.complete()}))})),c=new E((function(t){var e;s._zone.runOutsideAngular((function(){e=s._zone.onStable.subscribe((function(){xc.assertNotInAngularZone(),wc((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,t.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){xc.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){t.next(!1)})))}));return function(){e.unsubscribe(),n.unsubscribe()}}));this.isStable=J(u,c.pipe(at()))}return _createClass(t,[{key:"bootstrap",value:function(t,e){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=t instanceof Bs?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);var i=n.isBoundToModule?void 0:this._injector.get(oe),o=n.create(oa.NULL,[],e||n.selector,i);o.onDestroy((function(){r._unloadComponent(o)}));var a=o.injector.get(Oc,null);return a&&o.injector.get(Nc).registerApplication(o.location.nativeElement,a),this._loadComponent(o),Sr()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}},{key:"tick",value:function(){var t=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var e,n=_createForOfIteratorHelper(this._views);try{for(n.s();!(e=n.n()).done;)e.value.detectChanges()}catch(o){n.e(o)}finally{n.f()}if(this._enforceNoNewChanges){var r,i=_createForOfIteratorHelper(this._views);try{for(i.s();!(r=i.n()).done;)r.value.checkNoChanges()}catch(o){i.e(o)}finally{i.f()}}}catch(a){this._zone.runOutsideAngular((function(){return t._exceptionHandler.handleError(a)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(t){var e=t;this._views.push(e),e.attachToAppRef(this)}},{key:"detachView",value:function(t){var e=t;Wc(this._views,e),e.detachFromAppRef()}},{key:"_loadComponent",value:function(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(sc,[]).concat(this._bootstrapListeners).forEach((function(e){return e(t)}))}},{key:"_unloadComponent",value:function(t){this.detachView(t.hostView),Wc(this.components,t)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(t){return t.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),t}()).\u0275fac=function(t){return new(t||Uc)(te(xc),te(uc),te(oa),te(pr),te(Vs),te(ec))},Uc.\u0275prov=mt({token:Uc,factory:Uc.\u0275fac}),Uc);function Wc(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}var qc=function t(){_classCallCheck(this,t)},Hc=function t(){_classCallCheck(this,t)},Gc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Kc=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this._compiler=e,this._config=n||Gc}return _createClass(t,[{key:"load",value:function(t){return this.loadAndCompile(t)}},{key:"loadAndCompile",value:function(t){var e=this,r=_slicedToArray(t.split("#"),2),i=r[0],o=r[1];return void 0===o&&(o="default"),n("zn8P")(i).then((function(t){return t[o]})).then((function(t){return Xc(t,i,o)})).then((function(t){return e._compiler.compileModuleAsync(t)}))}},{key:"loadFactory",value:function(t){var e=_slicedToArray(t.split("#"),2),r=e[0],i=e[1],o="NgFactory";return void 0===i&&(i="default",o=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then((function(t){return t[i+o]})).then((function(t){return Xc(t,r,i)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(te(yc),te(Hc,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t}();function Xc(t,e,n){if(!t)throw new Error("Cannot find '".concat(n,"' in '").concat(e,"'"));return t}var $c=Lc(null,"core",[{provide:ac,useValue:"unknown"},{provide:jc,deps:[oa]},{provide:Nc,deps:[]},{provide:uc,deps:[]}]),Yc=[{provide:zc,useClass:zc,deps:[xc,uc,oa,pr,Vs,ec]},{provide:yu,deps:[xc],useFactory:function(t){var e=[];return t.onStable.subscribe((function(){for(;e.length;)e.pop()()})),function(t){e.push(t)}}},{provide:ec,useClass:ec,deps:[[new lt,tc]]},{provide:yc,useClass:yc,deps:[]},rc,{provide:au,useFactory:function(){return cu},deps:[]},{provide:su,useFactory:function(){return lu},deps:[]},{provide:cc,useFactory:function(t){return Eu(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new ct(cc),new lt,new ft]]},{provide:lc,useValue:"USD"}],Qc=function(){var t=function t(e){_classCallCheck(this,t)};return t.\u0275mod=Ce({type:t}),t.\u0275inj=gt({factory:function(e){return new(e||t)(te(zc))},providers:Yc}),t}(),Jc={apiKey:"AIzaSyB9Ss4JFnY0t9bjJ_KkNZUw2Df3Wfu19Uk",authDomain:"liga-futbol-8e1e6.firebaseapp.com",databaseURL:"https://liga-futbol-8e1e6.firebaseio.com",projectId:"liga-futbol-8e1e6",storageBucket:"liga-futbol-8e1e6.appspot.com",messagingSenderId:"118665138994",appId:"1:118665138994:web:9d05325e343288e633bd2b"},Zc=null;function tl(){return Zc}var el,nl=new Ht("DocumentToken"),rl=((el=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||el)},el.\u0275prov=mt({factory:il,token:el,providedIn:"platform"}),el);function il(){return te(sl)}var ol,al=new Ht("Location Initialized"),sl=((ol=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r._init(),r}return _createClass(n,[{key:"_init",value:function(){this.location=tl().getLocation(),this._history=tl().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return tl().getBaseHref(this._doc)}},{key:"onPopState",value:function(t){tl().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}},{key:"onHashChange",value:function(t){tl().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}},{key:"pushState",value:function(t,e,n){ul()?this._history.pushState(t,e,n):this.location.hash=n}},{key:"replaceState",value:function(t,e,n){ul()?this._history.replaceState(t,e,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(t){this.location.pathname=t}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),n}(rl)).\u0275fac=function(t){return new(t||ol)(te(nl))},ol.\u0275prov=mt({factory:cl,token:ol,providedIn:"platform"}),ol);function ul(){return!!window.history.pushState}function cl(){return new sl(te(nl))}function ll(t,e){if(0==t.length)return e;if(0==e.length)return t;var n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function hl(t){var e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function fl(t){return t&&"?"!==t[0]?"?"+t:t}var dl,pl=((dl=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||dl)},dl.\u0275prov=mt({factory:vl,token:dl,providedIn:"root"}),dl);function vl(t){var e=te(nl).location;return new _l(te(rl),e&&e.origin||"")}var ml,gl,yl,bl=new Ht("appBaseHref"),_l=((yl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;if(_classCallCheck(this,n),(i=e.call(this))._platformLocation=t,null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,_possibleConstructorReturn(i)}return _createClass(n,[{key:"onPopState",value:function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(t){return ll(this._baseHref,t)}},{key:"path",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._platformLocation.pathname+fl(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?"".concat(e).concat(n):e}},{key:"pushState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+fl(r));this._platformLocation.pushState(t,e,i)}},{key:"replaceState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+fl(r));this._platformLocation.replaceState(t,e,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(pl)).\u0275fac=function(t){return new(t||yl)(te(rl),te(bl,8))},yl.\u0275prov=mt({token:yl,factory:yl.\u0275fac}),yl),wl=((gl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._platformLocation=t,i._baseHref="",null!=r&&(i._baseHref=r),i}return _createClass(n,[{key:"onPopState",value:function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}},{key:"prepareExternalUrl",value:function(t){var e=ll(this._baseHref,t);return e.length>0?"#"+e:e}},{key:"pushState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+fl(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}},{key:"replaceState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+fl(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(pl)).\u0275fac=function(t){return new(t||gl)(te(rl),te(bl,8))},gl.\u0275prov=mt({token:gl,factory:gl.\u0275fac}),gl),xl=((ml=function(){function t(e,n){var r=this;_classCallCheck(this,t),this._subject=new Nu,this._urlChangeListeners=[],this._platformStrategy=e;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=hl(kl(i)),this._platformStrategy.onPopState((function(t){r._subject.emit({url:r.path(!0),pop:!0,state:t.state,type:t.type})}))}return _createClass(t,[{key:"path",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(t))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(t+fl(e))}},{key:"normalize",value:function(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,kl(e)))}},{key:"prepareExternalUrl",value:function(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}},{key:"go",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fl(e)),n)}},{key:"replaceState",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fl(e)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(t){var e=this;this._urlChangeListeners.push(t),this.subscribe((function(t){e._notifyUrlChangeListeners(t.url,t.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(t,e)}))}},{key:"subscribe",value:function(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}]),t}()).\u0275fac=function(t){return new(t||ml)(te(pl),te(rl))},ml.normalizeQueryParams=fl,ml.joinWithSlash=ll,ml.stripTrailingSlash=hl,ml.\u0275prov=mt({factory:Cl,token:ml,providedIn:"root"}),ml);function Cl(){return new xl(te(pl),te(rl))}function kl(t){return t.replace(/\/index.html$/,"")}var El,Sl=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),Il=function t(){_classCallCheck(this,t)},Tl=((El=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).locale=t,r}return _createClass(n,[{key:"getPluralCategory",value:function(t,e){switch(function(t){return function(t){var e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t),n=Cu(e);if(n)return n;var r=e.split("-")[0];if(n=Cu(r))return n;if("en"===r)return wu;throw new Error('Missing locale data for the locale "'.concat(t,'".'))}(t)[ku.PluralCase]}(e||this.locale)(t)){case Sl.Zero:return"zero";case Sl.One:return"one";case Sl.Two:return"two";case Sl.Few:return"few";case Sl.Many:return"many";default:return"other"}}}]),n}(Il)).\u0275fac=function(t){return new(t||El)(te(cc))},El.\u0275prov=mt({token:El,factory:El.\u0275fac}),El);function Al(t,e){e=encodeURIComponent(e);var n,r=_createForOfIteratorHelper(t.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.indexOf("="),a=_slicedToArray(-1==o?[i,""]:[i.slice(0,o),i.slice(o+1)],2),s=a[0],u=a[1];if(s.trim()===e)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var Rl,Ol,Nl,Dl=((Rl=function(){function t(e,n,r,i){_classCallCheck(this,t),this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return _createClass(t,[{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){var e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}},{key:"_applyKeyValueChanges",value:function(t){var e=this;t.forEachAddedItem((function(t){return e._toggleClass(t.key,t.currentValue)})),t.forEachChangedItem((function(t){return e._toggleClass(t.key,t.currentValue)})),t.forEachRemovedItem((function(t){t.previousValue&&e._toggleClass(t.key,!1)}))}},{key:"_applyIterableChanges",value:function(t){var e=this;t.forEachAddedItem((function(t){if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(St(t.item)));e._toggleClass(t.item,!0)})),t.forEachRemovedItem((function(t){return e._toggleClass(t.item,!1)}))}},{key:"_applyClasses",value:function(t){var e=this;t&&(Array.isArray(t)||t instanceof Set?t.forEach((function(t){return e._toggleClass(t,!0)})):Object.keys(t).forEach((function(n){return e._toggleClass(n,!!t[n])})))}},{key:"_removeClasses",value:function(t){var e=this;t&&(Array.isArray(t)||t instanceof Set?t.forEach((function(t){return e._toggleClass(t,!1)})):Object.keys(t).forEach((function(t){return e._toggleClass(t,!1)})))}},{key:"_toggleClass",value:function(t,e){var n=this;(t=t.trim())&&t.split(/\s+/g).forEach((function(t){e?n._renderer.addClass(n._ngEl.nativeElement,t):n._renderer.removeClass(n._ngEl.nativeElement,t)}))}},{key:"klass",set:function(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(va(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}}]),t}()).\u0275fac=function(t){return new(t||Rl)(Ca(au),Ca(su),Ca(Us),Ca(Hs))},Rl.\u0275dir=Ee({type:Rl,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),Rl),Pl=function(){function t(e,n,r,i){_classCallCheck(this,t),this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}return _createClass(t,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),t}(),Ml=((Ol=function(){function t(e,n,r){_classCallCheck(this,t),this._viewContainer=e,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return _createClass(t,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(t,"' of type '").concat((e=t).name||typeof e,"'. NgFor only supports binding to Iterables such as Arrays."))}}var e;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(t){var e=this,n=[];t.forEachOperation((function(t,r,i){if(null==t.previousIndex){var o=e._viewContainer.createEmbeddedView(e._template,new Pl(null,e._ngForOf,-1,-1),null===i?void 0:i),a=new Fl(t,o);n.push(a)}else if(null==i)e._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=e._viewContainer.get(r);e._viewContainer.move(s,i);var u=new Fl(t,s);n.push(u)}}));for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,o=this._viewContainer.length;i<o;i++){var a=this._viewContainer.get(i);a.context.index=i,a.context.count=o,a.context.ngForOf=this._ngForOf}t.forEachIdentityChange((function(t){e._viewContainer.get(t.currentIndex).context.$implicit=t.item}))}},{key:"_perViewChange",value:function(t,e){t.context.$implicit=e.item}},{key:"ngForOf",set:function(t){this._ngForOf=t,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(t){Sr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(t),". ")+"See https://angular.io/api/common/NgForOf#change-propagation for more information."),this._trackByFn=t},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(t){t&&(this._template=t)}}],[{key:"ngTemplateContextGuard",value:function(t,e){return!0}}]),t}()).\u0275fac=function(t){return new(t||Ol)(Ca(du),Ca(hu),Ca(au))},Ol.\u0275dir=Ee({type:Ol,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),Ol),Fl=function t(e,n){_classCallCheck(this,t),this.record=e,this.view=n},Ll=((Nl=function(){function t(e,n){_classCallCheck(this,t),this._viewContainer=e,this._context=new Bl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(t,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}},{key:"ngIfThen",set:function(t){jl("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(t){jl("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}}],[{key:"ngTemplateContextGuard",value:function(t,e){return!0}}]),t}()).\u0275fac=function(t){return new(t||Nl)(Ca(du),Ca(hu))},Nl.\u0275dir=Ee({type:Nl,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),Nl),Bl=function t(){_classCallCheck(this,t),this.$implicit=null,this.ngIf=null};function jl(t,e){if(e&&!e.createEmbeddedView)throw new Error("".concat(t," must be a TemplateRef, but received '").concat(St(e),"'."))}var Vl,Ul,zl,Wl,ql,Hl,Gl=function(){function t(e,n){_classCallCheck(this,t),this._viewContainerRef=e,this._templateRef=n,this._created=!1}return _createClass(t,[{key:"create",value:function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}},{key:"destroy",value:function(){this._created=!1,this._viewContainerRef.clear()}},{key:"enforceState",value:function(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}]),t}(),Kl=((zl=function(){function t(){_classCallCheck(this,t),this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return _createClass(t,[{key:"_addCase",value:function(){return this._caseCount++}},{key:"_addDefault",value:function(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}},{key:"_matchCase",value:function(t){var e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}},{key:"_updateDefaultCases",value:function(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(var e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}},{key:"ngSwitch",set:function(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}}]),t}()).\u0275fac=function(t){return new(t||zl)},zl.\u0275dir=Ee({type:zl,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),zl),Xl=((Ul=function(){function t(e,n,r){_classCallCheck(this,t),this.ngSwitch=r,r._addCase(),this._view=new Gl(e,n)}return _createClass(t,[{key:"ngDoCheck",value:function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}]),t}()).\u0275fac=function(t){return new(t||Ul)(Ca(du),Ca(hu),Ca(Kl,1))},Ul.\u0275dir=Ee({type:Ul,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),Ul),$l=((Vl=function t(e,n,r){_classCallCheck(this,t),r._addDefault(new Gl(e,n))}).\u0275fac=function(t){return new(t||Vl)(Ca(du),Ca(hu),Ca(Kl,1))},Vl.\u0275dir=Ee({type:Vl,selectors:[["","ngSwitchDefault",""]]}),Vl),Yl=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"createSubscription",value:function(t,e){return t.subscribe({next:e,error:function(t){throw t}})}},{key:"dispose",value:function(t){t.unsubscribe()}},{key:"onDestroy",value:function(t){t.unsubscribe()}}]),t}(),Ql=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"createSubscription",value:function(t,e){return t.then(e,(function(t){throw t}))}},{key:"dispose",value:function(t){}},{key:"onDestroy",value:function(t){}}]),t}()),Jl=new Yl,Zl=((Hl=function(){function t(e){_classCallCheck(this,t),this._ref=e,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._strategy=null}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._subscription&&this._dispose()}},{key:"transform",value:function(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):da(this._latestValue,this._latestReturnedValue)?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,pa.wrap(this._latestValue)):(t&&this._subscribe(t),this._latestReturnedValue=this._latestValue,this._latestValue)}},{key:"_subscribe",value:function(t){var e=this;this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,(function(n){return e._updateLatestValue(t,n)}))}},{key:"_selectStrategy",value:function(e){if(Ma(e))return Ql;if(Fa(e))return Jl;throw Error("InvalidPipeArgument: '".concat(e,"' for pipe '").concat(St(t),"'"))}},{key:"_dispose",value:function(){this._strategy.dispose(this._subscription),this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null}},{key:"_updateLatestValue",value:function(t,e){t===this._obj&&(this._latestValue=e,this._ref.markForCheck())}}]),t}()).\u0275fac=function(t){return new(t||Hl)(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt.Default,e=zo(!0);if(null!=e||t&dt.Optional)return e;throw new Error("No provider for ChangeDetectorRef!")}())},Hl.\u0275pipe={type:(ql={name:"async",type:Hl,pure:!1}).type,name:ql.name,factory:null,pure:!1!==ql.pure,onDestroy:ql.type.prototype.ngOnDestroy||null},Hl),th=((Wl=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Wl}),Wl.\u0275inj=gt({factory:function(t){return new(t||Wl)},providers:[{provide:Il,useClass:Tl}]}),Wl);function eh(t){return"browser"===t}function nh(t){return"server"===t}var rh,ih,oh,ah,sh,uh=((rh=function t(){_classCallCheck(this,t)}).\u0275prov=mt({token:rh,providedIn:"root",factory:function(){return new ch(te(nl),window,te(pr))}}),rh),ch=function(){function t(e,n,r){_classCallCheck(this,t),this.document=e,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(t,[{key:"setOffset",value:function(t){this.offset=Array.isArray(t)?function(){return t}:t}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}},{key:"scrollToAnchor",value:function(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var e=this.document.querySelector("#".concat(t));if(e)return void this.scrollToElement(e);var n=this.document.querySelector("[name='".concat(t,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(t){if(this.supportScrollRestoration()){var e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}},{key:"scrollToElement",value:function(t){var e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}]),t}(),lh=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getProperty",value:function(t,e){return t[e]}},{key:"log",value:function(t){window.console&&window.console.log&&window.console.log(t)}},{key:"logGroup",value:function(t){window.console&&window.console.group&&window.console.group(t)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(t,e,n){return t.addEventListener(e,n,!1),function(){t.removeEventListener(e,n,!1)}}},{key:"dispatchEvent",value:function(t,e){t.dispatchEvent(e)}},{key:"remove",value:function(t){return t.parentNode&&t.parentNode.removeChild(t),t}},{key:"getValue",value:function(t){return t.value}},{key:"createElement",value:function(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(t){return t.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(t){return t instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(t){var e,n=hh||(hh=document.querySelector("base"))?hh.getAttribute("href"):null;return null==n?null:(e=n,ih||(ih=document.createElement("a")),ih.setAttribute("href",e),"/"===ih.pathname.charAt(0)?ih.pathname:"/"+ih.pathname)}},{key:"resetBaseElement",value:function(){hh=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(t){return Al(document.cookie,t)}}],[{key:"makeCurrent",value:function(){var t;t=new n,Zc||(Zc=t)}}]),n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.call(this)}return _createClass(n,[{key:"supportsDOMEvents",value:function(){return!0}}]),n}(function(){return function t(){_classCallCheck(this,t)}}())),hh=null,fh=new Ht("TRANSITION_ID"),dh=[{provide:tc,useFactory:function(t,e,n){return function(){n.get(ec).donePromise.then((function(){var n=tl();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter((function(e){return e.getAttribute("ng-transition")===t})).forEach((function(t){return n.remove(t)}))}))}},deps:[fh,nl,oa],multi:!0}],ph=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"addToWindow",value:function(t){Lt.getAngularTestability=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Lt.getAllAngularTestabilities=function(){return t.getAllTestabilities()},Lt.getAllAngularRootElements=function(){return t.getAllRootElements()},Lt.frameworkStabilizers||(Lt.frameworkStabilizers=[]),Lt.frameworkStabilizers.push((function(t){var e=Lt.getAllAngularTestabilities(),n=e.length,r=!1,i=function(e){r=r||e,0==--n&&t(r)};e.forEach((function(t){t.whenStable(i)}))}))}},{key:"findTestabilityInTree",value:function(t,e,n){if(null==e)return null;var r=t.getTestability(e);return null!=r?r:n?tl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}],[{key:"init",value:function(){var e;e=new t,Dc=e}}]),t}(),vh=new Ht("EventManagerPlugins"),mh=((oh=function(){function t(e,n){var r=this;_classCallCheck(this,t),this._zone=n,this._eventNameToPlugin=new Map,e.forEach((function(t){return t.manager=r})),this._plugins=e.slice().reverse()}return _createClass(t,[{key:"addEventListener",value:function(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}},{key:"addGlobalEventListener",value:function(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(t){var e=this._eventNameToPlugin.get(t);if(e)return e;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(t))return this._eventNameToPlugin.set(t,i),i}throw new Error("No event manager plugin found for event ".concat(t))}}]),t}()).\u0275fac=function(t){return new(t||oh)(te(vh),te(xc))},oh.\u0275prov=mt({token:oh,factory:oh.\u0275fac}),oh),gh=function(){function t(e){_classCallCheck(this,t),this._doc=e}return _createClass(t,[{key:"addGlobalEventListener",value:function(t,e,n){var r=tl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(e));return this.addEventListener(r,e,n)}}]),t}(),yh=((sh=function(){function t(){_classCallCheck(this,t),this._stylesSet=new Set}return _createClass(t,[{key:"addStyles",value:function(t){var e=this,n=new Set;t.forEach((function(t){e._stylesSet.has(t)||(e._stylesSet.add(t),n.add(t))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(t){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),t}()).\u0275fac=function(t){return new(t||sh)},sh.\u0275prov=mt({token:sh,factory:sh.\u0275fac}),sh),bh=((ah=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r._hostNodes=new Set,r._styleNodes=new Set,r._hostNodes.add(t.head),r}return _createClass(n,[{key:"_addStylesToHost",value:function(t,e){var n=this;t.forEach((function(t){var r=n._doc.createElement("style");r.textContent=t,n._styleNodes.add(e.appendChild(r))}))}},{key:"addHost",value:function(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}},{key:"removeHost",value:function(t){this._hostNodes.delete(t)}},{key:"onStylesAdded",value:function(t){var e=this;this._hostNodes.forEach((function(n){return e._addStylesToHost(t,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(t){return tl().remove(t)}))}}]),n}(yh)).\u0275fac=function(t){return new(t||ah)(te(nl))},ah.\u0275prov=mt({token:ah,factory:ah.\u0275fac}),ah),_h={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},wh=/%COMP%/g;function xh(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?xh(t,i,n):(i=i.replace(wh,t),n.push(i))}return n}function Ch(t){return function(e){if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}var kh,Eh,Sh,Ih,Th,Ah,Rh=((kh=function(){function t(e,n,r){_classCallCheck(this,t),this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Oh(e)}return _createClass(t,[{key:"createRenderer",value:function(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case ve.Emulated:var n=this.rendererByCompId.get(e.id);return n||(n=new Nh(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n;case ve.Native:case ve.ShadowDom:return new Dh(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){var r=xh(e.id,e.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||kh)(te(mh),te(bh),te(nc))},kh.\u0275prov=mt({token:kh,factory:kh.\u0275fac}),kh),Oh=function(){function t(e){_classCallCheck(this,t),this.eventManager=e,this.data=Object.create(null)}return _createClass(t,[{key:"destroy",value:function(){}},{key:"createElement",value:function(t,e){return e?document.createElementNS(_h[e]||e,t):document.createElement(t)}},{key:"createComment",value:function(t){return document.createComment(t)}},{key:"createText",value:function(t){return document.createTextNode(t)}},{key:"appendChild",value:function(t,e){t.appendChild(e)}},{key:"insertBefore",value:function(t,e,n){t&&t.insertBefore(e,n)}},{key:"removeChild",value:function(t,e){t&&t.removeChild(e)}},{key:"selectRootElement",value:function(t,e){var n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error('The selector "'.concat(t,'" did not match any elements'));return e||(n.textContent=""),n}},{key:"parentNode",value:function(t){return t.parentNode}},{key:"nextSibling",value:function(t){return t.nextSibling}},{key:"setAttribute",value:function(t,e,n,r){if(r){e=r+":"+e;var i=_h[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}},{key:"removeAttribute",value:function(t,e,n){if(n){var r=_h[n];r?t.removeAttributeNS(r,e):t.removeAttribute("".concat(n,":").concat(e))}else t.removeAttribute(e)}},{key:"addClass",value:function(t,e){t.classList.add(e)}},{key:"removeClass",value:function(t,e){t.classList.remove(e)}},{key:"setStyle",value:function(t,e,n,r){r&qs.DashCase?t.style.setProperty(e,n,r&qs.Important?"important":""):t.style[e]=n}},{key:"removeStyle",value:function(t,e,n){n&qs.DashCase?t.style.removeProperty(e):t.style[e]=""}},{key:"setProperty",value:function(t,e,n){t[e]=n}},{key:"setValue",value:function(t,e){t.nodeValue=e}},{key:"listen",value:function(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Ch(n)):this.eventManager.addEventListener(t,e,Ch(n))}}]),t}(),Nh=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;_classCallCheck(this,n),(a=e.call(this,t)).component=i;var s,u=xh(o+"-"+i.id,i.styles,[]);return r.addStyles(u),a.contentAttr="_ngcontent-%COMP%".replace(wh,o+"-"+i.id),a.hostAttr=(s=o+"-"+i.id,"_nghost-%COMP%".replace(wh,s)),a}return _createClass(n,[{key:"applyToHost",value:function(t){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,t,this.hostAttr,"")}},{key:"createElement",value:function(t,e){var r=_get(_getPrototypeOf(n.prototype),"createElement",this).call(this,t,e);return _get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(Oh),Dh=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;_classCallCheck(this,n),(a=e.call(this,t)).sharedStylesHost=r,a.hostEl=i,a.component=o,a.shadowRoot=o.encapsulation===ve.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),a.sharedStylesHost.addHost(a.shadowRoot);for(var s=xh(o.id,o.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],a.shadowRoot.appendChild(c)}return a}return _createClass(n,[{key:"nodeOrShadowRoot",value:function(t){return t===this.hostEl?this.shadowRoot:t}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(t,e){return _get(_getPrototypeOf(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(t),e)}},{key:"insertBefore",value:function(t,e,r){return _get(_getPrototypeOf(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(t),e,r)}},{key:"removeChild",value:function(t,e){return _get(_getPrototypeOf(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(t),e)}},{key:"parentNode",value:function(t){return this.nodeOrShadowRoot(_get(_getPrototypeOf(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(t)))}}]),n}(Oh),Ph=((Eh=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"supports",value:function(t){return!0}},{key:"addEventListener",value:function(t,e,n){var r=this;return t.addEventListener(e,n,!1),function(){return r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){return t.removeEventListener(e,n)}}]),n}(gh)).\u0275fac=function(t){return new(t||Eh)(te(nl))},Eh.\u0275prov=mt({token:Eh,factory:Eh.\u0275fac}),Eh),Mh=["alt","control","meta","shift"],Fh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Lh={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Bh={alt:function(t){return t.altKey},control:function(t){return t.ctrlKey},meta:function(t){return t.metaKey},shift:function(t){return t.shiftKey}},jh=((Th=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"supports",value:function(t){return null!=n.parseEventName(t)}},{key:"addEventListener",value:function(t,e,r){var i=n.parseEventName(e),o=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return tl().onAndCancel(t,i.domEventName,o)}))}}],[{key:"parseEventName",value:function(t){var e=t.toLowerCase().split("."),r=e.shift();if(0===e.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(e.pop()),o="";if(Mh.forEach((function(t){var n=e.indexOf(t);n>-1&&(e.splice(n,1),o+=t+".")})),o+=i,0!=e.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a}},{key:"getEventFullKey",value:function(t){var e="",n=function(t){var e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Lh.hasOwnProperty(e)&&(e=Lh[e]))}return Fh[e]||e}(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Mh.forEach((function(r){r!=n&&(0,Bh[r])(t)&&(e+=r+".")})),e+=n}},{key:"eventCallback",value:function(t,e,r){return function(i){n.getEventFullKey(i)===t&&r.runGuarded((function(){return e(i)}))}}},{key:"_normalizeKey",value:function(t){switch(t){case"esc":return"escape";default:return t}}}]),n}(gh)).\u0275fac=function(t){return new(t||Th)(te(nl))},Th.\u0275prov=mt({token:Th,factory:Th.\u0275fac}),Th),Vh=((Ih=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||Ih)},Ih.\u0275prov=mt({factory:function(){return te(Uh)},token:Ih,providedIn:"root"}),Ih),Uh=((Sh=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r}return _createClass(n,[{key:"sanitize",value:function(t,e){if(null==e)return null;switch(t){case Xr.NONE:return e;case Xr.HTML:return xr(e,"HTML")?wr(e):function(t,e){var n=null;try{Dr=Dr||new Ir(t);var r=e?String(e):"";n=Dr.getInertBodyElement(r);var i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Dr.getInertBodyElement(r)}while(r!==o);var a=new Wr,s=a.sanitizeChildren(Kr(n)||n);return Sr()&&a.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var u=Kr(n)||n;u.firstChild;)u.removeChild(u.firstChild)}}(this._doc,String(e));case Xr.STYLE:return xr(e,"Style")?wr(e):function(t){if(!(t=String(t).trim()))return"";var e=t.match(Yr);return e&&Rr(e[1])===e[1]||t.match($r)&&function(t){for(var e=!0,n=!0,r=0;r<t.length;r++){var i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(Sr()&&console.warn("WARNING: sanitizing unsafe style value ".concat(t," (see http://g.co/ng/security#xss).")),"unsafe")}(e);case Xr.SCRIPT:if(xr(e,"Script"))return wr(e);throw new Error("unsafe value used in a script context");case Xr.URL:return Cr(e),xr(e,"URL")?wr(e):Rr(String(e));case Xr.RESOURCE_URL:if(xr(e,"ResourceURL"))return wr(e);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(t," (see http://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(t){return new mr(t)}},{key:"bypassSecurityTrustStyle",value:function(t){return new gr(t)}},{key:"bypassSecurityTrustScript",value:function(t){return new yr(t)}},{key:"bypassSecurityTrustUrl",value:function(t){return new br(t)}},{key:"bypassSecurityTrustResourceUrl",value:function(t){return new _r(t)}}]),n}(Vh)).\u0275fac=function(t){return new(t||Sh)(te(nl))},Sh.\u0275prov=mt({factory:function(){return t=te(Gt),new Uh(t.get(nl));var t},token:Sh,providedIn:"root"}),Sh),zh=Lc($c,"browser",[{provide:ac,useValue:"browser"},{provide:oc,useValue:function(){lh.makeCurrent(),ph.init()},multi:!0},{provide:nl,useFactory:function(){return function(t){Fe=t}(document),document},deps:[]}]),Wh=[[],{provide:Ho,useValue:"root"},{provide:pr,useFactory:function(){return new pr},deps:[]},{provide:vh,useClass:Ph,multi:!0,deps:[nl,xc,ac]},{provide:vh,useClass:jh,multi:!0,deps:[nl]},[],{provide:Rh,useClass:Rh,deps:[mh,bh,nc]},{provide:Ws,useExisting:Rh},{provide:yh,useExisting:bh},{provide:bh,useClass:bh,deps:[nl]},{provide:Oc,useClass:Oc,deps:[xc]},{provide:mh,useClass:mh,deps:[vh,xc]},[]],qh=((Ah=function(){function t(e){if(_classCallCheck(this,t),e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(t,null,[{key:"withServerTransition",value:function(e){return{ngModule:t,providers:[{provide:nc,useValue:e.appId},{provide:fh,useExisting:nc},dh]}}}]),t}()).\u0275mod=Ce({type:Ah}),Ah.\u0275inj=gt({factory:function(t){return new(t||Ah)(te(Ah,12))},providers:Wh,imports:[th,Qc]}),Ah);function Hh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(1===e.length){var r=e[0];if(h(r))return Gh(r,null);if(f(r)&&Object.getPrototypeOf(r)===Object.prototype){var i=Object.keys(r);return Gh(i.map((function(t){return r[t]})),i)}}if("function"==typeof e[e.length-1]){var o=e.pop();return Gh(e=1===e.length&&h(e[0])?e[0]:e,null).pipe(z((function(t){return o.apply(void 0,_toConsumableArray(t))})))}return Gh(e,null)}function Gh(t,e){return new E((function(n){var r=t.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var u=G(t[s]),c=!1;n.add(u.subscribe({next:function(t){c||(c=!0,a++),i[s]=t},error:function(t){return n.error(t)},complete:function(){++o!==r&&c||(a===r&&n.next(e?e.reduce((function(t,e,n){return t[e]=i[n],t}),{}):i),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}"undefined"!=typeof window&&window;var Kh,Xh,$h,Yh,Qh=new Ht("NgValueAccessor"),Jh={provide:Qh,useExisting:At((function(){return Zh})),multi:!0},Zh=((Kh=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}()).\u0275fac=function(t){return new(t||Kh)(Ca(Hs),Ca(Us))},Kh.\u0275dir=Ee({type:Kh,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&La("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[Ls([Jh])]}),Kh),tf={provide:Qh,useExisting:At((function(){return nf})),multi:!0},ef=new Ht("CompositionEventMode"),nf=((Yh=function(){function t(e,n,r){var i;_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._compositionMode=r,this.onChange=function(t){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(i=tl()?tl().getUserAgent():"",!/android (\d+)/.test(i.toLowerCase())))}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_handleInput",value:function(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}]),t}()).\u0275fac=function(t){return new(t||Yh)(Ca(Hs),Ca(Us),Ca(ef,8))},Yh.\u0275dir=Ee({type:Yh,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&La("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[Ls([tf])]}),Yh),rf=(($h=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"reset",value:function(t){this.control&&this.control.reset(t)}},{key:"hasError",value:function(t,e){return!!this.control&&this.control.hasError(t,e)}},{key:"getError",value:function(t,e){return this.control?this.control.getError(t,e):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),t}()).\u0275fac=function(t){return new(t||$h)},$h.\u0275dir=Ee({type:$h}),$h),of=((Xh=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(rf)).\u0275fac=function(t){return af(t||Xh)},Xh.\u0275dir=Ee({type:Xh,features:[ws]}),Xh),af=lr(of);function sf(){throw new Error("unimplemented")}var uf,cf,lf=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments))._parent=null,t.name=null,t.valueAccessor=null,t._rawValidators=[],t._rawAsyncValidators=[],t}return _createClass(n,[{key:"validator",get:function(){return sf()}},{key:"asyncValidator",get:function(){return sf()}}]),n}(rf),hf=function(){function t(e){_classCallCheck(this,t),this._cd=e}return _createClass(t,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),t}(),ff=((cf=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return n}(hf)).\u0275fac=function(t){return new(t||cf)(Ca(lf,2))},cf.\u0275dir=Ee({type:cf,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&ns("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[ws]}),cf),df=((uf=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return n}(hf)).\u0275fac=function(t){return new(t||uf)(Ca(of,2))},uf.\u0275dir=Ee({type:uf,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&ns("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[ws]}),uf);function pf(t){return null==t||0===t.length}var vf=new Ht("NgValidators"),mf=new Ht("NgAsyncValidators"),gf=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,yf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"min",value:function(t){return function(e){if(pf(e.value)||pf(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}},{key:"max",value:function(t){return function(e){if(pf(e.value)||pf(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}},{key:"required",value:function(t){return pf(t.value)?{required:!0}:null}},{key:"requiredTrue",value:function(t){return!0===t.value?null:{required:!0}}},{key:"email",value:function(t){return pf(t.value)?null:gf.test(t.value)?null:{email:!0}}},{key:"minLength",value:function(t){return function(e){if(pf(e.value))return null;var n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}},{key:"maxLength",value:function(t){return function(e){var n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}},{key:"pattern",value:function(e){return e?("string"==typeof e?(r="","^"!==e.charAt(0)&&(r+="^"),r+=e,"$"!==e.charAt(e.length-1)&&(r+="$"),n=new RegExp(r)):(r=e.toString(),n=e),function(t){if(pf(t.value))return null;var e=t.value;return n.test(e)?null:{pattern:{requiredPattern:r,actualValue:e}}}):t.nullValidator;var n,r}},{key:"nullValidator",value:function(t){return null}},{key:"compose",value:function(t){if(!t)return null;var e=t.filter(bf);return 0==e.length?null:function(t){return wf(function(t,e){return e.map((function(e){return e(t)}))}(t,e))}}},{key:"composeAsync",value:function(t){if(!t)return null;var e=t.filter(bf);return 0==e.length?null:function(t){return Hh(function(t,e){return e.map((function(e){return e(t)}))}(t,e).map(_f)).pipe(z(wf))}}}]),t}();function bf(t){return null!=t}function _f(t){var e=Ma(t)?G(t):t;if(!Fa(e))throw new Error("Expected validator to return Promise or Observable.");return e}function wf(t){var e={};return t.forEach((function(t){e=null!=t?Object.assign(Object.assign({},e),t):e})),0===Object.keys(e).length?null:e}function xf(t){return t.validate?function(e){return t.validate(e)}:t}function Cf(t){return t.validate?function(e){return t.validate(e)}:t}var kf,Ef,Sf,If,Tf,Af,Rf={provide:Qh,useExisting:At((function(){return Of})),multi:!0},Of=((kf=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}},{key:"registerOnChange",value:function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}()).\u0275fac=function(t){return new(t||kf)(Ca(Hs),Ca(Us))},kf.\u0275dir=Ee({type:kf,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&La("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Ls([Rf])]}),kf),Nf={provide:Qh,useExisting:At((function(){return Pf})),multi:!0},Df=((Sf=function(){function t(){_classCallCheck(this,t),this._accessors=[]}return _createClass(t,[{key:"add",value:function(t,e){this._accessors.push([t,e])}},{key:"remove",value:function(t){for(var e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}},{key:"select",value:function(t){var e=this;this._accessors.forEach((function(n){e._isSameGroup(n,t)&&n[1]!==t&&n[1].fireUncheck(t.value)}))}},{key:"_isSameGroup",value:function(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}]),t}()).\u0275fac=function(t){return new(t||Sf)},Sf.\u0275prov=mt({token:Sf,factory:Sf.\u0275fac}),Sf),Pf=((Ef=function(){function t(e,n,r,i){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._registry=r,this._injector=i,this.onChange=function(){},this.onTouched=function(){}}return _createClass(t,[{key:"ngOnInit",value:function(){this._control=this._injector.get(lf),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(t){var e=this;this._fn=t,this.onChange=function(){t(e.value),e._registry.select(e)}}},{key:"fireUncheck",value:function(t){this.writeValue(t)}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),t}()).\u0275fac=function(t){return new(t||Ef)(Ca(Hs),Ca(Us),Ca(Df),Ca(oa))},Ef.\u0275dir=Ee({type:Ef,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&La("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ls([Nf])]}),Ef),Mf={provide:Qh,useExisting:At((function(){return Ff})),multi:!0},Ff=((If=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}},{key:"registerOnChange",value:function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}()).\u0275fac=function(t){return new(t||If)(Ca(Hs),Ca(Us))},If.\u0275dir=Ee({type:If,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&La("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[Ls([Mf])]}),If),Lf='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',Bf='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',jf='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',Vf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"controlParentException",value:function(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(Lf))}},{key:"ngModelGroupException",value:function(){throw new Error('formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        '.concat(Bf,"\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ").concat(jf))}},{key:"missingFormException",value:function(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ".concat(Lf))}},{key:"groupParentException",value:function(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(Bf))}},{key:"arrayParentException",value:function(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}},{key:"disabledAttrWarning",value:function(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}},{key:"ngModelWarning",value:function(t){console.warn("\n    It looks like you're using ngModel on the same form field as ".concat(t,". \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/").concat("formControl"===t?"FormControlDirective":"FormControlName","#use-with-ngmodel\n    "))}}]),t}(),Uf={provide:Qh,useExisting:At((function(){return zf})),multi:!0},zf=((Tf=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=da}return _createClass(t,[{key:"writeValue",value:function(t){this.value=t;var e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=function(t,e){return null==t?"".concat(e):(e&&"object"==typeof e&&(e="Object"),"".concat(t,": ").concat(e).slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(t){var e=this;this.onChange=function(n){e.value=e._getOptionValue(n),t(e.value)}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r),t))return r}return null}},{key:"_getOptionValue",value:function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}},{key:"compareWith",set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(t)));this._compareWith=t}}]),t}()).\u0275fac=function(t){return new(t||Tf)(Ca(Hs),Ca(Us))},Tf.\u0275dir=Ee({type:Tf,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&La("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Ls([Uf])]}),Tf),Wf={provide:Qh,useExisting:At((function(){return qf})),multi:!0},qf=((Af=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=da}return _createClass(t,[{key:"writeValue",value:function(t){var e,n=this;if(this.value=t,Array.isArray(t)){var r=t.map((function(t){return n._getOptionId(t)}));e=function(t,e){t._setSelected(r.indexOf(e.toString())>-1)}}else e=function(t,e){t._setSelected(!1)};this._optionMap.forEach(e)}},{key:"registerOnChange",value:function(t){var e=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=e._getOptionValue(a.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=e._getOptionValue(l.value);r.push(h)}}e.value=r,t(r)}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_registerOption",value:function(t){var e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}},{key:"_getOptionId",value:function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r)._value,t))return r}return null}},{key:"_getOptionValue",value:function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}},{key:"compareWith",set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(t)));this._compareWith=t}}]),t}()).\u0275fac=function(t){return new(t||Af)(Ca(Hs),Ca(Us))},Af.\u0275dir=Ee({type:Af,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&La("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Ls([Wf])]}),Af);function Hf(t,e){return[].concat(_toConsumableArray(e.path),[t])}function Gf(t,e){t||Yf(e,"Cannot find control with"),e.valueAccessor||Yf(e,"No value accessor for form control with"),t.validator=yf.compose([t.validator,e.validator]),t.asyncValidator=yf.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange((function(n){t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Kf(t,e)}))}(t,e),function(t,e){t.registerOnChange((function(t,n){e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)}))}(t,e),function(t,e){e.valueAccessor.registerOnTouched((function(){t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Kf(t,e),"submit"!==t.updateOn&&t.markAsTouched()}))}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange((function(t){e.valueAccessor.setDisabledState(t)})),e._rawValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange((function(){return t.updateValueAndValidity()}))})),e._rawAsyncValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange((function(){return t.updateValueAndValidity()}))}))}function Kf(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Xf(t,e){null==t&&Yf(e,"Cannot find control with"),t.validator=yf.compose([t.validator,e.validator]),t.asyncValidator=yf.composeAsync([t.asyncValidator,e.asyncValidator])}function $f(t){return Yf(t,"There is no FormControl instance attached to form control element with")}function Yf(t,e){var n;throw n=t.path.length>1?"path: '".concat(t.path.join(" -> "),"'"):t.path[0]?"name: '".concat(t.path,"'"):"unspecified name attribute",new Error("".concat(e," ").concat(n))}function Qf(t){return null!=t?yf.compose(t.map(xf)):null}function Jf(t){return null!=t?yf.composeAsync(t.map(Cf)):null}function Zf(t,e){if(!t.hasOwnProperty("model"))return!1;var n=t.model;return!!n.isFirstChange()||!da(e,n.currentValue)}var td=[Zh,Ff,Of,zf,qf,Pf];function ed(t,e){t._syncPendingControls(),e.forEach((function(t){var e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}))}function nd(t,e){if(!e)return null;Array.isArray(e)||Yf(t,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,i=void 0;return e.forEach((function(e){var o;e.constructor===nf?n=e:(o=e,td.some((function(t){return o.constructor===t}))?(r&&Yf(t,"More than one built-in value accessor matches form control with"),r=e):(i&&Yf(t,"More than one custom value accessor matches form control with"),i=e))})),i||r||n||(Yf(t,"No valid value accessor for form control with"),null)}function rd(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function id(t){var e=ad(t)?t.validators:t;return Array.isArray(e)?Qf(e):e||null}function od(t,e){var n=ad(e)?e.asyncValidators:t;return Array.isArray(n)?Jf(n):n||null}function ad(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}var sd,ud,cd,ld,hd,fd,dd,pd,vd=function(){function t(e,n){_classCallCheck(this,t),this.validator=e,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(t,[{key:"setValidators",value:function(t){this.validator=id(t)}},{key:"setAsyncValidators",value:function(t){this.asyncValidator=od(t)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(t){return t.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(t){t.markAsUntouched({onlySelf:!0})})),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}},{key:"markAsDirty",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}},{key:"markAsPristine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(t){t.markAsPristine({onlySelf:!0})})),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}},{key:"markAsPending",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}},{key:"disable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(e){e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))})),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach((function(t){return t(!0)}))}},{key:"enable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild((function(e){e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach((function(t){return t(!1)}))}},{key:"_updateAncestors",value:function(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(t){this._parent=t}},{key:"updateValueAndValidity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}},{key:"_updateTreeValidity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(e){return e._updateTreeValidity(t)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(t){var e=this;if(this.asyncValidator){this.status="PENDING";var n=_f(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return e.setErrors(n,{emitEvent:t})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}},{key:"get",value:function(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;var r=t;return e.forEach((function(t){r=r instanceof gd?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof yd&&r.at(t)||null})),r}(this,t)}},{key:"getError",value:function(t,e){var n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}},{key:"hasError",value:function(t,e){return!!this.getError(t,e)}},{key:"_updateControlsErrors",value:function(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}},{key:"_initObservables",value:function(){this.valueChanges=new Nu,this.statusChanges=new Nu}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(t){return this._anyControls((function(e){return e.status===t}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(t){return t.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(t){return t.touched}))}},{key:"_updatePristine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}},{key:"_updateTouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}},{key:"_isBoxedValue",value:function(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}},{key:"_registerOnCollectionChange",value:function(t){this._onCollectionChange=t}},{key:"_setUpdateStrategy",value:function(t){ad(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}},{key:"_parentMarkedDirty",value:function(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var t=this;t._parent;)t=t._parent;return t}}]),t}(),md=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,n),(t=e.call(this,id(i),od(o,i)))._onChange=[],t._applyFormState(r),t._setUpdateStrategy(i),t.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),t._initObservables(),t}return _createClass(n,[{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(t){return t(e.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(t,e)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(t){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(t){this._onChange.push(t)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(t){this._onDisabledChange.push(t)}},{key:"_forEachChild",value:function(t){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}]),n}(vd),gd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,id(r),od(i,r))).controls=t,o._initObservables(),o._setUpdateStrategy(r),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _createClass(n,[{key:"registerControl",value:function(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}},{key:"addControl",value:function(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}},{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(t),Object.keys(t).forEach((function(r){e._throwIfControlMissing(r),e.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(t).forEach((function(r){e.controls[r]&&e.controls[r].patchValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})})),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(t,e,n){return t[n]=e instanceof md?e.value:e.getRawValue(),t}))}},{key:"_syncPendingControls",value:function(){var t=this._reduceChildren(!1,(function(t,e){return!!e._syncPendingControls()||t}));return t&&this.updateValueAndValidity({onlySelf:!0}),t}},{key:"_throwIfControlMissing",value:function(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error("Cannot find form control with name: ".concat(t,"."))}},{key:"_forEachChild",value:function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))}},{key:"_setUpControls",value:function(){var t=this;this._forEachChild((function(e){e.setParent(t),e._registerOnCollectionChange(t._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(t){var e=this,n=!1;return this._forEachChild((function(r,i){n=n||e.contains(i)&&t(r)})),n}},{key:"_reduceValue",value:function(){var t=this;return this._reduceChildren({},(function(e,n,r){return(n.enabled||t.disabled)&&(e[r]=n.value),e}))}},{key:"_reduceChildren",value:function(t,e){var n=t;return this._forEachChild((function(t,r){n=e(n,t,r)})),n}},{key:"_allControlsDisabled",value:function(){for(var t=0,e=Object.keys(this.controls);t<e.length;t++){var n=e[t];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(t){this._forEachChild((function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),n}(vd),yd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,id(r),od(i,r))).controls=t,o._initObservables(),o._setUpdateStrategy(r),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _createClass(n,[{key:"at",value:function(t){return this.controls[t]}},{key:"push",value:function(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}},{key:"removeAt",value:function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),this.controls.splice(t,1),this.updateValueAndValidity()}},{key:"setControl",value:function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(t),t.forEach((function(t,r){e._throwIfControlMissing(r),e.at(r).setValue(t,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t,r){e.at(r)&&e.at(r).patchValue(t,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})})),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}},{key:"getRawValue",value:function(){return this.controls.map((function(t){return t instanceof md?t.value:t.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(t){return t._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var t=this.controls.reduce((function(t,e){return!!e._syncPendingControls()||t}),!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}},{key:"_throwIfControlMissing",value:function(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index ".concat(t))}},{key:"_forEachChild",value:function(t){this.controls.forEach((function(e,n){t(e,n)}))}},{key:"_updateValue",value:function(){var t=this;this.value=this.controls.filter((function(e){return e.enabled||t.disabled})).map((function(t){return t.value}))}},{key:"_anyControls",value:function(t){return this.controls.some((function(e){return e.enabled&&t(e)}))}},{key:"_setUpControls",value:function(){var t=this;this._forEachChild((function(e){return t._registerControl(e)}))}},{key:"_checkAllValuesPresent",value:function(t){this._forEachChild((function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var t,e=_createForOfIteratorHelper(this.controls);try{for(e.s();!(t=e.n()).done;){if(t.value.enabled)return!1}}catch(n){e.e(n)}finally{e.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),n}(vd),bd={provide:of,useExisting:At((function(){return wd}))},_d=Promise.resolve(null),wd=((ud=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new Nu,i.form=new gd({},Qf(t),Jf(r)),i}return _createClass(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(t){var e=this;_d.then((function(){var n=e._findContainer(t.path);t.control=n.registerControl(t.name,t.control),Gf(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),e._directives.push(t)}))}},{key:"getControl",value:function(t){return this.form.get(t.path)}},{key:"removeControl",value:function(t){var e=this;_d.then((function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name),rd(e._directives,t)}))}},{key:"addFormGroup",value:function(t){var e=this;_d.then((function(){var n=e._findContainer(t.path),r=new gd({});Xf(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(t){var e=this;_d.then((function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name)}))}},{key:"getFormGroup",value:function(t){return this.form.get(t.path)}},{key:"updateModel",value:function(t,e){var n=this;_d.then((function(){n.form.get(t.path).setValue(e)}))}},{key:"setValue",value:function(t){this.control.setValue(t)}},{key:"onSubmit",value:function(t){return this.submitted=!0,ed(this.form,this._directives),this.ngSubmit.emit(t),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(t){this.form.reset(t),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(t){return t.pop(),t.length?this.form.get(t):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),n}(of)).\u0275fac=function(t){return new(t||ud)(Ca(vf,10),Ca(mf,10))},ud.\u0275dir=Ee({type:ud,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&La("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ls([bd]),ws]}),ud),xd=((sd=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return Hf(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return Qf(this._validators)}},{key:"asyncValidator",get:function(){return Jf(this._asyncValidators)}}]),n}(of)).\u0275fac=function(t){return Cd(t||sd)},sd.\u0275dir=Ee({type:sd,features:[ws]}),sd),Cd=lr(xd),kd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"modelParentException",value:function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      '.concat(Lf,'\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  '))}},{key:"formGroupNameException",value:function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ".concat(Bf,"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ").concat(jf))}},{key:"missingNameException",value:function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}},{key:"modelGroupParentException",value:function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ".concat(Bf,"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ").concat(jf))}}]),t}(),Ed={provide:of,useExisting:At((function(){return Sd}))},Sd=((cd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this))._parent=t,o._validators=r,o._asyncValidators=i,o}return _createClass(n,[{key:"_checkParentType",value:function(){this._parent instanceof n||this._parent instanceof wd||kd.modelGroupParentException()}}]),n}(xd)).\u0275fac=function(t){return new(t||cd)(Ca(of,5),Ca(vf,10),Ca(mf,10))},cd.\u0275dir=Ee({type:cd,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[Ls([Ed]),ws]}),cd),Id={provide:lf,useExisting:At((function(){return Ad}))},Td=Promise.resolve(null),Ad=((hd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this)).control=new md,a._registered=!1,a.update=new Nu,a._parent=t,a._rawValidators=r||[],a._rawAsyncValidators=i||[],a.valueAccessor=nd(_assertThisInitialized(a),o),a}return _createClass(n,[{key:"ngOnChanges",value:function(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),Zf(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(t){this.viewModel=t,this.update.emit(t)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){Gf(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){!(this._parent instanceof Sd)&&this._parent instanceof xd?kd.formGroupNameException():this._parent instanceof Sd||this._parent instanceof wd||kd.modelParentException()}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||kd.missingNameException()}},{key:"_updateValue",value:function(t){var e=this;Td.then((function(){e.control.setValue(t,{emitViewToModelChange:!1})}))}},{key:"_updateDisabled",value:function(t){var e=this,n=t.isDisabled.currentValue,r=""===n||n&&"false"!==n;Td.then((function(){r&&!e.control.disabled?e.control.disable():!r&&e.control.disabled&&e.control.enable()}))}},{key:"path",get:function(){return this._parent?Hf(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return Qf(this._rawValidators)}},{key:"asyncValidator",get:function(){return Jf(this._rawAsyncValidators)}}]),n}(lf)).\u0275fac=function(t){return new(t||hd)(Ca(of,9),Ca(vf,10),Ca(mf,10),Ca(Qh,10))},hd.\u0275dir=Ee({type:hd,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ls([Id]),ws,Is]}),hd),Rd=((ld=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||ld)},ld.\u0275dir=Ee({type:ld,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),ld),Od=new Ht("NgModelWithFormControlWarning"),Nd={provide:of,useExisting:At((function(){return Dd}))},Dd=((fd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._validators=t,i._asyncValidators=r,i.submitted=!1,i.directives=[],i.form=null,i.ngSubmit=new Nu,i}return _createClass(n,[{key:"ngOnChanges",value:function(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}},{key:"addControl",value:function(t){var e=this.form.get(t.path);return Gf(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}},{key:"getControl",value:function(t){return this.form.get(t.path)}},{key:"removeControl",value:function(t){rd(this.directives,t)}},{key:"addFormGroup",value:function(t){var e=this.form.get(t.path);Xf(e,t),e.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormGroup",value:function(t){}},{key:"getFormGroup",value:function(t){return this.form.get(t.path)}},{key:"addFormArray",value:function(t){var e=this.form.get(t.path);Xf(e,t),e.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormArray",value:function(t){}},{key:"getFormArray",value:function(t){return this.form.get(t.path)}},{key:"updateModel",value:function(t,e){this.form.get(t.path).setValue(e)}},{key:"onSubmit",value:function(t){return this.submitted=!0,ed(this.form,this.directives),this.ngSubmit.emit(t),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(t){this.form.reset(t),this.submitted=!1}},{key:"_updateDomValue",value:function(){var t=this;this.directives.forEach((function(e){var n=t.form.get(e.path);e.control!==n&&(function(t,e){e.valueAccessor.registerOnChange((function(){return $f(e)})),e.valueAccessor.registerOnTouched((function(){return $f(e)})),e._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(null)})),e._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(null)})),t&&t._clearChangeFns()}(e.control,e),n&&Gf(n,e),e.control=n)})),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_updateRegistrations",value:function(){var t=this;this.form._registerOnCollectionChange((function(){return t._updateDomValue()})),this._oldForm&&this._oldForm._registerOnCollectionChange((function(){})),this._oldForm=this.form}},{key:"_updateValidators",value:function(){var t=Qf(this._validators);this.form.validator=yf.compose([this.form.validator,t]);var e=Jf(this._asyncValidators);this.form.asyncValidator=yf.composeAsync([this.form.asyncValidator,e])}},{key:"_checkFormPresent",value:function(){this.form||Vf.missingFormException()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}}]),n}(of)).\u0275fac=function(t){return new(t||fd)(Ca(vf,10),Ca(mf,10))},fd.\u0275dir=Ee({type:fd,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&La("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ls([Nd]),ws,Is]}),fd),Pd={provide:of,useExisting:At((function(){return Md}))},Md=((dd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this))._parent=t,o._validators=r,o._asyncValidators=i,o}return _createClass(n,[{key:"_checkParentType",value:function(){Bd(this._parent)&&Vf.groupParentException()}}]),n}(xd)).\u0275fac=function(t){return new(t||dd)(Ca(of,13),Ca(vf,10),Ca(mf,10))},dd.\u0275dir=Ee({type:dd,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[Ls([Pd]),ws]}),dd),Fd={provide:of,useExisting:At((function(){return Ld}))},Ld=((pd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this))._parent=t,o._validators=r,o._asyncValidators=i,o}return _createClass(n,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormArray(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormArray(this)}},{key:"_checkParentType",value:function(){Bd(this._parent)&&Vf.arrayParentException()}},{key:"control",get:function(){return this.formDirective.getFormArray(this)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"path",get:function(){return Hf(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"validator",get:function(){return Qf(this._validators)}},{key:"asyncValidator",get:function(){return Jf(this._asyncValidators)}}]),n}(of)).\u0275fac=function(t){return new(t||pd)(Ca(of,13),Ca(vf,10),Ca(mf,10))},pd.\u0275dir=Ee({type:pd,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[Ls([Fd]),ws]}),pd);function Bd(t){return!(t instanceof Md||t instanceof Dd||t instanceof Ld)}var jd,Vd,Ud,zd,Wd,qd={provide:lf,useExisting:At((function(){return Hd}))},Hd=((Wd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this))._ngModelWarningConfig=a,s._added=!1,s.update=new Nu,s._ngModelWarningSent=!1,s._parent=t,s._rawValidators=r||[],s._rawAsyncValidators=i||[],s.valueAccessor=nd(_assertThisInitialized(s),o),s}return _createClass(n,[{key:"ngOnChanges",value:function(t){this._added||this._setUpControl(),Zf(t,this.viewModel)&&(function(t,e,n,r){Sr()&&"never"!==r&&((null!==r&&"once"!==r||e._ngModelWarningSentOnce)&&("always"!==r||n._ngModelWarningSent)||(Vf.ngModelWarning("formControlName"),e._ngModelWarningSentOnce=!0,n._ngModelWarningSent=!0))}(0,n,this,this._ngModelWarningConfig),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(t){this.viewModel=t,this.update.emit(t)}},{key:"_checkParentType",value:function(){!(this._parent instanceof Md)&&this._parent instanceof xd?Vf.ngModelGroupException():this._parent instanceof Md||this._parent instanceof Dd||this._parent instanceof Ld||Vf.controlParentException()}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}},{key:"isDisabled",set:function(t){Vf.disabledAttrWarning()}},{key:"path",get:function(){return Hf(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return Qf(this._rawValidators)}},{key:"asyncValidator",get:function(){return Jf(this._rawAsyncValidators)}}]),n}(lf)).\u0275fac=function(t){return new(t||Wd)(Ca(of,13),Ca(vf,10),Ca(mf,10),Ca(Qh,10),Ca(Od,8))},Wd.\u0275dir=Ee({type:Wd,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Ls([qd]),ws,Is]}),Wd._ngModelWarningSentOnce=!1,Wd),Gd=((zd=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:zd}),zd.\u0275inj=gt({factory:function(t){return new(t||zd)}}),zd),Kd=((Ud=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"group",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._reduceControls(t),r=null,i=null,o=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,o=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new gd(n,{asyncValidators:i,updateOn:o,validators:r})}},{key:"control",value:function(t,e,n){return new md(t,e,n)}},{key:"array",value:function(t,e,n){var r=this,i=t.map((function(t){return r._createControl(t)}));return new yd(i,e,n)}},{key:"_reduceControls",value:function(t){var e=this,n={};return Object.keys(t).forEach((function(r){n[r]=e._createControl(t[r])})),n}},{key:"_createControl",value:function(t){return t instanceof md||t instanceof gd||t instanceof yd?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}]),t}()).\u0275fac=function(t){return new(t||Ud)},Ud.\u0275prov=mt({token:Ud,factory:Ud.\u0275fac}),Ud),Xd=((Vd=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Vd}),Vd.\u0275inj=gt({factory:function(t){return new(t||Vd)},providers:[Df],imports:[Gd]}),Vd),$d=((jd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"withConfig",value:function(e){return{ngModule:t,providers:[{provide:Od,useValue:e.warnOnNgModelWithFormControl}]}}}]),t}()).\u0275mod=Ce({type:jd}),jd.\u0275inj=gt({factory:function(t){return new(t||jd)},providers:[Kd,Df],imports:[Gd]}),jd);function Yd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[e.length-1];return D(r)?(e.pop(),H(e,r)):Q(e)}var Qd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._value=t,r}return _createClass(n,[{key:"_subscribe",value:function(t){var e=_get(_getPrototypeOf(n.prototype),"_subscribe",this).call(this,t);return e&&!e.closed&&t.next(this._value),e}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new T;return this._value}},{key:"next",value:function(t){_get(_getPrototypeOf(n.prototype),"next",this).call(this,this._value=t)}},{key:"value",get:function(){return this.getValue()}}]),n}(O),Jd=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}(),Zd={};function tp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=null,i=null;return D(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&h(e[0])&&(e=e[0]),Q(e,i).lift(new ep(r))}var ep=function(){function t(e){_classCallCheck(this,t),this.resultSelector=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new np(t,this.resultSelector))}}]),t}(),np=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return _createClass(n,[{key:"_next",value:function(t){this.values.push(Zd),this.observables.push(t)}},{key:"_complete",value:function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(V(this,r,r,n))}}}},{key:"notifyComplete",value:function(t){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(t,e,n,r,i){var o=this.values,a=this.toRespond?o[n]===Zd?--this.toRespond:this.toRespond:0;o[n]=e,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}},{key:"_tryResultSelector",value:function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}]),n}(U),rp=new E((function(t){return t.complete()}));function ip(t){return t?function(t){return new E((function(e){return t.schedule((function(){return e.complete()}))}))}(t):rp}function op(t){return new E((function(e){var n;try{n=t()}catch(r){return void e.error(r)}return(n?G(n):ip()).subscribe(e)}))}function ap(){return Y(1)}function sp(t,e){return function(n){return n.lift(new up(t,e))}}var up=function(){function t(e,n){_classCallCheck(this,t),this.predicate=e,this.thisArg=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new cp(t,this.predicate,this.thisArg))}}]),t}(),cp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t)).predicate=r,o.thisArg=i,o.count=0,o}return _createClass(n,[{key:"_next",value:function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}]),n}(y),lp=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}();function hp(t){return function(e){return 0===t?ip():e.lift(new fp(t))}}var fp=function(){function t(e){if(_classCallCheck(this,t),this.total=e,this.total<0)throw new lp}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new dp(t,this.total))}}]),t}(),dp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).total=r,i.ring=new Array,i.count=0,i}return _createClass(n,[{key:"_next",value:function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}},{key:"_complete",value:function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=e++%n;t.next(r[o])}t.complete()}}]),n}(y);function pp(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gp;return function(e){return e.lift(new vp(t))}}var vp=function(){function t(e){_classCallCheck(this,t),this.errorFactory=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new mp(t,this.errorFactory))}}]),t}(),mp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).errorFactory=r,i.hasValue=!1,i}return _createClass(n,[{key:"_next",value:function(t){this.hasValue=!0,this.destination.next(t)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}]),n}(y);function gp(){return new Jd}function yp(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e){return e.lift(new bp(t))}}var bp=function(){function t(e){_classCallCheck(this,t),this.defaultValue=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new _p(t,this.defaultValue))}}]),t}(),_p=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).defaultValue=r,i.isEmpty=!0,i}return _createClass(n,[{key:"_next",value:function(t){this.isEmpty=!1,this.destination.next(t)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),n}(y);function wp(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?sp((function(e,n){return t(e,n,r)})):w,hp(1),n?yp(e):pp((function(){return new Jd})))}}function xp(t){return function(e){var n=new Cp(t),r=e.lift(n);return n.caught=r}}var Cp=function(){function t(e){_classCallCheck(this,t),this.selector=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new kp(t,this.selector,this.caught))}}]),t}(),kp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t)).selector=r,o.caught=i,o}return _createClass(n,[{key:"error",value:function(t){if(!this.isStopped){var e;try{e=this.selector(t,this.caught)}catch(o){return void _get(_getPrototypeOf(n.prototype),"error",this).call(this,o)}this._unsubscribeAndRecycle();var r=new P(this,void 0,void 0);this.add(r);var i=V(this,e,void 0,void 0,r);i!==r&&this.add(i)}}}]),n}(U);function Ep(t){return function(e){return 0===t?ip():e.lift(new Sp(t))}}var Sp=function(){function t(e){if(_classCallCheck(this,t),this.total=e,this.total<0)throw new lp}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Ip(t,this.total))}}]),t}(),Ip=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).total=r,i.count=0,i}return _createClass(n,[{key:"_next",value:function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}]),n}(y);function Tp(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?sp((function(e,n){return t(e,n,r)})):w,Ep(1),n?yp(e):pp((function(){return new Jd})))}}var Ap=function(){function t(e,n,r){_classCallCheck(this,t),this.predicate=e,this.thisArg=n,this.source=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Rp(t,this.predicate,this.thisArg,this.source))}}]),t}(),Rp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t)).predicate=r,a.thisArg=i,a.source=o,a.index=0,a.thisArg=i||_assertThisInitialized(a),a}return _createClass(n,[{key:"notifyComplete",value:function(t){this.destination.next(t),this.destination.complete()}},{key:"_next",value:function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),n}(y);function Op(t,e){return"function"==typeof e?function(n){return n.pipe(Op((function(n,r){return G(t(n,r)).pipe(z((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new Np(t))}}var Np=function(){function t(e){_classCallCheck(this,t),this.project=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Dp(t,this.project))}}]),t}(),Dp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).project=r,i.index=0,i}return _createClass(n,[{key:"_next",value:function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}},{key:"_innerSub",value:function(t,e,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new P(this,e,n),o=this.destination;o.add(i),this.innerSubscription=V(this,t,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)}},{key:"_complete",value:function(){var t=this.innerSubscription;t&&!t.closed||_get(_getPrototypeOf(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}}]),n}(U);function Pp(){return ap()(Yd.apply(void 0,arguments))}function Mp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[e.length-1];return D(r)?(e.pop(),function(t){return Pp(e,t,r)}):function(t){return Pp(e,t)}}function Fp(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Lp(t,e,n))}}var Lp=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.accumulator=e,this.seed=n,this.hasSeed=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Bp(t,this.accumulator,this.seed,this.hasSeed))}}]),t}(),Bp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t)).accumulator=r,a._seed=i,a.hasSeed=o,a.index=0,a}return _createClass(n,[{key:"_next",value:function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}},{key:"_tryNext",value:function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(r){this.destination.error(r)}this.seed=e,this.destination.next(e)}},{key:"seed",get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t}}]),n}(y);function jp(t,e){return K(t,e,1)}function Vp(){}function Up(t,e,n){return function(r){return r.lift(new zp(t,e,n))}}var zp=function(){function t(e,n,r){_classCallCheck(this,t),this.nextOrObserver=e,this.error=n,this.complete=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Wp(t,this.nextOrObserver,this.error,this.complete))}}]),t}(),Wp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var s;return _classCallCheck(this,n),(s=e.call(this,t))._tapNext=Vp,s._tapError=Vp,s._tapComplete=Vp,s._tapError=i||Vp,s._tapComplete=o||Vp,a(r)?(s._context=_assertThisInitialized(s),s._tapNext=r):r&&(s._context=r,s._tapNext=r.next||Vp,s._tapError=r.error||Vp,s._tapComplete=r.complete||Vp),s}return _createClass(n,[{key:"_next",value:function(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}},{key:"_error",value:function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}]),n}(y);function qp(t){return function(e){return e.lift(new Gp(t))}}var Hp,Gp=function(){function t(e){_classCallCheck(this,t),this.callback=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Kp(t,this.callback))}}]),t}(),Kp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).add(new v(r)),i}return n}(y),Xp=function t(e,n){_classCallCheck(this,t),this.id=e,this.url=n},$p=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,n),(i=e.call(this,t,r)).navigationTrigger=o,i.restoredState=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(Xp),Yp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).urlAfterRedirects=i,o}return _createClass(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(Xp),Qp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).reason=i,o}return _createClass(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(Xp),Jp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).error=i,o}return _createClass(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(Xp),Zp=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).urlAfterRedirects=i,a.state=o,a}return _createClass(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Xp),tv=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).urlAfterRedirects=i,a.state=o,a}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Xp),ev=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this,t,r)).urlAfterRedirects=i,s.state=o,s.shouldActivate=a,s}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(Xp),nv=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).urlAfterRedirects=i,a.state=o,a}return _createClass(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Xp),rv=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).urlAfterRedirects=i,a.state=o,a}return _createClass(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Xp),iv=function(){function t(e){_classCallCheck(this,t),this.route=e}return _createClass(t,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),t}(),ov=function(){function t(e){_classCallCheck(this,t),this.route=e}return _createClass(t,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),t}(),av=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),sv=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),uv=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),cv=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),lv=function(){function t(e,n,r){_classCallCheck(this,t),this.routerEvent=e,this.position=n,this.anchor=r}return _createClass(t,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),t}(),hv=((Hp=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||Hp)},Hp.\u0275cmp=be({type:Hp,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Ra(0,"router-outlet")},directives:function(){return[vg]},encapsulation:2}),Hp),fv=function(){function t(e){_classCallCheck(this,t),this.params=e||{}}return _createClass(t,[{key:"has",value:function(t){return this.params.hasOwnProperty(t)}},{key:"get",value:function(t){if(this.has(t)){var e=this.params[t];return Array.isArray(e)?e[0]:e}return null}},{key:"getAll",value:function(t){if(this.has(t)){var e=this.params[t];return Array.isArray(e)?e:[e]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),t}();function dv(t){return new fv(t)}function pv(t){var e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function vv(t,e,n){var r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;for(var i={},o=0;o<r.length;o++){var a=r[o],s=t[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}var mv=function t(e,n){_classCallCheck(this,t),this.routes=e,this.module=n};function gv(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<t.length;n++){var r=t[n];yv(r,bv(e,r))}}function yv(t,e){if(!t)throw new Error("\n      Invalid configuration of route '".concat(e,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(t))throw new Error("Invalid configuration of route '".concat(e,"': Array cannot be specified"));if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error("Invalid configuration of route '".concat(e,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(t.redirectTo&&t.children)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and children cannot be used together"));if(t.redirectTo&&t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and loadChildren cannot be used together"));if(t.children&&t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"': children and loadChildren cannot be used together"));if(t.redirectTo&&t.component)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and component cannot be used together"));if(t.path&&t.matcher)throw new Error("Invalid configuration of route '".concat(e,"': path and matcher cannot be used together"));if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===t.path&&void 0===t.matcher)throw new Error("Invalid configuration of route '".concat(e,"': routes must have either a path or a matcher specified"));if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error("Invalid configuration of route '".concat(e,"': path cannot start with a slash"));if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(e,'", redirectTo: "').concat(t.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error("Invalid configuration of route '".concat(e,"': pathMatch can only be set to 'prefix' or 'full'"));t.children&&gv(t.children,e)}function bv(t,e){return e?t||e.path?t&&!e.path?"".concat(t,"/"):!t&&e.path?e.path:"".concat(t,"/").concat(e.path):"":t}function _v(t){var e=t.children&&t.children.map(_v),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=hv),n}function wv(t,e){var n,r=Object.keys(t),i=Object.keys(e);if(!r||!i||r.length!=i.length)return!1;for(var o=0;o<r.length;o++)if(!xv(t[n=r[o]],e[n]))return!1;return!0}function xv(t,e){return Array.isArray(t)&&Array.isArray(e)?t.length==e.length&&t.every((function(t){return e.indexOf(t)>-1})):t===e}function Cv(t){return Array.prototype.concat.apply([],t)}function kv(t){return t.length>0?t[t.length-1]:null}function Ev(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Sv(t){return Fa(t)?t:Ma(t)?G(Promise.resolve(t)):Yd(t)}function Iv(t,e,n){return n?function(t,e){return wv(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!Ov(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every((function(n){return xv(t[n],e[n])}))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!Ov(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Ov(n.segments,i))return!1;for(var o in r.children){if(!n.children[o])return!1;if(!t(n.children[o],r.children[o]))return!1}return!0}var a=i.slice(0,n.segments.length),s=i.slice(n.segments.length);return!!Ov(n.segments,a)&&!!n.children.primary&&e(n.children.primary,r,s)}(e,n,n.segments)}(t.root,e.root)}var Tv=function(){function t(e,n,r){_classCallCheck(this,t),this.root=e,this.queryParams=n,this.fragment=r}return _createClass(t,[{key:"toString",value:function(){return Mv.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=dv(this.queryParams)),this._queryParamMap}}]),t}(),Av=function(){function t(e,n){var r=this;_classCallCheck(this,t),this.segments=e,this.children=n,this.parent=null,Ev(n,(function(t,e){return t.parent=r}))}return _createClass(t,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return Fv(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),t}(),Rv=function(){function t(e,n){_classCallCheck(this,t),this.path=e,this.parameters=n}return _createClass(t,[{key:"toString",value:function(){return zv(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=dv(this.parameters)),this._parameterMap}}]),t}();function Ov(t,e){return t.length===e.length&&t.every((function(t,n){return t.path===e[n].path}))}function Nv(t,e){var n=[];return Ev(t.children,(function(t,r){"primary"===r&&(n=n.concat(e(t,r)))})),Ev(t.children,(function(t,r){"primary"!==r&&(n=n.concat(e(t,r)))})),n}var Dv=function t(){_classCallCheck(this,t)},Pv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"parse",value:function(t){var e=new Kv(t);return new Tv(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}},{key:"serialize",value:function(t){var e,n,r;return"".concat("/".concat(function t(e,n){if(!e.hasChildren())return Fv(e);if(n){var r=e.children.primary?t(e.children.primary,!1):"",i=[];return Ev(e.children,(function(e,n){"primary"!==n&&i.push("".concat(n,":").concat(t(e,!1)))})),i.length>0?"".concat(r,"(").concat(i.join("//"),")"):r}var o=Nv(e,(function(n,r){return"primary"===r?[t(e.children.primary,!1)]:["".concat(r,":").concat(t(n,!1))]}));return"".concat(Fv(e),"/(").concat(o.join("//"),")")}(t.root,!0)),(n=t.queryParams,r=Object.keys(n).map((function(t){var e=n[t];return Array.isArray(e)?e.map((function(e){return"".concat(Bv(t),"=").concat(Bv(e))})).join("&"):"".concat(Bv(t),"=").concat(Bv(e))})),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof t.fragment?"#".concat((e=t.fragment,encodeURI(e))):"")}}]),t}(),Mv=new Pv;function Fv(t){return t.segments.map((function(t){return zv(t)})).join("/")}function Lv(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Bv(t){return Lv(t).replace(/%3B/gi,";")}function jv(t){return Lv(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vv(t){return decodeURIComponent(t)}function Uv(t){return Vv(t.replace(/\+/g,"%20"))}function zv(t){return"".concat(jv(t.path)).concat((e=t.parameters,Object.keys(e).map((function(t){return";".concat(jv(t),"=").concat(jv(e[t]))})).join("")));var e}var Wv=/^[^\/()?;=#]+/;function qv(t){var e=t.match(Wv);return e?e[0]:""}var Hv=/^[^=?&#]+/,Gv=/^[^?&#]+/,Kv=function(){function t(e){_classCallCheck(this,t),this.url=e,this.remaining=e}return _createClass(t,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Av([],{}):new Av([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());var e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Av(t,e)),n}},{key:"parseSegment",value:function(){var t=qv(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(t),new Rv(Vv(t),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var t={};this.consumeOptional(";");)this.parseParam(t);return t}},{key:"parseParam",value:function(t){var e=qv(this.remaining);if(e){this.capture(e);var n="";if(this.consumeOptional("=")){var r=qv(this.remaining);r&&(n=r,this.capture(n))}t[Vv(e)]=Vv(n)}}},{key:"parseQueryParam",value:function(t){var e=function(t){var e=t.match(Hv);return e?e[0]:""}(this.remaining);if(e){this.capture(e);var n="";if(this.consumeOptional("=")){var r=function(t){var e=t.match(Gv);return e?e[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=Uv(e),o=Uv(n);if(t.hasOwnProperty(i)){var a=t[i];Array.isArray(a)||(a=[a],t[i]=a),a.push(o)}else t[i]=o}}},{key:"parseParens",value:function(t){var e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=qv(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");var o=this.parseChildren();e[i]=1===Object.keys(o).length?o.primary:new Av([],o),this.consumeOptional("//")}return e}},{key:"peekStartsWith",value:function(t){return this.remaining.startsWith(t)}},{key:"consumeOptional",value:function(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}},{key:"capture",value:function(t){if(!this.consumeOptional(t))throw new Error('Expected "'.concat(t,'".'))}}]),t}(),Xv=function(){function t(e){_classCallCheck(this,t),this._root=e}return _createClass(t,[{key:"parent",value:function(t){var e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}},{key:"children",value:function(t){var e=$v(t,this._root);return e?e.children.map((function(t){return t.value})):[]}},{key:"firstChild",value:function(t){var e=$v(t,this._root);return e&&e.children.length>0?e.children[0].value:null}},{key:"siblings",value:function(t){var e=Yv(t,this._root);return e.length<2?[]:e[e.length-2].children.map((function(t){return t.value})).filter((function(e){return e!==t}))}},{key:"pathFromRoot",value:function(t){return Yv(t,this._root).map((function(t){return t.value}))}},{key:"root",get:function(){return this._root.value}}]),t}();function $v(t,e){if(t===e.value)return e;var n,r=_createForOfIteratorHelper(e.children);try{for(r.s();!(n=r.n()).done;){var i=$v(t,n.value);if(i)return i}}catch(o){r.e(o)}finally{r.f()}return null}function Yv(t,e){if(t===e.value)return[e];var n,r=_createForOfIteratorHelper(e.children);try{for(r.s();!(n=r.n()).done;){var i=Yv(t,n.value);if(i.length)return i.unshift(e),i}}catch(o){r.e(o)}finally{r.f()}return[]}var Qv=function(){function t(e,n){_classCallCheck(this,t),this.value=e,this.children=n}return _createClass(t,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),t}();function Jv(t){var e={};return t&&t.children.forEach((function(t){return e[t.value.outlet]=t})),e}var Zv=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).snapshot=r,om(_assertThisInitialized(i),t),i}return _createClass(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(Xv);function tm(t,e){var n=function(t,e){var n=new rm([],{},{},"",{},"primary",e,null,t.root,-1,{});return new im("",new Qv(n,[]))}(t,e),r=new Qd([new Rv("",{})]),i=new Qd({}),o=new Qd({}),a=new Qd({}),s=new Qd(""),u=new em(r,i,a,s,o,"primary",e,n.root);return u.snapshot=n.root,new Zv(new Qv(u,[]),n)}var em=function(){function t(e,n,r,i,o,a,s,u){_classCallCheck(this,t),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this._futureSnapshot=u}return _createClass(t,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(z((function(t){return dv(t)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(z((function(t){return dv(t)})))),this._queryParamMap}}]),t}();function nm(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=t.pathFromRoot,r=0;if("always"!==e)for(r=n.length-1;r>=1;){var i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(t){return t.reduce((function(t,e){return{params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(r))}var rm=function(){function t(e,n,r,i,o,a,s,u,c,l,h){_classCallCheck(this,t),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return _createClass(t,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(t){return t.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=dv(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=dv(this.queryParams)),this._queryParamMap}}]),t}(),im=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,r)).url=t,om(_assertThisInitialized(i),r),i}return _createClass(n,[{key:"toString",value:function(){return am(this._root)}}]),n}(Xv);function om(t,e){e.value._routerState=t,e.children.forEach((function(e){return om(t,e)}))}function am(t){var e=t.children.length>0?" { ".concat(t.children.map(am).join(", ")," } "):"";return"".concat(t.value).concat(e)}function sm(t){if(t.snapshot){var e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,wv(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),wv(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!wv(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),wv(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function um(t,e){return wv(t.params,e.params)&&function(t,e){return Ov(t,e)&&t.every((function(t,n){return wv(t.parameters,e[n].parameters)}))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||um(t.parent,e.parent))}function cm(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function lm(t,e,n,r,i){var o={};return r&&Ev(r,(function(t,e){o[e]=Array.isArray(t)?t.map((function(t){return"".concat(t)})):"".concat(t)})),new Tv(n.root===t?e:function t(e,n,r){var i={};return Ev(e.children,(function(e,o){i[o]=e===n?r:t(e,n,r)})),new Av(e.segments,i)}(n.root,t,e),o,i)}var hm=function(){function t(e,n,r){if(_classCallCheck(this,t),this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&cm(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find((function(t){return"object"==typeof t&&null!=t&&t.outlets}));if(i&&i!==kv(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(t,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),t}(),fm=function t(e,n,r){_classCallCheck(this,t),this.segmentGroup=e,this.processChildren=n,this.index=r};function dm(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:"".concat(t)}function pm(t,e,n){if(t||(t=new Av([],{})),0===t.segments.length&&t.hasChildren())return vm(t,e,n);var r=function(t,e,n){for(var r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};i<t.segments.length;){if(r>=n.length)return o;var a=t.segments[i],s=dm(n[r]),u=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!bm(s,u,a))return o;r+=2}else{if(!bm(s,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){var o=new Av(t.segments.slice(0,r.pathIndex),{});return o.children.primary=new Av(t.segments.slice(r.pathIndex),t.children),vm(o,0,i)}return r.match&&0===i.length?new Av(t.segments,{}):r.match&&!t.hasChildren()?mm(t,e,n):r.match?vm(t,0,i):mm(t,e,n)}function vm(t,e,n){if(0===n.length)return new Av(t.segments,{});var r=function(t){return"object"!=typeof t[0]?{primary:t}:void 0===t[0].outlets?{primary:t}:t[0].outlets}(n),i={};return Ev(r,(function(n,r){null!==n&&(i[r]=pm(t.children[r],e,n))})),Ev(t.children,(function(t,e){void 0===r[e]&&(i[e]=t)})),new Av(t.segments,i)}function mm(t,e,n){for(var r=t.segments.slice(0,e),i=0;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){var o=gm(n[i].outlets);return new Av(r,o)}if(0===i&&cm(n[0]))r.push(new Rv(t.segments[e].path,n[0])),i++;else{var a=dm(n[i]),s=i<n.length-1?n[i+1]:null;a&&s&&cm(s)?(r.push(new Rv(a,ym(s))),i+=2):(r.push(new Rv(a,{})),i++)}}return new Av(r,{})}function gm(t){var e={};return Ev(t,(function(t,n){null!==t&&(e[n]=mm(new Av([],{}),0,t))})),e}function ym(t){var e={};return Ev(t,(function(t,n){return e[n]="".concat(t)})),e}function bm(t,e,n){return t==n.path&&wv(e,n.parameters)}var _m=function(){function t(e,n,r,i){_classCallCheck(this,t),this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i}return _createClass(t,[{key:"activate",value:function(t){var e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),sm(this.futureState.root),this.activateChildRoutes(e,n,t)}},{key:"deactivateChildRoutes",value:function(t,e,n){var r=this,i=Jv(e);t.children.forEach((function(t){var e=t.value.outlet;r.deactivateRoutes(t,i[e],n),delete i[e]})),Ev(i,(function(t,e){r.deactivateRouteAndItsChildren(t,n)}))}},{key:"deactivateRoutes",value:function(t,e,n){var r=t.value,i=e?e.value:null;if(r===i)if(r.component){var o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}},{key:"deactivateRouteAndItsChildren",value:function(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}},{key:"detachAndStoreRouteSubtree",value:function(t,e){var n=e.getContext(t.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:r,route:t,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(t,e){var n=this,r=e.getContext(t.value.outlet);if(r){var i=Jv(t),o=t.value.component?r.children:e;Ev(i,(function(t,e){return n.deactivateRouteAndItsChildren(t,o)})),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(t,e,n){var r=this,i=Jv(e);t.children.forEach((function(t){r.activateRoutes(t,i[t.value.outlet],n),r.forwardEvent(new cv(t.value.snapshot))})),t.children.length&&this.forwardEvent(new sv(t.value.snapshot))}},{key:"activateRoutes",value:function(t,e,n){var r=t.value,i=e?e.value:null;if(sm(r),r===i)if(r.component){var o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,n);else if(r.component){var a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),wm(s.route)}else{var u=function(t){for(var e=t.parent;e;e=e.parent){var n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=c,a.outlet&&a.outlet.activateWith(r,c),this.activateChildRoutes(t,null,a.children)}}else this.activateChildRoutes(t,null,n)}}]),t}();function wm(t){sm(t.value),t.children.forEach(wm)}function xm(t){return"function"==typeof t}function Cm(t){return t instanceof Tv}var km=function t(e){_classCallCheck(this,t),this.segmentGroup=e||null},Em=function t(e){_classCallCheck(this,t),this.urlTree=e};function Sm(t){return new E((function(e){return e.error(new km(t))}))}function Im(t){return new E((function(e){return e.error(new Em(t))}))}function Tm(t){return new E((function(e){return e.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(t,"'")))}))}var Am=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(oe)}return _createClass(t,[{key:"apply",value:function(){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(z((function(e){return t.createUrlTree(e,t.urlTree.queryParams,t.urlTree.fragment)}))).pipe(xp((function(e){if(e instanceof Em)return t.allowRedirects=!1,t.match(e.urlTree);if(e instanceof km)throw t.noMatchError(e);throw e})))}},{key:"match",value:function(t){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(z((function(n){return e.createUrlTree(n,t.queryParams,t.fragment)}))).pipe(xp((function(t){if(t instanceof km)throw e.noMatchError(t);throw t})))}},{key:"noMatchError",value:function(t){return new Error("Cannot match any routes. URL Segment: '".concat(t.segmentGroup,"'"))}},{key:"createUrlTree",value:function(t,e,n){var r=t.segments.length>0?new Av([],{primary:t}):t;return new Tv(r,e,n)}},{key:"expandSegmentGroup",value:function(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(z((function(t){return new Av([],t)}))):this.expandSegment(t,n,e,n.segments,r,!0)}},{key:"expandChildren",value:function(t,e,n){var r=this;return function(n,i){if(0===Object.keys(n).length)return Yd({});var o=[],a=[],s={};return Ev(n,(function(n,i){var u,c,l=(u=i,c=n,r.expandSegmentGroup(t,e,c,u)).pipe(z((function(t){return s[i]=t})));"primary"===i?o.push(l):a.push(l)})),Yd.apply(null,o.concat(a)).pipe(ap(),wp(),z((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(t,e,n,r,i,o){var a=this;return Yd.apply(void 0,_toConsumableArray(n)).pipe(z((function(s){return a.expandSegmentAgainstRoute(t,e,n,s,r,i,o).pipe(xp((function(t){if(t instanceof km)return Yd(null);throw t})))})),ap(),Tp((function(t){return!!t})),xp((function(t,n){if(t instanceof Jd||"EmptyError"===t.name){if(a.noLeftoversInUrl(e,r,i))return Yd(new Av([],{}));throw new km(e)}throw t})))}},{key:"noLeftoversInUrl",value:function(t,e,n){return 0===e.length&&!t.children[n]}},{key:"expandSegmentAgainstRoute",value:function(t,e,n,r,i,o,a){return Dm(r)!==o?Sm(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Sm(e)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(t,e,n,r){var i=this,o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Im(o):this.lineralizeSegments(n,o).pipe(K((function(n){var o=new Av(n,{});return i.expandSegment(t,o,e,n,r,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(t,e,n,r,i,o){var a=this,s=Rm(e,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return Sm(e);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?Im(f):this.lineralizeSegments(r,f).pipe(K((function(r){return a.expandSegment(t,e,n,r.concat(i.slice(l)),o,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(t,e,n,r){var i=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(z((function(t){return n._loadedConfig=t,new Av(r,{})}))):Yd(new Av(r,{}));var o=Rm(e,n,r),a=o.matched,s=o.consumedSegments,u=o.lastChild;if(!a)return Sm(e);var c=r.slice(u);return this.getChildConfig(t,n,r).pipe(K((function(t){var n=t.module,r=t.routes,o=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some((function(n){return Nm(t,e,n)&&"primary"!==Dm(n)}))}(t,n,r)?{segmentGroup:Om(new Av(e,function(t,e){var n={};n.primary=e;var r,i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;""===o.path&&"primary"!==Dm(o)&&(n[Dm(o)]=new Av([],{}))}}catch(a){i.e(a)}finally{i.f()}return n}(r,new Av(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some((function(n){return Nm(t,e,n)}))}(t,n,r)?{segmentGroup:Om(new Av(t.segments,function(t,e,n,r){var i,o={},a=_createForOfIteratorHelper(n);try{for(a.s();!(i=a.n()).done;){var s=i.value;Nm(t,e,s)&&!r[Dm(s)]&&(o[Dm(s)]=new Av([],{}))}}catch(u){a.e(u)}finally{a.f()}return Object.assign(Object.assign({},r),o)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,s,c,r),a=o.segmentGroup,u=o.slicedSegments;return 0===u.length&&a.hasChildren()?i.expandChildren(n,r,a).pipe(z((function(t){return new Av(s,t)}))):0===r.length&&0===u.length?Yd(new Av(s,{})):i.expandSegment(n,a,r,u,"primary",!0).pipe(z((function(t){return new Av(s.concat(t.segments),t.children)})))})))}},{key:"getChildConfig",value:function(t,e,n){var r=this;return e.children?Yd(new mv(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Yd(e._loadedConfig):function(t,e,n){var r,i=e.canLoad;return i&&0!==i.length?G(i).pipe(z((function(r){var i,o=t.get(r);if(function(t){return t&&xm(t.canLoad)}(o))i=o.canLoad(e,n);else{if(!xm(o))throw new Error("Invalid CanLoad guard");i=o(e,n)}return Sv(i)}))).pipe(ap(),(r=function(t){return!0===t},function(t){return t.lift(new Ap(r,void 0,t))})):Yd(!0)}(t.injector,e,n).pipe(K((function(n){return n?r.configLoader.load(t.injector,e).pipe(z((function(t){return e._loadedConfig=t,t}))):function(t){return new E((function(e){return e.error(pv("Cannot load children because the guard of the route \"path: '".concat(t.path,"'\" returned false")))}))}(e)}))):Yd(new mv([],t))}},{key:"lineralizeSegments",value:function(t,e){for(var n=[],r=e.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Yd(n);if(r.numberOfChildren>1||!r.children.primary)return Tm(t.redirectTo);r=r.children.primary}}},{key:"applyRedirectCommands",value:function(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}},{key:"applyRedirectCreatreUrlTree",value:function(t,e,n,r){var i=this.createSegmentGroup(t,e.root,n,r);return new Tv(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}},{key:"createQueryParams",value:function(t,e){var n={};return Ev(t,(function(t,r){if("string"==typeof t&&t.startsWith(":")){var i=t.substring(1);n[r]=e[i]}else n[r]=t})),n}},{key:"createSegmentGroup",value:function(t,e,n,r){var i=this,o=this.createSegments(t,e.segments,n,r),a={};return Ev(e.children,(function(e,o){a[o]=i.createSegmentGroup(t,e,n,r)})),new Av(o,a)}},{key:"createSegments",value:function(t,e,n,r){var i=this;return e.map((function(e){return e.path.startsWith(":")?i.findPosParam(t,e,r):i.findOrReturn(e,n)}))}},{key:"findPosParam",value:function(t,e,n){var r=n[e.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(t,"'. Cannot find '").concat(e.path,"'."));return r}},{key:"findOrReturn",value:function(t,e){var n,r=0,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.path===t.path)return e.splice(r),o;r++}}catch(a){i.e(a)}finally{i.f()}return t}}]),t}();function Rm(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(e.matcher||vv)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Om(t){if(1===t.numberOfChildren&&t.children.primary){var e=t.children.primary;return new Av(t.segments.concat(e.segments),e.children)}return t}function Nm(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Dm(t){return t.outlet||"primary"}var Pm=function t(e){_classCallCheck(this,t),this.path=e,this.route=this.path[this.path.length-1]},Mm=function t(e,n){_classCallCheck(this,t),this.component=e,this.route=n};function Fm(t,e,n){var r=function(t){if(!t)return null;for(var e=t.parent;e;e=e.parent){var n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Lm(t,e,n){var r=Jv(t),i=t.value;Ev(r,(function(t,r){Lm(t,i.component?e?e.children.getContext(r):null:e,n)})),n.canDeactivateChecks.push(new Mm(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}var Bm=Symbol("INITIAL_VALUE");function jm(){return Op((function(t){return tp.apply(void 0,_toConsumableArray(t.map((function(t){return t.pipe(Ep(1),Mp(Bm))})))).pipe(Fp((function(t,e){var n=!1;return e.reduce((function(t,r,i){if(t!==Bm)return t;if(r===Bm&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Cm(r))return r}return t}),t)}),Bm),sp((function(t){return t!==Bm})),z((function(t){return Cm(t)?t:!0===t})),Ep(1))}))}function Vm(t,e){return null!==t&&e&&e(new uv(t)),Yd(!0)}function Um(t,e){return null!==t&&e&&e(new av(t)),Yd(!0)}function zm(t,e,n){var r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Yd(r.map((function(r){return op((function(){var i,o=Fm(r,e,n);if(function(t){return t&&xm(t.canActivate)}(o))i=Sv(o.canActivate(e,t));else{if(!xm(o))throw new Error("Invalid CanActivate guard");i=Sv(o(e,t))}return i.pipe(Tp())}))}))).pipe(jm()):Yd(!0)}function Wm(t,e,n){var r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map((function(t){return function(t){var e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)})).filter((function(t){return null!==t})).map((function(e){return op((function(){return Yd(e.guards.map((function(i){var o,a=Fm(i,e.node,n);if(function(t){return t&&xm(t.canActivateChild)}(a))o=Sv(a.canActivateChild(r,t));else{if(!xm(a))throw new Error("Invalid CanActivateChild guard");o=Sv(a(r,t))}return o.pipe(Tp())}))).pipe(jm())}))}));return Yd(i).pipe(jm())}var qm=function t(){_classCallCheck(this,t)},Hm=function(){function t(e,n,r,i,o,a){_classCallCheck(this,t),this.rootComponentType=e,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=a}return _createClass(t,[{key:"recognize",value:function(){try{var t=Xm(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new rm([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Qv(n,e),i=new im(this.url,r);return this.inheritParamsAndData(i._root),Yd(i)}catch(o){return new E((function(t){return t.error(o)}))}}},{key:"inheritParamsAndData",value:function(t){var e=this,n=t.value,r=nm(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),t.children.forEach((function(t){return e.inheritParamsAndData(t)}))}},{key:"processSegmentGroup",value:function(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}},{key:"processChildren",value:function(t,e){var n,r=this,i=Nv(e,(function(e,n){return r.processSegmentGroup(t,e,n)}));return n={},i.forEach((function(t){var e=n[t.value.outlet];if(e){var r=e.url.map((function(t){return t.toString()})).join("/"),i=t.value.url.map((function(t){return t.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(i,"'."))}n[t.value.outlet]=t.value})),i.sort((function(t,e){return"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)})),i}},{key:"processSegment",value:function(t,e,n,r){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;try{return this.processSegmentAgainstRoute(a,e,n,r)}catch(s){if(!(s instanceof qm))throw s}}}catch(u){o.e(u)}finally{o.f()}if(this.noLeftoversInUrl(e,n,r))return[];throw new qm}},{key:"noLeftoversInUrl",value:function(t,e,n){return 0===e.length&&!t.children[n]}},{key:"processSegmentAgainstRoute",value:function(t,e,n,r){if(t.redirectTo)throw new qm;if((t.outlet||"primary")!==r)throw new qm;var i,o=[],a=[];if("**"===t.path){var s=n.length>0?kv(n).parameters:{};i=new rm(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qm(t),r,t.component,t,Gm(e),Km(e)+n.length,Jm(t))}else{var u=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new qm;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(e.matcher||vv)(n,t,e);if(!r)throw new qm;var i={};Ev(r.posParams,(function(t,e){i[e]=t.path}));var o=r.consumed.length>0?Object.assign(Object.assign({},i),r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=u.consumedSegments,a=n.slice(u.lastChild),i=new rm(o,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qm(t),r,t.component,t,Gm(e),Km(e)+o.length,Jm(t))}var c=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),l=Xm(e,o,a,c,this.relativeLinkResolution),h=l.segmentGroup,f=l.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(c,h);return[new Qv(i,d)]}if(0===c.length&&0===f.length)return[new Qv(i,[])];var p=this.processSegment(c,h,f,"primary");return[new Qv(i,p)]}}]),t}();function Gm(t){for(var e=t;e._sourceSegment;)e=e._sourceSegment;return e}function Km(t){for(var e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;e._sourceSegment;)n+=(e=e._sourceSegment)._segmentIndexShift?e._segmentIndexShift:0;return n-1}function Xm(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some((function(n){return $m(t,e,n)&&"primary"!==Ym(n)}))}(t,n,r)){var o=new Av(e,function(t,e,n,r){var i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;var o,a=_createForOfIteratorHelper(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(""===s.path&&"primary"!==Ym(s)){var u=new Av([],{});u._sourceSegment=t,u._segmentIndexShift=e.length,i[Ym(s)]=u}}}catch(c){a.e(c)}finally{a.f()}return i}(t,e,r,new Av(n,t.children)));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some((function(n){return $m(t,e,n)}))}(t,n,r)){var a=new Av(t.segments,function(t,e,n,r,i,o){var a,s={},u=_createForOfIteratorHelper(r);try{for(u.s();!(a=u.n()).done;){var c=a.value;if($m(t,n,c)&&!i[Ym(c)]){var l=new Av([],{});l._sourceSegment=t,l._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[Ym(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(t,e,n,r,t.children,i));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}var s=new Av(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function $m(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function Ym(t){return t.outlet||"primary"}function Qm(t){return t.data||{}}function Jm(t){return t.resolve||{}}function Zm(t,e,n,r){var i=Fm(t,e,r);return Sv(i.resolve?i.resolve(e,n):i(e,n))}function tg(t){return function(e){return e.pipe(Op((function(e){var n=t(e);return n?G(n).pipe(z((function(){return e}))):G([e])})))}}var eg=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"shouldDetach",value:function(t){return!1}},{key:"store",value:function(t,e){}},{key:"shouldAttach",value:function(t){return!1}},{key:"retrieve",value:function(t){return null}},{key:"shouldReuseRoute",value:function(t,e){return t.routeConfig===e.routeConfig}}]),t}(),ng=new Ht("ROUTES"),rg=function(){function t(e,n,r,i){_classCallCheck(this,t),this.loader=e,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return _createClass(t,[{key:"load",value:function(t,e){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(z((function(r){n.onLoadEndListener&&n.onLoadEndListener(e);var i=r.create(t);return new mv(Cv(i.injector.get(ng)).map(_v),i)})))}},{key:"loadModuleFactory",value:function(t){var e=this;return"string"==typeof t?G(this.loader.load(t)):Sv(t()).pipe(K((function(t){return t instanceof ae?Yd(t):G(e.compiler.compileModuleAsync(t))})))}}]),t}(),ig=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"shouldProcessUrl",value:function(t){return!0}},{key:"extract",value:function(t){return t}},{key:"merge",value:function(t,e){return t}}]),t}();function og(t){throw t}function ag(t,e,n){return e.parse("/")}function sg(t,e){return Yd(null)}var ug,cg,lg,hg,fg=((ug=function(){function t(e,n,r,i,o,a,s,u){var c=this;_classCallCheck(this,t),this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new O,this.errorHandler=og,this.malformedUriErrorHandler=ag,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:sg,afterPreactivation:sg},this.urlHandlingStrategy=new ig,this.routeReuseStrategy=new eg,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=o.get(oe),this.console=o.get(uc);var l=o.get(xc);this.isNgZoneEnabled=l instanceof xc,this.resetConfig(u),this.currentUrlTree=new Tv(new Av([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new rg(a,s,(function(t){return c.triggerEvent(new iv(t))}),(function(t){return c.triggerEvent(new ov(t))})),this.routerState=tm(this.currentUrlTree,this.rootComponentType),this.transitions=new Qd({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(t,[{key:"setupNavigations",value:function(t){var e=this,n=this.events;return t.pipe(sp((function(t){return 0!==t.id})),z((function(t){return Object.assign(Object.assign({},t),{extractedUrl:e.urlHandlingStrategy.extract(t.rawUrl)})})),Op((function(t){var r,i,o,a=!1,s=!1;return Yd(t).pipe(Up((function(t){e.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:e.lastSuccessfulNavigation?Object.assign(Object.assign({},e.lastSuccessfulNavigation),{previousNavigation:null}):null}})),Op((function(t){var r,i,o,a,s=!e.navigated||t.extractedUrl.toString()!==e.browserUrlTree.toString();if(("reload"===e.onSameUrlNavigation||s)&&e.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Yd(t).pipe(Op((function(t){var r=e.transitions.getValue();return n.next(new $p(t.id,e.serializeUrl(t.extractedUrl),t.source,t.restoredState)),r!==e.transitions.getValue()?rp:[t]})),Op((function(t){return Promise.resolve(t)})),(r=e.ngModule.injector,i=e.configLoader,o=e.urlSerializer,a=e.config,function(t){return t.pipe(Op((function(t){return function(t,e,n,r,i){return new Am(t,e,n,r,i).apply()}(r,i,o,t.extractedUrl,a).pipe(z((function(e){return Object.assign(Object.assign({},t),{urlAfterRedirects:e})})))})))}),Up((function(t){e.currentNavigation=Object.assign(Object.assign({},e.currentNavigation),{finalUrl:t.urlAfterRedirects})})),function(t,n,r,i,o){return function(r){return r.pipe(K((function(r){return function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new Hm(t,e,n,r,i,o).recognize()}(t,n,r.urlAfterRedirects,(a=r.urlAfterRedirects,e.serializeUrl(a)),i,o).pipe(z((function(t){return Object.assign(Object.assign({},r),{targetSnapshot:t})})));var a})))}}(e.rootComponentType,e.config,0,e.paramsInheritanceStrategy,e.relativeLinkResolution),Up((function(t){"eager"===e.urlUpdateStrategy&&(t.extras.skipLocationChange||e.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),e.browserUrlTree=t.urlAfterRedirects)})),Up((function(t){var r=new Zp(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);n.next(r)})));if(s&&e.rawUrlTree&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){var u=t.id,c=t.extractedUrl,l=t.source,h=t.restoredState,f=t.extras,d=new $p(u,e.serializeUrl(c),l,h);n.next(d);var p=tm(c,e.rootComponentType).snapshot;return Yd(Object.assign(Object.assign({},t),{targetSnapshot:p,urlAfterRedirects:c,extras:Object.assign(Object.assign({},f),{skipLocationChange:!1,replaceUrl:!1})}))}return e.rawUrlTree=t.rawUrl,e.browserUrlTree=t.urlAfterRedirects,t.resolve(null),rp})),tg((function(t){var n=t.targetSnapshot,r=t.id,i=t.extractedUrl,o=t.rawUrl,a=t.extras,s=a.skipLocationChange,u=a.replaceUrl;return e.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})})),Up((function(t){var n=new tv(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})),z((function(t){return Object.assign(Object.assign({},t),{guards:(n=t.targetSnapshot,r=t.currentSnapshot,i=e.rootContexts,o=n._root,function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=Jv(n);return e.children.forEach((function(e){!function(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,s=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){var c=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Ov(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ov(t.url,e.url)||!wv(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!um(t,e)||!wv(t.queryParams,e.queryParams);case"paramsChange":default:return!um(t,e)}}(s,a,a.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new Pm(i)):(a.data=s.data,a._resolvedData=s._resolvedData),t(e,n,a.component?u?u.children:null:r,i,o),c&&o.canDeactivateChecks.push(new Mm(u&&u.outlet&&u.outlet.component||null,s))}else s&&Lm(n,u,o),o.canActivateChecks.push(new Pm(i)),t(e,null,a.component?u?u.children:null:r,i,o)}(e,a[e.value.outlet],r,i.concat([e.value]),o),delete a[e.value.outlet]})),Ev(a,(function(t,e){return Lm(t,r.getContext(e),o)})),o}(o,r?r._root:null,i,[o.value]))});var n,r,i,o})),function(t,e){return function(n){return n.pipe(K((function(n){var r=n.targetSnapshot,i=n.currentSnapshot,o=n.guards,a=o.canActivateChecks,s=o.canDeactivateChecks;return 0===s.length&&0===a.length?Yd(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return G(t).pipe(K((function(t){return function(t,e,n,r,i){var o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Yd(o.map((function(o){var a,s=Fm(o,e,i);if(function(t){return t&&xm(t.canDeactivate)}(s))a=Sv(s.canDeactivate(t,e,n,r));else{if(!xm(s))throw new Error("Invalid CanDeactivate guard");a=Sv(s(t,e,n,r))}return a.pipe(Tp())}))).pipe(jm()):Yd(!0)}(t.component,t.route,n,e,r)})),Tp((function(t){return!0!==t}),!0))}(s,r,i,t).pipe(K((function(n){return n&&"boolean"==typeof n?function(t,e,n,r){return G(e).pipe(jp((function(e){return G([Um(e.route.parent,r),Vm(e.route,r),Wm(t,e.path,n),zm(t,e.route,n)]).pipe(ap(),Tp((function(t){return!0!==t}),!0))})),Tp((function(t){return!0!==t}),!0))}(r,a,t,e):Yd(n)})),z((function(t){return Object.assign(Object.assign({},n),{guardsResult:t})})))})))}}(e.ngModule.injector,(function(t){return e.triggerEvent(t)})),Up((function(t){if(Cm(t.guardsResult)){var n=pv('Redirecting to "'.concat(e.serializeUrl(t.guardsResult),'"'));throw n.url=t.guardsResult,n}})),Up((function(t){var n=new ev(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);e.triggerEvent(n)})),sp((function(t){if(!t.guardsResult){e.resetUrlToCurrentUrlTree();var r=new Qp(t.id,e.serializeUrl(t.extractedUrl),"");return n.next(r),t.resolve(!1),!1}return!0})),tg((function(t){if(t.guards.canActivateChecks.length)return Yd(t).pipe(Up((function(t){var n=new nv(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})),(n=e.paramsInheritanceStrategy,r=e.ngModule.injector,function(t){return t.pipe(K((function(t){var e=t.targetSnapshot,i=t.guards.canActivateChecks;return i.length?G(i).pipe(jp((function(t){return function(t,e,n,r){return function(t,e,n,r){var i=Object.keys(t);if(0===i.length)return Yd({});if(1===i.length){var o=i[0];return Zm(t[o],e,n,r).pipe(z((function(t){return _defineProperty({},o,t)})))}var a={};return G(i).pipe(K((function(i){return Zm(t[i],e,n,r).pipe(z((function(t){return a[i]=t,t})))}))).pipe(wp(),z((function(){return a})))}(t._resolve,t,e,r).pipe(z((function(e){return t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),nm(t,n).resolve),null})))}(t.route,e,n,r)})),function(t,e){return arguments.length>=2?function(n){return x(Fp(t,e),hp(1),yp(e))(n)}:function(e){return x(Fp((function(e,n,r){return t(e,n,r+1)})),hp(1))(e)}}((function(t,e){return t})),z((function(e){return t}))):Yd(t)})))}),Up((function(t){var n=new rv(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})));var n,r})),tg((function(t){var n=t.targetSnapshot,r=t.id,i=t.extractedUrl,o=t.rawUrl,a=t.extras,s=a.skipLocationChange,u=a.replaceUrl;return e.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})})),z((function(t){var n=function(t,e,n){var r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){var i=r.value;i._futureSnapshot=n.value;var o=function(e,n,r){return n.children.map((function(n){var i,o=_createForOfIteratorHelper(r.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(e.shouldReuseRoute(a.value.snapshot,n.value))return t(e,n,a)}}catch(s){o.e(s)}finally{o.f()}return t(e,n)}))}(e,n,r);return new Qv(i,o)}var a=e.retrieve(n.value);if(a){var s=a.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(var r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,s),s}var u,c=new em(new Qd((u=n.value).url),new Qd(u.params),new Qd(u.queryParams),new Qd(u.fragment),new Qd(u.data),u.outlet,u.component,u),l=n.children.map((function(n){return t(e,n)}));return new Qv(c,l)}(t,e._root,n?n._root:void 0);return new Zv(r,e)}(e.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:n})})),Up((function(t){e.currentUrlTree=t.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(e.currentUrlTree,t.rawUrl),e.routerState=t.targetRouterState,"deferred"===e.urlUpdateStrategy&&(t.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),e.browserUrlTree=t.urlAfterRedirects)})),(r=e.rootContexts,i=e.routeReuseStrategy,o=function(t){return e.triggerEvent(t)},z((function(t){return new _m(i,t.targetRouterState,t.currentRouterState,o).activate(r),t}))),Up({next:function(){a=!0},complete:function(){a=!0}}),qp((function(){if(!a&&!s){e.resetUrlToCurrentUrlTree();var r=new Qp(t.id,e.serializeUrl(t.extractedUrl),"Navigation ID ".concat(t.id," is not equal to the current navigation id ").concat(e.navigationId));n.next(r),t.resolve(!1)}e.currentNavigation=null})),xp((function(r){if(s=!0,(u=r)&&u.ngNavigationCancelingError){var i=Cm(r.url);i||(e.navigated=!0,e.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));var o=new Qp(t.id,e.serializeUrl(t.extractedUrl),r.message);n.next(o),i?setTimeout((function(){var n=e.urlHandlingStrategy.merge(r.url,e.rawUrlTree);return e.scheduleNavigation(n,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})}),0):t.resolve(!1)}else{e.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);var a=new Jp(t.id,e.serializeUrl(t.extractedUrl),r);n.next(a);try{t.resolve(e.errorHandler(r))}catch(c){t.reject(c)}}var u;return rp})))})))}},{key:"resetRootComponentType",value:function(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}},{key:"setTransition",value:function(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var t=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(e){var n=t.parseUrl(e.url),r="popstate"===e.type?"popstate":"hashchange",i=e.state&&e.state.navigationId?e.state:null;setTimeout((function(){t.scheduleNavigation(n,r,i,{replaceUrl:!0})}),0)})))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(t){this.events.next(t)}},{key:"resetConfig",value:function(t){gv(t),this.config=t.map(_v),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.relativeTo,r=e.queryParams,i=e.fragment,o=e.preserveQueryParams,a=e.queryParamsHandling,s=e.preserveFragment;Sr()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,c=s?this.currentUrlTree.fragment:i,l=null;if(a)switch(a){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=o?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(t,e,n,r,i){if(0===n.length)return lm(e.root,e.root,e,r,i);var o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new hm(!0,0,t);var e=0,n=!1,r=t.reduce((function(t,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var o={};return Ev(r.outlets,(function(t,e){o[e]="string"==typeof t?t.split("/"):t})),[].concat(_toConsumableArray(t),[{outlets:o}])}if(r.segmentPath)return[].concat(_toConsumableArray(t),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(t),[r]):0===i?(r.split("/").forEach((function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))})),t):[].concat(_toConsumableArray(t),[r])}),[]);return new hm(n,e,r)}(n);if(o.toRoot())return lm(e.root,new Av([],{}),e,r,i);var a=function(t,e,n){if(t.isAbsolute)return new fm(e.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new fm(n.snapshot._urlSegment,!0,0);var r=cm(t.commands[0])?0:1;return function(t,e,n){for(var r=t,i=e,o=n;o>i;){if(o-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new fm(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(o,e,t),s=a.processChildren?vm(a.segmentGroup,a.index,o.commands):pm(a.segmentGroup,a.index,o.commands);return lm(a.segmentGroup,s,e,r,i)}(u,this.currentUrlTree,t,l,c)}},{key:"navigateByUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};Sr()&&this.isNgZoneEnabled&&!xc.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=Cm(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}},{key:"navigate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(t){for(var e=0;e<t.length;e++){var n=t[e];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(e))}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}},{key:"serializeUrl",value:function(t){return this.urlSerializer.serialize(t)}},{key:"parseUrl",value:function(t){var e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}},{key:"isActive",value:function(t,e){if(Cm(t))return Iv(this.currentUrlTree,t,e);var n=this.parseUrl(t);return Iv(this.currentUrlTree,n,e)}},{key:"removeEmptyProps",value:function(t){return Object.keys(t).reduce((function(e,n){var r=t[n];return null!=r&&(e[n]=r),e}),{})}},{key:"processNavigations",value:function(){var t=this;this.navigations.subscribe((function(e){t.navigated=!0,t.lastSuccessfulId=e.id,t.events.next(new Yp(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(t.currentUrlTree))),t.lastSuccessfulNavigation=t.currentNavigation,t.currentNavigation=null,e.resolve(!0)}),(function(e){t.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(t,e,n,r,i){var o,a,s,u=this.getTransition();if(u&&"imperative"!==e&&"imperative"===u.source&&u.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(u&&"hashchange"==e&&"popstate"===u.source&&u.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(u&&"popstate"==e&&"hashchange"===u.source&&u.rawUrl.toString()===t.toString())return Promise.resolve(!0);i?(o=i.resolve,a=i.reject,s=i.promise):s=new Promise((function(t,e){o=t,a=e}));var c=++this.navigationId;return this.setTransition({id:c,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:o,reject:a,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(t){return Promise.reject(t)}))}},{key:"setBrowserUrl",value:function(t,e,n,r){var i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}},{key:"resetStateAndUrl",value:function(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),t}()).\u0275fac=function(t){Ea()},ug.\u0275dir=Ee({type:ug}),ug),dg=function t(){_classCallCheck(this,t),this.outlet=null,this.route=null,this.resolver=null,this.children=new pg,this.attachRef=null},pg=function(){function t(){_classCallCheck(this,t),this.contexts=new Map}return _createClass(t,[{key:"onChildOutletCreated",value:function(t,e){var n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}},{key:"onChildOutletDestroyed",value:function(t){var e=this.getContext(t);e&&(e.outlet=null)}},{key:"onOutletDeactivated",value:function(){var t=this.contexts;return this.contexts=new Map,t}},{key:"onOutletReAttached",value:function(t){this.contexts=t}},{key:"getOrCreateContext",value:function(t){var e=this.getContext(t);return e||(e=new dg,this.contexts.set(t,e)),e}},{key:"getContext",value:function(t){return this.contexts.get(t)||null}}]),t}(),vg=((cg=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.parentContexts=e,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Nu,this.deactivateEvents=new Nu,this.name=i||"primary",e.onChildOutletCreated(this.name,this)}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var t=this.activated;return this.activated=null,this._activatedRoute=null,t}},{key:"attach",value:function(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}},{key:"deactivate",value:function(){if(this.activated){var t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}},{key:"activateWith",value:function(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;var n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new mg(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),t}()).\u0275fac=function(t){return new(t||cg)(Ca(pg),Ca(du),Ca(Vs),ka("name"),Ca(Wo))},cg.\u0275dir=Ee({type:cg,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),cg),mg=function(){function t(e,n,r){_classCallCheck(this,t),this.route=e,this.childContexts=n,this.parent=r}return _createClass(t,[{key:"get",value:function(t,e){return t===em?this.route:t===pg?this.childContexts:this.parent.get(t,e)}}]),t}(),gg=function t(){_classCallCheck(this,t)},yg=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"preload",value:function(t,e){return Yd(null)}}]),t}(),bg=((hg=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.router=e,this.injector=i,this.preloadingStrategy=o,this.loader=new rg(n,r,(function(t){return e.triggerEvent(new iv(t))}),(function(t){return e.triggerEvent(new ov(t))}))}return _createClass(t,[{key:"setUpPreloading",value:function(){var t=this;this.subscription=this.router.events.pipe(sp((function(t){return t instanceof Yp})),jp((function(){return t.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var t=this.injector.get(oe);return this.processRoutes(t,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(t,e){var n,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.loadChildren&&!o.canLoad&&o._loadedConfig){var a=o._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else o.loadChildren&&!o.canLoad?r.push(this.preloadConfig(t,o)):o.children&&r.push(this.processRoutes(t,o.children))}}catch(s){i.e(s)}finally{i.f()}return G(r).pipe(Y(),z((function(t){})))}},{key:"preloadConfig",value:function(t,e){var n=this;return this.preloadingStrategy.preload(e,(function(){return n.loader.load(t.injector,e).pipe(K((function(t){return e._loadedConfig=t,n.processRoutes(t.module,t.routes)})))}))}}]),t}()).\u0275fac=function(t){return new(t||hg)(te(fg),te(qc),te(yc),te(oa),te(gg))},hg.\u0275prov=mt({token:hg,factory:hg.\u0275fac}),hg),_g=((lg=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,t),this.router=e,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(t,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var t=this;return this.router.events.subscribe((function(e){e instanceof $p?(t.store[t.lastId]=t.viewportScroller.getScrollPosition(),t.lastSource=e.navigationTrigger,t.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Yp&&(t.lastId=e.id,t.scheduleScrollEvent(e,t.router.parseUrl(e.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var t=this;return this.router.events.subscribe((function(e){e instanceof lv&&(e.position?"top"===t.options.scrollPositionRestoration?t.viewportScroller.scrollToPosition([0,0]):"enabled"===t.options.scrollPositionRestoration&&t.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===t.options.anchorScrolling?t.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==t.options.scrollPositionRestoration&&t.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(t,e){this.router.triggerEvent(new lv(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),t}()).\u0275fac=function(t){Ea()},lg.\u0275dir=Ee({type:lg}),lg),wg=new Ht("ROUTER_CONFIGURATION"),xg=new Ht("ROUTER_FORROOT_GUARD"),Cg=[xl,{provide:Dv,useClass:Pv},{provide:fg,useFactory:function(t,e,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new fg(null,t,e,n,r,i,o,Cv(a));if(u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),s.errorHandler&&(l.errorHandler=s.errorHandler),s.malformedUriErrorHandler&&(l.malformedUriErrorHandler=s.malformedUriErrorHandler),s.enableTracing){var h=tl();l.events.subscribe((function(t){h.logGroup("Router Event: ".concat(t.constructor.name)),h.log(t.toString()),h.log(t),h.logGroupEnd()}))}return s.onSameUrlNavigation&&(l.onSameUrlNavigation=s.onSameUrlNavigation),s.paramsInheritanceStrategy&&(l.paramsInheritanceStrategy=s.paramsInheritanceStrategy),s.urlUpdateStrategy&&(l.urlUpdateStrategy=s.urlUpdateStrategy),s.relativeLinkResolution&&(l.relativeLinkResolution=s.relativeLinkResolution),l},deps:[Dv,pg,xl,oa,qc,yc,ng,wg,[function(){return function t(){_classCallCheck(this,t)}}(),new lt],[function(){return function t(){_classCallCheck(this,t)}}(),new lt]]},pg,{provide:em,useFactory:function(t){return t.routerState.root},deps:[fg]},{provide:qc,useClass:Kc},bg,yg,function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"preload",value:function(t,e){return e().pipe(xp((function(){return Yd(null)})))}}]),t}(),{provide:wg,useValue:{enableTracing:!1}}];function kg(){return new Fc("Router",fg)}var Eg,Sg=((Eg=function(){function t(e,n){_classCallCheck(this,t)}return _createClass(t,null,[{key:"forRoot",value:function(e,n){return{ngModule:t,providers:[Cg,Rg(e),{provide:xg,useFactory:Ag,deps:[[fg,new lt,new ft]]},{provide:wg,useValue:n||{}},{provide:pl,useFactory:Tg,deps:[rl,[new ct(bl),new lt],wg]},{provide:_g,useFactory:Ig,deps:[fg,uh,wg]},{provide:gg,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:yg},{provide:Fc,multi:!0,useFactory:kg},[Ng,{provide:tc,multi:!0,useFactory:Dg,deps:[Ng]},{provide:Fg,useFactory:Pg,deps:[Ng]},{provide:sc,multi:!0,useExisting:Fg}]]}}},{key:"forChild",value:function(e){return{ngModule:t,providers:[Rg(e)]}}}]),t}()).\u0275mod=Ce({type:Eg}),Eg.\u0275inj=gt({factory:function(t){return new(t||Eg)(te(xg,8),te(fg,8))}}),Eg);function Ig(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new _g(t,e,n)}function Tg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new wl(t,e):new _l(t,e)}function Ag(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Rg(t){return[{provide:aa,multi:!0,useValue:t},{provide:ng,multi:!0,useValue:t}]}var Og,Ng=((Og=function(){function t(e){_classCallCheck(this,t),this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new O}return _createClass(t,[{key:"appInitializer",value:function(){var t=this;return this.injector.get(al,Promise.resolve(null)).then((function(){var e=null,n=new Promise((function(t){return e=t})),r=t.injector.get(fg),i=t.injector.get(wg);if(t.isLegacyDisabled(i)||t.isLegacyEnabled(i))e(!0);else if("disabled"===i.initialNavigation)r.setUpLocationChangeListener(),e(!0);else{if("enabled"!==i.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(i.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return t.initNavigation?Yd(null):(t.initNavigation=!0,e(!0),t.resultOfPreactivationDone)},r.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(t){var e=this.injector.get(wg),n=this.injector.get(bg),r=this.injector.get(_g),i=this.injector.get(fg),o=this.injector.get(zc);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}},{key:"isLegacyDisabled",value:function(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}]),t}()).\u0275fac=function(t){return new(t||Og)(te(oa))},Og.\u0275prov=mt({token:Og,factory:Og.\u0275fac}),Og);function Dg(t){return t.appInitializer.bind(t)}function Pg(t){return t.bootstrapListener.bind(t)}var Mg,Fg=new Ht("Router Initializer"),Lg=((Mg=function t(){_classCallCheck(this,t),this.title="liga-futbol"}).\u0275fac=function(t){return new(t||Mg)},Mg.\u0275cmp=be({type:Mg,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&Ra(0,"router-outlet")},directives:[vg],styles:[""]}),Mg),Bg=function t(){_classCallCheck(this,t)};function jg(t,e){return{type:7,name:t,definitions:e,options:{}}}function Vg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:4,styles:e,timings:t}}function Ug(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:t,options:e}}function zg(t){return{type:6,styles:t,offset:null}}function Wg(t,e,n){return{type:0,name:t,styles:e,options:n}}function qg(t){return{type:5,steps:t}}function Hg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:1,expr:t,animation:e,options:n}}function Gg(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:9,options:t}}function Kg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:11,selector:t,animation:e,options:n}}function Xg(t){Promise.resolve(null).then(t)}var $g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,t),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=e+n}return _createClass(t,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(t){return t()})),this._onDoneFns=[])}},{key:"onStart",value:function(t){this._onStartFns.push(t)}},{key:"onDone",value:function(t){this._onDoneFns.push(t)}},{key:"onDestroy",value:function(t){this._onDestroyFns.push(t)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var t=this;Xg((function(){return t._onFinish()}))}},{key:"_onStart",value:function(){this._onStartFns.forEach((function(t){return t()})),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach((function(t){return t()})),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(t){}},{key:"getPosition",value:function(){return 0}},{key:"triggerCallback",value:function(t){var e="start"==t?this._onStartFns:this._onDoneFns;e.forEach((function(t){return t()})),e.length=0}}]),t}(),Yg=function(){function t(e){var n=this;_classCallCheck(this,t),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;var r=0,i=0,o=0,a=this.players.length;0==a?Xg((function(){return n._onFinish()})):this.players.forEach((function(t){t.onDone((function(){++r==a&&n._onFinish()})),t.onDestroy((function(){++i==a&&n._onDestroy()})),t.onStart((function(){++o==a&&n._onStart()}))})),this.totalTime=this.players.reduce((function(t,e){return Math.max(t,e.totalTime)}),0)}return _createClass(t,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(t){return t()})),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach((function(t){return t.init()}))}},{key:"onStart",value:function(t){this._onStartFns.push(t)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach((function(t){return t()})),this._onStartFns=[])}},{key:"onDone",value:function(t){this._onDoneFns.push(t)}},{key:"onDestroy",value:function(t){this._onDestroyFns.push(t)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach((function(t){return t.play()}))}},{key:"pause",value:function(){this.players.forEach((function(t){return t.pause()}))}},{key:"restart",value:function(){this.players.forEach((function(t){return t.restart()}))}},{key:"finish",value:function(){this._onFinish(),this.players.forEach((function(t){return t.finish()}))}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach((function(t){return t.destroy()})),this._onDestroyFns.forEach((function(t){return t()})),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach((function(t){return t.reset()})),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(t){var e=t*this.totalTime;this.players.forEach((function(t){var n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)}))}},{key:"getPosition",value:function(){var t=0;return this.players.forEach((function(e){var n=e.getPosition();t=Math.min(n,t)})),t}},{key:"beforeDestroy",value:function(){this.players.forEach((function(t){t.beforeDestroy&&t.beforeDestroy()}))}},{key:"triggerCallback",value:function(t){var e="start"==t?this._onStartFns:this._onDoneFns;e.forEach((function(t){return t()})),e.length=0}}]),t}();function Qg(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Jg(t){switch(t.length){case 0:return new $g;case 1:return t[0];default:return new Yg(t)}}function Zg(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=[],s=[],u=-1,c=null;if(r.forEach((function(t){var n=t.offset,r=n==u,l=r&&c||{};Object.keys(t).forEach((function(n){var r=n,s=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,a),s){case"!":s=i[n];break;case"*":s=o[n];break;default:s=e.normalizeStyleValue(n,r,s,a)}l[r]=s})),r||s.push(l),c=l,u=n})),a.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(a.join(l)))}return s}function ty(t,e,n,r){switch(e){case"start":t.onStart((function(){return r(n&&ey(n,"start",t))}));break;case"done":t.onDone((function(){return r(n&&ey(n,"done",t))}));break;case"destroy":t.onDestroy((function(){return r(n&&ey(n,"destroy",t))}))}}function ey(t,e,n){var r=n.totalTime,i=ny(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),o=t._data;return null!=o&&(i._data=o),i}function ny(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6?arguments[6]:void 0;return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function ry(t,e,n){var r;return t instanceof Map?(r=t.get(e))||t.set(e,r=n):(r=t[e])||(r=t[e]=n),r}function iy(t){var e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}var oy=function(t,e){return!1},ay=function(t,e){return!1},sy=function(t,e,n){return[]},uy=Qg();(uy||"undefined"!=typeof Element)&&(oy=function(t,e){return t.contains(e)},ay=function(){if(uy||Element.prototype.matches)return function(t,e){return t.matches(e)};var t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?function(t,n){return e.apply(t,[n])}:ay}(),sy=function(t,e,n){var r=[];if(n)r.push.apply(r,_toConsumableArray(t.querySelectorAll(e)));else{var i=t.querySelector(e);i&&r.push(i)}return r});var cy=null,ly=!1;function hy(t){cy||(cy=("undefined"!=typeof document?document.body:null)||{},ly=!!cy.style&&"WebkitAppearance"in cy.style);var e=!0;return cy.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(!(e=t in cy.style)&&ly)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in cy.style),e}var fy=ay,dy=oy,py=sy;function vy(t){var e={};return Object.keys(t).forEach((function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]})),e}var my,gy=((my=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"validateStyleProperty",value:function(t){return hy(t)}},{key:"matchesElement",value:function(t,e){return fy(t,e)}},{key:"containsElement",value:function(t,e){return dy(t,e)}},{key:"query",value:function(t,e,n){return py(t,e,n)}},{key:"computeStyle",value:function(t,e,n){return n||""}},{key:"animate",value:function(t,e,n,r,i){return arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&arguments[6],new $g(n,r)}}]),t}()).\u0275fac=function(t){return new(t||my)},my.\u0275prov=mt({token:my,factory:my.\u0275fac}),my),yy=function(){var t=function t(){_classCallCheck(this,t)};return t.NOOP=new gy,t}();function by(t){if("number"==typeof t)return t;var e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:_y(parseFloat(e[1]),e[2])}function _y(t,e){switch(e){case"s":return 1e3*t;default:return t}}function wy(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){var r,i=0,o="";if("string"==typeof t){var a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push('The provided timing value "'.concat(t,'" is invalid.')),{duration:0,delay:0,easing:""};r=_y(parseFloat(a[1]),a[2]);var s=a[3];null!=s&&(i=_y(parseFloat(s),a[4]));var u=a[5];u&&(o=u)}else r=t;if(!n){var c=!1,l=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&e.splice(l,0,'The provided timing value "'.concat(t,'" is invalid.'))}return{duration:r,delay:i,easing:o}}(t,e,n)}function xy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){e[n]=t[n]})),e}function Cy(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e)for(var r in t)n[r]=t[r];else xy(t,n);return n}function ky(t,e,n){return n?e+":"+n+";":""}function Ey(t){for(var e="",n=0;n<t.style.length;n++){var r=t.style.item(n);e+=ky(0,r,t.style.getPropertyValue(r))}for(var i in t.style)t.style.hasOwnProperty(i)&&!i.startsWith("_")&&(e+=ky(0,i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[i]));t.setAttribute("style",e)}function Sy(t,e,n){t.style&&(Object.keys(e).forEach((function(r){var i=Py(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]})),Qg()&&Ey(t))}function Iy(t,e){t.style&&(Object.keys(e).forEach((function(e){var n=Py(e);t.style[n]=""})),Qg()&&Ey(t))}function Ty(t){return Array.isArray(t)?1==t.length?t[0]:Ug(t):t}var Ay=new RegExp("{{\\s*(.+?)\\s*}}","g");function Ry(t){var e=[];if("string"==typeof t){for(var n;n=Ay.exec(t);)e.push(n[1]);Ay.lastIndex=0}return e}function Oy(t,e,n){var r=t.toString(),i=r.replace(Ay,(function(t,r){var i=e[r];return e.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()}));return i==r?t:i}function Ny(t){for(var e=[],n=t.next();!n.done;)e.push(n.value),n=t.next();return e}var Dy=/-+([a-z0-9])/g;function Py(t){return t.replace(Dy,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[1].toUpperCase()}))}function My(t,e){return 0===t||0===e}function Fy(t,e,n){var r=Object.keys(n);if(r.length&&e.length){var i=e[0],o=[];if(r.forEach((function(t){i.hasOwnProperty(t)||o.push(t),i[t]=n[t]})),o.length)for(var a=function(){var n=e[s];o.forEach((function(e){n[e]=By(t,e)}))},s=1;s<e.length;s++)a()}return e}function Ly(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error("Unable to resolve animation metadata node #".concat(e.type))}}function By(t,e){return window.getComputedStyle(t)[e]}var jy=new Set(["true","1"]),Vy=new Set(["false","0"]);function Uy(t,e){var n=jy.has(t)||Vy.has(t),r=jy.has(e)||Vy.has(e);return function(i,o){var a="*"==t||t==i,s="*"==e||e==o;return!a&&n&&"boolean"==typeof i&&(a=i?jy.has(t):Vy.has(t)),!s&&r&&"boolean"==typeof o&&(s=o?jy.has(e):Vy.has(e)),a&&s}}var zy=new RegExp("s*:selfs*,?","g");function Wy(t,e,n){return new qy(t).build(e,n)}var qy=function(){function t(e){_classCallCheck(this,t),this._driver=e}return _createClass(t,[{key:"build",value:function(t,e){var n=new Hy(e);return this._resetContextStyleTimingState(n),Ly(this,Ty(t),n)}},{key:"_resetContextStyleTimingState",value:function(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}},{key:"visitTrigger",value:function(t,e){var n=this,r=e.queryCount=0,i=e.depCount=0,o=[],a=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach((function(t){if(n._resetContextStyleTimingState(e),0==t.type){var s=t,u=s.name;u.toString().split(/\s*,\s*/).forEach((function(t){s.name=t,o.push(n.visitState(s,e))})),s.name=u}else if(1==t.type){var c=n.visitTransition(t,e);r+=c.queryCount,i+=c.depCount,a.push(c)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")})),{type:7,name:t.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(t,e){var n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){var i=new Set,o=r||{};if(n.styles.forEach((function(t){if(Gy(t)){var e=t;Object.keys(e).forEach((function(t){Ry(e[t]).forEach((function(t){o.hasOwnProperty(t)||i.add(t)}))}))}})),i.size){var a=Ny(i.values());e.errors.push('state("'.concat(t.name,'", ...) must define default values for all the following style substitutions: ').concat(a.join(", ")))}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(t,e){e.queryCount=0,e.depCount=0;var n,r,i,o=Ly(this,Ty(t.animation),e);return{type:1,matchers:(n=t.expr,r=e.errors,i=[],"string"==typeof n?n.split(/\s*,\s*/).forEach((function(t){return function(t,e,n){if(":"==t[0]){var r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(t,e){return parseFloat(e)>parseFloat(t)};case":decrement":return function(t,e){return parseFloat(e)<parseFloat(t)};default:return e.push('The transition alias value "'.concat(t,'" is not supported')),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}var i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(t,'" is not supported')),e;var o=i[1],a=i[2],s=i[3];e.push(Uy(o,s)),"<"!=a[0]||"*"==o&&"*"==s||e.push(Uy(s,o))}(t,i,r)})):i.push(n),i),animation:o,queryCount:e.queryCount,depCount:e.depCount,options:Ky(t.options)}}},{key:"visitSequence",value:function(t,e){var n=this;return{type:2,steps:t.steps.map((function(t){return Ly(n,t,e)})),options:Ky(t.options)}}},{key:"visitGroup",value:function(t,e){var n=this,r=e.currentTime,i=0,o=t.steps.map((function(t){e.currentTime=r;var o=Ly(n,t,e);return i=Math.max(i,e.currentTime),o}));return e.currentTime=i,{type:3,steps:o,options:Ky(t.options)}}},{key:"visitAnimate",value:function(t,e){var n,r=function(t,e){var n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return Xy(wy(t,e).duration,0,"");var r=t;if(r.split(/\s+/).some((function(t){return"{"==t.charAt(0)&&"{"==t.charAt(1)}))){var i=Xy(0,0,"");return i.dynamic=!0,i.strValue=r,i}return Xy((n=n||wy(r,e)).duration,n.delay,n.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;var i=t.styles?t.styles:zg({});if(5==i.type)n=this.visitKeyframes(i,e);else{var o=t.styles,a=!1;if(!o){a=!0;var s={};r.easing&&(s.easing=r.easing),o=zg(s)}e.currentTime+=r.duration+r.delay;var u=this.visitStyle(o,e);u.isEmptyStep=a,n=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:n,options:null}}},{key:"visitStyle",value:function(t,e){var n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}},{key:"_makeStyleAst",value:function(t,e){var n=[];Array.isArray(t.styles)?t.styles.forEach((function(t){"string"==typeof t?"*"==t?n.push(t):e.errors.push("The provided style string value ".concat(t," is not allowed.")):n.push(t)})):n.push(t.styles);var r=!1,i=null;return n.forEach((function(t){if(Gy(t)){var e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(var o in e)if(e[o].toString().indexOf("{{")>=0){r=!0;break}}})),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(t,e){var n=this,r=e.currentAnimateTimings,i=e.currentTime,o=e.currentTime;r&&o>0&&(o-=r.duration+r.delay),t.styles.forEach((function(t){"string"!=typeof t&&Object.keys(t).forEach((function(r){if(n._driver.validateStyleProperty(r)){var a,s,u,c,l,h=e.collectedStyles[e.currentQuerySelector],f=h[r],d=!0;f&&(o!=i&&o>=f.startTime&&i<=f.endTime&&(e.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(f.startTime,'ms" and "').concat(f.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(o,'ms" and "').concat(i,'ms"')),d=!1),o=f.startTime),d&&(h[r]={startTime:o,endTime:i}),e.options&&(a=t[r],s=e.options,u=e.errors,c=s.params||{},(l=Ry(a)).length&&l.forEach((function(t){c.hasOwnProperty(t)||u.push("Unable to resolve the local animation param ".concat(t," in the given list of values"))})))}else e.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))}))}))}},{key:"visitKeyframes",value:function(t,e){var n=this,r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,o=[],a=!1,s=!1,u=0,c=t.steps.map((function(t){var r=n._makeStyleAst(t,e),c=null!=r.offset?r.offset:function(t){if("string"==typeof t)return null;var e=null;if(Array.isArray(t))t.forEach((function(t){if(Gy(t)&&t.hasOwnProperty("offset")){var n=t;e=parseFloat(n.offset),delete n.offset}}));else if(Gy(t)&&t.hasOwnProperty("offset")){var n=t;e=parseFloat(n.offset),delete n.offset}return e}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,a=a||l<u,u=l,o.push(l),r}));s&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),a&&e.errors.push("Please ensure that all keyframe offsets are in order");var l=t.steps.length,h=0;i>0&&i<l?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=e.currentTime,p=e.currentAnimateTimings,v=p.duration;return c.forEach((function(t,i){var a=h>0?i==f?1:h*i:o[i],s=a*v;e.currentTime=d+p.delay+s,p.duration=s,n._validateStyleAst(t,e),t.offset=a,r.styles.push(t)})),r}},{key:"visitReference",value:function(t,e){return{type:8,animation:Ly(this,Ty(t.animation),e),options:Ky(t.options)}}},{key:"visitAnimateChild",value:function(t,e){return e.depCount++,{type:9,options:Ky(t.options)}}},{key:"visitAnimateRef",value:function(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Ky(t.options)}}},{key:"visitQuery",value:function(t,e){var n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;var i=_slicedToArray(function(t){var e=!!t.split(/\s*,\s*/).find((function(t){return":self"==t}));return e&&(t=t.replace(zy,"")),[t=t.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,(function(t){return".ng-trigger-"+t.substr(1)})).replace(/:animating/g,".ng-animating"),e]}(t.selector),2),o=i[0],a=i[1];e.currentQuerySelector=n.length?n+" "+o:o,ry(e.collectedStyles,e.currentQuerySelector,{});var s=Ly(this,Ty(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:s,originalSelector:t.selector,options:Ky(t.options)}}},{key:"visitStagger",value:function(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");var n="full"===t.timings?{duration:0,delay:0,easing:"full"}:wy(t.timings,e.errors,!0);return{type:12,animation:Ly(this,Ty(t.animation),e),timings:n,options:null}}}]),t}(),Hy=function t(e){_classCallCheck(this,t),this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function Gy(t){return!Array.isArray(t)&&"object"==typeof t}function Ky(t){var e;return t?(t=xy(t)).params&&(t.params=(e=t.params)?xy(e):null):t={},t}function Xy(t,e,n){return{duration:t,delay:e,easing:n}}function $y(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:s}}var Yy=function(){function t(){_classCallCheck(this,t),this._map=new Map}return _createClass(t,[{key:"consume",value:function(t){var e=this._map.get(t);return e?this._map.delete(t):e=[],e}},{key:"append",value:function(t,e){var n,r=this._map.get(t);r||this._map.set(t,r=[]),(n=r).push.apply(n,_toConsumableArray(e))}},{key:"has",value:function(t){return this._map.has(t)}},{key:"clear",value:function(){this._map.clear()}}]),t}(),Qy=new RegExp(":enter","g"),Jy=new RegExp(":leave","g");function Zy(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new tb).buildKeyframes(t,e,n,r,i,o,a,s,u,c)}var tb=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"buildKeyframes",value:function(t,e,n,r,i,o,a,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new Yy;var l=new nb(t,e,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([o],null,l.errors,s),Ly(this,n,l);var h=l.timelines.filter((function(t){return t.containsAnimation()}));if(h.length&&Object.keys(a).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([a],null,l.errors,s)}return h.length?h.map((function(t){return t.buildKeyframes()})):[$y(e,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(t,e){}},{key:"visitState",value:function(t,e){}},{key:"visitTransition",value:function(t,e){}},{key:"visitAnimateChild",value:function(t,e){var n=e.subInstructions.consume(e.element);if(n){var r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}},{key:"visitAnimateRef",value:function(t,e){var n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}},{key:"_visitSubInstructions",value:function(t,e,n){var r=e.currentTimeline.currentTime,i=null!=n.duration?by(n.duration):null,o=null!=n.delay?by(n.delay):null;return 0!==i&&t.forEach((function(t){var n=e.appendInstructionToTimeline(t,i,o);r=Math.max(r,n.duration+n.delay)})),r}},{key:"visitReference",value:function(t,e){e.updateOptions(t.options,!0),Ly(this,t.animation,e),e.previousNode=t}},{key:"visitSequence",value:function(t,e){var n=this,r=e.subContextCount,i=e,o=t.options;if(o&&(o.params||o.delay)&&((i=e.createSubContext(o)).transformIntoNewTimeline(),null!=o.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=eb);var a=by(o.delay);i.delayNextStep(a)}t.steps.length&&(t.steps.forEach((function(t){return Ly(n,t,i)})),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=t}},{key:"visitGroup",value:function(t,e){var n=this,r=[],i=e.currentTimeline.currentTime,o=t.options&&t.options.delay?by(t.options.delay):0;t.steps.forEach((function(a){var s=e.createSubContext(t.options);o&&s.delayNextStep(o),Ly(n,a,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)})),r.forEach((function(t){return e.currentTimeline.mergeTimelineCollectedStyles(t)})),e.transformIntoNewTimeline(i),e.previousNode=t}},{key:"_visitTiming",value:function(t,e){if(t.dynamic){var n=t.strValue;return wy(e.params?Oy(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}},{key:"visitAnimate",value:function(t,e){var n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());var i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}},{key:"visitStyle",value:function(t,e){var n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}},{key:"visitKeyframes",value:function(t,e){var n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,o=e.createSubContext().currentTimeline;o.easing=n.easing,t.styles.forEach((function(t){o.forwardTime((t.offset||0)*i),o.setStyles(t.styles,t.easing,e.errors,e.options),o.applyStylesToKeyframe()})),e.currentTimeline.mergeTimelineCollectedStyles(o),e.transformIntoNewTimeline(r+i),e.previousNode=t}},{key:"visitQuery",value:function(t,e){var n=this,r=e.currentTimeline.currentTime,i=t.options||{},o=i.delay?by(i.delay):0;o&&(6===e.previousNode.type||0==r&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=eb);var a=r,s=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=s.length;var u=null;s.forEach((function(r,i){e.currentQueryIndex=i;var s=e.createSubContext(t.options,r);o&&s.delayNextStep(o),r===e.element&&(u=s.currentTimeline),Ly(n,t.animation,s),s.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,s.currentTimeline.currentTime)})),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}},{key:"visitStagger",value:function(t,e){var n=e.parentContext,r=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),a=o*(e.currentQueryTotal-1),s=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=a-s;break;case"full":s=n.currentStaggerTime}var u=e.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;Ly(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),t}(),eb={},nb=function(){function t(e,n,r,i,o,a,s,u){_classCallCheck(this,t),this._driver=e,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=eb,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new rb(this._driver,n,0),s.push(this.currentTimeline)}return _createClass(t,[{key:"updateOptions",value:function(t,e){var n=this;if(t){var r=t,i=this.options;null!=r.duration&&(i.duration=by(r.duration)),null!=r.delay&&(i.delay=by(r.delay));var o=r.params;if(o){var a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach((function(t){e&&a.hasOwnProperty(t)||(a[t]=Oy(o[t],a,n.errors))}))}}}},{key:"_copyOptions",value:function(){var t={};if(this.options){var e=this.options.params;if(e){var n=t.params={};Object.keys(e).forEach((function(t){n[t]=e[t]}))}}return t}},{key:"createSubContext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,o=new t(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}},{key:"transformIntoNewTimeline",value:function(t){return this.previousNode=eb,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(t,e,n){var r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new ib(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}},{key:"delayNextStep",value:function(t){t>0&&this.currentTimeline.delayNextStep(t)}},{key:"invokeQuery",value:function(t,e,n,r,i,o){var a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(Qy,"."+this._enterClassName)).replace(Jy,"."+this._leaveClassName);var s=this._driver.query(this.element,t,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),a.push.apply(a,_toConsumableArray(s))}return i||0!=a.length||o.push('`query("'.concat(e,'")` returned zero elements. (Use `query("').concat(e,'", { optional: true })` if you wish to allow this.)')),a}},{key:"params",get:function(){return this.options.params}}]),t}(),rb=function(){function t(e,n,r,i){_classCallCheck(this,t),this._driver=e,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return _createClass(t,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"delayNextStep",value:function(t){var e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}},{key:"fork",value:function(e,n){return this.applyStylesToKeyframe(),new t(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}},{key:"_updateStyle",value:function(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(t){var e=this;t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach((function(t){e._backFill[t]=e._globalTimelineStyles[t]||"*",e._currentKeyframe[t]="*"})),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(t,e,n,r){var i=this;e&&(this._previousKeyframe.easing=e);var o=r&&r.params||{},a=function(t,e){var n,r={};return t.forEach((function(t){"*"===t?(n=n||Object.keys(e)).forEach((function(t){r[t]="*"})):Cy(t,!1,r)})),r}(t,this._globalTimelineStyles);Object.keys(a).forEach((function(t){var e=Oy(a[t],o,n);i._pendingStyles[t]=e,i._localTimelineStyles.hasOwnProperty(t)||(i._backFill[t]=i._globalTimelineStyles.hasOwnProperty(t)?i._globalTimelineStyles[t]:"*"),i._updateStyle(t,e)}))}},{key:"applyStylesToKeyframe",value:function(){var t=this,e=this._pendingStyles,n=Object.keys(e);0!=n.length&&(this._pendingStyles={},n.forEach((function(n){t._currentKeyframe[n]=e[n]})),Object.keys(this._localTimelineStyles).forEach((function(e){t._currentKeyframe.hasOwnProperty(e)||(t._currentKeyframe[e]=t._localTimelineStyles[e])})))}},{key:"snapshotCurrentStyles",value:function(){var t=this;Object.keys(this._localTimelineStyles).forEach((function(e){var n=t._localTimelineStyles[e];t._pendingStyles[e]=n,t._updateStyle(e,n)}))}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"mergeTimelineCollectedStyles",value:function(t){var e=this;Object.keys(t._styleSummary).forEach((function(n){var r=e._styleSummary[n],i=t._styleSummary[n];(!r||i.time>r.time)&&e._updateStyle(n,i.value)}))}},{key:"buildKeyframes",value:function(){var t=this;this.applyStylesToKeyframe();var e=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach((function(o,a){var s=Cy(o,!0);Object.keys(s).forEach((function(t){var r=s[t];"!"==r?e.add(t):"*"==r&&n.add(t)})),r||(s.offset=a/t.duration),i.push(s)}));var o=e.size?Ny(e.values()):[],a=n.size?Ny(n.values()):[];if(r){var s=i[0],u=xy(s);s.offset=0,u.offset=1,i=[s,u]}return $y(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"properties",get:function(){var t=[];for(var e in this._currentKeyframe)t.push(e);return t}}]),t}(),ib=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,n),(u=e.call(this,t,r,s.delay)).element=r,u.keyframes=i,u.preStyleProps=o,u.postStyleProps=a,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return _createClass(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var t=this.keyframes,e=this.timings,n=e.delay,r=e.duration,i=e.easing;if(this._stretchStartingKeyframe&&n){var o=[],a=r+n,s=n/a,u=Cy(t[0],!1);u.offset=0,o.push(u);var c=Cy(t[0],!1);c.offset=ob(s),o.push(c);for(var l=t.length-1,h=1;h<=l;h++){var f=Cy(t[h],!1);f.offset=ob((n+f.offset*r)/a),o.push(f)}r=a,n=0,i="",t=o}return $y(this.element,t,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(rb);function ob(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,e-1);return Math.round(t*n)/n}var ab=function t(){_classCallCheck(this,t)},sb=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"normalizePropertyName",value:function(t,e){return Py(t)}},{key:"normalizeStyleValue",value:function(t,e,n,r){var i="",o=n.toString().trim();if(ub[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push("Please provide a CSS unit value for ".concat(t,":").concat(n))}return o+i}}]),n}(ab),ub=function(t){var e={};return t.forEach((function(t){return e[t]=!0})),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function cb(t,e,n,r,i,o,a,s,u,c,l,h,f){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:a,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var lb={},hb=function(){function t(e,n,r){_classCallCheck(this,t),this._triggerName=e,this.ast=n,this._stateStyles=r}return _createClass(t,[{key:"match",value:function(t,e,n,r){return function(t,e,n,r,i){return t.some((function(t){return t(e,n,r,i)}))}(this.ast.matchers,t,e,n,r)}},{key:"buildStyles",value:function(t,e,n){var r=this._stateStyles["*"],i=this._stateStyles[t],o=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):o}},{key:"build",value:function(t,e,n,r,i,o,a,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||lb,f=this.buildStyles(n,a&&a.params||lb,l),d=s&&s.params||lb,p=this.buildStyles(r,d,l),v=new Set,m=new Map,g=new Map,y="void"===r,b={params:Object.assign(Object.assign({},h),d)},_=c?[]:Zy(t,e,this.ast.animation,i,o,f,p,b,u,l),w=0;if(_.forEach((function(t){w=Math.max(t.duration+t.delay,w)})),l.length)return cb(e,this._triggerName,n,r,y,f,p,[],[],m,g,w,l);_.forEach((function(t){var n=t.element,r=ry(m,n,{});t.preStyleProps.forEach((function(t){return r[t]=!0}));var i=ry(g,n,{});t.postStyleProps.forEach((function(t){return i[t]=!0})),n!==e&&v.add(n)}));var x=Ny(v.values());return cb(e,this._triggerName,n,r,y,f,p,_,x,m,g,w)}}]),t}(),fb=function(){function t(e,n){_classCallCheck(this,t),this.styles=e,this.defaultParams=n}return _createClass(t,[{key:"buildStyles",value:function(t,e){var n={},r=xy(this.defaultParams);return Object.keys(t).forEach((function(e){var n=t[e];null!=n&&(r[e]=n)})),this.styles.styles.forEach((function(t){if("string"!=typeof t){var i=t;Object.keys(i).forEach((function(t){var o=i[t];o.length>1&&(o=Oy(o,r,e)),n[t]=o}))}})),n}}]),t}(),db=function(){function t(e,n){var r=this;_classCallCheck(this,t),this.name=e,this.ast=n,this.transitionFactories=[],this.states={},n.states.forEach((function(t){r.states[t.name]=new fb(t.style,t.options&&t.options.params||{})})),pb(this.states,"true","1"),pb(this.states,"false","0"),n.transitions.forEach((function(t){r.transitionFactories.push(new hb(e,t,r.states))})),this.fallbackTransition=new hb(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(t,e){return!0}],options:null,queryCount:0,depCount:0},this.states)}return _createClass(t,[{key:"matchTransition",value:function(t,e,n,r){return this.transitionFactories.find((function(i){return i.match(t,e,n,r)}))||null}},{key:"matchStyles",value:function(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}},{key:"containsQueries",get:function(){return this.ast.queryCount>0}}]),t}();function pb(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}var vb=new Yy,mb=function(){function t(e,n,r){_classCallCheck(this,t),this.bodyNode=e,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return _createClass(t,[{key:"register",value:function(t,e){var n=[],r=Wy(this._driver,e,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[t]=r}},{key:"_buildPlayer",value:function(t,e,n){var r=t.element,i=Zg(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}},{key:"create",value:function(t,e){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],a=this._animations[t],s=new Map;if(a?(n=Zy(this._driver,e,a,"ng-enter","ng-leave",{},{},i,vb,o)).forEach((function(t){var e=ry(s,t.element,{});t.postStyleProps.forEach((function(t){return e[t]=null}))})):(o.push("The requested animation doesn't exist or has already been destroyed"),n=[]),o.length)throw new Error("Unable to create the animation due to the following errors: ".concat(o.join("\n")));s.forEach((function(t,e){Object.keys(t).forEach((function(n){t[n]=r._driver.computeStyle(e,n,"*")}))}));var u=Jg(n.map((function(t){var e=s.get(t.element);return r._buildPlayer(t,{},e)})));return this._playersById[t]=u,u.onDestroy((function(){return r.destroy(t)})),this.players.push(u),u}},{key:"destroy",value:function(t){var e=this._getPlayer(t);e.destroy(),delete this._playersById[t];var n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(t){var e=this._playersById[t];if(!e)throw new Error("Unable to find the timeline player referenced by ".concat(t));return e}},{key:"listen",value:function(t,e,n,r){var i=ny(e,"","","");return ty(this._getPlayer(t),n,i,r),function(){}}},{key:"command",value:function(t,e,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}else this.create(t,e,r[0]||{});else this.register(t,r[0])}}]),t}(),gb=[],yb={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bb={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},_b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_classCallCheck(this,t),this.namespaceId=n;var r,i=e&&e.hasOwnProperty("value");if(this.value=null!=(r=i?e.value:e)?r:null,i){var o=xy(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}return _createClass(t,[{key:"absorbOptions",value:function(t){var e=t.params;if(e){var n=this.options.params;Object.keys(e).forEach((function(t){null==n[t]&&(n[t]=e[t])}))}}},{key:"params",get:function(){return this.options.params}}]),t}(),wb=new _b("void"),xb=function(){function t(e,n,r){_classCallCheck(this,t),this.id=e,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ab(n,this._hostClassName)}return _createClass(t,[{key:"listen",value:function(t,e,n,r){var i,o=this;if(!this._triggers.hasOwnProperty(e))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(e,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(e,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(e,'" is not supported!'));var a=ry(this._elementListeners,t,[]),s={name:e,phase:n,callback:r};a.push(s);var u=ry(this._engine.statesByElement,t,{});return u.hasOwnProperty(e)||(Ab(t,"ng-trigger"),Ab(t,"ng-trigger-"+e),u[e]=wb),function(){o._engine.afterFlush((function(){var t=a.indexOf(s);t>=0&&a.splice(t,1),o._triggers[e]||delete u[e]}))}}},{key:"register",value:function(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}},{key:"_getTrigger",value:function(t){var e=this._triggers[t];if(!e)throw new Error('The provided animation trigger "'.concat(t,'" has not been registered!'));return e}},{key:"trigger",value:function(t,e,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._getTrigger(e),a=new kb(this.id,e,t),s=this._engine.statesByElement.get(t);s||(Ab(t,"ng-trigger"),Ab(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,s={}));var u=s[e],c=new _b(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[e]=c,u||(u=wb),"void"===c.value||u.value!==c.value){var l=ry(this._engine.playersByElement,t,[]);l.forEach((function(t){t.namespaceId==r.id&&t.triggerName==e&&t.queued&&t.destroy()}));var h=o.matchTransition(u.value,c.value,t,c.params),f=!1;if(!h){if(!i)return;h=o.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:h,fromState:u,toState:c,player:a,isFallbackTransition:f}),f||(Ab(t,"ng-animate-queued"),a.onStart((function(){Rb(t,"ng-animate-queued")}))),a.onDone((function(){var e=r.players.indexOf(a);e>=0&&r.players.splice(e,1);var n=r._engine.playersByElement.get(t);if(n){var i=n.indexOf(a);i>=0&&n.splice(i,1)}})),this.players.push(a),l.push(a),a}if(!function(t,e){var n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var o=n[i];if(!e.hasOwnProperty(o)||t[o]!==e[o])return!1}return!0}(u.params,c.params)){var d=[],p=o.matchStyles(u.value,u.params,d),v=o.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush((function(){Iy(t,p),Sy(t,v)}))}}},{key:"deregister",value:function(t){var e=this;delete this._triggers[t],this._engine.statesByElement.forEach((function(e,n){delete e[t]})),this._elementListeners.forEach((function(n,r){e._elementListeners.set(r,n.filter((function(e){return e.name!=t})))}))}},{key:"clearElementCache",value:function(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);var e=this._engine.playersByElement.get(t);e&&(e.forEach((function(t){return t.destroy()})),this._engine.playersByElement.delete(t))}},{key:"_signalRemovalForInnerTriggers",value:function(t,e){var n=this,r=this._engine.driver.query(t,".ng-trigger",!0);r.forEach((function(t){if(!t.__ng_removed){var r=n._engine.fetchNamespacesByElement(t);r.size?r.forEach((function(n){return n.triggerLeaveAnimation(t,e,!1,!0)})):n.clearElementCache(t)}})),this._engine.afterFlushAnimationsDone((function(){return r.forEach((function(t){return n.clearElementCache(t)}))}))}},{key:"triggerLeaveAnimation",value:function(t,e,n,r){var i=this,o=this._engine.statesByElement.get(t);if(o){var a=[];if(Object.keys(o).forEach((function(e){if(i._triggers[e]){var n=i.trigger(t,e,"void",r);n&&a.push(n)}})),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&Jg(a).onDone((function(){return i._engine.processLeaveNode(t)})),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(t){var e=this,n=this._elementListeners.get(t);if(n){var r=new Set;n.forEach((function(n){var i=n.name;if(!r.has(i)){r.add(i);var o=e._triggers[i].fallbackTransition,a=e._engine.statesByElement.get(t)[i]||wb,s=new _b("void"),u=new kb(e.id,i,t);e._engine.totalQueuedPlayers++,e._queue.push({element:t,triggerName:i,transition:o,fromState:a,toState:s,player:u,isFallbackTransition:!0})}}))}}},{key:"removeNode",value:function(t,e){var n=this,r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),!this.triggerLeaveAnimation(t,e,!0)){var i=!1;if(r.totalAnimations){var o=r.players.length?r.playersByQueriedElement.get(t):[];if(o&&o.length)i=!0;else for(var a=t;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}if(this.prepareLeaveAnimationListeners(t),i)r.markElementAsRemoved(this.id,t,!1,e);else{var s=t.__ng_removed;s&&s!==yb||(r.afterFlush((function(){return n.clearElementCache(t)})),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}}},{key:"insertNode",value:function(t,e){Ab(t,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(t){var e=this,n=[];return this._queue.forEach((function(r){var i=r.player;if(!i.destroyed){var o=r.element,a=e._elementListeners.get(o);a&&a.forEach((function(e){if(e.name==r.triggerName){var n=ny(o,r.triggerName,r.fromState.value,r.toState.value);n._data=t,ty(r.player,e.phase,n,e.callback)}})),i.markedForDestroy?e._engine.afterFlush((function(){i.destroy()})):n.push(r)}})),this._queue=[],n.sort((function(t,n){var r=t.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:e._engine.driver.containsElement(t.element,n.element)?1:-1}))}},{key:"destroy",value:function(t){this.players.forEach((function(t){return t.destroy()})),this._signalRemovalForInnerTriggers(this.hostElement,t)}},{key:"elementContainsData",value:function(t){var e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find((function(e){return e.element===t}))||e}}]),t}(),Cb=function(){function t(e,n,r){_classCallCheck(this,t),this.bodyNode=e,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(t,e){}}return _createClass(t,[{key:"_onRemovalComplete",value:function(t,e){this.onRemovalComplete(t,e)}},{key:"createNamespace",value:function(t,e){var n=new xb(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}},{key:"_balanceNamespaceList",value:function(t,e){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}},{key:"register",value:function(t,e){var n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}},{key:"registerTrigger",value:function(t,e,n){var r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}},{key:"destroy",value:function(t,e){var n=this;if(t){var r=this._fetchNamespace(t);this.afterFlush((function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[t];var e=n._namespaceList.indexOf(r);e>=0&&n._namespaceList.splice(e,1)})),this.afterFlushAnimationsDone((function(){return r.destroy(e)}))}}},{key:"_fetchNamespace",value:function(t){return this._namespaceLookup[t]}},{key:"fetchNamespacesByElement",value:function(t){var e=new Set,n=this.statesByElement.get(t);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=n[r[i]].namespaceId;if(o){var a=this._fetchNamespace(o);a&&e.add(a)}}return e}},{key:"trigger",value:function(t,e,n,r){if(Eb(e)){var i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}},{key:"insertNode",value:function(t,e,n,r){if(Eb(e)){var i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){var a=this._fetchNamespace(t);a&&a.insertNode(e,n)}r&&this.collectEnterElement(e)}}},{key:"collectEnterElement",value:function(t){this.collectedEnterElements.push(t)}},{key:"markElementAsDisabled",value:function(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ab(t,"ng-animate-disabled")):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Rb(t,"ng-animate-disabled"))}},{key:"removeNode",value:function(t,e,n,r){if(Eb(e)){var i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){var o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,r)}}else this._onRemovalComplete(e,r)}},{key:"markElementAsRemoved",value:function(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(t,e,n,r,i){return Eb(e)?this._fetchNamespace(t).listen(e,n,r,i):function(){}}},{key:"_buildInstruction",value:function(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}},{key:"destroyInnerAnimations",value:function(t){var e=this,n=this.driver.query(t,".ng-trigger",!0);n.forEach((function(t){return e.destroyActiveAnimationsForElement(t)})),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,".ng-animating",!0)).forEach((function(t){return e.finishActiveQueriedAnimationOnElement(t)}))}},{key:"destroyActiveAnimationsForElement",value:function(t){var e=this.playersByElement.get(t);e&&e.forEach((function(t){t.queued?t.markedForDestroy=!0:t.destroy()}))}},{key:"finishActiveQueriedAnimationOnElement",value:function(t){var e=this.playersByQueriedElement.get(t);e&&e.forEach((function(t){return t.finish()}))}},{key:"whenRenderingDone",value:function(){var t=this;return new Promise((function(e){if(t.players.length)return Jg(t.players).onDone((function(){return e()}));e()}))}},{key:"processLeaveNode",value:function(t){var e=this,n=t.__ng_removed;if(n&&n.setForRemoval){if(t.__ng_removed=yb,n.namespaceId){this.destroyInnerAnimations(t);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}this.driver.matchesElement(t,".ng-animate-disabled")&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach((function(t){e.markElementAsDisabled(t,!1)}))}},{key:"flush",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((function(e,n){return t._balanceNamespaceList(e,n)})),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)Ab(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,e)}finally{for(var o=0;o<i.length;o++)i[o]()}}else for(var a=0;a<this.collectedLeaveElements.length;a++)this.processLeaveNode(this.collectedLeaveElements[a]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach((function(t){return t()})),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?Jg(n).onDone((function(){s.forEach((function(t){return t()}))})):s.forEach((function(t){return t()}))}}},{key:"reportError",value:function(t){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(t.join("\n")))}},{key:"_flushAnimations",value:function(t,e){var n=this,r=new Yy,i=[],o=new Map,a=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach((function(t){l.add(t);for(var e=n.driver.query(t,".ng-animate-queued",!0),r=0;r<e.length;r++)l.add(e[r])}));var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=Tb(f,this.collectedEnterElements),p=new Map,v=0;d.forEach((function(t,e){var n="ng-enter"+v++;p.set(e,n),t.forEach((function(t){return Ab(t,n)}))}));for(var m=[],g=new Set,y=new Set,b=0;b<this.collectedLeaveElements.length;b++){var _=this.collectedLeaveElements[b],w=_.__ng_removed;w&&w.setForRemoval&&(m.push(_),g.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach((function(t){return g.add(t)})):y.add(_))}var x=new Map,C=Tb(f,Array.from(g));C.forEach((function(t,e){var n="ng-leave"+v++;x.set(e,n),t.forEach((function(t){return Ab(t,n)}))})),t.push((function(){d.forEach((function(t,e){var n=p.get(e);t.forEach((function(t){return Rb(t,n)}))})),C.forEach((function(t,e){var n=x.get(e);t.forEach((function(t){return Rb(t,n)}))})),m.forEach((function(t){n.processLeaveNode(t)}))}));for(var k=[],E=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(e).forEach((function(t){var e=t.player,o=t.element;if(k.push(e),n.collectedEnterElements.length){var l=o.__ng_removed;if(l&&l.setForMove)return void e.destroy()}var f=!h||!n.driver.containsElement(h,o),d=x.get(o),v=p.get(o),m=n._buildInstruction(t,r,v,d,f);if(!m.errors||!m.errors.length)return f?(e.onStart((function(){return Iy(o,m.fromStyles)})),e.onDestroy((function(){return Sy(o,m.toStyles)})),void i.push(e)):t.isFallbackTransition?(e.onStart((function(){return Iy(o,m.fromStyles)})),e.onDestroy((function(){return Sy(o,m.toStyles)})),void i.push(e)):(m.timelines.forEach((function(t){return t.stretchStartingKeyframe=!0})),r.append(o,m.timelines),a.push({instruction:m,player:e,element:o}),m.queriedElements.forEach((function(t){return ry(s,t,[]).push(e)})),m.preStyleProps.forEach((function(t,e){var n=Object.keys(t);if(n.length){var r=u.get(e);r||u.set(e,r=new Set),n.forEach((function(t){return r.add(t)}))}})),void m.postStyleProps.forEach((function(t,e){var n=Object.keys(t),r=c.get(e);r||c.set(e,r=new Set),n.forEach((function(t){return r.add(t)}))})));E.push(m)}));if(E.length){var I=[];E.forEach((function(t){I.push("@".concat(t.triggerName," has failed due to:\n")),t.errors.forEach((function(t){return I.push("- ".concat(t,"\n"))}))})),k.forEach((function(t){return t.destroy()})),this.reportError(I)}var T=new Map,A=new Map;a.forEach((function(t){var e=t.element;r.has(e)&&(A.set(e,e),n._beforeAnimationBuild(t.player.namespaceId,t.instruction,T))})),i.forEach((function(t){var e=t.element;n._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach((function(t){ry(T,e,[]).push(t),t.destroy()}))}));var R=m.filter((function(t){return Nb(t,u,c)})),O=new Map;Ib(O,this.driver,y,c,"*").forEach((function(t){Nb(t,u,c)&&R.push(t)}));var N=new Map;d.forEach((function(t,e){Ib(N,n.driver,new Set(t),u,"!")})),R.forEach((function(t){var e=O.get(t),n=N.get(t);O.set(t,Object.assign(Object.assign({},e),n))}));var D=[],P=[],M={};a.forEach((function(t){var e=t.element,a=t.player,s=t.instruction;if(r.has(e)){if(l.has(e))return a.onDestroy((function(){return Sy(e,s.toStyles)})),a.disabled=!0,a.overrideTotalTime(s.totalTime),void i.push(a);var u=M;if(A.size>1){for(var c=e,h=[];c=c.parentNode;){var f=A.get(c);if(f){u=f;break}h.push(c)}h.forEach((function(t){return A.set(t,u)}))}var d=n._buildAnimation(a.namespaceId,s,T,o,N,O);if(a.setRealPlayer(d),u===M)D.push(a);else{var p=n.playersByElement.get(u);p&&p.length&&(a.parentPlayer=Jg(p)),i.push(a)}}else Iy(e,s.fromStyles),a.onDestroy((function(){return Sy(e,s.toStyles)})),P.push(a),l.has(e)&&i.push(a)})),P.forEach((function(t){var e=o.get(t.element);if(e&&e.length){var n=Jg(e);t.setRealPlayer(n)}})),i.forEach((function(t){t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()}));for(var F=0;F<m.length;F++){var L=m[F],B=L.__ng_removed;if(Rb(L,"ng-leave"),!B||!B.hasAnimation){var j=[];if(s.size){var V=s.get(L);V&&V.length&&j.push.apply(j,_toConsumableArray(V));for(var U=this.driver.query(L,".ng-animating",!0),z=0;z<U.length;z++){var W=s.get(U[z]);W&&W.length&&j.push.apply(j,_toConsumableArray(W))}}var q=j.filter((function(t){return!t.destroyed}));q.length?Ob(this,L,q):this.processLeaveNode(L)}}return m.length=0,D.forEach((function(t){n.players.push(t),t.onDone((function(){t.destroy();var e=n.players.indexOf(t);n.players.splice(e,1)})),t.play()})),D}},{key:"elementContainsData",value:function(t,e){var n=!1,r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}},{key:"afterFlush",value:function(t){this._flushFns.push(t)}},{key:"afterFlushAnimationsDone",value:function(t){this._whenQuietFns.push(t)}},{key:"_getPreviousPlayers",value:function(t,e,n,r,i){var o=[];if(e){var a=this.playersByQueriedElement.get(t);a&&(o=a)}else{var s=this.playersByElement.get(t);if(s){var u=!i||"void"==i;s.forEach((function(t){t.queued||(u||t.triggerName==r)&&o.push(t)}))}}return(n||r)&&(o=o.filter((function(t){return!(n&&n!=t.namespaceId||r&&r!=t.triggerName)}))),o}},{key:"_beforeAnimationBuild",value:function(t,e,n){var r,i=this,o=e.element,a=e.isRemovalTransition?void 0:t,s=e.isRemovalTransition?void 0:e.triggerName,u=_createForOfIteratorHelper(e.timelines);try{var c=function(){var t=r.value.element,u=t!==o,c=ry(n,t,[]);i._getPreviousPlayers(t,u,a,s,e.toState).forEach((function(t){var e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),c.push(t)}))};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}Iy(o,e.fromStyles)}},{key:"_buildAnimation",value:function(t,e,n,r,i,o){var a=this,s=e.triggerName,u=e.element,c=[],l=new Set,h=new Set,f=e.timelines.map((function(e){var f=e.element;l.add(f);var d=f.__ng_removed;if(d&&d.removedBeforeQueried)return new $g(e.duration,e.delay);var p,v,m=f!==u,g=(p=(n.get(f)||gb).map((function(t){return t.getRealPlayer()})),v=[],function t(e,n){for(var r=0;r<e.length;r++){var i=e[r];i instanceof Yg?t(i.players,n):n.push(i)}}(p,v),v).filter((function(t){return!!t.element&&t.element===f})),y=i.get(f),b=o.get(f),_=Zg(0,a._normalizer,0,e.keyframes,y,b),w=a._buildPlayer(e,_,g);if(e.subTimeline&&r&&h.add(f),m){var x=new kb(t,s,f);x.setRealPlayer(w),c.push(x)}return w}));c.forEach((function(t){ry(a.playersByQueriedElement,t.element,[]).push(t),t.onDone((function(){return function(t,e,n){var r;if(t instanceof Map){if(r=t.get(e)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&t.delete(e)}}else if(r=t[e]){if(r.length){var o=r.indexOf(n);r.splice(o,1)}0==r.length&&delete t[e]}return r}(a.playersByQueriedElement,t.element,t)}))})),l.forEach((function(t){return Ab(t,"ng-animating")}));var d=Jg(f);return d.onDestroy((function(){l.forEach((function(t){return Rb(t,"ng-animating")})),Sy(u,e.toStyles)})),h.forEach((function(t){ry(r,t,[]).push(d)})),d}},{key:"_buildPlayer",value:function(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new $g(t.duration,t.delay)}},{key:"queuedPlayers",get:function(){var t=[];return this._namespaceList.forEach((function(e){e.players.forEach((function(e){e.queued&&t.push(e)}))})),t}}]),t}(),kb=function(){function t(e,n,r){_classCallCheck(this,t),this.namespaceId=e,this.triggerName=n,this.element=r,this._player=new $g,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return _createClass(t,[{key:"setRealPlayer",value:function(t){var e=this;this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach((function(n){e._queuedCallbacks[n].forEach((function(e){return ty(t,n,void 0,e)}))})),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(t){this.totalTime=t}},{key:"syncPlayerEvents",value:function(t){var e=this,n=this._player;n.triggerCallback&&t.onStart((function(){return n.triggerCallback("start")})),t.onDone((function(){return e.finish()})),t.onDestroy((function(){return e.destroy()}))}},{key:"_queueEvent",value:function(t,e){ry(this._queuedCallbacks,t,[]).push(e)}},{key:"onDone",value:function(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}},{key:"onStart",value:function(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}},{key:"onDestroy",value:function(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(t){this.queued||this._player.setPosition(t)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(t){var e=this._player;e.triggerCallback&&e.triggerCallback(t)}}]),t}();function Eb(t){return t&&1===t.nodeType}function Sb(t,e){var n=t.style.display;return t.style.display=null!=e?e:"none",n}function Ib(t,e,n,r,i){var o=[];n.forEach((function(t){return o.push(Sb(t))}));var a=[];r.forEach((function(n,r){var o={};n.forEach((function(t){var n=o[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=bb,a.push(r))})),t.set(r,o)}));var s=0;return n.forEach((function(t){return Sb(t,o[s++])})),a}function Tb(t,e){var n=new Map;if(t.forEach((function(t){return n.set(t,[])})),0==e.length)return n;var r=new Set(e),i=new Map;return e.forEach((function(t){var e=function t(e){if(!e)return 1;var o=i.get(e);if(o)return o;var a=e.parentNode;return o=n.has(a)?a:r.has(a)?1:t(a),i.set(e,o),o}(t);1!==e&&n.get(e).push(t)})),n}function Ab(t,e){if(t.classList)t.classList.add(e);else{var n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function Rb(t,e){if(t.classList)t.classList.remove(e);else{var n=t.$$classes;n&&delete n[e]}}function Ob(t,e,n){Jg(n).onDone((function(){return t.processLeaveNode(e)}))}function Nb(t,e,n){var r=n.get(t);if(!r)return!1;var i=e.get(t);return i?r.forEach((function(t){return i.add(t)})):e.set(t,r),n.delete(t),!0}var Db=function(){function t(e,n,r){var i=this;_classCallCheck(this,t),this.bodyNode=e,this._driver=n,this._triggerCache={},this.onRemovalComplete=function(t,e){},this._transitionEngine=new Cb(e,n,r),this._timelineEngine=new mb(e,n,r),this._transitionEngine.onRemovalComplete=function(t,e){return i.onRemovalComplete(t,e)}}return _createClass(t,[{key:"registerTrigger",value:function(t,e,n,r,i){var o=t+"-"+r,a=this._triggerCache[o];if(!a){var s=[],u=Wy(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));a=function(t,e){return new db(t,e)}(r,u),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,r,a)}},{key:"register",value:function(t,e){this._transitionEngine.register(t,e)}},{key:"destroy",value:function(t,e){this._transitionEngine.destroy(t,e)}},{key:"onInsert",value:function(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}},{key:"onRemove",value:function(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}},{key:"disableAnimations",value:function(t,e){this._transitionEngine.markElementAsDisabled(t,e)}},{key:"process",value:function(t,e,n,r){if("@"==n.charAt(0)){var i=_slicedToArray(iy(n),2),o=i[0],a=i[1];this._timelineEngine.command(o,e,a,r)}else this._transitionEngine.trigger(t,e,n,r)}},{key:"listen",value:function(t,e,n,r,i){if("@"==n.charAt(0)){var o=_slicedToArray(iy(n),2),a=o[0],s=o[1];return this._timelineEngine.listen(a,e,s,i)}return this._transitionEngine.listen(t,e,n,r,i)}},{key:"flush",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(t)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}}]),t}();function Pb(t,e){var n=null,r=null;return Array.isArray(e)&&e.length?(n=Fb(e[0]),e.length>1&&(r=Fb(e[e.length-1]))):e&&(n=Fb(e)),n||r?new Mb(t,n,r):null}var Mb=function(){var t=function(){function t(e,n,r){_classCallCheck(this,t),this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;var i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}return _createClass(t,[{key:"start",value:function(){this._state<1&&(this._startStyles&&Sy(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(Sy(this._element,this._initialStyles),this._endStyles&&(Sy(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Iy(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Iy(this._element,this._endStyles),this._endStyles=null),Sy(this._element,this._initialStyles),this._state=3)}}]),t}();return t.initialStylesByElement=new WeakMap,t}();function Fb(t){for(var e=null,n=Object.keys(t),r=0;r<n.length;r++){var i=n[r];Lb(i)&&((e=e||{})[i]=t[i])}return e}function Lb(t){return"display"===t||"position"===t}var Bb=function(){function t(e,n,r,i,o,a,s){var u=this;_classCallCheck(this,t),this._element=e,this._name=n,this._duration=r,this._delay=i,this._easing=o,this._fillMode=a,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(t){return u._handleCallback(t)}}return _createClass(t,[{key:"apply",value:function(){var t,e,n;t=this._element,e="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(n=qb(t,"").trim()).length&&(function(t,e){for(var n=0;n<t.length;n++)t.charAt(n)}(n),e="".concat(n,", ").concat(e)),Wb(t,"",e),zb(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){jb(this._element,this._name,"paused")}},{key:"resume",value:function(){jb(this._element,this._name,"running")}},{key:"setPosition",value:function(t){var e=Vb(this._element,this._name);this._position=t*this._duration,Wb(this._element,"Delay","-".concat(this._position,"ms"),e)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(t){var e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),zb(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){var n=qb(t,"").split(","),r=Ub(n,e);r>=0&&(n.splice(r,1),Wb(t,"",n.join(",")))}(this._element,this._name))}}]),t}();function jb(t,e,n){Wb(t,"PlayState",n,Vb(t,e))}function Vb(t,e){var n=qb(t,"");return n.indexOf(",")>0?Ub(n.split(","),e):Ub([n],e)}function Ub(t,e){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function zb(t,e,n){n?t.removeEventListener("animationend",e):t.addEventListener("animationend",e)}function Wb(t,e,n,r){var i="animation"+e;if(null!=r){var o=t.style[i];if(o.length){var a=o.split(",");a[r]=n,n=a.join(",")}}t.style[i]=n}function qb(t,e){return t.style["animation"+e]}var Hb=function(){function t(e,n,r,i,o,a,s,u){_classCallCheck(this,t),this.element=e,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=o,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=a||"linear",this.totalTime=i+o,this._buildStyler()}return _createClass(t,[{key:"onStart",value:function(t){this._onStartFns.push(t)}},{key:"onDone",value:function(t){this._onDoneFns.push(t)}},{key:"onDestroy",value:function(t){this._onDestroyFns.push(t)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(t){return t()})),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach((function(t){return t()})),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach((function(t){return t()})),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(t){this._styler.setPosition(t)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var t=this;this._styler=new Bb(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",(function(){return t.finish()}))}},{key:"triggerCallback",value:function(t){var e="start"==t?this._onStartFns:this._onDoneFns;e.forEach((function(t){return t()})),e.length=0}},{key:"beforeDestroy",value:function(){var t=this;this.init();var e={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach((function(r){"offset"!=r&&(e[r]=n?t._finalStyles[r]:By(t.element,r))}))}this.currentSnapshot=e}}]),t}(),Gb=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).element=t,i._startingStyles={},i.__initialized=!1,i._styles=vy(r),i}return _createClass(n,[{key:"init",value:function(){var t=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach((function(e){t._startingStyles[e]=t.element.style[e]})),_get(_getPrototypeOf(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var t=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach((function(e){return t.element.style.setProperty(e,t._styles[e])})),_get(_getPrototypeOf(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var t=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach((function(e){var n=t._startingStyles[e];n?t.element.style.setProperty(e,n):t.element.style.removeProperty(e)})),this._startingStyles=null,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this))}}]),n}($g),Kb=function(){function t(){_classCallCheck(this,t),this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}return _createClass(t,[{key:"validateStyleProperty",value:function(t){return hy(t)}},{key:"matchesElement",value:function(t,e){return fy(t,e)}},{key:"containsElement",value:function(t,e){return dy(t,e)}},{key:"query",value:function(t,e,n){return py(t,e,n)}},{key:"computeStyle",value:function(t,e,n){return window.getComputedStyle(t)[e]}},{key:"buildKeyframeElement",value:function(t,e,n){n=n.map((function(t){return vy(t)}));var r="@keyframes ".concat(e," {\n"),i="";n.forEach((function(t){i=" ";var e=parseFloat(t.offset);r+="".concat(i).concat(100*e,"% {\n"),i+=" ",Object.keys(t).forEach((function(e){var n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(e,": ").concat(n,";\n"))}})),r+="".concat(i,"}\n")})),r+="}\n";var o=document.createElement("style");return o.innerHTML=r,o}},{key:"animate",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;a&&this._notifyFaultyScrubber();var s=o.filter((function(t){return t instanceof Hb})),u={};My(n,r)&&s.forEach((function(t){var e=t.currentSnapshot;Object.keys(e).forEach((function(t){return u[t]=e[t]}))}));var c=function(t){var e={};return t&&(Array.isArray(t)?t:[t]).forEach((function(t){Object.keys(t).forEach((function(n){"offset"!=n&&"easing"!=n&&(e[n]=t[n])}))})),e}(e=Fy(t,e,u));if(0==n)return new Gb(t,c);var l="gen_css_kf_".concat(this._count++),h=this.buildKeyframeElement(t,l,e);document.querySelector("head").appendChild(h);var f=Pb(t,e),d=new Hb(t,e,l,n,r,i,c,f);return d.onDestroy((function(){var t;(t=h).parentNode.removeChild(t)})),d}},{key:"_notifyFaultyScrubber",value:function(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}]),t}(),Xb=function(){function t(e,n,r,i){_classCallCheck(this,t),this.element=e,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return _createClass(t,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(t){return t()})),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var t=this;if(!this._initialized){this._initialized=!0;var e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",(function(){return t._onFinish()}))}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(t,e,n){return t.animate(e,n)}},{key:"onStart",value:function(t){this._onStartFns.push(t)}},{key:"onDone",value:function(t){this._onDoneFns.push(t)}},{key:"onDestroy",value:function(t){this._onDestroyFns.push(t)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach((function(t){return t()})),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(t){return t()})),this._onDestroyFns=[])}},{key:"setPosition",value:function(t){this.domPlayer.currentTime=t*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"beforeDestroy",value:function(){var t=this,e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach((function(n){"offset"!=n&&(e[n]=t._finished?t._finalKeyframe[n]:By(t.element,n))})),this.currentSnapshot=e}},{key:"triggerCallback",value:function(t){var e="start"==t?this._onStartFns:this._onDoneFns;e.forEach((function(t){return t()})),e.length=0}},{key:"totalTime",get:function(){return this._delay+this._duration}}]),t}(),$b=function(){function t(){_classCallCheck(this,t),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Yb().toString()),this._cssKeyframesDriver=new Kb}return _createClass(t,[{key:"validateStyleProperty",value:function(t){return hy(t)}},{key:"matchesElement",value:function(t,e){return fy(t,e)}},{key:"containsElement",value:function(t,e){return dy(t,e)}},{key:"query",value:function(t,e,n){return py(t,e,n)}},{key:"computeStyle",value:function(t,e,n){return window.getComputedStyle(t)[e]}},{key:"overrideWebAnimationsSupport",value:function(t){this._isNativeImpl=t}},{key:"animate",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;if(!a&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,o);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=o.filter((function(t){return t instanceof Xb}));My(n,r)&&c.forEach((function(t){var e=t.currentSnapshot;Object.keys(e).forEach((function(t){return u[t]=e[t]}))}));var l=Pb(t,e=Fy(t,e=e.map((function(t){return Cy(t,!1)})),u));return new Xb(t,e,s,l)}}]),t}();function Yb(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var Qb,Jb=((Qb=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._nextAnimationId=0,i._renderer=t.createRenderer(r.body,{id:"0",encapsulation:ve.None,styles:[],data:{animation:[]}}),i}return _createClass(n,[{key:"build",value:function(t){var e=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(t)?Ug(t):t;return e_(this._renderer,null,e,"register",[n]),new Zb(e,this._renderer)}}]),n}(Bg)).\u0275fac=function(t){return new(t||Qb)(te(Ws),te(nl))},Qb.\u0275prov=mt({token:Qb,factory:Qb.\u0275fac}),Qb),Zb=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._id=t,i._renderer=r,i}return _createClass(n,[{key:"create",value:function(t,e){return new t_(this._id,t,e||{},this._renderer)}}]),n}(function(){return function t(){_classCallCheck(this,t)}}()),t_=function(){function t(e,n,r,i){_classCallCheck(this,t),this.id=e,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return _createClass(t,[{key:"_listen",value:function(t,e){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(t),e)}},{key:"_command",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return e_(this._renderer,this.element,this.id,t,n)}},{key:"onDone",value:function(t){this._listen("done",t)}},{key:"onStart",value:function(t){this._listen("start",t)}},{key:"onDestroy",value:function(t){this._listen("destroy",t)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(t){this._command("setPosition",t)}},{key:"getPosition",value:function(){return 0}}]),t}();function e_(t,e,n,r,i){return t.setProperty(e,"@@".concat(n,":").concat(r),i)}var n_,r_,i_,o_=((n_=function(){function t(e,n,r){_classCallCheck(this,t),this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(t,e){e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}return _createClass(t,[{key:"createRenderer",value:function(t,e){var n=this,r=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){var i=this._rendererCache.get(r);return i||(i=new a_("",r,this.engine),this._rendererCache.set(r,i)),i}var o=e.id,a=e.id+"-"+this._currentId;return this._currentId++,this.engine.register(a,t),e.data.animation.forEach((function e(r){Array.isArray(r)?r.forEach(e):n.engine.registerTrigger(o,a,t,r.name,r)})),new s_(this,a,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var t=this;this.promise.then((function(){t._microtaskId++}))}},{key:"scheduleListenerCallback",value:function(t,e,n){var r=this;t>=0&&t<this._microtaskId?this._zone.run((function(){return e(n)})):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then((function(){r._zone.run((function(){r._animationCallbacksBuffer.forEach((function(t){var e=_slicedToArray(t,2);(0,e[0])(e[1])})),r._animationCallbacksBuffer=[]}))})),this._animationCallbacksBuffer.push([e,n]))}},{key:"end",value:function(){var t=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular((function(){t._scheduleCountTask(),t.engine.flush(t._microtaskId)})),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),t}()).\u0275fac=function(t){return new(t||n_)(te(Ws),te(Db),te(xc))},n_.\u0275prov=mt({token:n_,factory:n_.\u0275fac}),n_),a_=function(){function t(e,n,r){_classCallCheck(this,t),this.namespaceId=e,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(t){return n.destroyNode(t)}:null}return _createClass(t,[{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(t,e){return this.delegate.createElement(t,e)}},{key:"createComment",value:function(t){return this.delegate.createComment(t)}},{key:"createText",value:function(t){return this.delegate.createText(t)}},{key:"appendChild",value:function(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}},{key:"insertBefore",value:function(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}},{key:"removeChild",value:function(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}},{key:"selectRootElement",value:function(t,e){return this.delegate.selectRootElement(t,e)}},{key:"parentNode",value:function(t){return this.delegate.parentNode(t)}},{key:"nextSibling",value:function(t){return this.delegate.nextSibling(t)}},{key:"setAttribute",value:function(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}},{key:"removeAttribute",value:function(t,e,n){this.delegate.removeAttribute(t,e,n)}},{key:"addClass",value:function(t,e){this.delegate.addClass(t,e)}},{key:"removeClass",value:function(t,e){this.delegate.removeClass(t,e)}},{key:"setStyle",value:function(t,e,n,r){this.delegate.setStyle(t,e,n,r)}},{key:"removeStyle",value:function(t,e,n){this.delegate.removeStyle(t,e,n)}},{key:"setProperty",value:function(t,e,n){"@"==e.charAt(0)&&"@.disabled"==e?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}},{key:"setValue",value:function(t,e){this.delegate.setValue(t,e)}},{key:"listen",value:function(t,e,n){return this.delegate.listen(t,e,n)}},{key:"disableAnimations",value:function(t,e){this.engine.disableAnimations(t,e)}},{key:"data",get:function(){return this.delegate.data}}]),t}(),s_=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,r,i,o)).factory=t,a.namespaceId=r,a}return _createClass(n,[{key:"setProperty",value:function(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&"@.disabled"==e?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}},{key:"listen",value:function(t,e,n){var r,i,o=this;if("@"==e.charAt(0)){var a,s=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t),u=e.substr(1),c="";return"@"!=u.charAt(0)&&(i=(r=u).indexOf("."),u=(a=_slicedToArray([r.substring(0,i),r.substr(i+1)],2))[0],c=a[1]),this.engine.listen(this.namespaceId,s,u,c,(function(t){o.factory.scheduleListenerCallback(t._data||-1,n,t)}))}return this.delegate.listen(t,e,n)}}]),n}(a_),u_=((r_=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){return _classCallCheck(this,n),e.call(this,t.body,r,i)}return n}(Db)).\u0275fac=function(t){return new(t||r_)(te(nl),te(yy),te(ab))},r_.\u0275prov=mt({token:r_,factory:r_.\u0275fac}),r_),c_=new Ht("AnimationModuleType"),l_=[{provide:yy,useFactory:function(){return"function"==typeof Yb()?new $b:new Kb}},{provide:c_,useValue:"BrowserAnimations"},{provide:Bg,useClass:Jb},{provide:ab,useFactory:function(){return new sb}},{provide:Db,useClass:u_},{provide:Ws,useFactory:function(t,e,n){return new o_(t,e,n)},deps:[Rh,Db,xc]}],h_=((i_=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:i_}),i_.\u0275inj=gt({factory:function(t){return new(t||i_)},providers:l_,imports:[qh]}),i_);function f_(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.length?n.some((function(e){return t[e]})):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}var d_=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).scheduler=t,i.work=r,i.pending=!1,i}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}},{key:"requestAsyncId",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(t.flush.bind(t,this),n)}},{key:"recycleAsyncId",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}},{key:"execute",value:function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}]),n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){return _classCallCheck(this,n),e.call(this)}return _createClass(n,[{key:"schedule",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),n}(v)),p_=function(){var t=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.now;_classCallCheck(this,t),this.SchedulerAction=e,this.now=n}return _createClass(t,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,t).schedule(n,e)}}]),t}();return t.now=function(){return Date.now()},t}(),v_=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p_.now;return _classCallCheck(this,n),(r=e.call(this,t,(function(){return n.delegate&&n.delegate!==_assertThisInitialized(r)?n.delegate.now():i()}))).actions=[],r.active=!1,r.scheduled=void 0,r}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(t,e,r):_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,t,e,r)}},{key:"flush",value:function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}}]),n}(p_),m_=new v_(d_);function g_(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m_;return function(n){return n.lift(new b_(t,e))}}var y_,b_=function(){function t(e,n){_classCallCheck(this,t),this.dueTime=e,this.scheduler=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new __(t,this.dueTime,this.scheduler))}}]),t}(),__=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t)).dueTime=r,o.scheduler=i,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=!1,o}return _createClass(n,[{key:"_next",value:function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(w_,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}},{key:"clearDebounce",value:function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}]),n}(y);function w_(t){t.debouncedNext()}function x_(t){return null!=t&&"false"!=="".concat(t)}function C_(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return k_(t)?Number(t):e}function k_(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function E_(t){return Array.isArray(t)?t:[t]}function S_(t){return null==t?"":"string"==typeof t?t:"".concat(t,"px")}function I_(t){return t instanceof Us?t.nativeElement:t}try{y_="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(Svt){y_=!1}var T_,A_,R_,O_,N_,D_,P_=((R_=function t(e){_classCallCheck(this,t),this._platformId=e,this.isBrowser=this._platformId?eh(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!y_)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}).\u0275fac=function(t){return new(t||R_)(te(ac,8))},R_.\u0275prov=mt({factory:function(){return new R_(te(ac,8))},token:R_,providedIn:"root"}),R_),M_=((A_=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:A_}),A_.\u0275inj=gt({factory:function(t){return new(t||A_)}}),A_),F_=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function L_(){if(T_)return T_;if("object"!=typeof document||!document)return T_=new Set(F_);var t=document.createElement("input");return T_=new Set(F_.filter((function(e){return t.setAttribute("type",e),t.type===e})))}function B_(t){return function(){if(null==O_&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return O_=!0}}))}finally{O_=O_||!1}return O_}()?t:!!t.capture}function j_(){if("object"!=typeof document||!document)return 0;if(null==N_){var t=document.createElement("div"),e=t.style;t.dir="rtl",e.height="1px",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";var n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",t.appendChild(n),document.body.appendChild(t),N_=0,0===t.scrollLeft&&(t.scrollLeft=1,N_=0===t.scrollLeft?1:2),t.parentNode.removeChild(t)}return N_}function V_(t){if(function(){if(null==D_){var t="undefined"!=typeof document?document.head:null;D_=!(!t||!t.createShadowRoot&&!t.attachShadow)}return D_}()){var e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}var U_,z_,W_,q_,H_=((q_=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}]),t}()).\u0275fac=function(t){return new(t||q_)},q_.\u0275prov=mt({factory:function(){return new q_},token:q_,providedIn:"root"}),q_),G_=((W_=function(){function t(e){_classCallCheck(this,t),this._mutationObserverFactory=e,this._observedElements=new Map}return _createClass(t,[{key:"ngOnDestroy",value:function(){var t=this;this._observedElements.forEach((function(e,n){return t._cleanupObserver(n)}))}},{key:"observe",value:function(t){var e=this,n=I_(t);return new E((function(t){var r=e._observeElement(n).subscribe(t);return function(){r.unsubscribe(),e._unobserveElement(n)}}))}},{key:"_observeElement",value:function(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{var e=new O,n=this._mutationObserverFactory.create((function(t){return e.next(t)}));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}},{key:"_unobserveElement",value:function(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}},{key:"_cleanupObserver",value:function(t){if(this._observedElements.has(t)){var e=this._observedElements.get(t),n=e.observer,r=e.stream;n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}}]),t}()).\u0275fac=function(t){return new(t||W_)(te(H_))},W_.\u0275prov=mt({factory:function(){return new W_(te(H_))},token:W_,providedIn:"root"}),W_),K_=((z_=function(){function t(e,n,r){_classCallCheck(this,t),this._contentObserver=e,this._elementRef=n,this._ngZone=r,this.event=new Nu,this._disabled=!1,this._currentSubscription=null}return _createClass(t,[{key:"ngAfterContentInit",value:function(){this._currentSubscription||this.disabled||this._subscribe()}},{key:"ngOnDestroy",value:function(){this._unsubscribe()}},{key:"_subscribe",value:function(){var t=this;this._unsubscribe();var e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular((function(){t._currentSubscription=(t.debounce?e.pipe(g_(t.debounce)):e).subscribe(t.event)}))}},{key:"_unsubscribe",value:function(){this._currentSubscription&&this._currentSubscription.unsubscribe()}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=x_(t),this._disabled?this._unsubscribe():this._subscribe()}},{key:"debounce",get:function(){return this._debounce},set:function(t){this._debounce=C_(t),this._subscribe()}}]),t}()).\u0275fac=function(t){return new(t||z_)(Ca(G_),Ca(Us),Ca(xc))},z_.\u0275dir=Ee({type:z_,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),z_),X_=((U_=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:U_}),U_.\u0275inj=gt({factory:function(t){return new(t||U_)},providers:[H_]}),U_);function $_(t,e){return(t.getAttribute(e)||"").match(/\S+/g)||[]}var Y_,Q_,J_=0,Z_=new Map,tw=null,ew=((Y_=function(){function t(e){_classCallCheck(this,t),this._document=e}return _createClass(t,[{key:"describe",value:function(t,e){this._canBeDescribed(t,e)&&("string"!=typeof e?(this._setMessageId(e),Z_.set(e,{messageElement:e,referenceCount:0})):Z_.has(e)||this._createMessageElement(e),this._isElementDescribedByMessage(t,e)||this._addMessageReference(t,e))}},{key:"removeDescription",value:function(t,e){if(this._isElementNode(t)){if(this._isElementDescribedByMessage(t,e)&&this._removeMessageReference(t,e),"string"==typeof e){var n=Z_.get(e);n&&0===n.referenceCount&&this._deleteMessageElement(e)}tw&&0===tw.childNodes.length&&this._deleteMessagesContainer()}}},{key:"ngOnDestroy",value:function(){for(var t=this._document.querySelectorAll("[cdk-describedby-host]"),e=0;e<t.length;e++)this._removeCdkDescribedByReferenceIds(t[e]),t[e].removeAttribute("cdk-describedby-host");tw&&this._deleteMessagesContainer(),Z_.clear()}},{key:"_createMessageElement",value:function(t){var e=this._document.createElement("div");this._setMessageId(e),e.textContent=t,this._createMessagesContainer(),tw.appendChild(e),Z_.set(t,{messageElement:e,referenceCount:0})}},{key:"_setMessageId",value:function(t){t.id||(t.id="cdk-describedby-message-".concat(J_++))}},{key:"_deleteMessageElement",value:function(t){var e=Z_.get(t),n=e&&e.messageElement;tw&&n&&tw.removeChild(n),Z_.delete(t)}},{key:"_createMessagesContainer",value:function(){if(!tw){var t=this._document.getElementById("cdk-describedby-message-container");t&&t.parentNode.removeChild(t),(tw=this._document.createElement("div")).id="cdk-describedby-message-container",tw.setAttribute("aria-hidden","true"),tw.style.display="none",this._document.body.appendChild(tw)}}},{key:"_deleteMessagesContainer",value:function(){tw&&tw.parentNode&&(tw.parentNode.removeChild(tw),tw=null)}},{key:"_removeCdkDescribedByReferenceIds",value:function(t){var e=$_(t,"aria-describedby").filter((function(t){return 0!=t.indexOf("cdk-describedby-message")}));t.setAttribute("aria-describedby",e.join(" "))}},{key:"_addMessageReference",value:function(t,e){var n,r,i,o,a=Z_.get(e);n=t,r="aria-describedby",i=a.messageElement.id,(o=$_(n,r)).some((function(t){return t.trim()==i.trim()}))||(o.push(i.trim()),n.setAttribute(r,o.join(" "))),t.setAttribute("cdk-describedby-host",""),a.referenceCount++}},{key:"_removeMessageReference",value:function(t,e){var n,r,i,o,a=Z_.get(e);a.referenceCount--,n=t,r="aria-describedby",i=a.messageElement.id,(o=$_(n,r).filter((function(t){return t!=i.trim()}))).length?n.setAttribute(r,o.join(" ")):n.removeAttribute(r),t.removeAttribute("cdk-describedby-host")}},{key:"_isElementDescribedByMessage",value:function(t,e){var n=$_(t,"aria-describedby"),r=Z_.get(e),i=r&&r.messageElement.id;return!!i&&-1!=n.indexOf(i)}},{key:"_canBeDescribed",value:function(t,e){if(!this._isElementNode(t))return!1;if(e&&"object"==typeof e)return!0;var n=null==e?"":"".concat(e).trim(),r=t.getAttribute("aria-label");return!(!n||r&&r.trim()===n)}},{key:"_isElementNode",value:function(t){return t.nodeType===this._document.ELEMENT_NODE}}]),t}()).\u0275fac=function(t){return new(t||Y_)(te(nl))},Y_.\u0275prov=mt({factory:function(){return new Y_(te(nl))},token:Y_,providedIn:"root"}),Y_),nw=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"setActiveItem",value:function(t){this.activeItem&&this.activeItem.setInactiveStyles(),_get(_getPrototypeOf(n.prototype),"setActiveItem",this).call(this,t),this.activeItem&&this.activeItem.setActiveStyles()}}]),n}(function(){function t(e){var n=this;_classCallCheck(this,t),this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new O,this._typeaheadSubscription=v.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._skipPredicateFn=function(t){return t.disabled},this._pressedLetters=[],this.tabOut=new O,this.change=new O,e instanceof Pu&&e.changes.subscribe((function(t){if(n._activeItem){var e=t.toArray().indexOf(n._activeItem);e>-1&&e!==n._activeItemIndex&&(n._activeItemIndex=e)}}))}return _createClass(t,[{key:"skipPredicate",value:function(t){return this._skipPredicateFn=t,this}},{key:"withWrap",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._wrap=t,this}},{key:"withVerticalOrientation",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._vertical=t,this}},{key:"withHorizontalOrientation",value:function(t){return this._horizontal=t,this}},{key:"withAllowedModifierKeys",value:function(t){return this._allowedModifierKeys=t,this}},{key:"withTypeAhead",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;if(this._items.length&&this._items.some((function(t){return"function"!=typeof t.getLabel})))throw Error("ListKeyManager items in typeahead mode must implement the `getLabel` method.");return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Up((function(e){return t._pressedLetters.push(e)})),g_(e),sp((function(){return t._pressedLetters.length>0})),z((function(){return t._pressedLetters.join("")}))).subscribe((function(e){for(var n=t._getItemsArray(),r=1;r<n.length+1;r++){var i=(t._activeItemIndex+r)%n.length,o=n[i];if(!t._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(e)){t.setActiveItem(i);break}}t._pressedLetters=[]})),this}},{key:"setActiveItem",value:function(t){var e=this._activeItemIndex;this.updateActiveItem(t),this._activeItemIndex!==e&&this.change.next(this._activeItemIndex)}},{key:"onKeydown",value:function(t){var e=this,n=t.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every((function(n){return!t[n]||e._allowedModifierKeys.indexOf(n)>-1}));switch(n){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;default:return void((r||f_(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(n>=65&&n<=90||n>=48&&n<=57)&&this._letterKeyStream.next(String.fromCharCode(n))))}this._pressedLetters=[],t.preventDefault()}},{key:"isTyping",value:function(){return this._pressedLetters.length>0}},{key:"setFirstItemActive",value:function(){this._setActiveItemByIndex(0,1)}},{key:"setLastItemActive",value:function(){this._setActiveItemByIndex(this._items.length-1,-1)}},{key:"setNextItemActive",value:function(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}},{key:"setPreviousItemActive",value:function(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}},{key:"updateActiveItem",value:function(t){var e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t),r=e[n];this._activeItem=null==r?null:r,this._activeItemIndex=n}},{key:"_setActiveItemByDelta",value:function(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}},{key:"_setActiveInWrapMode",value:function(t){for(var e=this._getItemsArray(),n=1;n<=e.length;n++){var r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}},{key:"_setActiveInDefaultMode",value:function(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}},{key:"_setActiveItemByIndex",value:function(t,e){var n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}},{key:"_getItemsArray",value:function(){return this._items instanceof Pu?this._items.toArray():this._items}},{key:"activeItemIndex",get:function(){return this._activeItemIndex}},{key:"activeItem",get:function(){return this._activeItem}}]),t}()),rw=((Q_=function(){function t(e){_classCallCheck(this,t),this._platform=e}return _createClass(t,[{key:"isDisabled",value:function(t){return t.hasAttribute("disabled")}},{key:"isVisible",value:function(t){return function(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}},{key:"isTabbable",value:function(t){if(!this._platform.isBrowser)return!1;var e,n=function(t){try{return t.frameElement}catch(Svt){return null}}((e=t).ownerDocument&&e.ownerDocument.defaultView||window);if(n){var r=n&&n.nodeName.toLowerCase();if(-1===ow(n))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===r)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(n))return!1}var i=t.nodeName.toLowerCase(),o=ow(t);if(t.hasAttribute("contenteditable"))return-1!==o;if("iframe"===i)return!1;if("audio"===i){if(!t.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===i){if(!t.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==i||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(t){var e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(t))&&t.tabIndex>=0}},{key:"isFocusable",value:function(t){return function(t){return!function(t){return function(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function(t){var e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function(t){return function(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||iw(t))}(t)&&!this.isDisabled(t)&&this.isVisible(t)}}]),t}()).\u0275fac=function(t){return new(t||Q_)(te(P_))},Q_.\u0275prov=mt({factory:function(){return new Q_(te(P_))},token:Q_,providedIn:"root"}),Q_);function iw(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;var e=t.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function ow(t){if(!iw(t))return null;var e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}var aw,sw=function(){function t(e,n,r,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,t),this._element=e,this._checker=n,this._ngZone=r,this._document=i,this._hasAttached=!1,this.startAnchorListener=function(){return o.focusLastTabbableElement()},this.endAnchorListener=function(){return o.focusFirstTabbableElement()},this._enabled=!0,a||this.attachAnchors()}return _createClass(t,[{key:"destroy",value:function(){var t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),e&&(e.removeEventListener("focus",this.endAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),this._startAnchor=this._endAnchor=null}},{key:"attachAnchors",value:function(){var t=this;return!!this._hasAttached||(this._ngZone.runOutsideAngular((function(){t._startAnchor||(t._startAnchor=t._createAnchor(),t._startAnchor.addEventListener("focus",t.startAnchorListener)),t._endAnchor||(t._endAnchor=t._createAnchor(),t._endAnchor.addEventListener("focus",t.endAnchorListener))})),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}},{key:"focusInitialElementWhenReady",value:function(){var t=this;return new Promise((function(e){t._executeOnStable((function(){return e(t.focusInitialElement())}))}))}},{key:"focusFirstTabbableElementWhenReady",value:function(){var t=this;return new Promise((function(e){t._executeOnStable((function(){return e(t.focusFirstTabbableElement())}))}))}},{key:"focusLastTabbableElementWhenReady",value:function(){var t=this;return new Promise((function(e){t._executeOnStable((function(){return e(t.focusLastTabbableElement())}))}))}},{key:"_getRegionBoundary",value:function(t){for(var e=this._element.querySelectorAll("[cdk-focus-region-".concat(t,"], ")+"[cdkFocusRegion".concat(t,"], ")+"[cdk-focus-".concat(t,"]")),n=0;n<e.length;n++)e[n].hasAttribute("cdk-focus-".concat(t))?console.warn("Found use of deprecated attribute 'cdk-focus-".concat(t,"', ")+"use 'cdkFocusRegion".concat(t,"' instead. The deprecated ")+"attribute will be removed in 8.0.0.",e[n]):e[n].hasAttribute("cdk-focus-region-".concat(t))&&console.warn("Found use of deprecated attribute 'cdk-focus-region-".concat(t,"', ")+"use 'cdkFocusRegion".concat(t,"' instead. The deprecated attribute ")+"will be removed in 8.0.0.",e[n]);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}},{key:"focusInitialElement",value:function(){var t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return t?(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),Sr()&&!this._checker.isFocusable(t)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",t),t.focus(),!0):this.focusFirstTabbableElement()}},{key:"focusFirstTabbableElement",value:function(){var t=this._getRegionBoundary("start");return t&&t.focus(),!!t}},{key:"focusLastTabbableElement",value:function(){var t=this._getRegionBoundary("end");return t&&t.focus(),!!t}},{key:"hasAttached",value:function(){return this._hasAttached}},{key:"_getFirstTabbableElement",value:function(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;for(var e=t.children||t.childNodes,n=0;n<e.length;n++){var r=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(r)return r}return null}},{key:"_getLastTabbableElement",value:function(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;for(var e=t.children||t.childNodes,n=e.length-1;n>=0;n--){var r=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(r)return r}return null}},{key:"_createAnchor",value:function(){var t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}},{key:"_toggleAnchorTabIndex",value:function(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}},{key:"toggleAnchors",value:function(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}},{key:"_executeOnStable",value:function(t){this._ngZone.isStable?t():this._ngZone.onStable.asObservable().pipe(Ep(1)).subscribe(t)}},{key:"enabled",get:function(){return this._enabled},set:function(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}}]),t}(),uw=((aw=function(){function t(e,n,r){_classCallCheck(this,t),this._checker=e,this._ngZone=n,this._document=r}return _createClass(t,[{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new sw(t,this._checker,this._ngZone,this._document,e)}}]),t}()).\u0275fac=function(t){return new(t||aw)(te(rw),te(xc),te(nl))},aw.\u0275prov=mt({factory:function(){return new aw(te(rw),te(xc),te(nl))},token:aw,providedIn:"root"}),aw);"undefined"!=typeof Element&&Element;var cw,lw=new Ht("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),hw=new Ht("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),fw=((cw=function(){function t(e,n,r,i){_classCallCheck(this,t),this._ngZone=n,this._defaultOptions=i,this._document=r,this._liveElement=e||this._createLiveElement()}return _createClass(t,[{key:"announce",value:function(t){for(var e,n,r,i=this,o=this._defaultOptions,a=arguments.length,s=new Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=arguments[u];return 1===s.length&&"number"==typeof s[0]?r=s[0]:(n=(e=_slicedToArray(s,2))[0],r=e[1]),this.clear(),clearTimeout(this._previousTimeout),n||(n=o&&o.politeness?o.politeness:"polite"),null==r&&o&&(r=o.duration),this._liveElement.setAttribute("aria-live",n),this._ngZone.runOutsideAngular((function(){return new Promise((function(e){clearTimeout(i._previousTimeout),i._previousTimeout=setTimeout((function(){i._liveElement.textContent=t,e(),"number"==typeof r&&(i._previousTimeout=setTimeout((function(){return i.clear()}),r))}),100)}))}))}},{key:"clear",value:function(){this._liveElement&&(this._liveElement.textContent="")}},{key:"ngOnDestroy",value:function(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}},{key:"_createLiveElement",value:function(){for(var t=this._document.getElementsByClassName("cdk-live-announcer-element"),e=this._document.createElement("div"),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e.classList.add("cdk-live-announcer-element"),e.classList.add("cdk-visually-hidden"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),e}}]),t}()).\u0275fac=function(t){return new(t||cw)(te(lw,8),te(xc),te(nl),te(hw,8))},cw.\u0275prov=mt({factory:function(){return new cw(te(lw,8),te(xc),te(nl),te(hw,8))},token:cw,providedIn:"root"}),cw);function dw(t){return 0===t.buttons}var pw,vw=new Ht("cdk-focus-monitor-default-options"),mw=B_({passive:!0,capture:!0}),gw=((pw=function(){function t(e,n,r,i){var o=this;_classCallCheck(this,t),this._ngZone=e,this._platform=n,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=function(){o._lastTouchTarget=null,o._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=function(t){if(!o._lastTouchTarget){var e=dw(t)?"keyboard":"mouse";o._setOriginForCurrentEventQueue(e)}},this._documentTouchstartListener=function(t){null!=o._touchTimeoutId&&clearTimeout(o._touchTimeoutId),o._lastTouchTarget=yw(t),o._touchTimeoutId=setTimeout((function(){return o._lastTouchTarget=null}),650)},this._windowFocusListener=function(){o._windowFocused=!0,o._windowFocusTimeoutId=setTimeout((function(){return o._windowFocused=!1}))},this._rootNodeFocusAndBlurListener=function(t){for(var e=yw(t),n="focus"===t.type?o._onFocus:o._onBlur,r=e;r;r=r.parentElement)n.call(o,t,r)},this._document=r,this._detectionMode=(null==i?void 0:i.detectionMode)||0}return _createClass(t,[{key:"monitor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._platform.isBrowser)return Yd(null);var n=I_(t),r=V_(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return e&&(i.checkChildren=!0),i.subject.asObservable();var o={checkChildren:e,subject:new O,rootNode:r};return this._elementInfo.set(n,o),this._registerGlobalListeners(o),o.subject.asObservable()}},{key:"stopMonitoring",value:function(t){var e=I_(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}},{key:"focusVia",value:function(t,e,n){var r=I_(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}},{key:"ngOnDestroy",value:function(){var t=this;this._elementInfo.forEach((function(e,n){return t.stopMonitoring(n)}))}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_toggleClass",value:function(t,e,n){n?t.classList.add(e):t.classList.remove(e)}},{key:"_getFocusOrigin",value:function(t){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"}},{key:"_setClasses",value:function(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}},{key:"_setOriginForCurrentEventQueue",value:function(t){var e=this;this._ngZone.runOutsideAngular((function(){e._origin=t,0===e._detectionMode&&(e._originTimeoutId=setTimeout((function(){return e._origin=null}),1))}))}},{key:"_wasCausedByTouch",value:function(t){var e=yw(t);return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}},{key:"_onFocus",value:function(t,e){var n=this._elementInfo.get(e);if(n&&(n.checkChildren||e===yw(t))){var r=this._getFocusOrigin(t);this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}}},{key:"_onBlur",value:function(t,e){var n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}},{key:"_emitOrigin",value:function(t,e){this._ngZone.run((function(){return t.next(e)}))}},{key:"_registerGlobalListeners",value:function(t){var e=this;if(this._platform.isBrowser){var n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular((function(){n.addEventListener("focus",e._rootNodeFocusAndBlurListener,mw),n.addEventListener("blur",e._rootNodeFocusAndBlurListener,mw)})),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular((function(){var t=e._getDocument(),n=e._getWindow();t.addEventListener("keydown",e._documentKeydownListener,mw),t.addEventListener("mousedown",e._documentMousedownListener,mw),t.addEventListener("touchstart",e._documentTouchstartListener,mw),n.addEventListener("focus",e._windowFocusListener)}))}}},{key:"_removeGlobalListeners",value:function(t){var e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){var n=this._rootNodeFocusListenerCount.get(e);n>1?this._rootNodeFocusListenerCount.set(e,n-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,mw),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,mw),this._rootNodeFocusListenerCount.delete(e))}if(!--this._monitoredElementCount){var r=this._getDocument(),i=this._getWindow();r.removeEventListener("keydown",this._documentKeydownListener,mw),r.removeEventListener("mousedown",this._documentMousedownListener,mw),r.removeEventListener("touchstart",this._documentTouchstartListener,mw),i.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}]),t}()).\u0275fac=function(t){return new(t||pw)(te(xc),te(P_),te(nl,8),te(vw,8))},pw.\u0275prov=mt({factory:function(){return new pw(te(xc),te(P_),te(nl,8),te(vw,8))},token:pw,providedIn:"root"}),pw);function yw(t){return t.composedPath?t.composedPath()[0]:t.target}var bw,_w,ww,xw,Cw=((_w=function(){function t(e,n){_classCallCheck(this,t),this._platform=e,this._document=n}return _createClass(t,[{key:"getHighContrastMode",value:function(){if(!this._platform.isBrowser)return 0;var t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);var e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}},{key:"_applyBodyHighContrastModeCssClasses",value:function(){if(this._platform.isBrowser&&this._document.body){var t=this._document.body.classList;t.remove("cdk-high-contrast-active"),t.remove("cdk-high-contrast-black-on-white"),t.remove("cdk-high-contrast-white-on-black");var e=this.getHighContrastMode();1===e?(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-black-on-white")):2===e&&(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-white-on-black"))}}}]),t}()).\u0275fac=function(t){return new(t||_w)(te(P_),te(nl))},_w.\u0275prov=mt({factory:function(){return new _w(te(P_),te(nl))},token:_w,providedIn:"root"}),_w),kw=((bw=function t(e){_classCallCheck(this,t),e._applyBodyHighContrastModeCssClasses()}).\u0275mod=Ce({type:bw}),bw.\u0275inj=gt({factory:function(t){return new(t||bw)(te(Cw))},imports:[[M_,X_]]}),bw),Ew=new Ht("cdk-dir-doc",{providedIn:"root",factory:function(){return ee(nl)}}),Sw=((xw=function(){function t(e){if(_classCallCheck(this,t),this.value="ltr",this.change=new Nu,e){var n=e.documentElement?e.documentElement.dir:null,r=(e.body?e.body.dir:null)||n;this.value="ltr"===r||"rtl"===r?r:"ltr"}}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.change.complete()}}]),t}()).\u0275fac=function(t){return new(t||xw)(te(Ew,8))},xw.\u0275prov=mt({factory:function(){return new xw(te(Ew,8))},token:xw,providedIn:"root"}),xw),Iw=((ww=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:ww}),ww.\u0275inj=gt({factory:function(t){return new(t||ww)}}),ww),Tw=new Xs("9.2.4"),Aw=["*",[["mat-option"],["ng-container"]]],Rw=["*","mat-option, ng-container"];function Ow(t,e){if(1&t&&Ra(0,"mat-pseudo-checkbox",3),2&t){var n=za();Sa("state",n.selected?"checked":"unchecked")("disabled",n.disabled)}}var Nw,Dw=["*"],Pw=function(){var t=function t(){_classCallCheck(this,t)};return t.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",t.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",t.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",t.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",t}(),Mw=function(){var t=function t(){_classCallCheck(this,t)};return t.COMPLEX="375ms",t.ENTERING="225ms",t.EXITING="195ms",t}(),Fw=new Xs("9.2.4"),Lw=new Ht("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}}),Bw=((Nw=function(){function t(e,n,r){_classCallCheck(this,t),this._hasDoneGlobalChecks=!1,this._document=r,e._applyBodyHighContrastModeCssClasses(),this._sanityChecks=n,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}return _createClass(t,[{key:"_getDocument",value:function(){var t=this._document||document;return"object"==typeof t&&t?t:null}},{key:"_getWindow",value:function(){var t=this._getDocument(),e=(null==t?void 0:t.defaultView)||window;return"object"==typeof e&&e?e:null}},{key:"_checksAreEnabled",value:function(){return Sr()&&!this._isTestEnv()}},{key:"_isTestEnv",value:function(){var t=this._getWindow();return t&&(t.__karma__||t.jasmine)}},{key:"_checkDoctypeIsDefined",value:function(){var t=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),e=this._getDocument();t&&e&&!e.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}},{key:"_checkThemeIsPresent",value:function(){var t=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,e=this._getDocument();if(!t&&e&&e.body&&"function"==typeof getComputedStyle){var n=e.createElement("div");n.classList.add("mat-theme-loaded-marker"),e.body.appendChild(n);var r=getComputedStyle(n);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),e.body.removeChild(n)}}},{key:"_checkCdkVersionMatch",value:function(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&Fw.full!==Tw.full&&console.warn("The Angular Material version ("+Fw.full+") does not match the Angular CDK version ("+Tw.full+").\nPlease ensure the versions of these two packages exactly match.")}}]),t}()).\u0275mod=Ce({type:Nw}),Nw.\u0275inj=gt({factory:function(t){return new(t||Nw)(te(Cw),te(Lw,8),te(nl,8))},imports:[[Iw],Iw]}),Nw);function jw(t){return function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i)))._disabled=!1,t}return _createClass(n,[{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=x_(t)}}]),n}(t)}function Vw(t,e){return function(t){_inherits(r,t);var n=_createSuper(r);function r(){var t;_classCallCheck(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=n.call.apply(n,[this].concat(o))).color=e,t}return _createClass(r,[{key:"color",get:function(){return this._color},set:function(t){var n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-".concat(this._color)),n&&this._elementRef.nativeElement.classList.add("mat-".concat(n)),this._color=n)}}]),r}(t)}function Uw(t){return function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i)))._disableRipple=!1,t}return _createClass(n,[{key:"disableRipple",get:function(){return this._disableRipple},set:function(t){this._disableRipple=x_(t)}}]),n}(t)}function zw(t){return function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).errorState=!1,t.stateChanges=new O,t}return _createClass(n,[{key:"updateErrorState",value:function(){var t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}]),n}(t)}function Ww(t){return function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i)))._isInitialized=!1,t._pendingSubscribers=[],t.initialized=new E((function(e){t._isInitialized?t._notifySubscriber(e):t._pendingSubscribers.push(e)})),t}return _createClass(n,[{key:"_markInitialized",value:function(){if(this._isInitialized)throw Error("This directive has already been marked as initialized and should not be called twice.");this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}},{key:"_notifySubscriber",value:function(t){t.next(),t.complete()}}]),n}(t)}var qw,Hw=new Ht("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return ee(cc)}}),Gw=function(){function t(){_classCallCheck(this,t),this._localeChanges=new O}return _createClass(t,[{key:"deserialize",value:function(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}},{key:"setLocale",value:function(t){this.locale=t,this._localeChanges.next()}},{key:"compareDate",value:function(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}},{key:"sameDate",value:function(t,e){if(t&&e){var n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}},{key:"clampDate",value:function(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}},{key:"localeChanges",get:function(){return this._localeChanges}}]),t}(),Kw=new Ht("mat-date-formats");try{qw="undefined"!=typeof Intl}catch(Svt){qw=!1}var Xw={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},$w=Jw(31,(function(t){return String(t+1)})),Yw={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},Qw=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Jw(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=e(r);return n}var Zw,tx,ex,nx,rx,ix,ox,ax,sx,ux,cx,lx=((tx=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,o;return _classCallCheck(this,n),(o=e.call(this)).useUtcForDisplay=!0,_get((i=_assertThisInitialized(o),_getPrototypeOf(n.prototype)),"setLocale",i).call(i,t),o.useUtcForDisplay=!r.TRIDENT,o._clampDate=r.TRIDENT||r.EDGE,o}return _createClass(n,[{key:"getYear",value:function(t){return t.getFullYear()}},{key:"getMonth",value:function(t){return t.getMonth()}},{key:"getDate",value:function(t){return t.getDate()}},{key:"getDayOfWeek",value:function(t){return t.getDay()}},{key:"getMonthNames",value:function(t){var e=this;if(qw){var n=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return Jw(12,(function(t){return e._stripDirectionalityCharacters(e._format(n,new Date(2017,t,1)))}))}return Xw[t]}},{key:"getDateNames",value:function(){var t=this;if(qw){var e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Jw(31,(function(n){return t._stripDirectionalityCharacters(t._format(e,new Date(2017,0,n+1)))}))}return $w}},{key:"getDayOfWeekNames",value:function(t){var e=this;if(qw){var n=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return Jw(7,(function(t){return e._stripDirectionalityCharacters(e._format(n,new Date(2017,0,t+1)))}))}return Yw[t]}},{key:"getYearName",value:function(t){if(qw){var e=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(e,t))}return String(this.getYear(t))}},{key:"getFirstDayOfWeek",value:function(){return 0}},{key:"getNumDaysInMonth",value:function(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}},{key:"clone",value:function(t){return new Date(t.getTime())}},{key:"createDate",value:function(t,e,n){if(e<0||e>11)throw Error('Invalid month index "'.concat(e,'". Month index has to be between 0 and 11.'));if(n<1)throw Error('Invalid date "'.concat(n,'". Date has to be greater than 0.'));var r=this._createDateWithOverflow(t,e,n);if(r.getMonth()!=e)throw Error('Invalid date "'.concat(n,'" for month with index "').concat(e,'".'));return r}},{key:"today",value:function(){return new Date}},{key:"parse",value:function(t){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}},{key:"format",value:function(t,e){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");if(qw){this._clampDate&&(t.getFullYear()<1||t.getFullYear()>9999)&&(t=this.clone(t)).setFullYear(Math.max(1,Math.min(9999,t.getFullYear()))),e=Object.assign(Object.assign({},e),{timeZone:"utc"});var n=new Intl.DateTimeFormat(this.locale,e);return this._stripDirectionalityCharacters(this._format(n,t))}return this._stripDirectionalityCharacters(t.toDateString())}},{key:"addCalendarYears",value:function(t,e){return this.addCalendarMonths(t,12*e)}},{key:"addCalendarMonths",value:function(t,e){var n=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+e,this.getDate(t));return this.getMonth(n)!=((this.getMonth(t)+e)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}},{key:"addCalendarDays",value:function(t,e){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+e)}},{key:"toIso8601",value:function(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}},{key:"deserialize",value:function(t){if("string"==typeof t){if(!t)return null;if(Qw.test(t)){var e=new Date(t);if(this.isValid(e))return e}}return _get(_getPrototypeOf(n.prototype),"deserialize",this).call(this,t)}},{key:"isDateInstance",value:function(t){return t instanceof Date}},{key:"isValid",value:function(t){return!isNaN(t.getTime())}},{key:"invalid",value:function(){return new Date(NaN)}},{key:"_createDateWithOverflow",value:function(t,e,n){var r=new Date(t,e,n);return t>=0&&t<100&&r.setFullYear(this.getYear(r)-1900),r}},{key:"_2digit",value:function(t){return("00"+t).slice(-2)}},{key:"_stripDirectionalityCharacters",value:function(t){return t.replace(/[\u200e\u200f]/g,"")}},{key:"_format",value:function(t,e){var n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.format(n)}}]),n}(Gw)).\u0275fac=function(t){return new(t||tx)(te(Hw,8),te(P_))},tx.\u0275prov=mt({token:tx,factory:tx.\u0275fac}),tx),hx=((Zw=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Zw}),Zw.\u0275inj=gt({factory:function(t){return new(t||Zw)},providers:[{provide:Gw,useClass:lx}],imports:[[M_]]}),Zw),fx={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}},dx=((rx=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:rx}),rx.\u0275inj=gt({factory:function(t){return new(t||rx)},providers:[{provide:Kw,useValue:fx}],imports:[[hx]]}),rx),px=((nx=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"isErrorState",value:function(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}]),t}()).\u0275fac=function(t){return new(t||nx)},nx.\u0275prov=mt({factory:function(){return new nx},token:nx,providedIn:"root"}),nx),vx=((ex=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:ex}),ex.\u0275inj=gt({factory:function(t){return new(t||ex)},imports:[[Bw],Bw]}),ex),mx=function(){function t(e,n,r){_classCallCheck(this,t),this._renderer=e,this.element=n,this.config=r,this.state=3}return _createClass(t,[{key:"fadeOut",value:function(){this._renderer.fadeOutRipple(this)}}]),t}(),gx={enterDuration:450,exitDuration:400},yx=B_({passive:!0}),bx=["mousedown","touchstart"],_x=["mouseup","mouseleave","touchend","touchcancel"],wx=function(){function t(e,n,r,i){_classCallCheck(this,t),this._target=e,this._ngZone=n,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=I_(r))}return _createClass(t,[{key:"fadeInRipple",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=Object.assign(Object.assign({},gx),r.animation);r.centered&&(t=i.left+i.width/2,e=i.top+i.height/2);var a=r.radius||function(t,e,n){var r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,i),s=t-i.left,u=e-i.top,c=o.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left="".concat(s-a,"px"),l.style.top="".concat(u-a,"px"),l.style.height="".concat(2*a,"px"),l.style.width="".concat(2*a,"px"),null!=r.color&&(l.style.backgroundColor=r.color),l.style.transitionDuration="".concat(c,"ms"),this._containerElement.appendChild(l),window.getComputedStyle(l).getPropertyValue("opacity"),l.style.transform="scale(1)";var h=new mx(this,l,r);return h.state=0,this._activeRipples.add(h),r.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone((function(){var t=h===n._mostRecentTransientRipple;h.state=1,r.persistent||t&&n._isPointerDown||h.fadeOut()}),c),h}},{key:"fadeOutRipple",value:function(t){var e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),e){var n=t.element,r=Object.assign(Object.assign({},gx),t.config.animation);n.style.transitionDuration="".concat(r.exitDuration,"ms"),n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone((function(){t.state=3,n.parentNode.removeChild(n)}),r.exitDuration)}}},{key:"fadeOutAll",value:function(){this._activeRipples.forEach((function(t){return t.fadeOut()}))}},{key:"setupTriggerEvents",value:function(t){var e=I_(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(bx))}},{key:"handleEvent",value:function(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(_x),this._pointerUpEventsRegistered=!0)}},{key:"_onMousedown",value:function(t){var e=dw(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}},{key:"_onTouchStart",value:function(t){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;for(var e=t.changedTouches,n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}},{key:"_onPointerUp",value:function(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach((function(t){!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()})))}},{key:"_runTimeoutOutsideZone",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._ngZone.runOutsideAngular((function(){return setTimeout(t,e)}))}},{key:"_registerEvents",value:function(t){var e=this;this._ngZone.runOutsideAngular((function(){t.forEach((function(t){e._triggerElement.addEventListener(t,e,yx)}))}))}},{key:"_removeTriggerEvents",value:function(){var t=this;this._triggerElement&&(bx.forEach((function(e){t._triggerElement.removeEventListener(e,t,yx)})),this._pointerUpEventsRegistered&&_x.forEach((function(e){t._triggerElement.removeEventListener(e,t,yx)})))}}]),t}(),xx=new Ht("mat-ripple-global-options"),Cx=((sx=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this._elementRef=e,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=i||{},this._rippleRenderer=new wx(this,n,e,r)}return _createClass(t,[{key:"ngOnInit",value:function(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}},{key:"ngOnDestroy",value:function(){this._rippleRenderer._removeTriggerEvents()}},{key:"fadeOutAll",value:function(){this._rippleRenderer.fadeOutAll()}},{key:"_setupTriggerEventsIfEnabled",value:function(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}},{key:"launch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}},{key:"trigger",get:function(){return this._trigger||this._elementRef.nativeElement},set:function(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}},{key:"rippleConfig",get:function(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}},{key:"rippleDisabled",get:function(){return this.disabled||!!this._globalOptions.disabled}}]),t}()).\u0275fac=function(t){return new(t||sx)(Ca(Us),Ca(xc),Ca(P_),Ca(xx,8),Ca(c_,8))},sx.\u0275dir=Ee({type:sx,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&ns("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),sx),kx=((ax=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:ax}),ax.\u0275inj=gt({factory:function(t){return new(t||ax)},imports:[[Bw,M_],Bw]}),ax),Ex=((ox=function t(e){_classCallCheck(this,t),this._animationMode=e,this.state="unchecked",this.disabled=!1}).\u0275fac=function(t){return new(t||ox)(Ca(c_,8))},ox.\u0275cmp=be({type:ox,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(t,e){2&t&&ns("mat-pseudo-checkbox-indeterminate","indeterminate"===e.state)("mat-pseudo-checkbox-checked","checked"===e.state)("mat-pseudo-checkbox-disabled",e.disabled)("_mat-animation-noopable","NoopAnimations"===e._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(t,e){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),ox),Sx=((ix=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:ix}),ix.\u0275inj=gt({factory:function(t){return new(t||ix)}}),ix),Ix=jw((function t(){_classCallCheck(this,t)})),Tx=0,Ax=((ux=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments))._labelId="mat-optgroup-label-".concat(Tx++),t}return n}(Ix)).\u0275fac=function(t){return Rx(t||ux)},ux.\u0275cmp=be({type:ux,selectors:[["mat-optgroup"]],hostAttrs:["role","group",1,"mat-optgroup"],hostVars:4,hostBindings:function(t,e){2&t&&(ba("aria-disabled",e.disabled.toString())("aria-labelledby",e._labelId),ns("mat-optgroup-disabled",e.disabled))},inputs:{disabled:"disabled",label:"label"},exportAs:["matOptgroup"],features:[ws],ngContentSelectors:Rw,decls:4,vars:2,consts:[[1,"mat-optgroup-label",3,"id"]],template:function(t,e){1&t&&(qa(Aw),Ta(0,"label",0),ps(1),Ha(2),Aa(),Ha(3,1)),2&t&&(Sa("id",e._labelId),di(1),ms("",e.label," "))},styles:[".mat-optgroup-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup-label[disabled]{cursor:default}[dir=rtl] .mat-optgroup-label{text-align:right}.mat-optgroup-label .mat-icon{margin-right:16px;vertical-align:middle}.mat-optgroup-label .mat-icon svg{vertical-align:top}[dir=rtl] .mat-optgroup-label .mat-icon{margin-left:16px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),ux),Rx=lr(Ax),Ox=0,Nx=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,t),this.source=e,this.isUserInput=n},Dx=new Ht("MAT_OPTION_PARENT_COMPONENT"),Px=((cx=function(){function t(e,n,r,i){_classCallCheck(this,t),this._element=e,this._changeDetectorRef=n,this._parent=r,this.group=i,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-".concat(Ox++),this.onSelectionChange=new Nu,this._stateChanges=new O}return _createClass(t,[{key:"select",value:function(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}},{key:"deselect",value:function(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}},{key:"focus",value:function(t,e){var n=this._getHostElement();"function"==typeof n.focus&&n.focus(e)}},{key:"setActiveStyles",value:function(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}},{key:"setInactiveStyles",value:function(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}},{key:"getLabel",value:function(){return this.viewValue}},{key:"_handleKeydown",value:function(t){13!==t.keyCode&&32!==t.keyCode||f_(t)||(this._selectViaInteraction(),t.preventDefault())}},{key:"_selectViaInteraction",value:function(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}},{key:"_getAriaSelected",value:function(){return this.selected||!this.multiple&&null}},{key:"_getTabIndex",value:function(){return this.disabled?"-1":"0"}},{key:"_getHostElement",value:function(){return this._element.nativeElement}},{key:"ngAfterViewChecked",value:function(){if(this._selected){var t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue=t,this._stateChanges.next())}}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"_emitSelectionChangeEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onSelectionChange.emit(new Nx(this,t))}},{key:"multiple",get:function(){return this._parent&&this._parent.multiple}},{key:"selected",get:function(){return this._selected}},{key:"disabled",get:function(){return this.group&&this.group.disabled||this._disabled},set:function(t){this._disabled=x_(t)}},{key:"disableRipple",get:function(){return this._parent&&this._parent.disableRipple}},{key:"active",get:function(){return this._active}},{key:"viewValue",get:function(){return(this._getHostElement().textContent||"").trim()}}]),t}()).\u0275fac=function(t){return new(t||cx)(Ca(Us),Ca(Wo),Ca(Dx,8),Ca(Ax,8))},cx.\u0275cmp=be({type:cx,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(t,e){1&t&&La("click",(function(){return e._selectViaInteraction()}))("keydown",(function(t){return e._handleKeydown(t)})),2&t&&(ys("id",e.id),ba("tabindex",e._getTabIndex())("aria-selected",e._getAriaSelected())("aria-disabled",e.disabled.toString()),ns("mat-selected",e.selected)("mat-option-multiple",e.multiple)("mat-active",e.active)("mat-option-disabled",e.disabled))},inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:Dw,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(t,e){1&t&&(qa(),wa(0,Ow,1,2,"mat-pseudo-checkbox",0),Ta(1,"span",1),Ha(2),Aa(),Ra(3,"div",2)),2&t&&(Sa("ngIf",e.multiple),di(3),Sa("matRippleTrigger",e._getHostElement())("matRippleDisabled",e.disabled||e.disableRipple))},directives:[Ll,Cx,Ex],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),cx);function Mx(t,e,n){if(n.length){for(var r=e.toArray(),i=n.toArray(),o=0,a=0;a<t+1;a++)r[a].group&&r[a].group===i[o]&&o++;return o}return 0}var Fx,Lx,Bx=((Fx=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Fx}),Fx.\u0275inj=gt({factory:function(t){return new(t||Fx)},imports:[[kx,th,Sx]]}),Fx),jx=new Ht("mat-label-global-options"),Vx=["*"],Ux=new Ht("MAT_GRID_LIST"),zx=((Lx=function(){function t(e,n){_classCallCheck(this,t),this._element=e,this._gridList=n,this._rowspan=1,this._colspan=1}return _createClass(t,[{key:"_setStyle",value:function(t,e){this._element.nativeElement.style[t]=e}},{key:"rowspan",get:function(){return this._rowspan},set:function(t){this._rowspan=Math.round(C_(t))}},{key:"colspan",get:function(){return this._colspan},set:function(t){this._colspan=Math.round(C_(t))}}]),t}()).\u0275fac=function(t){return new(t||Lx)(Ca(Us),Ca(Ux,8))},Lx.\u0275cmp=be({type:Lx,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(t,e){2&t&&ba("rowspan",e.rowspan)("colspan",e.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:Vx,decls:2,vars:0,consts:[[1,"mat-figure"]],template:function(t,e){1&t&&(qa(),Ta(0,"figure",0),Ha(1),Aa())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-figure{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}\n"],encapsulation:2,changeDetection:0}),Lx),Wx=function(){function t(){_classCallCheck(this,t),this.columnIndex=0,this.rowIndex=0}return _createClass(t,[{key:"update",value:function(t,e){var n=this;this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map((function(t){return n._trackTile(t)}))}},{key:"_trackTile",value:function(t){var e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new qx(this.rowIndex,e)}},{key:"_findMatchingGap",value:function(t){if(t>this.tracker.length)throw Error("mat-grid-list: tile with colspan ".concat(t," is wider than ")+'grid with cols="'.concat(this.tracker.length,'".'));var e=-1,n=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)):-1!=(e=this.tracker.indexOf(0,this.columnIndex))?(n=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e))}while(n-e<t||0==n);return Math.max(e,0)}},{key:"_nextRow",value:function(){this.columnIndex=0,this.rowIndex++;for(var t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}},{key:"_findGapEndIndex",value:function(t){for(var e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}},{key:"_markTilePosition",value:function(t,e){for(var n=0;n<e.colspan;n++)this.tracker[t+n]=e.rowspan}},{key:"rowCount",get:function(){return this.rowIndex+1}},{key:"rowspan",get:function(){var t=Math.max.apply(Math,_toConsumableArray(this.tracker));return t>1?this.rowCount+t-1:this.rowCount}}]),t}(),qx=function t(e,n){_classCallCheck(this,t),this.row=e,this.col=n},Hx=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/,Gx=function(){function t(){_classCallCheck(this,t),this._rows=0,this._rowspan=0}return _createClass(t,[{key:"init",value:function(t,e,n,r){this._gutterSize=Qx(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=n,this._direction=r}},{key:"getBaseTileSize",value:function(t,e){return"(".concat(t,"% - (").concat(this._gutterSize," * ").concat(e,"))")}},{key:"getTilePosition",value:function(t,e){return 0===e?"0":Yx("(".concat(t," + ").concat(this._gutterSize,") * ").concat(e))}},{key:"getTileSize",value:function(t,e){return"(".concat(t," * ").concat(e,") + (").concat(e-1," * ").concat(this._gutterSize,")")}},{key:"setStyle",value:function(t,e,n){var r=100/this._cols,i=(this._cols-1)/this._cols;this.setColStyles(t,n,r,i),this.setRowStyles(t,e,r,i)}},{key:"setColStyles",value:function(t,e,n,r){var i=this.getBaseTileSize(n,r);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(i,e)),t._setStyle("width",Yx(this.getTileSize(i,t.colspan)))}},{key:"getGutterSpan",value:function(){return"".concat(this._gutterSize," * (").concat(this._rowspan," - 1)")}},{key:"getTileSpan",value:function(t){return"".concat(this._rowspan," * ").concat(this.getTileSize(t,1))}},{key:"getComputedHeight",value:function(){return null}}]),t}(),Kx=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).fixedRowHeight=t,r}return _createClass(n,[{key:"init",value:function(t,e,r,i){if(_get(_getPrototypeOf(n.prototype),"init",this).call(this,t,e,r,i),this.fixedRowHeight=Qx(this.fixedRowHeight),!Hx.test(this.fixedRowHeight))throw Error('Invalid value "'.concat(this.fixedRowHeight,'" set as rowHeight.'))}},{key:"setRowStyles",value:function(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",Yx(this.getTileSize(this.fixedRowHeight,t.rowspan)))}},{key:"getComputedHeight",value:function(){return["height",Yx("".concat(this.getTileSpan(this.fixedRowHeight)," + ").concat(this.getGutterSpan()))]}},{key:"reset",value:function(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach((function(t){t._setStyle("top",null),t._setStyle("height",null)}))}}]),n}(Gx),Xx=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._parseRatio(t),r}return _createClass(n,[{key:"setRowStyles",value:function(t,e,n,r){this.baseTileHeight=this.getBaseTileSize(n/this.rowHeightRatio,r),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",Yx(this.getTileSize(this.baseTileHeight,t.rowspan)))}},{key:"getComputedHeight",value:function(){return["paddingBottom",Yx("".concat(this.getTileSpan(this.baseTileHeight)," + ").concat(this.getGutterSpan()))]}},{key:"reset",value:function(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach((function(t){t._setStyle("marginTop",null),t._setStyle("paddingTop",null)}))}},{key:"_parseRatio",value:function(t){var e=t.split(":");if(2!==e.length)throw Error('mat-grid-list: invalid ratio given for row-height: "'.concat(t,'"'));this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}]),n}(Gx),$x=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"setRowStyles",value:function(t,e){var n=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(n,e)),t._setStyle("height",Yx(this.getTileSize(n,t.rowspan)))}},{key:"reset",value:function(t){t._tiles&&t._tiles.forEach((function(t){t._setStyle("top",null),t._setStyle("height",null)}))}}]),n}(Gx);function Yx(t){return"calc(".concat(t,")")}function Qx(t){return t.match(/([A-Za-z%]+)$/)?t:"".concat(t,"px")}var Jx,Zx,tC,eC,nC,rC,iC=((tC=function(){function t(e,n){_classCallCheck(this,t),this._element=e,this._dir=n,this._gutter="1px"}return _createClass(t,[{key:"ngOnInit",value:function(){this._checkCols(),this._checkRowHeight()}},{key:"ngAfterContentChecked",value:function(){this._layoutTiles()}},{key:"_checkCols",value:function(){if(!this.cols)throw Error('mat-grid-list: must pass in number of columns. Example: <mat-grid-list cols="3">')}},{key:"_checkRowHeight",value:function(){this._rowHeight||this._setTileStyler("1:1")}},{key:"_setTileStyler",value:function(t){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===t?new $x:t&&t.indexOf(":")>-1?new Xx(t):new Kx(t)}},{key:"_layoutTiles",value:function(){var t=this;this._tileCoordinator||(this._tileCoordinator=new Wx);var e=this._tileCoordinator,n=this._tiles.filter((function(e){return!e._gridList||e._gridList===t})),r=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,n),this._tileStyler.init(this.gutterSize,e,this.cols,r),n.forEach((function(n,r){var i=e.positions[r];t._tileStyler.setStyle(n,i.row,i.col)})),this._setListStyle(this._tileStyler.getComputedHeight())}},{key:"_setListStyle",value:function(t){t&&(this._element.nativeElement.style[t[0]]=t[1])}},{key:"cols",get:function(){return this._cols},set:function(t){this._cols=Math.max(1,Math.round(C_(t)))}},{key:"gutterSize",get:function(){return this._gutter},set:function(t){this._gutter="".concat(null==t?"":t)}},{key:"rowHeight",get:function(){return this._rowHeight},set:function(t){var e="".concat(null==t?"":t);e!==this._rowHeight&&(this._rowHeight=e,this._setTileStyler(this._rowHeight))}}]),t}()).\u0275fac=function(t){return new(t||tC)(Ca(Us),Ca(Sw,8))},tC.\u0275cmp=be({type:tC,selectors:[["mat-grid-list"]],contentQueries:function(t,e,n){var r;1&t&&Ku(n,zx,!0),2&t&&Wu(r=Yu())&&(e._tiles=r)},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(t,e){2&t&&ba("cols",e.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[Ls([{provide:Ux,useExisting:tC}])],ngContentSelectors:Vx,decls:2,vars:0,template:function(t,e){1&t&&(qa(),Ta(0,"div"),Ha(1),Aa())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-figure{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}\n"],encapsulation:2,changeDetection:0}),tC),oC=((Zx=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Zx}),Zx.\u0275inj=gt({factory:function(t){return new(t||Zx)},imports:[[vx,Bw],vx,Bw]}),Zx),aC=((Jx=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Jx}),Jx.\u0275inj=gt({factory:function(t){return new(t||Jx)},imports:[[th,Bw],Bw]}),Jx),sC=["mat-button",""],uC=["*"],cC=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],lC=Vw(jw(Uw((function t(e){_classCallCheck(this,t),this._elementRef=e})))),hC=((rC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;_classCallCheck(this,n),(o=e.call(this,t))._focusMonitor=r,o._animationMode=i,o.isRoundButton=o._hasHostAttributes("mat-fab","mat-mini-fab"),o.isIconButton=o._hasHostAttributes("mat-icon-button");var a,s=_createForOfIteratorHelper(cC);try{for(s.s();!(a=s.n()).done;){var u=a.value;o._hasHostAttributes(u)&&o._getHostElement().classList.add(u)}}catch(c){s.e(c)}finally{s.f()}return t.nativeElement.classList.add("mat-button-base"),o._focusMonitor.monitor(o._elementRef,!0),o.isRoundButton&&(o.color="accent"),o}return _createClass(n,[{key:"ngOnDestroy",value:function(){this._focusMonitor.stopMonitoring(this._elementRef)}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"program",e=arguments.length>1?arguments[1]:void 0;this._focusMonitor.focusVia(this._getHostElement(),t,e)}},{key:"_getHostElement",value:function(){return this._elementRef.nativeElement}},{key:"_isRippleDisabled",value:function(){return this.disableRipple||this.disabled}},{key:"_hasHostAttributes",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.some((function(e){return t._getHostElement().hasAttribute(e)}))}}]),n}(lC)).\u0275fac=function(t){return new(t||rC)(Ca(Us),Ca(gw),Ca(c_,8))},rC.\u0275cmp=be({type:rC,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,e){var n;1&t&&Hu(Cx,!0),2&t&&Wu(n=Yu())&&(e.ripple=n.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:3,hostBindings:function(t,e){2&t&&(ba("disabled",e.disabled||null),ns("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ws],attrs:sC,ngContentSelectors:uC,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(qa(),Ta(0,"span",0),Ha(1),Aa(),Ra(2,"div",1),Ra(3,"div",2)),2&t&&(di(2),ns("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Sa("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[Cx],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),rC),fC=((nC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){return _classCallCheck(this,n),e.call(this,r,t,i)}return _createClass(n,[{key:"_haltDisabledEvents",value:function(t){this.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}}]),n}(hC)).\u0275fac=function(t){return new(t||nC)(Ca(gw),Ca(Us),Ca(c_,8))},nC.\u0275cmp=be({type:nC,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,e){1&t&&La("click",(function(t){return e._haltDisabledEvents(t)})),2&t&&(ba("tabindex",e.disabled?-1:e.tabIndex||0)("disabled",e.disabled||null)("aria-disabled",e.disabled.toString()),ns("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[ws],attrs:sC,ngContentSelectors:uC,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(qa(),Ta(0,"span",0),Ha(1),Aa(),Ra(2,"div",1),Ra(3,"div",2)),2&t&&(di(2),ns("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Sa("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[Cx],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),nC),dC=((eC=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:eC}),eC.\u0275inj=gt({factory:function(t){return new(t||eC)},imports:[[kx,Bw],Bw]}),eC);function pC(t,e,n,r){return a(n)&&(r=n,n=void 0),r?pC(t,e,n).pipe(z((function(t){return h(t)?r.apply(void 0,_toConsumableArray(t)):r(t)}))):new E((function(r){!function t(e,n,r,i,o){var a;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){var s=e;e.addEventListener(n,r,o),a=function(){return s.removeEventListener(n,r,o)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){var u=e;e.on(n,r),a=function(){return u.off(n,r)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){var c=e;e.addListener(n,r),a=function(){return c.removeListener(n,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,h=e.length;l<h;l++)t(e[l],n,r,i,o)}i.add(a)}(t,e,(function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),r,n)}))}var vC=1,mC=Promise.resolve(),gC={};function yC(t){return t in gC&&(delete gC[t],!0)}var bC=function(t){var e=vC++;return gC[e]=!0,mC.then((function(){return yC(e)&&t()})),e},_C=function(t){yC(t)},wC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).scheduler=t,i.work=r,i}return _createClass(n,[{key:"requestAsyncId",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0?_get(_getPrototypeOf(n.prototype),"requestAsyncId",this).call(this,t,e,r):(t.actions.push(this),t.scheduled||(t.scheduled=bC(t.flush.bind(t,null))))}},{key:"recycleAsyncId",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==r&&r>0||null===r&&this.delay>0)return _get(_getPrototypeOf(n.prototype),"recycleAsyncId",this).call(this,t,e,r);0===t.actions.length&&(_C(e),t.scheduled=void 0)}}]),n}(d_),xC=new(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"flush",value:function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}}}]),n}(v_))(wC);function CC(t,e){return function(n){return n.lift(new kC(t,e))}}var kC=function(){function t(e,n){_classCallCheck(this,t),this.compare=e,this.keySelector=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new EC(t,this.compare,this.keySelector))}}]),t}(),EC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t)).keySelector=i,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return _createClass(n,[{key:"compare",value:function(t,e){return t===e}},{key:"_next",value:function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(i){return this.destination.error(i)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(i){return this.destination.error(i)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))}}]),n}(y),SC=function(){function t(e){_classCallCheck(this,t),this.durationSelector=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new IC(t,this.durationSelector))}}]),t}(),IC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).durationSelector=r,i.hasValue=!1,i}return _createClass(n,[{key:"_next",value:function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e;try{e=(0,this.durationSelector)(t)}catch(r){return this.destination.error(r)}var n=V(this,e);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}},{key:"clearThrottle",value:function(){var t=this.value,e=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}},{key:"notifyNext",value:function(t,e,n,r){this.clearThrottle()}},{key:"notifyComplete",value:function(){this.clearThrottle()}}]),n}(U);function TC(t){return!h(t)&&t-parseFloat(t)+1>=0}function AC(t){var e=t.index,n=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function RC(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m_;return e=function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=-1;return TC(e)?r=Number(e)<1?1:Number(e):D(e)&&(n=e),D(n)||(n=m_),new E((function(e){var i=TC(t)?t:+t-n.now();return n.schedule(AC,i,{index:0,period:r,subscriber:e})}))}(t,n)},function(t){return t.lift(new SC(e))}}function OC(t){return function(e){return e.lift(new NC(t))}}var NC=function(){function t(e){_classCallCheck(this,t),this.notifier=e}return _createClass(t,[{key:"call",value:function(t,e){var n=new DC(t),r=V(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}]),t}(),DC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).seenValue=!1,r}return _createClass(n,[{key:"notifyNext",value:function(t,e,n,r,i){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),n}(U),PC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).scheduler=t,i.work=r,i}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0?_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}},{key:"execute",value:function(t,e){return e>0||this.closed?_get(_getPrototypeOf(n.prototype),"execute",this).call(this,t,e):this._execute(t,e)}},{key:"requestAsyncId",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(n.prototype),"requestAsyncId",this).call(this,t,e,r):t.flush(this)}}]),n}(d_),MC=new(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(v_))(PC);function FC(t,e){return new E(e?function(n){return e.schedule(LC,0,{error:t,subscriber:n})}:function(e){return e.error(t)})}function LC(t){var e=t.error;t.subscriber.error(e)}var BC=function(){var t=function(){function t(e,n,r){_classCallCheck(this,t),this.kind=e,this.value=n,this.error=r,this.hasValue="N"===e}return _createClass(t,[{key:"observe",value:function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}},{key:"do",value:function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}},{key:"accept",value:function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Yd(this.value);case"E":return FC(this.error);case"C":return ip()}throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}},{key:"createError",value:function(e){return new t("E",void 0,e)}},{key:"createComplete",value:function(){return t.completeNotification}}]),t}();return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();function jC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){return n.lift(new VC(t,e))}}var VC=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,t),this.scheduler=e,this.delay=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new UC(t,this.scheduler,this.delay))}}]),t}(),UC=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,n),(i=e.call(this,t)).scheduler=r,i.delay=o,i}return _createClass(n,[{key:"scheduleMessage",value:function(t){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new zC(t,this.destination)))}},{key:"_next",value:function(t){this.scheduleMessage(BC.createNext(t))}},{key:"_error",value:function(t){this.scheduleMessage(BC.createError(t)),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleMessage(BC.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()}}]),n}(y),zC=function t(e,n){_classCallCheck(this,t),this.notification=e,this.destination=n};function WC(t){return t&&"function"==typeof t.connect}var qC,HC,GC,KC,XC,$C=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,t),this._multiple=n,this._emitChanges=i,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new O,r&&r.length&&(n?r.forEach((function(t){return e._markSelected(t)})):this._markSelected(r[0]),this._selectedToEmit.length=0)}return _createClass(t,[{key:"select",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._verifyValueAssignment(n),n.forEach((function(e){return t._markSelected(e)})),this._emitChangeEvent()}},{key:"deselect",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._verifyValueAssignment(n),n.forEach((function(e){return t._unmarkSelected(e)})),this._emitChangeEvent()}},{key:"toggle",value:function(t){this.isSelected(t)?this.deselect(t):this.select(t)}},{key:"clear",value:function(){this._unmarkAll(),this._emitChangeEvent()}},{key:"isSelected",value:function(t){return this._selection.has(t)}},{key:"isEmpty",value:function(){return 0===this._selection.size}},{key:"hasValue",value:function(){return!this.isEmpty()}},{key:"sort",value:function(t){this._multiple&&this.selected&&this._selected.sort(t)}},{key:"isMultipleSelection",value:function(){return this._multiple}},{key:"_emitChangeEvent",value:function(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}},{key:"_markSelected",value:function(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}},{key:"_unmarkSelected",value:function(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}},{key:"_unmarkAll",value:function(){var t=this;this.isEmpty()||this._selection.forEach((function(e){return t._unmarkSelected(e)}))}},{key:"_verifyValueAssignment",value:function(t){if(t.length>1&&!this._multiple)throw Error("Cannot pass multiple values into SelectionModel with single-value mode.")}},{key:"selected",get:function(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}}]),t}(),YC=((XC=function(){function t(e,n,r){_classCallCheck(this,t),this._ngZone=e,this._platform=n,this._scrolled=new O,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}return _createClass(t,[{key:"register",value:function(t){var e=this;this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe((function(){return e._scrolled.next(t)})))}},{key:"deregister",value:function(t){var e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}},{key:"scrolled",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._platform.isBrowser?new E((function(n){t._globalSubscription||t._addGlobalListener();var r=e>0?t._scrolled.pipe(RC(e)).subscribe(n):t._scrolled.subscribe(n);return t._scrolledCount++,function(){r.unsubscribe(),t._scrolledCount--,t._scrolledCount||t._removeGlobalListener()}})):Yd()}},{key:"ngOnDestroy",value:function(){var t=this;this._removeGlobalListener(),this.scrollContainers.forEach((function(e,n){return t.deregister(n)})),this._scrolled.complete()}},{key:"ancestorScrolled",value:function(t,e){var n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(sp((function(t){return!t||n.indexOf(t)>-1})))}},{key:"getAncestorScrollContainers",value:function(t){var e=this,n=[];return this.scrollContainers.forEach((function(r,i){e._scrollableContainsElement(i,t)&&n.push(i)})),n}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_scrollableContainsElement",value:function(t,e){var n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}},{key:"_addGlobalListener",value:function(){var t=this;this._globalSubscription=this._ngZone.runOutsideAngular((function(){return pC(t._getWindow().document,"scroll").subscribe((function(){return t._scrolled.next()}))}))}},{key:"_removeGlobalListener",value:function(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}]),t}()).\u0275fac=function(t){return new(t||XC)(te(xc),te(P_),te(nl,8))},XC.\u0275prov=mt({factory:function(){return new XC(te(xc),te(P_),te(nl,8))},token:XC,providedIn:"root"}),XC),QC=((KC=function(){function t(e,n,r,i){var o=this;_classCallCheck(this,t),this.elementRef=e,this.scrollDispatcher=n,this.ngZone=r,this.dir=i,this._destroyed=new O,this._elementScrolled=new E((function(t){return o.ngZone.runOutsideAngular((function(){return pC(o.elementRef.nativeElement,"scroll").pipe(OC(o._destroyed)).subscribe(t)}))}))}return _createClass(t,[{key:"ngOnInit",value:function(){this.scrollDispatcher.register(this)}},{key:"ngOnDestroy",value:function(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}},{key:"elementScrolled",value:function(){return this._elementScrolled}},{key:"getElementRef",value:function(){return this.elementRef}},{key:"scrollTo",value:function(t){var e=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=n?t.end:t.start),null==t.right&&(t.right=n?t.start:t.end),null!=t.bottom&&(t.top=e.scrollHeight-e.clientHeight-t.bottom),n&&0!=j_()?(null!=t.left&&(t.right=e.scrollWidth-e.clientWidth-t.left),2==j_()?t.left=t.right:1==j_()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=e.scrollWidth-e.clientWidth-t.right),this._applyScrollToOptions(t)}},{key:"_applyScrollToOptions",value:function(t){var e=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?e.scrollTo(t):(null!=t.top&&(e.scrollTop=t.top),null!=t.left&&(e.scrollLeft=t.left))}},{key:"measureScrollOffset",value:function(t){var e=this.elementRef.nativeElement;if("top"==t)return e.scrollTop;if("bottom"==t)return e.scrollHeight-e.clientHeight-e.scrollTop;var n=this.dir&&"rtl"==this.dir.value;return"start"==t?t=n?"right":"left":"end"==t&&(t=n?"left":"right"),n&&2==j_()?"left"==t?e.scrollWidth-e.clientWidth-e.scrollLeft:e.scrollLeft:n&&1==j_()?"left"==t?e.scrollLeft+e.scrollWidth-e.clientWidth:-e.scrollLeft:"left"==t?e.scrollLeft:e.scrollWidth-e.clientWidth-e.scrollLeft}}]),t}()).\u0275fac=function(t){return new(t||KC)(Ca(Us),Ca(YC),Ca(xc),Ca(Sw,8))},KC.\u0275dir=Ee({type:KC,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),KC),JC=((GC=function(){function t(e,n,r){var i=this;_classCallCheck(this,t),this._platform=e,this._document=r,n.runOutsideAngular((function(){var t=i._getWindow();i._change=e.isBrowser?J(pC(t,"resize"),pC(t,"orientationchange")):Yd(),i._invalidateCache=i.change().subscribe((function(){return i._updateViewportSize()}))}))}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._invalidateCache.unsubscribe()}},{key:"getViewportSize",value:function(){this._viewportSize||this._updateViewportSize();var t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}},{key:"getViewportRect",value:function(){var t=this.getViewportScrollPosition(),e=this.getViewportSize(),n=e.width,r=e.height;return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}},{key:"getViewportScrollPosition",value:function(){if(!this._platform.isBrowser)return{top:0,left:0};var t=this._getDocument(),e=this._getWindow(),n=t.documentElement,r=n.getBoundingClientRect();return{top:-r.top||t.body.scrollTop||e.scrollY||n.scrollTop||0,left:-r.left||t.body.scrollLeft||e.scrollX||n.scrollLeft||0}}},{key:"change",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return t>0?this._change.pipe(RC(t)):this._change}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_updateViewportSize",value:function(){var t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}]),t}()).\u0275fac=function(t){return new(t||GC)(te(P_),te(xc),te(nl,8))},GC.\u0275prov=mt({factory:function(){return new GC(te(P_),te(xc),te(nl,8))},token:GC,providedIn:"root"}),GC),ZC=((HC=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:HC}),HC.\u0275inj=gt({factory:function(t){return new(t||HC)}}),HC),tk=((qC=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:qC}),qC.\u0275inj=gt({factory:function(t){return new(t||qC)},imports:[[Iw,M_,ZC],Iw,ZC]}),qC);function ek(){throw Error("Host already has a portal attached")}var nk,rk,ik=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"attach",value:function(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&ek(),this._attachedHost=t,t.attach(this)}},{key:"detach",value:function(){var t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}},{key:"setAttachedHost",value:function(t){this._attachedHost=t}},{key:"isAttached",get:function(){return null!=this._attachedHost}}]),t}(),ok=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this)).component=t,a.viewContainerRef=r,a.injector=i,a.componentFactoryResolver=o,a}return n}(ik),ak=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this)).templateRef=t,o.viewContainerRef=r,o.context=i,o}return _createClass(n,[{key:"attach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context;return this.context=e,_get(_getPrototypeOf(n.prototype),"attach",this).call(this,t)}},{key:"detach",value:function(){return this.context=void 0,_get(_getPrototypeOf(n.prototype),"detach",this).call(this)}},{key:"origin",get:function(){return this.templateRef.elementRef}}]),n}(ik),sk=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).element=t instanceof Us?t.nativeElement:t,r}return n}(ik),uk=function(){function t(){_classCallCheck(this,t),this._isDisposed=!1,this.attachDomPortal=null}return _createClass(t,[{key:"hasAttached",value:function(){return!!this._attachedPortal}},{key:"attach",value:function(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&ek(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof ok?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof ak?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof sk?(this._attachedPortal=t,this.attachDomPortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}},{key:"detach",value:function(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}},{key:"dispose",value:function(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}},{key:"setDisposeFn",value:function(t){this._disposeFn=t}},{key:"_invokeDisposeFn",value:function(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}]),t}(),ck=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s,u;return _classCallCheck(this,n),(u=e.call(this)).outletElement=t,u._componentFactoryResolver=r,u._appRef=i,u._defaultInjector=o,u.attachDomPortal=function(t){if(!u._document)throw Error("Cannot attach DOM portal without _document constructor parameter");var e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");var r=u._document.createComment("dom-portal");e.parentNode.insertBefore(r,e),u.outletElement.appendChild(e),_get((s=_assertThisInitialized(u),_getPrototypeOf(n.prototype)),"setDisposeFn",s).call(s,(function(){r.parentNode&&r.parentNode.replaceChild(e,r)}))},u._document=a,u}return _createClass(n,[{key:"attachComponentPortal",value:function(t){var e,n=this,r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);return t.viewContainerRef?(e=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn((function(){return e.destroy()}))):(e=r.create(t.injector||this._defaultInjector),this._appRef.attachView(e.hostView),this.setDisposeFn((function(){n._appRef.detachView(e.hostView),e.destroy()}))),this.outletElement.appendChild(this._getComponentRootNode(e)),e}},{key:"attachTemplatePortal",value:function(t){var e=this,n=t.viewContainerRef,r=n.createEmbeddedView(t.templateRef,t.context);return r.detectChanges(),r.rootNodes.forEach((function(t){return e.outletElement.appendChild(t)})),this.setDisposeFn((function(){var t=n.indexOf(r);-1!==t&&n.remove(t)})),r}},{key:"dispose",value:function(){_get(_getPrototypeOf(n.prototype),"dispose",this).call(this),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}},{key:"_getComponentRootNode",value:function(t){return t.hostView.rootNodes[0]}}]),n}(uk),lk=((rk=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o,a;return _classCallCheck(this,n),(a=e.call(this))._componentFactoryResolver=t,a._viewContainerRef=r,a._isInitialized=!1,a.attached=new Nu,a.attachDomPortal=function(t){if(!a._document)throw Error("Cannot attach DOM portal without _document constructor parameter");var e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");var r=a._document.createComment("dom-portal");t.setAttachedHost(_assertThisInitialized(a)),e.parentNode.insertBefore(r,e),a._getRootNode().appendChild(e),_get((o=_assertThisInitialized(a),_getPrototypeOf(n.prototype)),"setDisposeFn",o).call(o,(function(){r.parentNode&&r.parentNode.replaceChild(e,r)}))},a._document=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){this._isInitialized=!0}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"dispose",this).call(this),this._attachedPortal=null,this._attachedRef=null}},{key:"attachComponentPortal",value:function(t){t.setAttachedHost(this);var e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),i=e.createComponent(r,e.length,t.injector||e.injector);return e!==this._viewContainerRef&&this._getRootNode().appendChild(i.hostView.rootNodes[0]),_get(_getPrototypeOf(n.prototype),"setDisposeFn",this).call(this,(function(){return i.destroy()})),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}},{key:"attachTemplatePortal",value:function(t){var e=this;t.setAttachedHost(this);var r=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return _get(_getPrototypeOf(n.prototype),"setDisposeFn",this).call(this,(function(){return e._viewContainerRef.clear()})),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}},{key:"_getRootNode",value:function(){var t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}},{key:"portal",get:function(){return this._attachedPortal},set:function(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&_get(_getPrototypeOf(n.prototype),"detach",this).call(this),t&&_get(_getPrototypeOf(n.prototype),"attach",this).call(this,t),this._attachedPortal=t)}},{key:"attachedRef",get:function(){return this._attachedRef}}]),n}(uk)).\u0275fac=function(t){return new(t||rk)(Ca(Vs),Ca(du),Ca(nl))},rk.\u0275dir=Ee({type:rk,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[ws]}),rk),hk=((nk=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:nk}),nk.\u0275inj=gt({factory:function(t){return new(t||nk)}}),nk),fk=function(){function t(e,n){_classCallCheck(this,t),this._parentInjector=e,this._customTokens=n}return _createClass(t,[{key:"get",value:function(t,e){var n=this._customTokens.get(t);return void 0!==n?n:this._parentInjector.get(t,e)}}]),t}(),dk=function(){function t(e,n){_classCallCheck(this,t),this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}return _createClass(t,[{key:"attach",value:function(){}},{key:"enable",value:function(){if(this._canBeEnabled()){var t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=S_(-this._previousScrollPosition.left),t.style.top=S_(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}},{key:"disable",value:function(){if(this._isEnabled){var t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}},{key:"_canBeEnabled",value:function(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;var t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}]),t}();function pk(){return Error("Scroll strategy has already been attached.")}var vk=function(){function t(e,n,r,i){var o=this;_classCallCheck(this,t),this._scrollDispatcher=e,this._ngZone=n,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=function(){o.disable(),o._overlayRef.hasAttached()&&o._ngZone.run((function(){return o._overlayRef.detach()}))}}return _createClass(t,[{key:"attach",value:function(t){if(this._overlayRef)throw pk();this._overlayRef=t}},{key:"enable",value:function(){var t=this;if(!this._scrollSubscription){var e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe((function(){var e=t._viewportRuler.getViewportScrollPosition().top;Math.abs(e-t._initialScrollPosition)>t._config.threshold?t._detach():t._overlayRef.updatePosition()}))):this._scrollSubscription=e.subscribe(this._detach)}}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),t}(),mk=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"attach",value:function(){}}]),t}();function gk(t,e){return e.some((function(e){return t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right}))}function yk(t,e){return e.some((function(e){return t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right}))}var bk,_k=function(){function t(e,n,r,i){_classCallCheck(this,t),this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=r,this._config=i,this._scrollSubscription=null}return _createClass(t,[{key:"attach",value:function(t){if(this._overlayRef)throw pk();this._overlayRef=t}},{key:"enable",value:function(){var t=this;this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe((function(){if(t._overlayRef.updatePosition(),t._config&&t._config.autoClose){var e=t._overlayRef.overlayElement.getBoundingClientRect(),n=t._viewportRuler.getViewportSize(),r=n.width,i=n.height;gk(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(t.disable(),t._ngZone.run((function(){return t._overlayRef.detach()})))}})))}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),t}(),wk=((bk=function t(e,n,r,i){var o=this;_classCallCheck(this,t),this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=r,this.noop=function(){return new mk},this.close=function(t){return new vk(o._scrollDispatcher,o._ngZone,o._viewportRuler,t)},this.block=function(){return new dk(o._viewportRuler,o._document)},this.reposition=function(t){return new _k(o._scrollDispatcher,o._viewportRuler,o._ngZone,t)},this._document=i}).\u0275fac=function(t){return new(t||bk)(te(YC),te(JC),te(xc),te(nl))},bk.\u0275prov=mt({factory:function(){return new bk(te(YC),te(JC),te(xc),te(nl))},token:bk,providedIn:"root"}),bk),xk=function t(e){if(_classCallCheck(this,t),this.scrollStrategy=new mk,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];void 0!==e[i]&&(this[i]=e[i])}},Ck=function t(e,n,r,i,o){_classCallCheck(this,t),this.offsetX=r,this.offsetY=i,this.panelClass=o,this.originX=e.originX,this.originY=e.originY,this.overlayX=n.overlayX,this.overlayY=n.overlayY},kk=function t(e,n){_classCallCheck(this,t),this.connectionPair=e,this.scrollableViewProperties=n};function Ek(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error("ConnectedPosition: Invalid ".concat(t,' "').concat(e,'". ')+'Expected "top", "bottom" or "center".')}function Sk(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error("ConnectedPosition: Invalid ".concat(t,' "').concat(e,'". ')+'Expected "start", "end" or "center".')}var Ik,Tk,Ak=((Ik=function(){function t(e){var n=this;_classCallCheck(this,t),this._attachedOverlays=[],this._keydownListener=function(t){for(var e=n._attachedOverlays,r=e.length-1;r>-1;r--)if(e[r]._keydownEvents.observers.length>0){e[r]._keydownEvents.next(t);break}},this._document=e}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._detach()}},{key:"add",value:function(t){this.remove(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(t)}},{key:"remove",value:function(t){var e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this._detach()}},{key:"_detach",value:function(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}]),t}()).\u0275fac=function(t){return new(t||Ik)(te(nl))},Ik.\u0275prov=mt({factory:function(){return new Ik(te(nl))},token:Ik,providedIn:"root"}),Ik),Rk=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine),Ok=((Tk=function(){function t(e,n){_classCallCheck(this,t),this._platform=n,this._document=e}return _createClass(t,[{key:"ngOnDestroy",value:function(){var t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"getContainerElement",value:function(){return this._containerElement||this._createContainer(),this._containerElement}},{key:"_createContainer",value:function(){var t=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(t||Rk)for(var e=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]'),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n]);var r=this._document.createElement("div");r.classList.add("cdk-overlay-container"),Rk?r.setAttribute("platform","test"):t||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}]),t}()).\u0275fac=function(t){return new(t||Tk)(te(nl),te(P_))},Tk.\u0275prov=mt({factory:function(){return new Tk(te(nl),te(P_))},token:Tk,providedIn:"root"}),Tk),Nk=function(){function t(e,n,r,i,o,a,s,u){var c=this;_classCallCheck(this,t),this._portalOutlet=e,this._host=n,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=a,this._document=s,this._location=u,this._backdropElement=null,this._backdropClick=new O,this._attachments=new O,this._detachments=new O,this._locationChanges=v.EMPTY,this._backdropClickHandler=function(t){return c._backdropClick.next(t)},this._keydownEvents=new O,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}return _createClass(t,[{key:"attach",value:function(t){var e=this,n=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(Ep(1)).subscribe((function(){e.hasAttached()&&e.updatePosition()})),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe((function(){return e.dispose()}))),n}},{key:"detach",value:function(){if(this.hasAttached()){this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();var t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),t}}},{key:"dispose",value:function(){var t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}},{key:"hasAttached",value:function(){return this._portalOutlet.hasAttached()}},{key:"backdropClick",value:function(){return this._backdropClick.asObservable()}},{key:"attachments",value:function(){return this._attachments.asObservable()}},{key:"detachments",value:function(){return this._detachments.asObservable()}},{key:"keydownEvents",value:function(){return this._keydownEvents.asObservable()}},{key:"getConfig",value:function(){return this._config}},{key:"updatePosition",value:function(){this._positionStrategy&&this._positionStrategy.apply()}},{key:"updatePositionStrategy",value:function(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}},{key:"updateSize",value:function(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}},{key:"setDirection",value:function(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}},{key:"addPanelClass",value:function(t){this._pane&&this._toggleClasses(this._pane,t,!0)}},{key:"removePanelClass",value:function(t){this._pane&&this._toggleClasses(this._pane,t,!1)}},{key:"getDirection",value:function(){var t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}},{key:"updateScrollStrategy",value:function(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}},{key:"_updateElementDirection",value:function(){this._host.setAttribute("dir",this.getDirection())}},{key:"_updateElementSize",value:function(){if(this._pane){var t=this._pane.style;t.width=S_(this._config.width),t.height=S_(this._config.height),t.minWidth=S_(this._config.minWidth),t.minHeight=S_(this._config.minHeight),t.maxWidth=S_(this._config.maxWidth),t.maxHeight=S_(this._config.maxHeight)}}},{key:"_togglePointerEvents",value:function(t){this._pane.style.pointerEvents=t?"auto":"none"}},{key:"_attachBackdrop",value:function(){var t=this;this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){t._backdropElement&&t._backdropElement.classList.add("cdk-overlay-backdrop-showing")}))})):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}},{key:"_updateStackingOrder",value:function(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}},{key:"detachBackdrop",value:function(){var t,e=this,n=this._backdropElement;if(n){var r=function r(){n&&(n.removeEventListener("click",e._backdropClickHandler),n.removeEventListener("transitionend",r),n.parentNode&&n.parentNode.removeChild(n)),e._backdropElement==n&&(e._backdropElement=null),e._config.backdropClass&&e._toggleClasses(n,e._config.backdropClass,!1),clearTimeout(t)};n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular((function(){n.addEventListener("transitionend",r)})),n.style.pointerEvents="none",t=this._ngZone.runOutsideAngular((function(){return setTimeout(r,500)}))}}},{key:"_toggleClasses",value:function(t,e,n){var r=t.classList;E_(e).forEach((function(t){t&&(n?r.add(t):r.remove(t))}))}},{key:"_detachContentWhenStable",value:function(){var t=this;this._ngZone.runOutsideAngular((function(){var e=t._ngZone.onStable.asObservable().pipe(OC(J(t._attachments,t._detachments))).subscribe((function(){t._pane&&t._host&&0!==t._pane.children.length||(t._pane&&t._config.panelClass&&t._toggleClasses(t._pane,t._config.panelClass,!1),t._host&&t._host.parentElement&&(t._previousHostParent=t._host.parentElement,t._previousHostParent.removeChild(t._host)),e.unsubscribe())}))}))}},{key:"_disposeScrollStrategy",value:function(){var t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}},{key:"overlayElement",get:function(){return this._pane}},{key:"backdropElement",get:function(){return this._backdropElement}},{key:"hostElement",get:function(){return this._host}}]),t}(),Dk=/([A-Za-z%]+)$/,Pk=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this._viewportRuler=n,this._document=r,this._platform=i,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new O,this._resizeSubscription=v.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(e)}return _createClass(t,[{key:"attach",value:function(t){var e=this;if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe((function(){e._isInitialRender=!0,e.apply()}))}},{key:"apply",value:function(){if(!this._isDisposed&&this._platform.isBrowser)if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)this.reapplyLastPosition();else{this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();var t,e,n=this._originRect,r=this._overlayRect,i=this._viewportRect,o=[],a=_createForOfIteratorHelper(this._preferredPositions);try{for(a.s();!(e=a.n()).done;){var s=e.value,u=this._getOriginPoint(n,s),c=this._getOverlayPoint(u,r,s),l=this._getOverlayFit(c,r,i,s);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(s,u);this._canFitWithFlexibleDimensions(l,c,i)?o.push({position:s,origin:u,overlayRect:r,boundingBoxRect:this._calculateBoundingBoxRect(u,s)}):(!t||t.overlayFit.visibleArea<l.visibleArea)&&(t={overlayFit:l,overlayPoint:c,originPoint:u,position:s,overlayRect:r})}}catch(g){a.e(g)}finally{a.f()}if(o.length){var h,f=null,d=-1,p=_createForOfIteratorHelper(o);try{for(p.s();!(h=p.n()).done;){var v=h.value,m=v.boundingBoxRect.width*v.boundingBoxRect.height*(v.position.weight||1);m>d&&(d=m,f=v)}}catch(g){p.e(g)}finally{p.f()}return this._isPushed=!1,void this._applyPosition(f.position,f.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(t.position,t.originPoint);this._applyPosition(t.position,t.originPoint)}}},{key:"detach",value:function(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}},{key:"dispose",value:function(){this._isDisposed||(this._boundingBox&&Mk(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}},{key:"reapplyLastPosition",value:function(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();var t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}},{key:"withScrollableContainers",value:function(t){return this._scrollables=t,this}},{key:"withPositions",value:function(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}},{key:"withViewportMargin",value:function(t){return this._viewportMargin=t,this}},{key:"withFlexibleDimensions",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._hasFlexibleDimensions=t,this}},{key:"withGrowAfterOpen",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._growAfterOpen=t,this}},{key:"withPush",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._canPush=t,this}},{key:"withLockedPosition",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._positionLocked=t,this}},{key:"setOrigin",value:function(t){return this._origin=t,this}},{key:"withDefaultOffsetX",value:function(t){return this._offsetX=t,this}},{key:"withDefaultOffsetY",value:function(t){return this._offsetY=t,this}},{key:"withTransformOriginOn",value:function(t){return this._transformOriginSelector=t,this}},{key:"_getOriginPoint",value:function(t,e){var n;if("center"==e.originX)n=t.left+t.width/2;else{var r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return{x:n,y:"center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom}}},{key:"_getOverlayPoint",value:function(t,e,n){var r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+i}}},{key:"_getOverlayFit",value:function(t,e,n,r){var i=t.x,o=t.y,a=this._getOffset(r,"x"),s=this._getOffset(r,"y");a&&(i+=a),s&&(o+=s);var u=0-o,c=o+e.height-n.height,l=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,u,c),f=l*h;return{visibleArea:f,isCompletelyWithinViewport:e.width*e.height===f,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:l==e.width}}},{key:"_canFitWithFlexibleDimensions",value:function(t,e,n){if(this._hasFlexibleDimensions){var r=n.bottom-e.y,i=n.right-e.x,o=Fk(this._overlayRef.getConfig().minHeight),a=Fk(this._overlayRef.getConfig().minWidth),s=t.fitsInViewportHorizontally||null!=a&&a<=i;return(t.fitsInViewportVertically||null!=o&&o<=r)&&s}return!1}},{key:"_pushOverlayOnScreen",value:function(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};var r,i,o=this._viewportRect,a=Math.max(t.x+e.width-o.right,0),s=Math.max(t.y+e.height-o.bottom,0),u=Math.max(o.top-n.top-t.y,0),c=Math.max(o.left-n.left-t.x,0);return r=e.width<=o.width?c||-a:t.x<this._viewportMargin?o.left-n.left-t.x:0,i=e.height<=o.height?u||-s:t.y<this._viewportMargin?o.top-n.top-t.y:0,this._previousPushAmount={x:r,y:i},{x:t.x+r,y:t.y+i}}},{key:"_applyPosition",value:function(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){var n=this._getScrollVisibility(),r=new kk(t,n);this._positionChanges.next(r)}this._isInitialRender=!1}},{key:"_setTransformOrigin",value:function(t){if(this._transformOriginSelector){var e,n=this._boundingBox.querySelectorAll(this._transformOriginSelector),r=t.overlayY;e="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(var i=0;i<n.length;i++)n[i].style.transformOrigin="".concat(e," ").concat(r)}}},{key:"_calculateBoundingBoxRect",value:function(t,e){var n,r,i,o,a,s,u=this._viewportRect,c=this._isRtl();if("top"===e.overlayY)r=t.y,n=u.height-r+this._viewportMargin;else if("bottom"===e.overlayY)i=u.height-t.y+2*this._viewportMargin,n=u.height-i+this._viewportMargin;else{var l=Math.min(u.bottom-t.y+u.top,t.y),h=this._lastBoundingBoxSize.height;n=2*l,r=t.y-l,n>h&&!this._isInitialRender&&!this._growAfterOpen&&(r=t.y-h/2)}if("end"===e.overlayX&&!c||"start"===e.overlayX&&c)s=u.width-t.x+this._viewportMargin,o=t.x-this._viewportMargin;else if("start"===e.overlayX&&!c||"end"===e.overlayX&&c)a=t.x,o=u.right-t.x;else{var f=Math.min(u.right-t.x+u.left,t.x),d=this._lastBoundingBoxSize.width;o=2*f,a=t.x-f,o>d&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.x-d/2)}return{top:r,left:a,bottom:i,right:s,width:o,height:n}}},{key:"_setBoundingBoxStyles",value:function(t,e){var n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));var r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{var i=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=S_(n.height),r.top=S_(n.top),r.bottom=S_(n.bottom),r.width=S_(n.width),r.left=S_(n.left),r.right=S_(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",i&&(r.maxHeight=S_(i)),o&&(r.maxWidth=S_(o))}this._lastBoundingBoxSize=n,Mk(this._boundingBox.style,r)}},{key:"_resetBoundingBoxStyles",value:function(){Mk(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}},{key:"_resetOverlayElementStyles",value:function(){Mk(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}},{key:"_setOverlayElementStyles",value:function(t,e){var n={},r=this._hasExactPosition(),i=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){var a=this._viewportRuler.getViewportScrollPosition();Mk(n,this._getExactOverlayY(e,t,a)),Mk(n,this._getExactOverlayX(e,t,a))}else n.position="static";var s="",u=this._getOffset(e,"x"),c=this._getOffset(e,"y");u&&(s+="translateX(".concat(u,"px) ")),c&&(s+="translateY(".concat(c,"px)")),n.transform=s.trim(),o.maxHeight&&(r?n.maxHeight=S_(o.maxHeight):i&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=S_(o.maxWidth):i&&(n.maxWidth="")),Mk(this._pane.style,n)}},{key:"_getExactOverlayY",value:function(t,e,n){var r={top:"",bottom:""},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));var o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=o,"bottom"===t.overlayY?r.bottom="".concat(this._document.documentElement.clientHeight-(i.y+this._overlayRect.height),"px"):r.top=S_(i.y),r}},{key:"_getExactOverlayX",value:function(t,e,n){var r={left:"",right:""},i=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n)),"right"===(this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left")?r.right="".concat(this._document.documentElement.clientWidth-(i.x+this._overlayRect.width),"px"):r.left=S_(i.x),r}},{key:"_getScrollVisibility",value:function(){var t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map((function(t){return t.getElementRef().nativeElement.getBoundingClientRect()}));return{isOriginClipped:yk(t,n),isOriginOutsideView:gk(t,n),isOverlayClipped:yk(e,n),isOverlayOutsideView:gk(e,n)}}},{key:"_subtractOverflows",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return t-Math.max(e,0)}),t)}},{key:"_getNarrowedViewportRect",value:function(){var t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}},{key:"_isRtl",value:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"_hasExactPosition",value:function(){return!this._hasFlexibleDimensions||this._isPushed}},{key:"_getOffset",value:function(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}},{key:"_validatePositions",value:function(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach((function(t){Sk("originX",t.originX),Ek("originY",t.originY),Sk("overlayX",t.overlayX),Ek("overlayY",t.overlayY)}))}},{key:"_addPanelClasses",value:function(t){var e=this;this._pane&&E_(t).forEach((function(t){""!==t&&-1===e._appliedPanelClasses.indexOf(t)&&(e._appliedPanelClasses.push(t),e._pane.classList.add(t))}))}},{key:"_clearPanelClasses",value:function(){var t=this;this._pane&&(this._appliedPanelClasses.forEach((function(e){t._pane.classList.remove(e)})),this._appliedPanelClasses=[])}},{key:"_getOriginRect",value:function(){var t=this._origin;if(t instanceof Us)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();var e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}},{key:"positions",get:function(){return this._preferredPositions}}]),t}();function Mk(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Fk(t){if("number"!=typeof t&&null!=t){var e=_slicedToArray(t.split(Dk),2),n=e[0],r=e[1];return r&&"px"!==r?null:parseFloat(n)}return t||null}var Lk,Bk,jk,Vk,Uk,zk=function(){function t(e,n,r,i,o,a,s){_classCallCheck(this,t),this._preferredPositions=[],this._positionStrategy=new Pk(r,i,o,a,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(e,n)}return _createClass(t,[{key:"attach",value:function(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}},{key:"dispose",value:function(){this._positionStrategy.dispose()}},{key:"detach",value:function(){this._positionStrategy.detach()}},{key:"apply",value:function(){this._positionStrategy.apply()}},{key:"recalculateLastPosition",value:function(){this._positionStrategy.reapplyLastPosition()}},{key:"withScrollableContainers",value:function(t){this._positionStrategy.withScrollableContainers(t)}},{key:"withFallbackPosition",value:function(t,e,n,r){var i=new Ck(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"withDirection",value:function(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}},{key:"withOffsetX",value:function(t){return this._positionStrategy.withDefaultOffsetX(t),this}},{key:"withOffsetY",value:function(t){return this._positionStrategy.withDefaultOffsetY(t),this}},{key:"withLockedPosition",value:function(t){return this._positionStrategy.withLockedPosition(t),this}},{key:"withPositions",value:function(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"setOrigin",value:function(t){return this._positionStrategy.setOrigin(t),this}},{key:"_isRtl",get:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"onPositionChange",get:function(){return this._positionStrategy.positionChanges}},{key:"positions",get:function(){return this._preferredPositions}}]),t}(),Wk=function(){function t(){_classCallCheck(this,t),this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}return _createClass(t,[{key:"attach",value:function(t){var e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}},{key:"top",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}},{key:"left",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}},{key:"bottom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}},{key:"right",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}},{key:"width",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}},{key:"height",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}},{key:"centerHorizontally",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.left(t),this._justifyContent="center",this}},{key:"centerVertically",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.top(t),this._alignItems="center",this}},{key:"apply",value:function(){if(this._overlayRef&&this._overlayRef.hasAttached()){var t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),r=n.width,i=n.height,o=n.maxWidth,a=n.maxHeight,s=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==i&&"100vh"!==i||a&&"100%"!==a&&"100vh"!==a);t.position=this._cssPosition,t.marginLeft=s?"0":this._leftOffset,t.marginTop=u?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,s?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=u?"flex-start":this._alignItems}}},{key:"dispose",value:function(){if(!this._isDisposed&&this._overlayRef){var t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}}]),t}(),qk=((Bk=function(){function t(e,n,r,i){_classCallCheck(this,t),this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i}return _createClass(t,[{key:"global",value:function(){return new Wk}},{key:"connectedTo",value:function(t,e,n){return new zk(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}},{key:"flexibleConnectedTo",value:function(t){return new Pk(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}]),t}()).\u0275fac=function(t){return new(t||Bk)(te(JC),te(nl),te(P_),te(Ok))},Bk.\u0275prov=mt({factory:function(){return new Bk(te(JC),te(nl),te(P_),te(Ok))},token:Bk,providedIn:"root"}),Bk),Hk=0,Gk=((Lk=function(){function t(e,n,r,i,o,a,s,u,c,l){_classCallCheck(this,t),this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=i,this._keyboardDispatcher=o,this._injector=a,this._ngZone=s,this._document=u,this._directionality=c,this._location=l}return _createClass(t,[{key:"create",value:function(t){var e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new xk(t);return i.direction=i.direction||this._directionality.value,new Nk(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location)}},{key:"position",value:function(){return this._positionBuilder}},{key:"_createPaneElement",value:function(t){var e=this._document.createElement("div");return e.id="cdk-overlay-".concat(Hk++),e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}},{key:"_createHostElement",value:function(){var t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}},{key:"_createPortalOutlet",value:function(t){return this._appRef||(this._appRef=this._injector.get(zc)),new ck(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}]),t}()).\u0275fac=function(t){return new(t||Lk)(te(wk),te(Ok),te(Vs),te(qk),te(Ak),te(oa),te(xc),te(nl),te(Sw),te(xl,8))},Lk.\u0275prov=mt({token:Lk,factory:Lk.\u0275fac}),Lk),Kk=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Xk=new Ht("cdk-connected-overlay-scroll-strategy"),$k=((Vk=function t(e){_classCallCheck(this,t),this.elementRef=e}).\u0275fac=function(t){return new(t||Vk)(Ca(Us))},Vk.\u0275dir=Ee({type:Vk,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),Vk),Yk=((jk=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this._overlay=e,this._dir=o,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=v.EMPTY,this.viewportMargin=0,this.open=!1,this.backdropClick=new Nu,this.positionChange=new Nu,this.attach=new Nu,this.detach=new Nu,this.overlayKeydown=new Nu,this._templatePortal=new ak(n,r),this._scrollStrategyFactory=i,this.scrollStrategy=this._scrollStrategyFactory()}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._overlayRef&&this._overlayRef.dispose(),this._backdropSubscription.unsubscribe()}},{key:"ngOnChanges",value:function(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}},{key:"_createOverlay",value:function(){var t=this;this.positions&&this.positions.length||(this.positions=Kk),this._overlayRef=this._overlay.create(this._buildConfig()),this._overlayRef.keydownEvents().subscribe((function(e){t.overlayKeydown.next(e),27!==e.keyCode||f_(e)||(e.preventDefault(),t._detachOverlay())}))}},{key:"_buildConfig",value:function(){var t=this._position=this.positionStrategy||this._createPositionStrategy(),e=new xk({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(e.width=this.width),(this.height||0===this.height)&&(e.height=this.height),(this.minWidth||0===this.minWidth)&&(e.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(e.minHeight=this.minHeight),this.backdropClass&&(e.backdropClass=this.backdropClass),this.panelClass&&(e.panelClass=this.panelClass),e}},{key:"_updatePositionStrategy",value:function(t){var e=this,n=this.positions.map((function(t){return{originX:t.originX,originY:t.originY,overlayX:t.overlayX,overlayY:t.overlayY,offsetX:t.offsetX||e.offsetX,offsetY:t.offsetY||e.offsetY,panelClass:t.panelClass||void 0}}));return t.setOrigin(this.origin.elementRef).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}},{key:"_createPositionStrategy",value:function(){var t=this,e=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(e),e.positionChanges.subscribe((function(e){return t.positionChange.emit(e)})),e}},{key:"_attachOverlay",value:function(){var t=this;this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||(this._overlayRef.attach(this._templatePortal),this.attach.emit()),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe((function(e){t.backdropClick.emit(e)})):this._backdropSubscription.unsubscribe()}},{key:"_detachOverlay",value:function(){this._overlayRef&&(this._overlayRef.detach(),this.detach.emit()),this._backdropSubscription.unsubscribe()}},{key:"offsetX",get:function(){return this._offsetX},set:function(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}},{key:"offsetY",get:function(){return this._offsetY},set:function(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}},{key:"hasBackdrop",get:function(){return this._hasBackdrop},set:function(t){this._hasBackdrop=x_(t)}},{key:"lockPosition",get:function(){return this._lockPosition},set:function(t){this._lockPosition=x_(t)}},{key:"flexibleDimensions",get:function(){return this._flexibleDimensions},set:function(t){this._flexibleDimensions=x_(t)}},{key:"growAfterOpen",get:function(){return this._growAfterOpen},set:function(t){this._growAfterOpen=x_(t)}},{key:"push",get:function(){return this._push},set:function(t){this._push=x_(t)}},{key:"overlayRef",get:function(){return this._overlayRef}},{key:"dir",get:function(){return this._dir?this._dir.value:"ltr"}}]),t}()).\u0275fac=function(t){return new(t||jk)(Ca(Gk),Ca(hu),Ca(du),Ca(Xk),Ca(Sw,8))},jk.\u0275dir=Ee({type:jk,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown"},exportAs:["cdkConnectedOverlay"],features:[Is]}),jk),Qk={provide:Xk,deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.reposition()}}},Jk=((Uk=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:Uk}),Uk.\u0275inj=gt({factory:function(t){return new(t||Uk)},providers:[Gk,Qk],imports:[[Iw,hk,tk],tk]}),Uk),Zk=["underline"],tE=["connectionContainer"],eE=["inputContainer"],nE=["label"];function rE(t,e){1&t&&(Oa(0),Ta(1,"div",14),Ra(2,"div",15),Ra(3,"div",16),Ra(4,"div",17),Aa(),Ta(5,"div",18),Ra(6,"div",15),Ra(7,"div",16),Ra(8,"div",17),Aa(),Na())}function iE(t,e){1&t&&(Ta(0,"div",19),Ha(1,1),Aa())}function oE(t,e){if(1&t&&(Oa(0),Ha(1,2),Ta(2,"span"),ps(3),Aa(),Na()),2&t){var n=za(2);di(3),vs(n._control.placeholder)}}function aE(t,e){1&t&&Ha(0,3,["*ngSwitchCase","true"])}function sE(t,e){1&t&&(Ta(0,"span",23),ps(1," *"),Aa())}function uE(t,e){if(1&t){var n=Pa();Ta(0,"label",20,21),La("cdkObserveContent",(function(){return tn(n),za().updateOutlineGap()})),wa(2,oE,4,1,"ng-container",12),wa(3,aE,1,0,void 0,12),wa(4,sE,2,0,"span",22),Aa()}if(2&t){var r=za();ns("mat-empty",r._control.empty&&!r._shouldAlwaysFloat)("mat-form-field-empty",r._control.empty&&!r._shouldAlwaysFloat)("mat-accent","accent"==r.color)("mat-warn","warn"==r.color),Sa("cdkObserveContentDisabled","outline"!=r.appearance)("id",r._labelId)("ngSwitch",r._hasLabel()),ba("for",r._control.id)("aria-owns",r._control.id),di(2),Sa("ngSwitchCase",!1),di(1),Sa("ngSwitchCase",!0),di(1),Sa("ngIf",!r.hideRequiredMarker&&r._control.required&&!r._control.disabled)}}function cE(t,e){1&t&&(Ta(0,"div",24),Ha(1,4),Aa())}function lE(t,e){if(1&t&&(Ta(0,"div",25,26),Ra(2,"span",27),Aa()),2&t){var n=za();di(2),ns("mat-accent","accent"==n.color)("mat-warn","warn"==n.color)}}function hE(t,e){1&t&&(Ta(0,"div"),Ha(1,5),Aa()),2&t&&Sa("@transitionMessages",za()._subscriptAnimationState)}function fE(t,e){if(1&t&&(Ta(0,"div",31),ps(1),Aa()),2&t){var n=za(2);Sa("id",n._hintLabelId),di(1),vs(n.hintLabel)}}function dE(t,e){if(1&t&&(Ta(0,"div",28),wa(1,fE,2,2,"div",29),Ha(2,6),Ra(3,"div",30),Ha(4,7),Aa()),2&t){var n=za();Sa("@transitionMessages",n._subscriptAnimationState),di(1),Sa("ngIf",n.hintLabel)}}var pE,vE,mE=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],gE=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],yE=0,bE=((pE=function t(){_classCallCheck(this,t),this.id="mat-error-".concat(yE++)}).\u0275fac=function(t){return new(t||pE)},pE.\u0275dir=Ee({type:pE,selectors:[["mat-error"]],hostAttrs:["role","alert",1,"mat-error"],hostVars:1,hostBindings:function(t,e){2&t&&ba("id",e.id)},inputs:{id:"id"}}),pE),_E={transitionMessages:jg("transitionMessages",[Wg("enter",zg({opacity:1,transform:"translateY(0%)"})),Hg("void => enter",[zg({opacity:0,transform:"translateY(-100%)"}),Vg("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},wE=((vE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||vE)},vE.\u0275dir=Ee({type:vE}),vE);function xE(t){return Error("A hint was already declared for 'align=\"".concat(t,"\"'."))}var CE,kE,EE,SE,IE,TE,AE,RE=0,OE=((IE=function t(){_classCallCheck(this,t),this.align="start",this.id="mat-hint-".concat(RE++)}).\u0275fac=function(t){return new(t||IE)},IE.\u0275dir=Ee({type:IE,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(t,e){2&t&&(ba("id",e.id)("align",null),ns("mat-right","end"==e.align))},inputs:{align:"align",id:"id"}}),IE),NE=((SE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||SE)},SE.\u0275dir=Ee({type:SE,selectors:[["mat-label"]]}),SE),DE=((EE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||EE)},EE.\u0275dir=Ee({type:EE,selectors:[["mat-placeholder"]]}),EE),PE=((kE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||kE)},kE.\u0275dir=Ee({type:kE,selectors:[["","matPrefix",""]]}),kE),ME=((CE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||CE)},CE.\u0275dir=Ee({type:CE,selectors:[["","matSuffix",""]]}),CE),FE=0,LE=Vw((function t(e){_classCallCheck(this,t),this._elementRef=e}),"primary"),BE=new Ht("MAT_FORM_FIELD_DEFAULT_OPTIONS"),jE=new Ht("MatFormField"),VE=((AE=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s,u,c){var l;return _classCallCheck(this,n),(l=e.call(this,t))._elementRef=t,l._changeDetectorRef=r,l._dir=o,l._defaults=a,l._platform=s,l._ngZone=u,l._outlineGapCalculationNeededImmediately=!1,l._outlineGapCalculationNeededOnStable=!1,l._destroyed=new O,l._showAlwaysAnimate=!1,l._subscriptAnimationState="",l._hintLabel="",l._hintLabelId="mat-hint-".concat(FE++),l._labelId="mat-form-field-label-".concat(FE++),l._labelOptions=i||{},l.floatLabel=l._getDefaultFloatLabelState(),l._animationsEnabled="NoopAnimations"!==c,l.appearance=a&&a.appearance?a.appearance:"legacy",l._hideRequiredMarker=!(!a||null==a.hideRequiredMarker)&&a.hideRequiredMarker,l}return _createClass(n,[{key:"getConnectedOverlayOrigin",value:function(){return this._connectionContainerRef||this._elementRef}},{key:"ngAfterContentInit",value:function(){var t=this;this._validateControlChild();var e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add("mat-form-field-type-".concat(e.controlType)),e.stateChanges.pipe(Mp(null)).subscribe((function(){t._validatePlaceholders(),t._syncDescribedByIds(),t._changeDetectorRef.markForCheck()})),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(OC(this._destroyed)).subscribe((function(){return t._changeDetectorRef.markForCheck()})),this._ngZone.runOutsideAngular((function(){t._ngZone.onStable.asObservable().pipe(OC(t._destroyed)).subscribe((function(){t._outlineGapCalculationNeededOnStable&&t.updateOutlineGap()}))})),J(this._prefixChildren.changes,this._suffixChildren.changes).subscribe((function(){t._outlineGapCalculationNeededOnStable=!0,t._changeDetectorRef.markForCheck()})),this._hintChildren.changes.pipe(Mp(null)).subscribe((function(){t._processHints(),t._changeDetectorRef.markForCheck()})),this._errorChildren.changes.pipe(Mp(null)).subscribe((function(){t._syncDescribedByIds(),t._changeDetectorRef.markForCheck()})),this._dir&&this._dir.change.pipe(OC(this._destroyed)).subscribe((function(){"function"==typeof requestAnimationFrame?t._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){return t.updateOutlineGap()}))})):t.updateOutlineGap()}))}},{key:"ngAfterContentChecked",value:function(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}},{key:"ngAfterViewInit",value:function(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}},{key:"ngOnDestroy",value:function(){this._destroyed.next(),this._destroyed.complete()}},{key:"_shouldForward",value:function(t){var e=this._control?this._control.ngControl:null;return e&&e[t]}},{key:"_hasPlaceholder",value:function(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}},{key:"_hasLabel",value:function(){return!!this._labelChild}},{key:"_shouldLabelFloat",value:function(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}},{key:"_hideControlPlaceholder",value:function(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}},{key:"_hasFloatingLabel",value:function(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}},{key:"_getDisplayedMessages",value:function(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}},{key:"_animateAndLockLabel",value:function(){var t=this;this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,pC(this._label.nativeElement,"transitionend").pipe(Ep(1)).subscribe((function(){t._showAlwaysAnimate=!1}))),this.floatLabel="always",this._changeDetectorRef.markForCheck())}},{key:"_validatePlaceholders",value:function(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}},{key:"_processHints",value:function(){this._validateHints(),this._syncDescribedByIds()}},{key:"_validateHints",value:function(){var t,e,n=this;this._hintChildren&&this._hintChildren.forEach((function(r){if("start"===r.align){if(t||n.hintLabel)throw xE("start");t=r}else if("end"===r.align){if(e)throw xE("end");e=r}}))}},{key:"_getDefaultFloatLabelState",value:function(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}},{key:"_syncDescribedByIds",value:function(){if(this._control){var t=[];if("hint"===this._getDisplayedMessages()){var e=this._hintChildren?this._hintChildren.find((function(t){return"start"===t.align})):null,n=this._hintChildren?this._hintChildren.find((function(t){return"end"===t.align})):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&(t=this._errorChildren.map((function(t){return t.id})));this._control.setDescribedByIds(t)}}},{key:"_validateControlChild",value:function(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}},{key:"updateOutlineGap",value:function(){var t=this._label?this._label.nativeElement:null;if("outline"===this.appearance&&t&&t.children.length&&t.textContent.trim()&&this._platform.isBrowser)if(this._isAttachedToDOM()){var e=0,n=0,r=this._connectionContainerRef.nativeElement,i=r.querySelectorAll(".mat-form-field-outline-start"),o=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){var a=r.getBoundingClientRect();if(0===a.width&&0===a.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);var s,u=this._getStartEnd(a),c=this._getStartEnd(t.children[0].getBoundingClientRect()),l=0,h=_createForOfIteratorHelper(t.children);try{for(h.s();!(s=h.n()).done;)l+=s.value.offsetWidth}catch(p){h.e(p)}finally{h.f()}e=Math.abs(c-u)-5,n=l>0?.75*l+10:0}for(var f=0;f<i.length;f++)i[f].style.width="".concat(e,"px");for(var d=0;d<o.length;d++)o[d].style.width="".concat(n,"px");this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}else this._outlineGapCalculationNeededImmediately=!0}},{key:"_getStartEnd",value:function(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}},{key:"_isAttachedToDOM",value:function(){var t=this._elementRef.nativeElement;if(t.getRootNode){var e=t.getRootNode();return e&&e!==t}return document.documentElement.contains(t)}},{key:"appearance",get:function(){return this._appearance},set:function(t){var e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}},{key:"hideRequiredMarker",get:function(){return this._hideRequiredMarker},set:function(t){this._hideRequiredMarker=x_(t)}},{key:"_shouldAlwaysFloat",get:function(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}},{key:"_canLabelFloat",get:function(){return"never"!==this.floatLabel}},{key:"hintLabel",get:function(){return this._hintLabel},set:function(t){this._hintLabel=t,this._processHints()}},{key:"floatLabel",get:function(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel},set:function(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}},{key:"_control",get:function(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic},set:function(t){this._explicitFormFieldControl=t}},{key:"_labelChild",get:function(){return this._labelChildNonStatic||this._labelChildStatic}}]),n}(LE)).\u0275fac=function(t){return new(t||AE)(Ca(Us),Ca(Wo),Ca(jx,8),Ca(Sw,8),Ca(BE,8),Ca(P_),Ca(xc),Ca(c_,8))},AE.\u0275cmp=be({type:AE,selectors:[["mat-form-field"]],contentQueries:function(t,e,n){var r;1&t&&(Ku(n,wE,!0),Xu(n,wE,!0),Ku(n,NE,!0),Xu(n,NE,!0),Ku(n,DE,!0),Ku(n,bE,!0),Ku(n,OE,!0),Ku(n,PE,!0),Ku(n,ME,!0)),2&t&&(Wu(r=Yu())&&(e._controlNonStatic=r.first),Wu(r=Yu())&&(e._controlStatic=r.first),Wu(r=Yu())&&(e._labelChildNonStatic=r.first),Wu(r=Yu())&&(e._labelChildStatic=r.first),Wu(r=Yu())&&(e._placeholderChild=r.first),Wu(r=Yu())&&(e._errorChildren=r),Wu(r=Yu())&&(e._hintChildren=r),Wu(r=Yu())&&(e._prefixChildren=r),Wu(r=Yu())&&(e._suffixChildren=r))},viewQuery:function(t,e){var n;1&t&&(Hu(Zk,!0),qu(tE,!0),Hu(eE,!0),Hu(nE,!0)),2&t&&(Wu(n=Yu())&&(e.underlineRef=n.first),Wu(n=Yu())&&(e._connectionContainerRef=n.first),Wu(n=Yu())&&(e._inputContainerRef=n.first),Wu(n=Yu())&&(e._label=n.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(t,e){2&t&&ns("mat-form-field-appearance-standard","standard"==e.appearance)("mat-form-field-appearance-fill","fill"==e.appearance)("mat-form-field-appearance-outline","outline"==e.appearance)("mat-form-field-appearance-legacy","legacy"==e.appearance)("mat-form-field-invalid",e._control.errorState)("mat-form-field-can-float",e._canLabelFloat)("mat-form-field-should-float",e._shouldLabelFloat())("mat-form-field-has-label",e._hasFloatingLabel())("mat-form-field-hide-placeholder",e._hideControlPlaceholder())("mat-form-field-disabled",e._control.disabled)("mat-form-field-autofilled",e._control.autofilled)("mat-focused",e._control.focused)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)("ng-untouched",e._shouldForward("untouched"))("ng-touched",e._shouldForward("touched"))("ng-pristine",e._shouldForward("pristine"))("ng-dirty",e._shouldForward("dirty"))("ng-valid",e._shouldForward("valid"))("ng-invalid",e._shouldForward("invalid"))("ng-pending",e._shouldForward("pending"))("_mat-animation-noopable",!e._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Ls([{provide:jE,useExisting:AE}]),ws],ngContentSelectors:gE,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,e){1&t&&(qa(mE),Ta(0,"div",0),Ta(1,"div",1,2),La("click",(function(t){return e._control.onContainerClick&&e._control.onContainerClick(t)})),wa(3,rE,9,0,"ng-container",3),wa(4,iE,2,0,"div",4),Ta(5,"div",5,6),Ha(7),Ta(8,"span",7),wa(9,uE,5,16,"label",8),Aa(),Aa(),wa(10,cE,2,0,"div",9),Aa(),wa(11,lE,3,4,"div",10),Ta(12,"div",11),wa(13,hE,2,1,"div",12),wa(14,dE,5,2,"div",13),Aa(),Aa()),2&t&&(di(3),Sa("ngIf","outline"==e.appearance),di(1),Sa("ngIf",e._prefixChildren.length),di(5),Sa("ngIf",e._hasFloatingLabel()),di(1),Sa("ngIf",e._suffixChildren.length),di(1),Sa("ngIf","outline"!=e.appearance),di(1),Sa("ngSwitch",e._getDisplayedMessages()),di(1),Sa("ngSwitchCase","error"),di(1),Sa("ngSwitchCase","hint"))},directives:[Ll,Kl,Xl,K_],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[_E.transitionMessages]},changeDetection:0}),AE),UE=((TE=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:TE}),TE.\u0275inj=gt({factory:function(t){return new(t||TE)},imports:[[th,Bw,X_],Bw]}),TE),zE=["trigger"],WE=["panel"];function qE(t,e){if(1&t&&(Ta(0,"span",8),ps(1),Aa()),2&t){var n=za();di(1),vs(n.placeholder||"\xa0")}}function HE(t,e){if(1&t&&(Ta(0,"span"),ps(1),Aa()),2&t){var n=za(2);di(1),vs(n.triggerValue||"\xa0")}}function GE(t,e){1&t&&Ha(0,0,["*ngSwitchCase","true"])}function KE(t,e){1&t&&(Ta(0,"span",9),wa(1,HE,2,1,"span",10),wa(2,GE,1,0,void 0,11),Aa()),2&t&&(Sa("ngSwitch",!!za().customTrigger),di(2),Sa("ngSwitchCase",!0))}function XE(t,e){if(1&t){var n=Pa();Ta(0,"div",12),Ta(1,"div",13,14),La("@transformPanel.done",(function(t){return tn(n),za()._panelDoneAnimatingStream.next(t.toState)}))("keydown",(function(t){return tn(n),za()._handleKeydown(t)})),Ha(3,1),Aa(),Aa()}if(2&t){var r=za();Sa("@transformPanelWrap",void 0),di(1),i=r._getPanelTheme(),os(he,rs,_a(Je(),"mat-select-panel ",i,""),!0),es("transform-origin",r._transformOrigin)("font-size",r._triggerFontSize,"px"),Sa("ngClass",r.panelClass)("@transformPanel",r.multiple?"showing-multiple":"showing"),ba("id",r.id+"-panel")}var i}var $E,YE,QE,JE,ZE,tS=[[["mat-select-trigger"]],"*"],eS=["mat-select-trigger","*"],nS={transformPanelWrap:jg("transformPanelWrap",[Hg("* => void",Kg("@transformPanel",[Gg()],{optional:!0}))]),transformPanel:jg("transformPanel",[Wg("void",zg({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Wg("showing",zg({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Wg("showing-multiple",zg({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Hg("void => *",Vg("120ms cubic-bezier(0, 0, 0.2, 1)")),Hg("* => void",Vg("100ms 25ms linear",zg({opacity:0})))])},rS=0,iS=new Ht("mat-select-scroll-strategy"),oS=new Ht("MAT_SELECT_CONFIG"),aS={provide:iS,deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.reposition()}}},sS=function t(e,n){_classCallCheck(this,t),this.source=e,this.value=n},uS=Uw(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(function(t){_inherits(r,t);var n=_createSuper(r);function r(){var t;_classCallCheck(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=n.call.apply(n,[this].concat(o)))._tabIndex=e,t}return _createClass(r,[{key:"tabIndex",get:function(){return this.disabled?-1:this._tabIndex},set:function(t){this._tabIndex=null!=t?t:e}}]),r}(t))}(jw(zw((function t(e,n,r,i,o){_classCallCheck(this,t),this._elementRef=e,this._defaultErrorStateMatcher=n,this._parentForm=r,this._parentFormGroup=i,this.ngControl=o}))))),cS=((QE=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||QE)},QE.\u0275dir=Ee({type:QE,selectors:[["mat-select-trigger"]]}),QE),lS=((YE=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s,u,c,l,h,f,d,p,v){var m;return _classCallCheck(this,n),(m=e.call(this,a,o,u,c,h))._viewportRuler=t,m._changeDetectorRef=r,m._ngZone=i,m._dir=s,m._parentFormField=l,m.ngControl=h,m._liveAnnouncer=p,m._panelOpen=!1,m._required=!1,m._scrollTop=0,m._multiple=!1,m._compareWith=function(t,e){return t===e},m._uid="mat-select-".concat(rS++),m._destroy=new O,m._triggerFontSize=0,m._onChange=function(){},m._onTouched=function(){},m._optionIds="",m._transformOrigin="top",m._panelDoneAnimatingStream=new O,m._offsetY=0,m._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],m._disableOptionCentering=!1,m._focused=!1,m.controlType="mat-select",m.ariaLabel="",m.optionSelectionChanges=op((function(){var t=m.options;return t?t.changes.pipe(Mp(t),Op((function(){return J.apply(void 0,_toConsumableArray(t.map((function(t){return t.onSelectionChange}))))}))):m._ngZone.onStable.asObservable().pipe(Ep(1),Op((function(){return m.optionSelectionChanges})))})),m.openedChange=new Nu,m._openedStream=m.openedChange.pipe(sp((function(t){return t})),z((function(){}))),m._closedStream=m.openedChange.pipe(sp((function(t){return!t})),z((function(){}))),m.selectionChange=new Nu,m.valueChange=new Nu,m.ngControl&&(m.ngControl.valueAccessor=_assertThisInitialized(m)),m._scrollStrategyFactory=d,m._scrollStrategy=m._scrollStrategyFactory(),m.tabIndex=parseInt(f)||0,m.id=m.id,v&&(null!=v.disableOptionCentering&&(m.disableOptionCentering=v.disableOptionCentering),null!=v.typeaheadDebounceInterval&&(m.typeaheadDebounceInterval=v.typeaheadDebounceInterval)),m}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this._selectionModel=new $C(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(CC(),OC(this._destroy)).subscribe((function(){t.panelOpen?(t._scrollTop=0,t.openedChange.emit(!0)):(t.openedChange.emit(!1),t.overlayDir.offsetX=0,t._changeDetectorRef.markForCheck())})),this._viewportRuler.change().pipe(OC(this._destroy)).subscribe((function(){t._panelOpen&&(t._triggerRect=t.trigger.nativeElement.getBoundingClientRect(),t._changeDetectorRef.markForCheck())}))}},{key:"ngAfterContentInit",value:function(){var t=this;this._initKeyManager(),this._selectionModel.changed.pipe(OC(this._destroy)).subscribe((function(t){t.added.forEach((function(t){return t.select()})),t.removed.forEach((function(t){return t.deselect()}))})),this.options.changes.pipe(Mp(null),OC(this._destroy)).subscribe((function(){t._resetOptions(),t._initializeSelection()}))}},{key:"ngDoCheck",value:function(){this.ngControl&&this.updateErrorState()}},{key:"ngOnChanges",value:function(t){t.disabled&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}},{key:"ngOnDestroy",value:function(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}},{key:"toggle",value:function(){this.panelOpen?this.close():this.open()}},{key:"open",value:function(){var t=this;!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.asObservable().pipe(Ep(1)).subscribe((function(){t._triggerFontSize&&t.overlayDir.overlayRef&&t.overlayDir.overlayRef.overlayElement&&(t.overlayDir.overlayRef.overlayElement.style.fontSize="".concat(t._triggerFontSize,"px"))})))}},{key:"close",value:function(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}},{key:"writeValue",value:function(t){this.options&&this._setSelectionByValue(t)}},{key:"registerOnChange",value:function(t){this._onChange=t}},{key:"registerOnTouched",value:function(t){this._onTouched=t}},{key:"setDisabledState",value:function(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}},{key:"_isRtl",value:function(){return!!this._dir&&"rtl"===this._dir.value}},{key:"_handleKeydown",value:function(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}},{key:"_handleClosedKeydown",value:function(t){var e=t.keyCode,n=40===e||38===e||37===e||39===e,r=13===e||32===e,i=this._keyManager;if(!i.isTyping()&&r&&!f_(t)||(this.multiple||t.altKey)&&n)t.preventDefault(),this.open();else if(!this.multiple){var o=this.selected;36===e||35===e?(36===e?i.setFirstItemActive():i.setLastItemActive(),t.preventDefault()):i.onKeydown(t);var a=this.selected;a&&o!==a&&this._liveAnnouncer.announce(a.viewValue,1e4)}}},{key:"_handleOpenKeydown",value:function(t){var e=this._keyManager,n=t.keyCode,r=40===n||38===n,i=e.isTyping();if(36===n||35===n)t.preventDefault(),36===n?e.setFirstItemActive():e.setLastItemActive();else if(r&&t.altKey)t.preventDefault(),this.close();else if(i||13!==n&&32!==n||!e.activeItem||f_(t))if(!i&&this._multiple&&65===n&&t.ctrlKey){t.preventDefault();var o=this.options.some((function(t){return!t.disabled&&!t.selected}));this.options.forEach((function(t){t.disabled||(o?t.select():t.deselect())}))}else{var a=e.activeItemIndex;e.onKeydown(t),this._multiple&&r&&t.shiftKey&&e.activeItem&&e.activeItemIndex!==a&&e.activeItem._selectViaInteraction()}else t.preventDefault(),e.activeItem._selectViaInteraction()}},{key:"_onFocus",value:function(){this.disabled||(this._focused=!0,this.stateChanges.next())}},{key:"_onBlur",value:function(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}},{key:"_onAttached",value:function(){var t=this;this.overlayDir.positionChange.pipe(Ep(1)).subscribe((function(){t._changeDetectorRef.detectChanges(),t._calculateOverlayOffsetX(),t.panel.nativeElement.scrollTop=t._scrollTop}))}},{key:"_getPanelTheme",value:function(){return this._parentFormField?"mat-".concat(this._parentFormField.color):""}},{key:"_initializeSelection",value:function(){var t=this;Promise.resolve().then((function(){t._setSelectionByValue(t.ngControl?t.ngControl.value:t._value),t.stateChanges.next()}))}},{key:"_setSelectionByValue",value:function(t){var e=this;if(this.multiple&&t){if(!Array.isArray(t))throw Error("Value must be an array in multiple-selection mode.");this._selectionModel.clear(),t.forEach((function(t){return e._selectValue(t)})),this._sortValues()}else{this._selectionModel.clear();var n=this._selectValue(t);n?this._keyManager.setActiveItem(n):this.panelOpen||this._keyManager.setActiveItem(-1)}this._changeDetectorRef.markForCheck()}},{key:"_selectValue",value:function(t){var e=this,n=this.options.find((function(n){try{return null!=n.value&&e._compareWith(n.value,t)}catch(r){return Sr()&&console.warn(r),!1}}));return n&&this._selectionModel.select(n),n}},{key:"_initKeyManager",value:function(){var t=this;this._keyManager=new nw(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(OC(this._destroy)).subscribe((function(){t.panelOpen&&(!t.multiple&&t._keyManager.activeItem&&t._keyManager.activeItem._selectViaInteraction(),t.focus(),t.close())})),this._keyManager.change.pipe(OC(this._destroy)).subscribe((function(){t._panelOpen&&t.panel?t._scrollActiveOptionIntoView():t._panelOpen||t.multiple||!t._keyManager.activeItem||t._keyManager.activeItem._selectViaInteraction()}))}},{key:"_resetOptions",value:function(){var t=this,e=J(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(OC(e)).subscribe((function(e){t._onSelect(e.source,e.isUserInput),e.isUserInput&&!t.multiple&&t._panelOpen&&(t.close(),t.focus())})),J.apply(void 0,_toConsumableArray(this.options.map((function(t){return t._stateChanges})))).pipe(OC(e)).subscribe((function(){t._changeDetectorRef.markForCheck(),t.stateChanges.next()})),this._setOptionIds()}},{key:"_onSelect",value:function(t,e){var n=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(n!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),e&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),e&&this.focus())):(t.deselect(),this._selectionModel.clear(),this._propagateChanges(t.value)),n!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}},{key:"_sortValues",value:function(){var t=this;if(this.multiple){var e=this.options.toArray();this._selectionModel.sort((function(n,r){return t.sortComparator?t.sortComparator(n,r,e):e.indexOf(n)-e.indexOf(r)})),this.stateChanges.next()}}},{key:"_propagateChanges",value:function(t){var e;e=this.multiple?this.selected.map((function(t){return t.value})):this.selected?this.selected.value:t,this._value=e,this.valueChange.emit(e),this._onChange(e),this.selectionChange.emit(new sS(this,e)),this._changeDetectorRef.markForCheck()}},{key:"_setOptionIds",value:function(){this._optionIds=this.options.map((function(t){return t.id})).join(" ")}},{key:"_highlightCorrectOption",value:function(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}},{key:"_scrollActiveOptionIntoView",value:function(){var t,e,n,r,i=this._keyManager.activeItemIndex||0,o=Mx(i,this.options,this.optionGroups);this.panel.nativeElement.scrollTop=(t=i+o,e=this._getItemHeight(),n=this.panel.nativeElement.scrollTop,(r=t*e)<n?r:r+e>n+256?Math.max(0,r-256+e):n)}},{key:"focus",value:function(t){this._elementRef.nativeElement.focus(t)}},{key:"_getOptionIndex",value:function(t){return this.options.reduce((function(e,n,r){return void 0!==e?e:t===n?r:void 0}),void 0)}},{key:"_calculateOverlayPosition",value:function(){var t=this._getItemHeight(),e=this._getItemCount(),n=Math.min(e*t,256),r=e*t-n,i=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);i+=Mx(i,this.options,this.optionGroups);var o=n/2;this._scrollTop=this._calculateOverlayScroll(i,o,r),this._offsetY=this._calculateOverlayOffsetY(i,o,r),this._checkOverlayWithinViewport(r)}},{key:"_calculateOverlayScroll",value:function(t,e,n){var r=this._getItemHeight();return Math.min(Math.max(0,r*t-e+r/2),n)}},{key:"_getAriaLabel",value:function(){return this.ariaLabelledby?null:this.ariaLabel||this.placeholder}},{key:"_getAriaLabelledby",value:function(){return this.ariaLabelledby?this.ariaLabelledby:this._parentFormField&&this._parentFormField._hasFloatingLabel()&&!this._getAriaLabel()&&this._parentFormField._labelId||null}},{key:"_getAriaActiveDescendant",value:function(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}},{key:"_calculateOverlayOffsetX",value:function(){var t,e=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),n=this._viewportRuler.getViewportSize(),r=this._isRtl(),i=this.multiple?56:32;if(this.multiple)t=40;else{var o=this._selectionModel.selected[0]||this.options.first;t=o&&o.group?32:16}r||(t*=-1);var a=0-(e.left+t-(r?i:0)),s=e.right+t-n.width+(r?0:i);a>0?t+=a+8:s>0&&(t-=s+8),this.overlayDir.offsetX=Math.round(t),this.overlayDir.overlayRef.updatePosition()}},{key:"_calculateOverlayOffsetY",value:function(t,e,n){var r,i=this._getItemHeight(),o=(i-this._triggerRect.height)/2,a=Math.floor(256/i);return this._disableOptionCentering?0:(r=0===this._scrollTop?t*i:this._scrollTop===n?(t-(this._getItemCount()-a))*i+(i-(this._getItemCount()*i-256)%i):e-i/2,Math.round(-1*r-o))}},{key:"_checkOverlayWithinViewport",value:function(t){var e=this._getItemHeight(),n=this._viewportRuler.getViewportSize(),r=this._triggerRect.top-8,i=n.height-this._triggerRect.bottom-8,o=Math.abs(this._offsetY),a=Math.min(this._getItemCount()*e,256)-o-this._triggerRect.height;a>i?this._adjustPanelUp(a,i):o>r?this._adjustPanelDown(o,r,t):this._transformOrigin=this._getOriginBasedOnOption()}},{key:"_adjustPanelUp",value:function(t,e){var n=Math.round(t-e);this._scrollTop-=n,this._offsetY-=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}},{key:"_adjustPanelDown",value:function(t,e,n){var r=Math.round(t-e);if(this._scrollTop+=r,this._offsetY+=r,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=n)return this._scrollTop=n,this._offsetY=0,void(this._transformOrigin="50% top 0px")}},{key:"_getOriginBasedOnOption",value:function(){var t=this._getItemHeight(),e=(t-this._triggerRect.height)/2;return"50% ".concat(Math.abs(this._offsetY)-e+t/2,"px 0px")}},{key:"_getItemCount",value:function(){return this.options.length+this.optionGroups.length}},{key:"_getItemHeight",value:function(){return 3*this._triggerFontSize}},{key:"setDescribedByIds",value:function(t){this._ariaDescribedby=t.join(" ")}},{key:"onContainerClick",value:function(){this.focus(),this.open()}},{key:"focused",get:function(){return this._focused||this._panelOpen}},{key:"placeholder",get:function(){return this._placeholder},set:function(t){this._placeholder=t,this.stateChanges.next()}},{key:"required",get:function(){return this._required},set:function(t){this._required=x_(t),this.stateChanges.next()}},{key:"multiple",get:function(){return this._multiple},set:function(t){if(this._selectionModel)throw Error("Cannot change `multiple` mode of select after initialization.");this._multiple=x_(t)}},{key:"disableOptionCentering",get:function(){return this._disableOptionCentering},set:function(t){this._disableOptionCentering=x_(t)}},{key:"compareWith",get:function(){return this._compareWith},set:function(t){if("function"!=typeof t)throw Error("`compareWith` must be a function.");this._compareWith=t,this._selectionModel&&this._initializeSelection()}},{key:"value",get:function(){return this._value},set:function(t){t!==this._value&&(this.writeValue(t),this._value=t)}},{key:"typeaheadDebounceInterval",get:function(){return this._typeaheadDebounceInterval},set:function(t){this._typeaheadDebounceInterval=C_(t)}},{key:"id",get:function(){return this._id},set:function(t){this._id=t||this._uid,this.stateChanges.next()}},{key:"panelOpen",get:function(){return this._panelOpen}},{key:"selected",get:function(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}},{key:"triggerValue",get:function(){if(this.empty)return"";if(this._multiple){var t=this._selectionModel.selected.map((function(t){return t.viewValue}));return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}},{key:"empty",get:function(){return!this._selectionModel||this._selectionModel.isEmpty()}},{key:"shouldLabelFloat",get:function(){return this._panelOpen||!this.empty}}]),n}(uS)).\u0275fac=function(t){return new(t||YE)(Ca(JC),Ca(Wo),Ca(xc),Ca(px),Ca(Us),Ca(Sw,8),Ca(wd,8),Ca(Dd,8),Ca(jE,8),Ca(lf,10),ka("tabindex"),Ca(iS),Ca(fw),Ca(oS,8))},YE.\u0275cmp=be({type:YE,selectors:[["mat-select"]],contentQueries:function(t,e,n){var r;1&t&&(Ku(n,cS,!0),Ku(n,Px,!0),Ku(n,Ax,!0)),2&t&&(Wu(r=Yu())&&(e.customTrigger=r.first),Wu(r=Yu())&&(e.options=r),Wu(r=Yu())&&(e.optionGroups=r))},viewQuery:function(t,e){var n;1&t&&(Hu(zE,!0),Hu(WE,!0),Hu(Yk,!0)),2&t&&(Wu(n=Yu())&&(e.trigger=n.first),Wu(n=Yu())&&(e.panel=n.first),Wu(n=Yu())&&(e.overlayDir=n.first))},hostAttrs:["role","listbox",1,"mat-select"],hostVars:19,hostBindings:function(t,e){1&t&&La("keydown",(function(t){return e._handleKeydown(t)}))("focus",(function(){return e._onFocus()}))("blur",(function(){return e._onBlur()})),2&t&&(ba("id",e.id)("tabindex",e.tabIndex)("aria-label",e._getAriaLabel())("aria-labelledby",e._getAriaLabelledby())("aria-required",e.required.toString())("aria-disabled",e.disabled.toString())("aria-invalid",e.errorState)("aria-owns",e.panelOpen?e._optionIds:null)("aria-multiselectable",e.multiple)("aria-describedby",e._ariaDescribedby||null)("aria-activedescendant",e._getAriaActiveDescendant()),ns("mat-select-disabled",e.disabled)("mat-select-invalid",e.errorState)("mat-select-required",e.required)("mat-select-empty",e.empty))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Ls([{provide:wE,useExisting:YE},{provide:Dx,useExisting:YE}]),ws,Is],ngContentSelectors:eS,decls:9,vars:9,consts:[["cdk-overlay-origin","","aria-hidden","true",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],[3,"ngClass","keydown"],["panel",""]],template:function(t,e){if(1&t&&(qa(tS),Ta(0,"div",0,1),La("click",(function(){return e.toggle()})),Ta(3,"div",2),wa(4,qE,2,1,"span",3),wa(5,KE,3,2,"span",4),Aa(),Ta(6,"div",5),Ra(7,"div",6),Aa(),Aa(),wa(8,XE,4,11,"ng-template",7),La("backdropClick",(function(){return e.close()}))("attach",(function(){return e._onAttached()}))("detach",(function(){return e.close()}))),2&t){var n=xa(1);di(3),Sa("ngSwitch",e.empty),di(1),Sa("ngSwitchCase",!0),di(1),Sa("ngSwitchCase",!1),di(3),Sa("cdkConnectedOverlayScrollStrategy",e._scrollStrategy)("cdkConnectedOverlayOrigin",n)("cdkConnectedOverlayOpen",e.panelOpen)("cdkConnectedOverlayPositions",e._positions)("cdkConnectedOverlayMinWidth",null==e._triggerRect?null:e._triggerRect.width)("cdkConnectedOverlayOffsetY",e._offsetY)}},directives:[$k,Kl,Xl,Yk,$l,Dl],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[nS.transformPanelWrap,nS.transformPanel]},changeDetection:0}),YE),hS=(($E=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:$E}),$E.\u0275inj=gt({factory:function(t){return new(t||$E)},providers:[aS],imports:[[th,Jk,Bx,Bw],ZC,UE,Bx,Bw]}),$E),fS=function(){function t(e){_classCallCheck(this,t),this.total=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new dS(t,this.total))}}]),t}(),dS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).total=r,i.count=0,i}return _createClass(n,[{key:"_next",value:function(t){++this.count>this.total&&this.destination.next(t)}}]),n}(y),pS=new Set,vS=((ZE=function(){function t(e){_classCallCheck(this,t),this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):mS}return _createClass(t,[{key:"matchMedia",value:function(t){return this._platform.WEBKIT&&function(t){if(!pS.has(t))try{JE||((JE=document.createElement("style")).setAttribute("type","text/css"),document.head.appendChild(JE)),JE.sheet&&(JE.sheet.insertRule("@media ".concat(t," {.fx-query-test{ }}"),0),pS.add(t))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}]),t}()).\u0275fac=function(t){return new(t||ZE)(te(P_))},ZE.\u0275prov=mt({factory:function(){return new ZE(te(P_))},token:ZE,providedIn:"root"}),ZE);function mS(t){return{matches:"all"===t||""===t,media:t,addListener:function(){},removeListener:function(){}}}var gS,yS=((gS=function(){function t(e,n){_classCallCheck(this,t),this._mediaMatcher=e,this._zone=n,this._queries=new Map,this._destroySubject=new O}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._destroySubject.next(),this._destroySubject.complete()}},{key:"isMatched",value:function(t){var e=this;return bS(E_(t)).some((function(t){return e._registerQuery(t).mql.matches}))}},{key:"observe",value:function(t){var e=this,n=tp(bS(E_(t)).map((function(t){return e._registerQuery(t).observable})));return(n=Pp(n.pipe(Ep(1)),n.pipe((function(t){return t.lift(new fS(1))}),g_(0)))).pipe(z((function(t){var e={matches:!1,breakpoints:{}};return t.forEach((function(t){e.matches=e.matches||t.matches,e.breakpoints[t.query]=t.matches})),e})))}},{key:"_registerQuery",value:function(t){var e=this;if(this._queries.has(t))return this._queries.get(t);var n=this._mediaMatcher.matchMedia(t),r={observable:new E((function(t){var r=function(n){return e._zone.run((function(){return t.next(n)}))};return n.addListener(r),function(){n.removeListener(r)}})).pipe(Mp(n),z((function(e){return{query:t,matches:e.matches}})),OC(this._destroySubject)),mql:n};return this._queries.set(t,r),r}}]),t}()).\u0275fac=function(t){return new(t||gS)(te(vS),te(xc))},gS.\u0275prov=mt({factory:function(){return new gS(te(vS),te(xc))},token:gS,providedIn:"root"}),gS);function bS(t){return t.map((function(t){return t.split(",")})).reduce((function(t,e){return t.concat(e)})).map((function(t){return t.trim()}))}var _S={tooltipState:jg("state",[Wg("initial, void, hidden",zg({opacity:0,transform:"scale(0)"})),Wg("visible",zg({transform:"scale(1)"})),Hg("* => visible",Vg("200ms cubic-bezier(0, 0, 0.2, 1)",qg([zg({opacity:0,transform:"scale(0)",offset:0}),zg({opacity:.5,transform:"scale(0.99)",offset:.5}),zg({opacity:1,transform:"scale(1)",offset:1})]))),Hg("* => hidden",Vg("100ms cubic-bezier(0, 0, 0.2, 1)",zg({opacity:0})))])},wS=B_({passive:!0});function xS(t){return Error('Tooltip position "'.concat(t,'" is invalid.'))}var CS,kS,ES,SS=new Ht("mat-tooltip-scroll-strategy"),IS={provide:SS,deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.reposition({scrollThrottle:20})}}},TS=new Ht("mat-tooltip-default-options",{providedIn:"root",factory:function(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),AS=((ES=function(){function t(e,n,r,i,o,a,s,u,c,l,h,f){var d=this;_classCallCheck(this,t),this._overlay=e,this._elementRef=n,this._scrollDispatcher=r,this._viewContainerRef=i,this._ngZone=o,this._platform=a,this._ariaDescriber=s,this._focusMonitor=u,this._dir=l,this._defaultOptions=h,this._position="below",this._disabled=!1,this.showDelay=this._defaultOptions.showDelay,this.hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=new Map,this._destroyed=new O,this._handleKeydown=function(t){d._isTooltipVisible()&&27===t.keyCode&&!f_(t)&&(t.preventDefault(),t.stopPropagation(),d._ngZone.run((function(){return d.hide(0)})))},this._scrollStrategy=c,h&&(h.position&&(this.position=h.position),h.touchGestures&&(this.touchGestures=h.touchGestures)),u.monitor(n).pipe(OC(this._destroyed)).subscribe((function(t){t?"keyboard"===t&&o.run((function(){return d.show()})):o.run((function(){return d.hide(0)}))})),o.runOutsideAngular((function(){n.nativeElement.addEventListener("keydown",d._handleKeydown)}))}return _createClass(t,[{key:"ngOnInit",value:function(){this._setupPointerEvents()}},{key:"ngOnDestroy",value:function(){var t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),t.removeEventListener("keydown",this._handleKeydown),this._passiveListeners.forEach((function(e,n){t.removeEventListener(n,e,wS)})),this._passiveListeners.clear(),this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message),this._focusMonitor.stopMonitoring(t)}},{key:"show",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.showDelay;if(!this.disabled&&this.message&&(!this._isTooltipVisible()||this._tooltipInstance._showTimeoutId||this._tooltipInstance._hideTimeoutId)){var n=this._createOverlay();this._detach(),this._portal=this._portal||new ok(RS,this._viewContainerRef),this._tooltipInstance=n.attach(this._portal).instance,this._tooltipInstance.afterHidden().pipe(OC(this._destroyed)).subscribe((function(){return t._detach()})),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),this._tooltipInstance.show(e)}}},{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hideDelay;this._tooltipInstance&&this._tooltipInstance.hide(t)}},{key:"toggle",value:function(){this._isTooltipVisible()?this.hide():this.show()}},{key:"_isTooltipVisible",value:function(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}},{key:"_createOverlay",value:function(){var t=this;if(this._overlayRef)return this._overlayRef;var e=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),n=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(".mat-tooltip").withFlexibleDimensions(!1).withViewportMargin(8).withScrollableContainers(e);return n.positionChanges.pipe(OC(this._destroyed)).subscribe((function(e){t._tooltipInstance&&e.scrollableViewProperties.isOverlayClipped&&t._tooltipInstance.isVisible()&&t._ngZone.run((function(){return t.hide(0)}))})),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:n,panelClass:"mat-tooltip-panel",scrollStrategy:this._scrollStrategy()}),this._updatePosition(),this._overlayRef.detachments().pipe(OC(this._destroyed)).subscribe((function(){return t._detach()})),this._overlayRef}},{key:"_detach",value:function(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}},{key:"_updatePosition",value:function(){var t=this._overlayRef.getConfig().positionStrategy,e=this._getOrigin(),n=this._getOverlayPosition();t.withPositions([Object.assign(Object.assign({},e.main),n.main),Object.assign(Object.assign({},e.fallback),n.fallback)])}},{key:"_getOrigin",value:function(){var t,e=!this._dir||"ltr"==this._dir.value,n=this.position;if("above"==n||"below"==n)t={originX:"center",originY:"above"==n?"top":"bottom"};else if("before"==n||"left"==n&&e||"right"==n&&!e)t={originX:"start",originY:"center"};else{if(!("after"==n||"right"==n&&e||"left"==n&&!e))throw xS(n);t={originX:"end",originY:"center"}}var r=this._invertPosition(t.originX,t.originY);return{main:t,fallback:{originX:r.x,originY:r.y}}}},{key:"_getOverlayPosition",value:function(){var t,e=!this._dir||"ltr"==this._dir.value,n=this.position;if("above"==n)t={overlayX:"center",overlayY:"bottom"};else if("below"==n)t={overlayX:"center",overlayY:"top"};else if("before"==n||"left"==n&&e||"right"==n&&!e)t={overlayX:"end",overlayY:"center"};else{if(!("after"==n||"right"==n&&e||"left"==n&&!e))throw xS(n);t={overlayX:"start",overlayY:"center"}}var r=this._invertPosition(t.overlayX,t.overlayY);return{main:t,fallback:{overlayX:r.x,overlayY:r.y}}}},{key:"_updateTooltipMessage",value:function(){var t=this;this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.asObservable().pipe(Ep(1),OC(this._destroyed)).subscribe((function(){t._tooltipInstance&&t._overlayRef.updatePosition()})))}},{key:"_setTooltipClass",value:function(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}},{key:"_invertPosition",value:function(t,e){return"above"===this.position||"below"===this.position?"top"===e?e="bottom":"bottom"===e&&(e="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:e}}},{key:"_setupPointerEvents",value:function(){var t=this;if(this._platform.IOS||this._platform.ANDROID){if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();var e=function(){clearTimeout(t._touchstartTimeout),t.hide(t._defaultOptions.touchendHideDelay)};this._passiveListeners.set("touchend",e).set("touchcancel",e).set("touchstart",(function(){clearTimeout(t._touchstartTimeout),t._touchstartTimeout=setTimeout((function(){return t.show()}),500)}))}}else this._passiveListeners.set("mouseenter",(function(){return t.show()})).set("mouseleave",(function(){return t.hide()}));this._passiveListeners.forEach((function(e,n){t._elementRef.nativeElement.addEventListener(n,e,wS)}))}},{key:"_disableNativeGesturesIfNecessary",value:function(){var t=this._elementRef.nativeElement,e=t.style,n=this.touchGestures;"off"!==n&&(("on"===n||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName)&&(e.userSelect=e.msUserSelect=e.webkitUserSelect=e.MozUserSelect="none"),"on"!==n&&t.draggable||(e.webkitUserDrag="none"),e.touchAction="none",e.webkitTapHighlightColor="transparent")}},{key:"position",get:function(){return this._position},set:function(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(),this._tooltipInstance&&this._tooltipInstance.show(0),this._overlayRef.updatePosition()))}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=x_(t),this._disabled&&this.hide(0)}},{key:"message",get:function(){return this._message},set:function(t){var e=this;this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message),this._message=null!=t?"".concat(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._updateTooltipMessage(),this._ngZone.runOutsideAngular((function(){Promise.resolve().then((function(){e._ariaDescriber.describe(e._elementRef.nativeElement,e.message)}))})))}},{key:"tooltipClass",get:function(){return this._tooltipClass},set:function(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}}]),t}()).\u0275fac=function(t){return new(t||ES)(Ca(Gk),Ca(Us),Ca(YC),Ca(du),Ca(xc),Ca(P_),Ca(ew),Ca(gw),Ca(SS),Ca(Sw,8),Ca(TS,8),Ca(Us))},ES.\u0275dir=Ee({type:ES,selectors:[["","matTooltip",""]],inputs:{showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]}),ES),RS=((kS=function(){function t(e,n){_classCallCheck(this,t),this._changeDetectorRef=e,this._breakpointObserver=n,this._visibility="initial",this._closeOnInteraction=!1,this._onHide=new O,this._isHandset=this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)")}return _createClass(t,[{key:"show",value:function(t){var e=this;this._hideTimeoutId&&(clearTimeout(this._hideTimeoutId),this._hideTimeoutId=null),this._closeOnInteraction=!0,this._showTimeoutId=setTimeout((function(){e._visibility="visible",e._showTimeoutId=null,e._markForCheck()}),t)}},{key:"hide",value:function(t){var e=this;this._showTimeoutId&&(clearTimeout(this._showTimeoutId),this._showTimeoutId=null),this._hideTimeoutId=setTimeout((function(){e._visibility="hidden",e._hideTimeoutId=null,e._markForCheck()}),t)}},{key:"afterHidden",value:function(){return this._onHide.asObservable()}},{key:"isVisible",value:function(){return"visible"===this._visibility}},{key:"ngOnDestroy",value:function(){this._onHide.complete()}},{key:"_animationStart",value:function(){this._closeOnInteraction=!1}},{key:"_animationDone",value:function(t){var e=t.toState;"hidden"!==e||this.isVisible()||this._onHide.next(),"visible"!==e&&"hidden"!==e||(this._closeOnInteraction=!0)}},{key:"_handleBodyInteraction",value:function(){this._closeOnInteraction&&this.hide(0)}},{key:"_markForCheck",value:function(){this._changeDetectorRef.markForCheck()}}]),t}()).\u0275fac=function(t){return new(t||kS)(Ca(Wo),Ca(yS))},kS.\u0275cmp=be({type:kS,selectors:[["mat-tooltip-component"]],hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(t,e){1&t&&La("click",(function(){return e._handleBodyInteraction()}),!1,Gn),2&t&&es("zoom","visible"===e._visibility?1:null)},decls:3,vars:7,consts:[[1,"mat-tooltip",3,"ngClass"]],template:function(t,e){var n;1&t&&(Ta(0,"div",0),La("@state.start",(function(){return e._animationStart()}))("@state.done",(function(t){return e._animationDone(t)})),Ru(1,"async"),ps(2),Aa()),2&t&&(ns("mat-tooltip-handset",null==(n=Ou(1,5,e._isHandset))?null:n.matches),Sa("ngClass",e.tooltipClass)("@state",e._visibility),di(2),vs(e.message))},directives:[Dl],pipes:[Zl],styles:[".mat-tooltip-panel{pointer-events:none !important}.mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}\n"],encapsulation:2,data:{animation:[_S.tooltipState]},changeDetection:0}),kS),OS=((CS=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:CS}),CS.\u0275inj=gt({factory:function(t){return new(t||CS)},providers:[IS],imports:[[kw,th,Jk,Bw],Bw,ZC]}),CS);function NS(t,e){if(1&t&&(Ta(0,"mat-option",19),ps(1),Aa()),2&t){var n=e.$implicit;Sa("value",n),di(1),ms(" ",n," ")}}function DS(t,e){if(1&t){var n=Pa();Ta(0,"mat-form-field",16),Ta(1,"mat-select",17),La("selectionChange",(function(t){return tn(n),za(2)._changePageSize(t.value)})),wa(2,NS,2,2,"mat-option",18),Aa(),Aa()}if(2&t){var r=za(2);Sa("color",r.color),di(1),Sa("value",r.pageSize)("disabled",r.disabled)("aria-label",r._intl.itemsPerPageLabel),di(1),Sa("ngForOf",r._displayedPageSizeOptions)}}function PS(t,e){if(1&t&&(Ta(0,"div",20),ps(1),Aa()),2&t){var n=za(2);di(1),vs(n.pageSize)}}function MS(t,e){if(1&t&&(Ta(0,"div",12),Ta(1,"div",13),ps(2),Aa(),wa(3,DS,3,5,"mat-form-field",14),wa(4,PS,2,1,"div",15),Aa()),2&t){var n=za();di(2),ms(" ",n._intl.itemsPerPageLabel," "),di(1),Sa("ngIf",n._displayedPageSizeOptions.length>1),di(1),Sa("ngIf",n._displayedPageSizeOptions.length<=1)}}function FS(t,e){if(1&t){var n=Pa();Ta(0,"button",21),La("click",(function(){return tn(n),za().firstPage()})),En(),Ta(1,"svg",7),Ra(2,"path",22),Aa(),Aa()}if(2&t){var r=za();Sa("matTooltip",r._intl.firstPageLabel)("matTooltipDisabled",r._previousButtonsDisabled())("matTooltipPosition","above")("disabled",r._previousButtonsDisabled()),ba("aria-label",r._intl.firstPageLabel)}}function LS(t,e){if(1&t){var n=Pa();En(),Sn(),Ta(0,"button",23),La("click",(function(){return tn(n),za().lastPage()})),En(),Ta(1,"svg",7),Ra(2,"path",24),Aa(),Aa()}if(2&t){var r=za();Sa("matTooltip",r._intl.lastPageLabel)("matTooltipDisabled",r._nextButtonsDisabled())("matTooltipPosition","above")("disabled",r._nextButtonsDisabled()),ba("aria-label",r._intl.lastPageLabel)}}var BS,jS,VS,US,zS=((BS=function t(){_classCallCheck(this,t),this.changes=new O,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=function(t,e,n){if(0==n||0==e)return"0 of ".concat(n);var r=t*e;return"".concat(r+1," \u2013 ").concat(r<(n=Math.max(n,0))?Math.min(r+e,n):r+e," of ").concat(n)}}).\u0275fac=function(t){return new(t||BS)},BS.\u0275prov=mt({factory:function(){return new BS},token:BS,providedIn:"root"}),BS),WS={provide:zS,deps:[[new lt,new ft,zS]],useFactory:function(t){return t||new zS}},qS=new Ht("MAT_PAGINATOR_DEFAULT_OPTIONS"),HS=jw(Ww((function t(){_classCallCheck(this,t)}))),GS=((US=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;if(_classCallCheck(this,n),(o=e.call(this))._intl=t,o._changeDetectorRef=r,o._pageIndex=0,o._length=0,o._pageSizeOptions=[],o._hidePageSize=!1,o._showFirstLastButtons=!1,o.page=new Nu,o._intlChanges=t.changes.subscribe((function(){return o._changeDetectorRef.markForCheck()})),i){var a=i.pageSize,s=i.pageSizeOptions,u=i.hidePageSize,c=i.showFirstLastButtons;null!=a&&(o._pageSize=a),null!=s&&(o._pageSizeOptions=s),null!=u&&(o._hidePageSize=u),null!=c&&(o._showFirstLastButtons=c)}return _possibleConstructorReturn(o)}return _createClass(n,[{key:"ngOnInit",value:function(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}},{key:"ngOnDestroy",value:function(){this._intlChanges.unsubscribe()}},{key:"nextPage",value:function(){if(this.hasNextPage()){var t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}}},{key:"previousPage",value:function(){if(this.hasPreviousPage()){var t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}}},{key:"firstPage",value:function(){if(this.hasPreviousPage()){var t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}}},{key:"lastPage",value:function(){if(this.hasNextPage()){var t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}}},{key:"hasPreviousPage",value:function(){return this.pageIndex>=1&&0!=this.pageSize}},{key:"hasNextPage",value:function(){var t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}},{key:"getNumberOfPages",value:function(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}},{key:"_changePageSize",value:function(t){var e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}},{key:"_nextButtonsDisabled",value:function(){return this.disabled||!this.hasNextPage()}},{key:"_previousButtonsDisabled",value:function(){return this.disabled||!this.hasPreviousPage()}},{key:"_updateDisplayedPageSizeOptions",value:function(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((function(t,e){return t-e})),this._changeDetectorRef.markForCheck())}},{key:"_emitPageEvent",value:function(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}},{key:"pageIndex",get:function(){return this._pageIndex},set:function(t){this._pageIndex=Math.max(C_(t),0),this._changeDetectorRef.markForCheck()}},{key:"length",get:function(){return this._length},set:function(t){this._length=C_(t),this._changeDetectorRef.markForCheck()}},{key:"pageSize",get:function(){return this._pageSize},set:function(t){this._pageSize=Math.max(C_(t),0),this._updateDisplayedPageSizeOptions()}},{key:"pageSizeOptions",get:function(){return this._pageSizeOptions},set:function(t){this._pageSizeOptions=(t||[]).map((function(t){return C_(t)})),this._updateDisplayedPageSizeOptions()}},{key:"hidePageSize",get:function(){return this._hidePageSize},set:function(t){this._hidePageSize=x_(t)}},{key:"showFirstLastButtons",get:function(){return this._showFirstLastButtons},set:function(t){this._showFirstLastButtons=x_(t)}}]),n}(HS)).\u0275fac=function(t){return new(t||US)(Ca(zS),Ca(Wo),Ca(qS,8))},US.\u0275cmp=be({type:US,selectors:[["mat-paginator"]],hostAttrs:[1,"mat-paginator"],inputs:{disabled:"disabled",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",color:"color"},outputs:{page:"page"},exportAs:["matPaginator"],features:[ws],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,e){1&t&&(Ta(0,"div",0),Ta(1,"div",1),wa(2,MS,5,3,"div",2),Ta(3,"div",3),Ta(4,"div",4),ps(5),Aa(),wa(6,FS,3,5,"button",5),Ta(7,"button",6),La("click",(function(){return e.previousPage()})),En(),Ta(8,"svg",7),Ra(9,"path",8),Aa(),Aa(),Sn(),Ta(10,"button",9),La("click",(function(){return e.nextPage()})),En(),Ta(11,"svg",7),Ra(12,"path",10),Aa(),Aa(),wa(13,LS,3,5,"button",11),Aa(),Aa(),Aa()),2&t&&(di(2),Sa("ngIf",!e.hidePageSize),di(3),ms(" ",e._intl.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),di(1),Sa("ngIf",e.showFirstLastButtons),di(1),Sa("matTooltip",e._intl.previousPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),ba("aria-label",e._intl.previousPageLabel),di(3),Sa("matTooltip",e._intl.nextPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),ba("aria-label",e._intl.nextPageLabel),di(3),Sa("ngIf",e.showFirstLastButtons))},directives:[Ll,hC,AS,VE,lS,Ml,Px],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;min-height:56px;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}\n"],encapsulation:2,changeDetection:0}),US),KS=((VS=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:VS}),VS.\u0275inj=gt({factory:function(t){return new(t||VS)},providers:[WS],imports:[[th,dC,hS,OS]]}),VS),XS=((jS=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:jS}),jS.\u0275inj=gt({factory:function(t){return new(t||jS)},imports:[[Iw]]}),jS),$S=function t(){_classCallCheck(this,t)},YS=function t(){_classCallCheck(this,t)},QS=function(){function t(e){var n=this;_classCallCheck(this,t),this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?function(){n.headers=new Map,e.split("\n").forEach((function(t){var e=t.indexOf(":");if(e>0){var r=t.slice(0,e),i=r.toLowerCase(),o=t.slice(e+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(o):n.headers.set(i,[o])}}))}:function(){n.headers=new Map,Object.keys(e).forEach((function(t){var r=e[t],i=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(t,i))}))}:this.headers=new Map}return _createClass(t,[{key:"has",value:function(t){return this.init(),this.headers.has(t.toLowerCase())}},{key:"get",value:function(t){this.init();var e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(t){return this.init(),this.headers.get(t.toLowerCase())||null}},{key:"append",value:function(t,e){return this.clone({name:t,value:e,op:"a"})}},{key:"set",value:function(t,e){return this.clone({name:t,value:e,op:"s"})}},{key:"delete",value:function(t,e){return this.clone({name:t,value:e,op:"d"})}},{key:"maybeSetNormalizedName",value:function(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}},{key:"init",value:function(){var e=this;this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(t){return e.applyUpdate(t)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(t){var e=this;t.init(),Array.from(t.headers.keys()).forEach((function(n){e.headers.set(n,t.headers.get(n)),e.normalizedNames.set(n,t.normalizedNames.get(n))}))}},{key:"clone",value:function(e){var n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}},{key:"applyUpdate",value:function(t){var e=t.name.toLowerCase();switch(t.op){case"a":case"s":var n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);var r=("a"===t.op?this.headers.get(e):void 0)||[];r.push.apply(r,_toConsumableArray(n)),this.headers.set(e,r);break;case"d":var i=t.value;if(i){var o=this.headers.get(e);if(!o)return;0===(o=o.filter((function(t){return-1===i.indexOf(t)}))).length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}},{key:"forEach",value:function(t){var e=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return t(e.normalizedNames.get(n),e.headers.get(n))}))}}]),t}(),JS=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"encodeKey",value:function(t){return ZS(t)}},{key:"encodeValue",value:function(t){return ZS(t)}},{key:"decodeKey",value:function(t){return decodeURIComponent(t)}},{key:"decodeValue",value:function(t){return decodeURIComponent(t)}}]),t}();function ZS(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var tI=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,t),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new JS,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){var n=new Map;return t.length>0&&t.split("&").forEach((function(t){var r=t.indexOf("="),i=_slicedToArray(-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],2),o=i[0],a=i[1],s=n.get(o)||[];s.push(a),n.set(o,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(t){var r=n.fromObject[t];e.map.set(t,Array.isArray(r)?r:[r])}))):this.map=null}return _createClass(t,[{key:"has",value:function(t){return this.init(),this.map.has(t)}},{key:"get",value:function(t){this.init();var e=this.map.get(t);return e?e[0]:null}},{key:"getAll",value:function(t){return this.init(),this.map.get(t)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(t,e){return this.clone({param:t,value:e,op:"a"})}},{key:"set",value:function(t,e){return this.clone({param:t,value:e,op:"s"})}},{key:"delete",value:function(t,e){return this.clone({param:t,value:e,op:"d"})}},{key:"toString",value:function(){var t=this;return this.init(),this.keys().map((function(e){var n=t.encoder.encodeKey(e);return t.map.get(e).map((function(e){return n+"="+t.encoder.encodeValue(e)})).join("&")})).filter((function(t){return""!==t})).join("&")}},{key:"clone",value:function(e){var n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([e]),n}},{key:"init",value:function(){var t=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(e){return t.map.set(e,t.cloneFrom.map.get(e))})),this.updates.forEach((function(e){switch(e.op){case"a":case"s":var n=("a"===e.op?t.map.get(e.param):void 0)||[];n.push(e.value),t.map.set(e.param,n);break;case"d":if(void 0===e.value){t.map.delete(e.param);break}var r=t.map.get(e.param)||[],i=r.indexOf(e.value);-1!==i&&r.splice(i,1),r.length>0?t.map.set(e.param,r):t.map.delete(e.param)}})),this.cloneFrom=this.updates=null)}}]),t}();function eI(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function nI(t){return"undefined"!=typeof Blob&&t instanceof Blob}function rI(t){return"undefined"!=typeof FormData&&t instanceof FormData}var iI=function(){function t(e,n,r,i){var o;if(_classCallCheck(this,t),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new QS),this.params){var a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+a}}else this.params=new tI,this.urlWithParams=n}return _createClass(t,[{key:"serializeBody",value:function(){return null===this.body?null:eI(this.body)||nI(this.body)||rI(this.body)||"string"==typeof this.body?this.body:this.body instanceof tI?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body?null:rI(this.body)?null:nI(this.body)?this.body.type||null:eI(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof tI?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,s=void 0!==e.reportProgress?e.reportProgress:this.reportProgress,u=e.headers||this.headers,c=e.params||this.params;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((function(t,n){return t.set(n,e.setHeaders[n])}),u)),e.setParams&&(c=Object.keys(e.setParams).reduce((function(t,n){return t.set(n,e.setParams[n])}),c)),new t(n,r,o,{params:c,headers:u,reportProgress:s,responseType:i,withCredentials:a})}}]),t}(),oI=function(){var t={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return t[t.Sent]="Sent",t[t.UploadProgress]="UploadProgress",t[t.ResponseHeader]="ResponseHeader",t[t.DownloadProgress]="DownloadProgress",t[t.Response]="Response",t[t.User]="User",t}(),aI=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,t),this.headers=e.headers||new QS,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300},sI=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(t=e.call(this,r)).type=oI.ResponseHeader,t}return _createClass(n,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}]),n}(aI),uI=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(t=e.call(this,r)).type=oI.Response,t.body=void 0!==r.body?r.body:null,t}return _createClass(n,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}]),n}(aI),cI=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(t.url||"(unknown url)"):"Http failure response for ".concat(t.url||"(unknown url)",": ").concat(t.status," ").concat(t.statusText),r.error=t.error||null,r}return n}(aI);function lI(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}var hI,fI,dI,pI,vI,mI,gI,yI,bI,_I=((hI=function(){function t(e){_classCallCheck(this,t),this.handler=e}return _createClass(t,[{key:"request",value:function(t,e){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t instanceof iI)n=t;else{var o=void 0;o=i.headers instanceof QS?i.headers:new QS(i.headers);var a=void 0;i.params&&(a=i.params instanceof tI?i.params:new tI({fromObject:i.params})),n=new iI(t,e,void 0!==i.body?i.body:null,{headers:o,params:a,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}var s=Yd(n).pipe(jp((function(t){return r.handler.handle(t)})));if(t instanceof iI||"events"===i.observe)return s;var u=s.pipe(sp((function(t){return t instanceof uI})));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(z((function(t){if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body})));case"blob":return u.pipe(z((function(t){if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body})));case"text":return u.pipe(z((function(t){if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body})));case"json":default:return u.pipe(z((function(t){return t.body})))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(i.observe,"}"))}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",t,e)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",t,e)}},{key:"head",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",t,e)}},{key:"jsonp",value:function(t,e){return this.request("JSONP",t,{params:(new tI).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",t,e)}},{key:"patch",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",t,lI(n,e))}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",t,lI(n,e))}},{key:"put",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",t,lI(n,e))}}]),t}()).\u0275fac=function(t){return new(t||hI)(te($S))},hI.\u0275prov=mt({token:hI,factory:hI.\u0275fac}),hI),wI=function(){function t(e,n){_classCallCheck(this,t),this.next=e,this.interceptor=n}return _createClass(t,[{key:"handle",value:function(t){return this.interceptor.intercept(t,this.next)}}]),t}(),xI=new Ht("HTTP_INTERCEPTORS"),CI=((fI=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"intercept",value:function(t,e){return e.handle(t)}}]),t}()).\u0275fac=function(t){return new(t||fI)},fI.\u0275prov=mt({token:fI,factory:fI.\u0275fac}),fI),kI=/^\)\]\}',?\n/,EI=function t(){_classCallCheck(this,t)},SI=((pI=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"build",value:function(){return new XMLHttpRequest}}]),t}()).\u0275fac=function(t){return new(t||pI)},pI.\u0275prov=mt({token:pI,factory:pI.\u0275fac}),pI),II=((dI=function(){function t(e){_classCallCheck(this,t),this.xhrFactory=e}return _createClass(t,[{key:"handle",value:function(t){var e=this;if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new E((function(n){var r=e.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((function(t,e){return r.setRequestHeader(t,e.join(","))})),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){var i=t.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(t.responseType){var o=t.responseType.toLowerCase();r.responseType="json"!==o?o:"text"}var a=t.serializeBody(),s=null,u=function(){if(null!==s)return s;var e=1223===r.status?204:r.status,n=r.statusText||"OK",i=new QS(r.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||t.url;return s=new sI({headers:i,status:e,statusText:n,url:o})},c=function(){var e=u(),i=e.headers,o=e.status,a=e.statusText,s=e.url,c=null;204!==o&&(c=void 0===r.response?r.responseText:r.response),0===o&&(o=c?200:0);var l=o>=200&&o<300;if("json"===t.responseType&&"string"==typeof c){var h=c;c=c.replace(kI,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new uI({body:c,headers:i,status:o,statusText:a,url:s||void 0})),n.complete()):n.error(new cI({error:c,headers:i,status:o,statusText:a,url:s||void 0}))},l=function(t){var e=u().url,i=new cI({error:t,status:r.status||0,statusText:r.statusText||"Unknown Error",url:e||void 0});n.error(i)},h=!1,f=function(e){h||(n.next(u()),h=!0);var i={type:oI.DownloadProgress,loaded:e.loaded};e.lengthComputable&&(i.total=e.total),"text"===t.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(t){var e={type:oI.UploadProgress,loaded:t.loaded};t.lengthComputable&&(e.total=t.total),n.next(e)};return r.addEventListener("load",c),r.addEventListener("error",l),t.reportProgress&&(r.addEventListener("progress",f),null!==a&&r.upload&&r.upload.addEventListener("progress",d)),r.send(a),n.next({type:oI.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("load",c),t.reportProgress&&(r.removeEventListener("progress",f),null!==a&&r.upload&&r.upload.removeEventListener("progress",d)),r.abort()}}))}}]),t}()).\u0275fac=function(t){return new(t||dI)(te(EI))},dI.\u0275prov=mt({token:dI,factory:dI.\u0275fac}),dI),TI=new Ht("XSRF_COOKIE_NAME"),AI=new Ht("XSRF_HEADER_NAME"),RI=function t(){_classCallCheck(this,t)},OI=((bI=function(){function t(e,n,r){_classCallCheck(this,t),this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(t,[{key:"getToken",value:function(){if("server"===this.platform)return null;var t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Al(t,this.cookieName),this.lastCookieString=t),this.lastToken}}]),t}()).\u0275fac=function(t){return new(t||bI)(te(nl),te(ac),te(TI))},bI.\u0275prov=mt({token:bI,factory:bI.\u0275fac}),bI),NI=((yI=function(){function t(e,n){_classCallCheck(this,t),this.tokenService=e,this.headerName=n}return _createClass(t,[{key:"intercept",value:function(t,e){var n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);var r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}]),t}()).\u0275fac=function(t){return new(t||yI)(te(RI),te(AI))},yI.\u0275prov=mt({token:yI,factory:yI.\u0275fac}),yI),DI=((gI=function(){function t(e,n){_classCallCheck(this,t),this.backend=e,this.injector=n,this.chain=null}return _createClass(t,[{key:"handle",value:function(t){if(null===this.chain){var e=this.injector.get(xI,[]);this.chain=e.reduceRight((function(t,e){return new wI(t,e)}),this.backend)}return this.chain.handle(t)}}]),t}()).\u0275fac=function(t){return new(t||gI)(te(YS),te(oa))},gI.\u0275prov=mt({token:gI,factory:gI.\u0275fac}),gI),PI=((mI=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"disable",value:function(){return{ngModule:t,providers:[{provide:NI,useClass:CI}]}}},{key:"withOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:t,providers:[e.cookieName?{provide:TI,useValue:e.cookieName}:[],e.headerName?{provide:AI,useValue:e.headerName}:[]]}}}]),t}()).\u0275mod=Ce({type:mI}),mI.\u0275inj=gt({factory:function(t){return new(t||mI)},providers:[NI,{provide:xI,useExisting:NI,multi:!0},{provide:RI,useClass:OI},{provide:TI,useValue:"XSRF-TOKEN"},{provide:AI,useValue:"X-XSRF-TOKEN"}]}),mI),MI=((vI=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:vI}),vI.\u0275inj=gt({factory:function(t){return new(t||vI)},providers:[_I,{provide:$S,useClass:DI},II,{provide:YS,useExisting:II},SI,{provide:EI,useExisting:SI}],imports:[[PI.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),vI),FI=["*"];function LI(t){return Error('Unable to find icon with the name "'.concat(t,'"'))}function BI(t){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL "+"via Angular's DomSanitizer. Attempted URL was \"".concat(t,'".'))}function jI(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by "+"Angular's DomSanitizer. Attempted literal was \"".concat(t,'".'))}var VI,UI=function t(e,n){_classCallCheck(this,t),this.options=n,e.nodeName?this.svgElement=e:this.url=e},zI=((VI=function(){function t(e,n,r,i){_classCallCheck(this,t),this._httpClient=e,this._sanitizer=n,this._errorHandler=i,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=r}return _createClass(t,[{key:"addSvgIcon",value:function(t,e,n){return this.addSvgIconInNamespace("",t,e,n)}},{key:"addSvgIconLiteral",value:function(t,e,n){return this.addSvgIconLiteralInNamespace("",t,e,n)}},{key:"addSvgIconInNamespace",value:function(t,e,n,r){return this._addSvgIconConfig(t,e,new UI(n,r))}},{key:"addSvgIconLiteralInNamespace",value:function(t,e,n,r){var i=this._sanitizer.sanitize(Xr.HTML,n);if(!i)throw jI(n);var o=this._createSvgElementForSingleIcon(i,r);return this._addSvgIconConfig(t,e,new UI(o,r))}},{key:"addSvgIconSet",value:function(t,e){return this.addSvgIconSetInNamespace("",t,e)}},{key:"addSvgIconSetLiteral",value:function(t,e){return this.addSvgIconSetLiteralInNamespace("",t,e)}},{key:"addSvgIconSetInNamespace",value:function(t,e,n){return this._addSvgIconSetConfig(t,new UI(e,n))}},{key:"addSvgIconSetLiteralInNamespace",value:function(t,e,n){var r=this._sanitizer.sanitize(Xr.HTML,e);if(!r)throw jI(e);var i=this._svgElementFromString(r);return this._addSvgIconSetConfig(t,new UI(i,n))}},{key:"registerFontClassAlias",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._fontCssClassesByAlias.set(t,e),this}},{key:"classNameForFontAlias",value:function(t){return this._fontCssClassesByAlias.get(t)||t}},{key:"setDefaultFontSetClass",value:function(t){return this._defaultFontSetClass=t,this}},{key:"getDefaultFontSetClass",value:function(){return this._defaultFontSetClass}},{key:"getSvgIconFromUrl",value:function(t){var e=this,n=this._sanitizer.sanitize(Xr.RESOURCE_URL,t);if(!n)throw BI(t);var r=this._cachedIconsByUrl.get(n);return r?Yd(WI(r)):this._loadSvgIconFromConfig(new UI(t)).pipe(Up((function(t){return e._cachedIconsByUrl.set(n,t)})),z((function(t){return WI(t)})))}},{key:"getNamedSvgIcon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=qI(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);var i=this._iconSetConfigs.get(e);return i?this._getSvgFromIconSetConfigs(t,i):FC(LI(n))}},{key:"ngOnDestroy",value:function(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}},{key:"_getSvgFromConfig",value:function(t){return t.svgElement?Yd(WI(t.svgElement)):this._loadSvgIconFromConfig(t).pipe(Up((function(e){return t.svgElement=e})),z((function(t){return WI(t)})))}},{key:"_getSvgFromIconSetConfigs",value:function(t,e){var n=this,r=this._extractIconWithNameFromAnySet(t,e);return r?Yd(r):Hh(e.filter((function(t){return!t.svgElement})).map((function(t){return n._loadSvgIconSetFromConfig(t).pipe(xp((function(e){var r="Loading icon set URL: ".concat(n._sanitizer.sanitize(Xr.RESOURCE_URL,t.url)," failed: ").concat(e.message);return n._errorHandler?n._errorHandler.handleError(new Error(r)):console.error(r),Yd(null)})))}))).pipe(z((function(){var r=n._extractIconWithNameFromAnySet(t,e);if(!r)throw LI(t);return r})))}},{key:"_extractIconWithNameFromAnySet",value:function(t,e){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.svgElement){var i=this._extractSvgIconFromSet(r.svgElement,t,r.options);if(i)return i}}return null}},{key:"_loadSvgIconFromConfig",value:function(t){var e=this;return this._fetchUrl(t.url).pipe(z((function(n){return e._createSvgElementForSingleIcon(n,t.options)})))}},{key:"_loadSvgIconSetFromConfig",value:function(t){var e=this;return t.svgElement?Yd(t.svgElement):this._fetchUrl(t.url).pipe(z((function(n){return t.svgElement||(t.svgElement=e._svgElementFromString(n)),t.svgElement})))}},{key:"_createSvgElementForSingleIcon",value:function(t,e){var n=this._svgElementFromString(t);return this._setSvgAttributes(n,e),n}},{key:"_extractSvgIconFromSet",value:function(t,e,n){var r=t.querySelector('[id="'.concat(e,'"]'));if(!r)return null;var i=r.cloneNode(!0);if(i.removeAttribute("id"),"svg"===i.nodeName.toLowerCase())return this._setSvgAttributes(i,n);if("symbol"===i.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(i),n);var o=this._svgElementFromString("<svg></svg>");return o.appendChild(i),this._setSvgAttributes(o,n)}},{key:"_svgElementFromString",value:function(t){var e=this._document.createElement("DIV");e.innerHTML=t;var n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}},{key:"_toSvgElement",value:function(t){for(var e=this._svgElementFromString("<svg></svg>"),n=t.attributes,r=0;r<n.length;r++){var i=n[r],o=i.name,a=i.value;"id"!==o&&e.setAttribute(o,a)}for(var s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[s].cloneNode(!0));return e}},{key:"_setSvgAttributes",value:function(t,e){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),e&&e.viewBox&&t.setAttribute("viewBox",e.viewBox),t}},{key:"_fetchUrl",value:function(t){var e=this;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==t)throw Error('Cannot fetch icon from URL "'.concat(t,'".'));var n=this._sanitizer.sanitize(Xr.RESOURCE_URL,t);if(!n)throw BI(t);var r=this._inProgressUrlFetches.get(n);if(r)return r;var i=this._httpClient.get(n,{responseType:"text"}).pipe(qp((function(){return e._inProgressUrlFetches.delete(n)})),at());return this._inProgressUrlFetches.set(n,i),i}},{key:"_addSvgIconConfig",value:function(t,e,n){return this._svgIconConfigs.set(qI(t,e),n),this}},{key:"_addSvgIconSetConfig",value:function(t,e){var n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}}]),t}()).\u0275fac=function(t){return new(t||VI)(te(_I,8),te(Vh),te(nl,8),te(pr,8))},VI.\u0275prov=mt({factory:function(){return new VI(te(_I,8),te(Vh),te(nl,8),te(pr,8))},token:VI,providedIn:"root"}),VI);function WI(t){return t.cloneNode(!0)}function qI(t,e){return t+":"+e}var HI,GI,KI,XI,$I,YI=Vw((function t(e){_classCallCheck(this,t),this._elementRef=e})),QI=new Ht("mat-icon-location",{providedIn:"root",factory:function(){var t=ee(nl),e=t?t.location:null;return{getPathname:function(){return e?e.pathname+e.search:""}}}}),JI=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],ZI=JI.map((function(t){return"[".concat(t,"]")})).join(", "),tT=/^url\(['"]?#(.*?)['"]?\)$/,eT=((KI=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this,t))._iconRegistry=r,s._location=o,s._errorHandler=a,s._inline=!1,s._currentIconFetch=v.EMPTY,i||t.nativeElement.setAttribute("aria-hidden","true"),s}return _createClass(n,[{key:"_splitIconName",value:function(t){if(!t)return["",""];var e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error('Invalid icon name: "'.concat(t,'"'))}}},{key:"ngOnChanges",value:function(t){var e=this,n=t.svgIcon;if(n)if(this._currentIconFetch.unsubscribe(),this.svgIcon){var r=_slicedToArray(this._splitIconName(this.svgIcon),2),i=r[0],o=r[1];this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,i).pipe(Ep(1)).subscribe((function(t){return e._setSvgElement(t)}),(function(t){var n="Error retrieving icon ".concat(i,":").concat(o,"! ").concat(t.message);e._errorHandler?e._errorHandler.handleError(new Error(n)):console.error(n)}))}else n.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}},{key:"ngOnInit",value:function(){this._usingFontIcon()&&this._updateFontIconClasses()}},{key:"ngAfterViewChecked",value:function(){var t=this._elementsWithExternalReferences;if(t&&this._location&&t.size){var e=this._location.getPathname();e!==this._previousPath&&(this._previousPath=e,this._prependPathToReferences(e))}}},{key:"ngOnDestroy",value:function(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}},{key:"_usingFontIcon",value:function(){return!this.svgIcon}},{key:"_setSvgElement",value:function(t){this._clearSvgElement();for(var e=t.querySelectorAll("style"),n=0;n<e.length;n++)e[n].textContent+=" ";if(this._location){var r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r)}this._elementRef.nativeElement.appendChild(t)}},{key:"_clearSvgElement",value:function(){var t=this._elementRef.nativeElement,e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){var n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}},{key:"_updateFontIconClasses",value:function(){if(this._usingFontIcon()){var t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}}},{key:"_cleanupFontValue",value:function(t){return"string"==typeof t?t.trim().split(" ")[0]:t}},{key:"_prependPathToReferences",value:function(t){var e=this._elementsWithExternalReferences;e&&e.forEach((function(e,n){e.forEach((function(e){n.setAttribute(e.name,"url('".concat(t,"#").concat(e.value,"')"))}))}))}},{key:"_cacheChildrenWithExternalReferences",value:function(t){for(var e=t.querySelectorAll(ZI),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map,r=function(t){JI.forEach((function(r){var i=e[t],o=i.getAttribute(r),a=o?o.match(tT):null;if(a){var s=n.get(i);s||(s=[],n.set(i,s)),s.push({name:r,value:a[1]})}}))},i=0;i<e.length;i++)r(i)}},{key:"inline",get:function(){return this._inline},set:function(t){this._inline=x_(t)}},{key:"fontSet",get:function(){return this._fontSet},set:function(t){this._fontSet=this._cleanupFontValue(t)}},{key:"fontIcon",get:function(){return this._fontIcon},set:function(t){this._fontIcon=this._cleanupFontValue(t)}}]),n}(YI)).\u0275fac=function(t){return new(t||KI)(Ca(Us),Ca(zI),ka("aria-hidden"),Ca(QI,8),Ca(pr,8))},KI.\u0275cmp=be({type:KI,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(t,e){2&t&&ns("mat-icon-inline",e.inline)("mat-icon-no-color","primary"!==e.color&&"accent"!==e.color&&"warn"!==e.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[ws,Is],ngContentSelectors:FI,decls:1,vars:0,template:function(t,e){1&t&&(qa(),Ha(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),KI),nT=((GI=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:GI}),GI.\u0275inj=gt({factory:function(t){return new(t||GI)},imports:[[Bw],Bw]}),GI),rT=((HI=function t(){_classCallCheck(this,t),this.changes=new O,this.optionalLabel="Optional"}).\u0275fac=function(t){return new(t||HI)},HI.\u0275prov=mt({factory:function(){return new HI},token:HI,providedIn:"root"}),HI),iT={provide:rT,deps:[[new lt,new ft,rT]],useFactory:function(t){return t||new rT}},oT=(($I=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:$I}),$I.\u0275inj=gt({factory:function(t){return new(t||$I)},providers:[iT,px],imports:[[Bw,th,hk,dC,XS,nT,kx],Bw]}),$I),aT=((XI=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:XI}),XI.\u0275inj=gt({factory:function(t){return new(t||XI)},imports:[[th,Bw,hk,kx,X_,kw],Bw]}),XI),sT=["mat-sort-header",""];function uT(t,e){if(1&t){var n=Pa();Ta(0,"div",3),La("@arrowPosition.start",(function(){return tn(n),za()._disableViewStateAnimation=!0}))("@arrowPosition.done",(function(){return tn(n),za()._disableViewStateAnimation=!1})),Ra(1,"div",4),Ta(2,"div",5),Ra(3,"div",6),Ra(4,"div",7),Ra(5,"div",8),Aa(),Aa()}if(2&t){var r=za();Sa("@arrowOpacity",r._getArrowViewState())("@arrowPosition",r._getArrowViewState())("@allowChildren",r._getArrowDirectionState()),di(2),Sa("@indicator",r._getArrowDirectionState()),di(1),Sa("@leftPointer",r._getArrowDirectionState()),di(1),Sa("@rightPointer",r._getArrowDirectionState())}}var cT,lT,hT,fT,dT,pT=["*"],vT=Ww(jw((function t(){_classCallCheck(this,t)}))),mT=((cT=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments)).sortables=new Map,t._stateChanges=new O,t.start="asc",t._direction="",t.sortChange=new Nu,t}return _createClass(n,[{key:"register",value:function(t){if(!t.id)throw Error("MatSortHeader must be provided with a unique id.");if(this.sortables.has(t.id))throw Error("Cannot have two MatSortables with the same id (".concat(t.id,")."));this.sortables.set(t.id,t)}},{key:"deregister",value:function(t){this.sortables.delete(t.id)}},{key:"sort",value:function(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}},{key:"getNextSortDirection",value:function(t){if(!t)return"";var e,n,r,i=(e=t.start||this.start,n=null!=t.disableClear?t.disableClear:this.disableClear,r=["asc","desc"],"desc"==e&&r.reverse(),n||r.push(""),r),o=i.indexOf(this.direction)+1;return o>=i.length&&(o=0),i[o]}},{key:"ngOnInit",value:function(){this._markInitialized()}},{key:"ngOnChanges",value:function(){this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"direction",get:function(){return this._direction},set:function(t){if(Sr()&&t&&"asc"!==t&&"desc"!==t)throw function(t){return Error("".concat(t," is not a valid sort direction ('asc' or 'desc')."))}(t);this._direction=t}},{key:"disableClear",get:function(){return this._disableClear},set:function(t){this._disableClear=x_(t)}}]),n}(vT)).\u0275fac=function(t){return gT(t||cT)},cT.\u0275dir=Ee({type:cT,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"],active:["matSortActive","active"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[ws,Is]}),cT),gT=lr(mT),yT=Mw.ENTERING+" "+Pw.STANDARD_CURVE,bT={indicator:jg("indicator",[Wg("active-asc, asc",zg({transform:"translateY(0px)"})),Wg("active-desc, desc",zg({transform:"translateY(10px)"})),Hg("active-asc <=> active-desc",Vg(yT))]),leftPointer:jg("leftPointer",[Wg("active-asc, asc",zg({transform:"rotate(-45deg)"})),Wg("active-desc, desc",zg({transform:"rotate(45deg)"})),Hg("active-asc <=> active-desc",Vg(yT))]),rightPointer:jg("rightPointer",[Wg("active-asc, asc",zg({transform:"rotate(45deg)"})),Wg("active-desc, desc",zg({transform:"rotate(-45deg)"})),Hg("active-asc <=> active-desc",Vg(yT))]),arrowOpacity:jg("arrowOpacity",[Wg("desc-to-active, asc-to-active, active",zg({opacity:1})),Wg("desc-to-hint, asc-to-hint, hint",zg({opacity:.54})),Wg("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",zg({opacity:0})),Hg("* => asc, * => desc, * => active, * => hint, * => void",Vg("0ms")),Hg("* <=> *",Vg(yT))]),arrowPosition:jg("arrowPosition",[Hg("* => desc-to-hint, * => desc-to-active",Vg(yT,qg([zg({transform:"translateY(-25%)"}),zg({transform:"translateY(0)"})]))),Hg("* => hint-to-desc, * => active-to-desc",Vg(yT,qg([zg({transform:"translateY(0)"}),zg({transform:"translateY(25%)"})]))),Hg("* => asc-to-hint, * => asc-to-active",Vg(yT,qg([zg({transform:"translateY(25%)"}),zg({transform:"translateY(0)"})]))),Hg("* => hint-to-asc, * => active-to-asc",Vg(yT,qg([zg({transform:"translateY(0)"}),zg({transform:"translateY(-25%)"})]))),Wg("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",zg({transform:"translateY(0)"})),Wg("hint-to-desc, active-to-desc, desc",zg({transform:"translateY(-25%)"})),Wg("hint-to-asc, active-to-asc, asc",zg({transform:"translateY(25%)"}))]),allowChildren:jg("allowChildren",[Hg("* <=> *",[Kg("@*",Gg(),{optional:!0})])])},_T=((lT=function t(){_classCallCheck(this,t),this.changes=new O,this.sortButtonLabel=function(t){return"Change sorting for ".concat(t)}}).\u0275fac=function(t){return new(t||lT)},lT.\u0275prov=mt({factory:function(){return new lT},token:lT,providedIn:"root"}),lT),wT={provide:_T,deps:[[new lt,new ft,_T]],useFactory:function(t){return t||new _T}},xT=jw((function t(){_classCallCheck(this,t)})),CT=((dT=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s){var u;if(_classCallCheck(this,n),(u=e.call(this))._intl=t,u._sort=i,u._columnDef=o,u._focusMonitor=a,u._elementRef=s,u._showIndicatorHint=!1,u._arrowDirection="",u._disableViewStateAnimation=!1,u.arrowPosition="after",!i)throw Error("MatSortHeader must be placed within a parent element with the MatSort directive.");return u._rerenderSubscription=J(i.sortChange,i._stateChanges,t.changes).subscribe((function(){u._isSorted()&&u._updateArrowDirection(),!u._isSorted()&&u._viewState&&"active"===u._viewState.toState&&(u._disableViewStateAnimation=!1,u._setAnimationTransitionState({fromState:"active",toState:u._arrowDirection})),r.markForCheck()})),a&&s&&a.monitor(s,!0).subscribe((function(t){return u._setIndicatorHintVisible(!!t)})),_possibleConstructorReturn(u)}return _createClass(n,[{key:"ngOnInit",value:function(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this)}},{key:"ngOnDestroy",value:function(){this._focusMonitor&&this._elementRef&&this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}},{key:"_setIndicatorHintVisible",value:function(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}},{key:"_setAnimationTransitionState",value:function(t){this._viewState=t,this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}},{key:"_handleClick",value:function(){if(!this._isDisabled()){this._sort.sort(this),"hint"!==this._viewState.toState&&"active"!==this._viewState.toState||(this._disableViewStateAnimation=!0);var t=this._isSorted()?{fromState:this._arrowDirection,toState:"active"}:{fromState:"active",toState:this._arrowDirection};this._setAnimationTransitionState(t),this._showIndicatorHint=!1}}},{key:"_isSorted",value:function(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}},{key:"_getArrowDirectionState",value:function(){return"".concat(this._isSorted()?"active-":"").concat(this._arrowDirection)}},{key:"_getArrowViewState",value:function(){var t=this._viewState.fromState;return(t?"".concat(t,"-to-"):"")+this._viewState.toState}},{key:"_updateArrowDirection",value:function(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}},{key:"_isDisabled",value:function(){return this._sort.disabled||this.disabled}},{key:"_getAriaSortAttribute",value:function(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":null}},{key:"_renderArrow",value:function(){return!this._isDisabled()||this._isSorted()}},{key:"disableClear",get:function(){return this._disableClear},set:function(t){this._disableClear=x_(t)}}]),n}(xT)).\u0275fac=function(t){return new(t||dT)(Ca(_T),Ca(Wo),Ca(mT,8),Ca("MAT_SORT_HEADER_COLUMN_DEF",8),Ca(gw),Ca(Us))},dT.\u0275cmp=be({type:dT,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(t,e){1&t&&La("click",(function(){return e._handleClick()}))("mouseenter",(function(){return e._setIndicatorHintVisible(!0)}))("mouseleave",(function(){return e._setIndicatorHintVisible(!1)})),2&t&&(ba("aria-sort",e._getAriaSortAttribute()),ns("mat-sort-header-disabled",e._isDisabled()))},inputs:{disabled:"disabled",arrowPosition:"arrowPosition",disableClear:"disableClear",id:["mat-sort-header","id"],start:"start"},exportAs:["matSortHeader"],features:[ws],attrs:sT,ngContentSelectors:pT,decls:4,vars:7,consts:[[1,"mat-sort-header-container"],["type","button",1,"mat-sort-header-button","mat-focus-indicator"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(t,e){1&t&&(qa(),Ta(0,"div",0),Ta(1,"button",1),Ha(2),Aa(),wa(3,uT,6,6,"div",2),Aa()),2&t&&(ns("mat-sort-header-sorted",e._isSorted())("mat-sort-header-position-before","before"==e.arrowPosition),di(1),ba("disabled",e._isDisabled()||null)("aria-label",e._intl.sortButtonLabel(e.id)),di(2),Sa("ngIf",e._renderArrow()))},directives:[Ll],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-button{border:none;background:0 0;display:flex;align-items:center;padding:0;cursor:inherit;outline:0;font:inherit;color:currentColor;position:relative}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-button,[mat-sort-header].cdk-program-focused .mat-sort-header-button{border-bottom:solid 1px currentColor}.mat-sort-header-button::-moz-focus-inner{border:0}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}\n"],encapsulation:2,data:{animation:[bT.indicator,bT.leftPointer,bT.rightPointer,bT.arrowOpacity,bT.arrowPosition,bT.allowChildren]},changeDetection:0}),dT),kT=((fT=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:fT}),fT.\u0275inj=gt({factory:function(t){return new(t||fT)},providers:[wT],imports:[[th]]}),fT),ET=((hT=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:hT}),hT.\u0275inj=gt({factory:function(t){return new(t||hT)},imports:[[th,Bw],Bw]}),hT);function ST(t,e){}var IT=function t(){_classCallCheck(this,t),this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0},TT={dialogContainer:jg("dialogContainer",[Wg("void, exit",zg({opacity:0,transform:"scale(0.7)"})),Wg("enter",zg({transform:"none"})),Hg("* => enter",Vg("150ms cubic-bezier(0, 0, 0.2, 1)",zg({transform:"none",opacity:1}))),Hg("* => void, * => exit",Vg("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",zg({opacity:0})))])};function AT(){throw Error("Attempting to attach dialog content after content is already attached")}var RT,OT,NT,DT,PT,MT=((RT=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this))._elementRef=t,s._focusTrapFactory=r,s._changeDetectorRef=i,s._config=a,s._elementFocusedBeforeDialogWasOpened=null,s._state="enter",s._animationStateChanged=new Nu,s.attachDomPortal=function(t){return s._portalOutlet.hasAttached()&&AT(),s._setupFocusTrap(),s._portalOutlet.attachDomPortal(t)},s._ariaLabelledBy=a.ariaLabelledBy||null,s._document=o,s}return _createClass(n,[{key:"attachComponentPortal",value:function(t){return this._portalOutlet.hasAttached()&&AT(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(t)}},{key:"attachTemplatePortal",value:function(t){return this._portalOutlet.hasAttached()&&AT(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(t)}},{key:"_recaptureFocus",value:function(){this._containsFocus()||this._focusTrap.focusInitialElement()||this._elementRef.nativeElement.focus()}},{key:"_trapFocus",value:function(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}},{key:"_restoreFocus",value:function(){var t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){var e=this._document.activeElement,n=this._elementRef.nativeElement;e&&e!==this._document.body&&e!==n&&!n.contains(e)||t.focus()}this._focusTrap&&this._focusTrap.destroy()}},{key:"_setupFocusTrap",value:function(){var t=this;this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then((function(){return t._elementRef.nativeElement.focus()})))}},{key:"_containsFocus",value:function(){var t=this._elementRef.nativeElement,e=this._document.activeElement;return t===e||t.contains(e)}},{key:"_onAnimationDone",value:function(t){"enter"===t.toState?this._trapFocus():"exit"===t.toState&&this._restoreFocus(),this._animationStateChanged.emit(t)}},{key:"_onAnimationStart",value:function(t){this._animationStateChanged.emit(t)}},{key:"_startExitAnimation",value:function(){this._state="exit",this._changeDetectorRef.markForCheck()}}]),n}(uk)).\u0275fac=function(t){return new(t||RT)(Ca(Us),Ca(uw),Ca(Wo),Ca(nl,8),Ca(IT))},RT.\u0275cmp=be({type:RT,selectors:[["mat-dialog-container"]],viewQuery:function(t,e){var n;1&t&&qu(lk,!0),2&t&&Wu(n=Yu())&&(e._portalOutlet=n.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,e){1&t&&Ba("@dialogContainer.start",(function(t){return e._onAnimationStart(t)}))("@dialogContainer.done",(function(t){return e._onAnimationDone(t)})),2&t&&(ba("id",e._id)("role",e._config.role)("aria-labelledby",e._config.ariaLabel?null:e._ariaLabelledBy)("aria-label",e._config.ariaLabel)("aria-describedby",e._config.ariaDescribedBy||null),bs("@dialogContainer",e._state))},features:[ws],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&wa(0,ST,0,0,"ng-template",0)},directives:[lk],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[TT.dialogContainer]}}),RT),FT=0,LT=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mat-dialog-".concat(FT++);_classCallCheck(this,t),this._overlayRef=e,this._containerInstance=n,this.id=i,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new O,this._afterClosed=new O,this._beforeClosed=new O,this._state=0,n._id=i,n._animationStateChanged.pipe(sp((function(t){return"done"===t.phaseName&&"enter"===t.toState})),Ep(1)).subscribe((function(){r._afterOpened.next(),r._afterOpened.complete()})),n._animationStateChanged.pipe(sp((function(t){return"done"===t.phaseName&&"exit"===t.toState})),Ep(1)).subscribe((function(){clearTimeout(r._closeFallbackTimeout),r._finishDialogClose()})),e.detachments().subscribe((function(){r._beforeClosed.next(r._result),r._beforeClosed.complete(),r._afterClosed.next(r._result),r._afterClosed.complete(),r.componentInstance=null,r._overlayRef.dispose()})),e.keydownEvents().pipe(sp((function(t){return 27===t.keyCode&&!r.disableClose&&!f_(t)}))).subscribe((function(t){t.preventDefault(),r.close()})),e.backdropClick().subscribe((function(){r.disableClose?r._containerInstance._recaptureFocus():r.close()}))}return _createClass(t,[{key:"close",value:function(t){var e=this;this._result=t,this._containerInstance._animationStateChanged.pipe(sp((function(t){return"start"===t.phaseName})),Ep(1)).subscribe((function(n){e._beforeClosed.next(t),e._beforeClosed.complete(),e._overlayRef.detachBackdrop(),e._closeFallbackTimeout=setTimeout((function(){return e._finishDialogClose()}),n.totalTime+100)})),this._containerInstance._startExitAnimation(),this._state=1}},{key:"afterOpened",value:function(){return this._afterOpened.asObservable()}},{key:"afterClosed",value:function(){return this._afterClosed.asObservable()}},{key:"beforeClosed",value:function(){return this._beforeClosed.asObservable()}},{key:"backdropClick",value:function(){return this._overlayRef.backdropClick()}},{key:"keydownEvents",value:function(){return this._overlayRef.keydownEvents()}},{key:"updatePosition",value:function(t){var e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}},{key:"updateSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this._getPositionStrategy().width(t).height(e),this._overlayRef.updatePosition(),this}},{key:"addPanelClass",value:function(t){return this._overlayRef.addPanelClass(t),this}},{key:"removePanelClass",value:function(t){return this._overlayRef.removePanelClass(t),this}},{key:"getState",value:function(){return this._state}},{key:"_finishDialogClose",value:function(){this._state=2,this._overlayRef.dispose()}},{key:"_getPositionStrategy",value:function(){return this._overlayRef.getConfig().positionStrategy}}]),t}(),BT=new Ht("MatDialogData"),jT=new Ht("mat-dialog-default-options"),VT=new Ht("mat-dialog-scroll-strategy"),UT={provide:VT,deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.block()}}},zT=((PT=function(){function t(e,n,r,i,o,a,s){var u=this;_classCallCheck(this,t),this._overlay=e,this._injector=n,this._defaultOptions=i,this._parentDialog=a,this._overlayContainer=s,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new O,this._afterOpenedAtThisLevel=new O,this._ariaHiddenElements=new Map,this.afterAllClosed=op((function(){return u.openDialogs.length?u._afterAllClosed:u._afterAllClosed.pipe(Mp(void 0))})),this._scrollStrategy=o}return _createClass(t,[{key:"open",value:function(t,e){var n=this;if((e=function(t,e){return Object.assign(Object.assign({},e),t)}(e,this._defaultOptions||new IT)).id&&this.getDialogById(e.id))throw Error('Dialog with id "'.concat(e.id,'" exists already. The dialog id must be unique.'));var r=this._createOverlay(e),i=this._attachDialogContainer(r,e),o=this._attachDialogContent(t,i,r,e);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(o),o.afterClosed().subscribe((function(){return n._removeOpenDialog(o)})),this.afterOpened.next(o),o}},{key:"closeAll",value:function(){this._closeDialogs(this.openDialogs)}},{key:"getDialogById",value:function(t){return this.openDialogs.find((function(e){return e.id===t}))}},{key:"ngOnDestroy",value:function(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}},{key:"_createOverlay",value:function(t){var e=this._getOverlayConfig(t);return this._overlay.create(e)}},{key:"_getOverlayConfig",value:function(t){var e=new xk({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(e.backdropClass=t.backdropClass),e}},{key:"_attachDialogContainer",value:function(t,e){var n=oa.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:IT,useValue:e}]}),r=new ok(MT,e.viewContainerRef,n,e.componentFactoryResolver);return t.attach(r).instance}},{key:"_attachDialogContent",value:function(t,e,n,r){var i=new LT(n,e,r.id);if(t instanceof hu)e.attachTemplatePortal(new ak(t,null,{$implicit:r.data,dialogRef:i}));else{var o=this._createInjector(r,i,e),a=e.attachComponentPortal(new ok(t,r.viewContainerRef,o));i.componentInstance=a.instance}return i.updateSize(r.width,r.height).updatePosition(r.position),i}},{key:"_createInjector",value:function(t,e,n){var r=t&&t.viewContainerRef&&t.viewContainerRef.injector,i=[{provide:MT,useValue:n},{provide:BT,useValue:t.data},{provide:LT,useValue:e}];return!t.direction||r&&r.get(Sw,null)||i.push({provide:Sw,useValue:{value:t.direction,change:Yd()}}),oa.create({parent:r||this._injector,providers:i})}},{key:"_removeOpenDialog",value:function(t){var e=this.openDialogs.indexOf(t);e>-1&&(this.openDialogs.splice(e,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((function(t,e){t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")})),this._ariaHiddenElements.clear(),this._afterAllClosed.next()))}},{key:"_hideNonDialogContentFromAssistiveTechnology",value:function(){var t=this._overlayContainer.getContainerElement();if(t.parentElement)for(var e=t.parentElement.children,n=e.length-1;n>-1;n--){var r=e[n];r===t||"SCRIPT"===r.nodeName||"STYLE"===r.nodeName||r.hasAttribute("aria-live")||(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}},{key:"_closeDialogs",value:function(t){for(var e=t.length;e--;)t[e].close()}},{key:"openDialogs",get:function(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}},{key:"afterOpened",get:function(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}},{key:"_afterAllClosed",get:function(){var t=this._parentDialog;return t?t._afterAllClosed:this._afterAllClosedAtThisLevel}}]),t}()).\u0275fac=function(t){return new(t||PT)(te(Gk),te(oa),te(xl,8),te(jT,8),te(VT),te(PT,12),te(Ok))},PT.\u0275prov=mt({token:PT,factory:PT.\u0275fac}),PT),WT=0,qT=((DT=function(){function t(e,n,r){_classCallCheck(this,t),this.dialogRef=e,this._elementRef=n,this._dialog=r,this.type="button"}return _createClass(t,[{key:"ngOnInit",value:function(){this.dialogRef||(this.dialogRef=KT(this._elementRef,this._dialog.openDialogs))}},{key:"ngOnChanges",value:function(t){var e=t._matDialogClose||t._matDialogCloseResult;e&&(this.dialogResult=e.currentValue)}}]),t}()).\u0275fac=function(t){return new(t||DT)(Ca(LT,8),Ca(Us),Ca(zT))},DT.\u0275dir=Ee({type:DT,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(t,e){1&t&&La("click",(function(){return e.dialogRef.close(e.dialogResult)})),2&t&&ba("aria-label",e.ariaLabel||null)("type",e.type)},inputs:{type:"type",dialogResult:["mat-dialog-close","dialogResult"],ariaLabel:["aria-label","ariaLabel"],_matDialogClose:["matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],features:[Is]}),DT),HT=((NT=function(){function t(e,n,r){_classCallCheck(this,t),this._dialogRef=e,this._elementRef=n,this._dialog=r,this.id="mat-dialog-title-".concat(WT++)}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this._dialogRef||(this._dialogRef=KT(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then((function(){var e=t._dialogRef._containerInstance;e&&!e._ariaLabelledBy&&(e._ariaLabelledBy=t.id)}))}}]),t}()).\u0275fac=function(t){return new(t||NT)(Ca(LT,8),Ca(Us),Ca(zT))},NT.\u0275dir=Ee({type:NT,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(t,e){2&t&&ys("id",e.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),NT),GT=((OT=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||OT)},OT.\u0275dir=Ee({type:OT,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-dialog-actions"]}),OT);function KT(t,e){for(var n=t.nativeElement.parentElement;n&&!n.classList.contains("mat-dialog-container");)n=n.parentElement;return n?e.find((function(t){return t.id===n.id})):null}var XT,$T,YT,QT,JT,ZT,tA,eA,nA,rA,iA,oA,aA,sA=((XT=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:XT}),XT.\u0275inj=gt({factory:function(t){return new(t||XT)},providers:[zT,UT],imports:[[Jk,hk,Bw],Bw]}),XT),uA=B_({passive:!0}),cA=((YT=function(){function t(e,n){_classCallCheck(this,t),this._platform=e,this._ngZone=n,this._monitoredElements=new Map}return _createClass(t,[{key:"monitor",value:function(t){var e=this;if(!this._platform.isBrowser)return rp;var n=I_(t),r=this._monitoredElements.get(n);if(r)return r.subject.asObservable();var i=new O,o="cdk-text-field-autofilled",a=function(t){"cdk-text-field-autofill-start"!==t.animationName||n.classList.contains(o)?"cdk-text-field-autofill-end"===t.animationName&&n.classList.contains(o)&&(n.classList.remove(o),e._ngZone.run((function(){return i.next({target:t.target,isAutofilled:!1})}))):(n.classList.add(o),e._ngZone.run((function(){return i.next({target:t.target,isAutofilled:!0})})))};return this._ngZone.runOutsideAngular((function(){n.addEventListener("animationstart",a,uA),n.classList.add("cdk-text-field-autofill-monitored")})),this._monitoredElements.set(n,{subject:i,unlisten:function(){n.removeEventListener("animationstart",a,uA)}}),i.asObservable()}},{key:"stopMonitoring",value:function(t){var e=I_(t),n=this._monitoredElements.get(e);n&&(n.unlisten(),n.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}},{key:"ngOnDestroy",value:function(){var t=this;this._monitoredElements.forEach((function(e,n){return t.stopMonitoring(n)}))}}]),t}()).\u0275fac=function(t){return new(t||YT)(te(P_),te(xc))},YT.\u0275prov=mt({factory:function(){return new YT(te(P_),te(xc))},token:YT,providedIn:"root"}),YT),lA=(($T=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:$T}),$T.\u0275inj=gt({factory:function(t){return new(t||$T)},imports:[[M_]]}),$T),hA=new Ht("MAT_INPUT_VALUE_ACCESSOR"),fA=["button","checkbox","file","hidden","image","radio","range","reset","submit"],dA=0,pA=zw((function t(e,n,r,i){_classCallCheck(this,t),this._defaultErrorStateMatcher=e,this._parentForm=n,this._parentFormGroup=r,this.ngControl=i})),vA=((ZT=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s,u,c,l){var h;_classCallCheck(this,n),(h=e.call(this,s,o,a,i))._elementRef=t,h._platform=r,h.ngControl=i,h._autofillMonitor=c,h._uid="mat-input-".concat(dA++),h.focused=!1,h.stateChanges=new O,h.controlType="mat-input",h.autofilled=!1,h._disabled=!1,h._required=!1,h._type="text",h._readonly=!1,h._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter((function(t){return L_().has(t)}));var f=h._elementRef.nativeElement,d=f.nodeName.toLowerCase();return h._inputValueAccessor=u||f,h._previousNativeValue=h.value,h.id=h.id,r.IOS&&l.runOutsideAngular((function(){t.nativeElement.addEventListener("keyup",(function(t){var e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))}))})),h._isServer=!h._platform.isBrowser,h._isNativeSelect="select"===d,h._isTextarea="textarea"===d,h._isNativeSelect&&(h.controlType=f.multiple?"mat-native-select-multiple":"mat-native-select"),h}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe((function(e){t.autofilled=e.isAutofilled,t.stateChanges.next()}))}},{key:"ngOnChanges",value:function(){this.stateChanges.next()}},{key:"ngOnDestroy",value:function(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}},{key:"ngDoCheck",value:function(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}},{key:"focus",value:function(t){this._elementRef.nativeElement.focus(t)}},{key:"_focusChanged",value:function(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}},{key:"_onInput",value:function(){}},{key:"_dirtyCheckNativeValue",value:function(){var t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}},{key:"_validateType",value:function(){if(fA.indexOf(this._type)>-1)throw Error('Input type "'.concat(this._type,"\" isn't supported by matInput."))}},{key:"_isNeverEmpty",value:function(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}},{key:"_isBadInput",value:function(){var t=this._elementRef.nativeElement.validity;return t&&t.badInput}},{key:"setDescribedByIds",value:function(t){this._ariaDescribedby=t.join(" ")}},{key:"onContainerClick",value:function(){this.focused||this.focus()}},{key:"disabled",get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(t){this._disabled=x_(t),this.focused&&(this.focused=!1,this.stateChanges.next())}},{key:"id",get:function(){return this._id},set:function(t){this._id=t||this._uid}},{key:"required",get:function(){return this._required},set:function(t){this._required=x_(t)}},{key:"type",get:function(){return this._type},set:function(t){this._type=t||"text",this._validateType(),!this._isTextarea&&L_().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}},{key:"value",get:function(){return this._inputValueAccessor.value},set:function(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}},{key:"readonly",get:function(){return this._readonly},set:function(t){this._readonly=x_(t)}},{key:"empty",get:function(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}},{key:"shouldLabelFloat",get:function(){if(this._isNativeSelect){var t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}}]),n}(pA)).\u0275fac=function(t){return new(t||ZT)(Ca(Us),Ca(P_),Ca(lf,10),Ca(wd,8),Ca(Dd,8),Ca(px),Ca(hA,10),Ca(cA),Ca(xc))},ZT.\u0275dir=Ee({type:ZT,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(t,e){1&t&&La("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(ys("disabled",e.disabled)("required",e.required),ba("id",e.id)("placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-describedby",e._ariaDescribedby||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),ns("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[Ls([{provide:wE,useExisting:ZT}]),ws,Is]}),ZT),mA=((JT=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:JT}),JT.\u0275inj=gt({factory:function(t){return new(t||JT)},providers:[px],imports:[[lA,UE],lA,UE]}),JT),gA=((QT=function(){function t(){_classCallCheck(this,t),this.changes=new O,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}return _createClass(t,[{key:"formatYearRange",value:function(t,e){return"".concat(t," \u2013 ").concat(e)}}]),t}()).\u0275fac=function(t){return new(t||QT)},QT.\u0275prov=mt({factory:function(){return new QT},token:QT,providedIn:"root"}),QT),yA={provide:new Ht("mat-datepicker-scroll-strategy"),deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.reposition()}}},bA=((rA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:rA}),rA.\u0275inj=gt({factory:function(t){return new(t||rA)},providers:[gA,yA],imports:[[th,dC,sA,Jk,kw,hk],ZC]}),rA),_A=((nA=function t(e){_classCallCheck(this,t),this.template=e}).\u0275fac=function(t){return new(t||nA)(Ca(hu))},nA.\u0275dir=Ee({type:nA,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),nA),wA=((eA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:eA}),eA.\u0275inj=gt({factory:function(t){return new(t||eA)},providers:[gw,_A]}),eA),xA=((tA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:tA}),tA.\u0275inj=gt({factory:function(t){return new(t||tA)},imports:[[wA,Bw],Bw]}),tA),CA=["*",[["mat-toolbar-row"]]],kA=["*","mat-toolbar-row"],EA=Vw((function t(e){_classCallCheck(this,t),this._elementRef=e})),SA=((aA=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||aA)},aA.\u0275dir=Ee({type:aA,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),aA),IA=((oA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t))._platform=r,o._document=i,o}return _createClass(n,[{key:"ngAfterViewInit",value:function(){var t=this;Sr()&&this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe((function(){return t._checkToolbarMixedModes()})))}},{key:"_checkToolbarMixedModes",value:function(){var t=this;this._toolbarRows.length&&Array.from(this._elementRef.nativeElement.childNodes).filter((function(t){return!(t.classList&&t.classList.contains("mat-toolbar-row"))})).filter((function(e){return e.nodeType!==(t._document?t._document.COMMENT_NODE:8)})).some((function(t){return!(!t.textContent||!t.textContent.trim())}))&&function(){throw Error("MatToolbar: Attempting to combine different toolbar modes. Either specify multiple `<mat-toolbar-row>` elements explicitly or just place content inside of a `<mat-toolbar>` for a single row.")}()}}]),n}(EA)).\u0275fac=function(t){return new(t||oA)(Ca(Us),Ca(P_),Ca(nl))},oA.\u0275cmp=be({type:oA,selectors:[["mat-toolbar"]],contentQueries:function(t,e,n){var r;1&t&&Ku(n,SA,!0),2&t&&Wu(r=Yu())&&(e._toolbarRows=r)},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,e){2&t&&ns("mat-toolbar-multiple-rows",e._toolbarRows.length>0)("mat-toolbar-single-row",0===e._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[ws],ngContentSelectors:kA,decls:2,vars:0,template:function(t,e){1&t&&(qa(CA),Ha(0),Ha(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}\n"],encapsulation:2,changeDetection:0}),oA),TA=((iA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:iA}),iA.\u0275inj=gt({factory:function(t){return new(t||iA)},imports:[[Bw],Bw]}),iA),AA=["*"];function RA(t,e){if(1&t){var n=Pa();Ta(0,"div",2),La("click",(function(){return tn(n),za()._onBackdropClicked()})),Aa()}2&t&&ns("mat-drawer-shown",za()._isShowingBackdrop())}function OA(t,e){1&t&&(Ta(0,"mat-drawer-content"),Ha(1,2),Aa())}var NA=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],DA=["mat-drawer","mat-drawer-content","*"],PA={transformDrawer:jg("transform",[Wg("open, open-instant",zg({transform:"none",visibility:"visible"})),Wg("void",zg({"box-shadow":"none",visibility:"hidden"})),Hg("void => open-instant",Vg("0ms")),Hg("void <=> open, open-instant => void",Vg("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};function MA(t){throw Error("A drawer was already declared for 'position=\"".concat(t,"\"'"))}var FA,LA,BA,jA,VA,UA,zA=new Ht("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),WA=new Ht("MAT_DRAWER_CONTAINER"),qA=((jA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this,i,o,a))._changeDetectorRef=t,s._container=r,s}return _createClass(n,[{key:"ngAfterContentInit",value:function(){var t=this;this._container._contentMarginChanges.subscribe((function(){t._changeDetectorRef.markForCheck()}))}}]),n}(QC)).\u0275fac=function(t){return new(t||jA)(Ca(Wo),Ca(At((function(){return GA}))),Ca(Us),Ca(YC),Ca(xc))},jA.\u0275cmp=be({type:jA,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,e){2&t&&es("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[ws],ngContentSelectors:AA,decls:1,vars:0,template:function(t,e){1&t&&(qa(),Ha(0))},encapsulation:2,changeDetection:0}),jA),HA=((BA=function(){function t(e,n,r,i,o,a,s){var u=this;_classCallCheck(this,t),this._elementRef=e,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=i,this._ngZone=o,this._doc=a,this._container=s,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new O,this._animationEnd=new O,this._animationState="void",this.openedChange=new Nu(!0),this._destroyed=new O,this.onPositionChanged=new Nu,this._modeChanged=new O,this.openedChange.subscribe((function(t){t?(u._doc&&(u._elementFocusedBeforeDrawerWasOpened=u._doc.activeElement),u._takeFocus()):u._restoreFocus()})),this._ngZone.runOutsideAngular((function(){pC(u._elementRef.nativeElement,"keydown").pipe(sp((function(t){return 27===t.keyCode&&!u.disableClose&&!f_(t)})),OC(u._destroyed)).subscribe((function(t){return u._ngZone.run((function(){u.close(),t.stopPropagation(),t.preventDefault()}))}))})),this._animationEnd.pipe(CC((function(t,e){return t.fromState===e.fromState&&t.toState===e.toState}))).subscribe((function(t){var e=t.fromState,n=t.toState;(0===n.indexOf("open")&&"void"===e||"void"===n&&0===e.indexOf("open"))&&u.openedChange.emit(u._opened)}))}return _createClass(t,[{key:"_takeFocus",value:function(){var t=this;this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then((function(e){e||"function"!=typeof t._elementRef.nativeElement.focus||t._elementRef.nativeElement.focus()}))}},{key:"_restoreFocus",value:function(){if(this.autoFocus){var t=this._doc&&this._doc.activeElement;t&&this._elementRef.nativeElement.contains(t)&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}}},{key:"ngAfterContentInit",value:function(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}},{key:"ngAfterContentChecked",value:function(){this._platform.isBrowser&&(this._enableAnimations=!0)}},{key:"ngOnDestroy",value:function(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(t){return this.toggle(!0,t)}},{key:"close",value:function(){return this.toggle(!1)}},{key:"toggle",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.opened,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"program";return this._opened=e,e?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=n):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise((function(e){t.openedChange.pipe(Ep(1)).subscribe((function(t){return e(t?"open":"close")}))}))}},{key:"_updateFocusTrapState",value:function(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}},{key:"_animationStartListener",value:function(t){this._animationStarted.next(t)}},{key:"_animationDoneListener",value:function(t){this._animationEnd.next(t)}},{key:"position",get:function(){return this._position},set:function(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}},{key:"mode",get:function(){return this._mode},set:function(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}},{key:"disableClose",get:function(){return this._disableClose},set:function(t){this._disableClose=x_(t)}},{key:"autoFocus",get:function(){var t=this._autoFocus;return null==t?"side"!==this.mode:t},set:function(t){this._autoFocus=x_(t)}},{key:"opened",get:function(){return this._opened},set:function(t){this.toggle(x_(t))}},{key:"_openedStream",get:function(){return this.openedChange.pipe(sp((function(t){return t})),z((function(){})))}},{key:"openedStart",get:function(){return this._animationStarted.pipe(sp((function(t){return t.fromState!==t.toState&&0===t.toState.indexOf("open")})),z((function(){})))}},{key:"_closedStream",get:function(){return this.openedChange.pipe(sp((function(t){return!t})),z((function(){})))}},{key:"closedStart",get:function(){return this._animationStarted.pipe(sp((function(t){return t.fromState!==t.toState&&"void"===t.toState})),z((function(){})))}},{key:"_width",get:function(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}}]),t}()).\u0275fac=function(t){return new(t||BA)(Ca(Us),Ca(uw),Ca(gw),Ca(P_),Ca(xc),Ca(nl,8),Ca(WA,8))},BA.\u0275cmp=be({type:BA,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,e){1&t&&Ba("@transform.start",(function(t){return e._animationStartListener(t)}))("@transform.done",(function(t){return e._animationDoneListener(t)})),2&t&&(ba("align",null),bs("@transform",e._animationState),ns("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",onPositionChanged:"positionChanged",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart"},exportAs:["matDrawer"],ngContentSelectors:AA,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(qa(),Ta(0,"div",0),Ha(1),Aa())},encapsulation:2,data:{animation:[PA.transformDrawer]},changeDetection:0}),BA),GA=((LA=function(){function t(e,n,r,i,o){var a=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,t),this._dir=e,this._element=n,this._ngZone=r,this._changeDetectorRef=i,this._animationMode=u,this._drawers=new Pu,this.backdropClick=new Nu,this._destroyed=new O,this._doCheckSubject=new O,this._contentMargins={left:null,right:null},this._contentMarginChanges=new O,e&&e.change.pipe(OC(this._destroyed)).subscribe((function(){a._validateDrawers(),a.updateContentMargins()})),o.change().pipe(OC(this._destroyed)).subscribe((function(){return a.updateContentMargins()})),this._autosize=s}return _createClass(t,[{key:"ngAfterContentInit",value:function(){var t=this;this._allDrawers.changes.pipe(Mp(this._allDrawers),OC(this._destroyed)).subscribe((function(e){t._drawers.reset(e.filter((function(e){return!e._container||e._container===t}))),t._drawers.notifyOnChanges()})),this._drawers.changes.pipe(Mp(null)).subscribe((function(){t._validateDrawers(),t._drawers.forEach((function(e){t._watchDrawerToggle(e),t._watchDrawerPosition(e),t._watchDrawerMode(e)})),(!t._drawers.length||t._isDrawerOpen(t._start)||t._isDrawerOpen(t._end))&&t.updateContentMargins(),t._changeDetectorRef.markForCheck()})),this._doCheckSubject.pipe(g_(10),OC(this._destroyed)).subscribe((function(){return t.updateContentMargins()}))}},{key:"ngOnDestroy",value:function(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(){this._drawers.forEach((function(t){return t.open()}))}},{key:"close",value:function(){this._drawers.forEach((function(t){return t.close()}))}},{key:"updateContentMargins",value:function(){var t=this,e=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._width;else if("push"==this._left.mode){var r=this._left._width;e+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._width;else if("push"==this._right.mode){var i=this._right._width;n+=i,e-=i}n=n||null,(e=e||null)===this._contentMargins.left&&n===this._contentMargins.right||(this._contentMargins={left:e,right:n},this._ngZone.run((function(){return t._contentMarginChanges.next(t._contentMargins)})))}},{key:"ngDoCheck",value:function(){var t=this;this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular((function(){return t._doCheckSubject.next()}))}},{key:"_watchDrawerToggle",value:function(t){var e=this;t._animationStarted.pipe(sp((function(t){return t.fromState!==t.toState})),OC(this._drawers.changes)).subscribe((function(t){"open-instant"!==t.toState&&"NoopAnimations"!==e._animationMode&&e._element.nativeElement.classList.add("mat-drawer-transition"),e.updateContentMargins(),e._changeDetectorRef.markForCheck()})),"side"!==t.mode&&t.openedChange.pipe(OC(this._drawers.changes)).subscribe((function(){return e._setContainerClass(t.opened)}))}},{key:"_watchDrawerPosition",value:function(t){var e=this;t&&t.onPositionChanged.pipe(OC(this._drawers.changes)).subscribe((function(){e._ngZone.onMicrotaskEmpty.asObservable().pipe(Ep(1)).subscribe((function(){e._validateDrawers()}))}))}},{key:"_watchDrawerMode",value:function(t){var e=this;t&&t._modeChanged.pipe(OC(J(this._drawers.changes,this._destroyed))).subscribe((function(){e.updateContentMargins(),e._changeDetectorRef.markForCheck()}))}},{key:"_setContainerClass",value:function(t){var e=this._element.nativeElement.classList,n="mat-drawer-container-has-open";t?e.add(n):e.remove(n)}},{key:"_validateDrawers",value:function(){var t=this;this._start=this._end=null,this._drawers.forEach((function(e){"end"==e.position?(null!=t._end&&MA("end"),t._end=e):(null!=t._start&&MA("start"),t._start=e)})),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}},{key:"_isPushed",value:function(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}},{key:"_onBackdropClicked",value:function(){this.backdropClick.emit(),this._closeModalDrawer()}},{key:"_closeModalDrawer",value:function(){var t=this;[this._start,this._end].filter((function(e){return e&&!e.disableClose&&t._canHaveBackdrop(e)})).forEach((function(t){return t.close()}))}},{key:"_isShowingBackdrop",value:function(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}},{key:"_canHaveBackdrop",value:function(t){return"side"!==t.mode||!!this._backdropOverride}},{key:"_isDrawerOpen",value:function(t){return null!=t&&t.opened}},{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}},{key:"autosize",get:function(){return this._autosize},set:function(t){this._autosize=x_(t)}},{key:"hasBackdrop",get:function(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride},set:function(t){this._backdropOverride=null==t?null:x_(t)}},{key:"scrollable",get:function(){return this._userContent||this._content}}]),t}()).\u0275fac=function(t){return new(t||LA)(Ca(Sw,8),Ca(Us),Ca(xc),Ca(Wo),Ca(JC),Ca(zA),Ca(c_,8))},LA.\u0275cmp=be({type:LA,selectors:[["mat-drawer-container"]],contentQueries:function(t,e,n){var r;1&t&&(Ku(n,qA,!0),Ku(n,HA,!0)),2&t&&(Wu(r=Yu())&&(e._content=r.first),Wu(r=Yu())&&(e._allDrawers=r))},viewQuery:function(t,e){var n;1&t&&Hu(qA,!0),2&t&&Wu(n=Yu())&&(e._userContent=n.first)},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,e){2&t&&ns("mat-drawer-container-explicit-backdrop",e._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Ls([{provide:WA,useExisting:LA}])],ngContentSelectors:DA,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,e){1&t&&(qa(NA),wa(0,RA,1,2,"div",0),Ha(1),Ha(2,1),wa(3,OA,2,0,"mat-drawer-content",1)),2&t&&(Sa("ngIf",e.hasBackdrop),di(3),Sa("ngIf",!e._content))},directives:[Ll,qA],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),LA),KA=((FA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:FA}),FA.\u0275inj=gt({factory:function(t){return new(t||FA)},imports:[[th,Bw,M_,ZC],ZC,Bw]}),FA),XA=["*",[["mat-card-footer"]]],$A=["*","mat-card-footer"],YA=((UA=function t(e){_classCallCheck(this,t),this._animationMode=e}).\u0275fac=function(t){return new(t||UA)(Ca(c_,8))},UA.\u0275cmp=be({type:UA,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,e){2&t&&ns("_mat-animation-noopable","NoopAnimations"===e._animationMode)},exportAs:["matCard"],ngContentSelectors:$A,decls:2,vars:0,template:function(t,e){1&t&&(qa(XA),Ha(0),Ha(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),UA),QA=((VA=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:VA}),VA.\u0275inj=gt({factory:function(t){return new(t||VA)},imports:[[Bw],Bw]}),VA);function JA(t,e){if(1&t&&(En(),Ra(0,"circle",3)),2&t){var n=za();es("animation-name","mat-progress-spinner-stroke-rotate-"+n.diameter)("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),ba("r",n._circleRadius)}}function ZA(t,e){if(1&t&&(En(),Ra(0,"circle",3)),2&t){var n=za();es("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),ba("r",n._circleRadius)}}function tR(t,e){if(1&t&&(En(),Ra(0,"circle",3)),2&t){var n=za();es("animation-name","mat-progress-spinner-stroke-rotate-"+n.diameter)("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),ba("r",n._circleRadius)}}function eR(t,e){if(1&t&&(En(),Ra(0,"circle",3)),2&t){var n=za();es("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),ba("r",n._circleRadius)}}var nR,rR,iR,oR=Vw((function t(e){_classCallCheck(this,t),this._elementRef=e}),"primary"),aR=new Ht("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}}),sR=((iR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;_classCallCheck(this,n),(s=e.call(this,t))._elementRef=t,s._document=i,s._diameter=100,s._value=0,s._fallbackAnimation=!1,s.mode="determinate";var u=n._diameters;return u.has(i.head)||u.set(i.head,new Set([100])),s._fallbackAnimation=r.EDGE||r.TRIDENT,s._noopAnimations="NoopAnimations"===o&&!!a&&!a._forceAnimations,a&&(a.diameter&&(s.diameter=a.diameter),a.strokeWidth&&(s.strokeWidth=a.strokeWidth)),s}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this._elementRef.nativeElement;this._styleRoot=V_(t)||this._document.head,this._attachStyleNode(),t.classList.add("mat-progress-spinner-indeterminate".concat(this._fallbackAnimation?"-fallback":"","-animation"))}},{key:"_attachStyleNode",value:function(){var t=this._styleRoot,e=this._diameter,r=n._diameters,i=r.get(t);if(!i||!i.has(e)){var o=this._document.createElement("style");o.setAttribute("mat-spinner-animation",e+""),o.textContent=this._getAnimationText(),t.appendChild(o),i||(i=new Set,r.set(t,i)),i.add(e)}}},{key:"_getAnimationText",value:function(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,"".concat(.95*this._strokeCircumference)).replace(/END_VALUE/g,"".concat(.2*this._strokeCircumference)).replace(/DIAMETER/g,"".concat(this.diameter))}},{key:"diameter",get:function(){return this._diameter},set:function(t){this._diameter=C_(t),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}},{key:"strokeWidth",get:function(){return this._strokeWidth||this.diameter/10},set:function(t){this._strokeWidth=C_(t)}},{key:"value",get:function(){return"determinate"===this.mode?this._value:0},set:function(t){this._value=Math.max(0,Math.min(100,C_(t)))}},{key:"_circleRadius",get:function(){return(this.diameter-10)/2}},{key:"_viewBox",get:function(){var t=2*this._circleRadius+this.strokeWidth;return"0 0 ".concat(t," ").concat(t)}},{key:"_strokeCircumference",get:function(){return 2*Math.PI*this._circleRadius}},{key:"_strokeDashOffset",get:function(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}},{key:"_circleStrokeWidth",get:function(){return this.strokeWidth/this.diameter*100}}]),n}(oR)).\u0275fac=function(t){return new(t||iR)(Ca(Us),Ca(P_),Ca(nl,8),Ca(c_,8),Ca(aR))},iR.\u0275cmp=be({type:iR,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(ba("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),es("width",e.diameter,"px")("height",e.diameter,"px"),ns("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[ws],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(En(),Ta(0,"svg",0),wa(1,JA,1,9,"circle",1),wa(2,ZA,1,7,"circle",2),Aa()),2&t&&(es("width",e.diameter,"px")("height",e.diameter,"px"),Sa("ngSwitch","indeterminate"===e.mode),ba("viewBox",e._viewBox),di(1),Sa("ngSwitchCase",!0),di(1),Sa("ngSwitchCase",!1))},directives:[Kl,Xl],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),iR._diameters=new WeakMap,iR),uR=((rR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a){var s;return _classCallCheck(this,n),(s=e.call(this,t,r,i,o,a)).mode="indeterminate",s}return n}(sR)).\u0275fac=function(t){return new(t||rR)(Ca(Us),Ca(P_),Ca(nl,8),Ca(c_,8),Ca(aR))},rR.\u0275cmp=be({type:rR,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(t,e){2&t&&(es("width",e.diameter,"px")("height",e.diameter,"px"),ns("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color"},features:[ws],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(En(),Ta(0,"svg",0),wa(1,tR,1,9,"circle",1),wa(2,eR,1,7,"circle",2),Aa()),2&t&&(es("width",e.diameter,"px")("height",e.diameter,"px"),Sa("ngSwitch","indeterminate"===e.mode),ba("viewBox",e._viewBox),di(1),Sa("ngSwitchCase",!0),di(1),Sa("ngSwitchCase",!1))},directives:[Kl,Xl],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),rR),cR=((nR=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:nR}),nR.\u0275inj=gt({factory:function(t){return new(t||nR)},imports:[[Bw,th],Bw]}),nR),lR=[[["caption"]]],hR=["caption"];function fR(t){return function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i)))._sticky=!1,t._hasStickyChanged=!1,t}return _createClass(n,[{key:"hasStickyChanged",value:function(){var t=this._hasStickyChanged;return this._hasStickyChanged=!1,t}},{key:"resetStickyChanged",value:function(){this._hasStickyChanged=!1}},{key:"sticky",get:function(){return this._sticky},set:function(t){var e=this._sticky;this._sticky=x_(t),this._hasStickyChanged=e!==this._sticky}}]),n}(t)}var dR,pR,vR,mR,gR,yR,bR,_R,wR,xR,CR,kR,ER,SR=new Ht("CDK_TABLE"),IR=((vR=function t(e){_classCallCheck(this,t),this.template=e}).\u0275fac=function(t){return new(t||vR)(Ca(hu))},vR.\u0275dir=Ee({type:vR,selectors:[["","cdkCellDef",""]]}),vR),TR=((pR=function t(e){_classCallCheck(this,t),this.template=e}).\u0275fac=function(t){return new(t||pR)(Ca(hu))},pR.\u0275dir=Ee({type:pR,selectors:[["","cdkHeaderCellDef",""]]}),pR),AR=((dR=function t(e){_classCallCheck(this,t),this.template=e}).\u0275fac=function(t){return new(t||dR)(Ca(hu))},dR.\u0275dir=Ee({type:dR,selectors:[["","cdkFooterCellDef",""]]}),dR),RR=fR((function t(){_classCallCheck(this,t)})),OR=((mR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._table=t,r._stickyEnd=!1,r}return _createClass(n,[{key:"name",get:function(){return this._name},set:function(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"))}},{key:"stickyEnd",get:function(){return this._stickyEnd},set:function(t){var e=this._stickyEnd;this._stickyEnd=x_(t),this._hasStickyChanged=e!==this._stickyEnd}}]),n}(RR)).\u0275fac=function(t){return new(t||mR)(Ca(SR,8))},mR.\u0275dir=Ee({type:mR,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,e,n){var r;1&t&&(Ku(n,IR,!0),Ku(n,TR,!0),Ku(n,AR,!0)),2&t&&(Wu(r=Yu())&&(e.cell=r.first),Wu(r=Yu())&&(e.headerCell=r.first),Wu(r=Yu())&&(e.footerCell=r.first))},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[Ls([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:mR}]),ws]}),mR),NR=function t(e,n){_classCallCheck(this,t),n.nativeElement.classList.add("cdk-column-".concat(e.cssClassFriendlyName))},DR=((bR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){return _classCallCheck(this,n),e.call(this,t,r)}return n}(NR)).\u0275fac=function(t){return new(t||bR)(Ca(OR),Ca(Us))},bR.\u0275dir=Ee({type:bR,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[ws]}),bR),PR=((yR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){return _classCallCheck(this,n),e.call(this,t,r)}return n}(NR)).\u0275fac=function(t){return new(t||yR)(Ca(OR),Ca(Us))},yR.\u0275dir=Ee({type:yR,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:["role","gridcell",1,"cdk-cell"],features:[ws]}),yR),MR=((gR=function(){function t(e,n){_classCallCheck(this,t),this.template=e,this._differs=n}return _createClass(t,[{key:"ngOnChanges",value:function(t){if(!this._columnsDiffer){var e=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(e).create(),this._columnsDiffer.diff(e)}}},{key:"getColumnsDiff",value:function(){return this._columnsDiffer.diff(this.columns)}},{key:"extractCellTemplate",value:function(t){return this instanceof LR?t.headerCell.template:this instanceof jR?t.footerCell.template:t.cell.template}}]),t}()).\u0275fac=function(t){return new(t||gR)(Ca(hu),Ca(au))},gR.\u0275dir=Ee({type:gR,features:[Is]}),gR),FR=fR(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(MR)),LR=((_R=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r))._table=i,o}return _createClass(n,[{key:"ngOnChanges",value:function(t){_get(_getPrototypeOf(n.prototype),"ngOnChanges",this).call(this,t)}}]),n}(FR)).\u0275fac=function(t){return new(t||_R)(Ca(hu),Ca(au),Ca(SR,8))},_R.\u0275dir=Ee({type:_R,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[ws,Is]}),_R),BR=fR(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(MR)),jR=((ER=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r))._table=i,o}return _createClass(n,[{key:"ngOnChanges",value:function(t){_get(_getPrototypeOf(n.prototype),"ngOnChanges",this).call(this,t)}}]),n}(BR)).\u0275fac=function(t){return new(t||ER)(Ca(hu),Ca(au),Ca(SR,8))},ER.\u0275dir=Ee({type:ER,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[ws,Is]}),ER),VR=((kR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,t,r))._table=i,o}return n}(MR)).\u0275fac=function(t){return new(t||kR)(Ca(hu),Ca(au),Ca(SR,8))},kR.\u0275dir=Ee({type:kR,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[ws]}),kR),UR=((CR=function(){function t(e){_classCallCheck(this,t),this._viewContainer=e,t.mostRecentCellOutlet=this}return _createClass(t,[{key:"ngOnDestroy",value:function(){t.mostRecentCellOutlet===this&&(t.mostRecentCellOutlet=null)}}]),t}()).\u0275fac=function(t){return new(t||CR)(Ca(du))},CR.\u0275dir=Ee({type:CR,selectors:[["","cdkCellOutlet",""]]}),CR.mostRecentCellOutlet=null,CR),zR=((xR=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||xR)},xR.\u0275cmp=be({type:xR,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Da(0,0)},directives:[UR],encapsulation:2}),xR),WR=((wR=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||wR)},wR.\u0275cmp=be({type:wR,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Da(0,0)},directives:[UR],encapsulation:2}),wR),qR=["top","bottom","left","right"],HR=function(){function t(e,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];_classCallCheck(this,t),this._isNativeHtmlTable=e,this._stickCellCss=n,this.direction=r,this._isBrowser=i}return _createClass(t,[{key:"clearStickyPositioning",value:function(t,e){var n,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.nodeType===i.ELEMENT_NODE){this._removeStickyStyle(i,e);for(var o=0;o<i.children.length;o++)this._removeStickyStyle(i.children[o],e)}}}catch(a){r.e(a)}finally{r.f()}}},{key:"updateStickyColumns",value:function(t,e,n){var r=e.some((function(t){return t}))||n.some((function(t){return t}));if(t.length&&r&&this._isBrowser){var i,o=t[0],a=o.children.length,s=this._getCellWidths(o),u=this._getStickyStartColumnPositions(s,e),c=this._getStickyEndColumnPositions(s,n),l="rtl"===this.direction,h=_createForOfIteratorHelper(t);try{for(h.s();!(i=h.n()).done;)for(var f=i.value,d=0;d<a;d++){var p=f.children[d];e[d]&&this._addStickyStyle(p,l?"right":"left",u[d]),n[d]&&this._addStickyStyle(p,l?"left":"right",c[d])}}catch(v){h.e(v)}finally{h.f()}}}},{key:"stickRows",value:function(t,e,n){if(this._isBrowser)for(var r="bottom"===n?t.reverse():t,i=0,o=0;o<r.length;o++)if(e[o]){var a=r[o];if(this._isNativeHtmlTable)for(var s=0;s<a.children.length;s++)this._addStickyStyle(a.children[s],n,i);else this._addStickyStyle(a,n,i);if(o===r.length-1)return;i+=a.getBoundingClientRect().height}}},{key:"updateStickyFooterContainer",value:function(t,e){if(this._isNativeHtmlTable){var n=t.querySelector("tfoot");e.some((function(t){return!t}))?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0)}}},{key:"_removeStickyStyle",value:function(t,e){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.style[i]=""}}catch(o){r.e(o)}finally{r.f()}t.style.zIndex=this._getCalculatedZIndex(t),qR.some((function(e){return!!t.style[e]}))||(t.style.position="",t.classList.remove(this._stickCellCss))}},{key:"_addStickyStyle",value:function(t,e,n){t.classList.add(this._stickCellCss),t.style[e]="".concat(n,"px"),t.style.cssText+="position: -webkit-sticky; position: sticky; ",t.style.zIndex=this._getCalculatedZIndex(t)}},{key:"_getCalculatedZIndex",value:function(t){var e,n={top:100,bottom:10,left:1,right:1},r=0,i=_createForOfIteratorHelper(qR);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.style[o]&&(r+=n[o])}}catch(a){i.e(a)}finally{i.f()}return r?"".concat(r):""}},{key:"_getCellWidths",value:function(t){for(var e=[],n=t.children,r=0;r<n.length;r++)e.push(n[r].getBoundingClientRect().width);return e}},{key:"_getStickyStartColumnPositions",value:function(t,e){for(var n=[],r=0,i=0;i<t.length;i++)e[i]&&(n[i]=r,r+=t[i]);return n}},{key:"_getStickyEndColumnPositions",value:function(t,e){for(var n=[],r=0,i=t.length;i>0;i--)e[i]&&(n[i]=r,r+=t[i]);return n}}]),t}();function GR(t){return Error('Could not find column with id "'.concat(t,'".'))}var KR,XR,$R,YR,QR=((YR=function t(e,n){_classCallCheck(this,t),this.viewContainer=e,this.elementRef=n}).\u0275fac=function(t){return new(t||YR)(Ca(du),Ca(Us))},YR.\u0275dir=Ee({type:YR,selectors:[["","rowOutlet",""]]}),YR),JR=(($R=function t(e,n){_classCallCheck(this,t),this.viewContainer=e,this.elementRef=n}).\u0275fac=function(t){return new(t||$R)(Ca(du),Ca(Us))},$R.\u0275dir=Ee({type:$R,selectors:[["","headerRowOutlet",""]]}),$R),ZR=((XR=function t(e,n){_classCallCheck(this,t),this.viewContainer=e,this.elementRef=n}).\u0275fac=function(t){return new(t||XR)(Ca(du),Ca(Us))},XR.\u0275dir=Ee({type:XR,selectors:[["","footerRowOutlet",""]]}),XR),tO=((KR=function(){function t(e,n,r,i,o,a,s){_classCallCheck(this,t),this._differs=e,this._changeDetectorRef=n,this._elementRef=r,this._dir=o,this._platform=s,this._onDestroy=new O,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this._multiTemplateDataRows=!1,this.viewChange=new Qd({start:0,end:Number.MAX_VALUE}),i||this._elementRef.nativeElement.setAttribute("role","grid"),this._document=a,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((function(e,n){return t.trackBy?t.trackBy(n.dataIndex,n.data):n}))}},{key:"ngAfterContentChecked",value:function(){if(this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&!this._rowDefs.length)throw Error("Missing definitions for header, footer, and row; cannot determine which columns should be rendered.");this._renderUpdatedColumns(),this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription&&this._observeRenderChanges(),this._checkStickyStates()}},{key:"ngOnDestroy",value:function(){this._rowOutlet.viewContainer.clear(),this._headerRowOutlet.viewContainer.clear(),this._footerRowOutlet.viewContainer.clear(),this._cachedRenderRowsMap.clear(),this._onDestroy.next(),this._onDestroy.complete(),WC(this.dataSource)&&this.dataSource.disconnect(this)}},{key:"renderRows",value:function(){var t=this;this._renderRows=this._getAllRenderRows();var e=this._dataDiffer.diff(this._renderRows);if(e){var n=this._rowOutlet.viewContainer;e.forEachOperation((function(e,r,i){if(null==e.previousIndex)t._insertRow(e.item,i);else if(null==i)n.remove(r);else{var o=n.get(r);n.move(o,i)}})),this._updateRowIndexContext(),e.forEachIdentityChange((function(t){n.get(t.currentIndex).context.$implicit=t.item.data})),this.updateStickyColumnStyles()}}},{key:"setHeaderRowDef",value:function(t){this._customHeaderRowDefs=new Set([t]),this._headerRowDefChanged=!0}},{key:"setFooterRowDef",value:function(t){this._customFooterRowDefs=new Set([t]),this._footerRowDefChanged=!0}},{key:"addColumnDef",value:function(t){this._customColumnDefs.add(t)}},{key:"removeColumnDef",value:function(t){this._customColumnDefs.delete(t)}},{key:"addRowDef",value:function(t){this._customRowDefs.add(t)}},{key:"removeRowDef",value:function(t){this._customRowDefs.delete(t)}},{key:"addHeaderRowDef",value:function(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}},{key:"removeHeaderRowDef",value:function(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}},{key:"addFooterRowDef",value:function(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}},{key:"removeFooterRowDef",value:function(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}},{key:"updateStickyHeaderRowStyles",value:function(){var t=this._getRenderedRows(this._headerRowOutlet),e=this._elementRef.nativeElement.querySelector("thead");e&&(e.style.display=t.length?"":"none");var n=this._headerRowDefs.map((function(t){return t.sticky}));this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,n,"top"),this._headerRowDefs.forEach((function(t){return t.resetStickyChanged()}))}},{key:"updateStickyFooterRowStyles",value:function(){var t=this._getRenderedRows(this._footerRowOutlet),e=this._elementRef.nativeElement.querySelector("tfoot");e&&(e.style.display=t.length?"":"none");var n=this._footerRowDefs.map((function(t){return t.sticky}));this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,n,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,n),this._footerRowDefs.forEach((function(t){return t.resetStickyChanged()}))}},{key:"updateStickyColumnStyles",value:function(){var t=this,e=this._getRenderedRows(this._headerRowOutlet),n=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);this._stickyStyler.clearStickyPositioning([].concat(_toConsumableArray(e),_toConsumableArray(n),_toConsumableArray(r)),["left","right"]),e.forEach((function(e,n){t._addStickyColumnStyles([e],t._headerRowDefs[n])})),this._rowDefs.forEach((function(e){for(var r=[],i=0;i<n.length;i++)t._renderRows[i].rowDef===e&&r.push(n[i]);t._addStickyColumnStyles(r,e)})),r.forEach((function(e,n){t._addStickyColumnStyles([e],t._footerRowDefs[n])})),Array.from(this._columnDefsByName.values()).forEach((function(t){return t.resetStickyChanged()}))}},{key:"_getAllRenderRows",value:function(){var t=[],e=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(var n=0;n<this._data.length;n++){var r=this._data[n],i=this._getRenderRowsForData(r,n,e.get(r));this._cachedRenderRowsMap.has(r)||this._cachedRenderRowsMap.set(r,new WeakMap);for(var o=0;o<i.length;o++){var a=i[o],s=this._cachedRenderRowsMap.get(a.data);s.has(a.rowDef)?s.get(a.rowDef).push(a):s.set(a.rowDef,[a]),t.push(a)}}return t}},{key:"_getRenderRowsForData",value:function(t,e,n){return this._getRowDefs(t,e).map((function(r){var i=n&&n.has(r)?n.get(r):[];if(i.length){var o=i.shift();return o.dataIndex=e,o}return{data:t,rowDef:r,dataIndex:e}}))}},{key:"_cacheColumnDefs",value:function(){var t=this;this._columnDefsByName.clear(),eO(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach((function(e){if(t._columnDefsByName.has(e.name))throw function(t){return Error('Duplicate column definition name provided: "'.concat(t,'".'))}(e.name);t._columnDefsByName.set(e.name,e)}))}},{key:"_cacheRowDefs",value:function(){this._headerRowDefs=eO(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=eO(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=eO(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);var t=this._rowDefs.filter((function(t){return!t.when}));if(!this.multiTemplateDataRows&&t.length>1)throw Error("There can only be one default row without a when predicate function.");this._defaultRowDef=t[0]}},{key:"_renderUpdatedColumns",value:function(){var t=function(t,e){return t||!!e.getColumnsDiff()};this._rowDefs.reduce(t,!1)&&this._forceRenderDataRows(),this._headerRowDefs.reduce(t,!1)&&this._forceRenderHeaderRows(),this._footerRowDefs.reduce(t,!1)&&this._forceRenderFooterRows()}},{key:"_switchDataSource",value:function(t){this._data=[],WC(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}},{key:"_observeRenderChanges",value:function(){var t=this;if(this.dataSource){var e,n;if(WC(this.dataSource)?e=this.dataSource.connect(this):(n=this.dataSource)&&(n instanceof E||"function"==typeof n.lift&&"function"==typeof n.subscribe)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=Yd(this.dataSource)),void 0===e)throw Error("Provided data source did not match an array, Observable, or DataSource");this._renderChangeSubscription=e.pipe(OC(this._onDestroy)).subscribe((function(e){t._data=e||[],t.renderRows()}))}}},{key:"_forceRenderHeaderRows",value:function(){var t=this;this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((function(e,n){return t._renderRow(t._headerRowOutlet,e,n)})),this.updateStickyHeaderRowStyles(),this.updateStickyColumnStyles()}},{key:"_forceRenderFooterRows",value:function(){var t=this;this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((function(e,n){return t._renderRow(t._footerRowOutlet,e,n)})),this.updateStickyFooterRowStyles(),this.updateStickyColumnStyles()}},{key:"_addStickyColumnStyles",value:function(t,e){var n=this,r=Array.from(e.columns||[]).map((function(t){var e=n._columnDefsByName.get(t);if(!e)throw GR(t);return e})),i=r.map((function(t){return t.sticky})),o=r.map((function(t){return t.stickyEnd}));this._stickyStyler.updateStickyColumns(t,i,o)}},{key:"_getRenderedRows",value:function(t){for(var e=[],n=0;n<t.viewContainer.length;n++){var r=t.viewContainer.get(n);e.push(r.rootNodes[0])}return e}},{key:"_getRowDefs",value:function(t,e){if(1==this._rowDefs.length)return[this._rowDefs[0]];var n=[];if(this.multiTemplateDataRows)n=this._rowDefs.filter((function(n){return!n.when||n.when(e,t)}));else{var r=this._rowDefs.find((function(n){return n.when&&n.when(e,t)}))||this._defaultRowDef;r&&n.push(r)}if(!n.length)throw function(t){return Error("Could not find a matching row definition for the"+"provided row data: ".concat(JSON.stringify(t)))}(t);return n}},{key:"_insertRow",value:function(t,e){this._renderRow(this._rowOutlet,t.rowDef,e,{$implicit:t.data})}},{key:"_renderRow",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.viewContainer.createEmbeddedView(e.template,r,n);var i,o=_createForOfIteratorHelper(this._getCellTemplates(e));try{for(o.s();!(i=o.n()).done;){var a=i.value;UR.mostRecentCellOutlet&&UR.mostRecentCellOutlet._viewContainer.createEmbeddedView(a,r)}}catch(s){o.e(s)}finally{o.f()}this._changeDetectorRef.markForCheck()}},{key:"_updateRowIndexContext",value:function(){for(var t=this._rowOutlet.viewContainer,e=0,n=t.length;e<n;e++){var r=t.get(e).context;r.count=n,r.first=0===e,r.last=e===n-1,r.even=e%2==0,r.odd=!r.even,this.multiTemplateDataRows?(r.dataIndex=this._renderRows[e].dataIndex,r.renderIndex=e):r.index=this._renderRows[e].dataIndex}}},{key:"_getCellTemplates",value:function(t){var e=this;return t&&t.columns?Array.from(t.columns,(function(n){var r=e._columnDefsByName.get(n);if(!r)throw GR(n);return t.extractCellTemplate(r)})):[]}},{key:"_applyNativeTableSections",value:function(){for(var t=this._document.createDocumentFragment(),e=0,n=[{tag:"thead",outlet:this._headerRowOutlet},{tag:"tbody",outlet:this._rowOutlet},{tag:"tfoot",outlet:this._footerRowOutlet}];e<n.length;e++){var r=n[e],i=this._document.createElement(r.tag);i.setAttribute("role","rowgroup"),i.appendChild(r.outlet.elementRef.nativeElement),t.appendChild(i)}this._elementRef.nativeElement.appendChild(t)}},{key:"_forceRenderDataRows",value:function(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows(),this.updateStickyColumnStyles()}},{key:"_checkStickyStates",value:function(){var t=function(t,e){return t||e.hasStickyChanged()};this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&this.updateStickyColumnStyles()}},{key:"_setupStickyStyler",value:function(){var t=this;this._stickyStyler=new HR(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._platform.isBrowser),(this._dir?this._dir.change:Yd()).pipe(OC(this._onDestroy)).subscribe((function(e){t._stickyStyler.direction=e,t.updateStickyColumnStyles()}))}},{key:"_getOwnDefs",value:function(t){var e=this;return t.filter((function(t){return!t._table||t._table===e}))}},{key:"trackBy",get:function(){return this._trackByFn},set:function(t){Sr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(t),".")),this._trackByFn=t}},{key:"dataSource",get:function(){return this._dataSource},set:function(t){this._dataSource!==t&&this._switchDataSource(t)}},{key:"multiTemplateDataRows",get:function(){return this._multiTemplateDataRows},set:function(t){this._multiTemplateDataRows=x_(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&this._forceRenderDataRows()}}]),t}()).\u0275fac=function(t){return new(t||KR)(Ca(au),Ca(Wo),Ca(Us),ka("role"),Ca(Sw,8),Ca(nl),Ca(P_))},KR.\u0275cmp=be({type:KR,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,e,n){var r;1&t&&(Ku(n,OR,!0),Ku(n,VR,!0),Ku(n,LR,!0),Ku(n,jR,!0)),2&t&&(Wu(r=Yu())&&(e._contentColumnDefs=r),Wu(r=Yu())&&(e._contentRowDefs=r),Wu(r=Yu())&&(e._contentHeaderRowDefs=r),Wu(r=Yu())&&(e._contentFooterRowDefs=r))},viewQuery:function(t,e){var n;1&t&&(qu(QR,!0),qu(JR,!0),qu(ZR,!0)),2&t&&(Wu(n=Yu())&&(e._rowOutlet=n.first),Wu(n=Yu())&&(e._headerRowOutlet=n.first),Wu(n=Yu())&&(e._footerRowOutlet=n.first))},hostAttrs:[1,"cdk-table"],inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows"},exportAs:["cdkTable"],features:[Ls([{provide:SR,useExisting:KR}])],ngContentSelectors:hR,decls:4,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["footerRowOutlet",""]],template:function(t,e){1&t&&(qa(lR),Ha(0),Da(1,0),Da(2,1),Da(3,2))},directives:[JR,QR,ZR],encapsulation:2}),KR);function eO(t,e){return t.concat(Array.from(e))}var nO,rO,iO,oO,aO,sO,uO,cO,lO,hO,fO,dO,pO,vO=((nO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:nO}),nO.\u0275inj=gt({factory:function(t){return new(t||nO)}}),nO),mO=[[["caption"]]],gO=["caption"],yO=((rO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments)).stickyCssClass="mat-table-sticky",t}return n}(tO)).\u0275fac=function(t){return bO(t||rO)},rO.\u0275cmp=be({type:rO,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-table"],exportAs:["matTable"],features:[Ls([{provide:tO,useExisting:rO},{provide:SR,useExisting:rO}]),ws],ngContentSelectors:gO,decls:4,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["footerRowOutlet",""]],template:function(t,e){1&t&&(qa(mO),Ha(0),Da(1,0),Da(2,1),Da(3,2))},directives:[JR,QR,ZR],styles:['mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-row::after,mat-header-row::after,mat-footer-row::after{display:inline-block;min-height:inherit;content:""}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type,[dir=rtl] mat-header-cell:first-of-type,[dir=rtl] mat-footer-cell:first-of-type{padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type,[dir=rtl] mat-header-cell:last-of-type,[dir=rtl] mat-footer-cell:last-of-type{padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}table.mat-table{border-spacing:0}tr.mat-header-row{height:56px}tr.mat-row,tr.mat-footer-row{height:48px}th.mat-header-cell{text-align:left}[dir=rtl] th.mat-header-cell{text-align:right}th.mat-header-cell,td.mat-cell,td.mat-footer-cell{padding:0;border-bottom-width:1px;border-bottom-style:solid}th.mat-header-cell:first-of-type,td.mat-cell:first-of-type,td.mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] th.mat-header-cell:first-of-type,[dir=rtl] td.mat-cell:first-of-type,[dir=rtl] td.mat-footer-cell:first-of-type{padding-left:0;padding-right:24px}th.mat-header-cell:last-of-type,td.mat-cell:last-of-type,td.mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] th.mat-header-cell:last-of-type,[dir=rtl] td.mat-cell:last-of-type,[dir=rtl] td.mat-footer-cell:last-of-type{padding-right:0;padding-left:24px}\n'],encapsulation:2}),rO),bO=lr(yO),_O=((iO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(IR)).\u0275fac=function(t){return wO(t||iO)},iO.\u0275dir=Ee({type:iO,selectors:[["","matCellDef",""]],features:[Ls([{provide:IR,useExisting:iO}]),ws]}),iO),wO=lr(_O),xO=((oO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(TR)).\u0275fac=function(t){return CO(t||oO)},oO.\u0275dir=Ee({type:oO,selectors:[["","matHeaderCellDef",""]],features:[Ls([{provide:TR,useExisting:oO}]),ws]}),oO),CO=lr(xO),kO=((aO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(OR)).\u0275fac=function(t){return EO(t||aO)},aO.\u0275dir=Ee({type:aO,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[Ls([{provide:OR,useExisting:aO},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:aO}]),ws]}),aO),EO=lr(kO),SO=((cO=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),i=e.call(this,t,r),r.nativeElement.classList.add("mat-column-".concat(t.cssClassFriendlyName)),i}return n}(DR)).\u0275fac=function(t){return new(t||cO)(Ca(OR),Ca(Us))},cO.\u0275dir=Ee({type:cO,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-header-cell"],features:[ws]}),cO),IO=((uO=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),i=e.call(this,t,r),r.nativeElement.classList.add("mat-column-".concat(t.cssClassFriendlyName)),i}return n}(PR)).\u0275fac=function(t){return new(t||uO)(Ca(OR),Ca(Us))},uO.\u0275dir=Ee({type:uO,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:["role","gridcell",1,"mat-cell"],features:[ws]}),uO),TO=((sO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(LR)).\u0275fac=function(t){return AO(t||sO)},sO.\u0275dir=Ee({type:sO,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[Ls([{provide:LR,useExisting:sO}]),ws]}),sO),AO=lr(TO),RO=((lO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(VR)).\u0275fac=function(t){return OO(t||lO)},lO.\u0275dir=Ee({type:lO,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[Ls([{provide:VR,useExisting:lO}]),ws]}),lO),OO=lr(RO),NO=((hO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(zR)).\u0275fac=function(t){return DO(t||hO)},hO.\u0275cmp=be({type:hO,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-header-row"],exportAs:["matHeaderRow"],features:[Ls([{provide:zR,useExisting:hO}]),ws],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Da(0,0)},directives:[UR],encapsulation:2}),hO),DO=lr(NO),PO=((fO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(WR)).\u0275fac=function(t){return MO(t||fO)},fO.\u0275cmp=be({type:fO,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-row"],exportAs:["matRow"],features:[Ls([{provide:WR,useExisting:fO}]),ws],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,e){1&t&&Da(0,0)},directives:[UR],encapsulation:2}),fO),MO=lr(PO),FO=((dO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:dO}),dO.\u0275inj=gt({factory:function(t){return new(t||dO)},imports:[[vO,Bw],Bw]}),dO),LO=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _classCallCheck(this,n),(t=e.call(this))._renderData=new Qd([]),t._filter=new Qd(""),t._internalPageChanges=new O,t._renderChangesSubscription=v.EMPTY,t.sortingDataAccessor=function(t,e){var n=t[e];if(k_(n)){var r=Number(n);return r<9007199254740991?r:n}return n},t.sortData=function(e,n){var r=n.active,i=n.direction;return r&&""!=i?e.sort((function(e,n){var o=t.sortingDataAccessor(e,r),a=t.sortingDataAccessor(n,r),s=0;return null!=o&&null!=a?o>a?s=1:o<a&&(s=-1):null!=o?s=1:null!=a&&(s=-1),s*("asc"==i?1:-1)})):e},t.filterPredicate=function(t,e){var n=Object.keys(t).reduce((function(e,n){return e+t[n]+"\u25ec"}),"").toLowerCase(),r=e.trim().toLowerCase();return-1!=n.indexOf(r)},t._data=new Qd(r),t._updateChangeSubscription(),t}return _createClass(n,[{key:"_updateChangeSubscription",value:function(){var t=this,e=this._sort?J(this._sort.sortChange,this._sort.initialized):Yd(null),n=this._paginator?J(this._paginator.page,this._internalPageChanges,this._paginator.initialized):Yd(null),r=tp([this._data,this._filter]).pipe(z((function(e){var n=_slicedToArray(e,1)[0];return t._filterData(n)}))),i=tp([r,e]).pipe(z((function(e){var n=_slicedToArray(e,1)[0];return t._orderData(n)}))),o=tp([i,n]).pipe(z((function(e){var n=_slicedToArray(e,1)[0];return t._pageData(n)})));this._renderChangesSubscription.unsubscribe(),this._renderChangesSubscription=o.subscribe((function(e){return t._renderData.next(e)}))}},{key:"_filterData",value:function(t){var e=this;return this.filteredData=this.filter?t.filter((function(t){return e.filterPredicate(t,e.filter)})):t,this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}},{key:"_orderData",value:function(t){return this.sort?this.sortData(t.slice(),this.sort):t}},{key:"_pageData",value:function(t){if(!this.paginator)return t;var e=this.paginator.pageIndex*this.paginator.pageSize;return t.slice(e,e+this.paginator.pageSize)}},{key:"_updatePaginator",value:function(t){var e=this;Promise.resolve().then((function(){var n=e.paginator;if(n&&(n.length=t,n.pageIndex>0)){var r=Math.ceil(n.length/n.pageSize)-1||0,i=Math.min(n.pageIndex,r);i!==n.pageIndex&&(n.pageIndex=i,e._internalPageChanges.next())}}))}},{key:"connect",value:function(){return this._renderData}},{key:"disconnect",value:function(){}},{key:"data",get:function(){return this._data.value},set:function(t){this._data.next(t)}},{key:"filter",get:function(){return this._filter.value},set:function(t){this._filter.next(t)}},{key:"sort",get:function(){return this._sort},set:function(t){this._sort=t,this._updateChangeSubscription()}},{key:"paginator",get:function(){return this._paginator},set:function(t){this._paginator=t,this._updateChangeSubscription()}}]),n}(function(){return function t(){_classCallCheck(this,t)}}()),BO=((pO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:pO}),pO.\u0275inj=gt({factory:function(t){return new(t||pO)},imports:[[kx,Bw],Bw]}),pO);function jO(t,e){if(1&t){var n=Pa();Ta(0,"div",1),Ta(1,"button",2),La("click",(function(){return tn(n),za().action()})),ps(2),Aa(),Aa()}if(2&t){var r=za();di(2),vs(r.data.action)}}function VO(t,e){}var UO,zO,WO,qO,HO,GO,KO,XO,$O,YO,QO,JO,ZO,tN,eN,nN,rN,iN,oN=Math.pow(2,31)-1,aN=function(){function t(e,n){var r=this;_classCallCheck(this,t),this._overlayRef=n,this._afterDismissed=new O,this._afterOpened=new O,this._onAction=new O,this._dismissedByAction=!1,this.containerInstance=e,this.onAction().subscribe((function(){return r.dismiss()})),e._onExit.subscribe((function(){return r._finishDismiss()}))}return _createClass(t,[{key:"dismiss",value:function(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}},{key:"dismissWithAction",value:function(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}},{key:"closeWithAction",value:function(){this.dismissWithAction()}},{key:"_dismissAfter",value:function(t){var e=this;this._durationTimeoutId=setTimeout((function(){return e.dismiss()}),Math.min(t,oN))}},{key:"_open",value:function(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}},{key:"_finishDismiss",value:function(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}},{key:"afterDismissed",value:function(){return this._afterDismissed.asObservable()}},{key:"afterOpened",value:function(){return this.containerInstance._onEnter}},{key:"onAction",value:function(){return this._onAction.asObservable()}}]),t}(),sN=new Ht("MatSnackBarData"),uN=function t(){_classCallCheck(this,t),this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"},cN=((UO=function(){function t(e,n){_classCallCheck(this,t),this.snackBarRef=e,this.data=n}return _createClass(t,[{key:"action",value:function(){this.snackBarRef.dismissWithAction()}},{key:"hasAction",get:function(){return!!this.data.action}}]),t}()).\u0275fac=function(t){return new(t||UO)(Ca(aN),Ca(sN))},UO.\u0275cmp=be({type:UO,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(Ta(0,"span"),ps(1),Aa(),wa(2,jO,3,1,"div",0)),2&t&&(di(1),vs(e.data.message),di(1),Sa("ngIf",e.hasAction))},directives:[Ll,hC],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),UO),lN={snackBarState:jg("state",[Wg("void, hidden",zg({transform:"scale(0.8)",opacity:0})),Wg("visible",zg({transform:"scale(1)",opacity:1})),Hg("* => visible",Vg("150ms cubic-bezier(0, 0, 0.2, 1)")),Hg("* => void, * => hidden",Vg("75ms cubic-bezier(0.4, 0.0, 1, 1)",zg({opacity:0})))])},hN=((WO=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this))._ngZone=t,a._elementRef=r,a._changeDetectorRef=i,a.snackBarConfig=o,a._destroyed=!1,a._onExit=new O,a._onEnter=new O,a._animationState="void",a.attachDomPortal=function(t){return a._assertNotAttached(),a._applySnackBarClasses(),a._portalOutlet.attachDomPortal(t)},a._role="assertive"!==o.politeness||o.announcementMessage?"off"===o.politeness?null:"status":"alert",a}return _createClass(n,[{key:"attachComponentPortal",value:function(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(t)}},{key:"attachTemplatePortal",value:function(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(t)}},{key:"onAnimationEnd",value:function(t){var e=t.fromState,n=t.toState;if(("void"===n&&"void"!==e||"hidden"===n)&&this._completeExit(),"visible"===n){var r=this._onEnter;this._ngZone.run((function(){r.next(),r.complete()}))}}},{key:"enter",value:function(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}},{key:"exit",value:function(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),this._onExit}},{key:"ngOnDestroy",value:function(){this._destroyed=!0,this._completeExit()}},{key:"_completeExit",value:function(){var t=this;this._ngZone.onMicrotaskEmpty.asObservable().pipe(Ep(1)).subscribe((function(){t._onExit.next(),t._onExit.complete()}))}},{key:"_applySnackBarClasses",value:function(){var t=this._elementRef.nativeElement,e=this.snackBarConfig.panelClass;e&&(Array.isArray(e)?e.forEach((function(e){return t.classList.add(e)})):t.classList.add(e)),"center"===this.snackBarConfig.horizontalPosition&&t.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&t.classList.add("mat-snack-bar-top")}},{key:"_assertNotAttached",value:function(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}]),n}(uk)).\u0275fac=function(t){return new(t||WO)(Ca(xc),Ca(Us),Ca(Wo),Ca(uN))},WO.\u0275cmp=be({type:WO,selectors:[["snack-bar-container"]],viewQuery:function(t,e){var n;1&t&&qu(lk,!0),2&t&&Wu(n=Yu())&&(e._portalOutlet=n.first)},hostAttrs:[1,"mat-snack-bar-container"],hostVars:2,hostBindings:function(t,e){1&t&&Ba("@state.done",(function(t){return e.onAnimationEnd(t)})),2&t&&(ba("role",e._role),bs("@state",e._animationState))},features:[ws],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&wa(0,VO,0,0,"ng-template",0)},directives:[lk],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[lN.snackBarState]}}),WO),fN=((zO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:zO}),zO.\u0275inj=gt({factory:function(t){return new(t||zO)},imports:[[Jk,hk,th,dC,Bw],Bw]}),zO),dN=new Ht("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new uN}}),pN=((ZO=function(){function t(e,n,r,i,o,a){_classCallCheck(this,t),this._overlay=e,this._live=n,this._injector=r,this._breakpointObserver=i,this._parentSnackBar=o,this._defaultConfig=a,this._snackBarRefAtThisLevel=null}return _createClass(t,[{key:"openFromComponent",value:function(t,e){return this._attach(t,e)}},{key:"openFromTemplate",value:function(t,e){return this._attach(t,e)}},{key:"open",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=Object.assign(Object.assign({},this._defaultConfig),n);return r.data={message:t,action:e},r.announcementMessage||(r.announcementMessage=t),this.openFromComponent(cN,r)}},{key:"dismiss",value:function(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}},{key:"ngOnDestroy",value:function(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}},{key:"_attachSnackBarContainer",value:function(t,e){var n=new fk(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[uN,e]])),r=new ok(hN,e.viewContainerRef,n),i=t.attach(r);return i.instance.snackBarConfig=e,i.instance}},{key:"_attach",value:function(t,e){var n=Object.assign(Object.assign(Object.assign({},new uN),this._defaultConfig),e),r=this._createOverlay(n),i=this._attachSnackBarContainer(r,n),o=new aN(i,r);if(t instanceof hu){var a=new ak(t,null,{$implicit:n.data,snackBarRef:o});o.instance=i.attachTemplatePortal(a)}else{var s=this._createInjector(n,o),u=new ok(t,void 0,s),c=i.attachComponentPortal(u);o.instance=c.instance}return this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait)").pipe(OC(r.detachments())).subscribe((function(t){var e=r.overlayElement.classList;t.matches?e.add("mat-snack-bar-handset"):e.remove("mat-snack-bar-handset")})),this._animateSnackBar(o,n),this._openedSnackBarRef=o,this._openedSnackBarRef}},{key:"_animateSnackBar",value:function(t,e){var n=this;t.afterDismissed().subscribe((function(){n._openedSnackBarRef==t&&(n._openedSnackBarRef=null),e.announcementMessage&&n._live.clear()})),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe((function(){t.containerInstance.enter()})),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),e.duration&&e.duration>0&&t.afterOpened().subscribe((function(){return t._dismissAfter(e.duration)})),e.announcementMessage&&this._live.announce(e.announcementMessage,e.politeness)}},{key:"_createOverlay",value:function(t){var e=new xk;e.direction=t.direction;var n=this._overlay.position().global(),r="rtl"===t.direction,i="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!r||"end"===t.horizontalPosition&&r,o=!i&&"center"!==t.horizontalPosition;return i?n.left("0"):o?n.right("0"):n.centerHorizontally(),"top"===t.verticalPosition?n.top("0"):n.bottom("0"),e.positionStrategy=n,this._overlay.create(e)}},{key:"_createInjector",value:function(t,e){return new fk(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[aN,e],[sN,t.data]]))}},{key:"_openedSnackBarRef",get:function(){var t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel},set:function(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}}]),t}()).\u0275fac=function(t){return new(t||ZO)(te(Gk),te(fw),te(oa),te(yS),te(ZO,12),te(dN))},ZO.\u0275prov=mt({factory:function(){return new ZO(te(Gk),te(fw),te(Gt),te(yS),te(ZO,12),te(dN))},token:ZO,providedIn:fN}),ZO),vN=((JO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:JO}),JO.\u0275inj=gt({factory:function(t){return new(t||JO)}}),JO),mN=((QO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:QO}),QO.\u0275inj=gt({factory:function(t){return new(t||QO)},imports:[[kx,Bw,X_,vN],Bw,vN]}),QO),gN=((YO=function(){function t(){_classCallCheck(this,t),this._vertical=!1,this._inset=!1}return _createClass(t,[{key:"vertical",get:function(){return this._vertical},set:function(t){this._vertical=x_(t)}},{key:"inset",get:function(){return this._inset},set:function(t){this._inset=x_(t)}}]),t}()).\u0275fac=function(t){return new(t||YO)},YO.\u0275cmp=be({type:YO,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(t,e){2&t&&(ba("aria-orientation",e.vertical?"vertical":"horizontal"),ns("mat-divider-vertical",e.vertical)("mat-divider-horizontal",!e.vertical)("mat-divider-inset",e.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(t,e){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),YO),yN=(($O=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:$O}),$O.\u0275inj=gt({factory:function(t){return new(t||$O)},imports:[[Bw],Bw]}),$O),bN=((XO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:XO}),XO.\u0275inj=gt({factory:function(t){return new(t||XO)},imports:[[vx,kx,Bw,Sx,th],vx,Bw,Sx,yN]}),XO),_N=((KO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:KO}),KO.\u0275inj=gt({factory:function(t){return new(t||KO)}}),KO),wN=((GO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:GO}),GO.\u0275inj=gt({factory:function(t){return new(t||GO)},imports:[[th,_N,hk]]}),GO),xN=((HO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:HO}),HO.\u0275inj=gt({factory:function(t){return new(t||HO)}}),HO),CN=((qO=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:qO}),qO.\u0275inj=gt({factory:function(t){return new(t||qO)},imports:[[xN,kx,Bw,X_],xN,Bw]}),qO),kN={provide:new Ht("mat-menu-scroll-strategy"),deps:[Gk],useFactory:function(t){return function(){return t.scrollStrategies.reposition()}}},EN=((nN=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:nN}),nN.\u0275inj=gt({factory:function(t){return new(t||nN)},providers:[kN],imports:[Bw]}),nN),SN=((eN=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:eN}),eN.\u0275inj=gt({factory:function(t){return new(t||eN)},providers:[kN],imports:[[th,Bw,kx,Jk,EN],ZC,Bw,EN]}),eN),IN=((tN=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:tN}),tN.\u0275inj=gt({factory:function(t){return new(t||tN)},imports:[[th],h_,TA,dC,nT,KA,QA,UE,cR,mA,FO,Bx,SN,hS,BO,fN,sA,mN,bN,oC,xA,ET,bA,aC,bA,dx,KS,OS,oT,aT,kT,ET,wN,aC,CN,yN]}),tN),TN={provide:sc,useFactory:function(t,e){return function(){if(eh(e)){var n=Array.from(t.querySelectorAll("[class*=".concat(AN,"]"))),r=/\bflex-layout-.+?\b/g;n.forEach((function(t){t.classList.contains("".concat(AN,"ssr"))&&t.parentNode?t.parentNode.removeChild(t):t.className.replace(r,"")}))}}},deps:[nl,ac],multi:!0},AN="flex-layout-",RN=((rN=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:rN}),rN.\u0275inj=gt({factory:function(t){return new(t||rN)},providers:[TN]}),rN),ON=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;_classCallCheck(this,t),this.matches=e,this.mediaQuery=n,this.mqAlias=r,this.suffix=i,this.priority=o,this.property=""}return _createClass(t,[{key:"clone",value:function(){return new t(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}]),t}(),NN=((iN=function(){function t(){_classCallCheck(this,t),this.stylesheet=new Map}return _createClass(t,[{key:"addStyleToElement",value:function(t,e,n){var r=this.stylesheet.get(t);r?r.set(e,n):this.stylesheet.set(t,new Map([[e,n]]))}},{key:"clearStyles",value:function(){this.stylesheet.clear()}},{key:"getStyleForElement",value:function(t,e){var n=this.stylesheet.get(t),r="";if(n){var i=n.get(e);"number"!=typeof i&&"string"!=typeof i||(r=i+"")}return r}}]),t}()).\u0275fac=function(t){return new(t||iN)},iN.\u0275prov=mt({factory:function(){return new iN},token:iN,providedIn:"root"}),iN),DN={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[]},PN=new Ht("Flex Layout token, config options for the library",{providedIn:"root",factory:function(){return DN}}),MN=new Ht("FlexLayoutServerLoaded",{providedIn:"root",factory:function(){return!1}}),FN=new Ht("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:function(){return null}});function LN(t,e){return t=t?t.clone():new ON,e&&(t.mqAlias=e.alias,t.mediaQuery=e.mediaQuery,t.suffix=e.suffix,t.priority=e.priority),t}var BN=["row","column","row-reverse","column-reverse"];function jN(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}var VN,UN=((VN=function(){function t(e,n,r,i){_classCallCheck(this,t),this.elementRef=e,this.styleBuilder=n,this.styler=r,this.marshal=i,this.DIRECTIVE_KEY="",this.inputs=[],this.mru={},this.destroySubject=new O,this.styleCache=new Map}return _createClass(t,[{key:"ngOnChanges",value:function(t){var e=this;Object.keys(t).forEach((function(n){if(-1!==e.inputs.indexOf(n)){var r=n.split(".").slice(1).join(".");e.setValue(t[n].currentValue,r)}}))}},{key:"ngOnDestroy",value:function(){this.destroySubject.next(),this.destroySubject.complete(),this.marshal.releaseElement(this.nativeElement)}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.marshal.init(this.elementRef.nativeElement,this.DIRECTIVE_KEY,this.updateWithValue.bind(this),this.clearStyles.bind(this),t)}},{key:"addStyles",value:function(t,e){var n=this.styleBuilder,r=n.shouldCache,i=this.styleCache.get(t);i&&r||(i=n.buildStyles(t,e),r&&this.styleCache.set(t,i)),this.mru=Object.assign({},i),this.applyStyleToElement(i),n.sideEffect(t,i,e)}},{key:"clearStyles",value:function(){var t=this;Object.keys(this.mru).forEach((function(e){t.mru[e]=""})),this.applyStyleToElement(this.mru),this.mru={}}},{key:"triggerUpdate",value:function(){this.marshal.triggerUpdate(this.nativeElement,this.DIRECTIVE_KEY)}},{key:"getFlexFlowDirection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var n=this.styler.getFlowDirection(t),r=_slicedToArray(n,2),i=r[0],o=r[1];if(!o&&e){var a=function(t){var e=function(t){var e=_slicedToArray((t=t?t.toLowerCase():"").split(" "),3),n=e[0],r=e[1],i=e[2];return BN.find((function(t){return t===n}))||(n=BN[0]),"inline"===r&&(r="inline"!==i?i:"",i="inline"),[n,jN(r),!!i]}(t),n=_slicedToArray(e,3);return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}(n[0],n[1],n[2])}(i);this.styler.applyStyleToElements(a,[t])}return i.trim()}return"row"}},{key:"hasWrap",value:function(t){return this.styler.hasWrap(t)}},{key:"applyStyleToElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nativeElement;this.styler.applyStyleToElement(n,t,e)}},{key:"setValue",value:function(t,e){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,e)}},{key:"updateWithValue",value:function(t){this.currentValue!==t&&(this.addStyles(t),this.currentValue=t)}},{key:"parentElement",get:function(){return this.elementRef.nativeElement.parentElement}},{key:"nativeElement",get:function(){return this.elementRef.nativeElement}},{key:"activatedValue",get:function(){return this.marshal.getValue(this.nativeElement,this.DIRECTIVE_KEY)},set:function(t){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,this.marshal.activatedAlias)}}]),t}()).\u0275fac=function(t){Ea()},VN.\u0275dir=Ee({type:VN,features:[Is]}),VN),zN=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.9px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.9px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.9px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.9px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.9px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.9px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.9px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.9px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.9px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],WN="(orientation: portrait) and (min-width: 600px) and (max-width: 839.9px)",qN="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.9px)",HN="(orientation: portrait) and (min-width: 840px)",GN="(orientation: landscape) and (min-width: 1280px)",KN={HANDSET:"(orientation: portrait) and (max-width: 599.9px), (orientation: landscape) and (max-width: 959.9px)",TABLET:"".concat(WN," , ").concat(qN),WEB:"".concat(HN,", ").concat(GN," "),HANDSET_PORTRAIT:"(orientation: portrait) and (max-width: 599.9px)",TABLET_PORTRAIT:"".concat(WN," "),WEB_PORTRAIT:"".concat(HN),HANDSET_LANDSCAPE:"(orientation: landscape) and (max-width: 959.9px)",TABLET_LANDSCAPE:"".concat(qN),WEB_LANDSCAPE:"".concat(GN)},XN=[{alias:"handset",priority:2e3,mediaQuery:KN.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:KN.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:KN.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:KN.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:KN.TABLET_LANDSCAPE},{alias:"tablet.portrait",priority:2100,mediaQuery:KN.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:KN.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:KN.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:KN.WEB_PORTRAIT,overlapping:!0}],$N=/(\.|-|_)/g;function YN(t){var e=t.length>0?t.charAt(0):"",n=t.length>1?t.slice(1):"";return e.toUpperCase()+n}var QN=new Ht("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:function(){var t=ee(FN),e=ee(PN),n=[].concat.apply([],(t||[]).map((function(t){return Array.isArray(t)?t:[t]})));return function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r={};return t.forEach((function(t){r[t.alias]=t})),n.forEach((function(t){r[t.alias]?function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(null!=a)for(var s in a)a.hasOwnProperty(s)&&(t[s]=a[s])}}(r[t.alias],t):r[t.alias]=t})),(e=Object.keys(r).map((function(t){return r[t]}))).forEach((function(t){t.suffix||(t.suffix=function(t){return t.replace($N,"|").split("|").map(YN).join("")}(t.alias),t.overlapping=!!t.overlapping)})),e}((e.disableDefaultBps?[]:zN).concat(e.addOrientationBps?XN:[]),n)}});function JN(t,e){return(e&&e.priority||0)-(t&&t.priority||0)}function ZN(t,e){return(t.priority||0)-(e.priority||0)}var tD,eD,nD,rD=((eD=function(){function t(e){_classCallCheck(this,t),this.findByMap=new Map,this.items=_toConsumableArray(e).sort(ZN)}return _createClass(t,[{key:"findByAlias",value:function(t){return t?this.findWithPredicate(t,(function(e){return e.alias==t})):null}},{key:"findByQuery",value:function(t){return this.findWithPredicate(t,(function(e){return e.mediaQuery==t}))}},{key:"findWithPredicate",value:function(t,e){var n=this.findByMap.get(t);return n||(n=this.items.find(e)||null,this.findByMap.set(t,n)),n||null}},{key:"overlappings",get:function(){return this.items.filter((function(t){return 1==t.overlapping}))}},{key:"aliases",get:function(){return this.items.map((function(t){return t.alias}))}},{key:"suffixes",get:function(){return this.items.map((function(t){return t.suffix?t.suffix:""}))}}]),t}()).\u0275fac=function(t){return new(t||eD)(te(QN))},eD.\u0275prov=mt({factory:function(){return new eD(te(QN))},token:eD,providedIn:"root"}),eD),iD=((tD=function(){function t(e,n,r){_classCallCheck(this,t),this._zone=e,this._platformId=n,this._document=r,this.source=new Qd(new ON(!0)),this.registry=new Map,this.pendingRemoveListenerFns=[],this._observable$=this.source.asObservable()}return _createClass(t,[{key:"isActive",value:function(t){var e=this.registry.get(t);return e?e.matches:this.registerQuery(t).some((function(t){return t.matches}))}},{key:"observe",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&t.length){var r=this._observable$.pipe(sp((function(e){return!n||t.indexOf(e.mediaQuery)>-1})));return J(new E((function(n){var r=e.registerQuery(t);if(r.length){var i=r.pop();r.forEach((function(t){n.next(t)})),e.source.next(i)}n.complete()})),r)}return this._observable$}},{key:"registerQuery",value:function(t){var e=this,n=Array.isArray(t)?t:[t],r=[];return function(t,e){var n=t.filter((function(t){return!oD[t]}));if(n.length>0){var r=n.join(", ");try{var i=e.createElement("style");i.setAttribute("type","text/css"),i.styleSheet||i.appendChild(e.createTextNode("\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ".concat(r," {.fx-query-test{ }}\n"))),e.head.appendChild(i),n.forEach((function(t){return oD[t]=i}))}catch(o){console.error(o)}}}(n,this._document),n.forEach((function(t){var n=function(n){e._zone.run((function(){return e.source.next(new ON(n.matches,t))}))},i=e.registry.get(t);i||((i=e.buildMQL(t)).addListener(n),e.pendingRemoveListenerFns.push((function(){return i.removeListener(n)})),e.registry.set(t,i)),i.matches&&r.push(new ON(!0,t))})),r}},{key:"ngOnDestroy",value:function(){for(var t;t=this.pendingRemoveListenerFns.pop();)t()}},{key:"buildMQL",value:function(t){return function(t,e){return e&&window.matchMedia("all").addListener?window.matchMedia(t):{matches:"all"===t||""===t,media:t,addListener:function(){},removeListener:function(){},onchange:null,addEventListener:function(){},removeEventListener:function(){},dispatchEvent:function(){return!1}}}(t,eh(this._platformId))}},{key:"activations",get:function(){var t=[];return this.registry.forEach((function(e,n){e.matches&&t.push(n)})),t}}]),t}()).\u0275fac=function(t){return new(t||tD)(te(xc),te(ac),te(nl))},tD.\u0275prov=mt({factory:function(){return new tD(te(xc),te(ac),te(nl))},token:tD,providedIn:"root"}),tD),oD={},aD={alias:"print",mediaQuery:"print",priority:1e3},sD=((nD=function(){function t(e,n,r){_classCallCheck(this,t),this.breakpoints=e,this.layoutConfig=n,this._document=r,this.registeredBeforeAfterPrintHooks=!1,this.isPrintingBeforeAfterEvent=!1,this.beforePrintEventListeners=[],this.afterPrintEventListeners=[],this.isPrinting=!1,this.queue=new uD,this.deactivations=[]}return _createClass(t,[{key:"withPrintQuery",value:function(t){return[].concat(_toConsumableArray(t),["print"])}},{key:"isPrintEvent",value:function(t){return t.mediaQuery.startsWith("print")}},{key:"getEventBreakpoints",value:function(t){var e=t.mediaQuery,n=this.breakpoints.findByQuery(e);return(n?[].concat(_toConsumableArray(this.printBreakPoints),[n]):this.printBreakPoints).sort(JN)}},{key:"updateEvent",value:function(t){var e=this.breakpoints.findByQuery(t.mediaQuery);return this.isPrintEvent(t)&&(e=this.getEventBreakpoints(t)[0],t.mediaQuery=e?e.mediaQuery:""),LN(t,e)}},{key:"registerBeforeAfterPrintHooks",value:function(t){var e=this;if(this._document.defaultView&&!this.registeredBeforeAfterPrintHooks){this.registeredBeforeAfterPrintHooks=!0;var n=function(){e.isPrinting||(e.isPrintingBeforeAfterEvent=!0,e.startPrinting(t,e.getEventBreakpoints(new ON(!0,"print"))),t.updateStyles())},r=function(){e.isPrintingBeforeAfterEvent=!1,e.isPrinting&&(e.stopPrinting(t),t.updateStyles())};this._document.defaultView.addEventListener("beforeprint",n),this._document.defaultView.addEventListener("afterprint",r),this.beforePrintEventListeners.push(n),this.afterPrintEventListeners.push(r)}}},{key:"interceptEvents",value:function(t){var e=this;return this.registerBeforeAfterPrintHooks(t),function(n){e.isPrintEvent(n)?n.matches&&!e.isPrinting?(e.startPrinting(t,e.getEventBreakpoints(n)),t.updateStyles()):n.matches||!e.isPrinting||e.isPrintingBeforeAfterEvent||(e.stopPrinting(t),t.updateStyles()):e.collectActivations(n)}}},{key:"blockPropagation",value:function(){var t=this;return function(e){return!(t.isPrinting||t.isPrintEvent(e))}}},{key:"startPrinting",value:function(t,e){this.isPrinting=!0,t.activatedBreakpoints=this.queue.addPrintBreakpoints(e)}},{key:"stopPrinting",value:function(t){t.activatedBreakpoints=this.deactivations,this.deactivations=[],this.queue.clear(),this.isPrinting=!1}},{key:"collectActivations",value:function(t){if(!this.isPrinting||this.isPrintingBeforeAfterEvent)if(t.matches)this.isPrintingBeforeAfterEvent||(this.deactivations=[]);else{var e=this.breakpoints.findByQuery(t.mediaQuery);e&&(this.deactivations.push(e),this.deactivations.sort(JN))}}},{key:"ngOnDestroy",value:function(){var t=this;this.beforePrintEventListeners.forEach((function(e){return t._document.defaultView.removeEventListener("beforeprint",e)})),this.afterPrintEventListeners.forEach((function(e){return t._document.defaultView.removeEventListener("afterprint",e)}))}},{key:"printAlias",get:function(){return this.layoutConfig.printWithBreakpoints||[]}},{key:"printBreakPoints",get:function(){var t=this;return this.printAlias.map((function(e){return t.breakpoints.findByAlias(e)})).filter((function(t){return null!==t}))}}]),t}()).\u0275fac=function(t){return new(t||nD)(te(rD),te(PN),te(nl))},nD.\u0275prov=mt({factory:function(){return new nD(te(rD),te(PN),te(nl))},token:nD,providedIn:"root"}),nD),uD=function(){function t(){_classCallCheck(this,t),this.printBreakpoints=[]}return _createClass(t,[{key:"addPrintBreakpoints",value:function(t){var e=this;return t.push(aD),t.sort(JN),t.forEach((function(t){return e.addBreakpoint(t)})),this.printBreakpoints}},{key:"addBreakpoint",value:function(t){t&&void 0===this.printBreakpoints.find((function(e){return e.mediaQuery===t.mediaQuery}))&&(this.printBreakpoints=function(t){return!!t&&t.mediaQuery.startsWith("print")}(t)?[t].concat(_toConsumableArray(this.printBreakpoints)):[].concat(_toConsumableArray(this.printBreakpoints),[t]))}},{key:"clear",value:function(){this.printBreakpoints=[]}}]),t}();function cD(t){for(var e in t){var n=t[e]||"";switch(e){case"display":t.display="flex"===n?["-webkit-flex","flex"]:"inline-flex"===n?["-webkit-inline-flex","inline-flex"]:n;break;case"align-items":case"align-self":case"align-content":case"flex":case"flex-basis":case"flex-flow":case"flex-grow":case"flex-shrink":case"flex-wrap":case"justify-content":t["-webkit-"+e]=n;break;case"flex-direction":n=n||"row",t["-webkit-flex-direction"]=n,t["flex-direction"]=n;break;case"order":t.order=t["-webkit-"+e]=isNaN(+n)?"0":n}}return t}var lD,hD,fD=((lD=function(){function t(e,n,r,i){_classCallCheck(this,t),this._serverStylesheet=e,this._serverModuleLoaded=n,this._platformId=r,this.layoutConfig=i}return _createClass(t,[{key:"applyStyleToElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={};"string"==typeof e&&(r[e]=n,e=r),r=this.layoutConfig.disableVendorPrefixes?e:cD(e),this._applyMultiValueStyleToElement(r,t)}},{key:"applyStyleToElements",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.layoutConfig.disableVendorPrefixes?t:cD(t);n.forEach((function(t){e._applyMultiValueStyleToElement(r,t)}))}},{key:"getFlowDirection",value:function(t){var e=this.lookupStyle(t,"flex-direction");return[e||"row",this.lookupInlineStyle(t,"flex-direction")||nh(this._platformId)&&this._serverModuleLoaded?e:""]}},{key:"hasWrap",value:function(t){return"wrap"===this.lookupStyle(t,"flex-wrap")}},{key:"lookupAttributeValue",value:function(t,e){return t.getAttribute(e)||""}},{key:"lookupInlineStyle",value:function(t,e){return eh(this._platformId)?t.style.getPropertyValue(e):this._getServerStyle(t,e)}},{key:"lookupStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";return t&&((r=this.lookupInlineStyle(t,e))||(eh(this._platformId)?n||(r=getComputedStyle(t).getPropertyValue(e)):this._serverModuleLoaded&&(r=this._serverStylesheet.getStyleForElement(t,e)))),r?r.trim():""}},{key:"_applyMultiValueStyleToElement",value:function(t,e){var n=this;Object.keys(t).sort().forEach((function(r){var i=t[r],o=Array.isArray(i)?i:[i];o.sort();var a,s=_createForOfIteratorHelper(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;u=u?u+"":"",eh(n._platformId)||!n._serverModuleLoaded?eh(n._platformId)?e.style.setProperty(r,u):n._setServerStyle(e,r,u):n._serverStylesheet.addStyleToElement(e,r,u)}}catch(c){s.e(c)}finally{s.f()}}))}},{key:"_setServerStyle",value:function(t,e,n){e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var r=this._readStyleAttribute(t);r[e]=n||"",this._writeStyleAttribute(t,r)}},{key:"_getServerStyle",value:function(t,e){return this._readStyleAttribute(t)[e]||""}},{key:"_readStyleAttribute",value:function(t){var e={},n=t.getAttribute("style");if(n)for(var r=n.split(/;+/g),i=0;i<r.length;i++){var o=r[i].trim();if(o.length>0){var a=o.indexOf(":");if(-1===a)throw new Error("Invalid CSS style: ".concat(o));e[o.substr(0,a).trim()]=o.substr(a+1).trim()}}return e}},{key:"_writeStyleAttribute",value:function(t,e){var n="";for(var r in e)e[r]&&(n+=r+":"+e[r]+";");t.setAttribute("style",n)}}]),t}()).\u0275fac=function(t){return new(t||lD)(te(NN),te(MN),te(ac),te(PN))},lD.\u0275prov=mt({factory:function(){return new lD(te(NN),te(MN),te(ac),te(PN))},token:lD,providedIn:"root"}),lD),dD=function(){function t(){_classCallCheck(this,t),this.shouldCache=!0}return _createClass(t,[{key:"sideEffect",value:function(t,e,n){}}]),t}(),pD=((hD=function(){function t(e,n,r){_classCallCheck(this,t),this.matchMedia=e,this.breakpoints=n,this.hook=r,this.activatedBreakpoints=[],this.elementMap=new Map,this.elementKeyMap=new WeakMap,this.watcherMap=new WeakMap,this.updateMap=new WeakMap,this.clearMap=new WeakMap,this.subject=new O,this.observeActivations()}return _createClass(t,[{key:"onMediaChange",value:function(t){var e=this.findByQuery(t.mediaQuery);e&&((t=LN(t,e)).matches&&-1===this.activatedBreakpoints.indexOf(e)?(this.activatedBreakpoints.push(e),this.activatedBreakpoints.sort(JN),this.updateStyles()):t.matches||-1===this.activatedBreakpoints.indexOf(e)||(this.activatedBreakpoints.splice(this.activatedBreakpoints.indexOf(e),1),this.activatedBreakpoints.sort(JN),this.updateStyles()))}},{key:"init",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];vD(this.updateMap,t,e,n),vD(this.clearMap,t,e,r),this.buildElementKeyMap(t,e),this.watchExtraTriggers(t,e,i)}},{key:"getValue",value:function(t,e,n){var r=this.elementMap.get(t);if(r){var i=void 0!==n?r.get(n):this.getActivatedValues(r,e);if(i)return i.get(e)}}},{key:"hasValue",value:function(t,e){var n=this.elementMap.get(t);if(n){var r=this.getActivatedValues(n,e);if(r)return void 0!==r.get(e)||!1}return!1}},{key:"setValue",value:function(t,e,n,r){var i=this.elementMap.get(t);if(i){var o=(i.get(r)||new Map).set(e,n);i.set(r,o),this.elementMap.set(t,i)}else i=(new Map).set(r,(new Map).set(e,n)),this.elementMap.set(t,i);var a=this.getValue(t,e);void 0!==a&&this.updateElement(t,e,a)}},{key:"trackValue",value:function(t,e){return this.subject.asObservable().pipe(sp((function(n){return n.element===t&&n.key===e})))}},{key:"updateStyles",value:function(){var t=this;this.elementMap.forEach((function(e,n){var r=new Set(t.elementKeyMap.get(n)),i=t.getActivatedValues(e);i&&i.forEach((function(e,i){t.updateElement(n,i,e),r.delete(i)})),r.forEach((function(r){if(i=t.getActivatedValues(e,r)){var o=i.get(r);t.updateElement(n,r,o)}else t.clearElement(n,r)}))}))}},{key:"clearElement",value:function(t,e){var n=this.clearMap.get(t);if(n){var r=n.get(e);r&&(r(),this.subject.next({element:t,key:e,value:""}))}}},{key:"updateElement",value:function(t,e,n){var r=this.updateMap.get(t);if(r){var i=r.get(e);i&&(i(n),this.subject.next({element:t,key:e,value:n}))}}},{key:"releaseElement",value:function(t){var e=this.watcherMap.get(t);e&&(e.forEach((function(t){return t.unsubscribe()})),this.watcherMap.delete(t));var n=this.elementMap.get(t);n&&(n.forEach((function(t,e){return n.delete(e)})),this.elementMap.delete(t))}},{key:"triggerUpdate",value:function(t,e){var n=this,r=this.elementMap.get(t);if(r){var i=this.getActivatedValues(r,e);i&&(e?this.updateElement(t,e,i.get(e)):i.forEach((function(e,r){return n.updateElement(t,r,e)})))}}},{key:"buildElementKeyMap",value:function(t,e){var n=this.elementKeyMap.get(t);n||(n=new Set,this.elementKeyMap.set(t,n)),n.add(e)}},{key:"watchExtraTriggers",value:function(t,e,n){var r=this;if(n&&n.length){var i=this.watcherMap.get(t);if(i||(i=new Map,this.watcherMap.set(t,i)),!i.get(e)){var o=J.apply(void 0,_toConsumableArray(n)).subscribe((function(){var n=r.getValue(t,e);r.updateElement(t,e,n)}));i.set(e,o)}}}},{key:"findByQuery",value:function(t){return this.breakpoints.findByQuery(t)}},{key:"getActivatedValues",value:function(t,e){for(var n=0;n<this.activatedBreakpoints.length;n++){var r=t.get(this.activatedBreakpoints[n].alias);if(r&&(void 0===e||r.has(e)&&null!=r.get(e)))return r}var i=t.get("");return void 0===e||i&&i.has(e)?i:void 0}},{key:"observeActivations",value:function(){var t=this.breakpoints.items.map((function(t){return t.mediaQuery}));this.matchMedia.observe(this.hook.withPrintQuery(t)).pipe(Up(this.hook.interceptEvents(this)),sp(this.hook.blockPropagation())).subscribe(this.onMediaChange.bind(this))}},{key:"activatedAlias",get:function(){return this.activatedBreakpoints[0]?this.activatedBreakpoints[0].alias:""}}]),t}()).\u0275fac=function(t){return new(t||hD)(te(iD),te(rD),te(sD))},hD.\u0275prov=mt({factory:function(){return new hD(te(iD),te(rD),te(sD))},token:hD,providedIn:"root"}),hD);function vD(t,e,n,r){if(void 0!==r){var i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n,r)}}var mD=["row","column","row-reverse","column-reverse"];function gD(t){var e=_slicedToArray((t=t?t.toLowerCase():"").split(" "),3),n=e[0],r=e[1],i=e[2];return mD.find((function(t){return t===n}))||(n=mD[0]),"inline"===r&&(r="inline"!==i?i:"",i="inline"),[n,bD(r),!!i]}function yD(t){return _slicedToArray(gD(t),1)[0].indexOf("row")>-1}function bD(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}var _D,wD,xD,CD,kD,ED,SD=((_D=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"buildStyles",value:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}((e=_slicedToArray(gD(t),3))[0],e[1],e[2]);var e}}]),n}(dD)).\u0275fac=function(t){return ID(t||_D)},_D.\u0275prov=mt({factory:function(){return new _D},token:_D,providedIn:"root"}),_D),ID=lr(SD),TD=["fxLayout","fxLayout.xs","fxLayout.sm","fxLayout.md","fxLayout.lg","fxLayout.xl","fxLayout.lt-sm","fxLayout.lt-md","fxLayout.lt-lg","fxLayout.lt-xl","fxLayout.gt-xs","fxLayout.gt-sm","fxLayout.gt-md","fxLayout.gt-lg"],AD=((xD=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,i,r,o)).DIRECTIVE_KEY="layout",a.styleCache=ND,a.init(),a}return n}(UN)).\u0275fac=function(t){return new(t||xD)(Ca(Us),Ca(fD),Ca(SD),Ca(pD))},xD.\u0275dir=Ee({type:xD,features:[ws]}),xD),RD=((wD=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments)).inputs=TD,t}return n}(AD)).\u0275fac=function(t){return OD(t||wD)},wD.\u0275dir=Ee({type:wD,selectors:[["","fxLayout",""],["","fxLayout.xs",""],["","fxLayout.sm",""],["","fxLayout.md",""],["","fxLayout.lg",""],["","fxLayout.xl",""],["","fxLayout.lt-sm",""],["","fxLayout.lt-md",""],["","fxLayout.lt-lg",""],["","fxLayout.lt-xl",""],["","fxLayout.gt-xs",""],["","fxLayout.gt-sm",""],["","fxLayout.gt-md",""],["","fxLayout.gt-lg",""]],inputs:{fxLayout:"fxLayout","fxLayout.xs":"fxLayout.xs","fxLayout.sm":"fxLayout.sm","fxLayout.md":"fxLayout.md","fxLayout.lg":"fxLayout.lg","fxLayout.xl":"fxLayout.xl","fxLayout.lt-sm":"fxLayout.lt-sm","fxLayout.lt-md":"fxLayout.lt-md","fxLayout.lt-lg":"fxLayout.lt-lg","fxLayout.lt-xl":"fxLayout.lt-xl","fxLayout.gt-xs":"fxLayout.gt-xs","fxLayout.gt-sm":"fxLayout.gt-sm","fxLayout.gt-md":"fxLayout.gt-md","fxLayout.gt-lg":"fxLayout.gt-lg"},features:[ws]}),wD),OD=lr(RD),ND=new Map,DD={"margin-left":null,"margin-right":null,"margin-top":null,"margin-bottom":null},PD=((CD=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._styler=t,r}return _createClass(n,[{key:"buildStyles",value:function(t,e){return t.endsWith(WD)?(n=t=t.slice(0,t.indexOf(WD)),r=e.directionality,i=_slicedToArray(n.split(" "),2),o=i[0],s="0px",u=(a=function(t){return"-".concat(t)})(i[1]||o),c="0px","rtl"===r?c=a(o):s=a(o),{margin:"0px ".concat(s," ").concat(u," ").concat(c)}):{};var n,r,i,o,a,s,u,c}},{key:"sideEffect",value:function(t,e,n){var r,i,o,a,s,u,c,l=n.items;if(t.endsWith(WD)){var h=(r=t=t.slice(0,t.indexOf(WD)),i=n.directionality,o=_slicedToArray(r.split(" "),2),a=o[0],s=o[1],u="0px",c="0px","rtl"===i?c=a:u=a,{padding:"0px ".concat(u," ").concat(s||a," ").concat(c)});this._styler.applyStyleToElements(h,n.items)}else{var f=l.pop(),d=function(t,e){var n=qD(e.directionality,e.layout),r=Object.assign({},DD);return r[n]=t,r}(t,n);this._styler.applyStyleToElements(d,l),this._styler.applyStyleToElements(DD,[f])}}}]),n}(dD)).\u0275fac=function(t){return new(t||CD)(te(fD))},CD.\u0275prov=mt({factory:function(){return new CD(te(fD))},token:CD,providedIn:"root"}),CD),MD=["fxLayoutGap","fxLayoutGap.xs","fxLayoutGap.sm","fxLayoutGap.md","fxLayoutGap.lg","fxLayoutGap.xl","fxLayoutGap.lt-sm","fxLayoutGap.lt-md","fxLayoutGap.lt-lg","fxLayoutGap.lt-xl","fxLayoutGap.gt-xs","fxLayoutGap.gt-sm","fxLayoutGap.gt-md","fxLayoutGap.gt-lg"],FD=((ED=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o,a,s){var u;_classCallCheck(this,n),(u=e.call(this,t,a,o,s)).zone=r,u.directionality=i,u.styleUtils=o,u.layout="row",u.DIRECTIVE_KEY="layout-gap",u.observerSubject=new O;var c=[u.directionality.change,u.observerSubject.asObservable()];return u.init(c),u.marshal.trackValue(u.nativeElement,"layout").pipe(OC(u.destroySubject)).subscribe(u.onLayoutChange.bind(_assertThisInitialized(u))),u}return _createClass(n,[{key:"ngAfterContentInit",value:function(){this.buildChildObservable(),this.triggerUpdate()}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this),this.observer&&this.observer.disconnect()}},{key:"onLayoutChange",value:function(t){var e=this,n=t.value.split(" ");this.layout=n[0],mD.find((function(t){return t===e.layout}))||(this.layout="row"),this.triggerUpdate()}},{key:"updateWithValue",value:function(t){var e=this,n=this.childrenNodes.filter((function(t){return 1===t.nodeType&&e.willDisplay(t)})).sort((function(t,n){var r=+e.styler.lookupStyle(t,"order"),i=+e.styler.lookupStyle(n,"order");return isNaN(r)||isNaN(i)||r===i?0:r>i?1:-1}));if(n.length>0){var r=this.directionality.value,i=this.layout;"row"===i&&"rtl"===r?this.styleCache=jD:"row"===i&&"rtl"!==r?this.styleCache=UD:"column"===i&&"rtl"===r?this.styleCache=VD:"column"===i&&"rtl"!==r&&(this.styleCache=zD),this.addStyles(t,{directionality:r,items:n,layout:i})}}},{key:"clearStyles",value:function(){var t=Object.keys(this.mru).length>0,e=t?"padding":qD(this.directionality.value,this.layout);t&&_get(_getPrototypeOf(n.prototype),"clearStyles",this).call(this),this.styleUtils.applyStyleToElements(_defineProperty({},e,""),this.childrenNodes)}},{key:"willDisplay",value:function(t){var e=this.marshal.getValue(t,"show-hide");return!0===e||void 0===e&&"none"!==this.styleUtils.lookupStyle(t,"display")}},{key:"buildChildObservable",value:function(){var t=this;this.zone.runOutsideAngular((function(){"undefined"!=typeof MutationObserver&&(t.observer=new MutationObserver((function(e){e.some((function(t){return t.addedNodes&&t.addedNodes.length>0||t.removedNodes&&t.removedNodes.length>0}))&&t.observerSubject.next()})),t.observer.observe(t.nativeElement,{childList:!0}))}))}},{key:"childrenNodes",get:function(){for(var t=this.nativeElement.children,e=[],n=t.length;n--;)e[n]=t[n];return e}}]),n}(UN)).\u0275fac=function(t){return new(t||ED)(Ca(Us),Ca(xc),Ca(Sw),Ca(fD),Ca(PD),Ca(pD))},ED.\u0275dir=Ee({type:ED,features:[ws]}),ED),LD=((kD=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments)).inputs=MD,t}return n}(FD)).\u0275fac=function(t){return BD(t||kD)},kD.\u0275dir=Ee({type:kD,selectors:[["","fxLayoutGap",""],["","fxLayoutGap.xs",""],["","fxLayoutGap.sm",""],["","fxLayoutGap.md",""],["","fxLayoutGap.lg",""],["","fxLayoutGap.xl",""],["","fxLayoutGap.lt-sm",""],["","fxLayoutGap.lt-md",""],["","fxLayoutGap.lt-lg",""],["","fxLayoutGap.lt-xl",""],["","fxLayoutGap.gt-xs",""],["","fxLayoutGap.gt-sm",""],["","fxLayoutGap.gt-md",""],["","fxLayoutGap.gt-lg",""]],inputs:{fxLayoutGap:"fxLayoutGap","fxLayoutGap.xs":"fxLayoutGap.xs","fxLayoutGap.sm":"fxLayoutGap.sm","fxLayoutGap.md":"fxLayoutGap.md","fxLayoutGap.lg":"fxLayoutGap.lg","fxLayoutGap.xl":"fxLayoutGap.xl","fxLayoutGap.lt-sm":"fxLayoutGap.lt-sm","fxLayoutGap.lt-md":"fxLayoutGap.lt-md","fxLayoutGap.lt-lg":"fxLayoutGap.lt-lg","fxLayoutGap.lt-xl":"fxLayoutGap.lt-xl","fxLayoutGap.gt-xs":"fxLayoutGap.gt-xs","fxLayoutGap.gt-sm":"fxLayoutGap.gt-sm","fxLayoutGap.gt-md":"fxLayoutGap.gt-md","fxLayoutGap.gt-lg":"fxLayoutGap.gt-lg"},features:[ws]}),kD),BD=lr(LD),jD=new Map,VD=new Map,UD=new Map,zD=new Map,WD=" grid";function qD(t,e){switch(e){case"column":return"margin-bottom";case"column-reverse":return"margin-top";case"row":return"rtl"===t?"margin-left":"margin-right";case"row-reverse":return"rtl"===t?"margin-right":"margin-left";default:return"rtl"===t?"margin-left":"margin-right"}}var HD,GD,KD,XD,$D,YD,QD,JD,ZD,tP,eP,nP={margin:0,width:"100%",height:"100%","min-width":"100%","min-height":"100%"},rP=((HD=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"buildStyles",value:function(t){return nP}}]),n}(dD)).\u0275fac=function(t){return iP(t||HD)},HD.\u0275prov=mt({factory:function(){return new HD},token:HD,providedIn:"root"}),HD),iP=lr(rP),oP=((GD=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,i,r,o)).styleCache=aP,a.addStyles(""),a}return n}(UN)).\u0275fac=function(t){return new(t||GD)(Ca(Us),Ca(fD),Ca(rP),Ca(pD))},GD.\u0275dir=Ee({type:GD,selectors:[["","fxFill",""],["","fxFlexFill",""]],features:[ws]}),GD),aP=new Map,sP=((KD=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"buildStyles",value:function(t,e){var n={},r=_slicedToArray(t.split(" "),2),i=r[0],o=r[1];switch(i){case"center":n["justify-content"]="center";break;case"space-around":n["justify-content"]="space-around";break;case"space-between":n["justify-content"]="space-between";break;case"space-evenly":n["justify-content"]="space-evenly";break;case"end":case"flex-end":n["justify-content"]="flex-end";break;case"start":case"flex-start":default:n["justify-content"]="flex-start"}switch(o){case"start":case"flex-start":n["align-items"]=n["align-content"]="flex-start";break;case"center":n["align-items"]=n["align-content"]="center";break;case"end":case"flex-end":n["align-items"]=n["align-content"]="flex-end";break;case"space-between":n["align-content"]="space-between",n["align-items"]="stretch";break;case"space-around":n["align-content"]="space-around",n["align-items"]="stretch";break;case"baseline":n["align-content"]="stretch",n["align-items"]="baseline";break;case"stretch":default:n["align-items"]=n["align-content"]="stretch"}return function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(null!=a)for(var s in a)a.hasOwnProperty(s)&&(t[s]=a[s])}return t}(n,{display:e.inline?"inline-flex":"flex","flex-direction":e.layout,"box-sizing":"border-box","max-width":"stretch"===o?yD(e.layout)?null:"100%":null,"max-height":"stretch"===o&&yD(e.layout)?"100%":null})}}]),n}(dD)).\u0275fac=function(t){return uP(t||KD)},KD.\u0275prov=mt({factory:function(){return new KD},token:KD,providedIn:"root"}),KD),uP=lr(sP),cP=["fxLayoutAlign","fxLayoutAlign.xs","fxLayoutAlign.sm","fxLayoutAlign.md","fxLayoutAlign.lg","fxLayoutAlign.xl","fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg"],lP=(($D=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,o){var a;return _classCallCheck(this,n),(a=e.call(this,t,i,r,o)).DIRECTIVE_KEY="layout-align",a.layout="row",a.inline=!1,a.init(),a.marshal.trackValue(a.nativeElement,"layout").pipe(OC(a.destroySubject)).subscribe(a.onLayoutChange.bind(_assertThisInitialized(a))),a}return _createClass(n,[{key:"updateWithValue",value:function(t){var e=this.layout||"row",n=this.inline;"row"===e&&n?this.styleCache=gP:"row"!==e||n?"row-reverse"===e&&n?this.styleCache=bP:"row-reverse"!==e||n?"column"===e&&n?this.styleCache=yP:"column"!==e||n?"column-reverse"===e&&n?this.styleCache=_P:"column-reverse"!==e||n||(this.styleCache=mP):this.styleCache=pP:this.styleCache=vP:this.styleCache=dP,this.addStyles(t,{layout:e,inline:n})}},{key:"onLayoutChange",value:function(t){var e=this,n=t.value.split(" ");this.layout=n[0],this.inline=t.value.includes("inline"),mD.find((function(t){return t===e.layout}))||(this.layout="row"),this.triggerUpdate()}}]),n}(UN)).\u0275fac=function(t){return new(t||$D)(Ca(Us),Ca(fD),Ca(sP),Ca(pD))},$D.\u0275dir=Ee({type:$D,features:[ws]}),$D),hP=((XD=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments)).inputs=cP,t}return n}(lP)).\u0275fac=function(t){return fP(t||XD)},XD.\u0275dir=Ee({type:XD,selectors:[["","fxLayoutAlign",""],["","fxLayoutAlign.xs",""],["","fxLayoutAlign.sm",""],["","fxLayoutAlign.md",""],["","fxLayoutAlign.lg",""],["","fxLayoutAlign.xl",""],["","fxLayoutAlign.lt-sm",""],["","fxLayoutAlign.lt-md",""],["","fxLayoutAlign.lt-lg",""],["","fxLayoutAlign.lt-xl",""],["","fxLayoutAlign.gt-xs",""],["","fxLayoutAlign.gt-sm",""],["","fxLayoutAlign.gt-md",""],["","fxLayoutAlign.gt-lg",""]],inputs:{fxLayoutAlign:"fxLayoutAlign","fxLayoutAlign.xs":"fxLayoutAlign.xs","fxLayoutAlign.sm":"fxLayoutAlign.sm","fxLayoutAlign.md":"fxLayoutAlign.md","fxLayoutAlign.lg":"fxLayoutAlign.lg","fxLayoutAlign.xl":"fxLayoutAlign.xl","fxLayoutAlign.lt-sm":"fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md":"fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg":"fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl":"fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs":"fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm":"fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md":"fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg":"fxLayoutAlign.gt-lg"},features:[ws]}),XD),fP=lr(hP),dP=new Map,pP=new Map,vP=new Map,mP=new Map,gP=new Map,yP=new Map,bP=new Map,_P=new Map,wP=((ZD=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:ZD}),ZD.\u0275inj=gt({factory:function(t){return new(t||ZD)},imports:[[RN,Iw]]}),ZD),xP=((JD=function(){function t(e){_classCallCheck(this,t),this.router=e,this.fondo="white",this.isThemeDark=!1,this.themes=["deeppurple-amber","indigo-pink","pink-bluegrey","purple-green"]}return _createClass(t,[{key:"irAPersonalizar",value:function(){this.router.navigate(["main/personalizar-usuario"])}},{key:"sombra",value:function(){return JSON.parse(localStorage.getItem("colorFondo"))?"3px 0 6px rgba(255, 255, 255, 0.658)":JSON.parse(localStorage.getItem("colorFondo"))?void 0:"3px 0 6px rgba(0, 0, 0, 0.658)"}},{key:"irAEquipos",value:function(){this.router.navigate(["main/equipos-tabla"])}},{key:"irASancionados",value:function(){this.router.navigate(["main/sancionados-tabla"])}},{key:"comprobarSancionados",value:function(){this.router.navigate(["main/comprobar-sancionados"])}},{key:"toHome",value:function(){this.router.navigate(["main/home"])}},{key:"logOut",value:function(){localStorage.setItem("Logueado","false"),this.router.navigate(["login"])}},{key:"colores",value:function(){return JSON.parse(localStorage.getItem("colorFondo"))?JSON.parse(localStorage.getItem("colorFondo"))?"#fafafa":void 0:"#303030"}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||JD)(Ca(fg))},JD.\u0275cmp=be({type:JD,selectors:[["app-main-nav"]],hostVars:2,hostBindings:function(t,e){2&t&&os(he,rs,e.activeThemeCssClass,!0)},decls:44,vars:6,consts:[[1,"body"],[3,"clickOutside"],["color","primary",1,"mat-elevation-z8",".mat-toolbar-single-row"],[1,"boton-menu"],["type","button","mat-button","",3,"click"],[1,"titulo-principal"],[1,"espacioncentral"],["mat-button","",3,"click"],["color","primary","autosize","",1,"ventana"],["fixedInViewport","true",1,".mat-drawer",3,"mode"],["drawer",""],["mat-label","","fxLayout","row",1,"boton2",3,"click"],[1,"icono"]],template:function(t,e){if(1&t){var n=Pa();Ta(0,"body",0),Ta(1,"div",1),La("clickOutside",(function(){return tn(n),xa(19).close()})),Ta(2,"mat-toolbar",2),Ta(3,"span"),Ta(4,"div",3),Ta(5,"button",4),La("click",(function(){return tn(n),xa(19).toggle()})),Ta(6,"mat-icon"),ps(7,"menu"),Aa(),Aa(),Aa(),Aa(),Ta(8,"span",5),ps(9," LIGA DE FUTBOL "),Aa(),Ra(10,"span",6),Ta(11,"button",7),La("click",(function(){return e.toHome()})),Ta(12,"mat-icon"),ps(13,"home"),Aa(),Aa(),Ta(14,"button",7),La("click",(function(){return e.logOut()})),Ta(15,"mat-icon"),ps(16,"cancel"),Aa(),Aa(),Aa(),Ta(17,"mat-drawer-container",8),Ta(18,"mat-drawer",9,10),Ru(20,"async"),Ru(21,"async"),Ta(22,"a",11),La("click",(function(){return tn(n),xa(19).toggle()}))("click",(function(){return e.irAEquipos()})),Ta(23,"div",12),Ta(24,"mat-icon"),ps(25,"tour "),Aa(),ps(26," \xa0 "),Aa(),Ta(27,"div"),ps(28," Equipos "),Aa(),Aa(),Ta(29,"a",11),La("click",(function(){return tn(n),xa(19).toggle()}))("click",(function(){return e.irASancionados()})),Ta(30,"div",12),Ta(31,"mat-icon"),ps(32,"account_circle "),Aa(),ps(33," \xa0 "),Aa(),Ta(34,"div"),ps(35," Jugadores sancionados "),Aa(),Aa(),Ta(36,"a",11),La("click",(function(){return tn(n),xa(19).toggle()}))("click",(function(){return e.comprobarSancionados()})),Ta(37,"div",12),Ta(38,"mat-icon"),ps(39,"verified_user "),Aa(),ps(40," \xa0 "),Aa(),Ta(41,"div"),ps(42," Comprobar sancionados "),Aa(),Aa(),Aa(),Aa(),Aa(),Ra(43,"router-outlet"),Aa()}2&t&&(di(18),Sa("mode",Ou(21,4,e.isHandset$)?"over":"side"),ba("role",Ou(20,2,e.isHandset$)?"dialog":"navigation"))},directives:[IA,hC,eT,GA,HA,RD,vg],pipes:[Zl],styles:[".titulo-principal[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}.body[_ngcontent-%COMP%]{overflow-y:scroll}.boton-menu[_ngcontent-%COMP%]{margin-left:-10%}.mat-toolbar-single-row[_ngcontent-%COMP%]{position:fixed;z-index:10}.icono[_ngcontent-%COMP%]{margin-top:-4px}.espacioncentral[_ngcontent-%COMP%]{flex:1 1 auto}.mat-drawer[_ngcontent-%COMP%]{box-shadow:3px 0 6px rgba(0,0,0,.287);position:fixed;top:64px;padding:10px 8px 0}.formatos[_ngcontent-%COMP%]{text-align:center}.letras[_ngcontent-%COMP%]{font-size:12px}.theme-selectors-container[_ngcontent-%COMP%]{width:190px;margin:0 8px}.subti[_ngcontent-%COMP%]{margin-left:5%}.paletaColores[_ngcontent-%COMP%]{margin-left:10px}.center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}@media screen and (max-width:599px){.mat-drawer[_ngcontent-%COMP%]{box-shadow:3px 0 6px hsla(0,0%,100%,.19);position:fixed;top:56px}}.desplegable[_ngcontent-%COMP%]{max-height:400px}.titulo[_ngcontent-%COMP%]{font-weight:800;font-family:Open Sans;font-size:15px}.boton2[_ngcontent-%COMP%]{text-align:start;width:100%;cursor:pointer;margin:8px 0;padding:10px 8px 4px}.boton2[_ngcontent-%COMP%]:hover{background:#cfcfcf}.boton3[_ngcontent-%COMP%]{text-align:start;margin-left:15px;margin-right:15px;width:100%;cursor:pointer}.ventana[_ngcontent-%COMP%]{z-index:10}"]}),JD),CP=((QD=function(){function t(e){_classCallCheck(this,t),this.router=e}return _createClass(t,[{key:"irAEquipos",value:function(){this.router.navigate(["main/equipos-tabla"])}},{key:"irASancionados",value:function(){this.router.navigate(["main/sancionados-tabla"])}},{key:"comprobarSancionados",value:function(){this.router.navigate(["main/comprobar-sancionados"])}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||QD)(Ca(fg))},QD.\u0275cmp=be({type:QD,selectors:[["app-home"]],decls:35,vars:0,consts:[[1,"contenido"],[1,"number2"],["fxLayout","row wrap","fxLayout.lt-sm","column","fxLayoutGap","26px","fxLayoutAlign","flex-start"],[1,"info-box2","hover-expand-effect2",3,"click"],[1,"icon2","bg-light-blue2"],[1,"material-icons"],["fxLayout","column","fxLayoutGap","10px",1,"content2"],[1,"text2"]],template:function(t,e){1&t&&(Ta(0,"div",0),Ta(1,"div"),Ta(2,"div"),Ta(3,"h3",1),ps(4,"BIENVENIDO"),Aa(),Ra(5,"mat-divider"),Aa(),Ra(6,"br"),Ta(7,"div",2),Ta(8,"div",3),La("click",(function(){return e.irAEquipos()})),Ta(9,"div",4),Ta(10,"i",5),ps(11,"tour"),Aa(),Aa(),Ta(12,"div",6),Ta(13,"div",7),ps(14,"Administrar"),Aa(),Ta(15,"div",1),ps(16,"Equipos"),Aa(),Aa(),Aa(),Ta(17,"div",3),La("click",(function(){return e.irASancionados()})),Ta(18,"div",4),Ta(19,"i",5),ps(20,"account_circle"),Aa(),Aa(),Ta(21,"div",6),Ta(22,"div",7),ps(23,"Lista de"),Aa(),Ta(24,"div",1),ps(25,"Sancionados"),Aa(),Aa(),Aa(),Ta(26,"div",3),La("click",(function(){return e.comprobarSancionados()})),Ta(27,"div",4),Ta(28,"i",5),ps(29,"verified_user"),Aa(),Aa(),Ta(30,"div",6),Ta(31,"div",7),ps(32,"Comprobar"),Aa(),Ta(33,"div",1),ps(34,"Sancionados"),Aa(),Aa(),Aa(),Aa(),Aa(),Aa())},directives:[gN,RD,LD,hP],styles:['.carta[_ngcontent-%COMP%]{margin-left:36%;margin-right:20%;margin-top:-15%;text-align:center}.tituloCabecera[_ngcontent-%COMP%]{margin-top:15px}.number[_ngcontent-%COMP%]{color:#fff}.number2[_ngcontent-%COMP%]{color:#000}.texto[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-weight:100;color:#fff}.contenido[_ngcontent-%COMP%]{padding-top:7%;margin-left:2%}.iconos[_ngcontent-%COMP%]{background-color:#fff}.iconos[_ngcontent-%COMP%], .info-box2[_ngcontent-%COMP%]{height:80px;display:flex;cursor:pointer;position:relative;overflow:hidden;margin-bottom:30px}.info-box2[_ngcontent-%COMP%]{box-shadow:0 2px 10px rgba(0,0,0,.541);background-color:#cfcfcf;width:285px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]{display:inline-block;text-align:center;background-color:hsla(0,0%,100%,.12);width:80px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000;font-size:50px;line-height:80px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-bar2[_ngcontent-%COMP%]{height:100%;line-height:100px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-bar2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-pie2[_ngcontent-%COMP%]{height:100%;line-height:123px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-pie2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]{height:100%;line-height:115px}.info-box2[_ngcontent-%COMP%]   .icon2[_ngcontent-%COMP%]   .chart.chart-line2[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]{display:inline-block;padding:7px 10px}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]   .text2[_ngcontent-%COMP%]{font-size:13px;margin-top:6px;color:#505050}.info-box2[_ngcontent-%COMP%]   .content2[_ngcontent-%COMP%]   .number2[_ngcontent-%COMP%]{font-weight:400;font-size:26px;margin-top:1px;color:#000}.bg-light-blue2[_ngcontent-%COMP%]{color:red}.info-box2.hover-expand-effect2[_ngcontent-%COMP%]:after{background-color:rgba(0,0,0,.192);content:".";position:absolute;top:0;width:0;height:100%;color:transparent;transition:all .95s}.info-box2.hover-expand-effect2[_ngcontent-%COMP%]:hover:after{width:100%}.card2[_ngcontent-%COMP%]{background:#cecece;min-height:50px;margin-right:1.5%;box-shadow:0 2px 10px rgba(0,0,0,.507);position:relative;margin-bottom:30px;border-radius:2px}.card2[_ngcontent-%COMP%]   .header2[_ngcontent-%COMP%]{color:#dfdfdf;padding:5px;height:115px;margin-left:12px;position:relative;border-bottom:1px solid hsla(0,0%,80%,.35)}.info-box[_ngcontent-%COMP%]{box-shadow:0 2px 10px hsla(0,0%,100%,.219);height:80px;display:flex;cursor:pointer;background-color:#424242;width:285px;position:relative;overflow:hidden;margin-bottom:30px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:inline-block;text-align:center;background-color:rgba(0,0,0,.12);width:80px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:50px;line-height:80px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-bar[_ngcontent-%COMP%]{height:100%;line-height:100px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-bar[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-pie[_ngcontent-%COMP%]{height:100%;line-height:123px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-pie[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]{height:100%;line-height:115px}.info-box[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .chart.chart-line[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{vertical-align:baseline!important}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:inline-block;padding:7px 10px}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:13px;margin-top:6px;color:#969696}.info-box[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{font-weight:400;font-size:26px;margin-top:1px;color:#fff}.bg-light-blue[_ngcontent-%COMP%]{color:#fff}.info-box.hover-expand-effect[_ngcontent-%COMP%]:after{background-color:hsla(0,0%,100%,.192);content:".";position:absolute;top:0;width:0;height:100%;color:transparent;transition:all .95s}.info-box.hover-expand-effect[_ngcontent-%COMP%]:hover:after{width:100%}.card[_ngcontent-%COMP%]{background:#424242;min-height:50px;margin-right:1.5%;box-shadow:0 2px 10px hsla(0,0%,100%,.2);position:relative;margin-bottom:30px;border-radius:2px}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:#dfdfdf;padding:5px;height:115px;margin-left:12px;position:relative;border-bottom:1px solid hsla(0,0%,80%,.35)}']}),QD),kP=((YD=function(){function t(e){_classCallCheck(this,t),this.router=e}return _createClass(t,[{key:"canActivate",value:function(t,e){return"true"===localStorage.getItem("Logueado")||this.router.parseUrl("/login")}}]),t}()).\u0275fac=function(t){return new(t||YD)(te(fg))},YD.\u0275prov=mt({token:YD,factory:YD.\u0275fac,providedIn:"root"}),YD),EP=n("mrSG"),SP=((eP=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||eP)},eP.\u0275cmp=be({type:eP,selectors:[["app-login-incorrecto"]],decls:5,vars:0,consts:[["mat-label","",1,"md-body-2"],[1,"error"]],template:function(t,e){1&t&&(Ta(0,"span",0),ps(1," Datos incorrectos "),Aa(),Ta(2,"span",1),Ta(3,"mat-icon"),ps(4,"block"),Aa(),Aa())},directives:[eT],styles:[".md-body-2[_ngcontent-%COMP%]{color:#fff;vertical-align:5px;text-align:center;font-family:Arial,Helvetica,sans-serif}.error[_ngcontent-%COMP%]{text-align:right;margin-left:50%;vertical-align:-1.5px;vertical-align:center;color:red}"]}),eP),IP=((tP=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"login",value:function(t,e){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});case 2:return r=n.sent,n.next=5,r.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))}}]),t}()).\u0275fac=function(t){return new(t||tP)},tP.\u0275prov=mt({token:tP,factory:tP.\u0275fac,providedIn:"root"}),tP);function TP(t,e){1&t&&Ra(0,"mat-spinner",13)}var AP,RP,OP,NP,DP=((NP=function(){function t(e,n,r){_classCallCheck(this,t),this.usuarioService=e,this.router=n,this.snackBar=r,this.spinner=!1,this.logueado=!1,this.listaPermisos=[]}return _createClass(t,[{key:"entrar",value:function(t,e){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,!0;case 2:return this.spinner=n.sent,n.next=5,this.usuarioService.login(t,e);case 5:1===n.sent.split(" ").length?(this.router.navigate(["main/home"]),this.logueado=!0,localStorage.setItem("Logueado","true"),localStorage.setItem("usuarioRegistrado",JSON.stringify(t))):this.openSnackBarErrorLogin(),this.spinner=!1;case 8:case"end":return n.stop()}}),n,this)})))}},{key:"openSnackBarErrorLogin",value:function(){this.snackBar.openFromComponent(SP,{duration:3e3})}},{key:"getUserLoggedIn",value:function(){return JSON.parse(localStorage.getItem("usuarioRegistrado"))}},{key:"verificarSesionAbierta",value:function(){localStorage.getItem("Logueado")&&this.router.navigate(["main/home"])}},{key:"ngOnInit",value:function(){this.verificarSesionAbierta()}}]),t}()).\u0275fac=function(t){return new(t||NP)(Ca(IP),Ca(fg),Ca(pN))},NP.\u0275cmp=be({type:NP,selectors:[["app-login"]],decls:22,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center","fxFill",""],[1,"carta"],[1,"tipografia"],[1,"row"],[1,"col-md-4","text-center"],[1,"forma"],[1,"example-full-width"],["matInput","","type","text","placeholder","Email","required","","autofocus","",1,"caja-texto",3,"keyup.enter"],["userEmail",""],["matInput","","type","password","placeholder","Password","required","",1,"form-control","mb-2",3,"keyup.enter"],["userPassword",""],["diameter","35","class","spin",3,"display",4,"ngIf"],["mat-raised-button","","fxLayoutAlign","center center","color","primary",1,"tipografia",3,"click"],["diameter","35",1,"spin",3,"display"]],template:function(t,e){if(1&t){var n=Pa();Ta(0,"div",0),Ta(1,"div"),Ta(2,"div"),Ta(3,"mat-card",1),Ra(4,"p"),Ta(5,"mat-label",2),ps(6,"Ingreso"),Aa(),Ra(7,"p"),Ta(8,"div",3),Ra(9,"div",4),Ta(10,"div"),Ta(11,"div",5),Ta(12,"mat-form-field",6),Ta(13,"input",7,8),La("keyup.enter",(function(){tn(n);var t=xa(14),r=xa(17);return e.entrar(t.value,r.value)})),Aa(),Aa(),Ta(15,"mat-form-field",6),Ta(16,"input",9,10),La("keyup.enter",(function(){tn(n);var t=xa(14),r=xa(17);return e.entrar(t.value,r.value)})),Aa(),Aa(),Aa(),Ra(18,"p"),wa(19,TP,1,0,"mat-spinner",11),Ta(20,"button",12),La("click",(function(){tn(n);var t=xa(14),r=xa(17);return e.entrar(t.value,r.value)})),ps(21,"Entrar"),Aa(),Aa(),Aa(),Aa(),Aa(),Aa(),Aa()}2&t&&(di(19),Sa("ngIf",e.spinner))},directives:[RD,hP,oP,YA,NE,VE,vA,Ll,hC,uR],styles:[".tipografia[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin-left:36%}.forma[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%;text-align:center;align-content:center}.container[_ngcontent-%COMP%]{align-items:center;text-align:center;width:60%;height:90%;margin-left:35%;position:absolute;display:flex}.example-full-width[_ngcontent-%COMP%]{width:100%}.carta[_ngcontent-%COMP%]{box-shadow:6px 13px 75px 3px rgba(0,0,0,.19)}.spin[_ngcontent-%COMP%]{margin-left:80%;position:absolute}"]}),NP),PP=((OP=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||OP)},OP.\u0275cmp=be({type:OP,selectors:[["app-confirmar-eliminar"]],decls:8,vars:2,consts:[[1,"mat-typography"],["mat-dialog-title",""],["fxLayoutAlign","center center","fxFill","",1,"botones"],["mat-raised-button","","color","primary",3,"mat-dialog-close"],["mat-raised-button","","color","warn",3,"mat-dialog-close"]],template:function(t,e){1&t&&(Ta(0,"section",0),Ta(1,"h1",1),ps(2,"\xbfEsta seguro que desea eliminarlo?"),Aa(),Ta(3,"mat-dialog-actions",2),Ta(4,"button",3),ps(5,"Si"),Aa(),Ta(6,"button",4),ps(7,"No"),Aa(),Aa(),Aa()),2&t&&(di(4),Sa("mat-dialog-close",!0),di(2),Sa("mat-dialog-close",!1))},directives:[HT,GT,hP,oP,hC,qT],styles:[""]}),OP),MP=((RP=function(){function t(e){_classCallCheck(this,t),this.http=e}return _createClass(t,[{key:"getConfiguration",value:function(){return t.config}}]),t}()).\u0275fac=function(t){return new(t||RP)(te(_I))},RP.\u0275prov=mt({token:RP,factory:RP.\u0275fac,providedIn:"root"}),RP),FP=((AP=function(){function t(e,n){_classCallCheck(this,t),this.confService=e,this.http=n,this.httpHeaders=new QS({"Content-Type":"application/json",Authorization:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjExLCJ1c2VyRW1haWwiOiJzYW50aWRhbG1hc3NvakBnbWFpbC5jb20iLCJpYXQiOjE2MDI2ODQwMTksImV4cCI6MTYwMjY4NzYxOX0.YJOCbcipmYnO2hxW2BRm91yjhe9a92q9BBGLvS4nau4"})}return _createClass(t,[{key:"get",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return e=t.sent,t.next=5,e.json();case 5:return n=t.sent,r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"GET",headers:{Authorization:n,"Access-Control-Allow-Origin":"*"}}),t.next=9,r;case 9:return t.next=11,t.sent.json();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})))}},{key:"nuevo",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"POST",headers:{"Content-Type":"application/json",Authorization:r,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({name:t})}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}},{key:"editar",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:r,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({id:t.id,name:t.name})}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}},{key:"eliminar",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams/"+t,{method:"DELETE",headers:{Authorization:r,"Access-Control-Allow-Origin":"*"}}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}}]),t}()).\u0275fac=function(t){return new(t||AP)(te(MP),te(_I))},AP.\u0275prov=mt({token:AP,factory:AP.\u0275fac,providedIn:"root"}),AP);function LP(t,e){1&t&&(Ta(0,"div",2),Ra(1,"mat-spinner"),Aa())}function BP(t,e){1&t&&(Ta(0,"th",21),ps(1," Nombre "),Aa())}function jP(t,e){if(1&t&&(Ta(0,"td",22),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.name," ")}}function VP(t,e){1&t&&(Ta(0,"th",23),ps(1,"Acciones"),Aa())}function UP(t,e){if(1&t){var n=Pa();Ta(0,"td",24),Ta(1,"button",25),La("click",(function(){tn(n);var t=e.$implicit;return za(2).verJugadores(t)})),Ta(2,"mat-icon"),ps(3," accessibility "),Aa(),Aa(),Ta(4,"button",26),La("click",(function(){tn(n);var t=e.$implicit;return za(2).editar(t)})),Ta(5,"mat-icon"),ps(6,"create"),Aa(),Aa(),Ta(7,"button",27),La("click",(function(){tn(n);var t=e.$implicit;return za(2).eliminar(t)})),Ta(8,"mat-icon"),ps(9,"delete_forever"),Aa(),Aa(),Aa()}}function zP(t,e){1&t&&Ra(0,"tr",28)}function WP(t,e){1&t&&Ra(0,"tr",29)}var qP=function(){return[10,20,50]};function HP(t,e){if(1&t){var n=Pa();Ta(0,"div",3),Ra(1,"br"),Ta(2,"div",4),Ta(3,"h2"),ps(4,"Equipos"),Aa(),Aa(),Ta(5,"mat-grid-list",5),Ta(6,"mat-grid-tile"),Ta(7,"mat-form-field"),Ta(8,"mat-label"),ps(9,"Filtro"),Aa(),Ta(10,"input",6),La("keyup",(function(t){return tn(n),za().applyFilter(t)})),Aa(),Aa(),Aa(),Ta(11,"mat-grid-tile"),Ta(12,"button",7),La("click",(function(){return tn(n),za().nuevo()})),ps(13," Agregar nuevo equipo "),Aa(),Aa(),Aa(),Ta(14,"div",8),Ta(15,"table",9,10),Oa(17,11),wa(18,BP,2,0,"th",12),wa(19,jP,2,1,"td",13),Na(),Oa(20,14),wa(21,VP,2,0,"th",15),wa(22,UP,10,0,"td",16),Na(),wa(23,zP,1,0,"tr",17),wa(24,WP,1,0,"tr",18),Aa(),Ra(25,"mat-paginator",19),Aa(),Ra(26,"div",20),Aa()}if(2&t){var r=za();di(15),Sa("dataSource",r.dataSource),di(8),Sa("matHeaderRowDef",r.displayedColumns),di(1),Sa("matRowDefColumns",r.displayedColumns),di(1),Sa("pageSizeOptions",Au(5,qP))("pageSize",r.itemPorPagina)}}var GP,KP=((GP=function(){function t(e,n,r){_classCallCheck(this,t),this.dialog=e,this.router=n,this.equiposService=r,this.cargaPendientes=!0,this.displayedColumns=["nombre","acciones"],this.dataSource=new LO,this.verificarAcceso=!0,this.enBlanco=!1}return _createClass(t,[{key:"setDataSourceAttributes",value:function(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}},{key:"applyFilter",value:function(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}},{key:"determinarCantidadItem",value:function(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}},{key:"verJugadores",value:function(t){console.log(t),this.router.navigate(["main/jugadores-tabla/"+t.id])}},{key:"eliminar",value:function(t){var e=this;this.dialog.open(PP).afterClosed().subscribe((function(n){return Object(EP.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=5;break}return e.next=4,this.equiposService.eliminar(t.id);case 4:location.reload();case 5:case"end":return e.stop()}}),e,this)})))}))}},{key:"editar",value:function(t){this.router.navigate(["main/equipos-editar/"+t.id])}},{key:"nuevo",value:function(){this.router.navigate(["main/equipos-crear"])}},{key:"cargarTabla",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.equiposService.get();case 2:this.dataSource.data=t.sent,this.cargaPendientes=!1;case 4:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){this.cargarTabla(),console.log(this.dataSource.data)}},{key:"matSort",set:function(t){this.sort=t,this.setDataSourceAttributes()}},{key:"matPaginator",set:function(t){this.paginator=t,this.setDataSourceAttributes()}}]),t}()).\u0275fac=function(t){return new(t||GP)(Ca(zT),Ca(fg),Ca(FP))},GP.\u0275cmp=be({type:GP,selectors:[["app-equipos-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(mT,!0),Hu(GS,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["cols","2","rowHeight","100px"],["matInput","",3,"keyup"],["mat-raised-button","","color","primary",3,"click"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],[1,"button-row"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Jugadores",3,"click"],["mat-button","","color","accent","matTooltip","Editar",3,"click"],["mat-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(wa(0,LP,2,0,"div",0),wa(1,HP,27,6,"div",1)),2&t&&(Sa("ngIf",e.cargaPendientes),di(1),Sa("ngIf",!e.cargaPendientes))},directives:[Ll,hP,oP,uR,iC,zx,VE,NE,vA,hC,yO,mT,kO,xO,_O,TO,RO,GS,SO,CT,IO,AS,eT,NO,PO],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),GP),XP=function(t,e){return(XP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function $P(t,e){function n(){this.constructor=t}XP(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var YP=function(){return(YP=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function QP(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function JP(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var ZP=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=tM(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function tM(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}var eM=null;function nM(t){eM=t}function rM(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function iM(t,e,n){return Math.max(t,Math.min(e,n))}function oM(t){return t%2==0?t:t+1}function aM(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function sM(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function uM(t,e,n){void 0===n&&(n=""),sM(fM(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function cM(t){sM(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function lM(t,e){if(void 0===e&&(e=[]),null==e&&(e=[]),Array.isArray(t)||IM(t))for(var n=0;n<t.length;++n)lM(t[n],e);else e.push(t);return e}function hM(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function fM(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function dM(t){return t%1==0}function pM(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function vM(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function mM(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function gM(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0;!function a(){if(t())r();else{var s=e(++o);null!=n&&o>=n?i():setTimeout(a,s)}}()}))}function yM(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function bM(t,e){var n=e.length;return sM((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),sM(t.every((function(t){return dM(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function _M(t,e){for(var n=[],r=[],i=null==e?null:bM(e,t).sort(),o=0,a=0;a<t.length;++a){if(null!=i){if(i[o]===a&&1!==t[a])throw new Error("Can't squeeze axis "+a+" since its dim '"+t[a]+"' is not 1");(null==i[o]||i[o]>a)&&1===t[a]&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}1!==t[a]&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function wM(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function xM(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function CM(t,e,n){if("float32"===e)for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))throw Error("The result of the '"+n+"' is "+i+".")}}function kM(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function EM(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function SM(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function IM(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function TM(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function AM(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=2*t.length})),e}function RM(t){return"string"==typeof t||t instanceof String}function OM(t){return"boolean"==typeof t}function NM(t){return"number"==typeof t}function DM(t){return Array.isArray(t)?DM(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":NM(t)?"float32":RM(t)?"string":OM(t)?"bool":"float32"}function PM(t){return!!(t&&t.constructor&&t.call&&t.apply)}function MM(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function FM(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function LM(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=lM(t)),n&&kM(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function BM(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],a=0;a<o;a++)i[a]=r[e+a];else{o=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(a=0;a<o;a++)i[a]=t(e+a*u,s,r)}return i}(0,t,e)}function jM(t,e){for(var n=VM(t,e),r=0;r<n.length;r++)n[r]=1;return n}function VM(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function UM(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")}function zM(t){t.forEach((function(e){sM(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function WM(t,e){return eM.platform.fetch(t,e)}Object.freeze({Environment:ZP,getQueryParams:tM,get ENV(){return eM},setEnvironmentGlobal:nM}),Object.freeze({shuffle:rM,clamp:iM,nearestLargerEven:oM,sum:aM,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:sM,assertShapesMatch:uM,assertNonNull:cM,flatten:lM,sizeFromShape:hM,isScalarShape:function(t){return 0===t.length},arraysEqual:fM,isInt:dM,tanh:pM,sizeToSquarishShape:vM,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return rM(e),e},rightPad:mM,repeatedTry:gM,inferFromImplicitShape:yM,parseAxisParam:bM,squeezeShape:_M,getTypedArrayFromDType:wM,getArrayFromDType:xM,checkComputationForErrors:CM,checkConversionForErrors:kM,isValidDtype:EM,hasEncodingLoss:SM,isTypedArray:IM,bytesPerElement:TM,bytesFromStringArray:AM,isString:RM,isBoolean:OM,isNumber:NM,inferDtype:DM,isFunction:PM,nearestDivisor:MM,computeStrides:FM,toTypedArray:LM,toNestedArray:BM,makeOnesTypedArray:jM,makeZerosTypedArray:VM,now:UM,assertNonNegativeIntegerDimensions:zM,fetch:WM});var qM=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new HM)}return t.prototype.profileKernel=function(t,e){var n,r=this,i=this.backendTimer.time((function(){n=e()}));return(Array.isArray(n)?n:[n]).forEach((function(e){var n=e.dataSync();CM(n,e.dtype,t),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),r.logger.logKernelProfile(t,e,n,i.kernelMs,o)}))})),n},t}(),HM=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i){var o=mM(r+"ms",9),a=mM(t,25),s=e.rank,u=e.size,c=mM(e.shape.toString(),14);console.log("%c"+a+"\t%c"+o+"\t%c"+s+"D "+c+"\t%c"+u+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green")},t}();function GM(t,e,n){return mM(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":RM(t)?"'"+t+"'":"bool"===n?KM(t):parseFloat(t.toFixed(7)).toString(),e)}function KM(t){return 0===t?"false":"true"}function XM(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var $M=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=hM(t),null!=n){var i=n.length;sM(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||xM(e,this.size),this.strides=FM(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),sM(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var a="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return ZM.make(this.shape,{values:this.values},this.dtype)},t}(),YM=null,QM=null,JM=null,ZM=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=hM(t),this.strides=FM(t),this.dataId=null!=r?r:{},this.id=YM().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",YM().registerTensor(this,i),null!=n&&YM().write(i,this.dataId,n)}return t.make=function(e,n,r,i){return new t(e,r,n.values,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),sM(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),QM.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,QM.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return QM.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,BM(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return BM(this.shape,this.dataSync())},t.prototype.data=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){return this.throwIfDisposed(),[2,YM().read(this.dataId)]}))}))},t.prototype.dataSync=function(){return this.throwIfDisposed(),YM().readSync(this.dataId)},t.prototype.dispose=function(){this.isDisposed||(YM().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),QM.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),QM.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),QM.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),QM.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),QM.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),QM.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),QM.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=FM(e),o=function(t,e,n,r){var i=hM(e),o=r[r.length-1],a=new Array(o).fill(0),s=e.length,u="complex64"===n?XM(t):t;if(s>1)for(var c=0;c<i/o;c++)for(var l=c*o,h=0;h<o;h++)a[h]=Math.max(a[h],GM(u[l+h],0,n).length);return a}(t,e,n,i),a=e.length,s=function t(e,n,r,i,o,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[GM(XM(e)[0],0,r)]:"bool"===r?[KM(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=Array.from(e.slice(0,3*s)),h=Array.from(e.slice(u-3*s,u));return"complex64"===r&&(l=XM(l),h=XM(h)),["["+l.map((function(t,e){return GM(t,o[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return GM(t,o[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?XM(e):Array.from(e)).map((function(t,e){return GM(t,o[e],r)})).join(", ")+"]"]}var f=n.slice(1),d=i.slice(1),p=i[0]*s,v=[];if(u>20){for(var m=0;m<3;m++)v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,!1));for(v.push("..."),m=u-3;m<u;m++)v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,m===u-1))}else for(m=0;m<u;m++){var g;v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,m===u-1))}var y=2===c?",":"";for(v[0]="["+v[0]+y,m=1;m<v.length-1;m++)v[m]=" "+v[m]+y;var b=",\n";for(m=2;m<c;m++)b+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":b),v}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),QM.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),QM.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),QM.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),QM.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),QM.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),QM.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),QM.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),QM.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),QM.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),QM.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),QM.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),QM.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),JM("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),QM.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),QM.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),QM.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),QM.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),QM.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),QM.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),QM.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),QM.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),QM.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),QM.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),QM.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),QM.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),QM.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),QM.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),QM.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),QM.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),QM.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),QM.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),QM.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),QM.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),QM.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),QM.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),QM.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),QM.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),QM.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),QM.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),QM.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),QM.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),QM.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),QM.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),QM.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),QM.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),QM.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),QM.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),QM.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),QM.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),QM.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),QM.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),QM.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),QM.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),QM.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),QM.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),QM.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),QM.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),QM.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),QM.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),QM.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),QM.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),QM.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),QM.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),QM.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),QM.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),QM.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),QM.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),QM.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),QM.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),QM.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),QM.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),QM.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),QM.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),QM.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),QM.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),QM.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),QM.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),QM.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),QM.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),QM.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),QM.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),QM.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),QM.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),QM.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),QM.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),QM.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),QM.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),QM.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),QM.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),QM.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),QM.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),QM.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),QM.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),QM.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),QM.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),QM.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),QM.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),QM.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),QM.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),QM.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),QM.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),QM.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),QM.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),QM.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),QM.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),QM.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),QM.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),QM.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),QM.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),QM.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),QM.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),aF.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),QM.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),QM.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),QM.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),QM.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),QM.stridedSlice(this,t,e,n,r,i,o,a,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),QM.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),QM.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),QM.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),QM.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),QM.spectral.irfft(this)},t}();Object.defineProperty(ZM,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var tF,eF,nF,rF,iF,oF,aF=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=YM().nextVariableId().toString());try{YM().registerVariable(i)}catch(t){throw YM().disposeTensor(i),t}return i}return $P(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!fM(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");YM().disposeTensor(this),this.dataId=t.dataId,YM().registerTensor(this)},e.prototype.dispose=function(){YM().disposeVariable(this),this.isDisposedInternal=!0},e}(ZM);Object.defineProperty(aF,Symbol.hasInstance,{value:function(t){return t instanceof ZM&&null!=t.assign&&t.assign instanceof Function}}),(oF=tF||(tF={})).R0="R0",oF.R1="R1",oF.R2="R2",oF.R3="R3",oF.R4="R4",oF.R5="R5",oF.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(eF||(eF={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(nF||(nF={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(rF||(rF={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(iF||(iF={}));var sF={float32:rF,int32:eF,bool:nF,complex64:iF};function uF(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return sF[t][e]}function cF(t){return uF(t,"int32")}function lF(t,e){if(t.dtype===e.dtype)return[t,e];var n=uF(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function hF(t,e){sM(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function fF(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof ZM)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var a in o){var s=o[a];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:lF,assertTypesMatch:hF,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:fF});var dF,pF=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),vF=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new pF}return t.prototype.ready=function(){return QP(this,void 0,void 0,(function(){var t,e,n;return JP(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return QP(this,void 0,void 0,(function(){var e,n,r;return JP(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new qM(this.backendInstance),[2,!0]}}))}))},t.prototype.initializeBackend=function(t){var e=this,n=mF.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=ZM.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,(function(t){return[t.toFloat()]})),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],a=this.isTapeOn(),s=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){a&&(o=t.map((function(t){return i.keep(i.clone(t))})))},c=this.state.numBytes,l=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(s,(function(){return t(i.backend,u)})):t(i.backend,u)})),a){var h={id:this.state.nextTapeNodeId++,name:s,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShape:Array.isArray(r)?r.map((function(t){return t.shape})):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*TM(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof aF||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return QP(this,void 0,void 0,(function(){var e,n;return JP(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach((function(t,e){r[e]=t}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=fF(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==a.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),sM(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));sM(o instanceof ZM,(function(){return"The result y returned by f() must be a tensor."}));var a=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var a=(p=t[o]).inputs;for(var s in a){for(var u=a[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var f={};for(o=t.length-1;o>=0;o--)for(a=(p=t[o]).inputs,l=0;l<p.outputs.length;l++)if(h[p.outputs[l].id]){for(var s in a)h[a[s].id]=!0,f[p.id]=!0;break}var d=[];for(o=0;o<t.length;o++){var p;if(i[(p=t[o]).id]&&f[p.id]){var v={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},p);g.inputs=v,g.outputs=p.outputs,d.push(g)}}return d}(this.state.activeTape,e,o);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[o.id]=null==n?(r=jM(hM(t=o.shape),"float32"),ZM.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=ZM.make(e.shape,{values:VM(e.size,e.dtype)},e.dtype);o.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var a=i.gradient(1===i.outputs.length?o[0]:o),s=function(e){if(!(e in a))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!fM(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var s=t[o.id];t[o.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=e.length-1;i>=0;i--)r(i)}(s,a,(function(t){return i.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return sM(PM(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];sM(r.every((function(t){return t instanceof ZM})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernel((function(e,i){return sM((n=t.apply(void 0,r.concat([i]))).value instanceof ZM,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),sM(PM(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];sM(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),sM(o.every((function(t){return t instanceof ZM})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return o.forEach((function(t,e){a[e]=function(){return t}})),a}))}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=AM(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return QP(this,void 0,void 0,(function(){var e,n;return JP(this,(function(r){switch(r.label){case 0:return e=UM(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=UM()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new pF,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),mF=function(){var t=function(){if(null==dF){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}dF=t}return dF}();if(null==t._tfengine){var e=new ZP(t);t._tfengine=new vF(e)}return nM(t._tfengine.ENV),YM=function(){return t._tfengine},t._tfengine}();function gF(){return"undefined"!=typeof window||"undefined"!=typeof WorkerGlobalScope}eM.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),eM.registerFlag("IS_BROWSER",(function(){return gF()})),eM.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),eM.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),eM.registerFlag("PROD",(function(){return!1})),eM.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return eM.getBool("DEBUG")})),eM.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),eM.registerFlag("IS_TEST",(function(){return!1}));var yF={},bF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function _F(t,e){yF[t]=e}function wF(t){t in yF||(yF[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete yF[t]}),!1),1===t?e.getContext("webgl",bF)||e.getContext("experimental-webgl",bF):e.getContext("webgl2",bF)}(t));var e=yF[t];return e.isContextLost()?(delete yF[t],wF(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),yF[t])}function xF(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+kF(t,e))}(t),r}function CF(t){return!!(eM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function kF(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function EF(t,e,n){return XF(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function SF(t,e,n){var r=XF(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(xF(t,e,(function(){return t.shaderSource(r,n)})),xF(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function IF(t,e,n){var r=XF(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(xF(t,e,(function(){return t.shaderSource(r,n)})),xF(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=RF.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,a=i.map((function(t,e){return mM((e+1).toString(),o)+t})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var c=a.slice(0,r-1),l=a.slice(r-1,r),h=a.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+mM(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var TF,AF,RF=/ERROR: [0-9]+:([0-9]+):/g;function OF(t,e){return XF(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function NF(t,e,n){if(xF(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function DF(t,e,n){if(xF(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function PF(t,e,n){var r=XF(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return xF(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),xF(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function MF(t,e,n){var r=XF(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return xF(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),xF(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function FF(t,e){return XF(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function LF(t,e){var n=eM.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function BF(t,e){return XF(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function jF(t,e,n,r,i,o,a,s){var u=t.getAttribLocation(n,r);return-1!==u&&(xF(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),xF(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,a,s)})),xF(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function VF(t,e,n,r){$F(t,r),xF(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function UF(t,e,n,r){return XF(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function zF(t,e,n){return t.getUniformLocation(e,n)}function WF(t,e,n,r,i,o){xF(t,e,(function(){return VF(t,e,r,o)})),xF(t,e,(function(){return t.uniform1i(i,o)}))}function qF(t,e,n,r){xF(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),xF(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function HF(t,e,n){xF(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),xF(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function GF(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+KF(t,e))}function KF(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function XF(t,e,n,r){var i=xF(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function $F(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function YF(t,e){return void 0===e&&(e=2),hM(t.slice(0,t.length-e))}function QF(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function JF(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[YF(t)].concat(QF(t))),e}function ZF(t,e){var n;void 0===e&&(e=!1);var r=eM.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?oM(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=_M(t);t=i.newShape}var o=hM(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=YF(t),s=2,u=2;return t.length&&(s=(n=QF(t))[0],u=n[1]),vM(o=a*(s/2)*(u/2)).map((function(t){return 2*t}))}return vM(o)}function tL(t){return t%2==0}function eL(t,e){if(fM(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(tL(n)&&tL(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&tL(t[0])&&tL(e[0])}function nL(t){if(null==TF){var e=wF(t);TF=e.getParameter(e.MAX_TEXTURE_SIZE)}return TF}function rL(t){if(null==AF){var e=wF(t);AF=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,AF)}function iL(t){if(0===t)return 0;var e=wF(t);return oL(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:oL(e,"EXT_disjoint_timer_query")?1:0}function oL(t,e){return null!=t.getExtension(e)}function aL(t){try{if(null!=wF(t))return!0}catch(t){return!1}return!1}function sL(t){if(0===t)return!1;var e=wF(t);if(1===t){if(!oL(e,"OES_texture_float"))return!1}else if(!oL(e,"EXT_color_buffer_float"))return!1;return cL(e,t)}function uL(t){if(0===t)return!1;var e=wF(t);if(1===t){if(!oL(e,"OES_texture_float"))return!1;if(!oL(e,"WEBGL_color_buffer_float"))return!1}else if(!oL(e,"EXT_color_buffer_float"))return!1;return cL(e,t)}function cL(t,e){var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,2===e?t.RGBA32F:t.RGBA,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(n),i}function lL(t){return 2===t&&null!=wF(t).fenceSync}var hL=Object.freeze({callAndCheck:xF,canBeRepresented:CF,getWebGLErrorMessage:kF,getExtensionOrThrow:EF,createVertexShader:SF,createFragmentShader:IF,createProgram:OF,linkProgram:NF,validateProgram:DF,createStaticVertexBuffer:PF,createStaticIndexBuffer:MF,getNumChannels:function(){return 2===eM.getNumber("WEBGL_VERSION")?1:4},createTexture:FF,validateTextureSize:LF,createFramebuffer:BF,bindVertexBufferToProgramAttribute:jF,bindTextureUnit:VF,unbindTextureUnit:function(t,e,n){$F(t,n),xF(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:UF,getProgramUniformLocation:zF,bindTextureToProgramUniformSampler:WF,bindCanvasToFramebuffer:function(t,e){xF(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),xF(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),xF(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:qF,unbindColorTextureFromFramebuffer:HF,validateFramebuffer:GF,getFramebufferErrorMessage:KF,getBatchDim:YF,getRowsCols:QF,getShapeAs3D:JF,getTextureShapeFromLogicalShape:ZF,isReshapeFree:eL,get MAX_TEXTURE_SIZE(){return TF},get MAX_TEXTURES_IN_SHADER(){return AF},getWebGLMaxTextureSize:nL,getMaxTexturesInShader:rL,getWebGLDisjointQueryTimerVersion:iL,isWebGLVersionEnabled:aL,isRenderToFloatTextureEnabled:sL,isDownloadFloatTextureEnabled:uL,isWebGLFenceEnabled:lL});function fL(t){eM.getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function dL(t,e){return mF.tidy(t,e)}function pL(t){fF(t).forEach((function(t){return t.dispose()}))}function vL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];eM.getBool("IS_TEST")||console.warn.apply(console,t)}function mL(t){var e=t;if(IM(t))return[t.length];if(!Array.isArray(t))return[];for(var n=[];Array.isArray(e)||IM(e);)n.push(e.length),e=e[0];return Array.isArray(t)&&eM.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||IM(e)){sM(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),sM(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else sM(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,n,[]),n}function gL(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function yL(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof ZM)return gL(r,t.dtype,e,n),t;var i=DM(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),gL(r,i,e,n),null==t||!IM(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=mL(t);IM(t)||Array.isArray(t)||(t=[t]);var a="string"!==i?LM(t,i,eM.getBool("DEBUG")):lM(t);return ZM.make(o,{values:a},i)}function bL(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return yL(t,e+"["+r+"]",n)}),r)}function _L(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function wL(t,e,n){for(var r=t.length+e.length,i=[],o=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[o++]):i.push(e[a++]);return i}function xL(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function CL(t,e){return wL(t,e.map((function(t){return 1})),e)}function kL(t,e,n){sM(_L(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function EL(t,e){if(_L(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function SL(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function IL(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function TL(t,e){var n=t[0].length;t.forEach((function(t,e){sM(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),sM(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)sM(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function AL(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function RL(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];mF.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),mF.endScope(i),i}catch(t){throw mF.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}eM.registerFlag("HAS_WEBGL",(function(){return eM.getNumber("WEBGL_VERSION")>0})),eM.registerFlag("WEBGL_VERSION",(function(){return aL(2)?2:aL(1)?1:0})),eM.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===eM.get("WEBGL_VERSION")})),eM.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),eM.registerFlag("WEBGL_PACK",(function(){return eM.getBool("HAS_WEBGL")})),eM.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_PACK_CLIP",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),eM.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_PACK_REDUCE",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_CONV_IM2COL",(function(){return eM.getBool("WEBGL_PACK")})),eM.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return nL(eM.getNumber("WEBGL_VERSION"))})),eM.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return rL(eM.getNumber("WEBGL_VERSION"))})),eM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=eM.getNumber("WEBGL_VERSION");return 0===t?0:iL(t)})),eM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),eM.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return sL(eM.getNumber("WEBGL_VERSION"))})),eM.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return uL(eM.getNumber("WEBGL_VERSION"))})),eM.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return lL(eM.getNumber("WEBGL_VERSION"))})),eM.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return eM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),JM=fL;var OL=RL({complex_:function(t,e){var n=yL(t,"real","complex"),r=yL(e,"imag","complex");return uM(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),mF.runKernel((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),NL=RL({real_:function(t){var e=yL(t,"input","real");return mF.runKernel((function(t){return t.real(e)}),{$input:e})}}),DL=RL({imag_:function(t){var e=yL(t,"input","imag");return mF.runKernel((function(t){return t.imag(e)}),{$input:e})}});function PL(t,e,n){return ML(t,e,mL(t),n)}function ML(t,e,n,r){if(null==r&&(r=DM(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!IM(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){zM(e);var i=hM(e),o=hM(n);sM(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var a=0;a<n.length;++a){var s=a!==n.length-1||n[a]!==hM(e.slice(a));sM(n[a]===e[a]||!s,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return IM(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?LM(t,r,eM.getBool("DEBUG")):lM(t),ZM.make(e,{values:t},r)}function FL(t,e){if((IM(t)||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");return ML(t,[],[],e)}function LL(t,e){cM(t);var n=mL(t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ML(t,null,n,e)}function BL(t,e,n){if(cM(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=mL(t);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ML(t,e,r,n)}function jL(t,e,n){if(cM(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=mL(t);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ML(t,e,r,n)}function VL(t,e,n){if(cM(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=mL(t);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ML(t,e,r,n)}function UL(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=UL(t,"float32"),r=zL(t,"float32");return OL(n,r)}var i=jM(hM(t),e);return ZM.make(t,{values:i},e)}function zL(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=zL(t,"float32"),r=zL(t,"float32");return OL(n,r)}var i=VM(hM(t),e);return ZM.make(t,{values:i},e)}function WL(t,e,n){return mF.runKernel((function(r){return r.fill(t,e,n)}),{})}function qL(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return zL([0],r);var i=VM(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return LL(i,r)}var HL=RL({onesLike_:function(t){var e=yL(t,"x","onesLike");if("complex64"===e.dtype){var n=HL(NL(e)),r=GL(DL(e));return OL(n,r)}return mF.runKernel((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return GL(t)}}}))}}),GL=RL({zerosLike_:function(t){var e=yL(t,"x","zerosLike");return mF.runKernel((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return GL(t)}}}))}}),KL=RL({concat_:function(t,e){void 0===e&&(e=0),sM(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=bL(t,"tensors","concat");e=bM(e,n[0].shape)[0];var r=AL(n.map((function(t){return t.shape})),e);if(0===hM(r))return PL([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return TL(i,e),mF.runKernel((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return JL(t,n,e).map((function(t){return function(){return t}}))}))}}),XL=RL({concat1d_:function(t){return KL(t,0)}}),$L=RL({concat2d_:function(t,e){return KL(t,e)}}),YL=RL({concat3d_:function(t,e){return KL(t,e)}}),QL=RL({concat4d_:function(t,e){return KL(t,e)}}),JL=RL({split_:function(t,e,n){void 0===n&&(n=0);var r,i=yL(t,"x","split");return n=bM(n,i.shape)[0],"number"==typeof e?(sM(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(sM(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),mF.runKernel((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return KL(t,n)}}}))}});function ZL(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var tB=ZL((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.alea=o}(0,t)})),eB=ZL((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor128=o}(0,t)})),nB=ZL((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)})),rB=ZL((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.x&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)})),iB=ZL((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=s[127&o]^=r+(a=a+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=a,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.X&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)})),oB=ZL((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.tychei=o}(0,t)})),aB=ZL((function(t){!function(e,r){var i,o=this,a=256,s="random",u=r.pow(a,6),c=r.pow(2,52),l=2*c,h=255;function f(t,n,h){var f=[],g=v(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,m(e)]}}():t,3),f),y=new d(f),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(m(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&p(i,y),t.state=function(){return p(y,{})}),n?(r[s]=t,e):t})(b,g,"global"in n?n.global:this==r,n.state)}function d(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=h&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*a+s[h&(s[i]=s[o=h&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=f,v(r.random(),e),t.exports){t.exports=f;try{i=n(1)}catch(t){}}}([],Math)}));aB.alea=tB,aB.xor128=eB,aB.xorwow=nB,aB.xorshift7=rB,aB.xor4096=iB,aB.tychei=oB;var sB=aB.alea,uB=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=sB(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*o*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),cB=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=1);var i=this;if(this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=sB(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function lB(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",zM(t),new $M(t,e,n)}var hB=RL({batchToSpaceND_:function(t,e,n){var r=yL(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return sM(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),sM(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),sM(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),mF.runKernel((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),fB=RL({cast_:function(t,e){var n=yL(t,"x","cast");if(!EM(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return mF.runKernel((function(t){return t.cast(n,e)}),{$x:n},(function(t){return{$x:function(){return t.clone()}}}))}}),dB=RL({clone_:function(t){var e=yL(t,"x","clone",null);return mF.runKernel((function(t){return ZM.make(e.shape,{dataId:e.dataId},e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),pB=RL({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=yL(t,"x","cumsum"),o=EL([e|=0],i.rank),a=i;null!=o&&(a=i.transpose(o));var s=IL(1,i.rank)[0],u=mF.runKernel((function(t){return t.cumsum(a,s,n,r)}),{permutedX:a},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),vB=RL({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=yL(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return sM(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),sM(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),sM(a%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape})),mF.runKernel((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),mB=RL({expandDims_:function(t,e){void 0===e&&(e=0);var n=yL(t,"x","expandDims",null);sM(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(sM(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),TB(n,r)}}),gB=RL({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=lB([t,e],r),o=t<=e?t:e,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return NB(mB(s,0),[n[0],1,1]);if(2===n.length)return NB(mB(mB(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return NB(mB(mB(mB(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),yB=RL({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=yL(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?i.as2D(1,-1):i,u=mF.runKernel((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===a?u.as1D():u}}),bB=RL({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=yL(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),mF.runKernel((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return zL(i.shape,"float32")}}})).reshape(o)}}),_B=RL({pad_:function(t,e,n){void 0===n&&(n=0);var r=yL(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map((function(t){return t[0]}));return mF.runKernel((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(i,r.shape)}}}))}}),wB=RL({pad1d_:function(t,e,n){return void 0===n&&(n=0),sM(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),_B(t,[e],n)}}),xB=RL({pad2d_:function(t,e,n){return void 0===n&&(n=0),sM(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_B(t,e,n)}}),CB=RL({pad3d_:function(t,e,n){return void 0===n&&(n=0),sM(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_B(t,e,n)}}),kB=RL({pad4d_:function(t,e,n){return void 0===n&&(n=0),sM(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_B(t,e,n)}}),EB=RL({rand_:function(t,e,n){var r=hM(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return ZM.make(t,{values:i},n)}}),SB=RL({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new uB(e,n,r,!1,i),a=lB(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),IB=RL({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=lB(t,r),a=new cB(e,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),TB=RL({reshape_:function(t,e){var n=yL(t,"x","reshape",null);return e=yM(e,n.size),sM(n.size===hM(e),(function(){return"new shape and old shape must have the same number of elements."})),mF.runKernel((function(t){return t.reshape(n,e)}),{$x:n},(function(t){return{$x:function(){return t.reshape(n.shape)}}}))}}),AB=RL({spaceToBatchND_:function(t,e,n){var r=yL(t,"x","spaceToBatchND");return sM(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),sM(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),sM(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),mF.runKernel((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),RB=RL({squeeze_:function(t,e){var n=yL(t,"x","squeeze");return TB(n,_M(n.shape,e).newShape)}}),OB=RL({stack_:function(t,e){void 0===e&&(e=0);var n=bL(t,"tensors","stack");if(sM(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;sM(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){uM(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){sM(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return KL(o,e)}}),NB=RL({tile_:function(t,e){var n=yL(t,"x","tile",null);return sM(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),mF.runKernel((function(t,r){var i=t.tile(n,e);return r([n]),i}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=GL(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var a=0;a<e[2];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(a=0;a<e[2];++a)for(var s=0;s<e[3];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),DB=RL({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new uB(e,n,r,!0,i),a=lB(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),PB=RL({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=yL(t,"x","unstack");return sM(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),mF.runKernel((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return OB(t,e)}}}))}});function MB(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,a=0;a<o;++a)i=i.concat([t[a+1]/e[a],e[a]]);i=i.concat(t.slice(o+1))}return i}function FB(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function LB(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function BB(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function jB(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function VB(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=t.shape,s=n.slice();s.pop();var u=1;for(o=r;o<t.rank;++o)u*=a[o],s.push(a[o]);var c=FM(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,i,u,c]}function UB(t){return t<=30?t:MM(t,Math.floor(Math.sqrt(t)))}function zB(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,a=r;a<i;++a)o*=n[a];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:FM(n.slice(0,r)).concat([1]),outputSize:hM(n)}}function WB(t,e,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),0!==a)throw new Error("ellipsis mask is not yet supported");if(0!==s)throw new Error("new axis mask is not yet supported");for(var c=[],l=[],h=[],f=0;f<t.length;f++)c[f]=qB(i,e,r,t,f),l[f]=HB(o,n,r,t,f),u&1<<f&&(l[f]=c[f]+1,h.push(f));var d=new Array(t.length).fill(0);return d=d.map((function(t,e){for(var n=0,i=r[e]||1,o=c[e];!(i>0?o>=l[e]:o<=l[e]);o+=i)n+=1;return n})),[c,d,h]}function qB(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),iM(0,o,a-1)}function HB(t,e,n,r,i){var o=e[i],a=n[i]||1;(t&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),a>0?iM(0,o,s):iM(-1,o,s-1)}function GB(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function KB(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function XB(t){return mF.customGrad(t)}var $B=RL({softmax_:function(t,e){void 0===e&&(e=-1);var n=yL(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return XB((function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}}))(n)}}),YB=RL({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=yL(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return XB((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),QB=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}();function JB(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function ZB(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function tj(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var a=e[e.length-i-1];if(null==a&&(a=1),1===o)n.unshift(a);else if(1===a)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function ej(t,e,n,r,i,o,a){void 0===a&&(a="channelsLast");var s,u=oj(e),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,t[1],t[1]]}return nj(t,s,n,r,i,o,!1,a)}function nj(t,e,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3];if("channelsLast"===s)c=t[0],l=t[1],h=t[2],f=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],h=t[3]}var d,p=e[0],v=e[1],m=e[3],g=oj(n),y=g[0],b=g[1],_=oj(r),w=_[0],x=_[1],C=sj(p,w),k=sj(v,x),E=function(t,e,n,r,i,o,a,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i,o){null==i&&(i=ij(t,e,r));var a=t[1],s=uj((t[0]-e+2*i)/r+1,o);sM(dM(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var u=uj((a-e+2*i)/r+1,o);return sM(dM(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[s,u,1]}([e,n,1],o,0,r,t,s);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var f=Math.max(0,(c-1)*r+o-e),d=Math.max(0,(l-1)*i+a-n),p=Math.floor(f/2),v=f-p,m=Math.floor(d/2);u={top:p,bottom:v,left:m,right:d-m,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),l=Math.ceil((n-a+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,b,C,k,o),S=E.outHeight,I=E.outWidth,T=a?m*f:m;return"channelsFirst"===s?d=[c,T,S,I]:"channelsLast"===s&&(d=[c,S,I,T]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:h,inChannels:f,outHeight:S,outWidth:I,outChannels:T,padInfo:E.padInfo,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:v,effectiveFilterHeight:C,effectiveFilterWidth:k,dilationHeight:w,dilationWidth:x,inShape:t,outShape:d,filterShape:e}}function rj(t,e,n,r,i,o,a){void 0===o&&(o=!1),void 0===a&&(a="channelsLast");var s=[-1,-1,-1,-1,-1],u=s[0],c=s[1],l=s[2],h=s[3],f=s[4];if("channelsLast"===a)u=t[0],c=t[1],l=t[2],h=t[3],f=t[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);u=t[0],f=t[1],c=t[2],l=t[3],h=t[4]}var d,p=e[0],v=e[1],m=e[2],g=e[4],y=aj(n),b=y[0],_=y[1],w=y[2],x=aj(r),C=x[0],k=x[1],E=x[2],S=function(t,e,n,r,i,o,a,s,u,c){var l,h,f,d;if("same"===t){var p=((h=Math.ceil(e/i))-1)*i+s-e,v=((f=Math.ceil(n/o))-1)*o+u-n,m=((d=Math.ceil(r/a))-1)*a+c-r,g=Math.floor(p/2),y=p-g,b=Math.floor(v/2),_=v-b,w=Math.floor(m/2);l={top:b,bottom:_,left:w,right:m-w,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);l={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-s+1)/i),f=Math.ceil((n-u+1)/o),d=Math.ceil((r-c+1)/a)}return{padInfo:l,outDepth:h,outHeight:f,outWidth:d}}(i,c,l,h,b,_,w,sj(p,C),sj(v,k),sj(m,E)),I=S.outDepth,T=S.outHeight,A=S.outWidth,R=o?g*f:g;return"channelsFirst"===a?d=[u,R,I,T,A]:"channelsLast"===a&&(d=[u,I,T,A,R]),{batchSize:u,dataFormat:a,inDepth:c,inHeight:l,inWidth:h,inChannels:f,outDepth:I,outHeight:T,outWidth:A,outChannels:R,padInfo:S.padInfo,strideDepth:b,strideHeight:_,strideWidth:w,filterDepth:p,filterHeight:v,filterWidth:m,dilationDepth:C,dilationHeight:k,dilationWidth:E,inShape:t,outShape:d,filterShape:e}}function ij(t,e,n,r){void 0===r&&(r=1);var i=sj(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function oj(t){return"number"==typeof t?[t,t]:t}function aj(t){return"number"==typeof t?[t,t,t]:t}function sj(t,e){return e<=1?t:t+(t-1)*(e-1)}function uj(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function cj(t){var e=oj(t);return 1===e[0]&&1===e[1]}function lj(t,e){return cj(t)||cj(e)}function hj(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=zL(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!SM(t.dtype,e))return ZM.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var a=n.real(t);return o=a.cast(e),a.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var s=FL(0,t.dtype);return o=n.notEqual(t,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function fj(t,e){return ZM.make(e,{dataId:t.dataId},t.dtype)}function dj(t,e,n){var r=(e-t)/(n-1),i=VM(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return LL(i,"float32")}function pj(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function vj(t,e){return{real:t[2*e],imag:t[2*e+1]}}function mj(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function gj(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function yj(t,e,n,r,i){for(var o=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),a=[],s=0;s<o.length;s++){var u=o[s],c=u.boxIndex;if(u.score<i)break;for(var l=!1,h=a.length-1;h>=0;--h)if(bj(t,c,a[h])>=r){l=!0;break}if(!l&&(a.push(c),a.length>=n))break}return LL(a,"int32")}function bj(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),d=(s-o)*(u-a),p=(h-c)*(f-l);if(d<=0||p<=0)return 0;var v=Math.max(o,c),m=Math.max(a,l),g=Math.min(s,h),y=Math.min(u,f),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(d+p-b)}function _j(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function wj(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=lB(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=o[s]%t.shape[s];var u=t.locToIndex(a);i.values[r]=t.values[u]}return i.toTensor()}function xj(t,e,n,r,i){for(var o=e[e.length-1],a=[t.length/o,o],s=a[0],u=a[1],c=wM(n,s*r),l=wM("int32",s*r),h=0;h<s;h++){for(var f=h*u,d=t.subarray(f,f+u),p=[],v=0;v<d.length;v++)p.push({value:d[v],index:v});p.sort((function(t,e){return e.value-t.value}));var m=h*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}var b=e.slice();return b[b.length-1]=r,[PL(c,b,n),PL(l,b,"int32")]}function Cj(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=lB(t,"int32"),o=lB([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]);o.values.set(a,r*t.length)}return o.toTensor()}!function(){function t(){}t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s,u){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")}}(),Object.freeze({castTensor:hj,reshapeTensor:fj,linspaceImpl:dj,upcastType:uF,axesAreInnerMostDims:_L,combineLocations:wL,computeOutAndReduceShapes:xL,expandShapeToKeepDim:CL,assertAxesAreInnerMostDims:kL,getAxesPermutation:EL,getUndoAxesPermutation:SL,getInnerMostAxes:IL,getBroadcastDims:JB,getReductionAxes:ZB,assertAndGetBroadcastShape:tj,assertParamsConsistent:TL,computeOutShape:AL,computePool2DInfo:ej,computeConv2DInfo:nj,computeConv3DInfo:rj,computeDefaultPad:ij,tupleValuesAreOne:cj,eitherStridesOrDilationsAreOne:lj});var kj=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Ej=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Sj=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Ij(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function Tj(t,e){return 1===e?[t]:Ij(t,e)}function Aj(){var t,e,n,r,i,o,a,s,u,c;return 2===eM.getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 0. || val == 0.) ? false : true;\n      }\n    ",u="\n      const float INFINITY = uintBitsToFloat(uint(0x7f800000));\n    ",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Rj(t,e,n){void 0===n&&(n="index");var r=FM(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function Oj(t){var e=FM(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var Nj="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Dj(t){return"offset"+t}function Pj(t){var e=t.name,n=hM(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function Mj(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function Fj(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Lj(t,e){return e.map((function(e){return t[e]})).join(", ")}var Bj=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,sM(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,a,s=this.outputShape,u=s.length,c=Mj(u),l=Tj("coords",u);if(1===i){var h=Mj(a=u+1);o="\n        "+h+" sourceLocR = "+h+"("+l.join()+", 0);\n        ++"+l[u-1]+";\n        "+h+" sourceLocG = "+h+"("+l.join()+", 0);\n        ++"+l[u-2]+";\n        "+h+" sourceLocA = "+h+"("+l.join()+", 0);\n        --"+l[u-1]+";\n        "+h+" sourceLocB = "+h+"("+l.join()+", 0);\n        --"+l[u-2]+";"}else a=u,o="\n        "+c+" sourceLocR = coords;\n        ++"+l[u-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+l[u-2]+";\n        "+c+" sourceLocA = coords;\n        --"+l[u-1]+";\n        "+c+" sourceLocB = coords;\n        --"+l[u-2]+";";var f=["x","y","z","w","u","v"].slice(0,a),d="."+f[a-1],p=f.map((function(t){return"int "+t})),v=Tj("sourceLocR",a-1).concat("inIdx.r"),m=Tj("sourceLocG",a-1).concat("inIdx.g"),g=Tj("sourceLocB",a-1).concat("inIdx.b"),y=Tj("sourceLocA",a-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",_=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+")));",w="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+m.join()+") : 0.,\n            hasNextRow ? getAChannel("+g.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+y.join()+") : 0.)",x=r?"":"\n      float getBestIndicesAChannel("+p.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+p.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+x+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+l[u-1]+" < "+(s[u-1]-1)+";\n        bool hasNextRow = "+l[u-2]+" < "+(s[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+w+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+_+"\n          vec4 candidate = "+w+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},jj=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Vj=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],tj(t,e),tj(t,n);var a="0.0";null!=r&&(tj(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=i&&(tj(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Uj=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],tj(t,e),tj(t,n);var a="vec4(0.0)";null!=r&&(tj(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(tj(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},zj=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=tj(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Wj="return a - b;",qj="return a * b;",Hj=function(t,e,n){this.variableNames=["A","B"],this.outputShape=tj(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Gj=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=tj(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===hM(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+Mj(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Tj("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+a[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+a[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},Kj=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, min, max));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Xj=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(min), vec4(max)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),$j=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Yj=function(t){this.outputShape=[],this.outputShape=AL(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Qj=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=AL(t,e);var n=this.outputShape,r=n.length,i=Mj(r),o=Tj("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=a[e],l="vec2("+a.slice(-2).join()+")",h=a.join(),f="if ("+c+" < "+s[0]+")\n          return getChannel(getT0("+h+"), "+l+");";for(u=1;u<s.length;u++)f+="\n        else if ("+c+" < "+s[u]+") {\n          "+c+" -= "+s[u-1]+";\n          return getChannel(getT"+u+"("+h+"), "+l+");\n        }";f+="\n        else {\n          "+c+" -= "+s[s.length-1]+";\n          return getChannel(getT"+s.length+"("+h+"), "+l+");\n        }",this.userCode="\n      float getValue("+a.map((function(t){return"int "+t}))+") {\n        "+f+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n        if (++"+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n        if (++"+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            --"+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "},Jj=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Zj=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},tV=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eV=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},nV=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TODO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},rV=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TODO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},iV=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.top,n=t.padInfo.left,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.filterHeight,u=t.filterWidth,c=4*Math.floor(t.inChannels/4),l=t.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+i+");\n      const ivec2 pads = ivec2("+e+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+"; wR++) {\n          int xR = xRCorner + wR * "+o+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+u+"; wC++) {\n            int xC = xCCorner + wC * "+a+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+c+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===l)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+c+") *\n                getW(wR, wC, "+c+", d2);\n            } else if ("+(2===l)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===l)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1),\n                getX(batch, xR, xC, "+c+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2),\n                getW(wR, wC, "+c+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},oV=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},aV=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+t.strideHeight+", "+t.strideWidth+");\n      const ivec2 pads = ivec2("+t.padInfo.top+", "+t.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+e+";\n        int q = d2 - d1 * "+e+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+t.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+t.dilationHeight+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+t.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+t.dilationWidth+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},sV=function(t){this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var e=t.inHeight,n=t.inWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,a=t.strideWidth,s=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,f="int xR; int xC; int xCOffset;",d=0;d<c;d++)for(var p=0;p<l;p++)f+="\n          vec4 xTexelR"+d+"C"+2*p+" = vec4(0.);\n          vec4 wR"+d+"C"+p+" = vec4(0.);\n          vec4 xR"+d+"C"+p+" = vec4(0.);";for(d=0;d<c;d++)for(var v=0;v<h;v++){if(f+="\n          xR = xRCorner + "+d*s+";\n          xC = xCCorner + "+(p=2*v)*u+";\n        ",1===a){if(p<l&&(f+=i%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+d+"C"+p+" = vec4(previous.zw, xTexelR"+d+"C"+p+".xy);\n                } else {\n                  xR"+d+"C"+p+" = vec4(0, 0, xTexelR"+d+"C"+p+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+e+" && xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = xTexelR"+d+"C"+p+";\n              ",p+1<l)){var m=i%2==0?oM(u):u;u%2==0&&i%2==1||u%2!=0&&i%2!=1?(f+="\n                  xCOffset = xC + "+i%2+" + "+m+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",u>1&&(f+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+e+" &&\n                      xCOffset >= 0 && xCOffset < "+n+") {\n                      xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+d+"C"+p+" = vec4(0.);\n                    }\n                  "),f+="\n                  xR"+d+"C"+(p+1)+" = vec4(\n                    xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".xy);\n                "):f+="\n                  xCOffset = xC + "+m+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+d+"C"+(p+1)+" = xTexelR"+d+"C"+(p+2)+";\n                "}}else p<l&&(f+="\n              if(xR >= 0 && xR < "+e+") {\n            ",i%2==1?(f+="\n                xCOffset = xC + 1 - "+a+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+n+") {\n                  xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+d+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = vec4(\n                  xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".zw);\n              ",p+1<l&&(f+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+a+";\n                  if(xCOffset >= 0 && xCOffset < "+n+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+d+"C"+(p+1)+" = vec4(xTexelR"+d+"C"+(p+2)+".xy, final.xy);\n                ")):(f+="\n                if(xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+a+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = vec4(\n                  xTexelR"+d+"C"+p+".xy, xTexelR"+d+"C"+(p+2)+".xy);\n              ",p+1<l&&(f+="\n                  xR"+d+"C"+(p+1)+" = vec4(\n                    xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".zw);\n                ")),f+="}");p<l&&(f+="\n            vec4 wTexelR"+d+"C"+p+" = getW("+d+", "+p+", d1, q);\n            wR"+d+"C"+p+" = vec4(wTexelR"+d+"C"+p+".xz, wTexelR"+d+"C"+p+".xz);\n          ",p+1<l&&(f+="\n              vec4 wTexelR"+d+"C"+(p+1)+" = getW("+d+", "+(p+1)+", d1, q);\n              wR"+d+"C"+(p+1)+" =\n                vec4(wTexelR"+d+"C"+(p+1)+".xz, wTexelR"+d+"C"+(p+1)+".xz);"))}for(d=0;d<c;d++)for(p=0;p<l;p++)f+="result += xR"+d+"C"+p+" * wR"+d+"C"+p+";";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+a+");\n      const ivec2 pads = ivec2("+r+", "+i+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 result = vec4(0.);\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},uV=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],a=t[1],s=t[2],u=n[0],c=n[1];this.outputShape=[e[0],u,c,t[3]];var l=[a-1+".0",s-1+".0"],h=l[0],f=l[1],d=u>1?[""+(a-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],p=c>1?[""+(s-1)/(c-1),"(x2-x1) * width_ratio","x1*"+f+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+f];this.userCode="\n      const float height_ratio = float("+d[0]+");\n      const float width_ratio = float("+p[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+d[1]+";\n        float width_scale = "+p[1]+";\n\n        float in_y = "+d[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+p[2]+";\n        if( in_x < 0.0 || in_x > "+f+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},cV=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Mj(r)+" coords = getOutputCoords();\n        int end = "+lV(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+lV(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function lV(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var hV,fV,dV=function(t,e){this.variableNames=["A"];var n=Aj();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Rj(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},pV=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=Aj();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Rj(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},vV=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),mV=function(t){this.variableNames=["A"];var e=Aj();this.outputShape=t,this.userCode="\n      "+Nj+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},gV=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=Aj();this.outputShape=t,this.userCode="\n      "+Nj+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},yV=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Aj(),i=e[0],o=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Oj(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex /= 4;\n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},bV=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Aj(),i=e[0],o=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex /= 4;\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Oj(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},_V=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},wV=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),xV=function(t){this.variableNames=["A"];var e=Aj(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},CV=function(t){this.variableNames=["A"];var e=Aj(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},kV=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=Mj(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},EV=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=Mj(e.length),i=Mj(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function SV(t,e){return[e,t]}function IV(t){var e=hM(t);return vM(Math.ceil(e/4))}function TV(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function AV(t,e){var n=Aj();return SF(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function RV(t,e){return PF(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function OV(t,e){return MF(t,e,new Uint16Array([0,1,2,2,1,3]))}function NV(t,e){var n,r,i,o,a,s,u,c,l=t;return 2===eM.getNumber("WEBGL_VERSION")?(n=l.R32F,r=l.R16F,i=l.RGBA16F,o=l.RGBA32F,a=l.RED,s=4,u=1,c=l.HALF_FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=l.RGBA,a=t.RGBA,s=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c}}function DV(t,e,n,r,i,o,a){LF(n,r);var s=FF(t,e),u=t.TEXTURE_2D;return xF(t,e,(function(){return t.bindTexture(u,s)})),xF(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),xF(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),xF(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),xF(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),xF(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,a,null)})),xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function PV(t,e,n,r,i){var o=SV(n,r);return DV(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function MV(t,e,n,r,i){var o=SV(n,r);return DV(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function FV(t,e,n,r,i){var o=SV(n,r);return DV(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function LV(t,e,n,r,i){var o=TV(n,r);return DV(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function BV(t,e,n,r,i){var o=TV(n,r);return DV(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function jV(t,e,n,r){return xF(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),jF(t,e,n,"clipSpacePos",r,3,20,0)&&jF(t,e,n,"uv",r,2,20,12)}function VV(t,e,n,r,i,o,a){var s,u,c;xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(o),xF(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,s)})),xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function UV(t,e,n,r){xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?xF(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):xF(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),xF(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function zV(t,e,n,r,i){var o=t.createBuffer();xF(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var a=16*n*r;return xF(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)})),xF(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),xF(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function WV(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function qV(t,e,n,r,i){var o=SV(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return xF(t,e,(function(){return t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function HV(t,e,n,r,i,o,a,s){var u=t,c=new Float32Array(function(t,e){var n=TV(t,e);return n[0]*n[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function GV(t,e,n,r){var i=new Float32Array(n*r*4);return xF(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(hV||(hV={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(fV||(fV={}));var KV=Object.freeze({createVertexShader:AV,createVertexBuffer:RV,createIndexBuffer:OV,getTextureConfig:NV,createFloat32MatrixTexture:PV,createFloat16MatrixTexture:MV,createUnsignedBytesMatrixTexture:FV,createPackedMatrixTexture:LV,createFloat16PackedMatrixTexture:BV,bindVertexProgramAttributeStreams:jV,uploadDenseMatrixToTexture:VV,uploadPixelDataToTexture:UV,createBufferFromOutputTexture:zV,downloadFloat32MatrixFromBuffer:WV,downloadByteEncodedFloatMatrixFromOutputTexture:qV,downloadPackedMatrixFromBuffer:HV,downloadMatrixFromPackedOutputTexture:GV}),XV=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=eM.getNumber("WEBGL_VERSION");null!=t?(this.gl=t,_F(e,t)):this.gl=wF(e),1===eM.getNumber("WEBGL_VERSION")?(this.textureFloatExtension=EF(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),eM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||(this.textureHalfFloatExtension=EF(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float"))):this.colorBufferFloatExtension=EF(this.gl,this.debug,"EXT_color_buffer_float"),this.vertexBuffer=RV(this.gl,this.debug),this.indexBuffer=OV(this.gl,this.debug),this.framebuffer=BF(this.gl,this.debug),this.textureConfig=NV(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return eM.getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;xF(e,this.debug,(function(){return e.finish()})),xF(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),xF(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),xF(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),xF(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),xF(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),PV(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),MV(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),FV(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),UV(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),VV(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),BV(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),LV(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(HF(this.gl,this.debug,this.framebuffer),this.outputTexture=null),xF(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return qV(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return HV(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return WV(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=zV(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(eM.getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return GV(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=IF(e,this.debug,t),r=AV(e,this.debug),i=OF(e,this.debug);return xF(e,this.debug,(function(){return e.attachShader(i,r)})),xF(e,this.debug,(function(){return e.attachShader(i,n)})),NF(e,this.debug,i),this.debug&&DF(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=jV(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&xF(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&DF(this.gl,this.debug,this.program),xF(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?UF(this.gl,this.debug,t,e):zF(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),xF(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),WF(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=TV(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&DF(this.gl,this.debug,this.program),GF(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),xF(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),xF(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=EF(this.gl,this.debug,2===eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return QP(this,void 0,void 0,(function(){var e=this;return JP(this,(function(n){switch(n.label){case 0:return[4,gM((function(){return e.disposed||e.isQueryAvailable(t,eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||gM((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),qF(this.gl,this.debug,t,this.framebuffer),this.debug&&GF(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(qF(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&GF(this.gl)):HF(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;qF(r,this.debug,t,this.framebuffer),this.debug&&GF(r),this.outputTexture=t,xF(r,this.debug,(function(){return r.viewport(0,0,e,n)})),xF(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),xF(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function $V(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!fM(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var a=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!fM(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var YV=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,a=n.padInfo,s=n.outWidth,u=n.dilationWidth,c=n.dilationHeight,l=a.left,h=a.top,f=r*n.filterWidth,d=Aj();this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            int blockIndex = rc.y + col;\n            int pos = rc.x + row;\n\n            if(blockIndex >= "+t[1]+" || pos >= "+t[0]+") continue;\n\n            int offsetY = int(blockIndex / ("+s+")) * "+o+" - "+h+";\n            int d0 = offsetY + "+c+" * (pos / "+f+");\n\n            if(d0 >= "+e[0]+" || d0 < 0) continue;\n\n            int offsetX = int(mod(float(blockIndex), "+s+".) * "+i+". - "+l+".);\n            int d1 = offsetX + "+u+" * (int(mod(float(pos), "+f+".) / "+r+".));\n\n            if(d1 >= "+e[1]+" || d1 < 0) continue;\n\n            vec2 innerDims = vec2(d1, int(mod(float(pos), "+r+".)));\n            result[row * 2 + col] = getChannel(getA(d0, int(innerDims.x),\n                                              int(innerDims.y)), innerDims);\n          }\n        }\n\n        "+d.output+" = result;\n      }\n    "},QV=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},JV=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},ZV=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+a+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},tU=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eU=function(t,e,n,r,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var a=Math.ceil((n?t[1]:t[2])/2),s=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],l=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",f="";o&&(h="vec4 activation(vec4 x) {\n        "+o+"\n      }",f="result = activation(result);");var d=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+a+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+a+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+s+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          result += ("+c[0]+" * "+l[0]+") + ("+c[1]+" * "+l[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+d+"\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},nU=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),rU=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},iU=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Tj("rc",e),r=Mj(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),a=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),a=2;a<t;a++)o=e[e.length-1-a]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},oU=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Mj(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},aU=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=Mj(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Tj("rc",r),u=Tj("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",p=0,v=1===r?2:4;p<v;p++)d+="\n        "+h[p]+"\n        if ("+f+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(d+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},sU=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,d="0.0";if(f||(d="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+l+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(p="avgValue / count");var v=4*Math.floor(r/4),m=r%4,g="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+l+", "+h+");\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+d+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},uU=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",s="min"):"max"===e&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var d="";i%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},cU=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Rj(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Oj(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},lU=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},hU=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},fU=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],a=t[3];this.outputShape=[t[0],e,n,a];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+s[0]/u[0]+",\n          "+s[1]/u[1]+",\n          "+s[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(a-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},dU=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},pU=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},vU=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=Mj(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},mU=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Tj("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Mj(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},gU=function(t,e,n,r,i,o,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Mj(i.length),u=Mj(o.length),c="";1===n?c="i":2===n&&(c="i, j");var l="";1===r?l="i":2===r&&(l="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+l+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},yU=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},bU=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+o[u]),u<t&&a.push(""+o[u]);r=a.join(),i=s.join()}var c=Mj(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},_U=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=Mj(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return wU.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+wU[e]+" = start["+e+"] + coords."+wU[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),wU=["x","y","z","w","u","v"],xU=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=Mj(this.rank),n=Tj("coords",this.rank),r=Tj("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",a="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),CU=function(t,e,n,r){this.variableNames=["x"];var i=n.filter((function(t,e){return-1===r.indexOf(e)}));this.outputShape=i;var o=n.length,a=Mj(n.length),s=Mj(i.length),u="";if(1===o)u="coords * strides + begin";else{var c=0;u=n.map((function(t,e){return-1===r.indexOf(e)?(c++,1===i.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(c-1)+"] * strides["+e+"] + begin["+e+"]"):"begin["+e+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+t+");\n      "+a+" strides = "+a+"("+e+");\n\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+u+"));\n      }\n    "},kU=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=EU(e,n),o=SU(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),i===fV.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===fV.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===fV.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===fV.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===fV.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=SU(e,EU(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],a=o.indexOf(t);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function EU(t,e){if(t===hV.UPLOAD)return fV.PACKED_2X2_FLOAT32;if(t===hV.RENDER||null==t)return e?eM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?fV.PACKED_2X2_FLOAT32:fV.PACKED_2X2_FLOAT16:eM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?fV.UNPACKED_FLOAT32:fV.UNPACKED_FLOAT16;if(t===hV.DOWNLOAD||t===hV.PIXELS)return fV.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function SU(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var IU=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=Mj(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},TU=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=Mj(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},AU=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Mj(this.rank),o=Ij("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},RU=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},OU="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",NU="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",DU=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},PU=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=Tj("rc",e),r=Mj(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),a=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},MU={},FU=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!eM.getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=wF(eM.getNumber("WEBGL_VERSION"));this.binaryCache=(n=eM.getNumber("WEBGL_VERSION"))in MU?MU[n]:(MU[n]={},MU[n]),this.gpgpu=new XV(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new kU(this.gpgpu),this.numMBBeforeWarning=null==eM.global.screen?1024:eM.global.screen.height*eM.global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new QB(this,mF)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=[t.height,t.width],r=[t.height,t.width,e];if(eM.getBool("IS_BROWSER")){if(!(t instanceof HTMLVideoElement||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t.data instanceof Uint8Array))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(t instanceof HTMLVideoElement){if(null==this.fromPixels2DContext){if("complete"!==document.readyState)throw new Error("The DOM is not ready yet. Please call tf.browser.fromPixels() once the DOM is ready. One way to do that is to add an event listener for `DOMContentLoaded` on the document object");this.fromPixels2DContext=document.createElement("canvas").getContext("2d")}this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),t=this.fromPixels2DContext.canvas}}var i,o,a=this.makeTensorHandle(n,"int32");if(this.texData.get(a.dataId).usage=hV.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(a.dataId),t),eM.getBool("WEBGL_PACK")){i=new CV(r);var s=this.makePackedTensor(i.outputShape,a.dtype);o=this.compileAndRun(i,[a],s)}else i=new xV(r),o=this.compileAndRun(i,[a]);return this.disposeData(a.dataId),o},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(eM.getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!CF(r))throw Error("The value "+r+" cannot be represented on this device.")}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=hV.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var a=new RU(o,"return x;"),s=this.compileAndRun(a,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(s.dataId);return s.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var c,l,h=null!=this.activeTimers;return h&&(c=performance.now()),l="complex64"===r?pj(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=performance.now()-c),this.convertAndCacheOnCPU(t,l)},t.prototype.read=function(t){return QP(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y;return JP(this,(function(b){switch(b.label){case 0:if(this.pendingRead.has(t))return n=this.pendingRead.get(t),[2,new Promise((function(t){return n.push(t)}))];if(r=this.texData.get(t),i=r.values,o=r.shape,a=r.dtype,s=r.complexTensors,null!=r.slice)return u=new RU(o,"return x;"),c=this.compileAndRun(u,[{dataId:t,shape:o,dtype:a}]),l=this.read(c.dataId),c.dispose(),[2,l];if(null!=i)return[2,this.convertAndCacheOnCPU(t)];if(!eM.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===eM.getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==a&&eM.get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(t),t=f.dataId,d=this.texData.get(f.dataId),h=(e=this.gpgpu).createBufferFromTexture.apply(e,[d.texture].concat(IV(o)))),this.pendingRead.set(t,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:b.sent(),b.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return v=b.sent(),p=pj(v[0],v[1]),[3,5];case 4:null==h?p=this.getValuesFromTexture(t):(m=hM(o),p=this.gpgpu.downloadFloat32MatrixFromBuffer(h,m),this.disposeData(t)),b.label=5;case 5:return g=this.convertAndCacheOnCPU(t,p),y=this.pendingRead.get(t),this.pendingRead.delete(t),y.forEach((function(t){return t(g)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,g]}}))}))},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,a=r.isPacked,s=hM(i);if(eM.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),c=this.texData.get(u.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(IV(i))).subarray(0,s);return this.disposeData(u.dataId),l}var h=eM.getBool("WEBGL_PACK")&&!0===a,f=h?JF(i):i,d=this.makeTensorHandle(f,"float32");d.size=hM(i),this.texData.get(d.dataId).usage=hV.DOWNLOAD;var p=dL((function(){var e=h?new gV(f):new mV(f);return n.compileAndRun(e,[{shape:f,dtype:o,dataId:t}],d,null)})),v=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,s);return this.disposeData(d.dataId),m},t.prototype.time=function(t){return QP(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return JP(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=lM(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=lM(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return a=u.sent(),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:aM(a),getExtraProfileInfo:function(){return a.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,s]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},t.prototype.endTimer=function(t){return eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=performance.now(),t)},t.prototype.getQueryTime=function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){return eM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,a=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,a)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getCPUBackend=function(){return eM.getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=mF.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:mF.keep(t.clone()),imag:mF.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===hM(n))return PL([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=GB(t.shape,e,n);if(r||!i){var o=eM.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xU(n):new _U(n),a=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,a)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=ZM.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var a=KB(e,t.strides);r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,s+1),i},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s,u){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r,i,o,a,s,u);var c=WB(t.shape,e,n,r,i,o,a,s,u),l=c[0],h=c[1],f=c[2],d=h.filter((function(t,e){return-1===f.indexOf(e)}));if(d.some((function(t){return 0===t})))return PL([],d);var p=new CU(l,r,h,f);return this.compileAndRun(p,[t])},t.prototype.reverse=function(t,e){var n=eM.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mU(t.shape,e):new vU(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>eM.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(t.length/2),r=this.concat(t.slice(0,n),e),i=this.concat(t.slice(n),e);return this.concat([r,i],e)}if(eM.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var o=new Qj(t.map((function(t){return t.shape})),e);return this.compileAndRun(o,t)}var a=AL(t.map((function(t){return t.shape})),e),s=t.map((function(t){return t.as2D(-1,hM(t.shape.slice(e)))})),u=new Yj(s.map((function(t){return t.shape})));return this.compileAndRun(u,s).reshape(a)},t.prototype.neg=function(t){var e=new RU(t.shape,"return -x;");return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===o)&&a>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(s,a,1),c=1===o?2:1,l=1===o?e.as3D(s,1,a):e;return this.multiply(u,l).sum(c,!0)}var h=uF(t.dtype,e.dtype),f=new eU(t.shape,[s,i,o],n,r),d=this.makePackedTensor(f.outputShape,h);return this.compileAndRun(f,[t,e],d)},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var a=n?t.shape[2]:t.shape[1],s=r?e.shape[1]:e.shape[2],u=t.shape[0],c=uF(t.dtype,e.dtype),l=new eU(t.shape,[u,a,s],n,r,!!i,o?function(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?NU:OU;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}(o,!0):null),h=this.makePackedTensor(l.outputShape,c),f=[t,e];return i&&f.push(i),this.compileAndRun(l,f,h)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new zj("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new zj("return areal * bimag + aimag * breal;",t.shape,e.shape),a=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],s=this.compileAndRun(i,a),u=this.compileAndRun(o,a),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,qj,t.dtype);var l=new Hj(qj,t.shape,e.shape),h=this.makeOutputArray(l.outputShape,t.dtype);return this.compileAndRun(l,[t,e],h)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var a=[t,e,n],s=null;null!=o&&(s=o.shape,a.push(o));var u=null;if(null!=i&&(u=i.shape,a.push(i)),eM.getBool("WEBGL_PACK_NORMALIZATION")){var c=new Uj(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(c,a)}var l=new Vj(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,a)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=eM.getBool("WEBGL_PACK_NORMALIZATION")?new ZV(t.shape,e,n,r,i):new QV(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){var s=new JV(e.shape,r,i,o,a);return this.compileAndRun(s,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype)return wj(lB(t.shape,t.dtype,this.readSync(t.dataId)),e);var n=new IU(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.pad=function(t,e,n){var r=eM.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aU(t.shape,e,n):new oU(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=eM.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new AU(t.shape,e):new TU(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new kV(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){sM(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=MB(t.shape,e,r),o=FB(i.length,e.length),a=LB(t.shape,e,r),s=BB(n,e.length),u=jB(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){sM(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=MB(a.shape,e,r,!1),u=FB(s.length,e.length,!1),c=LB(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=UB(i),a=new uU({windowSize:o,inSize:i,batchSize:r},e),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],n);return this.compileAndRun(a,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=UB(i),a=new Sj({windowSize:o,inSize:i,batchSize:r},e,null==n),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],"int32"),c=[t];return null!=n&&c.push(n),this.compileAndRun(a,c,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=UB(r[r.length-1]),o=new Bj(r,i,e,null==n),a=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],a),a.rank===t.rank?this.argReducePacked(t,e,a):a},t.prototype.sum=function(t,e){kL("sum",e,t.rank);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i),a=cF(t.dtype);return this.reduce(o,"sum",a).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i),a=cF(t.dtype);return this.reduce(o,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=EL([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=IL(1,t.rank)[0]);var a=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),s=hM([o.shape[r]]),u=o.as2D(-1,s),c=cF(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(a);return null!=i&&(l=l.transpose(SL(i))),l},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],a=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=MM(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=MM(t,n+1);return n}(a,i),u=new yU({windowSize:s,inSize:a,batchSize:o,numSegments:i},e),c=u.outputShape,l=this.makeOutputArray([c[0],c[1]],r);return this.compileAndRun(u,[t,n],l),l.shape[1]===i?l:(n=qL(0,i).tile([a/s]),this.segOpCompute(l,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(kL("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!eM.getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=xL(t.shape,r),o=i[0],a=hM(i[1]),s=t.as2D(-1,a);return this.argReduce(s,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new cV(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new Hj("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Hj("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Hj("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Hj("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Hj("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Hj("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new RU(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Hj("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Hj("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new bU(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,uF(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){vL("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return Cj(t.shape,e)},t.prototype.topk=function(t,e,n){return xj(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){kL("min",e,t.rank);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Hj("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Hj("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);kL("max",e,t.rank);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Hj("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){kL("all",e,t.rank);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){kL("any",e,t.rank);var n=xL(t.shape,e),r=n[0],i=hM(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("return (a - b) * (a - b);",t.shape,e.shape):new Hj("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(b.x == 0.0) {\n    result.x = NAN;\n  } else if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(b.y == 0.0) {\n    result.y = NAN;\n  } else if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(b.z == 0.0) {\n    result.z = NAN;\n  } else if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(b.w == 0.0) {\n    result.w = NAN;\n  } else if(a.w == b.w) {\n    result.w = 1.;\n  }\n  \n  return result;\n","float32",!0);var n=new Hj("\nif (b == 0.0) {\n  return NAN;\n} \nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Hj("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a + b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=uF(t.dtype,e.dtype);if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a + b;",n);var r=new Hj("return a + b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new Gj(n,t.shape,e.shape,i),a=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],a)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),a=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],a=i[1],s=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,a),c=new Hj(n,t.shape,e.shape),l=r.makeOutputArray(c.outputShape,uF(o.dtype,a.dtype));return r.compileAndRun(c,[s,u],l)})),s=a[0],u=a[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>eM.get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return uF(t,e)})),o=t.map((function(t){return t.shape})),a=eM.getBool("WEBGL_PACK"),s=a?new Ej(t[0].shape,o):new kj(t[0].shape,o),u=a?this.makePackedTensor(s.outputShape,i):this.makeOutputArray(s.outputShape,i);return this.compileAndRun(s,t,u)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Wj);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=uF(t.dtype,e.dtype);if(eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Wj,t.dtype);var r=new Hj(Wj,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new Gj("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Hj("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=uF(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){var e=new RU(t.shape,"return ceil(x);");return this.compileAndRun(e,[t])},t.prototype.floor=function(t){var e=new RU(t.shape,"return floor(x);");return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new RU(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new RU(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new RU(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new RU(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new RU(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){var e;return e=eM.getBool("WEBGL_PACK")?new DU(t.shape,"return exp(x);"):new RU(t.shape,"return exp(x);"),this.compileAndRun(e,[t])},t.prototype.expm1=function(t){var e=new RU(t.shape,"return exp(x) - 1.0;");return this.compileAndRun(e,[t])},t.prototype.log=function(t){var e;return e=eM.getBool("WEBGL_PACK")?new DU(t.shape,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n"):new RU(t.shape,"if (x < 0.0) return NAN;\n  return log(x);"),this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new RU(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new RU(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new RU(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new RU(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new RU(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=eM.getBool("WEBGL_PACK")?new DU(t.shape,NU):new RU(t.shape,OU),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",t.shape,e.shape):new Hj("return (a < 0.) ? b * a : a;",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){var e=new RU(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new Hj("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new RU(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new RU(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=eM.getBool("WEBGL_PACK_CLIP")?new Xj(t.shape):new Kj(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){var e=new RU(t.shape,"return abs(x);");return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new $j(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new RU(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new RU(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new RU(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new RU(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new RU(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new RU(t.shape,"return asin(x);");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new RU(t.shape,"return acos(x);");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new RU(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gj("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Hj("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new RU(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new RU(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new RU(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new RU(t.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new RU(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new RU(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new RU(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new RU(t.shape,function(t){return void 0===t&&(t=0),"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n){var r=t.shape,i=this.texData.get(t.dataId),o=r[2]%2!=0&&!!i.isPacked;if((1==r[0]*r[1]*r[2]||1===n.outChannels)&&n.inChannels>1e3||!eM.getBool("WEBGL_LAZILY_UNPACK")||!eM.getBool("WEBGL_PACK_BINARY_OPERATIONS")||!o){var a=this.reshape(t,[1,r[0]*r[1]*r[2],n.inChannels]),s=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.batchMatMul(a,s,!1,!1),n.outShape)}var u=ZM.make([1,r[0]*r[1]*(r[2]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),c=i.shape;i.shape=i.shape.slice(),i.shape[i.shape.length-2]++,sM(eL(i.shape,u.shape),(function(){return"packed reshape "+i.shape+" to "+u.shape+" isn't free"}));var l=this.reshape(e,[1,n.inChannels,n.outChannels]),h=this.batchMatMul(u,l,!1,!1),f=this.texData.get(h.dataId);return sM(f.isPacked,(function(){return"batchMatMul result is expected to be packed"})),i.shape=c,f.shape=n.outShape,ZM.make(n.outShape,{dataId:h.dataId},h.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n){var r=n.outWidth,i=n.outHeight,o=n.filterWidth*n.filterHeight*n.inChannels,a=i*r,s=[o,a],u=t.squeeze([0]),c=e.reshape([1,o,-1]),l=new YV(s,u.shape,n),h=this.compileAndRun(l,[u]).reshape([1,s[0],s[1]]),f=new eU(h.shape,[1,a,n.outChannels],!0,!1);return this.compileAndRun(f,[h,c]).reshape([1,i,r,n.outChannels])},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(eM.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new iV(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new Zj(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new Jj(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r;return eM.getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new sV(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new aV(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new rV(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new nV(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new oV(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new eV(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new tV(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new sU(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new sU(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new sU(r,"max",!0),o=this.compileAndRun(i,[e]),a=new tU(r),s=this.makeOutputArray(a.outputShape,e.dtype),u=this.compileAndRun(a,[t,o],s);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new jj(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return hj(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||eL(t.shape,e)||null!==n.texture&&eL(n.shape,e)?fj(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=eM.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fU(t.shape,e,n,r):new hU(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new lU(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new pU(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new dU(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:$B(t),o=new nU(i.shape[0],i.shape[1],n),a=this.makeOutputArray(o.outputShape,"int32"),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],a,s)},t.prototype.oneHot=function(t,e,n,r){var i=new rU(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return vL("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),yj(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var a=new uV(t.shape,e.shape,r,i,o);return this.compileAndRun(a,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){sM(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,a=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),s=new vV("NHWC"===n?[r,i,o,a]:[r,a,i,o],e,n);return this.compileAndRun(s,[t])},t.prototype.split=function(t,e,n){return _j(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=zB(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/a,a],l=t.reshape([o,i]),h=e.reshape([o,a]);if(0===u)return fj(PL([]),n);var f=FL(0),d=new gU(o,i,l.rank,h.rank,s,c);return this.compileAndRun(d,[h,l,f]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=zB(0,t,n),o=new gU(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new _V("return real * expR - imag * expI;",t.shape,e),i=new _V("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],a=this.compileAndRun(r,o),s=this.compileAndRun(i,o),u=this.complex(a,s).as2D(t.shape[0],t.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=VB(t,e),o=i[0],a=i[1],s=i[2],u=i[3],c=e.reshape([a,r]),l=t.reshape([t.size/s,s]),h=new EV(r,u,[a,s]);return this.compileAndRun(h,[l,c]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||DM(e))){var r=xM(n,hM(t));return r.fill(e),ZM.make(t,{values:r},n)}var i=new wV(t,e),o=i.getCustomSetupFunc(e),a=this.makeOutputArray(t,n);return this.compileAndRun(i,[],a,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return dj(t,e,n)},t.prototype.makeOutputArray=function(t,e){return ZM.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=ZM.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new PU(t.shape);return this.compileAndRun(e,[t],ZM.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new iU(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([YF(t.shape)].concat(QF(t.shape))),r=[YF(e)].concat(QF(e)),i=new cU(r,n.shape);return this.compileAndRun(i,[n]).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,a=JF(i),s=IV(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=s.map((function(t){return 2*t})),e=r?new pV(a,s):new dV(a,s),this.compileAndRun(e,[{shape:a,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=wM(n.dtype,0),n;var a=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&hM(e.shape)<=eM.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!eL(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var s,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,a,u),l=this.getAndSaveBinary(c,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),a=o.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(t,e,n,r){var i=[];t.forEach((function(t){var e=hM(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,a,s=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+Aj().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=Aj();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],s=Aj();if(null!=i&&fM(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var s=Fj(e,n.slice(1));return"\n        "+t(s)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+Lj(["b","row","col"],[1,2])+");\n        }\n      "}var u=a[0],c=a[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return "+Aj().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],s=a[0],u=a[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",f="b * "+l+" + (row / 2) * "+c+" + (col / 2)",d=2;d<n-1;d++)h="int b"+d+", "+h,f="b"+d+" * "+(l*=e[n-d-1])+" + "+f;return"\n    vec4 "+i+"("+h+") {\n      int index = "+f+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+Aj().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+Dj(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Pj(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var a=Dj(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+a+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&fM(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var a=_M(n),s=a.newShape,u=a.keptDims;if(s.length<n.length){var c=Fj(e,s);return"\n      "+t(c)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+Lj(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+Pj(e)+"\n      }\n    ";var l=o[0],h=o[1],f=Dj(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===l?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+f+";\n    vec2 uv = uvFromFlat("+l+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],s=_M(n),u=s.newShape,c=s.keptDims;if(u.length<n.length){var l=Fj(e,u);return"\n        "+t(l)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+Lj(["row","col","depth"],c)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+a+", 1)));\n        "+Pj(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,f=h[0],d=h[1],p=e.shapeInfo.flatOffset;return d===o&&null==p?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+f+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":d===a&&null==p?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+f+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+a+" + depth + "+Dj(r)+";\n        vec2 uv = uvFromFlat("+f+", "+d+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,s=n[1]*a,u=_M(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=Fj(e,c);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+Lj(["row","col","depth","depth2"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+a+", "+o+", 1)));\n        "+Pj(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],v=d[1];return v===s&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":v===o&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+v+", index + "+Dj(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],a=n[3]*o,s=n[2]*a,u=n[1]*s,c=_M(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var f=Fj(e,l);return"\n      "+t(f)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+Lj(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+s+", "+a+", "+o+")) +\n          depth3;\n        "+Pj(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],m=p[1];return m===u&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+s+", "+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" + depth * "+a+" +\n          depth2 * "+o+" + depth3 + "+Dj(r)+";\n      vec2 uv = uvFromFlat("+v+", "+m+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=_M(n),a=o.newShape,s=o.keptDims;if(a.length<n.length){var u=Fj(e,a);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+Lj(["row","col","depth","depth2","depth3","depth4"],s)+");\n      }\n    "}var c=n[5],l=n[4]*c,h=n[3]*l,f=n[2]*h,d=n[1]*f;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+f+", "+h+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+Pj(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],g=v[1];return g===d&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+f+", "+h+", "+l+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===c&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+f+" + depth * "+h+" +\n          depth2 * "+l+" + depth3 * "+c+" + depth4 + "+Dj(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),a="get"+o+"AtOutCoords",s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c=JB(t.shapeInfo.logicalShape,e.logicalShape),l=Mj(u),h=u-s,f=["x","y","z","w","u","v"];n=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords."+f[t+h]+" = 0;"})).join("\n"),r=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+f[e+h]})).join(", ");var d="return outputValue;",p=1===hM(t.shapeInfo.logicalShape),v=1===hM(e.logicalShape);if(1!==s||p||v){if(p&&!v)d=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var m=s-2,g=s-1;c.indexOf(m)>-1&&c.indexOf(g)>-1?d="return vec4(outputValue.x);":c.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(g)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+d+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===a&&null==t.shapeInfo.flatOffset&&fM(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var s=Mj(a),u=JB(t.shapeInfo.logicalShape,e.logicalShape),c=a-o,l=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+s+" coords = getOutputCoords();\n      "+(0===o?"":a<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+l[t+c]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(a<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+l[e+c]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=Aj(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),f=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    #define isnan(value) isnan_custom(value)\n    "+t.defineSpecialNaN+"\n    bvec4 isnan_custom(vec4 val) {\n      return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n    }\n\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  "}(l);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(fM(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,a="",s="b, r, c",u=2;u<t.length-1;u++)a="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,o,a}(e.logicalShape,c),a=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return fM(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=Rj(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=Rj(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=Rj(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=Rj(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),a=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(f+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[f,h,a,s,o,u,n].join("\n")}(o,s,i,e.usesPackedTextures),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===eM.getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var f={},d=0;d<e.variableNames.length;d++){var p=e.variableNames[d];f[p]=t.getUniformLocation(c,p,!1),f["offset"+p]=t.getUniformLocation(c,"offset"+p,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:f,inShapeInfos:a,outShapeInfo:s,infLoc:l,nanLoc:h}}(o.gpgpu,t,a,u)})),h=null!=this.activeTimers;return h&&(s=this.startTimer()),function(t,e,n,r,i){$V(e.inShapeInfos,n),$V([e.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===eM.getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],a=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(hM(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(o,s)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,l,a,u,r),h&&(s=this.endTimer(s),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(s)})),!eM.getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&null!=this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=dL((function(){var e=eM.getBool("DEBUG");eM.set("DEBUG",!1);var n=t.abs(FL(1e-8)).dataSync()[0];return eM.set("DEBUG",e),n>0?32:16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,a=n.usage,s=n.isPacked;if(null==n.texture){var u,c=null!=this.activeTimers;c&&(u=performance.now());var l=n.texShape;if(null==l&&(l=ZF(r,s),n.texShape=l),null!=o){var h=JF(r),f=void 0,d=l[1],p=l[0],v=o instanceof Uint8Array;s?(d=(e=TV(l[0],l[1]))[0],f=new bV(h,[p=e[1],d],v)):f=new yV(h,[p,d],v);var m=this.makeTensorHandle([p,d],i);this.texData.get(m.dataId).usage=v?hV.PIXELS:hV.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(m.dataId),d,p,o);var g=this.makeTensorHandle(f.outputShape,m.dtype);g.size=hM(f.outputShape),this.texData.get(g.dataId).isPacked=s,this.compileAndRun(f,[m],g);var y=this.texData.get(g.dataId);n.texture=y.texture,n.texShape=y.texShape,n.isPacked=y.isPacked,n.usage=y.usage,this.disposeData(m.dataId),this.texData.delete(g.dataId),n.values=null,c&&(this.uploadWaitMs+=performance.now()-u)}else{var b=this.acquireTexture(l,a,i,s);n.texture=b}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*TM(e)},t}();gF()&&mF.registerBackend("webgl",(function(){return new FU}),2);var LU=RL({abs_:function(t){var e=yL(t,"x","abs");return"complex64"===e.dtype?mF.runKernel((function(t){return t.complexAbs(e)}),{$x:e}):mF.runKernel((function(t,n){var r=t.abs(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}}))}}),BU=RL({acos_:function(t){var e=yL(t,"x","acos");return mF.runKernel((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(FL(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),jU=RL({acosh_:function(t){var e=yL(t,"x","acosh");return mF.runKernel((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),VU=RL({asin_:function(t){var e=yL(t,"x","asin");return mF.runKernel((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(FL(1).sub(n.toFloat().square()).sqrt())}}}))}}),UU=RL({asinh_:function(t){var e=yL(t,"x","asinh");return mF.runKernel((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(FL(1).add(n.toFloat().square()).sqrt())}}}))}}),zU=RL({atan_:function(t){var e=yL(t,"x","atan");return mF.runKernel((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),WU=RL({atanh_:function(t){var e=yL(t,"x","atanh");return mF.runKernel((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(FL(1).sub(n.toFloat().square()))}}}))}}),qU=RL({ceil_:function(t){var e=yL(t,"x","ceil");return mF.runKernel((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),HU=RL({clipByValue_:function(t,e,n){var r=yL(t,"x","clipByValue");return sM(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),mF.runKernel((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{$x:r},(function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),GL(t))}}}))}}),GU=RL({cos_:function(t){var e=yL(t,"x","cos");return mF.runKernel((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),KU=RL({cosh_:function(t){var e=yL(t,"x","cosh");return mF.runKernel((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),XU=RL({erf_:function(t){var e=yL(t,"x","erf");return sM("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),mF.runKernel((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),$U=RL({exp_:function(t){var e=yL(t,"x","exp");return mF.runKernel((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),YU=RL({expm1_:function(t){var e=yL(t,"x","expm1");return mF.runKernel((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),QU=RL({floor_:function(t){var e=yL(t,"x","floor");return mF.runKernel((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),JU=RL({log_:function(t){var e=yL(t,"x","log");return mF.runKernel((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),ZU=RL({log1p_:function(t){var e=yL(t,"x","log1p");return mF.runKernel((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),tz=RL({logSigmoid_:function(t){var e=yL(t,"x","logSigmoid");return mF.runKernel((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),ez=RL({neg_:function(t){var e=yL(t,"x","neg");return mF.runKernel((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),nz=RL({reciprocal_:function(t){var e=yL(t,"x","reciprocal");return mF.runKernel((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),rz=RL({round_:function(t){var e=yL(t,"x","round");return mF.runKernel((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),iz=RL({rsqrt_:function(t){var e=yL(t,"x","rsqrt");return mF.runKernel((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),oz=RL({sigmoid_:function(t){var e=yL(t,"x","sigmoid");return mF.runKernel((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(FL(1).sub(n)))}}}))}}),az=RL({sign_:function(t){var e=yL(t,"x","sign");return mF.runKernel((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),sz=RL({isNaN_:function(t){var e=yL(t,"x","isNaN");return mF.runKernel((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),uz=RL({isInf_:function(t){var e=yL(t,"x","isInf");return mF.runKernel((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),cz=RL({isFinite_:function(t){var e=yL(t,"x","isFinite");return mF.runKernel((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return GL(t)}}}))}}),lz=RL({sin_:function(t){var e=yL(t,"x","sin");return mF.runKernel((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),hz=RL({sinh_:function(t){var e=yL(t,"x","sinh");return mF.runKernel((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),fz=RL({softplus_:function(t){var e=yL(t,"x","softplus");return mF.runKernel((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),dz=RL({sqrt_:function(t){var e=yL(t,"x","sqrt");return mF.runKernel((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),pz=RL({square_:function(t){var e=yL(t,"x","square");return mF.runKernel((function(t,n){return n([e]),t.square(e)}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}}))}}),vz=RL({step_:function(t,e){void 0===e&&(e=0);var n=yL(t,"x","step");return mF.runKernel((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return GL(t)}}}))}}),mz=RL({tan_:function(t){var e=yL(t,"x","tan");return mF.runKernel((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),gz=RL({tanh_:function(t){var e=yL(t,"x","tanh");return mF.runKernel((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return FL(1).sub(n.square()).mulStrict(t)}}}))}});function yz(t,e,n,r,i,o){var a,s,u=yL(t,"x","batchNorm"),c=yL(e,"mean","batchNorm"),l=yL(n,"variance","batchNorm");return null!=i&&(a=yL(i,"scale","batchNorm")),null!=r&&(s=yL(r,"offset","batchNorm")),sM(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),sM(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),sM(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=a&&sM(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&sM(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),wz(u,c,l,s,a,o)}function bz(t,e,n,r,i,o){var a,s,u=yL(t,"x","batchNorm"),c=yL(e,"mean","batchNorm"),l=yL(n,"variance","batchNorm");return null!=i&&(a=yL(i,"scale","batchNorm")),null!=r&&(s=yL(r,"offset","batchNorm")),sM(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),sM(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),sM(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=a&&sM(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&sM(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),wz(u,c,l,s,a,o)}function _z(t,e,n,r,i,o){var a,s,u=yL(t,"x","batchNorm"),c=yL(e,"mean","batchNorm"),l=yL(n,"variance","batchNorm");return null!=i&&(a=yL(i,"scale","batchNorm")),null!=r&&(s=yL(r,"offset","batchNorm")),sM(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),sM(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),sM(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=a&&sM(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&sM(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),wz(u,c,l,s,a,o)}function wz(t,e,n,r,i,o){null==o&&(o=.001);var a,s,u,c=yL(t,"x","batchNorm"),l=yL(e,"mean","batchNorm"),h=yL(n,"variance","batchNorm");return null!=i&&(a=yL(i,"scale","batchNorm")),null!=r&&(s=yL(r,"offset","batchNorm")),sM(l.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),sM(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),sM(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,mF.runKernel((function(t,e){var n=t.batchNormalization(u,xz(l),xz(h),o,xz(a),xz(s));return e([c,l,h,a]),n}),{$x:c,$mean:l,$variance:h,$scale:a,$offset:s},(function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=null==a?FL(1):a,c=ZB(r.shape,u.shape),l=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)l.push(u.shape[h]);l.push(1)}var f=n.sub(r),d=t.mul(s),p=iz(i.add(FL(o))),v=p.mul(p).mul(p).mul(FL(-.5));return{$x:function(){return 1===r.rank?t.mul(NB(p.as4D(1,1,1,r.shape[0]),l)).mul(s).reshape(n.shape):t.mul(p).mul(s).reshape(n.shape)},$mean:function(){var t=p.mul(FL(-1)).mul(d);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$variance:function(){var t=v.mul(f).mul(d);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$scale:function(){var e=f.mul(p),n=t.mul(e);return 1===r.rank&&(n=n.sum(c)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(c)),e.reshape(r.shape)}}})).reshape(c.shape)}function xz(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Cz(){fL("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var kz=RL({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Cz(),yz(t,e,n,o,i,r)}}),Ez=RL({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Cz(),bz(t,e,n,o,i,r)}}),Sz=RL({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Cz(),_z(t,e,n,o,i,r)}}),Iz=RL({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Cz(),wz(t,e,n,o,i,r)}}),Tz=RL({batchNorm_:wz}),Az=RL({batchNorm2d_:yz}),Rz=RL({batchNorm3d_:bz}),Oz=RL({batchNorm4d_:_z});function Nz(t,e,n,r,i,o){sM(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var a=t,s=e,u=!1;3===e.rank&&(u=!0,s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,t[0],t[1],t[2]]);var c=a[3],l=s.shape[3];sM(4===a.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."})),sM(4===s.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+s.rank})),sM(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank})),sM(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."})),sM(l===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&sM(dM(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=nj(a,n.shape,r,1,i,o),f=mF.runKernel((function(t,e){var r=t.conv2dDerInput(s,n,h);return e([n,s]),r}),{dy4D:s,filter:n},(function(t,e){var n=e[0],a=e[1];return{dy4D:function(){return Fz(t,n,r,i,"NHWC",1,o)},filter:function(){return Bz(t,a,n.shape,r,i,o)}}}));return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function Dz(t,e,n,r,i,o){var a=t;3===t.rank&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=e;3===s.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),sM(4===a.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."})),sM(4===s.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+s.shape+"."})),sM(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."})),sM(a.shape[3]===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+a.shape[3]+") must match input depth in filter ("+n[2]+"."})),sM(s.shape[3]===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+s.shape[3]+") must match output depth for filter ("+n[3]+")."})),null!=o&&sM(dM(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var u=nj(a.shape,n,r,1,i,o);return mF.runKernel((function(t){return t.conv2dDerFilter(a,s,u)}),{x4D:a,dy4D:s})}function Pz(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}var Mz=RL({conv1d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NWC"),void 0===o&&(o=1);var s=yL(t,"x","conv1d"),u=yL(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),sM(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),sM(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&sM(dM(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),sM(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),sM(lj(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),sM("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),d=Fz(f,h,[1,n],r,"NHWC",[1,o],a);return l?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),Fz=RL({conv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=yL(t,"x","conv2d"),u=yL(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),sM(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),sM(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&sM(dM(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),sM(c.shape[3]===u.shape[2],(function(){return"Error in conv2d: depth of input ("+c.shape[3]+") must match input depth for filter "+u.shape[2]+"."})),sM(lj(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),sM("NHWC"===i,(function(){return"Error in conv2d: got dataFormat of "+i+" but only NHWC is currently supported."}));var h=nj(c.shape,u.shape,n,o,r,a),f=mF.runKernel((function(t,e){var n=t.conv2d(c,u,h);return e([u,c]),n}),{x:c,$filter:u},(function(t,e){var i=e[0],a=e[1];return sM(cj(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return Nz(a.shape,t,i,n,r)},$filter:function(){return Dz(a,t,i.shape,n,r)}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),Lz=RL({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var a=yL(t,"x","conv3d"),s=yL(e,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),sM(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),sM(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),sM(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),sM(function(t,e){return Pz(t)||Pz(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),sM("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=rj(u.shape,s.shape,n,o,r),h=mF.runKernel((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){sM(Pz(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],a=e[1];return{x:function(){return function(t,e,n,r,i){sM(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,a=e,s=!1;4===e.rank&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],c=a.shape[4];sM(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),sM(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),sM(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),sM(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),sM(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=rj(o,n.shape,r,1,i),h=mF.runKernel((function(t){return t.conv3dDerInput(a,n,l)}),{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}(i.shape,t,a,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var a=e;4===a.rank&&(a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),sM(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),sM(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),sM(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),sM(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),sM(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=rj(o.shape,n,r,1,i);return mF.runKernel((function(t){return t.conv3dDerFilter(o,a,s)}),{x5D:o,dy5D:a})}(i,t,a.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Bz=RL({conv2dDerFilter_:Dz}),jz=RL({depthwiseConv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=yL(t,"x","depthwiseConv2d"),u=yL(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),sM(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),sM(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),sM(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),sM(lj(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&sM(dM(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h=nj(c.shape,u.shape,n,o,r,a,!0),f=mF.runKernel((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,$filter:u},(function(t,e){sM(cj(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=mF.runKernel((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}(0,t,r,h)},$filter:function(){return function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),mF.runKernel((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}(n,t,0,h)}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),Vz=RL({separableConv2d_:function(t,e,n,r,i,o,a){void 0===o&&(o=[1,1]),void 0===a&&(a="NHWC");var s=yL(t,"x","separableConv2d"),u=yL(e,"depthwiseFilter","separableConv2d"),c=yL(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");sM(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),sM(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),sM(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),sM(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),sM(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var f=u.shape[2],d=u.shape[3];sM(c.shape[2]===f*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*d+", but got "+c.shape[2]+"."}));var p=jz(l,u,r,i,a,o),v=Fz(p,c,1,"valid",a);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Uz=RL({conv2dTranspose_:function(t,e,n,r,i,o){return Nz(n,yL(t,"x","conv2dTranspose"),yL(e,"filter","conv2dTranspose"),r,i,o)}}),zz=RL({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=yL(t,"a","matMul"),a=yL(e,"b","matMul");i=lF(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),f=a.shape.slice(0,-2),d=hM(h),p=hM(f);sM(o.rank>=2&&a.rank>=2&&o.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."})),sM(fM(h,f),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."})),sM(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=o.shape.slice(0,-2).concat([c,l]),m=n?o.as3D(d,s,c):o.as3D(d,c,s),g=r?a.as3D(p,l,u):a.as3D(p,u,l);return mF.runKernel((function(t,e){var i=t.batchMatMul(m,g,n,r);return e([m,g]),i}),{$a:m,$b:g},(function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}})).reshape(v)}}),Wz=RL({dot_:function(t,e){var n=yL(t,"t1","dot"),r=yL(e,"t2","dot");sM(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return sM(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),qz=RL({outerProduct_:function(t,e){var n=yL(t,"v1","outerProduct"),r=yL(e,"v2","outerProduct");return sM(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Hz=RL({reverse_:function(t,e){var n=yL(t,"x","reverse");if(0===n.rank)return n.clone();var r=bM(e,n.shape);return mF.runKernel((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),Gz=RL({reverse1d_:function(t){var e=yL(t,"x","reverse");return sM(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Hz(e,0)}}),Kz=RL({reverse2d_:function(t,e){var n=yL(t,"x","reverse");return sM(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Hz(n,e)}}),Xz=RL({reverse3d_:function(t,e){var n=yL(t,"x","reverse");return sM(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Hz(n,e)}}),$z=RL({reverse4d_:function(t,e){var n=yL(t,"x","reverse");return sM(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Hz(n,e)}});function Yz(t,e,n,r,i,o){var a=yL(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),sM(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),sM(lj(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&sM(dM(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=ej(s.shape,e,n,r,i,o),l=mF.runKernel((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,o){var a=o[0],s=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=yL(t,"dy","maxPoolBackprop"),c=yL(e,"input","maxPoolBackprop"),l=yL(n,"output","maxPoolBackprop");sM(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),sM(lj(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),sM(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),sM(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var h=ej(c.shape,r,i,o,a,void 0);return mF.runKernel((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,a,s,e,n,r,i)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function Qz(t,e,n,r,i,o){var a=yL(t,"x","avgPool","float32");null==r&&(r=[1,1]),sM(lj(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),sM(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=o&&sM(dM(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=ej(s.shape,e,n,r,i,o),l=mF.runKernel((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,o){var a=yL(t,"dy","avgPoolBackprop"),s=yL(e,"input","avgPoolBackprop");sM(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==i&&(i=[1,1]),sM(lj(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,c=a,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),sM(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),sM(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=ej(u.shape,n,r,i,o),f=mF.runKernel((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}(t,s,e,n,r,i)}}}));return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Jz=RL({maxPool_:function(t,e,n,r,i){return Yz(t,e,n,1,r,i)}}),Zz=RL({avgPool_:function(t,e,n,r,i){return Qz(t,e,n,1,r,i)}}),tW=RL({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var a=yL(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),sM(lj(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var c,l=ej(s.shape,e,o,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],d=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),a=e.map((function(t,e){return(t-o[e]%t)%t})),s=i.map((function(t,e){return t+a[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,a[e]]}))]}([l.inHeight,l.inWidth],h,c),p=d[1],v=f?r:"valid",m=f?s:AB(s,h,d[0]),g=("avg"===n?function(){return Qz(m,e,o,1,v)}:function(){return Yz(m,e,o,1,v)})(),y=f?g:hB(g,h,p);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),eW=RL({slice_:function(t,e,n){var r,i,o=yL(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice(),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(sM(-1===t,(function(){return"Bad value in size"})),o.shape[e]-r[e])})),function(t,e,n){sM(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),sM(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){sM(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}(o,r,i);var a=o.shape;return mF.runKernel((function(t){return t.slice(o,r,i)}),{$x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],a[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}}))}}),nW=RL({slice1d_:function(t,e,n){var r=yL(t,"x","slice1d");return sM(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),eW(r,[e],[n])}}),rW=RL({slice2d_:function(t,e,n){var r=yL(t,"x","slice2d");return sM(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),eW(r,e,n)}}),iW=RL({slice3d_:function(t,e,n){var r=yL(t,"x","slice3d");return sM(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),eW(r,e,n)}}),oW=RL({slice4d_:function(t,e,n){var r=yL(t,"x","slice4d");return sM(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),eW(r,e,n)}});function aW(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(CL(e.shape,r))),t.rank<n.rank&&(t=t.reshape(CL(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var sW=RL({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","all","bool"),i=bM(e,r.shape),o=i,a=EL(o,r.rank);null!=a&&(r=r.transpose(a),o=IL(o.length,r.rank));var s=mF.runKernel((function(t){return t.all(r,o)}),{$x:r});if(n){var u=CL(s.shape,i);return s.reshape(u)}return s}}),uW=RL({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","any","bool"),i=bM(e,r.shape),o=i,a=EL(o,r.rank);null!=a&&(r=r.transpose(a),o=IL(o.length,r.rank));var s=mF.runKernel((function(t){return t.any(r,o)}),{$x:r});if(n){var u=CL(s.shape,i);return s.reshape(u)}return s}}),cW=RL({argMax_:function(t,e){void 0===e&&(e=0);var n=yL(t,"x","argMax");null==e&&(e=0);var r=bM(e,n.shape),i=EL(r,n.rank);return null!=i&&(n=n.transpose(i),r=IL(r.length,n.rank)),mF.runKernel((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return GL(n)}}}))}}),lW=RL({argMin_:function(t,e){void 0===e&&(e=0);var n=yL(t,"x","argMin");null==e&&(e=0);var r=bM(e,n.shape),i=EL(r,n.rank);return null!=i&&(n=n.transpose(i),r=IL(r.length,n.rank)),mF.runKernel((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return GL(n)}}}))}}),hW=RL({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","logSumExp"),i=bM(e,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=CL(s.shape,i);return s.reshape(u)}return s}}),fW=RL({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","max"),i=r,o=bM(e,r.shape),a=o,s=EL(a,r.rank);null!=s&&(r=r.transpose(s),a=IL(a.length,r.rank));var u=mF.runKernel((function(t,e){var n=t.max(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return aW(t,e[1],e[0],o,s)}));if(n){var c=CL(u.shape,o);u=u.reshape(c)}return u}}),dW=RL({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","mean"),i=bM(e,r.shape),o=hM(xL(r.shape,i)[1]);return XB((function(t){var r=FL(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(UL(t.shape,"float32")).div(o)}}}))(r)}}),pW=RL({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","min"),i=r,o=bM(e,r.shape),a=o,s=EL(a,r.rank);null!=s&&(r=r.transpose(s),a=IL(a.length,r.rank));var u=mF.runKernel((function(t,e){var n=t.min(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return aW(t,e[1],e[0],o,s)}));if(n){var c=CL(u.shape,o);u=u.reshape(c)}return u}}),vW=RL({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=bM(e,(t=yL(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=CL(i.shape,r));var a=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),mW=RL({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=bM(e,r.shape);return XB((function(t){var e=EL(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=IL(r.length,t.rank));var a=mF.runKernel((function(t){return t.sum(o,r)}),{permutedX:o});if(n){var s=CL(a.shape,i);a=a.reshape(s)}return{value:a,gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(UL(t.shape,"float32"))}}}))(r)}}),gW=RL({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=yL(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=bM(e,r.shape),o=EL(i,r.rank),a=i,s=r;null!=o&&(s=r.transpose(o),a=IL(a.length,r.rank));var u=mF.runKernel((function(t){return t.prod(s,a)}),{permutedX:s});if(n){var c=CL(u.shape,i);u=u.reshape(c)}return u}}),yW=RL({equal_:function(t,e){var n,r=yL(t,"a","equal"),i=yL(e,"b","equal");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),bW=RL({equalStrict_:function(t,e){var n=yL(t,"a","equalStrict"),r=yL(e,"b","equalStrict");return uM(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),_W=RL({greater_:function(t,e){var n,r=yL(t,"a","greater"),i=yL(e,"b","greater");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t){return t.greater(r,i)}),{$a:r,$b:i})}}),wW=RL({greaterEqual_:function(t,e){var n,r=yL(t,"a","greaterEqual"),i=yL(e,"b","greaterEqual");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return GL(n)},$b:function(){return GL(r)}}}))}}),xW=RL({greaterEqualStrict_:function(t,e){var n=yL(t,"a","greaterEqualStrict"),r=yL(e,"b","greaterEqualStrict");return uM(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),CW=RL({greaterStrict_:function(t,e){var n=yL(t,"a","greaterStrict"),r=yL(e,"b","greaterStrict");return uM(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),kW=RL({less_:function(t,e){var n,r=yL(t,"a","less"),i=yL(e,"b","less");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t){return t.less(r,i)}),{$a:r,$b:i})}}),EW=RL({lessEqual_:function(t,e){var n,r=yL(t,"a","lessEqual"),i=yL(e,"b","lessEqual");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t){return t.lessEqual(r,i)}),{$a:r,$b:i})}}),SW=RL({lessEqualStrict_:function(t,e){var n=yL(t,"a","lessEqualStrict"),r=yL(e,"b","lessEqualStrict");return uM(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),IW=RL({lessStrict_:function(t,e){var n=yL(t,"a","lessStrict"),r=yL(e,"b","lessStrict");return uM(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),TW=RL({notEqual_:function(t,e){var n,r=yL(t,"a","notEqual"),i=yL(e,"b","notEqual");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t){return t.notEqual(r,i)}),{$a:r,$b:i})}}),AW=RL({notEqualStrict_:function(t,e){var n=yL(t,"a","notEqualStrict"),r=yL(e,"b","notEqualStrict");return uM(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),RW=RL({add_:function(t,e){var n,r=yL(t,"a","add"),i=yL(e,"b","add");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t){return t.add(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=ZB(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=ZB(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}))}}),OW=RL({addN_:function(t){sM(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),sM(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return yL(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!fM(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),mF.runKernel((function(t){return t.addN(e)}),e,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),NW=RL({addStrict_:function(t,e){var n=yL(t,"a","addStrict"),r=yL(e,"b","addStrict");return uM(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),DW=RL({atan2_:function(t,e){var n,r=yL(t,"a","atan2"),i=yL(e,"b","atan2");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=RW(n.square(),r.square()),i=t.mul(r.div(e)),a=ZB(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var e=RW(n.square(),r.square()),i=ez(t.mul(n.div(e))),a=ZB(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}}))}}),PW=RL({div_:function(t,e){var n,r=yL(t,"a","div"),i=yL(e,"b","div");if(n=lF(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return FW(r,i);var o=tj(r.shape,i.shape);return mF.runKernel((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=ZB(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=ZB(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),MW=RL({divStrict_:function(t,e){var n=yL(t,"a","div"),r=yL(e,"b","div");return uM(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),FW=RL({floorDiv_:function(t,e){var n,r=yL(t,"a","floorDiv"),i=yL(e,"b","floorDiv");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=ZB(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=ZB(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),LW=RL({maximum_:function(t,e){var n,r=yL(t,"a","maximum"),i=yL(e,"b","maximum");return n=lF(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),tj(r.shape,i.shape),mF.runKernel((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),BW=RL({maximumStrict_:function(t,e){var n=yL(t,"a","maximumStrict"),r=yL(e,"b","maximumStrict");return uM(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),jW=RL({minimum_:function(t,e){var n,r=yL(t,"a","minimum"),i=yL(e,"b","minimum");return n=lF(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),tj(r.shape,i.shape),mF.runKernel((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),VW=RL({minimumStrict_:function(t,e){var n=yL(t,"a","minimumStrict"),r=yL(e,"b","minimumStrict");return uM(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),UW=RL({mod_:function(t,e){var n,r=yL(t,"a","mod"),i=yL(e,"b","mod");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=ZB(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=ZB(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),zW=RL({modStrict_:function(t,e){var n=yL(t,"a","modStrict"),r=yL(e,"b","modStrict");return uM(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),WW=RL({mul_:function(t,e){var n,r=yL(t,"a","mul"),i=yL(e,"b","mul");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=ZB(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=ZB(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),qW=RL({mulStrict_:function(t,e){var n=yL(t,"a","mul"),r=yL(e,"b","mul");return uM(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),HW=RL({pow_:function(t,e){var n=yL(t,"base","pow"),r=yL(e,"exp","pow"),i=tj(n.shape,r.shape);return t=n.cast(uF(n.dtype,r.dtype)),e=r.cast(uF(n.dtype,r.dtype)),mF.runKernel((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(FL(1))))),a=ZB(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),a=n.log().where(e,GL(n)),s=t.mul(o.mul(a)),u=ZB(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}))}}),GW=RL({powStrict_:function(t,e){return uM(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),KW=RL({squaredDifference_:function(t,e){var n,r=yL(t,"a","squaredDifference"),i=yL(e,"b","squaredDifference");return n=lF(r,i),tj((r=n[0]).shape,(i=n[1]).shape),mF.runKernel((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1],i=FL(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}}))}}),XW=RL({squaredDifferenceStrict_:function(t,e){var n=yL(t,"a","squaredDifferenceStrict"),r=yL(e,"b","squaredDifferenceStrict");return uM(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),$W=RL({sub_:function(t,e){var n,r=yL(t,"a","sub"),i=yL(e,"b","sub");n=lF(r,i);var o=tj((r=n[0]).shape,(i=n[1]).shape);return mF.runKernel((function(t){return t.subtract(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=ZB(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=ZB(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}))}}),YW=RL({subStrict_:function(t,e){var n=yL(t,"a","subStrict"),r=yL(e,"b","subStrict");return uM(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),QW=RL({logicalAnd_:function(t,e){var n=yL(t,"a","logicalAnd","bool"),r=yL(e,"b","logicalAnd","bool");return tj(n.shape,r.shape),mF.runKernel((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),JW=RL({logicalNot_:function(t){var e=yL(t,"x","logicalNot","bool");return mF.runKernel((function(t){return t.logicalNot(e)}),{$x:e})}}),ZW=RL({logicalOr_:function(t,e){var n=yL(t,"a","logicalOr","bool"),r=yL(e,"b","logicalOr","bool");return tj(n.shape,r.shape),mF.runKernel((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),tq=RL({logicalXor_:function(t,e){var n=yL(t,"a","logicalXor","bool"),r=yL(e,"b","logicalXor","bool");return tj(n.shape,r.shape),ZW(t,e).logicalAnd(QW(t,e).logicalNot())}}),eq=RL({where_:function(t,e,n){var r=yL(e,"a","where"),i=yL(n,"b","where"),o=yL(t,"condition","where","bool");return uM(r.shape,i.shape,"Error in where: "),1===o.rank?sM(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):uM(o.shape,i.shape,"Error in where: "),mF.runKernel((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return GL(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),nq=RL({elu_:function(t){var e=yL(t,"x","elu");return mF.runKernel((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return mF.runKernel((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),rq=RL({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=yL(t,"x","leakyRelu");return LW(FL(e).mul(n),n)}}),iq=RL({prelu_:function(t,e){var n=yL(t,"x","prelu"),r=yL(e,"alpha","prelu");return mF.runKernel((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{$x:n,$alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return eq(i,t,t.mul(r))},$alpha:function(){var e=eq(i,GL(t),t.mul(n)),o=ZB(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}))}}),oq=RL({relu_:function(t){var e=yL(t,"x","relu");return"bool"===e.dtype?e.toInt():mF.runKernel((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),aq=RL({selu_:function(t){var e=yL(t,"x","selu");return mF.runKernel((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(FL(0)),r=FL(1.7580993408473768),i=FL(1.0507009873554805),o=t.mul(i),a=t.mul(r).mul(n.toFloat().exp());return eq(e,o,a)}}}))}}),sq=RL({transpose_:function(t,e){var n=yL(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),sM(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){sM(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():mF.runKernel((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=SL(e);return{$x:function(){return t.transpose(n)}}}))}}),uq=RL({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=yL(t,"x","localResponseNormalization");sM(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),sM(dM(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var a=o,s=!1;3===o.rank&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=mF.runKernel((function(t,o){var s=t.localResponseNormalization4D(a,e,n,r,i);return o([a,s]),s}),{x4D:a},(function(t,o){var a=o[0],s=o[1];return{x4D:function(){return mF.runKernel((function(o){return o.LRNGrad(t,a,s,e,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),cq=RL({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(FL(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=yL(t,"x","norm"),e,n),o=i.shape;if(r){var a=bM(n,t.shape);o=CL(i.shape,a)}return i.reshape(o)}});function lq(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function hq(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var fq=RL({gather_:function(t,e,n){void 0===n&&(n=0);var r=yL(t,"x","gather"),i=yL(e,"indices","gather","int32");n=bM(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,a=1,s=0;s<n;s++)i.push(t.shape[s]),o*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),a*=t.shape[s];return{batchSize:o,sliceSize:a,dimSize:r,outputShape:i}}(r,i,n);return mF.runKernel((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{$x:r},(function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,a=e.slice(0,n),s=a.length,u=e.slice(n,e.length).slice(1),c=u.length,l=lq(0,s),h=lq(s+1,s+1+c),f=hq([a,[o],u]),d=t.reshape(f),p=i.reshape([o]),v=hq([[s],l,h]),m=d.transpose(v),g=dq(m,p,r.shape[n]),y=SL(v);return g.transpose(y)}}})).reshape(o.outputShape)}}),dq=RL({unsortedSegmentSum_:function(t,e,n){var r=yL(t,"x","unsortedSegmentSum"),i=yL(e,"segmentIds","unsortedSegmentSum","int32");return sM(dM(n),(function(){return"numSegments must be of dtype int"})),mF.runKernel((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=LW(e,GL(e)),r=fq(t,n),i=wW(e,FL(0,"int32")),o=r.rank-i.rank,a=0;a<o;++a)i=mB(i,a+1);i=QW(i,UL(r.shape,"bool"));var s=GL(r);return eq(i,r,s)}(t,n)}}}))}}),pq=RL({basicLSTMCell_:function(t,e,n,r,i,o){var a=yL(t,"forgetBias","basicLSTMCell"),s=yL(e,"lstmKernel","basicLSTMCell"),u=yL(n,"lstmBias","basicLSTMCell"),c=yL(r,"data","basicLSTMCell"),l=yL(i,"c","basicLSTMCell"),h=yL(o,"h","basicLSTMCell"),f=c.concat(h,1).matMul(s).add(u),d=f.shape[1]/4,p=[f.shape[0],d],v=f.slice([0,0],p),m=f.slice([0,d],p),g=f.slice([0,2*d],p),y=f.slice([0,3*d],p),b=v.sigmoid().mulStrict(m.tanh()).addStrict(l.mulStrict(a.add(g).sigmoid())),_=b.tanh().mulStrict(y.sigmoid());return[b,_]}}),vq=RL({multiRNNCell_:function(t,e,n,r){for(var i=yL(e,"data","multiRNNCell"),o=bL(n,"c","multiRNNCell"),a=bL(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,o[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],f=[];for(c=0;c<u.length;c+=2)h.push(u[c]),f.push(u[c+1]);return[h,f]}}),mq=RL({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=yL(t,"v","movingAverage"),a=yL(e,"x","movingAverage"),s=yL(n,"decay","movingAverage");hF(o,a),sM(fM(o.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=FL(1),c=u.sub(s),l=a.sub(o).mul(c);if(i){sM(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=yL(r,"step","movingAverage");l=l.div(u.sub(HW(s,h)))}return o.add(l)}}),gq=RL({stridedSlice_:function(t,e,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),0!==a)throw new Error("ellipsis mask is not yet supported");if(0!==s)throw new Error("new axis mask is not yet supported");var c=yL(t,"x","stridedSlice");if(r.every((function(t){return 1===t}))){var l=WB(c.shape,e,n,r,i,o,a,s,u),h=l[0],f=l[1],d=l[2],p=f.filter((function(t,e){return-1===d.indexOf(e)}));return eW(c,h,f).reshape(p)}return mF.runKernel((function(t){return t.stridedSlice(c,e,n,r,i,o,a,s,u)}),{$x:c})}}),yq=RL({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=yL(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=mF.runKernel((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),bq=RL({scatterND_:function(t,e,n){var r=yL(t,"indices","scatterND","int32"),i=yL(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+t[a+i]+")")}(n,e,t)}(i,r,n),mF.runKernel((function(t){return t.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),_q=RL({fft_:function(t){sM("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return mF.runKernel((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),wq=RL({ifft_:function(t){sM("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return mF.runKernel((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),xq=RL({rfft_:function(t,e){sM("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e,n=t.slice(o,a),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(zL(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=OL(n,u).as2D(i,r),l=_q(c),h=Math.floor(r/2)+1,f=NL(l),d=DL(l),p=f.split([h,r-h],f.shape.length-1),v=d.split([h,r-h],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,OL(p[0],v[0]).reshape(m)}}),Cq=RL({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=wq(r);return NL(i)}var o=[n,2*(e-1)],a=NL(t).as2D(n,e),s=DL(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(FL(-1)),l=a.concat(u,1),h=s.concat(c,1);return r=OL(l,h).as2D(o[0],o[1]),i=wq(r),NL(i)}}),kq=Object.freeze({fft:_q,ifft:wq,rfft:xq,irfft:Cq}),Eq=RL({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=yL(t,"sparseIndices","sparseToDense","int32"),o=yL(e,"sparseValues","sparseToDense"),a=yL(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),mF.runKernel((function(t){return t.sparseToDense(i,o,n,a)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),Sq=RL({gatherND_:function(t,e){var n=yL(e,"indices","gatherND","int32"),r=yL(t,"x","gatherND");return mF.runKernel((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),Iq=RL({dropout_:function(t,e,n,r){if(null!=n&&!fM(t.shape,n))throw new Error("Non-default noise shape is not implemented yet: "+JSON.stringify(n));var i=IB(t.shape,0,1,"float32",r).greater(e);return i=i.div($W(1,e)),t.mul(i)}});function Tq(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var a=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(a)}return LL(i,"float32")}var Aq,Rq=RL({hannWindow_:function(t){return Tq(t,.5,.5)}}),Oq=RL({hammingWindow_:function(t){return Tq(t,.54,.46)}}),Nq=RL({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,a=[];o+e<=t.size;)a.push(eW(t,o,e)),o+=n;if(r){var s=o+e-t.size,u=KL([eW(t,o,e-s),WL([s],i)]);a.push(u)}return 0===a.length?BL([],[0,e]):KL(a).as2D(a.length,e)}}),Dq=Object.freeze({hannWindow:Rq,hammingWindow:Oq,frame:Nq});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Aq||(Aq={}));var Pq=RL({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=Aq.SUM_BY_NONZERO_WEIGHTS);var i=yL(t,"labels","absoluteDifference"),o=yL(e,"predictions","absoluteDifference"),a=null;null!=n&&(a=yL(n,"weights","absoluteDifference")),uM(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return Mq(s,a,r)}}),Mq=RL({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=Aq.SUM_BY_NONZERO_WEIGHTS);var r=yL(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=yL(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===Aq.NONE)return o;if(n===Aq.SUM)return o.sum();if(n===Aq.MEAN){if(null==i)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(FL(a)):s}if(n===Aq.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(FL(r.size));var u=i.mul(UL(r.shape)).notEqual(FL(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Fq=RL({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=Aq.SUM_BY_NONZERO_WEIGHTS);var o=yL(t,"labels","cosineDistance"),a=yL(e,"predictions","cosineDistance"),s=null;null!=r&&(s=yL(r,"weights","cosineDistance")),uM(o.shape,a.shape,"Error in cosineDistance: ");var u=FL(1).sub(o.mul(a).sum(n,!0));return Mq(u,s,i)}}),Lq=RL({hingeLoss_:function(t,e,n,r){void 0===r&&(r=Aq.SUM_BY_NONZERO_WEIGHTS);var i=yL(t,"labels","hingeLoss"),o=yL(e,"predictions","hingeLoss"),a=null;null!=n&&(a=yL(n,"weights","hingeLoss")),uM(i.shape,o.shape,"Error in hingeLoss: ");var s=FL(1);i=FL(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return Mq(u,a,r)}}),Bq=RL({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=Aq.SUM_BY_NONZERO_WEIGHTS);var o=yL(t,"labels","huberLoss"),a=yL(e,"predictions","huberLoss"),s=null;null!=n&&(s=yL(n,"weights","huberLoss")),uM(o.shape,a.shape,"Error in huberLoss: ");var u=FL(r),c=a.sub(o).abs(),l=jW(c,u),h=c.sub(l),f=FL(.5).mul(l.square()).add(u.mul(h));return Mq(f,s,i)}}),jq=RL({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=Aq.SUM_BY_NONZERO_WEIGHTS);var o=yL(t,"labels","logLoss"),a=yL(e,"predictions","logLoss"),s=null;null!=n&&(s=yL(n,"weights","logLoss")),uM(o.shape,a.shape,"Error in logLoss: ");var u=FL(1),c=FL(r),l=o.mul(a.add(c).log()).neg().sub(u.sub(o).mul(u.sub(a).add(c).log()));return Mq(l,s,i)}}),Vq=RL({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=Aq.SUM_BY_NONZERO_WEIGHTS);var i=yL(t,"labels","meanSquaredError"),o=yL(e,"predictions","meanSquaredError"),a=null;null!=n&&(a=yL(n,"weights","meanSquaredError")),uM(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return Mq(s,a,r)}}),Uq=RL({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Aq.SUM_BY_NONZERO_WEIGHTS);var o=yL(t,"multiClassLabels","sigmoidCrossEntropy"),a=yL(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=yL(n,"weights","sigmoidCrossEntropy")),uM(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=FL(r),c=FL(1),l=FL(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=yL(t,"labels","sigmoidCrossEntropyWithLogits"),r=yL(e,"logits","sigmoidCrossEntropyWithLogits");uM(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),a=r.abs().neg().exp().log1p();return i.sub(o).add(a)}(o,a);return Mq(h,s,i)}}),zq=RL({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Aq.SUM_BY_NONZERO_WEIGHTS);var o=yL(t,"onehotLabels","softmaxCrossEntropy"),a=yL(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=yL(n,"weights","softmaxCrossEntropy")),uM(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=FL(r),c=FL(1),l=FL(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return XB((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=CL(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,a);return Mq(h,s,i)}}),Wq=Object.freeze({get Reduction(){return Aq},absoluteDifference:Pq,computeWeightedLoss:Mq,cosineDistance:Fq,hingeLoss:Lq,huberLoss:Bq,logLoss:jq,meanSquaredError:Vq,sigmoidCrossEntropy:Uq,softmaxCrossEntropy:zq});function qq(t,e){return void 0===e&&(e=!1),mF.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=gB(n),o=t.clone(),a=BL([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(t){var e,u=o,c=s,l=i;e=mF.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),c=o.slice([t,t],[1,1]),l=c.sign().neg(),h=c.sub(l.mul(u)),f=e.div(h);s=1===f.shape[0]?a.clone():a.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var d=l.matMul(h).div(u).neg(),p=o.slice([t,0],[n-t,r]),v=d.mul(s);o=0===t?p.sub(v.matMul(s.transpose().matMul(p))):o.slice([0,0],[t,r]).concat(p.sub(v.matMul(s.transpose().matMul(p))),0);var m=i.slice([0,t],[n,i.shape[1]-t]);return i=0===t?m.sub(m.matMul(s).matMul(v.transpose())):i.slice([0,0],[n,t]).concat(m.sub(m.matMul(s).matMul(v.transpose())),1),[s,o,i]})),s=e[0],o=e[1],i=e[2],pL([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var Hq=RL({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,sM(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){sM(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=JL(t,t.shape[0],0).map((function(t){return RB(t,[0])}));sM(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],a=t,s=function(t){o.push(mF.tidy((function(){var e=a[t];if(t>0)for(var n=0;n<t;++n){var r=mW(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(cq(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?OB(o,0):o}}),Gq=RL({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return qq(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=PB(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=qq(t,e),r=n[1];i.push(n[0]),o.push(r)})),[OB(i,0).reshape(t.shape),OB(o,0).reshape(t.shape)]}}),Kq=Object.freeze({gramSchmidt:Hq,qr:Gq});function Xq(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),sM(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),sM(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),sM(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),sM(1===e.rank,(function(){return"scores must be a 1D tensor"})),sM(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var $q=RL({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=yL(t,"images","resizeBilinear");sM(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),sM(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=mF.runKernel((function(t,e){return e([i]),t.resizeBilinear(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return mF.runKernel((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Yq=RL({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=yL(t,"images","resizeNearestNeighbor");sM(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),sM(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),sM("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=mF.runKernel((function(t,e){return e([i]),t.resizeNearestNeighbor(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return mF.runKernel((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Qq=RL({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=yL(t,"boxes","nonMaxSuppression"),a=yL(e,"scores","nonMaxSuppression"),s=Xq(o,a,n,r,i);return n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,mF.runKernel((function(t){return t.nonMaxSuppression(o,a,n,r,i)}),{$boxes:o})}}),Jq=RL({cropAndResize_:function(t,e,n,r,i,o){var a=yL(t,"image","cropAndResize","float32"),s=yL(e,"boxes","cropAndResize","float32"),u=yL(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=s.shape[0];return sM(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),sM(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),sM(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),sM(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),sM(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),sM("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),mF.runKernel((function(t,e){return t.cropAndResize(a,s,u,r,i,o)}),{$image:a,$boxes:s})}}),Zq=Object.freeze({resizeBilinear:$q,resizeNearestNeighbor:Yq,nonMaxSuppression:Qq,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),QP(this,void 0,void 0,(function(){var o,a,s,u,c,l;return JP(this,(function(h){switch(h.label){case 0:return o=yL(t,"boxes","nonMaxSuppressionAsync"),a=yL(e,"scores","nonMaxSuppressionAsync"),s=Xq(o,a,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,o.data()];case 1:return u=h.sent(),[4,a.data()];case 2:return c=h.sent(),l=yj(u,c,n,r,i),o!==t&&o.dispose(),a!==e&&a.dispose(),[2,l]}}))}))},cropAndResize:Jq}),tH=RL({matMul_:function(t,e,n,r,i,o){var a;void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o="linear");var s=yL(t,"a","fused matMul"),u=yL(e,"b","fused matMul");a=lF(s,u),s=a[0],u=a[1];var c=n?s.shape[s.rank-2]:s.shape[s.rank-1],l=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?s.shape[s.rank-1]:s.shape[s.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],d=s.shape.slice(0,-2),p=u.shape.slice(0,-2),v=hM(d),m=hM(p);sM(s.rank>=2&&u.rank>=2&&s.rank===u.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+s.rank+" and "+u.rank+"."})),sM(fM(d,p),(function(){return"Error in fused matMul: outer dimensions ("+d+") and ("+p+") of Tensors with shapes "+s.shape+" and "+u.shape+" must match."})),sM(c===l,(function(){return"Error in fused matMul: inner shapes ("+c+") and ("+l+") of Tensors with shapes "+s.shape+" and "+u.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var g,y=s.shape.slice(0,-2).concat([h,f]),b=n?s.as3D(v,c,h):s.as3D(v,h,c),_=r?u.as3D(m,f,l):u.as3D(m,l,f);null!=i&&tj(y,(g=lF(g=yL(i,"bias","fused matMul"),s)[0]).shape);var w={$a:b,$b:_};return null!=i&&(w.$bias=g),mF.runKernel((function(t,e){var i=t.fusedBatchMatMul(b,_,n,r,g,o);return e([b,_,i]),i}),w,(function(t,e){var a,s=e[0],u=e[1],c=e[2];if(null==o||"linear"===o)a=t;else{if("relu"!==o)throw new Error("Gradient for activation "+o+" has not been implemented yet.");a=t.mul(c.step())}var l={};return null!=i&&(l={$bias:function(){var t=a,e=ZB(g.shape,a.shape);return e.length>0&&(t=t.sum(e)),t.reshape(g.shape)}}),Object.assign(n||r?!n&&r?{$a:function(){return a.matMul(u,!1,!1)},$b:function(){return a.matMul(s,!0,!1)}}:n&&!r?{$a:function(){return u.matMul(a,!1,!0)},$b:function(){return s.matMul(a,!1,!1)}}:{$a:function(){return u.matMul(a,!0,!0)},$b:function(){return a.matMul(s,!0,!0)}}:{$a:function(){return a.matMul(u,!1,!0)},$b:function(){return s.matMul(a,!0,!1)}},l)})).reshape(y)}}),eH=Object.freeze({matMul:tH}),nH=Object.freeze({image:Zq,linalg:Kq,losses:Wq,spectral:kq,fused:eH,signal:Dq,op:RL,batchNormalization2d:kz,batchNormalization3d:Ez,batchNormalization4d:Sz,batchNormalization:Iz,batchNorm:Tz,batchNorm2d:Az,batchNorm3d:Rz,batchNorm4d:Oz,complex:OL,real:NL,imag:DL,concat:KL,concat1d:XL,concat2d:$L,concat3d:YL,concat4d:QL,split:JL,conv1d:Mz,conv2d:Fz,conv3d:Lz,conv2dDerFilter:Bz,depthwiseConv2d:jz,separableConv2d:Vz,conv2dTranspose:Uz,matMul:zz,dot:Wz,outerProduct:qz,reverse:Hz,reverse1d:Gz,reverse2d:Kz,reverse3d:Xz,reverse4d:$z,maxPool:Jz,avgPool:Zz,pool:tW,slice:eW,slice1d:nW,slice2d:rW,slice3d:iW,slice4d:oW,abs:LU,acos:BU,acosh:jU,asin:VU,asinh:UU,atan:zU,atanh:WU,ceil:qU,clipByValue:HU,cos:GU,cosh:KU,erf:XU,exp:$U,expm1:YU,floor:QU,log:JU,log1p:ZU,logSigmoid:tz,neg:ez,reciprocal:nz,round:rz,rsqrt:iz,sigmoid:oz,sign:az,isNaN:sz,isInf:uz,isFinite:cz,sin:lz,sinh:hz,softplus:fz,sqrt:dz,square:pz,step:vz,tan:mz,tanh:gz,all:sW,any:uW,argMax:cW,argMin:lW,logSumExp:hW,max:fW,mean:dW,min:pW,moments:vW,sum:mW,prod:gW,equal:yW,equalStrict:bW,greater:_W,greaterEqual:wW,greaterEqualStrict:xW,greaterStrict:CW,less:kW,lessEqual:EW,lessEqualStrict:SW,lessStrict:IW,notEqual:TW,notEqualStrict:AW,add:RW,addN:OW,addStrict:NW,atan2:DW,div:PW,divStrict:MW,floorDiv:FW,maximum:LW,maximumStrict:BW,minimum:jW,minimumStrict:VW,mod:UW,modStrict:zW,mul:WW,mulStrict:qW,pow:HW,powStrict:GW,squaredDifference:KW,squaredDifferenceStrict:XW,sub:$W,subStrict:YW,elu:nq,leakyRelu:rq,prelu:iq,relu:oq,selu:aq,logicalAnd:QW,logicalNot:JW,logicalOr:ZW,logicalXor:tq,where:eq,whereAsync:function(t){return QP(this,void 0,void 0,(function(){var e,n,r;return JP(this,(function(i){switch(i.label){case 0:return[4,(e=yL(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=Cj(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},buffer:lB,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:hB,cast:fB,clone:dB,cumsum:pB,depthToSpace:vB,expandDims:mB,eye:gB,multinomial:yB,oneHot:bB,pad:_B,pad1d:wB,pad2d:xB,pad3d:CB,pad4d:kB,rand:EB,randomNormal:SB,randomUniform:IB,reshape:TB,spaceToBatchND:AB,squeeze:RB,stack:OB,tile:NB,truncatedNormal:DB,unstack:PB,setdiff1dAsync:function(t,e){return QP(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h;return JP(this,(function(f){switch(f.label){case 0:return n=yL(t,"x","setdiff1d"),r=yL(e,"y","setdiff1d"),sM(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),sM(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),sM(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=f.sent(),[4,r.data()];case 2:for(o=f.sent(),a=new Set(o),s=0,l=0;l<i.length;l++)a.has(i[l])||s++;for(u=new $M([s],n.dtype),c=new $M([s],"int32"),l=0,h=0;l<i.length;l++)a.has(i[l])||(u.values[h]=i[l],c.values[h]=l,h++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},fill:WL,linspace:function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return mF.runKernel((function(r){return r.linspace(t,e,n)}),{})},ones:UL,range:qL,scalar:FL,tensor:PL,tensor1d:LL,tensor2d:BL,tensor3d:jL,tensor4d:VL,tensor5d:function(t,e,n){if(cM(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=mL(t);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ML(t,e,r,n)},tensor6d:function(t,e,n){if(cM(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=mL(t);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ML(t,e=e||r,r,n)},zeros:zL,onesLike:HL,zerosLike:GL,transpose:sq,softmax:$B,logSoftmax:YB,localResponseNormalization:uq,norm:cq,gather:fq,unsortedSegmentSum:dq,basicLSTMCell:pq,multiRNNCell:vq,movingAverage:mq,stridedSlice:gq,topk:yq,scatterND:bq,fft:_q,ifft:wq,rfft:xq,irfft:Cq,sparseToDense:Eq,gatherND:Sq,dropout:Iq,hannWindow:Rq,hammingWindow:Oq,frame:Nq}),rH=function(){function t(){if(this.blockSize=48,this.firstUse=!0,eM.get("IS_BROWSER")){var t=function(){if("undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}();this.fromPixels2DContext=t.getContext("2d")}this.data=new QB(this,mF)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,eM.get("IS_NODE")&&vL("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r;if(eM.get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,t.width,t.height).data;else if(t instanceof ImageData||t.data instanceof Uint8Array)n=t.data;else{if(!(t instanceof HTMLImageElement||t instanceof HTMLVideoElement))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),n=this.fromPixels2DContext.getImageData(0,0,t.width,t.height).data}if(4===e)r=new Int32Array(n);else{var i=t.width*t.height;r=new Int32Array(i*e);for(var o=0;o<i;o++)for(var a=0;a<e;++a)r[o*e+a]=n[4*o+a]}return jL(r,[t.height,t.width,e],"int32")},t.prototype.read=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?pj(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){return lB(t.shape,t.dtype,this.readSync(t.dataId))},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){return e=UM(),t(),[2,{kernelMs:UM()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=ZM.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:mF.keep(t.clone()),imag:mF.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&sM("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),GB(t.shape,e,n)){var r=KB(e,t.strides),i=hM(n);return PL(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=lB(n,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s).map((function(t,n){return t+e[n]}));o.values[s]=a.get.apply(a,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s,u){this.assertNotComplex(t,"stridedSlice");var c=WB(t.shape,e,n,r,i,o,a,s,u),l=c[0],h=c[1],f=c[2],d=h.filter((function(t,e){return-1===f.indexOf(e)}));if(d.some((function(t){return 0===t})))return PL([],d);for(var p=lB(h,t.dtype),v=this.bufferSync(t),m=0;m<p.size;m++){for(var g=p.indexToLoc(m),y=new Array(g.length),b=0;b<y.length;b++)y[b]=g[b]*r[b]+l[b];p.set.apply(p,[v.get.apply(v,y)].concat(g))}return p.toTensor().reshape(d)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=lB(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),a=o.slice();e.forEach((function(e){return a[e]=t.shape[e]-1-a[e]})),n.set.apply(n,[r.get.apply(r,a)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;this.assertNotComplex(t,"concat");var r=t.map((function(t){var n=hM(t.shape.slice(e));return t.as2D(-1,n)})),i=AL(r.map((function(t){return t.shape})),1),o=lB(i,t[0].dtype).values;if(1===r[0].shape[0]){var a=0;r.forEach((function(t){o.set(n.readSync(t.dataId),a),a+=t.size}))}else{var s=0;r.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,a=0;a<t.shape[0];++a)for(var u=a*i[1]+s,c=0;c<t.shape[1];++c)o[u+c]=e[r++];s+=t.shape[1]}))}var u=AL(t.map((function(t){return t.shape})),e);return PL(o,u,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(FL(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,uF(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=lB(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var a=n[o],s=0;s<i.length;s++)i[s]+=a[s];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,uF(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],f=l[1],d=l[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],v=p[0],m=p[1],g=p[2],y=o*a,b=lB([s,o,a],t.dtype),_=b.values,w=this.blockSize,x=0;x<s;x++)for(var C=0;C<o;C+=w)for(var k=0;k<a;k+=w)for(var E=0;E<i;E+=w)for(var S=Math.min(C+w,o),I=Math.min(k+w,a),T=Math.min(E+w,i),A=C;A<S;A++)for(var R=k;R<I;R++){for(var O=0,N=E;N<T;N++)O+=u[x*h+A*f+N*d]*c[N*v+R*m+x*g];_[x*y+(A*a+R)]+=O}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var a=this.batchMatMul(t,e,n,r);return i&&(a=this.add(a,i)),o&&(a=function(t,e,n){if("linear"===e)return t.linear(n);if("relu"===e)return t.relu(n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}(this,o,a)),a},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,uF(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),kL("sum",e,t.rank);for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],uF(t.dtype,"int32")),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=0,h=0;h<o;++h)l+=s[c+h];a[u]=l}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],uF(t.dtype,"int32")),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=1,h=0;h<o;++h)l*=s[c+h];a[u]=l}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var a=FL(o,"int32"),s=yW(a,e).asType("float32").mul(t).sum(0);r.push(s)}return OB(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];kL("argMin",n,t.rank);for(var r=xL(t.shape,n),i=r[1],o=zL(r[0],"int32"),a=hM(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0,d=0;d<a;++d){var p=u[l+d];p<h&&(h=p,f=d)}s[c]=f}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];kL("argMax",n,t.rank);for(var r=xL(t.shape,n),i=r[1],o=zL(r[0],"int32"),a=hM(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0,d=0;d<a;++d){var p=u[l+d];p>h&&(h=p,f=d)}s[c]=f}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=uF(t.dtype,"int32"),o=zL(t.shape,i),a=this.readSync(o.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var f=c(l,h);if(0===h)a[f]=n?0:s[f];else{var d=c(l,h-1);a[f]=n?s[d]+a[d]:s[f]+a[d]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return ZM.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),a=zL(e.shape,uF(e.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],l=0;l<r.length;l++)for(var h=0;h<c;h++)s[u++]=1===r[l]?i[l]:o[l];return a},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return Cj(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),xj(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),kL("min",e,t.rank);for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],t.dtype),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h){var f=s[c+h];f<l&&(l=f)}a[u]=l}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),kL("max",e,t.rank);for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],t.dtype),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h){var f=s[c+h];f>l&&(l=f)}a[u]=l}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),kL("all",e,t.rank);for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],t.dtype),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h)l=l&&s[c+h];a[u]=l}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),kL("any",e,t.rank);for(var n=xL(t.shape,e),r=n[1],i=zL(n[0],t.dtype),o=hM(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h)l=l||s[c+h];a[u]=l}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return ZM.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return ZM.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return ZM.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return ZM.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return ZM.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return ZM.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return ZM.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return ZM.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=zL(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return ZM.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o];n[o]=a>=1?i[o]:i[o]*(a+1)}return ZM.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return ZM.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>n?n:a<e?e:a}return ZM.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return ZM.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return ZM.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return ZM.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,a=r[i]>-e,s=r[i]<e,u=Math.exp(r[i]);o=s?u:a?r[i]:Math.log(1+u),n[i]=o}return ZM.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=pM(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return ZM.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r],o=1/(1+.3275911*i);e[r]=1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i)}return ZM.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return ZM.make(t.shape,{values:n})},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=lB(n.outShape,t.dtype),l=this.readSync(t.dataId),h=this.readSync(e.dataId),f=c.values,d=0;d<n.batchSize;++d)for(var p=d*t.strides[0],v=d*c.strides[0],m=0;m<n.outHeight;++m)for(var g=v+m*c.strides[1],y=m*n.strideHeight-u,b=0;b<r;b++){var _=y+b*o;if(!(_<0||_>=n.inHeight))for(var w=b*e.strides[0],x=p+_*t.strides[1],C=0;C<n.outWidth;++C)for(var k=g+C*n.outChannels,E=C*n.strideWidth-s,S=0;S<i;S++){var I=E+S*a;if(!(I<0||I>=n.inWidth))for(var T=x+I*n.inChannels,A=w+S*e.strides[1],R=0;R<n.inChannels;++R){for(var O=l[T+R],N=0;N<n.outChannels;++N)f[k+N]+=O*h[A+N];A+=n.outChannels}}}return c.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,f=lB(n.outShape,t.dtype),d=this.readSync(t.dataId),p=this.readSync(e.dataId),v=f.values,m=0;m<n.batchSize;++m)for(var g=m*t.strides[0],y=m*f.strides[0],b=0;b<n.outDepth;++b)for(var _=y+b*f.strides[1],w=b*n.strideDepth-c,x=0;x<r;x++){var C=w+x*a;if(!(C<0||C>=n.inDepth))for(var k=x*e.strides[0],E=g+C*t.strides[1],S=0;S<n.outHeight;++S)for(var I=_+S*f.strides[2],T=S*n.strideHeight-h,A=0;A<i;A++){var R=T+A*s;if(!(R<0||R>=n.inHeight))for(var O=k+A*e.strides[1],N=E+R*t.strides[2],D=0;D<n.outWidth;++D)for(var P=I+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<o;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=N+L*n.inChannels,j=O+F*e.strides[2],V=0;V<n.inChannels;++V){for(var U=d[B+V],z=0;z<n.outChannels;++z)v[P+z]+=U*p[j+z];j+=n.outChannels}}}}return f.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=lB(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],f=l[1],d=l[2],p=this.readSync(e.dataId),v=e.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,_=n.filterHeight,w=n.filterWidth,x=n.inChannels,C=n.inHeight,k=n.inWidth,E=n.outChannels,S=n.outHeight,I=n.outWidth,T=n.strideHeight,A=n.strideWidth,R=_-1-n.padInfo.top,O=w-1-n.padInfo.left,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-R,F=Math.max(0,Math.ceil(M/T)),L=Math.min(S,(_+M)/T),B=0;B<k;++B){for(var j=B-O,V=Math.max(0,Math.ceil(j/A)),U=Math.min(I,(w+j)/A),z=0,W=F;W<L;++W)for(var q=W*T-M,H=V;H<U;++H)for(var G=h*N+f*W+d*H,K=m*(_-1-q)+g*(w-1-(H*A-j))+y*D,X=0;X<E;++X)z+=c[G+X]*p[K+X];i[a*N+s*P+u*B+D]=z}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=lB(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=o[3],l=this.readSync(t.dataId),h=t.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=n.batchSize,C=n.filterDepth,k=n.filterHeight,E=n.filterWidth,S=n.inChannels,I=n.inDepth,T=n.inHeight,A=n.inWidth,R=n.outChannels,O=n.outDepth,N=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=C-1-n.padInfo.front,B=k-1-n.padInfo.top,j=E-1-n.padInfo.left,V=0;V<x;++V)for(var U=0;U<S;++U)for(var z=0;z<I;++z)for(var W=z-L,q=Math.max(0,Math.ceil(W/P)),H=Math.min(O,(C+W)/P),G=0;G<T;++G)for(var K=G-B,X=Math.max(0,Math.ceil(K/M)),$=Math.min(N,(k+K)/M),Y=0;Y<A;++Y){for(var Q=Y-j,J=Math.max(0,Math.ceil(Q/F)),Z=Math.min(D,(E+Q)/F),tt=0,et=q;et<H;++et)for(var nt=et*P-W,rt=X;rt<$;++rt)for(var it=rt*M-K,ot=J;ot<Z;++ot)for(var at=f*V+d*et+p*rt+v*ot,st=y*(C-1-nt)+b*(k-1-it)+_*(E-1-(ot*F-Q))+w*U,ut=0;ut<R;++ut)tt+=l[at+ut]*m[st+ut];i[a*V+s*z+u*G+c*Y+U]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=lB(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=this.bufferSync(t),h=this.bufferSync(e),f=0;f<o;++f)for(var d=Math.max(0,Math.ceil((c-f)/r)),p=Math.min(n.outHeight,(n.inHeight+c-f)/r),v=0;v<a;++v)for(var m=Math.max(0,Math.ceil((u-v)/i)),g=Math.min(n.outWidth,(n.inWidth+u-v)/i),y=0;y<n.inChannels;++y)for(var b=0;b<n.outChannels;++b){for(var _=0,w=0;w<n.batchSize;++w)for(var x=d;x<p;++x)for(var C=f+x*r-c,k=m;k<g;++k)_+=l.get(w,C,v+k*i-u,y)*h.get(w,x,k,b);s.set(_,f,v,y,b)}return s.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=lB(n.filterShape,"float32"),l=c.values,h=c.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=this.readSync(t.dataId),C=t.strides,k=C[0],E=C[1],S=C[2],I=C[3],T=n.padInfo.front,A=n.padInfo.left,R=n.padInfo.top,O=0;O<a;++O)for(var N=Math.max(0,Math.ceil((T-O)/r)),D=Math.min(n.outDepth,(n.inDepth+T-O)/r),P=O*f,M=0;M<s;++M)for(var F=Math.max(0,Math.ceil((R-M)/i)),L=Math.min(n.outHeight,(n.inHeight+R-M)/i),B=M*d+P,j=0;j<u;++j)for(var V=Math.max(0,Math.ceil((A-j)/o)),U=Math.min(n.outWidth,(n.inWidth+A-j)/o),z=j*p+B,W=0;W<n.inChannels;++W)for(var q=W*v+z,H=0;H<n.outChannels;++H){for(var G=0,K=0;K<n.batchSize;++K)for(var X=K*k,$=K*y,Y=N;Y<D;++Y)for(var Q=(O+Y*r-T)*E+X,J=Y*b+$,Z=F;Z<L;++Z)for(var tt=(M+Z*i-R)*S+Q,et=Z*_+J,nt=V;nt<U;++nt)G+=x[(j+nt*o-A)*I+tt+W]*m[nt*w+et+H];l[q+H]=G}return c.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=lB(n.outShape,t.dtype),h=this.readSync(t.dataId),f=this.readSync(e.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*t.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,_=0;_<r;++_){var w=b+_*o;if(!(w<0||w>=n.inHeight))for(var x=_*e.strides[0],C=v+w*t.strides[1],k=0;k<n.outWidth;++k)for(var E=y+k*l.strides[2],S=k*n.strideWidth-u,I=0;I<i;++I){var T=S+I*a;if(!(T<0||T>=n.inWidth))for(var A=C+T*n.inChannels,R=E,O=x+I*e.strides[1],N=0;N<n.inChannels;++N){for(var D=h[A+N],P=0;P<c;++P)d[R+P]+=D*f[O+P];R+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=lB(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],f=l[1],d=l[2],p=this.readSync(e.dataId),v=e.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,_=n.filterHeight,w=n.filterWidth,x=n.inChannels,C=n.inHeight,k=n.inWidth,E=n.outHeight,S=n.outWidth,I=n.strideHeight,T=n.strideWidth,A=_-1-n.padInfo.top,R=w-1-n.padInfo.left,O=n.outChannels/x,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-A,F=Math.max(0,Math.ceil(M/I)),L=Math.min(E,(_+M)/I),B=0;B<k;++B){for(var j=B-R,V=Math.max(0,Math.ceil(j/T)),U=Math.min(S,(w+j)/T),z=0,W=F;W<L;++W)for(var q=W*I-M,H=V;H<U;++H)for(var G=h*N+f*W+d*H,K=m*(_-1-q)+g*(w-1-(H*T-j))+y*D,X=0;X<O;++X)z+=c[G+(D*O+X)]*p[K+X];i[a*N+s*P+u*B+D]=z}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=lB(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<o;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((u-m)/i)),y=Math.min(n.outWidth,(n.inWidth+u-m)/i),b=0;b<n.outChannels;++b){for(var _=Math.trunc(b/l),w=b%l,x=0,C=0;C<n.batchSize;++C)for(var k=p;k<v;++k)for(var E=d+k*r-c,S=g;S<y;++S)x+=h.get(C,E,m+S*i-u,_)*f.get(C,k,S,b);s.set(x,d,m,_,w)}return s.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),wj(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),a=lB(r,t.dtype);0!==n&&a.values.fill(n);for(var s=0;s<t.size;s++){var u=o.indexToLoc(s),c=u.map((function(t,e){return t+i[e]}));a.set.apply(a,[o.get.apply(o,u)].concat(c))}return a.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=lB(n,t.dtype),a=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[e[c]];var l=o.locToIndex(u);o.values[l]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=lB(r,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s),c=u.slice();c[n]=i[u[n]];var l=a.locToIndex(c);o.values[s]=a.values[l]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=MB(t.shape,e,r),o=FB(i.length,e.length),a=LB(t.shape,e,r),s=BB(n,e.length),u=jB(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=MB(a.shape,e,r,!1),u=FB(s.length,e.length,!1),c=LB(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=this.readSync(t.dataId),d=lB(e.outShape,t.dtype),p=d.values,v=e.outShape[1]*e.outShape[2]*e.outShape[3],m=e.outShape[2]*e.outShape[3],g=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*v,_=y*t.strides[0],w=0;w<e.inChannels;++w)for(var x=0;x<e.outHeight;++x)for(var C=x*r-c,k=Math.max(0,C),E=Math.min(e.inHeight,s+C),S=b+x*m,I=0;I<e.outWidth;++I){for(var T=I*i-l,A=Math.max(0,T),R=Math.min(e.inWidth,u+T),O=h,N=0,D=0,P=k;P<E;P+=o){for(var M=_+P*t.strides[1],F=A;F<R;F+=a){var L=f[M+F*t.strides[2]+w];"max"===n&&L>O?O=L:"avg"===n&&(N+=L,D++)}if(isNaN(O))break}p[S+I*g+w]="avg"===n?N/D:O}return d.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=lB(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),f=0;f<e.batchSize;++f)for(var d=0;d<e.inChannels;++d)for(var p=0;p<e.outHeight;++p){for(var v=p*r-c,m=v;m<0;)m+=o;for(var g=Math.min(e.inHeight,s+v),y=0;y<e.outWidth;++y){for(var b=y*i-l,_=b;_<0;)_+=a;for(var w=Math.min(e.inWidth,u+b),x=Number.NEGATIVE_INFINITY,C=-1,k=m;k<g;k+=o)for(var E=k-v,S=_;S<w;S+=a){var I=S-b,T=h.get(f,k,S,d);T>x&&(x=T,C=E*u+I)}n.set(C,f,p,y,d)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,f=c-1-r.padInfo.top,d=lB(e.shape,"float32"),p=this.bufferSync(i),v=this.bufferSync(t),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var _=y-f,w=b-h,x=0,C=0;C<c;C+=s){var k=(_+C)/o;if(!(k<0||k>=r.outHeight||Math.floor(k)!==k))for(var E=0;E<l;E+=u){var S=(w+E)/a;if(!(S<0||S>=r.outWidth||Math.floor(S)!==S)){var I=c*l-1-p.get(m,k,S,g)===C*l+E?1:0;0!==I&&(x+=v.get(m,k,S,g)*I)}}}d.set(x,m,y,b,g)}return d.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,f=c-1-n.padInfo.top,d=lB(e.shape,"float32"),p=1/(o*a),v=this.bufferSync(t),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var _=y-f,w=b-h,x=0,C=0;C<c;C+=s){var k=(_+C)/r;if(!(k<0||k>=n.outHeight||Math.floor(k)!==k))for(var E=0;E<l;E+=u){var S=(w+E)/i;S<0||S>=n.outWidth||Math.floor(S)!==S||(x+=v.get(m,k,S,g))}}d.set(x*p,m,y,b,g)}return d.toTensor()},t.prototype.cast=function(t,e){return hj(t,e,this)},t.prototype.reshape=function(t,e){return fj(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(hM([o,e,n,u])),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=0,p=h[0]/f[0],v=h[1]/f[1],m=0;m<o;m++)for(var g=0;g<e;g++)for(var y=p*g,b=Math.floor(y),_=y-b,w=Math.min(a-1,Math.ceil(y)),x=m*t.strides[0]+b*t.strides[1],C=m*t.strides[0]+w*t.strides[1],k=0;k<n;k++)for(var E=v*k,S=Math.floor(E),I=E-S,T=Math.min(s-1,Math.ceil(E)),A=x+S*t.strides[2],R=C+S*t.strides[2],O=x+ +T*t.strides[2],N=C+T*t.strides[2],D=0;D<u;D++){var P=c[A+D],M=c[R+D],F=P+(c[O+D]-P)*I;l[d++]=F+(M+(c[N+D]-M)*I-F)*_}return PL(l,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=[n&&c>1?o-1:o,n&&l>1?a-1:a],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=f[0]/d[0],v=f[1]/d[1],m=this.readSync(t.dataId),g=0,y=0;y<i;y++)for(var b=y*e.strides[0],_=0;_<c;_++)for(var w=_*p,x=Math.floor(w),C=Math.min(Math.ceil(w),o-1),k=b+x*e.strides[1],E=b+C*e.strides[1],S=w-x,I=1-S,T=0;T<l;T++)for(var A=T*v,R=Math.floor(A),O=Math.min(Math.ceil(A),a-1),N=A-R,D=1-N,P=k+R*e.strides[2],M=k+O*e.strides[2],F=E+R*e.strides[2],L=E+O*e.strides[2],B=I*D,j=I*N,V=S*D,U=S*N,z=0;z<s;z++){var W=m[g++];h[P+z]+=W*B,h[M+z]+=W*j,h[F+z]+=W*V,h[L+z]+=W*U}return VL(h,[i,a,o,s],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(o*e*n*u),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/f[0],p=h[1]/f[1],v=0,m=0;m<o;m++)for(var g=m*t.strides[0],y=0;y<e;y++)for(var b=d*y,_=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*t.strides[1],w=0;w<n;w++)for(var x=p*w,C=_+Math.min(s-1,r?Math.round(x):Math.floor(x))*t.strides[2],k=0;k<u;k++)l[v++]=c[C+k];return PL(l,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=this.readSync(t.dataId),d=[n&&c>1?o-1:o,n&&l>1?a-1:a],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,_=2*Math.ceil(y)+2,w=0;w<i;w++)for(var x=w*e.strides[0],C=0;C<o;C++)for(var k=x+C*e.strides[1],E=Math.floor(C*g),S=Math.floor(E-b/2),I=0;I<a;I++)for(var T=k+I*e.strides[2],A=Math.floor(I*y),R=Math.floor(A-_/2),O=0;O<s;O++){for(var N=0,D=0;D<b;D++){var P=D+S;if(!(P<0||P>=c)){var M=x+P*t.strides[1],F=P*v;if(C===Math.min(o-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<_;L++){var B=L+R;if(!(B<0||B>=l)){var j=M+B*t.strides[2],V=B*m;I===Math.min(a-1,n?Math.round(V):Math.floor(V))&&(N+=f[j+O])}}}}h[T+O]=N}return VL(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(a.length),f=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,b=0,_=0;_<a.length;++_)h[_]=l[m++]+(a[_]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),m>=f&&(m=0),g>=v&&(g=0),y>=d&&(y=0),b>=p&&(b=0);return VL(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],a=o-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,a),u=0;r<=i;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var f=l(h),d=s[h]*Math.pow(n+r*f,-i);c[h]=d}return VL(c,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){this.assertNotComplex(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),f=t.size,d=0;d<f;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);for(g=o*g+i,y=v;y<m;y++){var b=-2*o*a*c[y]*l[d]/g;d===y&&(b+=Math.pow(g,-a)),h[y]+=b*=u[d]}}return VL(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:$B(t),o=i.shape[0],a=i.shape[1],s=zL([o,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(i.dataId),l=0;l<o;++l){var h=l*a,f=new Float32Array(a-1);f[0]=c[h];for(var d=1;d<f.length;++d)f[d]=f[d-1]+c[h+d];for(var p=sB(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),a=0;a<t.size;++a)o[a]>=0&&o[a]<e&&(i[a*e+o[a]]=n);return BL(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),yj(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=lB(t.shape,"float32"),o=lB(t.shape,"float32"),a=NL(t).as2D(n,r),s=DL(t).as2D(n,r),u=0;u<n;u++)for(var c=a.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=OL(c,l),f=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var p=vj(f,d);i.values[u*r+d]=p.real,o.values[u*r+d]=p.imag}return OL(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=OL(NL(i).div(FL(r)),DL(i).div(FL(r)))),i}var o=this.readSync(t.dataId),a=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return OL(a.real,a.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),a=OL(o.real,o.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=OL(s.real,s.imag).as1D();a=this.fftRadix2(a,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),l=OL(c.real,c.imag).mul(u),h=a.add(l),f=a.sub(l),d=NL(h).concat(NL(f)),p=DL(h).concat(DL(f));return OL(d,p).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,a=0,s=0;s<e;s++){var u=gj(i*s,e,n),c=vj(t,s);o+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(o/=e,a/=e),mj(r,o,a,i)}return r},t.prototype.depthToSpace=function(t,e,n){sM("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),sM(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],a=t.shape[3],s=i*e,u=o*e,c=a/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*s*u*c),f=0,d=0;d<r;++d)for(var p=0;p<s;++p)for(var v=Math.floor(p/e),m=p%e,g=0;g<u;++g)for(var y=Math.floor(g/e),b=(m*e+g%e)*c,_=0;_<c;++_)h[f++]=l[_+b+a*(y+o*(v+i*d))];return VL(h,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=tj(t.shape,e.shape),o=lB(i,n),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=JB(t.shape,i),c=JB(e.shape,i),l=o.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(a[h%a.length],s[h%s.length]);else{var f=this.bufferSync(t),d=this.bufferSync(e),p=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=f.locToIndex(h),v=i.slice(-e.rank);c.forEach((function(t){return v[t]=0}));var m=d.locToIndex(v);l[n]=r(a[p],s[m])};for(h=0;h<l.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=tj(t.shape,e.shape),i=lB(r,"float32"),o=lB(r,"float32"),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=JB(t.shape,r),c=JB(e.shape,r),l=i.values,h=o.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var d=f%a.length,p=f%s.length,v=n(a[2*d],a[2*d+1],s[2*p],s[2*p+1]);l[f]=v.real,h[f]=v.imag}else{var m=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),f=o.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var d=m.locToIndex(f),p=o.slice(-e.rank);c.forEach((function(t){return p[t]=0}));var v=g.locToIndex(p),y=n(a[2*d],a[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,h[r]=y.imag};for(f=0;f<l.length;f++)y(f)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return _j(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var a=t.shape,s=a[0],u=a[1],c=a[2],l=a[3],h=e.shape[0],f=r[0],d=r[1],p=lB([h,f,d,l],t.dtype),v=this.readSync(e.dataId),m=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,b=p.strides,_=0;_<h;_++){var w=4*_,x=v[w],C=v[w+1],k=v[w+2],E=v[w+3],S=m[_];if(!(S>=s))for(var I=f>1?(k-x)*(u-1)/(f-1):0,T=d>1?(E-C)*(c-1)/(d-1):0,A=0;A<f;A++){var R=f>1?x*(u-1)+A*I:.5*(x+k)*(u-1);if(R<0||R>u-1)for(var O=0;O<d;O++)for(var N=0;N<l;N++){var D=N+O*b[2]+A*b[1]+_*b[0];p.values[D]=o}else if("bilinear"===i){var P=Math.floor(R),M=Math.ceil(R),F=R-P;for(O=0;O<d;O++)if((H=d>1?C*(c-1)+O*T:.5*(C+E)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=o;else{var L=Math.floor(H),B=Math.ceil(H),j=H-L;for(N=0;N<l;N++){var V=g[D=N+L*y[2]+P*y[1]+S*y[0]],U=g[D=N+B*y[2]+P*y[1]+S*y[0]],z=g[D=N+L*y[2]+M*y[1]+S*y[0]],W=V+(U-V)*j,q=z+(g[D=N+B*y[2]+M*y[1]+S*y[0]]-z)*j;p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=W+(q-W)*F}}}else for(O=0;O<d;++O){var H;if((H=d>1?C*(c-1)+O*T:.5*(C+E)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=o;else{var G=Math.round(H),K=Math.round(R);for(N=0;N<l;N++)p.values[N+O*b[2]+A*b[1]+_*b[0]]=g[N+G*y[2]+K*y[1]+S*y[0]]}}}}return p.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=zB(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=VB(t,e),o=i[0],a=i[1],s=i[2],u=i[3];if(0===a)return PL([],o,t.dtype);for(var c=new $M([a,s],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),f=0;f<a;f++){for(var d=[],p=0,v=0;v<r;v++){var m=l[f*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=t.size/s)throw new Error("Invalid indices: "+d+" does not index into "+t.shape);for(var g=0;g<s;g++)c.values[f*s+g]=h[p*s+g]}return c.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=zB(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=FL(0);return this.scatter(t,e,n,u,a,o,i,s,c,!0)},t.prototype.fill=function(t,e,n){var r=xM(n=n||DM(e),hM(t));return r.fill(e),ZM.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=xM(t.dtype,hM(t.shape));return ZM.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return dj(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,a,s,u,c){var l=[r/i,i],h=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return PL([],n,e.dtype);var d=new $M(l,e.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var v=[],m=0,g=0;g<a;g++){var y=h[p*a+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/i)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<i;b++)c?d.values[m*i+b]+=f[p*i+b]:d.values[m*i+b]=0===e.rank?f[0]:f[p*i+b]}return d.toTensor().reshape(n)},t}();mF.registerBackend("cpu",(function(){return new rH}),1);var iH=function(){function t(){this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder}return t.prototype.encodeUTF8=function(t){return this.textEncoder.encode(t)},t.prototype.decodeUTF8=function(t){return this.textDecoder.decode(t)},t.prototype.fetch=function(t,e){return fetch(t,e)},t}();eM.get("IS_BROWSER")&&eM.setPlatform("browser",new iH);var oH,aH=function(){function t(){var t=n(3);this.textEncoder=new t.TextEncoder,this.textDecoder=new t.TextDecoder}return t.prototype.encodeUTF8=function(t){return this.textEncoder.encode(t)},t.prototype.decodeUTF8=function(t){return 0===t.length?"":this.textDecoder.decode(t)},t.prototype.fetch=function(t,e){return null!=eM.global.fetch?eM.global.fetch(t,e):(null==oH&&(oH=n(2)),oH(t,e))},t}();eM.get("IS_NODE")&&eM.setPlatform("node",new aH);var sH={float32:4,int32:4,uint16:2,uint8:1,bool:1};function uH(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,a=e.shape,s=hM(a),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=sH[c.dtype],h=t.slice(r,r+s*l),f="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(f,(function(t){return t*c.scale+c.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(f,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===o){var d=e,p=new Uint8Array(t.slice(r,r+d.byteLength));u=eM.platform.decodeUTF8(p).split(d.delimiter),r+=d.byteLength}else{var v=sH[o];if(h=t.slice(r,r+s*v),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=s*v}n[i]=PL(u,a,o)},o=0,a=e;o<a.length;o++)i(a[o]);return n}function cH(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var lH="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function hH(t){return lH?Buffer.byteLength(t):new Blob([t]).size}function fH(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function dH(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function pH(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:hH(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:hH(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var vH=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),mH=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){sM(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),sM(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();sM(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function gH(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+mH.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}function yH(t,e,n){return void 0===n&&(n=!1),QP(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h;return JP(this,(function(f){switch(f.label){case 0:return sM(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),sM((r=vH.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),sM(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],sM((o=vH.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),sM(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),a=o[0],s=gH(t).scheme,u=gH(t).path,c=s===gH(t).scheme,[4,i.load()];case 1:return l=f.sent(),n&&c?[4,mH.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return h=f.sent(),!n||c?[3,6]:[4,mH.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}function bH(){if(!eM.getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function _H(t){var e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}var wH=function(){function t(t){if(this.indexedDB=bH(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return _H(i)},i.onsuccess=function(){var o=i.result;if(null==e){var a=o.transaction("models_store","readonly"),s=a.objectStore("models_store").get(n.modelPath);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return o.close(),r(s.error)},a.oncomplete=function(){return o.close()}}else{var u,c=pH(e),l=o.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var i=(u=o.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore("model_info_store")).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},f.onerror=function(t){return o.close(),r(f.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),xH=function(t){return eM.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wH.URL_SCHEME)?(e=t.slice(wH.URL_SCHEME.length),new wH(e)):null;var e};vH.registerSaveRouter(xH),vH.registerLoadRouter(xH);var CH=function(){function t(){this.indexedDB=bH()}return t.prototype.listModels=function(){return QP(this,void 0,void 0,(function(){var t=this;return JP(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return _H(r)},r.onsuccess=function(){var t=r.result,i=t.transaction("model_info_store","readonly"),o=i.objectStore("model_info_store").getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return QP(this,void 0,void 0,(function(){var e=this;return JP(this,(function(n){var r;return t=(r=t).startsWith(wH.URL_SCHEME)?r.slice(wH.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return _H(i)},i.onsuccess=function(){var e,o=i.result,a=o.transaction("model_info_store","readwrite"),s=a.objectStore("model_info_store"),u=s.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),a=function(){var i=(e=o.transaction("models_store","readwrite")).objectStore("models_store").delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=a,i.onerror=function(t){return a(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},a.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(eM.getBool("IS_BROWSER"))try{mH.registerManager(wH.URL_SCHEME,new CH)}catch(oF){}var kH="tensorflowjs_models",EH="info",SH="model_topology",IH="weight_specs",TH="weight_data",AH="model_metadata";function RH(t){return{info:[kH,t,EH].join("/"),topology:[kH,t,SH].join("/"),weightSpecs:[kH,t,IH].join("/"),weightData:[kH,t,TH].join("/"),modelMetadata:[kH,t,AH].join("/")}}function OH(t){var e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}var NH=function(){function t(t){if(!eM.getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=RH(this.modelPath)}return t.prototype.save=function(t){return QP(this,void 0,void 0,(function(){var e,n,r;return JP(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=pH(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,lH?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},t.prototype.load=function(){return QP(this,void 0,void 0,(function(){var t,e,n,r,i,o,a;return JP(this,(function(s){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(lH){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(a),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),DH=function(t){return eM.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(NH.URL_SCHEME)?(e=t.slice(NH.URL_SCHEME.length),new NH(e)):null;var e};vH.registerSaveRouter(DH),vH.registerLoadRouter(DH);var PH=function(){function t(){sM(eM.getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),sM(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return QP(this,void 0,void 0,(function(){var t,e,n,r,i,o;return JP(this,(function(a){for(t={},e=kH+"/",n="/"+EH,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=OH(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return QP(this,void 0,void 0,(function(){var e,n;return JP(this,(function(r){var i;if(t=(i=t).startsWith(NH.URL_SCHEME)?i.slice(NH.URL_SCHEME.length):i,e=RH(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(eM.getBool("IS_BROWSER"))try{mH.registerManager(NH.URL_SCHEME,new PH)}catch(oF){}function MH(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var FH=function(){function t(e){if(!eM.getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return QP(this,void 0,void 0,(function(){var e,n,r,i;return JP(this,(function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,MH((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,MH((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:pH(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),LH=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return QP(this,void 0,void 0,(function(){var t,e,n=this;return JP(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var a=JSON.parse(o.target.result),s=a.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),f.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);f[i]=n,-1===f.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:fH(f)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return dH(t.name)})),i={},o=0,a=t;o<a.length;o++)a[o].paths.forEach((function(t){var o=dH(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function BH(t,e,n,r){!function(t){sM(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){sM(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),sM(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),sM(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var a=n+ ++i/t.length*(r-n);return e(a),o})),o})))}function jH(t,e){return QP(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return JP(this,(function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?WM:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit)})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=h.sent(),[3,4];case 2:return[4,BH(r,e.onProgress,i,o)];case 3:a=h.sent(),h.label=4;case 4:return s=a.map((function(t){return t.arrayBuffer()})),u=.5,c=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=h.sent(),[3,8];case 6:return[4,BH(s,e.onProgress,u,c)];case 7:l=h.sent(),h.label=8;case 8:return[2,l]}}))}))}function VH(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),QP(e,void 0,void 0,(function(){var e,o,a,s,u,c,l,h,f,d;return JP(this,(function(p){switch(p.label){case 0:if(e=n.map((function(){return!1})),o={},a=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u=sH["quantization"in t?t.quantization.dtype:t.dtype]*hM(t.shape),c=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach((function(e,n){e===t.name&&(c(),a[n]=!0)})):c(),s.push(t.name),r+=u}))})),!a.every((function(t){return t})))throw u=i.filter((function(t,e){return!a[e]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),l=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;l.push(e)}))})),[4,t(l)];case 1:return h=p.sent(),f={},d=0,c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[d+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,c=0;c<e;c++){var l=new Uint8Array(h[d+c]);s.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=uH(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)f[n]=e[n]})),d+=e})),[2,f]}}))}))}}vH.registerSaveRouter((function(t){return eM.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(FH.URL_SCHEME)?(void 0===(e=t.slice(FH.URL_SCHEME.length))&&(e="model"),new FH(e)):null;var e}));var UH=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(sM("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=WM,sM(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&sM(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return QP(this,void 0,void 0,(function(){var e,n;return JP(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:pH(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return QP(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s;return JP(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:s=u.sent(),o=s[0],a=s[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:a}]}}))}))},t.prototype.loadWeights=function(t){return QP(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l;return JP(this,(function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,a=[],s=0,u=t;s<u.length;s++)a.push.apply(a,u[s].weights);return c=[],t.forEach((function(t){t.paths.forEach((function(t){c.push(o+t+i)}))})),[4,jH(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return l=h.sent(),[2,[a,fH(l)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function zH(t){return null!=t.match(UH.URL_SCHEME_REGEX)}var WH=function(t,e){return(Array.isArray(t)?t.every((function(t){return zH(t)})):zH(t))?qH(t,{onProgress:e}):null};function qH(t,e){return new UH(t,e)}vH.registerSaveRouter(WH),vH.registerLoadRouter(WH);var HH=function(){function t(t,e,n,r){this.modelTopology=t,this.weightSpecs=e,this.weightData=n,this.trainingConfig=r}return t.prototype.load=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){return t={},null!=this.modelTopology&&(t=YP({modelTopology:this.modelTopology},t)),null!=this.weightSpecs&&this.weightSpecs.length>0&&(t=YP({weightSpecs:this.weightSpecs},t)),null!=this.weightData&&this.weightData.byteLength>0&&(t=YP({weightData:this.weightData},t)),null!=this.trainingConfig&&(t=YP({trainingConfig:this.trainingConfig},t)),[2,t]}))}))},t}(),GH=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),KH=(Object.freeze({browserFiles:function(t){return new LH(t)},browserHTTPRequest:function(t,e){return qH(t,e)},concatenateArrayBuffers:fH,decodeWeights:uH,encodeWeights:function(t,e){return QP(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return JP(this,(function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),o=function(o){var a=i[o],u=Array.isArray(t)?t[o].tensor:t[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+u.dtype);var c={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(t){return QP(s,void 0,void 0,(function(){var e,n,r;return JP(this,(function(i){switch(i.label){case 0:return e=c,[4,u.data()];case 1:return n=i.sent(),r=eM.platform.encodeUTF8(n.join("\0")),e.byteLength=r.length,e.delimiter="\0",t(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=e&&(c.group=e),n.push(c)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:cH(u.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return new HH(t,e,n,r)},getLoadHandlers:function(t,e){return vH.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:pH,getSaveHandlers:function(t){return vH.getSaveHandlers(t)},http:qH,isHTTPScheme:zH,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),QP(this,void 0,void 0,(function(){return JP(this,(function(i){return[2,VH((function(t){return jH(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return vH.registerLoadRouter(t)},registerSaveRouter:function(t){return vH.registerSaveRouter(t)},weightsLoaderFactory:VH,withSaveHandler:function(t){return new GH(t)},copyModel:function(t,e){return QP(this,void 0,void 0,(function(){return JP(this,(function(n){return[2,yH(t,e,!1)]}))}))},listModels:function(){return QP(this,void 0,void 0,(function(){var t,e,n,r,i,o,a;return JP(this,(function(s){switch(s.label){case 0:t=mH.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?[4,mH.getManager(i=r[n]).listModels()]:[3,4];case 2:for(a in o=s.sent())e[i+"://"+a]=o[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return QP(this,void 0,void 0,(function(){return JP(this,(function(n){return[2,yH(t,e,!0)]}))}))},removeModel:function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){return e=gH(t),[2,mH.getManager(e.scheme).removeModel(e.path)]}))}))}}),RL({confusionMatrix_:function(t,e,n){var r=yL(t,"labels","confusionMatrix"),i=yL(e,"predictions","confusionMatrix");sM(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),sM(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),sM(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),sM(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),sM(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=bB(r.asType("int32"),n),a=bB(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}})),XH=(Object.freeze({confusionMatrix:KH}),RL({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return mF.fromPixels(t,e)}})),$H=Object.freeze({toPixels:function(t,e){return QP(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w,x;return JP(this,(function(C){switch(C.label){case 0:if(n=yL(t,"img","toPixels"),t instanceof ZM||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),h=l[0][0],f=l[1][0],u.dispose(),c.dispose(),"float32"===n.dtype){if(h<0||f>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+f+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||f>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+f+"].")}for(d="float32"===n.dtype?255:1,p=new Uint8ClampedArray(o*i*4),v=0;v<i*o;++v)m=void 0,g=void 0,y=void 0,b=void 0,1===a?(m=s[v]*d,g=s[v]*d,y=s[v]*d,b=255):3===a?(m=s[3*v]*d,g=s[3*v+1]*d,y=s[3*v+2]*d,b=255):4===a&&(m=s[4*v]*d,g=s[4*v+1]*d,y=s[4*v+2]*d,b=s[4*v+3]*d),p[0+(_=4*v)]=Math.round(m),p[_+1]=Math.round(g),p[_+2]=Math.round(y),p[_+3]=Math.round(b);return null!=e&&(e.width=o,e.height=i,w=e.getContext("2d"),x=new ImageData(p,o,i),w.putImageData(x,0,0)),n!==t&&n.dispose(),[2,p]}}))}))},fromPixels:XH}),YH=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),QH=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function JH(t){sM(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),sM("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),sM(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),QH.register(t)}function ZH(){return 32===mF.backend.floatPrecision()?.001:.1}function tG(t,e,n){var r=!0;if((IM(t)||IM(e))&&(r=!1),IM(t)&&IM(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var a=mL(t),s=mL(e);if(!fM(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=IM(t)?t:lM(t),c=IM(e)?e:lM(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],f=c[l];if(!n(h,f))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+f+".\nActual:   "+u+".\nExpected: "+c+".")}}function eG(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({Serializable:YH,SerializationMap:QH,registerClass:JH}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=ZH()),tG(t,e,(function(t,e){return eG(t,e,n)}))},testEpsilon:ZH,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return RM(t)||RM(t[0])||RM(e)||RM(e[0])?tG(t,n,(function(t,e){return t==e})):tG(t,e,(function(t,e){return eG(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=ZH()),!eG(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Object.freeze({gpgpu_util:KV,webgl_util:hL,MathBackendWebGL:FU,setWebGLContext:_F,GPGPUContext:XV});var nG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $P(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var a=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(a)}else this.applyGradients(o);return pL(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){sM(PM(t),(function(){return"The f passed in variableGrads(f) must be a function"})),sM(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof aF})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],mF.registeredVariables)e.push(mF.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;sM((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var a=mF.gradients(t,e,null,!0),s=a.value,u=a.grads;sM(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),sM(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&pL(this.iterations_)},e.prototype.saveIterations=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:FL(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(YH);Object.defineProperty(nG,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var rG=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=mF.backend.epsilon()),i}return $P(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=mF.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:dL((function(){return GL(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:dL((function(){return GL(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;dL((function(){var t=a.mul(e.rho).add(o.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(a.add(e.epsilon).sqrt()).mul(o),r=s.mul(e.rho).add(n.square().mul(1-e.rho));a.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(pL(this.accumulatedGrads.map((function(t){return t.variable}))),pL(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="AdadeltaOptimizer",e}(nG);JH(rG);var iG=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return $P(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=mF.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:dL((function(){return WL(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable;dL((function(){var t=a.add(o.square());a.assign(t);var n=o.div(t.add(mF.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&pL(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(nG);JH(iG);var oG=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],dL((function(){o.accBeta1=FL(n).variable(),o.accBeta2=FL(r).variable()})),null==i&&(o.epsilon=mF.backend.epsilon()),o}return $P(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);dL((function(){var r=$W(1,e.accBeta1),i=$W(1,e.accBeta2);n.forEach((function(n,o){var a=mF.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:dL((function(){return GL(a).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:dL((function(){return GL(a).variable(!1)}))});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedSecondMoment[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=l.div(r),d=h.div(i);u.assign(l),c.assign(h);var p=f.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(a);a.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&pL(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&pL(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){var e,n=this;return JP(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),dL((function(){n.accBeta1.assign(HW(n.beta1,n.iterations_+1)),n.accBeta2.assign(HW(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(nG);JH(oG);var aG=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],dL((function(){a.iteration=FL(0).variable(),a.accBeta1=FL(n).variable()})),null==i&&(a.epsilon=mF.backend.epsilon()),a}return $P(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);dL((function(){var r=$W(1,e.accBeta1),i=PW(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var a=mF.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:GL(a).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:GL(a).variable(!1)});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedWeightedInfNorm[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2),f=s.abs(),d=h.maximum(f);u.assign(l),c.assign(d);var p=i.div(r).mul(l.div(d.add(e.epsilon))).add(a);a.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&pL(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&pL(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(nG);JH(aG);var sG=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return $P(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=mF.registeredVariables[n];dL((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function(t){return mF.keep(t)}(FL(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(nG);JH(sG);var uG=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=FL(i.momentum),i}return $P(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=mF.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:dL((function(){return GL(i).variable(!1)}))});var o=e.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[n];null!=a&&dL((function(){var t,n=e.m.mul(o).add(a);t=e.useNesterov?e.c.mul(a.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&pL(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){return JP(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){return JP(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="MomentumOptimizer",e}(sG);JH(uG);var cG=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var a=t.call(this)||this;return a.learningRate=e,a.decay=n,a.momentum=r,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,null==i&&(a.epsilon=mF.backend.epsilon()),a}return $P(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=mF.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:dL((function(){return GL(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:dL((function(){return GL(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:dL((function(){return GL(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;dL((function(){var t=a.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),c=s.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));a.assign(t),n.assign(u),s.assign(c);var l=i.sub(c);i.assign(l)}else{var h=a.mul(e.decay).add(o.square().mul(1-e.decay));c=s.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),a.assign(h),s.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&pL(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&pL(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&pL(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return QP(this,void 0,void 0,(function(){var t;return JP(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return QP(this,void 0,void 0,(function(){var e;return JP(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(nG);JH(cG),function(){function t(){}t.sgd=function(t){return new sG(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new uG(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new cG(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new oG(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new rG(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new aG(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new iG(t,e)}}(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate,QM=nH;var lG=function(t,e){return(lG=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function hG(t,e){function n(){this.constructor=t}lG(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function fG(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function dG(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var pG=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=vG(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function vG(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e}var mG=null;function gG(t){mG=t}function yG(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function bG(t,e,n){return Math.max(t,Math.min(e,n))}function _G(t){return t%2==0?t:t+1}function wG(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function xG(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function CG(t,e,n){void 0===n&&(n=""),xG(IG(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function kG(t){xG(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function EG(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||UG(t)&&!n)for(var r=0;r<t.length;++r)EG(t[r],e,n);else e.push(t);return e}function SG(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function IG(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function TG(t){return t%1==0}function AG(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function RG(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function OG(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function NG(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0;!function a(){if(t())r();else{var s=e(++o);null!=n&&o>=n?i():setTimeout(a,s)}}()}))}function DG(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function PG(t,e){var n=e.length;return xG((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),xG(t.every((function(t){return TG(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function MG(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:PG(e,t).sort(),a=0,s=0;s<t.length;++s){if(null!=o){if(o[a]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==o[a]||o[a]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),o[a]<=s&&a++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function FG(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function LG(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function BG(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function jG(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function VG(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function UG(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function zG(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function WG(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function qG(t){return"string"==typeof t||t instanceof String}function HG(t){return"boolean"==typeof t}function GG(t){return"number"==typeof t}function KG(t){return Array.isArray(t)?KG(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":GG(t)?"float32":qG(t)?"string":HG(t)?"bool":"float32"}function XG(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $G(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function YG(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function QG(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=EG(t)),n&&BG(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function JG(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],a=0;a<o;a++)i[a]=r[e+a];else{o=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(a=0;a<o;a++)i[a]=t(e+a*u,s,r)}return i}(0,t,e)}function ZG(t,e){for(var n=tK(t,e),r=0;r<n.length;r++)n[r]=1;return n}function tK(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function eK(){return mG.platform.now()}function nK(t){t.forEach((function(e){xG(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function rK(t,e){return void 0===e&&(e="utf-8"),mG.platform.encode(t,e=e||"utf-8")}function iK(t,e){return void 0===e&&(e="utf-8"),mG.platform.decode(t,e=e||"utf-8")}Object.freeze({Environment:pG,getQueryParams:vG,get ENV(){return mG},setEnvironmentGlobal:gG}),Object.freeze({shuffle:yG,clamp:bG,nearestLargerEven:_G,sum:wG,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:xG,assertShapesMatch:CG,assertNonNull:kG,flatten:EG,sizeFromShape:SG,isScalarShape:function(t){return 0===t.length},arraysEqual:IG,isInt:TG,tanh:AG,sizeToSquarishShape:RG,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return yG(e),e},rightPad:OG,repeatedTry:NG,inferFromImplicitShape:DG,parseAxisParam:PG,squeezeShape:MG,getTypedArrayFromDType:FG,getArrayFromDType:LG,checkConversionForErrors:BG,isValidDtype:jG,hasEncodingLoss:VG,isTypedArray:UG,bytesPerElement:zG,bytesFromStringArray:WG,isString:qG,isBoolean:HG,isNumber:GG,inferDtype:KG,isFunction:XG,nearestDivisor:$G,computeStrides:YG,toTypedArray:QG,toNestedArray:JG,makeOnesTypedArray:ZG,makeZerosTypedArray:tK,now:eK,assertNonNegativeIntegerDimensions:nK,fetch:function(t,e){return mG.platform.fetch(t,e)},encodeString:rK,decodeString:iK});var oK=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new aK)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,o=this.backendTimer.time((function(){r=n()}));return(Array.isArray(r)?r:[r]).forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),o.then((function(o){var a="";null!=o.getExtraProfileInfo&&(a=o.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,o.kernelMs,e,a)}))}))})),r},t}(),aK=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,o){var a=OG(r+"ms",9),s=OG(t,25),u=e.rank,c=e.size,l=OG(e.shape.toString(),14),h="";for(var f in i){var d=i[f].shape,p=d.length;h+=f+": "+p+"D "+(p>0?d:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+h+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function sK(t,e,n){return OG(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":qG(t)?"'"+t+"'":"bool"===n?uK(t):parseFloat(t.toFixed(7)).toString(),e)}function uK(t){return 0===t?"false":"true"}function cK(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var lK=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=SG(t),null!=n){var i=n.length;xG(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||LG(e,this.size),this.strides=YG(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),xG(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var a="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return pK.make(this.shape,{values:this.values},this.dtype)},t}(),hK=null,fK=null,dK=null,pK=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=SG(t),this.strides=YG(t),this.dataId=null!=r?r:{},this.id=hK().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",hK().registerTensor(this,i),null!=n&&hK().write(i,this.dataId,n)}return t.make=function(e,n,r,i){var o=n.values;return null!=n.values&&"string"===r&&qG(n.values[0])&&(o=n.values.map((function(t){return rK(t)}))),new t(e,r,o,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),xG(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),fK.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,fK.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return fK.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,JG(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return JG(this.shape,this.dataSync())},t.prototype.data=function(){return fG(this,void 0,void 0,(function(){var t,e;return dG(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=hK().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return iK(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=hK().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return iK(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,hK().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(hK().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),fK.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),fK.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),fK.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),fK.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),fK.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),fK.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),fK.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=YG(e),o=function(t,e,n,r){var i=SG(e),o=r[r.length-1],a=new Array(o).fill(0),s=e.length,u="complex64"===n?cK(t):t;if(s>1)for(var c=0;c<i/o;c++)for(var l=c*o,h=0;h<o;h++)a[h]=Math.max(a[h],sK(u[l+h],0,n).length);return a}(t,e,n,i),a=e.length,s=function t(e,n,r,i,o,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[sK(cK(e)[0],0,r)]:"bool"===r?[uK(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=Array.from(e.slice(0,3*s)),h=Array.from(e.slice(u-3*s,u));return"complex64"===r&&(l=cK(l),h=cK(h)),["["+l.map((function(t,e){return sK(t,o[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return sK(t,o[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?cK(e):Array.from(e)).map((function(t,e){return sK(t,o[e],r)})).join(", ")+"]"]}var f=n.slice(1),d=i.slice(1),p=i[0]*s,v=[];if(u>20){for(var m=0;m<3;m++)v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,!1));for(v.push("..."),m=u-3;m<u;m++)v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,m===u-1))}else for(m=0;m<u;m++){var g;v.push.apply(v,t(e.slice(g=m*p,g+p),f,r,d,o,m===u-1))}var y=2===c?",":"";for(v[0]="["+v[0]+y,m=1;m<v.length-1;m++)v[m]=" "+v[m]+y;var b=",\n";for(m=2;m<c;m++)b+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":b),v}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),fK.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),fK.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),fK.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),fK.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),fK.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),fK.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),fK.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),fK.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),fK.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),fK.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),fK.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),fK.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),dK("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),fK.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),fK.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),fK.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),fK.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),fK.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),fK.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),fK.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),fK.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),fK.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),fK.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),fK.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),fK.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),fK.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),fK.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),fK.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),fK.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),fK.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),fK.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),fK.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),fK.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),fK.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),fK.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),fK.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),fK.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),fK.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),fK.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),fK.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),fK.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),fK.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),fK.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),fK.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),fK.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),fK.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),fK.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),fK.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),fK.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),fK.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),fK.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),fK.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),fK.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),fK.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),fK.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),fK.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),fK.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),fK.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),fK.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),fK.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),fK.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),fK.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),fK.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),fK.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),fK.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),fK.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),fK.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),fK.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),fK.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),fK.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),fK.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),fK.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),fK.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),fK.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),fK.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),fK.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),fK.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),fK.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),fK.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),fK.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),fK.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),fK.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),fK.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),fK.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),fK.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),fK.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),fK.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),fK.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),fK.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),fK.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),fK.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),fK.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),fK.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),fK.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),fK.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),fK.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),fK.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),fK.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),fK.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),fK.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),fK.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),fK.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),fK.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),fK.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),fK.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),fK.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),fK.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),fK.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),fK.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),fK.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),fK.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),_K.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),fK.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),fK.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),fK.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),fK.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),fK.stridedSlice(this,t,e,n,r,i,o,a,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),fK.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),fK.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),fK.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),fK.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),fK.spectral.irfft(this)},t}();Object.defineProperty(pK,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var vK,mK,gK,yK,bK,_K=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=hK().nextVariableId().toString());try{hK().registerVariable(i)}catch(t){throw hK().disposeTensor(i),t}return i}return hG(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!IG(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");hK().disposeTensor(this),this.dataId=t.dataId,hK().registerTensor(this)},e.prototype.dispose=function(){hK().disposeVariable(this),this.isDisposedInternal=!0},e}(pK);Object.defineProperty(_K,Symbol.hasInstance,{value:function(t){return t instanceof pK&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(vK||(vK={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(mK||(mK={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(gK||(gK={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(yK||(yK={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(bK||(bK={}));var wK={float32:yK,int32:mK,bool:gK,complex64:bK};function xK(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return wK[t][e]}function CK(t){return xK(t,"int32")}function kK(t,e){if(t.dtype===e.dtype)return[t,e];var n=xK(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function EK(t,e){xG(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function SK(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof pK)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var a in o){var s=o[a];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:kK,assertTypesMatch:EK,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:SK});var IK,TK=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),AK=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new TK}return t.prototype.ready=function(){return fG(this,void 0,void 0,(function(){var t,e,n;return dG(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return fG(this,void 0,void 0,(function(){var e,n,r;return dG(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new oK(this.backendInstance),[2,!0]}}))}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=pK.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,(function(t){return[t.toFloat()]})),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],a=this.isTapeOn(),s=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){a&&(o=t.map((function(t){return i.keep(i.clone(t))})))},c=this.state.numBytes,l=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(s,e,(function(){return t(i.backend,u)})):t(i.backend,u)})),a){var h={id:this.state.nextTapeNodeId++,name:s,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShape:Array.isArray(r)?r.map((function(t){return t.shape})):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*zG(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof _K||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return fG(this,void 0,void 0,(function(){var e,n;return dG(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach((function(t,e){r[e]=t}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=SK(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==a.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),xG(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));xG(o instanceof pK,(function(){return"The result y returned by f() must be a tensor."}));var a=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var a=(p=t[o]).inputs;for(var s in a){for(var u=a[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var f={};for(o=t.length-1;o>=0;o--)for(a=(p=t[o]).inputs,l=0;l<p.outputs.length;l++)if(h[p.outputs[l].id]){for(var s in a)h[a[s].id]=!0,f[p.id]=!0;break}var d=[];for(o=0;o<t.length;o++){var p;if(i[(p=t[o]).id]&&f[p.id]){var v={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},p);g.inputs=v,g.outputs=p.outputs,d.push(g)}}return d}(this.state.activeTape,e,o);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[o.id]=null==n?(r=ZG(SG(t=o.shape),"float32"),pK.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=pK.make(e.shape,{values:tK(e.size,e.dtype)},e.dtype);o.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var a=i.gradient(1===i.outputs.length?o[0]:o),s=function(e){if(!(e in a))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!IG(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var s=t[o.id];t[o.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=e.length-1;i>=0;i--)r(i)}(s,a,(function(t){return i.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return xG(XG(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];xG(r.every((function(t){return t instanceof pK})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernel((function(e,i){return xG((n=t.apply(void 0,r.concat([i]))).value instanceof pK,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),xG(XG(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];xG(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),xG(o.every((function(t){return t instanceof pK})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return o.forEach((function(t,e){a[e]=function(){return t}})),a}))}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=WG(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return fG(this,void 0,void 0,(function(){var e,n;return dG(this,(function(r){switch(r.label){case 0:return e=eK(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=eK()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new TK,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),RK=function(){var t=function(){if(null==IK){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}IK=t}return IK}();if(null==t._tfengine){var e=new pG(t);t._tfengine=new AK(e)}return gG(t._tfengine.ENV),hK=function(){return t._tfengine},t._tfengine}();function OK(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}mG.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),mG.registerFlag("IS_BROWSER",(function(){return OK()})),mG.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),mG.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),mG.registerFlag("PROD",(function(){return!1})),mG.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return mG.getBool("DEBUG")})),mG.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),mG.registerFlag("IS_TEST",(function(){return!1}));var NK,DK,PK={},MK={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function FK(t,e){PK[t]=e}function LK(t){t in PK||(PK[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=BK(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete PK[t]}),!1),1===t?e.getContext("webgl",MK)||e.getContext("experimental-webgl",MK):e.getContext("webgl2",MK)}(t));var e=PK[t];return e.isContextLost()?(delete PK[t],LK(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),PK[t])}function BK(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function jK(t,e){return[e,t]}function VK(t){var e=SG(t);return RG(Math.ceil(e/4))}function UK(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function zK(t,e){var n,r,i,o,a,s,u,c,l,h=t;return 2===mG.getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,o=h.RGBA32F,a=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=h.RGBA,a=t.RGBA,s=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function WK(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+HK(t,e))}(t),r}function qK(t){return!!(mG.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function HK(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function GK(t,e,n){return vX(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function KK(t,e,n){var r=vX(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(WK(t,e,(function(){return t.shaderSource(r,n)})),WK(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function XK(t,e,n){var r=vX(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(WK(t,e,(function(){return t.shaderSource(r,n)})),WK(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=QK.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,a=i.map((function(t,e){return OG((e+1).toString(),o)+t})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var c=a.slice(0,r-1),l=a.slice(r-1,r),h=a.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+OG(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(NK||(NK={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(DK||(DK={}));var $K,YK,QK=/ERROR: [0-9]+:([0-9]+):/g;function JK(t,e){return vX(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function ZK(t,e,n){if(WK(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function tX(t,e,n){if(WK(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function eX(t,e,n){var r=vX(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return WK(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),WK(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function nX(t,e,n){var r=vX(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return WK(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),WK(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function rX(t,e){return vX(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function iX(t,e){var n=mG.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function oX(t,e){return vX(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function aX(t,e,n,r,i,o,a,s){var u=t.getAttribLocation(n,r);return-1!==u&&(WK(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),WK(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,a,s)})),WK(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function sX(t,e,n,r){mX(t,r),WK(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function uX(t,e,n,r){return vX(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function cX(t,e,n){return t.getUniformLocation(e,n)}function lX(t,e,n,r,i,o){WK(t,e,(function(){return sX(t,e,r,o)})),WK(t,e,(function(){return t.uniform1i(i,o)}))}function hX(t,e,n,r){WK(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),WK(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function fX(t,e,n){WK(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),WK(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function dX(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+pX(t,e))}function pX(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function vX(t,e,n,r){var i=WK(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function mX(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function gX(t,e){return void 0===e&&(e=2),SG(t.slice(0,t.length-e))}function yX(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function bX(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[gX(t)].concat(yX(t))),e}function _X(t,e){var n;void 0===e&&(e=!1);var r=mG.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?_G(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=MG(t);t=i.newShape}var o=SG(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=gX(t),s=2,u=2;return t.length&&(s=(n=yX(t))[0],u=n[1]),RG(o=a*(s/2)*(u/2)).map((function(t){return 2*t}))}return RG(o)}function wX(t){return t%2==0}function xX(t,e){if(IG(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(wX(n)&&wX(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&wX(t[0])&&wX(e[0])}function CX(t){if(null==$K){var e=LK(t);$K=e.getParameter(e.MAX_TEXTURE_SIZE)}return $K}function kX(t){if(null==YK){var e=LK(t);YK=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,YK)}function EX(t){if(0===t)return 0;var e=LK(t);return SX(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:SX(e,"EXT_disjoint_timer_query")?1:0}function SX(t,e){return null!=t.getExtension(e)}function IX(t){try{if(null!=LK(t))return!0}catch(t){return!1}return!1}function TX(t){if(0===t)return!1;var e=LK(t);if(1===t){if(!SX(e,"OES_texture_float"))return!1}else if(!SX(e,"EXT_color_buffer_float"))return!1;return RX(e)}function AX(t){if(0===t)return!1;var e=LK(t);if(1!==t){if(SX(e,"EXT_color_buffer_float"))return RX(e);if(SX(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=zK(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),o}(e,n)}return!1}return!!SX(e,"OES_texture_float")&&!!SX(e,"WEBGL_color_buffer_float")&&RX(e)}function RX(t){var e=zK(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function OX(t){return 2===t&&null!=LK(t).fenceSync}var NX=Object.freeze({callAndCheck:WK,canBeRepresented:qK,getWebGLErrorMessage:HK,getExtensionOrThrow:GK,createVertexShader:KK,createFragmentShader:XK,createProgram:JK,linkProgram:ZK,validateProgram:tX,createStaticVertexBuffer:eX,createStaticIndexBuffer:nX,getNumChannels:function(){return 2===mG.getNumber("WEBGL_VERSION")?1:4},createTexture:rX,validateTextureSize:iX,createFramebuffer:oX,bindVertexBufferToProgramAttribute:aX,bindTextureUnit:sX,unbindTextureUnit:function(t,e,n){mX(t,n),WK(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:uX,getProgramUniformLocation:cX,bindTextureToProgramUniformSampler:lX,bindCanvasToFramebuffer:function(t,e){WK(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),WK(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),WK(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:hX,unbindColorTextureFromFramebuffer:fX,validateFramebuffer:dX,getFramebufferErrorMessage:pX,getBatchDim:gX,getRowsCols:yX,getShapeAs3D:bX,getTextureShapeFromLogicalShape:_X,isReshapeFree:xX,getWebGLMaxTextureSize:CX,resetMaxTextureSize:function(){$K=null},resetMaxTexturesInShader:function(){YK=null},getMaxTexturesInShader:kX,getWebGLDisjointQueryTimerVersion:EX,hasExtension:SX,isWebGLVersionEnabled:IX,isCapableOfRenderingToFloatTexture:TX,isDownloadFloatTextureEnabled:AX,isWebGLFenceEnabled:OX});function DX(t){mG.getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function PX(t,e){return RK.tidy(t,e)}function MX(t){SK(t).forEach((function(t){return t.dispose()}))}function FX(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];mG.getBool("IS_TEST")||console.warn.apply(console,t)}function LX(t,e){var n=t;if(UG(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||UG(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&mG.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||UG(e)){xG(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),xG(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else xG(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function BX(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function jX(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof pK)return BX(r,t.dtype,e,n),t;var i=KG(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),BX(r,i,e,n),null==t||!UG(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=LX(t,i);UG(t)||Array.isArray(t)||(t=[t]);var a="string"!==i?QG(t,i,mG.getBool("DEBUG")):EG(t,[],!0);return pK.make(o,{values:a},i)}function VX(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return jX(t,e+"["+r+"]",n)}),r)}function UX(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function zX(t,e,n){for(var r=t.length+e.length,i=[],o=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[o++]):i.push(e[a++]);return i}function WX(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function qX(t,e){return zX(t,e.map((function(t){return 1})),e)}function HX(t,e,n){xG(UX(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function GX(t,e){if(UX(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function KX(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function XX(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function $X(t,e){var n=t[0].length;t.forEach((function(t,e){xG(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),xG(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)xG(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function YX(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function QX(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];RK.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),RK.endScope(i),i}catch(t){throw RK.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}mG.registerFlag("HAS_WEBGL",(function(){return mG.getNumber("WEBGL_VERSION")>0})),mG.registerFlag("WEBGL_VERSION",(function(){return IX(2)?2:IX(1)?1:0})),mG.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===mG.get("WEBGL_VERSION")})),mG.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),mG.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),mG.registerFlag("WEBGL_PACK",(function(){return mG.getBool("HAS_WEBGL")})),mG.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_CLIP",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),mG.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_PACK_REDUCE",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_CONV_IM2COL",(function(){return mG.getBool("WEBGL_PACK")})),mG.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return CX(mG.getNumber("WEBGL_VERSION"))})),mG.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return kX(mG.getNumber("WEBGL_VERSION"))})),mG.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=mG.getNumber("WEBGL_VERSION");return 0===t?0:EX(t)})),mG.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),mG.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return TX(mG.getNumber("WEBGL_VERSION"))})),mG.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!mG.getBool("WEBGL_FORCE_F16_TEXTURES")&&mG.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),mG.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return AX(mG.getNumber("WEBGL_VERSION"))})),mG.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return OX(mG.getNumber("WEBGL_VERSION"))})),mG.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return mG.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),dK=DX;var JX=QX({complex_:function(t,e){var n=jX(t,"real","complex"),r=jX(e,"imag","complex");return CG(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),RK.runKernel((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),ZX=QX({real_:function(t){var e=jX(t,"input","real");return RK.runKernel((function(t){return t.real(e)}),{$input:e})}}),t$=QX({imag_:function(t){var e=jX(t,"input","imag");return RK.runKernel((function(t){return t.imag(e)}),{$input:e})}});function e$(t,e,n){return n$(t,e,LX(t,n),n)}function n$(t,e,n,r){if(null==r&&(r=KG(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!UG(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){nK(e);var i=SG(e),o=SG(n);xG(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var a=0;a<n.length;++a){var s=a!==n.length-1||n[a]!==SG(e.slice(a));xG(n[a]===e[a]||!s,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return UG(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?QG(t,r,mG.getBool("DEBUG")):EG(t,[],!0),pK.make(e,{values:t},r)}function r$(t,e){if((UG(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&UG(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return n$(t,[],[],e)}function i$(t,e){kG(t);var n=LX(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return n$(t,null,n,e)}function o$(t,e,n){if(kG(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=LX(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return n$(t,e,r,n)}function a$(t,e,n){if(kG(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=LX(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return n$(t,e,r,n)}function s$(t,e,n){if(kG(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=LX(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return n$(t,e,r,n)}function u$(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=u$(t,"float32"),r=c$(t,"float32");return JX(n,r)}var i=ZG(SG(t),e);return pK.make(t,{values:i},e)}function c$(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=c$(t,"float32"),r=c$(t,"float32");return JX(n,r)}var i=tK(SG(t),e);return pK.make(t,{values:i},e)}function l$(t,e,n){return RK.runKernel((function(r){return r.fill(t,e,n)}),{})}function h$(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return c$([0],r);var i=tK(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return i$(i,r)}var f$=QX({onesLike_:function(t){var e=jX(t,"x","onesLike");if("complex64"===e.dtype){var n=f$(ZX(e)),r=d$(t$(e));return JX(n,r)}return RK.runKernel((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return d$(t)}}}))}}),d$=QX({zerosLike_:function(t){var e=jX(t,"x","zerosLike");return RK.runKernel((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return d$(t)}}}))}}),p$=QX({concat_:function(t,e){void 0===e&&(e=0),xG(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=VX(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=PG(e,n[0].shape)[0];var r=YX(n.map((function(t){return t.shape})),e);if(0===SG(r))return e$([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return $X(i,e),RK.runKernel((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return b$(t,n,e).map((function(t){return function(){return t}}))}))}}),v$=QX({concat1d_:function(t){return p$(t,0)}}),m$=QX({concat2d_:function(t,e){return p$(t,e)}}),g$=QX({concat3d_:function(t,e){return p$(t,e)}}),y$=QX({concat4d_:function(t,e){return p$(t,e)}}),b$=QX({split_:function(t,e,n){void 0===n&&(n=0);var r,i=jX(t,"x","split");return n=PG(n,i.shape)[0],"number"==typeof e?(xG(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(xG(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),RK.runKernel((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return p$(t,n)}}}))}});function _$(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var w$=_$((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.alea=o}(0,t)})),x$=_$((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor128=o}(0,t)})),C$=_$((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)})),k$=_$((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.x&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)})),E$=_$((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=s[127&o]^=r+(a=a+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=a,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.X&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)})),S$=_$((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.tychei=o}(0,t)})),I$=_$((function(t){!function(e,r){var i,o=this,a=256,s="random",u=r.pow(a,6),c=r.pow(2,52),l=2*c,h=255;function f(t,n,h){var f=[],g=v(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,m(e)]}}():t,3),f),y=new d(f),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(m(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&p(i,y),t.state=function(){return p(y,{})}),n?(r[s]=t,e):t})(b,g,"global"in n?n.global:this==r,n.state)}function d(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=h&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*a+s[h&(s[i]=s[o=h&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=f,v(r.random(),e),t.exports){t.exports=f;try{i=n(4)}catch(t){}}}([],Math)}));I$.alea=w$,I$.xor128=x$,I$.xorwow=C$,I$.xorshift7=k$,I$.xor4096=E$,I$.tychei=S$;var T$=I$.alea,A$=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=T$(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*o*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),R$=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=T$(i.toString()),this.randn=new A$(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-(o*=o*o)+Math.log(o)),(i=this.randu())<e||Math.log(i)<n)break}return o*=1/this.beta*this.d,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),O$=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=T$(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function N$(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",nK(t),new lK(t,e,n)}var D$=QX({batchToSpaceND_:function(t,e,n){var r=jX(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return xG(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),xG(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),xG(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),RK.runKernel((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),P$=QX({cast_:function(t,e){var n=jX(t,"x","cast");if(!jG(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return RK.runKernel((function(t){return t.cast(n,e)}),{$x:n},(function(t){return{$x:function(){return t.clone()}}}))}}),M$=QX({clone_:function(t){var e=jX(t,"x","clone",null);return RK.runKernel((function(t){return pK.make(e.shape,{dataId:e.dataId},e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),F$=QX({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=jX(t,"x","cumsum"),o=GX([e|=0],i.rank),a=i;null!=o&&(a=i.transpose(o));var s=XX(1,i.rank)[0],u=RK.runKernel((function(t){return t.cumsum(a,s,n,r)}),{permutedX:a},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),L$=QX({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=jX(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return xG(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),xG(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),xG(a%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape})),RK.runKernel((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),B$=QX({expandDims_:function(t,e){void 0===e&&(e=0);var n=jX(t,"x","expandDims",null);xG(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(xG(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),Q$(n,r)}}),j$=QX({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=N$([t,e],r),o=t<=e?t:e,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return eY(B$(s,0),[n[0],1,1]);if(2===n.length)return eY(B$(B$(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return eY(B$(B$(B$(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),V$=QX({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=jX(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?i.as2D(1,-1):i,u=RK.runKernel((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===a?u.as1D():u}}),U$=QX({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=jX(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),RK.runKernel((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return c$(i.shape,"float32")}}})).reshape(o)}}),z$=QX({pad_:function(t,e,n){void 0===n&&(n=0);var r=jX(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map((function(t){return t[0]}));return RK.runKernel((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(i,r.shape)}}}))}}),W$=QX({pad1d_:function(t,e,n){return void 0===n&&(n=0),xG(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),z$(t,[e],n)}}),q$=QX({pad2d_:function(t,e,n){return void 0===n&&(n=0),xG(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),z$(t,e,n)}}),H$=QX({pad3d_:function(t,e,n){return void 0===n&&(n=0),xG(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),z$(t,e,n)}}),G$=QX({pad4d_:function(t,e,n){return void 0===n&&(n=0),xG(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),z$(t,e,n)}}),K$=QX({rand_:function(t,e,n){var r=SG(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return pK.make(t,{values:i},n)}}),X$=QX({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new A$(e,n,r,!1,i),a=N$(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),$$=QX({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var o=new R$(e,n,r,i),a=N$(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Y$=QX({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=N$(t,r),a=new O$(e,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Q$=QX({reshape_:function(t,e){var n=jX(t,"x","reshape",null);return e=DG(e,n.size),xG(n.size===SG(e),(function(){return"new shape and old shape must have the same number of elements."})),RK.runKernel((function(t){return t.reshape(n,e)}),{$x:n},(function(t){return{$x:function(){return t.reshape(n.shape)}}}))}}),J$=QX({spaceToBatchND_:function(t,e,n){var r=jX(t,"x","spaceToBatchND");return xG(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),xG(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),xG(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),RK.runKernel((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),Z$=QX({squeeze_:function(t,e){var n=jX(t,"x","squeeze");return Q$(n,MG(n.shape,e).newShape)}}),tY=QX({stack_:function(t,e){void 0===e&&(e=0);var n=VX(t,"tensors","stack");if(xG(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;xG(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){CG(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){xG(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return p$(o,e)}}),eY=QX({tile_:function(t,e){var n=jX(t,"x","tile",null);return xG(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),RK.runKernel((function(t,r){var i=t.tile(n,e);return r([n]),i}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=d$(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var a=0;a<e[2];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(a=0;a<e[2];++a)for(var s=0;s<e[3];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),nY=QX({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new A$(e,n,r,!0,i),a=N$(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),rY=QX({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=jX(t,"x","unstack");return xG(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),RK.runKernel((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return tY(t,e)}}}))}});function iY(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,a=0;a<o;++a)i=i.concat([t[a+1]/e[a],e[a]]);i=i.concat(t.slice(o+1))}return i}function oY(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function aY(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function sY(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function uY(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function cY(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=t.shape,s=n.slice();s.pop();var u=1;for(o=r;o<t.rank;++o)u*=a[o],s.push(a[o]);var c=YG(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,i,u,c]}function lY(t){return t<=30?t:$G(t,Math.floor(Math.sqrt(t)))}function hY(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,a=r;a<i;++a)o*=n[a];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:YG(n.slice(0,r)).concat([1]),outputSize:SG(n)}}function fY(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function dY(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function pY(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),bG(0,o,a-1)}function vY(t,e,n,r,i){var o=e[i],a=n[i]||1;(t&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),a>0?bG(0,o,s):bG(-1,o,s-1)}function mY(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function gY(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function yY(t){return RK.customGrad(t)}var bY=QX({softmax_:function(t,e){void 0===e&&(e=-1);var n=jX(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return yY((function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}}))(n)}}),_Y=QX({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=jX(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return yY((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),wY=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}();function xY(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function CY(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function kY(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var a=e[e.length-i-1];if(null==a&&(a=1),1===o)n.unshift(a);else if(1===a)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function EY(t,e,n,r,i,o,a){void 0===a&&(a="channelsLast");var s,u=RY(e),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,t[1],t[1]]}return IY(t,s,n,r,i,o,!1,a)}function SY(t,e,n,r,i,o,a){void 0===a&&(a="NDHWC");var s,u,c=OY(e),l=c[0],h=c[1],f=c[2];if("NDHWC"===a)u="channelsLast",s=[l,h,f,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,h,f,t[1],t[1]]}return TY(t,s,n,r,i,!1,u,o)}function IY(t,e,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3];if("channelsLast"===s)c=t[0],l=t[1],h=t[2],f=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],h=t[3]}var d,p=e[0],v=e[1],m=e[3],g=RY(n),y=g[0],b=g[1],_=RY(r),w=_[0],x=_[1],C=NY(p,w),k=NY(v,x),E=function(t,e,n,r,i,o,a,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=AY(t,e,n));var o=t[1],a=DY((t[0]-e+2*r)/n+1,i);xG(TG(a),(function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"}));var s=DY((o-e+2*r)/n+1,i);return xG(TG(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[a,s]}([e,n],o,r,t,s);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var f=Math.max(0,(c-1)*r+o-e),d=Math.max(0,(l-1)*i+a-n),p=Math.floor(f/2),v=f-p,m=Math.floor(d/2);u={top:p,bottom:v,left:m,right:d-m,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),l=Math.ceil((n-a+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,b,C,k,o),S=E.outHeight,I=E.outWidth,T=a?m*f:m;return"channelsFirst"===s?d=[c,T,S,I]:"channelsLast"===s&&(d=[c,S,I,T]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:h,inChannels:f,outHeight:S,outWidth:I,outChannels:T,padInfo:E.padInfo,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:v,effectiveFilterHeight:C,effectiveFilterWidth:k,dilationHeight:w,dilationWidth:x,inShape:t,outShape:d,filterShape:e}}function TY(t,e,n,r,i,o,a,s){void 0===o&&(o=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3],d=u[4];if("channelsLast"===a)c=t[0],l=t[1],h=t[2],f=t[3],d=t[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=t[0],d=t[1],l=t[2],h=t[3],f=t[4]}var p,v=e[0],m=e[1],g=e[2],y=e[4],b=OY(n),_=b[0],w=b[1],x=b[2],C=OY(r),k=C[0],E=C[1],S=C[2],I=NY(v,k),T=NY(m,E),A=NY(g,S),R=function(t,e,n,r,i,o,a,s,u,c,l){var h,f,d,p;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var v=function(t,e,n,r,i,o){null==i&&(i=AY(t,e,r));var a=t[1],s=t[2],u=DY((t[0]-e+2*i)/r+1,o);xG(TG(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=DY((a-e+2*i)/r+1,o);xG(TG(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=DY((s-e+2*i)/r+1,o);return xG(TG(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([e,n,r,1],s,0,i,t,l);f=v[0],d=v[1],p=v[2]}else if("same"===t){var m=((f=Math.ceil(e/i))-1)*i+s-e,g=((d=Math.ceil(n/o))-1)*o+u-n,y=((p=Math.ceil(r/a))-1)*a+c-r,b=Math.floor(m/2),_=m-b,w=Math.floor(g/2),x=g-w,C=Math.floor(y/2);h={top:w,bottom:x,left:C,right:y-C,front:b,back:_,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/i),d=Math.ceil((n-u+1)/o),p=Math.ceil((r-c+1)/a)}return{padInfo:h,outDepth:f,outHeight:d,outWidth:p}}(i,l,h,f,_,w,x,I,T,A,s),O=R.outDepth,N=R.outHeight,D=R.outWidth,P=o?y*d:y;return"channelsFirst"===a?p=[c,P,O,N,D]:"channelsLast"===a&&(p=[c,O,N,D,P]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:h,inWidth:f,inChannels:d,outDepth:O,outHeight:N,outWidth:D,outChannels:P,padInfo:R.padInfo,strideDepth:_,strideHeight:w,strideWidth:x,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:T,effectiveFilterWidth:A,dilationDepth:k,dilationHeight:E,dilationWidth:S,inShape:t,outShape:p,filterShape:e}}function AY(t,e,n,r){void 0===r&&(r=1);var i=NY(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function RY(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function OY(t){return"number"==typeof t?[t,t,t]:t}function NY(t,e){return e<=1?t:t+(t-1)*(e-1)}function DY(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function PY(t){var e=RY(t);return 1===e[0]&&1===e[1]&&1===e[2]}function MY(t,e){return PY(t)||PY(e)}function FY(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function LY(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=c$(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!VG(t.dtype,e))return pK.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var a=n.real(t);return o=a.cast(e),a.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var s=r$(0,t.dtype);return o=n.notEqual(t,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function BY(t,e){return pK.make(e,{dataId:t.dataId},t.dtype)}function jY(t,e,n){var r=(e-t)/(n-1),i=tK(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return i$(i,"float32")}function VY(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function UY(t,e){return{real:t[2*e],imag:t[2*e+1]}}function zY(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function WY(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function qY(t,e,n,r,i){for(var o=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),a=[],s=0;s<o.length;s++){var u=o[s],c=u.boxIndex;if(u.score<i)break;for(var l=!1,h=a.length-1;h>=0;--h)if(HY(t,c,a[h])>=r){l=!0;break}if(!l&&(a.push(c),a.length>=n))break}return i$(a,"int32")}function HY(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),d=(s-o)*(u-a),p=(h-c)*(f-l);if(d<=0||p<=0)return 0;var v=Math.max(o,c),m=Math.max(a,l),g=Math.min(s,h),y=Math.min(u,f),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(d+p-b)}function GY(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function KY(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=N$(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=o[s]%t.shape[s];var u=t.locToIndex(a);i.values[r]=t.values[u]}return i.toTensor()}function XY(t,e,n,r,i){for(var o=e[e.length-1],a=[t.length/o,o],s=a[0],u=a[1],c=FG(n,s*r),l=FG("int32",s*r),h=0;h<s;h++){for(var f=h*u,d=t.subarray(f,f+u),p=[],v=0;v<d.length;v++)p.push({value:d[v],index:v});p.sort((function(t,e){return e.value-t.value}));var m=h*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}var b=e.slice();return b[b.length-1]=r,[e$(c,b,n),e$(l,b,"int32")]}function $Y(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=N$(t,"int32"),o=N$([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]);o.values.set(a,r*t.length)}return o.toTensor()}!function(){function t(){}t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.fusedConv2d=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.avgPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPool3dBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPool3dBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.diag=function(t){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")}}(),Object.freeze({castTensor:LY,reshapeTensor:BY,linspaceImpl:jY,upcastType:xK,axesAreInnerMostDims:UX,combineLocations:zX,computeOutAndReduceShapes:WX,expandShapeToKeepDim:qX,assertAxesAreInnerMostDims:HX,getAxesPermutation:GX,getUndoAxesPermutation:KX,getInnerMostAxes:XX,getBroadcastDims:xY,getReductionAxes:CY,assertAndGetBroadcastShape:kY,assertParamsConsistent:$X,computeOutShape:YX,computePool2DInfo:EY,computePool3DInfo:SY,computeConv2DInfo:IY,computeConv3DInfo:TY,computeDefaultPad:AY,tupleValuesAreOne:PY,eitherStridesOrDilationsAreOne:MY,convertConv2DDataFormat:FY});var YY=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},QY=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},JY=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function ZY(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function tQ(t,e){return 1===e?[t]:ZY(t,e)}function eQ(){var t,e,n,r,i,o,a,s,u,c;return 2===mG.getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 0. || val == 0.) ? false : true;\n      }\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function nQ(t,e,n){void 0===n&&(n="index");var r=YG(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function rQ(t){var e=YG(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var iQ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function oQ(t){return"offset"+t}function aQ(t){var e=t.name,n=SG(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function sQ(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function uQ(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function cQ(t,e){return e.map((function(e){return t[e]})).join(", ")}var lQ=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,xG(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,a,s=this.outputShape,u=s.length,c=sQ(u),l=tQ("coords",u);if(1===i){var h=sQ(a=u+1);o="\n        "+h+" sourceLocR = "+h+"("+l.join()+", 0);\n        ++"+l[u-1]+";\n        "+h+" sourceLocG = "+h+"("+l.join()+", 0);\n        ++"+l[u-2]+";\n        "+h+" sourceLocA = "+h+"("+l.join()+", 0);\n        --"+l[u-1]+";\n        "+h+" sourceLocB = "+h+"("+l.join()+", 0);\n        --"+l[u-2]+";"}else a=u,o="\n        "+c+" sourceLocR = coords;\n        ++"+l[u-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+l[u-2]+";\n        "+c+" sourceLocA = coords;\n        --"+l[u-1]+";\n        "+c+" sourceLocB = coords;\n        --"+l[u-2]+";";var f=["x","y","z","w","u","v"].slice(0,a),d="."+f[a-1],p=f.map((function(t){return"int "+t})),v=tQ("sourceLocR",a-1).concat("inIdx.r"),m=tQ("sourceLocG",a-1).concat("inIdx.g"),g=tQ("sourceLocB",a-1).concat("inIdx.b"),y=tQ("sourceLocA",a-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",_=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+")));",w="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+m.join()+") : 0.,\n            hasNextRow ? getAChannel("+g.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+y.join()+") : 0.)",x=r?"":"\n      float getBestIndicesAChannel("+p.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+p.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+x+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+l[u-1]+" < "+(s[u-1]-1)+";\n        bool hasNextRow = "+l[u-2]+" < "+(s[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+w+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+_+"\n          vec4 candidate = "+w+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},hQ=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},fQ=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterDepth*t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n            wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},dQ=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],kY(t,e),kY(t,n);var a="0.0";null!=r&&(kY(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=i&&(kY(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},pQ=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],kY(t,e),kY(t,n);var a="vec4(0.0)";null!=r&&(kY(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(kY(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},vQ=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=kY(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},mQ=function(t,e,n){this.variableNames=["A","B"],this.outputShape=kY(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},gQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",yQ=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=kY(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===SG(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+sQ(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=tQ("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+a[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+a[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},bQ=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),_Q=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),wQ=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},xQ=function(t){this.outputShape=[],this.outputShape=YX(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},CQ=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=YX(t,e);var n=this.outputShape,r=n.length,i=sQ(r),o=tQ("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=a[e],l="vec2("+a.slice(-2).join()+")",h=a.join(),f="if ("+c+" < "+s[0]+")\n          return getChannel(getT0("+h+"), "+l+");";for(u=1;u<s.length;u++)f+="\n        else if ("+c+" < "+s[u]+") {\n          "+c+" -= "+s[u-1]+";\n          return getChannel(getT"+u+"("+h+"), "+l+");\n        }";f+="\n        else {\n          "+c+" -= "+s[s.length-1]+";\n          return getChannel(getT"+s.length+"("+h+"), "+l+");\n        }",this.userCode="\n      float getValue("+a.map((function(t){return"int "+t}))+") {\n        "+f+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n        if (++"+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n        if (++"+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            --"+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "},kQ=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===t.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},EQ=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(r?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(r?1:2)+"], coords["+(r?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+r+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},SQ=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},IQ=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},TQ=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},AQ=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},RQ=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4,p="channelsLast"===t.dataFormat,v=p?1:2,m=p?2:3,g=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===d)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+f+") *\n                    getW(wR, wC, "+f+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+f+", xR, xC) *\n                    getW(wR, wC, "+f+", d2);\n              }\n\n            } else if ("+(2===d)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===d)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2),\n                getW(wR, wC, "+f+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1),\n                  getX(batch, xR, xC, "+f+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC),\n                  getX(batch, "+f+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+_+"\n        "+b+"\n        setOutput(result);\n      }\n    "},OQ=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},NQ=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+t.strideHeight+", "+t.strideWidth+");\n      const ivec2 pads = ivec2("+t.padInfo.top+", "+t.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+e+";\n        int q = d2 - d1 * "+e+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+t.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+t.dilationHeight+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+t.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+t.dilationWidth+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},DQ=function(t){this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var e=t.inHeight,n=t.inWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,a=t.strideWidth,s=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,f="int xR; int xC; int xCOffset;",d=0;d<c;d++)for(var p=0;p<l;p++)f+="\n          vec4 xTexelR"+d+"C"+2*p+" = vec4(0.);\n          vec4 wR"+d+"C"+p+" = vec4(0.);\n          vec4 xR"+d+"C"+p+" = vec4(0.);";for(d=0;d<c;d++)for(var v=0;v<h;v++){if(f+="\n          xR = xRCorner + "+d*s+";\n          xC = xCCorner + "+(p=2*v)*u+";\n        ",1===a){if(p<l&&(f+=i%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+d+"C"+p+" = vec4(previous.zw, xTexelR"+d+"C"+p+".xy);\n                } else {\n                  xR"+d+"C"+p+" = vec4(0, 0, xTexelR"+d+"C"+p+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+e+" && xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = xTexelR"+d+"C"+p+";\n              ",p+1<l)){var m=i%2==0?_G(u):u;u%2==0&&i%2==1||u%2!=0&&i%2!=1?(f+="\n                  xCOffset = xC + "+i%2+" + "+m+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",u>1&&(f+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+e+" &&\n                      xCOffset >= 0 && xCOffset < "+n+") {\n                      xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+d+"C"+p+" = vec4(0.);\n                    }\n                  "),f+="\n                  xR"+d+"C"+(p+1)+" = vec4(\n                    xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".xy);\n                "):f+="\n                  xCOffset = xC + "+m+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+d+"C"+(p+1)+" = xTexelR"+d+"C"+(p+2)+";\n                "}}else p<l&&(f+="\n              if(xR >= 0 && xR < "+e+") {\n            ",i%2==1?(f+="\n                xCOffset = xC + 1 - "+a+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+n+") {\n                  xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+d+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = vec4(\n                  xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".zw);\n              ",p+1<l&&(f+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+a+";\n                  if(xCOffset >= 0 && xCOffset < "+n+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+d+"C"+(p+1)+" = vec4(xTexelR"+d+"C"+(p+2)+".xy, final.xy);\n                ")):(f+="\n                if(xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+p+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+p+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+a+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+(p+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+(p+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+p+" = vec4(\n                  xTexelR"+d+"C"+p+".xy, xTexelR"+d+"C"+(p+2)+".xy);\n              ",p+1<l&&(f+="\n                  xR"+d+"C"+(p+1)+" = vec4(\n                    xTexelR"+d+"C"+p+".zw, xTexelR"+d+"C"+(p+2)+".zw);\n                ")),f+="}");p<l&&(f+="\n            vec4 wTexelR"+d+"C"+p+" = getW("+d+", "+p+", d1, q);\n            wR"+d+"C"+p+" = vec4(wTexelR"+d+"C"+p+".xz, wTexelR"+d+"C"+p+".xz);\n          ",p+1<l&&(f+="\n              vec4 wTexelR"+d+"C"+(p+1)+" = getW("+d+", "+(p+1)+", d1, q);\n              wR"+d+"C"+(p+1)+" =\n                vec4(wTexelR"+d+"C"+(p+1)+".xz, wTexelR"+d+"C"+(p+1)+".xz);"))}for(d=0;d<c;d++)for(p=0;p<l;p++)f+="result += xR"+d+"C"+p+" * wR"+d+"C"+p+";";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+a+");\n      const ivec2 pads = ivec2("+r+", "+i+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 result = vec4(0.);\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},PQ=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],a=t[1],s=t[2],u=n[0],c=n[1];this.outputShape=[e[0],u,c,t[3]];var l=[a-1+".0",s-1+".0"],h=l[0],f=l[1],d=u>1?[""+(a-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],p=c>1?[""+(s-1)/(c-1),"(x2-x1) * width_ratio","x1*"+f+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+f];this.userCode="\n      const float height_ratio = float("+d[0]+");\n      const float width_ratio = float("+p[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+d[1]+";\n        float width_scale = "+p[1]+";\n\n        float in_y = "+d[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+p[2]+";\n        if( in_x < 0.0 || in_x > "+f+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},MQ=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+sQ(r)+" coords = getOutputCoords();\n        int end = "+FQ(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+FQ(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function FQ(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var LQ=function(t,e){this.variableNames=["A"];var n=eQ();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+nQ(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},BQ=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=eQ();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+nQ(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},jQ=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),VQ=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},UQ=function(t){this.variableNames=["A"];var e=eQ();this.outputShape=t,this.userCode="\n      "+iQ+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},zQ=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=eQ();this.outputShape=t,this.userCode="\n      "+iQ+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},WQ=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=eQ(),i=e[0],o=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+rQ(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},qQ=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=eQ(),i=e[0],o=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+rQ(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},HQ=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},GQ=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),KQ=function(t){this.variableNames=["A"];var e=eQ(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},XQ=function(t){this.variableNames=["A"];var e=eQ(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},$Q=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=sQ(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},YQ=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=sQ(e.length),i=sQ(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function QQ(t,e){var n=eQ();return KK(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function JQ(t,e){return eX(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ZQ(t,e){return nX(t,e,new Uint16Array([0,1,2,2,1,3]))}function tJ(t,e,n,r,i,o,a){iX(n,r);var s=rX(t,e),u=t.TEXTURE_2D;return WK(t,e,(function(){return t.bindTexture(u,s)})),WK(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),WK(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),WK(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),WK(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),WK(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,a,null)})),WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function eJ(t,e,n,r,i){var o=jK(n,r);return tJ(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function nJ(t,e,n,r,i){var o=jK(n,r);return tJ(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function rJ(t,e,n,r,i){var o=jK(n,r);return tJ(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function iJ(t,e,n,r,i){var o=UK(n,r);return tJ(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function oJ(t,e,n,r,i){var o=UK(n,r);return tJ(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function aJ(t,e,n,r){return WK(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),aX(t,e,n,"clipSpacePos",r,3,20,0)&&aX(t,e,n,"uv",r,2,20,12)}function sJ(t,e,n,r,i,o,a){var s,u,c;WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(o),WK(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,s)})),WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function uJ(t,e,n,r){WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?WK(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):WK(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),WK(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function cJ(t,e,n,r,i){var o=t.createBuffer();WK(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var a=16*n*r;return WK(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)})),WK(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),WK(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function lJ(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function hJ(t,e,n,r,i){var o=jK(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return WK(t,e,(function(){return t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function fJ(t,e,n,r,i,o,a,s){var u=t,c=new Float32Array(function(t,e){var n=UK(t,e);return n[0]*n[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function dJ(t,e,n,r){var i=new Float32Array(n*r*4);return WK(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var pJ=Object.freeze({createVertexShader:QQ,createVertexBuffer:JQ,createIndexBuffer:ZQ,createFloat32MatrixTexture:eJ,createFloat16MatrixTexture:nJ,createUnsignedBytesMatrixTexture:rJ,createPackedMatrixTexture:iJ,createFloat16PackedMatrixTexture:oJ,bindVertexProgramAttributeStreams:aJ,uploadDenseMatrixToTexture:sJ,uploadPixelDataToTexture:uJ,createBufferFromOutputTexture:cJ,downloadFloat32MatrixFromBuffer:lJ,downloadByteEncodedFloatMatrixFromOutputTexture:hJ,downloadPackedMatrixFromBuffer:fJ,downloadMatrixFromPackedOutputTexture:dJ}),vJ=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=mG.getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,FK(e,t)):this.gl=LK(e),1===mG.getNumber("WEBGL_VERSION"))this.textureFloatExtension=GK(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=GK(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(SX(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!SX(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=JQ(this.gl,this.debug),this.indexBuffer=ZQ(this.gl,this.debug),this.framebuffer=oX(this.gl,this.debug),this.textureConfig=zK(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return mG.getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;WK(e,this.debug,(function(){return e.finish()})),WK(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),WK(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),WK(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),WK(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),WK(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),eJ(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),nJ(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),rJ(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),uJ(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),sJ(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),oJ(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),iJ(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(fX(this.gl,this.debug,this.framebuffer),this.outputTexture=null),WK(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return hJ(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return fJ(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return lJ(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=cJ(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(mG.getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return dJ(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=XK(e,this.debug,t),r=QQ(e,this.debug),i=JK(e,this.debug);return WK(e,this.debug,(function(){return e.attachShader(i,r)})),WK(e,this.debug,(function(){return e.attachShader(i,n)})),ZK(e,this.debug,i),this.debug&&tX(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=aJ(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&WK(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&tX(this.gl,this.debug,this.program),WK(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?uX(this.gl,this.debug,t,e):cX(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),WK(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),lX(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=UK(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&tX(this.gl,this.debug,this.program),dX(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),WK(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),WK(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=GK(this.gl,this.debug,2===mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return fG(this,void 0,void 0,(function(){var e=this;return dG(this,(function(n){switch(n.label){case 0:return[4,NG((function(){return e.disposed||e.isQueryAvailable(t,mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||NG((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),hX(this.gl,this.debug,t,this.framebuffer),this.debug&&dX(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(hX(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&dX(this.gl)):fX(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;hX(r,this.debug,t,this.framebuffer),this.debug&&dX(r),this.outputTexture=t,WK(r,this.debug,(function(){return r.viewport(0,0,e,n)})),WK(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),WK(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function mJ(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!IG(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var a=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!IG(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var gJ=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,a=n.padInfo,s=n.outWidth,u=n.dilationWidth,c=n.dilationHeight,l=n.dataFormat,h=a.left,f=a.top,d=r*n.filterWidth,p=eQ(),v="channelsLast"===l,m=v?0:1,g=v?1:2,y="",b=0;b<=1;b++)for(var _=0;_<=1;_++)y+="\n          blockIndex = rc.y + "+_+";\n          pos = rc.x + "+b+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+s+")) * "+o+" - "+f+";\n            d0 = offsetY + "+c+" * (pos / "+d+");\n\n            if(d0 < "+e[m]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+s+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+u+" * (int(mod(float(pos), "+d+".) / "+r+".));\n\n              if(d1 < "+e[g]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+r+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*b+_)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*b+_)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+y+"\n\n        "+p.output+" = result;\n      }\n    "},yJ=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},bJ=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},_J=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+a+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},wJ=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},xJ=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n           wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(e*n*r-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+n+" * "+r+" +\n                  wR * "+r+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CJ=function(t,e,n,r,i,o,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var s=Math.ceil((n?t[1]:t[2])/2),u=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",l=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",d="";o&&(f=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+o+"\n        }":"vec4 activation(vec4 x) {\n          "+o+"\n        }",d="result = activation(result);");var p=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+f+"\n\n      const float sharedDimension = "+s+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+s+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+u+");\n          vec4 b = getMatrixB(rc.x, "+c+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+l[0]+" * "+h[0]+");\n          result += ("+l[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+p+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},kJ=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),EJ=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},SJ=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=tQ("rc",e),r=sQ(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),a=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),a=2;a<t;a++)o=e[e.length-1-a]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},IJ=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=sQ(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},TJ=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=sQ(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=tQ("rc",r),u=tQ("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",p=0,v=1===r?2:4;p<v;p++)d+="\n        "+h[p]+"\n        if ("+f+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(d+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},AJ=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,d="0.0";if(f||(d="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+l+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(p="avgValue / count");var v=4*Math.floor(r/4),m=r%4,g="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+l+", "+h+");\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+d+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},RJ=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var m="avg"===e,g="0.0";if(m||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+o+", "+a+");\n        const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+f+" +\n                      wR * "+f+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var b=4*Math.floor(r/4),_=r%4,w="\n      if ("+m+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},OJ=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",s="min"):"max"===e&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var d="";i%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},NJ=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+nQ(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+rQ(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},DJ=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},PJ=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},MJ=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],a=t[3];this.outputShape=[t[0],e,n,a];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+s[0]/u[0]+",\n          "+s[1]/u[1]+",\n          "+s[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(a-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},FJ=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],d=1/h,p=1/f,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},LJ=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},BJ=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=sQ(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},jJ=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=tQ("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=sQ(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},VJ=function(t,e,n,r,i,o,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=sQ(i.length),u=sQ(o.length),c="";1===n?c="i":2===n&&(c="i, j");var l="";1===r?l="i":2===r&&(l="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+l+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},UJ=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},zJ=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+o[u]),u<t&&a.push(""+o[u]);r=a.join(),i=s.join()}var c=sQ(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},WJ=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=sQ(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return qJ.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+qJ[e]+" = start["+e+"] + coords."+qJ[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),qJ=["x","y","z","w","u","v"],HJ=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=sQ(this.rank),n=tQ("coords",this.rank),r=tQ("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",a="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),GJ=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=sQ(n.length),o=sQ(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},KJ=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=XJ(e,n),o=$J(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),i===DK.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===DK.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===DK.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===DK.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===DK.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=$J(e,XJ(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],a=o.indexOf(t);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function XJ(t,e){if(t===NK.UPLOAD)return DK.PACKED_2X2_FLOAT32;if(t===NK.RENDER||null==t)return function(t){return mG.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?DK.PACKED_2X2_FLOAT32:DK.UNPACKED_FLOAT32:t?DK.PACKED_2X2_FLOAT16:DK.UNPACKED_FLOAT16}(e);if(t===NK.DOWNLOAD||t===NK.PIXELS)return DK.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function $J(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var YJ=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=sQ(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},QJ=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=sQ(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},JJ=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=sQ(this.rank),o=ZY("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},ZJ=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},tZ="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",eZ="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",nZ=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},rZ=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=tQ("rc",e),r=sQ(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),a=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},iZ={};function oZ(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?tZ:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===t)return e?eZ:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("prelu"===t)return e?gQ:"return (a < 0.) ? b * a : a;";throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var aZ=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!mG.getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=LK(mG.getNumber("WEBGL_VERSION"));this.binaryCache=(n=mG.getNumber("WEBGL_VERSION"))in iZ?iZ[n]:(iZ[n]={},iZ[n]),this.gpgpu=new vJ(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new KJ(this.gpgpu),this.numMBBeforeWarning=null==mG.global.screen?1024:mG.global.screen.height*mG.global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new wY(this,RK)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n="undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement,r=t.data instanceof Uint8Array,i="undefined"!=typeof ImageData&&t instanceof ImageData,o="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,s=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],u=s[0],c=s[1],l=[c,u],h=[c,u,e];if(!(n||r||i||o||a))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(a||o)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=BK(mG.getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=u,this.fromPixels2DContext.canvas.height=c,this.fromPixels2DContext.drawImage(t,0,0,u,c),t=this.fromPixels2DContext.canvas);var f,d,p=this.makeTensorHandle(l,"int32");if(this.texData.get(p.dataId).usage=NK.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(p.dataId),t),mG.getBool("WEBGL_PACK")){f=new XQ(h);var v=this.makePackedTensor(f.outputShape,p.dtype);d=this.compileAndRun(f,[p],v)}else f=new KQ(h),d=this.compileAndRun(f,[p]);return this.disposeData(p.dataId),d},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(mG.getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!qK(r)){if(mG.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.ENV.set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+r+" cannot be represented on this device.")}}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=NK.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var a;a=e.isPacked?new nZ(o,"return x;"):new ZJ(o,"return x;");var s=this.compileAndRun(a,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(s.dataId);return s.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var c,l,h=null!=this.activeTimers;return h&&(c=eK()),l="complex64"===r?VY(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=eK()-c),this.convertAndCacheOnCPU(t,l)},t.prototype.read=function(t){return fG(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b;return dG(this,(function(_){switch(_.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,o=n.dtype,a=n.complexTensors,s=n.isPacked,null!=n.slice)return u=s?new nZ(i,"return x;"):new ZJ(i,"return x;"),c=this.compileAndRun(u,[{dataId:t,shape:i,dtype:o}]),l=this.read(c.dataId),c.dispose(),[2,l];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!mG.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===mG.getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==o&&mG.get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(t),d=this.texData.get(f.dataId),h=(b=this.gpgpu).createBufferFromTexture.apply(b,[d.texture].concat(VK(i)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_.sent(),_.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([a.real.data(),a.imag.data()])];case 3:return v=_.sent(),p=VY(v[0],v[1]),[3,5];case 4:null==h?p=this.getValuesFromTexture(t):(m=SG(i),p=this.gpgpu.downloadFloat32MatrixFromBuffer(h,m)),_.label=5;case 5:return null!=f&&this.disposeData(f.dataId),g=this.convertAndCacheOnCPU(t,p),y=this.pendingRead.get(t),this.pendingRead.delete(t),y.forEach((function(t){return t(g)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,g]}}))}))},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,a=r.isPacked,s=SG(i);if(mG.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),c=this.texData.get(u.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(VK(i))).subarray(0,s);return this.disposeData(u.dataId),l}var h=mG.getBool("WEBGL_PACK")&&!0===a,f=h?bX(i):i,d=this.makeTensorHandle(f,"float32");d.size=SG(i),this.texData.get(d.dataId).usage=NK.DOWNLOAD;var p=PX((function(){var e=h?new zQ(f):new UQ(f);return n.compileAndRun(e,[{shape:f,dtype:o,dataId:t}],d,null)})),v=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,s);return this.disposeData(d.dataId),m},t.prototype.time=function(t){return fG(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return dG(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=EG(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=EG(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return a=u.sent(),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:wG(a),getExtraProfileInfo:function(){return a.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,s]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:eK(),endMs:null}},t.prototype.endTimer=function(t){return mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=eK(),t)},t.prototype.getQueryTime=function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){return mG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,a=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,a)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getDataInfo=function(t){return this.texData.get(t)},t.prototype.getCPUBackend=function(){return mG.getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=RK.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:RK.keep(t.clone()),imag:RK.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===SG(n))return e$([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=mY(t.shape,e,n);if(r||!i){var o=mG.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HJ(n):new WJ(n),a=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,a)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=pK.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var a=gY(e,t.strides);r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,s+1),i},t.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=dY(e,n,r);if(i.some((function(t){return 0===t})))return e$([],i);var o=new GJ(e,r,i);return this.compileAndRun(o,[t])},t.prototype.reverse=function(t,e){var n=mG.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jJ(t.shape,e):new BJ(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return ZX(t)})),r=t.map((function(t){return t$(t)}));return JX(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>mG.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),o=this.concat(t.slice(0,i),e),a=this.concat(t.slice(i),e);return this.concat([o,a],e)}if(mG.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new CQ(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var u=YX(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,SG(t.shape.slice(e)))})),l=new xQ(c.map((function(t){return t.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return -x;",t.dtype);var e=new ZJ(t.shape,"return -x;");return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===o)&&a>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(s,a,1),c=1===o?2:1,l=1===o?e.as3D(s,1,a):e;return this.multiply(u,l).sum(c,!0)}var h=xK(t.dtype,e.dtype),f=new CJ(t.shape,[s,i,o],n,r),d=this.makePackedTensor(f.outputShape,h);return this.compileAndRun(f,[t,e],d)},t.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,o=t.bias,a=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],l=e.shape[0],h=xK(e.dtype,n.dtype),f=null!=o,d=null!=s,p=a?oZ(a,!0):null,v=new CJ(e.shape,[l,u,c],r,i,f,p,d),m=this.makePackedTensor(v.outputShape,h),g=[e,n];return o&&g.push(o),s&&g.push(s),this.compileAndRun(v,g,m)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new vQ("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new vQ("return areal * bimag + aimag * breal;",t.shape,e.shape),a=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],s=this.compileAndRun(i,a),u=this.compileAndRun(o,a),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a * b;",t.dtype);var l=new mQ("return a * b;",t.shape,e.shape),h=this.makeOutputArray(l.outputShape,t.dtype);return this.compileAndRun(l,[t,e],h)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var a=[t,e,n],s=null;null!=o&&(s=o.shape,a.push(o));var u=null;if(null!=i&&(u=i.shape,a.push(i)),mG.getBool("WEBGL_PACK_NORMALIZATION")){var c=new pQ(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(c,a)}var l=new dQ(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,a)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=mG.getBool("WEBGL_PACK_NORMALIZATION")?new _J(t.shape,e,n,r,i):new yJ(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){var s=new bJ(e.shape,r,i,o,a);return this.compileAndRun(s,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return iK(t)}));return KY(N$(t.shape,t.dtype,n),e)}var r=new YJ(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.pad=function(t,e,n){var r=mG.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TJ(t.shape,e,n):new IJ(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=mG.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JJ(t.shape,e):new QJ(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new $Q(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){xG(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=iY(t.shape,e,r),o=oY(i.length,e.length),a=aY(t.shape,e,r),s=sY(n,e.length),u=uY(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){xG(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=iY(a.shape,e,r,!1),u=oY(s.length,e.length,!1),c=aY(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=lY(i),a=new OJ({windowSize:o,inSize:i,batchSize:r},e),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],n);return this.compileAndRun(a,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=lY(i),a=new JY({windowSize:o,inSize:i,batchSize:r},e,null==n),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],"int32"),c=[t];return null!=n&&c.push(n),this.compileAndRun(a,c,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=lY(r[r.length-1]),o=new lQ(r,i,e,null==n),a=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],a),a.rank===t.rank?this.argReducePacked(t,e,a):a},t.prototype.sum=function(t,e){HX("sum",e,t.rank);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i),a=CK(t.dtype);return this.reduce(o,"sum",a).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i),a=CK(t.dtype);return this.reduce(o,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=GX([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=XX(1,t.rank)[0]);var a=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),s=SG([o.shape[r]]),u=o.as2D(-1,s),c=CK(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(a);return null!=i&&(l=l.transpose(KX(i))),l},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],a=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=$G(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=$G(t,n+1);return n}(a,i),u=new UJ({windowSize:s,inSize:a,batchSize:o,numSegments:i},e),c=u.outputShape,l=this.makeOutputArray([c[0],c[1]],r);return this.compileAndRun(u,[t,n],l),l.shape[1]===i?l:(n=h$(0,i).tile([a/s]),this.segOpCompute(l,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(HX("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!mG.getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=WX(t.shape,r),o=i[0],a=SG(i[1]),s=t.as2D(-1,a);return this.argReduce(s,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new MQ(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new mQ("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new mQ("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new mQ("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new mQ("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new mQ("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new mQ("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new ZJ(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new mQ("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new mQ("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new zJ(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,xK(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){FX("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return $Y(t.shape,e)},t.prototype.topk=function(t,e,n){return XY(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){HX("min",e,t.rank);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new mQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new mQ("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);HX("max",e,t.rank);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new mQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){HX("all",e,t.rank);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){HX("any",e,t.rank);var n=WX(t.shape,e),r=n[0],i=SG(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("return (a - b) * (a - b);",t.shape,e.shape):new mQ("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(b.x == 0.0) {\n    result.x = NAN;\n  } else if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(b.y == 0.0) {\n    result.y = NAN;\n  } else if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(b.z == 0.0) {\n    result.z = NAN;\n  } else if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(b.w == 0.0) {\n    result.w = NAN;\n  } else if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new mQ("\nif (b == 0.0) {\n  return NAN;\n}\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new mQ("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a + b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=xK(t.dtype,e.dtype);if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a + b;",n);var r=new mQ("return a + b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedUnaryOp=function(t,e,n){var r=new nZ(t.shape,e),i=this.makePackedTensor(r.outputShape,n);return this.compileAndRun(r,[t],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new yQ(n,t.shape,e.shape,i),a=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],a)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),a=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],a=i[1],s=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,a),c=new mQ(n,t.shape,e.shape),l=r.makeOutputArray(c.outputShape,xK(o.dtype,a.dtype));return r.compileAndRun(c,[s,u],l)})),s=a[0],u=a[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>mG.get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return xK(t,e)})),o=t.map((function(t){return t.shape})),a=mG.getBool("WEBGL_PACK"),s=a?new QY(t[0].shape,o):new YY(t[0].shape,o),u=a?this.makePackedTensor(s.outputShape,i):this.makeOutputArray(s.outputShape,i);return this.compileAndRun(s,t,u)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,"return a - b;");if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=xK(t.dtype,e.dtype);if(mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"return a - b;",t.dtype);var r=new mQ("return a - b;",t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new yQ("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new mQ("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=xK(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return ceil(x);",t.dtype);var e=new ZJ(t.shape,"return ceil(x);");return this.compileAndRun(e,[t])},t.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return floor(x);",t.dtype);var e=new ZJ(t.shape,"return floor(x);");return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new ZJ(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new ZJ(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new ZJ(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new ZJ(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new ZJ(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return exp(x);",t.dtype);var e=new ZJ(t.shape,"return exp(x);");return this.compileAndRun(e,[t])},t.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return exp(x) - 1.0;",t.dtype);var e=new ZJ(t.shape,"return exp(x) - 1.0;");return this.compileAndRun(e,[t])},t.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new ZJ(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new ZJ(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new ZJ(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new ZJ(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new ZJ(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new ZJ(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=mG.getBool("WEBGL_PACK")?new nZ(t.shape,tZ):new ZJ(t.shape,"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n"),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ(gQ,t.shape,e.shape):new mQ("return (a < 0.) ? b * a : a;",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,eZ,t.dtype);var e=new ZJ(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new mQ("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new ZJ(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new ZJ(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=mG.getBool("WEBGL_PACK_CLIP")?new _Q(t.shape):new bQ(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(mG.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"return abs(x);",t.dtype);var e=new ZJ(t.shape,"return abs(x);");return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new wQ(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new ZJ(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new ZJ(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new ZJ(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new ZJ(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new ZJ(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new ZJ(t.shape,"return asin(x);");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new ZJ(t.shape,"return acos(x);");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new ZJ(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yQ("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new mQ("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new ZJ(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new ZJ(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new ZJ(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new ZJ(t.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new ZJ(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new ZJ(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new ZJ(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new ZJ(t.shape,function(t){return void 0===t&&(t=0),"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n,r,i,o){var a=t.shape,s=this.texData.get(t.dataId),u="channelsLast"===n.dataFormat,c=a[2]%2!=0&&!!s.isPacked;if((1==a[0]*a[1]*a[2]||1===n.outChannels)&&n.inChannels>1e3||!mG.getBool("WEBGL_LAZILY_UNPACK")||!mG.getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){var l=this.reshape(t,[1,u?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],n.inChannels]),h=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:l,b:h,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),n.outShape)}var f=pK.make([1,u?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),d=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,xG(xX(s.shape,f.shape),(function(){return"packed reshape "+s.shape+" to "+f.shape+" isn't free"}));var p=this.reshape(e,[1,n.inChannels,n.outChannels]),v=this.fusedBatchMatMul({a:f,b:p,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),m=this.texData.get(v.dataId);return xG(m.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=d,m.shape=n.outShape,pK.make(n.outShape,{dataId:v.dataId},v.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n,r,i,o){var a=n.outWidth,s=n.outHeight,u="channelsLast"===n.dataFormat,c=n.filterWidth*n.filterHeight*n.inChannels,l=s*a,h=[c,l],f=t.squeeze([0]),d=e.reshape([1,c,-1]),p=new gJ(h,f.shape,n),v=this.compileAndRun(p,[f]).reshape([1,h[0],h[1]]),m=null!=r,g=null!=o,y=i?oZ(i,!0):null,b=new CJ(v.shape,[1,l,n.outChannels],!0,!1,m,y,g),_=[v,d];return r&&_.push(r),g&&_.push(o),this.compileAndRun(b,_).reshape(u?[1,s,a,n.outChannels]:[1,n.outChannels,s,a])},t.prototype.fusedConv2d=function(t,e,n,r,i,o){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n,r,i,o);if(mG.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n,r,i,o);var a=null!=r,s=null!=o,u=i?oZ(i,!1):null,c=new RQ(n,a,u,s),l=[t,e];return r&&l.push(r),o&&l.push(o),this.compileAndRun(c,l)},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(mG.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new RQ(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new EQ(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new kQ(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r;return mG.getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new DQ(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new NQ(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new AQ(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new TQ(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new OQ(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new IQ(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new SQ(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new AJ(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new AJ(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new AJ(r,"max",!0),o=this.compileAndRun(i,[e]),a=new wJ(r),s=this.makeOutputArray(a.outputShape,e.dtype),u=this.compileAndRun(a,[t,o],s);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new hQ(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return LY(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.avgPool3d=function(t,e){var n=new RJ(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.avgPool3dBackprop=function(t,e,n){var r=new fQ(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.maxPool3d=function(t,e){var n=new RJ(e,"max",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new RJ(r,"max",!0),o=this.compileAndRun(i,[e]),a=new xJ(r),s=this.makeOutputArray(a.outputShape,e.dtype),u=this.compileAndRun(a,[t,o],s);return o.dispose(),u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||xX(t.shape,e)||null!==n.texture&&xX(n.shape,e)?BY(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=mG.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new MJ(t.shape,e,n,r):new PJ(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new DJ(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new LJ(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new FJ(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:bY(t),o=new kJ(i.shape[0],i.shape[1],n),a=this.makeOutputArray(o.outputShape,"int32"),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],a,s)},t.prototype.oneHot=function(t,e,n,r){var i=new EJ(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.diag=function(t){var e=new VQ(t.size);return this.compileAndRun(e,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return FX("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),qY(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var a=new PQ(t.shape,e.shape,r,i,o);return this.compileAndRun(a,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){xG(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,a=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),s=new jQ("NHWC"===n?[r,i,o,a]:[r,a,i,o],e,n);return this.compileAndRun(s,[t])},t.prototype.split=function(t,e,n){return GY(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=hY(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/a,a],l=t.reshape([o,i]),h=e.reshape([o,a]);if(0===u)return BY(e$([]),n);var f=r$(0),d=new VJ(o,i,l.rank,h.rank,s,c);return this.compileAndRun(d,[h,l,f]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=hY(0,t,n),o=new VJ(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new HQ("return real * expR - imag * expI;",t.shape,e),i=new HQ("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],a=this.compileAndRun(r,o),s=this.compileAndRun(i,o),u=this.complex(a,s).as2D(t.shape[0],t.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=cY(t,e),o=i[0],a=i[1],s=i[2],u=i[3],c=e.reshape([a,r]),l=t.reshape([t.size/s,s]),h=new YQ(r,u,[a,s]);return this.compileAndRun(h,[l,c]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||KG(e))){var r=LG(n,SG(t));return r.fill(e),pK.make(t,{values:r},n)}var i=new GQ(t,e),o=i.getCustomSetupFunc(e),a=this.makeOutputArray(t,n);return this.compileAndRun(i,[],a,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return jY(t,e,n)},t.prototype.makeOutputArray=function(t,e){return pK.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=pK.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new rZ(t.shape);return this.compileAndRun(e,[t],pK.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new SJ(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([gX(t.shape)].concat(yX(t.shape))),r=[gX(e)].concat(yX(e)),i=new NJ(r,n.shape);return this.compileAndRun(i,[n]).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,a=bX(i),s=VK(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=s.map((function(t){return 2*t})),e=r?new BQ(a,s):new LQ(a,s),this.compileAndRun(e,[{shape:a,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=FG(n.dtype,0),n;var a=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&SG(e.shape)<=mG.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!xX(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var s,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,a,u),l=this.getAndSaveBinary(c,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),a=o.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(t,e,n,r){var i=[];t.forEach((function(t){var e=SG(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,a,s=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+eQ().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=eQ();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],s=eQ();if(null!=i&&IG(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var s=uQ(e,n.slice(1));return"\n        "+t(s)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+cQ(["b","row","col"],[1,2])+");\n        }\n      "}var u=a[0],c=a[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return "+eQ().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],s=a[0],u=a[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",f="b * "+l+" + (row / 2) * "+c+" + (col / 2)",d=2;d<n-1;d++)h="int b"+d+", "+h,f="b"+d+" * "+(l*=e[n-d-1])+" + "+f;return"\n    vec4 "+i+"("+h+") {\n      int index = "+f+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+eQ().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+oQ(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+aQ(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var a=oQ(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+a+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&IG(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var a=MG(n),s=a.newShape,u=a.keptDims;if(s.length<n.length){var c=uQ(e,s);return"\n      "+t(c)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+cQ(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+aQ(e)+"\n      }\n    ";var l=o[0],h=o[1],f=oQ(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===l?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+f+";\n    vec2 uv = uvFromFlat("+l+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],s=MG(n),u=s.newShape,c=s.keptDims;if(u.length<n.length){var l=uQ(e,u);return"\n        "+t(l)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+cQ(["row","col","depth"],c)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+a+", 1)));\n        "+aQ(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,f=h[0],d=h[1],p=e.shapeInfo.flatOffset;return d===o&&null==p?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+f+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":d===a&&null==p?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+f+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+a+" + depth + "+oQ(r)+";\n        vec2 uv = uvFromFlat("+f+", "+d+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,s=n[1]*a,u=MG(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=uQ(e,c);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+cQ(["row","col","depth","depth2"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+a+", "+o+", 1)));\n        "+aQ(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],v=d[1];return v===s&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":v===o&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+v+", index + "+oQ(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],a=n[3]*o,s=n[2]*a,u=n[1]*s,c=MG(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var f=uQ(e,l);return"\n      "+t(f)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+cQ(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+s+", "+a+", "+o+")) +\n          depth3;\n        "+aQ(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],m=p[1];return m===u&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+s+", "+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" + depth * "+a+" +\n          depth2 * "+o+" + depth3 + "+oQ(r)+";\n      vec2 uv = uvFromFlat("+v+", "+m+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=MG(n),a=o.newShape,s=o.keptDims;if(a.length<n.length){var u=uQ(e,a);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+cQ(["row","col","depth","depth2","depth3","depth4"],s)+");\n      }\n    "}var c=n[5],l=n[4]*c,h=n[3]*l,f=n[2]*h,d=n[1]*f;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+f+", "+h+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+aQ(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],g=v[1];return g===d&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+f+", "+h+", "+l+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===c&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+f+" + depth * "+h+" +\n          depth2 * "+l+" + depth3 * "+c+" + depth4 + "+oQ(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),a="get"+o+"AtOutCoords",s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c=xY(t.shapeInfo.logicalShape,e.logicalShape),l=sQ(u),h=u-s,f=["x","y","z","w","u","v"];n=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords."+f[t+h]+" = 0;"})).join("\n"),r=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+f[e+h]})).join(", ");var d="return outputValue;",p=1===SG(t.shapeInfo.logicalShape),v=1===SG(e.logicalShape);if(1!==s||p||v){if(p&&!v)d=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var m=s-2,g=s-1;c.indexOf(m)>-1&&c.indexOf(g)>-1?d="return vec4(outputValue.x);":c.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(g)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+d+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===a&&null==t.shapeInfo.flatOffset&&IG(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var s=sQ(a),u=xY(t.shapeInfo.logicalShape,e.logicalShape),c=a-o,l=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+s+" coords = getOutputCoords();\n      "+(0===o?"":a<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+l[t+c]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(a<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+l[e+c]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=eQ(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),f=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    #define isnan(value) isnan_custom(value)\n    "+t.defineSpecialNaN+"\n    bvec4 isnan_custom(vec4 val) {\n      return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n    }\n\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  "}(l);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(IG(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,a="",s="b, r, c",u=2;u<t.length-1;u++)a="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,o,a}(e.logicalShape,c),a=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return IG(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=nQ(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=nQ(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=nQ(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=nQ(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),a=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(f+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[f,h,a,s,o,u,n].join("\n")}(o,s,i,e.usesPackedTextures),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===mG.getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var f={},d=0;d<e.variableNames.length;d++){var p=e.variableNames[d];f[p]=t.getUniformLocation(c,p,!1),f["offset"+p]=t.getUniformLocation(c,"offset"+p,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:f,inShapeInfos:a,outShapeInfo:s,infLoc:l,nanLoc:h}}(o.gpgpu,t,a,u)})),h=null!=this.activeTimers;return h&&(s=this.startTimer()),function(t,e,n,r,i){mJ(e.inShapeInfos,n),mJ([e.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===mG.getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],a=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(SG(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(o,s)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,l,a,u,r),h&&(s=this.endTimer(s),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(s)})),!mG.getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=PX((function(){if(!mG.get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=mG.getBool("DEBUG");mG.set("DEBUG",!1);var n=t.abs(r$(1e-8)).dataSync()[0];if(mG.set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,a=n.usage,s=n.isPacked;if(null==n.texture){var u,c=null!=this.activeTimers;c&&(u=eK());var l=n.texShape;if(null==l&&(l=_X(r,s),n.texShape=l),null!=o){var h=bX(r),f=void 0,d=l[1],p=l[0],v=o instanceof Uint8Array;s?(d=(e=UK(l[0],l[1]))[0],f=new qQ(h,[p=e[1],d],v)):f=new WQ(h,[p,d],v);var m=this.makeTensorHandle([p,d],i);this.texData.get(m.dataId).usage=v?NK.PIXELS:NK.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(m.dataId),d,p,o);var g=this.makeTensorHandle(f.outputShape,m.dtype);g.size=SG(f.outputShape),this.texData.get(g.dataId).isPacked=s,this.compileAndRun(f,[m],g);var y=this.texData.get(g.dataId);n.texture=y.texture,n.texShape=y.texShape,n.isPacked=y.isPacked,n.usage=y.usage,this.disposeData(m.dataId),this.texData.delete(g.dataId),n.values=null,c&&(this.uploadWaitMs+=eK()-u)}else{var b=this.acquireTexture(l,a,i,s);n.texture=b}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*zG(e)},t}();OK()&&RK.registerBackend("webgl",(function(){return new aZ}),2);var sZ=QX({abs_:function(t){var e=jX(t,"x","abs");return"complex64"===e.dtype?RK.runKernel((function(t){return t.complexAbs(e)}),{$x:e}):RK.runKernel((function(t,n){var r=t.abs(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}}))}}),uZ=QX({acos_:function(t){var e=jX(t,"x","acos");return RK.runKernel((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(r$(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),cZ=QX({acosh_:function(t){var e=jX(t,"x","acosh");return RK.runKernel((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),lZ=QX({asin_:function(t){var e=jX(t,"x","asin");return RK.runKernel((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(r$(1).sub(n.toFloat().square()).sqrt())}}}))}}),hZ=QX({asinh_:function(t){var e=jX(t,"x","asinh");return RK.runKernel((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(r$(1).add(n.toFloat().square()).sqrt())}}}))}}),fZ=QX({atan_:function(t){var e=jX(t,"x","atan");return RK.runKernel((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),dZ=QX({atanh_:function(t){var e=jX(t,"x","atanh");return RK.runKernel((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(r$(1).sub(n.toFloat().square()))}}}))}}),pZ=QX({ceil_:function(t){var e=jX(t,"x","ceil");return RK.runKernel((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),vZ=QX({clipByValue_:function(t,e,n){var r=jX(t,"x","clipByValue");return xG(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),RK.runKernel((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{$x:r},(function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),d$(t))}}}))}}),mZ=QX({cos_:function(t){var e=jX(t,"x","cos");return RK.runKernel((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),gZ=QX({cosh_:function(t){var e=jX(t,"x","cosh");return RK.runKernel((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),yZ=QX({erf_:function(t){var e=jX(t,"x","erf");return xG("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),RK.runKernel((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),bZ=QX({exp_:function(t){var e=jX(t,"x","exp");return RK.runKernel((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),_Z=QX({expm1_:function(t){var e=jX(t,"x","expm1");return RK.runKernel((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),wZ=QX({floor_:function(t){var e=jX(t,"x","floor");return RK.runKernel((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),xZ=QX({log_:function(t){var e=jX(t,"x","log");return RK.runKernel((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),CZ=QX({log1p_:function(t){var e=jX(t,"x","log1p");return RK.runKernel((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),kZ=QX({logSigmoid_:function(t){var e=jX(t,"x","logSigmoid");return RK.runKernel((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),EZ=QX({neg_:function(t){var e=jX(t,"x","neg");return RK.runKernel((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),SZ=QX({reciprocal_:function(t){var e=jX(t,"x","reciprocal");return RK.runKernel((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),IZ=QX({round_:function(t){var e=jX(t,"x","round");return RK.runKernel((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),TZ=QX({rsqrt_:function(t){var e=jX(t,"x","rsqrt");return RK.runKernel((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),AZ=QX({sigmoid_:function(t){var e=jX(t,"x","sigmoid");return RK.runKernel((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(r$(1).sub(n)))}}}))}}),RZ=QX({sign_:function(t){var e=jX(t,"x","sign");return RK.runKernel((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),OZ=QX({isNaN_:function(t){var e=jX(t,"x","isNaN");return RK.runKernel((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),NZ=QX({isInf_:function(t){var e=jX(t,"x","isInf");return RK.runKernel((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),DZ=QX({isFinite_:function(t){var e=jX(t,"x","isFinite");return RK.runKernel((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return d$(t)}}}))}}),PZ=QX({sin_:function(t){var e=jX(t,"x","sin");return RK.runKernel((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),MZ=QX({sinh_:function(t){var e=jX(t,"x","sinh");return RK.runKernel((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),FZ=QX({softplus_:function(t){var e=jX(t,"x","softplus");return RK.runKernel((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),LZ=QX({sqrt_:function(t){var e=jX(t,"x","sqrt");return RK.runKernel((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),BZ=QX({square_:function(t){var e=jX(t,"x","square");return RK.runKernel((function(t,n){return n([e]),t.square(e)}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}}))}}),jZ=QX({step_:function(t,e){void 0===e&&(e=0);var n=jX(t,"x","step");return RK.runKernel((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return d$(t)}}}))}}),VZ=QX({tan_:function(t){var e=jX(t,"x","tan");return RK.runKernel((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),UZ=QX({tanh_:function(t){var e=jX(t,"x","tanh");return RK.runKernel((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return r$(1).sub(n.square()).mulStrict(t)}}}))}});function zZ(t,e,n,r,i,o){var a,s,u=jX(t,"x","batchNorm"),c=jX(e,"mean","batchNorm"),l=jX(n,"variance","batchNorm");return null!=i&&(a=jX(i,"scale","batchNorm")),null!=r&&(s=jX(r,"offset","batchNorm")),xG(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),xG(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),xG(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=a&&xG(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&xG(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),HZ(u,c,l,s,a,o)}function WZ(t,e,n,r,i,o){var a,s,u=jX(t,"x","batchNorm"),c=jX(e,"mean","batchNorm"),l=jX(n,"variance","batchNorm");return null!=i&&(a=jX(i,"scale","batchNorm")),null!=r&&(s=jX(r,"offset","batchNorm")),xG(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),xG(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),xG(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=a&&xG(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&xG(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),HZ(u,c,l,s,a,o)}function qZ(t,e,n,r,i,o){var a,s,u=jX(t,"x","batchNorm"),c=jX(e,"mean","batchNorm"),l=jX(n,"variance","batchNorm");return null!=i&&(a=jX(i,"scale","batchNorm")),null!=r&&(s=jX(r,"offset","batchNorm")),xG(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),xG(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),xG(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=a&&xG(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&xG(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),HZ(u,c,l,s,a,o)}function HZ(t,e,n,r,i,o){null==o&&(o=.001);var a,s,u,c=jX(t,"x","batchNorm"),l=jX(e,"mean","batchNorm"),h=jX(n,"variance","batchNorm");return null!=i&&(a=jX(i,"scale","batchNorm")),null!=r&&(s=jX(r,"offset","batchNorm")),xG(l.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),xG(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),xG(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,RK.runKernel((function(t,e){var n=t.batchNormalization(u,GZ(l),GZ(h),o,GZ(a),GZ(s));return e([c,l,h,a]),n}),{$x:c,$mean:l,$variance:h,$scale:a,$offset:s},(function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=null==a?r$(1):a,c=CY(r.shape,u.shape),l=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)l.push(u.shape[h]);l.push(1)}var f=n.sub(r),d=t.mul(s),p=TZ(i.add(r$(o))),v=p.mul(p).mul(p).mul(r$(-.5));return{$x:function(){return 1===r.rank?t.mul(eY(p.as4D(1,1,1,r.shape[0]),l)).mul(s).reshape(n.shape):t.mul(p).mul(s).reshape(n.shape)},$mean:function(){var t=p.mul(r$(-1)).mul(d);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$variance:function(){var t=v.mul(f).mul(d);return 1===r.rank&&(t=t.sum(c)),t.reshape(r.shape)},$scale:function(){var e=f.mul(p),n=t.mul(e);return 1===r.rank&&(n=n.sum(c)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(c)),e.reshape(r.shape)}}})).reshape(c.shape)}function GZ(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function KZ(){DX("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var XZ=QX({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),KZ(),zZ(t,e,n,o,i,r)}}),$Z=QX({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),KZ(),WZ(t,e,n,o,i,r)}}),YZ=QX({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),KZ(),qZ(t,e,n,o,i,r)}}),QZ=QX({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),KZ(),HZ(t,e,n,o,i,r)}}),JZ=QX({batchNorm_:HZ}),ZZ=QX({batchNorm2d_:zZ}),t0=QX({batchNorm3d_:WZ}),e0=QX({batchNorm4d_:qZ}),n0=QX({logicalAnd_:function(t,e){var n=jX(t,"a","logicalAnd","bool"),r=jX(e,"b","logicalAnd","bool");return kY(n.shape,r.shape),RK.runKernel((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),r0=QX({logicalNot_:function(t){var e=jX(t,"x","logicalNot","bool");return RK.runKernel((function(t){return t.logicalNot(e)}),{$x:e})}}),i0=QX({logicalOr_:function(t,e){var n=jX(t,"a","logicalOr","bool"),r=jX(e,"b","logicalOr","bool");return kY(n.shape,r.shape),RK.runKernel((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),o0=QX({logicalXor_:function(t,e){var n=jX(t,"a","logicalXor","bool"),r=jX(e,"b","logicalXor","bool");return kY(n.shape,r.shape),i0(t,e).logicalAnd(n0(t,e).logicalNot())}}),a0=QX({where_:function(t,e,n){var r=jX(e,"a","where"),i=jX(n,"b","where"),o=jX(t,"condition","where","bool");return CG(r.shape,i.shape,"Error in where: "),1===o.rank?xG(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):CG(o.shape,i.shape,"Error in where: "),RK.runKernel((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return d$(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),s0=function(t){return fG(this,void 0,void 0,(function(){var e,n,r;return dG(this,(function(i){switch(i.label){case 0:return[4,(e=jX(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=$Y(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},u0=QX({add_:function(t,e){var n,r=jX(t,"a","add"),i=jX(e,"b","add");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t){return t.add(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=CY(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=CY(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}))}}),c0=QX({addN_:function(t){xG(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),xG(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return jX(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!IG(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),RK.runKernel((function(t){return t.addN(e)}),e,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),l0=QX({addStrict_:function(t,e){var n=jX(t,"a","addStrict"),r=jX(e,"b","addStrict");return CG(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),h0=QX({atan2_:function(t,e){var n,r=jX(t,"a","atan2"),i=jX(e,"b","atan2");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=u0(n.square(),r.square()),i=t.mul(r.div(e)),a=CY(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var e=u0(n.square(),r.square()),i=EZ(t.mul(n.div(e))),a=CY(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}}))}}),f0=QX({div_:function(t,e){var n,r=jX(t,"a","div"),i=jX(e,"b","div");if(n=kK(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return p0(r,i);var o=kY(r.shape,i.shape);return RK.runKernel((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=CY(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=CY(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),d0=QX({divStrict_:function(t,e){var n=jX(t,"a","div"),r=jX(e,"b","div");return CG(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),p0=QX({floorDiv_:function(t,e){var n,r=jX(t,"a","floorDiv"),i=jX(e,"b","floorDiv");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=CY(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=CY(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),v0=QX({maximum_:function(t,e){var n,r=jX(t,"a","maximum"),i=jX(e,"b","maximum");return n=kK(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),kY(r.shape,i.shape),RK.runKernel((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),m0=QX({maximumStrict_:function(t,e){var n=jX(t,"a","maximumStrict"),r=jX(e,"b","maximumStrict");return CG(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),g0=QX({minimum_:function(t,e){var n,r=jX(t,"a","minimum"),i=jX(e,"b","minimum");return n=kK(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),kY(r.shape,i.shape),RK.runKernel((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),y0=QX({minimumStrict_:function(t,e){var n=jX(t,"a","minimumStrict"),r=jX(e,"b","minimumStrict");return CG(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),b0=QX({mod_:function(t,e){var n,r=jX(t,"a","mod"),i=jX(e,"b","mod");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=CY(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=CY(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),_0=QX({modStrict_:function(t,e){var n=jX(t,"a","modStrict"),r=jX(e,"b","modStrict");return CG(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),w0=QX({mul_:function(t,e){var n,r=jX(t,"a","mul"),i=jX(e,"b","mul");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=CY(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=CY(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),x0=QX({mulStrict_:function(t,e){var n=jX(t,"a","mul"),r=jX(e,"b","mul");return CG(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),C0=QX({pow_:function(t,e){var n=jX(t,"base","pow"),r=jX(e,"exp","pow"),i=kY(n.shape,r.shape);return t=n.cast(xK(n.dtype,r.dtype)),e=r.cast(xK(n.dtype,r.dtype)),RK.runKernel((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(r$(1))))),a=CY(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),a=n.log().where(e,d$(n)),s=t.mul(o.mul(a)),u=CY(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}))}}),k0=QX({powStrict_:function(t,e){return CG(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),E0=QX({squaredDifference_:function(t,e){var n,r=jX(t,"a","squaredDifference"),i=jX(e,"b","squaredDifference");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1],i=r$(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}}))}}),S0=QX({squaredDifferenceStrict_:function(t,e){var n=jX(t,"a","squaredDifferenceStrict"),r=jX(e,"b","squaredDifferenceStrict");return CG(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),I0=QX({sub_:function(t,e){var n,r=jX(t,"a","sub"),i=jX(e,"b","sub");n=kK(r,i);var o=kY((r=n[0]).shape,(i=n[1]).shape);return RK.runKernel((function(t){return t.subtract(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=CY(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=CY(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}))}}),T0=QX({subStrict_:function(t,e){var n=jX(t,"a","subStrict"),r=jX(e,"b","subStrict");return CG(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),A0=QX({equal_:function(t,e){var n,r=jX(t,"a","equal"),i=jX(e,"b","equal");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),R0=QX({equalStrict_:function(t,e){var n=jX(t,"a","equalStrict"),r=jX(e,"b","equalStrict");return CG(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),O0=QX({greater_:function(t,e){var n,r=jX(t,"a","greater"),i=jX(e,"b","greater");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t){return t.greater(r,i)}),{$a:r,$b:i})}}),N0=QX({greaterEqual_:function(t,e){var n,r=jX(t,"a","greaterEqual"),i=jX(e,"b","greaterEqual");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return d$(n)},$b:function(){return d$(r)}}}))}}),D0=QX({greaterEqualStrict_:function(t,e){var n=jX(t,"a","greaterEqualStrict"),r=jX(e,"b","greaterEqualStrict");return CG(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),P0=QX({greaterStrict_:function(t,e){var n=jX(t,"a","greaterStrict"),r=jX(e,"b","greaterStrict");return CG(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),M0=QX({less_:function(t,e){var n,r=jX(t,"a","less"),i=jX(e,"b","less");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t){return t.less(r,i)}),{$a:r,$b:i})}}),F0=QX({lessEqual_:function(t,e){var n,r=jX(t,"a","lessEqual"),i=jX(e,"b","lessEqual");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t){return t.lessEqual(r,i)}),{$a:r,$b:i})}}),L0=QX({lessEqualStrict_:function(t,e){var n=jX(t,"a","lessEqualStrict"),r=jX(e,"b","lessEqualStrict");return CG(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),B0=QX({lessStrict_:function(t,e){var n=jX(t,"a","lessStrict"),r=jX(e,"b","lessStrict");return CG(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),j0=QX({notEqual_:function(t,e){var n,r=jX(t,"a","notEqual"),i=jX(e,"b","notEqual");return n=kK(r,i),kY((r=n[0]).shape,(i=n[1]).shape),RK.runKernel((function(t){return t.notEqual(r,i)}),{$a:r,$b:i})}}),V0=QX({notEqualStrict_:function(t,e){var n=jX(t,"a","notEqualStrict"),r=jX(e,"b","notEqualStrict");return CG(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function U0(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function z0(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var W0=QX({gather_:function(t,e,n){void 0===n&&(n=0);var r=jX(t,"x","gather"),i=jX(e,"indices","gather","int32");n=PG(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,a=1,s=0;s<n;s++)i.push(t.shape[s]),o*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),a*=t.shape[s];return{batchSize:o,sliceSize:a,dimSize:r,outputShape:i}}(r,i,n);return RK.runKernel((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{$x:r},(function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,a=e.slice(0,n),s=a.length,u=e.slice(n,e.length).slice(1),c=u.length,l=U0(0,s),h=U0(s+1,s+1+c),f=z0([a,[o],u]),d=t.reshape(f),p=i.reshape([o]),v=z0([[s],l,h]),m=d.transpose(v),g=q0(m,p,r.shape[n]),y=KX(v);return g.transpose(y)}}})).reshape(o.outputShape)}}),q0=QX({unsortedSegmentSum_:function(t,e,n){var r=jX(t,"x","unsortedSegmentSum"),i=jX(e,"segmentIds","unsortedSegmentSum","int32");return xG(TG(n),(function(){return"numSegments must be of dtype int"})),RK.runKernel((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=v0(e,d$(e)),r=W0(t,n),i=N0(e,r$(0,"int32")),o=r.rank-i.rank,a=0;a<o;++a)i=B$(i,a+1);i=n0(i,u$(r.shape,"bool"));var s=d$(r);return a0(i,r,s)}(t,n)}}}))}});function H0(t,e,n,r,i,o,a){void 0===o&&(o="NHWC"),xG(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),xG(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),xG(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),xG(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===o?s[3]:s[1],h="NHWC"===o?u.shape[3]:u.shape[1];xG(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),xG(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&xG(TG(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var f=FY(o),d=IY(s,n.shape,r,1,i,a,!1,f),p=RK.runKernel((function(t,e){var r=t.conv2dDerInput(u,n,d);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return Y0(t,n,r,i,o,1,a)},filter:function(){return J0(t,s,n.shape,r,i,o,a)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function G0(t,e,n,r,i,o,a){void 0===o&&(o="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),xG(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),xG(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),xG(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===o?s.shape[3]:s.shape[1],l="NHWC"===o?u.shape[3]:u.shape[1];xG(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),xG(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=a&&xG(TG(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var h=FY(o),f=IY(s.shape,n,r,1,i,a,!1,h);return RK.runKernel((function(t){return t.conv2dDerFilter(s,u,f)}),{x4D:s,dy4D:u})}function K0(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}function X0(t,e,n,r,i){xG(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,a=e,s=!1;4===e.rank&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],c=a.shape[4];xG(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),xG(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),xG(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),xG(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),xG(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=TY(o,n.shape,r,1,i),h=RK.runKernel((function(t){return t.conv3dDerInput(a,n,l)}),{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var $0=QX({conv1d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NWC"),void 0===o&&(o=1);var s=jX(t,"x","conv1d"),u=jX(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),xG(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),xG(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&xG(TG(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),xG(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),xG(MY(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),xG("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),d=Y0(f,h,[1,n],r,"NHWC",[1,o],a);return l?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),Y0=QX({conv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=jX(t,"x","conv2d"),u=jX(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),xG(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),xG(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&xG(TG(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h="NHWC"===i?c.shape[3]:c.shape[1];xG(h===u.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."})),xG(MY(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}));var f=FY(i),d=IY(c.shape,u.shape,n,o,r,a,!1,f),p=RK.runKernel((function(t,e){var n=t.conv2d(c,u,d);return e([u,c]),n}),{x:c,$filter:u},(function(t,e){var a=e[0],s=e[1];return xG(PY(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return H0(s.shape,t,a,n,r,i)},$filter:function(){return G0(s,t,a.shape,n,r,i)}}}));return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Q0=QX({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var a=jX(t,"x","conv3d"),s=jX(e,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),xG(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),xG(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),xG(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),xG(function(t,e){return K0(t)||K0(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),xG("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=TY(u.shape,s.shape,n,o,r),h=RK.runKernel((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){xG(K0(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],a=e[1];return{x:function(){return X0(i.shape,t,a,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var a=e;4===a.rank&&(a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),xG(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),xG(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),xG(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),xG(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),xG(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=TY(o.shape,n,r,1,i);return RK.runKernel((function(t){return t.conv3dDerFilter(o,a,s)}),{x5D:o,dy5D:a})}(i,t,a.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),J0=QX({conv2dDerFilter_:G0}),Z0=QX({conv2dDerInput_:H0}),t1=QX({depthwiseConv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=jX(t,"x","depthwiseConv2d"),u=jX(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),xG(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),xG(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),xG(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),xG(MY(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&xG(TG(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h=IY(c.shape,u.shape,n,o,r,a,!0),f=RK.runKernel((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,$filter:u},(function(t,e){xG(PY(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=RK.runKernel((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}(0,t,r,h)},$filter:function(){return function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),RK.runKernel((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}(n,t,0,h)}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),e1=QX({separableConv2d_:function(t,e,n,r,i,o,a){void 0===o&&(o=[1,1]),void 0===a&&(a="NHWC");var s=jX(t,"x","separableConv2d"),u=jX(e,"depthwiseFilter","separableConv2d"),c=jX(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");xG(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),xG(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),xG(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),xG(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),xG(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var f=u.shape[2],d=u.shape[3];xG(c.shape[2]===f*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*d+", but got "+c.shape[2]+"."}));var p=t1(l,u,r,i,a,o),v=Y0(p,c,1,"valid",a);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),n1=QX({conv2dTranspose_:function(t,e,n,r,i,o){return H0(n,jX(t,"x","conv2dTranspose"),jX(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),r1=QX({conv3dTranspose_:function(t,e,n,r,i){return X0(n,jX(t,"x","conv3dTranspose"),jX(e,"filter","conv3dTranspose"),r,i)}}),i1=QX({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=jX(t,"a","matMul"),a=jX(e,"b","matMul");i=kK(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),f=a.shape.slice(0,-2),d=SG(h),p=SG(f);xG(o.rank>=2&&a.rank>=2&&o.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."})),xG(IG(h,f),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."})),xG(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=o.shape.slice(0,-2).concat([c,l]),m=n?o.as3D(d,s,c):o.as3D(d,c,s),g=r?a.as3D(p,l,u):a.as3D(p,u,l);return RK.runKernel((function(t,e){var i=t.batchMatMul(m,g,n,r);return e([m,g]),i}),{$a:m,$b:g},(function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}})).reshape(v)}}),o1=QX({dot_:function(t,e){var n=jX(t,"t1","dot"),r=jX(e,"t2","dot");xG(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return xG(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),a1=QX({outerProduct_:function(t,e){var n=jX(t,"v1","outerProduct"),r=jX(e,"v2","outerProduct");return xG(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),s1=QX({reverse_:function(t,e){var n=jX(t,"x","reverse");if(0===n.rank)return n.clone();var r=PG(e,n.shape);return RK.runKernel((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),u1=QX({reverse1d_:function(t){var e=jX(t,"x","reverse");return xG(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),s1(e,0)}}),c1=QX({reverse2d_:function(t,e){var n=jX(t,"x","reverse");return xG(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),s1(n,e)}}),l1=QX({reverse3d_:function(t,e){var n=jX(t,"x","reverse");return xG(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),s1(n,e)}}),h1=QX({reverse4d_:function(t,e){var n=jX(t,"x","reverse");return xG(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),s1(n,e)}});function f1(t,e,n,r,i,o){var a=jX(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),xG(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),xG(MY(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&xG(TG(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=EY(s.shape,e,n,r,i,o),l=RK.runKernel((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,o){var a=o[0],s=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=jX(t,"dy","maxPoolBackprop"),c=jX(e,"input","maxPoolBackprop"),l=jX(n,"output","maxPoolBackprop");xG(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),xG(MY(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),xG(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),xG(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var h=EY(c.shape,r,i,o,a,void 0);return RK.runKernel((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,a,s,e,n,r,i)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function d1(t,e,n,r,i,o){var a=jX(t,"x","avgPool","float32");null==r&&(r=[1,1]),xG(MY(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),xG(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=o&&xG(TG(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=EY(s.shape,e,n,r,i,o),l=RK.runKernel((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,o){var a=jX(t,"dy","avgPoolBackprop"),s=jX(e,"input","avgPoolBackprop");xG(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==i&&(i=[1,1]),xG(MY(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,c=a,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),xG(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),xG(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=EY(u.shape,n,r,i,o),f=RK.runKernel((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}(t,s,e,n,r,i)}}}));return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var p1=QX({maxPool_:function(t,e,n,r,i){return f1(t,e,n,1,r,i)}}),v1=QX({avgPool_:function(t,e,n,r,i){return d1(t,e,n,1,r,i)}}),m1=QX({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var a=jX(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),xG(MY(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var c,l=EY(s.shape,e,o,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],d=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),a=e.map((function(t,e){return(t-o[e]%t)%t})),s=i.map((function(t,e){return t+a[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,a[e]]}))]}([l.inHeight,l.inWidth],h,c),p=d[1],v=f?r:"valid",m=f?s:J$(s,h,d[0]),g=("avg"===n?function(){return d1(m,e,o,1,v)}:function(){return f1(m,e,o,1,v)})(),y=f?g:D$(g,h,p);return u?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),g1=QX({maxPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=jX(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),xG(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),xG("NDHWC"===o,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),xG(MY(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&xG(TG(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=SY(u.shape,e,n,a,r,i,o),h=RK.runKernel((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,o){var s=o[0],u=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=jX(t,"dy","maxPool3dBackprop"),c=jX(e,"input","maxPool3dBackprop"),l=jX(n,"output","maxPool3dBackprop"),h=u,f=c,d=l,p=!1;4===c.rank&&(p=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),xG(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),xG(5===f.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+f.rank+"."})),xG(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+d.rank+"."})),null==o&&(o=[1,1,1]),xG(MY(i,o),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),null!=s&&xG(TG(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var v=SY(f.shape,r,i,o,a,s),m=RK.runKernel((function(t){return t.maxPool3dBackprop(h,f,d,v)}),{dy5D:h,input5D:f});return p?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(t,s,u,e,n,a,r,i)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),y1=QX({avgPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=jX(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),xG(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),xG("NDHWC"===o,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),xG(MY(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&xG(TG(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=SY(u.shape,e,n,a,r,i,o),h=RK.runKernel((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,o,a){var s=jX(t,"dy","avgPool3dBackprop"),u=jX(e,"input","avgPool3dBackprop"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),xG(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),xG(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==i&&(i=[1,1,1]),xG(MY(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=a&&xG(TG(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var f=SY(l.shape,n,r,i,o,a),d=RK.runKernel((function(t){return t.avgPool3dBackprop(c,l,f)}),{dy5D:c,input5D:l});return h?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}(t,u,e,n,a,r,i)}}}));return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),b1=QX({slice_:function(t,e,n){var r,i,o=jX(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(t){xG(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(xG(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),o.shape[e]-r[e])})),function(t,e,n){xG(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),xG(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){xG(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}(o,r,i);var a=o.shape;return RK.runKernel((function(t){return t.slice(o,r,i)}),{$x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],a[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}}))}}),_1=QX({slice1d_:function(t,e,n){var r=jX(t,"x","slice1d");return xG(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),b1(r,[e],[n])}}),w1=QX({slice2d_:function(t,e,n){var r=jX(t,"x","slice2d");return xG(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),b1(r,e,n)}}),x1=QX({slice3d_:function(t,e,n){var r=jX(t,"x","slice3d");return xG(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),b1(r,e,n)}}),C1=QX({slice4d_:function(t,e,n){var r=jX(t,"x","slice4d");return xG(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),b1(r,e,n)}});function k1(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(qX(e.shape,r))),t.rank<n.rank&&(t=t.reshape(qX(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var E1=QX({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","all","bool"),i=PG(e,r.shape),o=i,a=GX(o,r.rank);null!=a&&(r=r.transpose(a),o=XX(o.length,r.rank));var s=RK.runKernel((function(t){return t.all(r,o)}),{$x:r});if(n){var u=qX(s.shape,i);return s.reshape(u)}return s}}),S1=QX({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","any","bool"),i=PG(e,r.shape),o=i,a=GX(o,r.rank);null!=a&&(r=r.transpose(a),o=XX(o.length,r.rank));var s=RK.runKernel((function(t){return t.any(r,o)}),{$x:r});if(n){var u=qX(s.shape,i);return s.reshape(u)}return s}}),I1=QX({argMax_:function(t,e){void 0===e&&(e=0);var n=jX(t,"x","argMax");null==e&&(e=0);var r=PG(e,n.shape),i=GX(r,n.rank);return null!=i&&(n=n.transpose(i),r=XX(r.length,n.rank)),RK.runKernel((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return d$(n)}}}))}}),T1=QX({argMin_:function(t,e){void 0===e&&(e=0);var n=jX(t,"x","argMin");null==e&&(e=0);var r=PG(e,n.shape),i=GX(r,n.rank);return null!=i&&(n=n.transpose(i),r=XX(r.length,n.rank)),RK.runKernel((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return d$(n)}}}))}}),A1=QX({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","logSumExp"),i=PG(e,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=qX(s.shape,i);return s.reshape(u)}return s}}),R1=QX({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","max"),i=r,o=PG(e,r.shape),a=o,s=GX(a,r.rank);null!=s&&(r=r.transpose(s),a=XX(a.length,r.rank));var u=RK.runKernel((function(t,e){var n=t.max(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return k1(t,e[1],e[0],o,s)}));if(n){var c=qX(u.shape,o);u=u.reshape(c)}return u}}),O1=QX({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","mean"),i=PG(e,r.shape),o=SG(WX(r.shape,i)[1]);return yY((function(t){var r=r$(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(u$(t.shape,"float32")).div(o)}}}))(r)}}),N1=QX({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","min"),i=r,o=PG(e,r.shape),a=o,s=GX(a,r.rank);null!=s&&(r=r.transpose(s),a=XX(a.length,r.rank));var u=RK.runKernel((function(t,e){var n=t.min(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return k1(t,e[1],e[0],o,s)}));if(n){var c=qX(u.shape,o);u=u.reshape(c)}return u}}),D1=QX({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=PG(e,(t=jX(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=qX(i.shape,r));var a=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),P1=QX({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=PG(e,r.shape);return yY((function(t){var e=GX(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=XX(r.length,t.rank));var a=RK.runKernel((function(t){return t.sum(o,r)}),{permutedX:o});if(n){var s=qX(a.shape,i);a=a.reshape(s)}return{value:a,gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(u$(t.shape,"float32"))}}}))(r)}}),M1=QX({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=jX(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=PG(e,r.shape),o=GX(i,r.rank),a=i,s=r;null!=o&&(s=r.transpose(o),a=XX(a.length,r.rank));var u=RK.runKernel((function(t){return t.prod(s,a)}),{permutedX:s});if(n){var c=qX(u.shape,i);u=u.reshape(c)}return u}}),F1=QX({elu_:function(t){var e=jX(t,"x","elu");return RK.runKernel((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return RK.runKernel((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),L1=QX({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=jX(t,"x","leakyRelu");return v0(r$(e).mul(n),n)}}),B1=QX({prelu_:function(t,e){var n=jX(t,"x","prelu"),r=jX(e,"alpha","prelu");return RK.runKernel((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{$x:n,$alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return a0(i,t,t.mul(r))},$alpha:function(){var e=a0(i,d$(t),t.mul(n)),o=CY(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}))}}),j1=QX({relu_:function(t){var e=jX(t,"x","relu");return"bool"===e.dtype?e.toInt():RK.runKernel((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),V1=QX({selu_:function(t){var e=jX(t,"x","selu");return RK.runKernel((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(r$(0)),r=r$(1.7580993408473768),i=r$(1.0507009873554805),o=t.mul(i),a=t.mul(r).mul(n.toFloat().exp());return a0(e,o,a)}}}))}}),U1=QX({transpose_:function(t,e){var n=jX(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),xG(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){xG(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():RK.runKernel((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=KX(e);return{$x:function(){return t.transpose(n)}}}))}}),z1=QX({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=jX(t,"x","localResponseNormalization");xG(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),xG(TG(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var a=o,s=!1;3===o.rank&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=RK.runKernel((function(t,o){var s=t.localResponseNormalization4D(a,e,n,r,i);return o([a,s]),s}),{x4D:a},(function(t,o){var a=o[0],s=o[1];return{x4D:function(){return RK.runKernel((function(o){return o.LRNGrad(t,a,s,e,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),W1=QX({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(r$(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=jX(t,"x","norm"),e,n),o=i.shape;if(r){var a=PG(n,t.shape);o=qX(i.shape,a)}return i.reshape(o)}}),q1=QX({basicLSTMCell_:function(t,e,n,r,i,o){var a=jX(t,"forgetBias","basicLSTMCell"),s=jX(e,"lstmKernel","basicLSTMCell"),u=jX(n,"lstmBias","basicLSTMCell"),c=jX(r,"data","basicLSTMCell"),l=jX(i,"c","basicLSTMCell"),h=jX(o,"h","basicLSTMCell"),f=c.concat(h,1).matMul(s).add(u),d=f.shape[1]/4,p=[f.shape[0],d],v=f.slice([0,0],p),m=f.slice([0,d],p),g=f.slice([0,2*d],p),y=f.slice([0,3*d],p),b=v.sigmoid().mulStrict(m.tanh()).addStrict(l.mulStrict(a.add(g).sigmoid())),_=b.tanh().mulStrict(y.sigmoid());return[b,_]}}),H1=QX({multiRNNCell_:function(t,e,n,r){for(var i=jX(e,"data","multiRNNCell"),o=VX(n,"c","multiRNNCell"),a=VX(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,o[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],f=[];for(c=0;c<u.length;c+=2)h.push(u[c]),f.push(u[c+1]);return[h,f]}}),G1=QX({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=jX(t,"v","movingAverage"),a=jX(e,"x","movingAverage"),s=jX(n,"decay","movingAverage");EK(o,a),xG(IG(o.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=r$(1),c=u.sub(s),l=a.sub(o).mul(c);if(i){xG(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=jX(r,"step","movingAverage");l=l.div(u.sub(C0(s,h)))}return o.add(l)}}),K1=QX({stridedSlice_:function(t,e,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=jX(t,"x","stridedSlice"),l=fY(s),h=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),c=c.reshape(h);for(var f=0;f<c.rank;f++)e[f]=pY(i,e,r,c.shape,f),n[f]=vY(o,n,r,c.shape,f),r[f]=r[f]||1;var d=fY(u);d.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var p=dY(e,n,r),v=p.filter((function(t,e){return-1===d.indexOf(e)}));return r.every((function(t){return 1===t}))?b1(c,e,p).reshape(v):RK.runKernel((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(v)}}),X1=QX({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=jX(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=RK.runKernel((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),$1=QX({scatterND_:function(t,e,n){var r=jX(t,"indices","scatterND","int32"),i=jX(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+t[a+i]+")")}(n,e,t)}(i,r,n),RK.runKernel((function(t){return t.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),Y1=QX({fft_:function(t){xG("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return RK.runKernel((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),Q1=QX({ifft_:function(t){xG("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return RK.runKernel((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),J1=QX({rfft_:function(t,e){xG("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e,n=t.slice(o,a),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(c$(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=JX(n,u).as2D(i,r),l=Y1(c),h=Math.floor(r/2)+1,f=ZX(l),d=t$(l),p=f.split([h,r-h],f.shape.length-1),v=d.split([h,r-h],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,JX(p[0],v[0]).reshape(m)}}),Z1=QX({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=Q1(r);return ZX(i)}var o=[n,2*(e-1)],a=ZX(t).as2D(n,e),s=t$(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(r$(-1)),l=a.concat(u,1),h=s.concat(c,1);return r=JX(l,h).as2D(o[0],o[1]),i=Q1(r),ZX(i)}}),t2=Object.freeze({fft:Y1,ifft:Q1,rfft:J1,irfft:Z1}),e2=QX({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=jX(t,"sparseIndices","sparseToDense","int32"),o=jX(e,"sparseValues","sparseToDense"),a=jX(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),RK.runKernel((function(t){return t.sparseToDense(i,o,n,a)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),n2=QX({gatherND_:function(t,e){var n=jX(e,"indices","gatherND","int32"),r=jX(t,"x","gatherND");return RK.runKernel((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),r2=QX({diag_:function(t){var e=jX(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return RK.runKernel((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),i2=QX({dropout_:function(t,e,n,r){var i=jX(t,"x","dropout");if(xG("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),xG(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof pK?i.clone():i;var o=function(t,e){if(null==e)return t.shape.slice();if(IG(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),a=1-e,s=Y$(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function o2(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var a=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(a)}return i$(i,"float32")}var a2,s2=QX({hannWindow_:function(t){return o2(t,.5,.5)}}),u2=QX({hammingWindow_:function(t){return o2(t,.54,.46)}}),c2=QX({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,a=[];o+e<=t.size;)a.push(b1(t,o,e)),o+=n;if(r)for(;o<t.size;){var s=o+e-t.size,u=p$([b1(t,o,e-s),l$([s],i)]);a.push(u),o+=n}return 0===a.length?o$([],[0,e]):p$(a).as2D(a.length,e)}}),l2=QX({stft_:function(t,e,n,r,i){void 0===i&&(i=s2),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));for(var o=c2(t,e,n),a=w0(o,i(e)),s=[],u=0;u<o.shape[0];u++)s.push(J1(a.slice([u,0],[1,e]),r));return p$(s)}}),h2=Object.freeze({hannWindow:s2,hammingWindow:u2,frame:c2,stft:l2});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(a2||(a2={}));var f2=QX({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=a2.SUM_BY_NONZERO_WEIGHTS);var i=jX(t,"labels","absoluteDifference"),o=jX(e,"predictions","absoluteDifference"),a=null;null!=n&&(a=jX(n,"weights","absoluteDifference")),CG(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return d2(s,a,r)}}),d2=QX({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=a2.SUM_BY_NONZERO_WEIGHTS);var r=jX(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=jX(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===a2.NONE)return o;if(n===a2.SUM)return o.sum();if(n===a2.MEAN){if(null==i)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(r$(a)):s}if(n===a2.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(r$(r.size));var u=i.mul(u$(r.shape)).notEqual(r$(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),p2=QX({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=a2.SUM_BY_NONZERO_WEIGHTS);var o=jX(t,"labels","cosineDistance"),a=jX(e,"predictions","cosineDistance"),s=null;null!=r&&(s=jX(r,"weights","cosineDistance")),CG(o.shape,a.shape,"Error in cosineDistance: ");var u=r$(1).sub(o.mul(a).sum(n,!0));return d2(u,s,i)}}),v2=QX({hingeLoss_:function(t,e,n,r){void 0===r&&(r=a2.SUM_BY_NONZERO_WEIGHTS);var i=jX(t,"labels","hingeLoss"),o=jX(e,"predictions","hingeLoss"),a=null;null!=n&&(a=jX(n,"weights","hingeLoss")),CG(i.shape,o.shape,"Error in hingeLoss: ");var s=r$(1);i=r$(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return d2(u,a,r)}}),m2=QX({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=a2.SUM_BY_NONZERO_WEIGHTS);var o=jX(t,"labels","huberLoss"),a=jX(e,"predictions","huberLoss"),s=null;null!=n&&(s=jX(n,"weights","huberLoss")),CG(o.shape,a.shape,"Error in huberLoss: ");var u=r$(r),c=a.sub(o).abs(),l=g0(c,u),h=c.sub(l),f=r$(.5).mul(l.square()).add(u.mul(h));return d2(f,s,i)}}),g2=QX({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=a2.SUM_BY_NONZERO_WEIGHTS);var o=jX(t,"labels","logLoss"),a=jX(e,"predictions","logLoss"),s=null;null!=n&&(s=jX(n,"weights","logLoss")),CG(o.shape,a.shape,"Error in logLoss: ");var u=r$(1),c=r$(r),l=o.mul(a.add(c).log()).neg().sub(u.sub(o).mul(u.sub(a).add(c).log()));return d2(l,s,i)}}),y2=QX({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=a2.SUM_BY_NONZERO_WEIGHTS);var i=jX(t,"labels","meanSquaredError"),o=jX(e,"predictions","meanSquaredError"),a=null;null!=n&&(a=jX(n,"weights","meanSquaredError")),CG(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return d2(s,a,r)}}),b2=QX({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=a2.SUM_BY_NONZERO_WEIGHTS);var o=jX(t,"multiClassLabels","sigmoidCrossEntropy"),a=jX(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=jX(n,"weights","sigmoidCrossEntropy")),CG(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=r$(r),c=r$(1),l=r$(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=jX(t,"labels","sigmoidCrossEntropyWithLogits"),r=jX(e,"logits","sigmoidCrossEntropyWithLogits");CG(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),a=r.abs().neg().exp().log1p();return i.sub(o).add(a)}(o,a);return d2(h,s,i)}}),_2=QX({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=a2.SUM_BY_NONZERO_WEIGHTS);var o=jX(t,"onehotLabels","softmaxCrossEntropy"),a=jX(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=jX(n,"weights","softmaxCrossEntropy")),CG(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=r$(r),c=r$(1),l=r$(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return yY((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=qX(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,a);return d2(h,s,i)}}),w2=Object.freeze({get Reduction(){return a2},absoluteDifference:f2,computeWeightedLoss:d2,cosineDistance:p2,hingeLoss:v2,huberLoss:m2,logLoss:g2,meanSquaredError:y2,sigmoidCrossEntropy:b2,softmaxCrossEntropy:_2});function x2(t,e){return void 0===e&&(e=!1),RK.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=j$(n),o=t.clone(),a=o$([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(t){var e,u=o,c=s,l=i;e=RK.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),c=o.slice([t,t],[1,1]),l=o$([[-1]]).where(c.greater(0),o$([[1]])),h=c.sub(l.mul(u)),f=e.div(h);s=1===f.shape[0]?a.clone():a.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var d=l.matMul(h).div(u).neg(),p=o.slice([t,0],[n-t,r]),v=d.mul(s);if(0===t)o=p.sub(v.matMul(s.transpose().matMul(p)));else{var m=p.sub(v.matMul(s.transpose().matMul(p)));o=o.slice([0,0],[t,r]).concat(m,0)}var g=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=g.sub(g.matMul(s).matMul(v.transpose()));else{var y=g.sub(g.matMul(s).matMul(v.transpose()));i=i.slice([0,0],[n,t]).concat(y,1)}return[s,o,i]})),s=e[0],o=e[1],i=e[2],MX([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var C2=QX({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,xG(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){xG(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=b$(t,t.shape[0],0).map((function(t){return Z$(t,[0])}));xG(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],a=t,s=function(t){o.push(RK.tidy((function(){var e=a[t];if(t>0)for(var n=0;n<t;++n){var r=P1(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(W1(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?tY(o,0):o}}),k2=QX({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return x2(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=rY(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=x2(t,e),r=n[1];i.push(n[0]),o.push(r)})),[tY(i,0).reshape(t.shape),tY(o,0).reshape(t.shape)]}}),E2=Object.freeze({gramSchmidt:C2,qr:k2});function S2(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),xG(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),xG(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),xG(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),xG(1===e.rank,(function(){return"scores must be a 1D tensor"})),xG(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var I2=QX({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=jX(t,"images","resizeBilinear");xG(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),xG(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=RK.runKernel((function(t,e){return e([i]),t.resizeBilinear(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return RK.runKernel((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),T2=QX({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=jX(t,"images","resizeNearestNeighbor");xG(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),xG(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),xG("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=RK.runKernel((function(t,e){return e([i]),t.resizeNearestNeighbor(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return RK.runKernel((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),A2=QX({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=jX(t,"boxes","nonMaxSuppression"),a=jX(e,"scores","nonMaxSuppression"),s=S2(o,a,n,r,i);return n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,RK.runKernel((function(t){return t.nonMaxSuppression(o,a,n,r,i)}),{$boxes:o})}}),R2=QX({cropAndResize_:function(t,e,n,r,i,o){var a=jX(t,"image","cropAndResize","float32"),s=jX(e,"boxes","cropAndResize","float32"),u=jX(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=s.shape[0];return xG(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),xG(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),xG(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),xG(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),xG(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),xG("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),RK.runKernel((function(t,e){return t.cropAndResize(a,s,u,r,i,o)}),{$image:a,$boxes:s})}}),O2=Object.freeze({resizeBilinear:I2,resizeNearestNeighbor:T2,nonMaxSuppression:A2,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),fG(this,void 0,void 0,(function(){var o,a,s,u,c;return dG(this,(function(l){switch(l.label){case 0:return o=jX(t,"boxes","nonMaxSuppressionAsync"),a=jX(e,"scores","nonMaxSuppressionAsync"),s=S2(o,a,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return u=l.sent(),c=qY(u[0],u[1],n,r,i),o!==t&&o.dispose(),a!==e&&a.dispose(),[2,c]}}))}))},cropAndResize:R2}),N2=QX({matMul_:function(t){var e,n=t.b,r=t.transposeA,i=void 0!==r&&r,o=t.transposeB,a=void 0!==o&&o,s=t.bias,u=t.activation,c=void 0===u?"linear":u,l=t.preluActivationWeights,h=jX(t.a,"a","fused matMul"),f=jX(n,"b","fused matMul");e=kK(h,f),h=e[0],f=e[1];var d=i?h.shape[h.rank-2]:h.shape[h.rank-1],p=a?f.shape[f.rank-1]:f.shape[f.rank-2],v=i?h.shape[h.rank-1]:h.shape[h.rank-2],m=a?f.shape[f.rank-2]:f.shape[f.rank-1],g=h.shape.slice(0,-2),y=f.shape.slice(0,-2),b=SG(g),_=SG(y);xG(h.rank>=2&&f.rank>=2&&h.rank===f.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+f.rank+"."})),xG(IG(g,y),(function(){return"Error in fused matMul: outer dimensions ("+g+") and ("+y+") of Tensors with shapes "+h.shape+" and "+f.shape+" must match."})),xG(d===p,(function(){return"Error in fused matMul: inner shapes ("+d+") and ("+p+") of Tensors with shapes "+h.shape+" and "+f.shape+" and transposeA="+i+" and transposeB="+a+" must match."}));var w,x,C=h.shape.slice(0,-2).concat([v,m]),k=i?h.as3D(b,d,v):h.as3D(b,v,d),E=a?f.as3D(_,m,p):f.as3D(_,p,m);null!=s&&kY(C,(w=kK(w=jX(s,"bias","fused matMul"),h)[0]).shape),null!=l&&(x=jX(l,"prelu weights","fused matMul"));var S={$a:k,$b:E};return null!=s&&(S.$bias=w),null!=l&&(S.$preluActivationWeights=x),RK.runKernel((function(t,e){var n=t.fusedBatchMatMul({a:k,b:E,transposeA:i,transposeB:a,bias:w,activation:c,preluActivationWeights:x});return e([k,E,n]),n}),S,(function(t,e){var n,r=e[0],o=e[1],u=e[2];if(null==c||"linear"===c)n=t;else{if("relu"!==c)throw new Error("Gradient for activation "+c+" has not been implemented yet.");n=t.mul(u.step())}var l={};return null!=s&&(l={$bias:function(){var t=n,e=CY(w.shape,n.shape);return e.length>0&&(t=t.sum(e)),t.reshape(w.shape)}}),Object.assign(i||a?!i&&a?{$a:function(){return n.matMul(o,!1,!1)},$b:function(){return n.matMul(r,!0,!1)}}:i&&!a?{$a:function(){return o.matMul(n,!1,!0)},$b:function(){return r.matMul(n,!1,!1)}}:{$a:function(){return o.matMul(n,!0,!0)},$b:function(){return n.matMul(r,!0,!0)}}:{$a:function(){return n.matMul(o,!1,!0)},$b:function(){return r.matMul(n,!0,!1)}},l)})).reshape(C)}}),D2=QX({conv2d_:function(t){var e=t.filter,n=t.strides,r=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,a=t.dilations,s=void 0===a?[1,1]:a,u=t.dimRoundingMode,c=t.bias,l=t.activation,h=void 0===l?"linear":l,f=t.preluActivationWeights,d=jX(t.x,"x","conv2d"),p=jX(e,"filter","conv2d"),v=d,m=!1;3===d.rank&&(m=!0,v=d.as4D(1,d.shape[0],d.shape[1],d.shape[2])),xG(4===v.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."})),xG(4===p.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+p.rank+"."})),null!=u&&xG(TG(r),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."})),xG(v.shape[3]===p.shape[2],(function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+p.shape[2]+"."})),xG(MY(n,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"})),xG("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var g,y,b=IY(v.shape,p.shape,n,s,r,u);null!=c&&(g=kK(g=jX(c,"bias","fused conv2d"),d)[0],kY(b.outShape,g.shape)),null!=f&&(y=jX(f,"prelu weights","fused conv2d"));var _={x:v,$filter:p};null!=c&&(_.$bias=g),null!=f&&(_.$preluActivationWeights=y);var w=RK.runKernel((function(t,e){var n=t.fusedConv2d(v,p,b,g,h,y);return e([p,v,n]),n}),_,(function(t,e){var i,o=e[0],a=e[1],u=e[2];if(null==h||"linear"===h)i=t;else{if("relu"!==h)throw new Error("Gradient for activation "+h+" has not been implemented yet.");i=t.mul(u.step())}xG(PY(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+s+"'"}));var l={};return null!=c&&(l={$bias:function(){var t=i,e=CY(g.shape,i.shape);return e.length>0&&(t=t.sum(e)),t.reshape(g.shape)}}),Object.assign({x:function(){return Z0(a.shape,i,o,n,r)},$filter:function(){return J0(a,i,o.shape,n,r)}},l)}));return m?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),P2=Object.freeze({matMul:N2,conv2d:D2}),M2=Object.freeze({image:O2,linalg:E2,losses:w2,spectral:t2,fused:P2,signal:h2,op:QX,batchNormalization2d:XZ,batchNormalization3d:$Z,batchNormalization4d:YZ,batchNormalization:QZ,batchNorm:JZ,batchNorm2d:ZZ,batchNorm3d:t0,batchNorm4d:e0,booleanMaskAsync:function(t,e,n){return fG(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,d,p,v;return dG(this,(function(m){switch(m.label){case 0:for(r=jX(t,"tensor","boolMask"),i=jX(e,"mask","boolMask","bool"),o=null==n?0:n,s=r.shape,xG((a=i.rank)>0,(function(){return"mask cannot be scalar"})),CG(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=o;c<o+a;c++)u*=s[c];return l=s.slice(0,o).concat([u],s.slice(o+a)),h=r.reshape(l),f=i.reshape([-1]),[4,s0(f)];case 1:return d=m.sent(),p=d.squeeze([1]),v=W0(h,p,o),t!==r&&r.dispose(),e!==i&&i.dispose(),p.dispose(),h.dispose(),f.dispose(),d.dispose(),[2,v]}}))}))},complex:JX,real:ZX,imag:t$,concat:p$,concat1d:v$,concat2d:m$,concat3d:g$,concat4d:y$,split:b$,conv1d:$0,conv2d:Y0,conv3d:Q0,conv2dDerFilter:J0,conv2dDerInput:Z0,depthwiseConv2d:t1,separableConv2d:e1,conv2dTranspose:n1,conv3dTranspose:r1,matMul:i1,dot:o1,outerProduct:a1,reverse:s1,reverse1d:u1,reverse2d:c1,reverse3d:l1,reverse4d:h1,maxPool:p1,avgPool:v1,pool:m1,maxPool3d:g1,avgPool3d:y1,slice:b1,slice1d:_1,slice2d:w1,slice3d:x1,slice4d:C1,abs:sZ,acos:uZ,acosh:cZ,asin:lZ,asinh:hZ,atan:fZ,atanh:dZ,ceil:pZ,clipByValue:vZ,cos:mZ,cosh:gZ,erf:yZ,exp:bZ,expm1:_Z,floor:wZ,log:xZ,log1p:CZ,logSigmoid:kZ,neg:EZ,reciprocal:SZ,round:IZ,rsqrt:TZ,sigmoid:AZ,sign:RZ,isNaN:OZ,isInf:NZ,isFinite:DZ,sin:PZ,sinh:MZ,softplus:FZ,sqrt:LZ,square:BZ,step:jZ,tan:VZ,tanh:UZ,all:E1,any:S1,argMax:I1,argMin:T1,logSumExp:A1,max:R1,mean:O1,min:N1,moments:D1,sum:P1,prod:M1,equal:A0,equalStrict:R0,greater:O0,greaterEqual:N0,greaterEqualStrict:D0,greaterStrict:P0,less:M0,lessEqual:F0,lessEqualStrict:L0,lessStrict:B0,notEqual:j0,notEqualStrict:V0,add:u0,addN:c0,addStrict:l0,atan2:h0,div:f0,divStrict:d0,floorDiv:p0,maximum:v0,maximumStrict:m0,minimum:g0,minimumStrict:y0,mod:b0,modStrict:_0,mul:w0,mulStrict:x0,pow:C0,powStrict:k0,squaredDifference:E0,squaredDifferenceStrict:S0,sub:I0,subStrict:T0,elu:F1,leakyRelu:L1,prelu:B1,relu:j1,selu:V1,logicalAnd:n0,logicalNot:r0,logicalOr:i0,logicalXor:o0,where:a0,whereAsync:s0,buffer:N$,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:D$,cast:P$,clone:M$,cumsum:F$,depthToSpace:L$,expandDims:B$,eye:j$,multinomial:V$,oneHot:U$,pad:z$,pad1d:W$,pad2d:q$,pad3d:H$,pad4d:G$,rand:K$,randomNormal:X$,randomGamma:$$,randomUniform:Y$,reshape:Q$,spaceToBatchND:J$,squeeze:Z$,stack:tY,tile:eY,truncatedNormal:nY,unstack:rY,setdiff1dAsync:function(t,e){return fG(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h;return dG(this,(function(f){switch(f.label){case 0:return n=jX(t,"x","setdiff1d"),r=jX(e,"y","setdiff1d"),xG(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),xG(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),xG(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=f.sent(),[4,r.data()];case 2:for(o=f.sent(),a=new Set(o),s=0,l=0;l<i.length;l++)a.has(i[l])||s++;for(u=new lK([s],n.dtype),c=new lK([s],"int32"),l=0,h=0;l<i.length;l++)a.has(i[l])||(u.values[h]=i[l],c.values[h]=l,h++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},fill:l$,linspace:function(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return RK.runKernel((function(r){return r.linspace(t,e,n)}),{})},ones:u$,range:h$,scalar:r$,tensor:e$,tensor1d:i$,tensor2d:o$,tensor3d:a$,tensor4d:s$,tensor5d:function(t,e,n){if(kG(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=LX(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return n$(t,e,r,n)},tensor6d:function(t,e,n){if(kG(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=LX(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return n$(t,e=e||r,r,n)},zeros:c$,onesLike:f$,zerosLike:d$,transpose:U1,softmax:bY,logSoftmax:_Y,localResponseNormalization:z1,norm:W1,gather:W0,unsortedSegmentSum:q0,basicLSTMCell:q1,multiRNNCell:H1,movingAverage:G1,stridedSlice:K1,topk:X1,scatterND:$1,fft:Y1,ifft:Q1,rfft:J1,irfft:Z1,sparseToDense:e2,gatherND:n2,diag:r2,dropout:i2,hannWindow:s2,hammingWindow:u2,frame:c2,stft:l2,inTopKAsync:function(t,e,n){return void 0===n&&(n=1),fG(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,d,p,v,m;return dG(this,(function(g){switch(g.label){case 0:return r=jX(t,"predictions","inTopK"),i=jX(e,"targets","inTopK"),xG(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),xG(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),CG(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],xG(n>0&&n<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n})),[4,r.data()];case 1:return a=g.sent(),[4,i.data()];case 2:for(s=g.sent(),l=(u=[a.length/o,o])[1],h=FG("bool",c=u[0]),f=0;f<c;f++){for(p=a.subarray(d=f*l,d+l),v=[],m=0;m<p.length;m++)v.push({value:p[m],index:m});for(v.sort((function(t,e){return e.value-t.value})),h[f]=0,m=0;m<n;m++)if(v[m].index===s[f]){h[f]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,e$(h,i.shape,"bool")]}}))}))}});function F2(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var L2=function(){function t(){if(this.blockSize=48,this.firstUse=!0,mG.get("IS_BROWSER")){var t="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==t&&(this.fromPixels2DContext=t.getContext("2d"))}this.data=new wY(this,RK)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,mG.get("IS_NODE")&&FX("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,i=t.data instanceof Uint8Array,o="undefined"!=typeof ImageData&&t instanceof ImageData,a="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,u=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=u[0],l=u[1];if(mG.get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,c,l).data;else if(o||i)n=t.data;else{if(!s&&!a)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=l,this.fromPixels2DContext.drawImage(t,0,0,c,l),n=this.fromPixels2DContext.getImageData(0,0,c,l).data}if(4===e)r=new Int32Array(n);else{var h=c*l;r=new Int32Array(h*e);for(var f=0;f<h;f++)for(var d=0;d<e;++d)r[f*e+d]=n[4*f+d]}return a$(r,[l,c,e],"int32")},t.prototype.read=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?VY(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return iK(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return N$(t.shape,t.dtype,n)},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){return e=eK(),t(),[2,{kernelMs:eK()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=pK.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:RK.keep(t.clone()),imag:RK.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&xG("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),mY(t.shape,e,n)){var r=gY(e,t.strides),i=SG(n);return e$(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=N$(n,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s).map((function(t,n){return t+e[n]}));o.values[s]=a.get.apply(a,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r){this.assertNotComplex(t,"stridedSlice");var i=dY(e,n,r);if(i.some((function(t){return 0===t})))return e$([],i);for(var o=N$(i,t.dtype),a=this.bufferSync(t),s=0;s<o.size;s++){for(var u=o.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];o.set.apply(o,[a.get.apply(a,c)].concat(u))}return o.toTensor()},t.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=N$([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=N$(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),a=o.slice();e.forEach((function(e){return a[e]=t.shape[e]-1-a[e]})),n.set.apply(n,[r.get.apply(r,a)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return ZX(t)})),i=t.map((function(t){return t$(t)}));return JX(this.concat(r,e),this.concat(i,e))}var o=t.map((function(t){var n=SG(t.shape.slice(e));return t.as2D(-1,n)})),a=YX(o.map((function(t){return t.shape})),1),s=N$(a,t[0].dtype).values;if(1===o[0].shape[0]){var u=0;o.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;o.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var o=i*a[1]+c,u=0;u<t.shape[1];++u)s[o+u]=e[r++];c+=t.shape[1]}))}var l=YX(t.map((function(t){return t.shape})),e);return e$(s,l,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(r$(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,xK(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=N$(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var a=n[o],s=0;s<i.length;s++)i[s]+=a[s];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,xK(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],f=l[1],d=l[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],v=p[0],m=p[1],g=p[2],y=o*a,b=N$([s,o,a],t.dtype),_=b.values,w=this.blockSize,x=0;x<s;x++)for(var C=0;C<o;C+=w)for(var k=0;k<a;k+=w)for(var E=0;E<i;E+=w)for(var S=Math.min(C+w,o),I=Math.min(k+w,a),T=Math.min(E+w,i),A=C;A<S;A++)for(var R=k;R<I;R++){for(var O=0,N=E;N<T;N++)O+=u[x*h+A*f+N*d]*c[N*v+R*m+x*g];_[x*y+(A*a+R)]+=O}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.batchMatMul(t.a,t.b,t.transposeA,t.transposeB);return e&&(i=this.add(i,e)),n&&(i=F2(this,i,n,r)),i},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,xK(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),HX("sum",e,t.rank);for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],xK(t.dtype,"int32")),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=0,h=0;h<o;++h)l+=s[c+h];a[u]=l}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],xK(t.dtype,"int32")),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=1,h=0;h<o;++h)l*=s[c+h];a[u]=l}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var a=r$(o,"int32"),s=A0(a,e).asType("float32").mul(t).sum(0);r.push(s)}return tY(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];HX("argMin",n,t.rank);for(var r=WX(t.shape,n),i=r[1],o=c$(r[0],"int32"),a=SG(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0,d=0;d<a;++d){var p=u[l+d];p<h&&(h=p,f=d)}s[c]=f}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];HX("argMax",n,t.rank);for(var r=WX(t.shape,n),i=r[1],o=c$(r[0],"int32"),a=SG(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0,d=0;d<a;++d){var p=u[l+d];p>h&&(h=p,f=d)}s[c]=f}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=xK(t.dtype,"int32"),o=c$(t.shape,i),a=this.readSync(o.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var f=c(l,h);if(0===h)a[f]=n?0:s[f];else{var d=c(l,h-1);a[f]=n?s[d]+a[d]:s[f]+a[d]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return pK.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),a=c$(e.shape,xK(e.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],l=0;l<r.length;l++)for(var h=0;h<c;h++)s[u++]=1===r[l]?i[l]:o[l];return a},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return $Y(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),XY(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),HX("min",e,t.rank);for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],t.dtype),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h){var f=s[c+h];f<l&&(l=f)}a[u]=l}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),HX("max",e,t.rank);for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],t.dtype),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h){var f=s[c+h];f>l&&(l=f)}a[u]=l}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),HX("all",e,t.rank);for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],t.dtype),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h)l=l&&s[c+h];a[u]=l}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),HX("any",e,t.rank);for(var n=WX(t.shape,e),r=n[1],i=c$(n[0],t.dtype),o=SG(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var c=u*o,l=s[c],h=0;h<o;++h)l=l||s[c+h];a[u]=l}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return pK.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return pK.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return pK.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return pK.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return pK.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return pK.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return pK.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return pK.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return pK.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return pK.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return pK.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return pK.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return pK.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return pK.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return pK.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=c$(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return pK.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o];n[o]=a>=1?i[o]:i[o]*(a+1)}return pK.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return pK.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>n?n:a<e?e:a}return pK.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return pK.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return pK.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return pK.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return pK.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,a=r[i]>-e,s=r[i]<e,u=Math.exp(r[i]);o=s?u:a?r[i]:Math.log(1+u),n[i]=o}return pK.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return pK.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return pK.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return pK.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return pK.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return pK.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return pK.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return pK.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return pK.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=AG(n[r]);return pK.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return pK.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return pK.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return pK.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r],o=1/(1+.3275911*i);e[r]=1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i)}return pK.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return pK.make(t.shape,{values:n})},t.prototype.fusedConv2d=function(t,e,n,r,i,o){var a=this.conv2d(t,e,n);return r&&(a=this.add(a,r)),i&&(a=F2(this,a,i,o)),a},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=N$(n.outShape,t.dtype),h=t.strides[0],f=c?t.strides[1]:t.strides[2],d=c?t.strides[2]:1,p=c?1:t.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(t.dataId),_=this.readSync(e.dataId),w=l.values,x=0;x<n.batchSize;++x)for(var C=x*h,k=x*v,E=0;E<n.outHeight;++E)for(var S=k+E*m,I=E*n.strideHeight-u,T=0;T<r;T++){var A=I+T*o;if(!(A<0||A>=n.inHeight))for(var R=T*e.strides[0],O=C+A*f,N=0;N<n.outWidth;++N)for(var D=S+N*g,P=N*n.strideWidth-s,M=0;M<i;M++){var F=P+M*a;if(!(F<0||F>=n.inWidth))for(var L=O+F*d,B=R+M*e.strides[1],j=0;j<n.inChannels;++j){for(var V=b[L+j*p],U=0;U<n.outChannels;++U)w[D+U*y]+=V*_[B+U];B+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,f=N$(n.outShape,t.dtype),d=this.readSync(t.dataId),p=this.readSync(e.dataId),v=f.values,m=0;m<n.batchSize;++m)for(var g=m*t.strides[0],y=m*f.strides[0],b=0;b<n.outDepth;++b)for(var _=y+b*f.strides[1],w=b*n.strideDepth-c,x=0;x<r;x++){var C=w+x*a;if(!(C<0||C>=n.inDepth))for(var k=x*e.strides[0],E=g+C*t.strides[1],S=0;S<n.outHeight;++S)for(var I=_+S*f.strides[2],T=S*n.strideHeight-h,A=0;A<i;A++){var R=T+A*s;if(!(R<0||R>=n.inHeight))for(var O=k+A*e.strides[1],N=E+R*t.strides[2],D=0;D<n.outWidth;++D)for(var P=I+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<o;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=N+L*n.inChannels,j=O+F*e.strides[2],V=0;V<n.inChannels;++V){for(var U=d[B+V],z=0;z<n.outChannels;++z)v[P+z]+=U*p[j+z];j+=n.outChannels}}}}return f.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=N$(n.inShape,"float32"),i=r.values,o=this.readSync(t.dataId),a=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],h=n.batchSize,f=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,_=n.strideHeight,w=n.strideWidth,x=f-1-n.padInfo.top,C=d-1-n.padInfo.left,k="channelsLast"===n.dataFormat,E=r.strides[0],S=k?r.strides[1]:r.strides[2],I=k?r.strides[2]:1,T=k?1:r.strides[1],A=t.strides[0],R=k?t.strides[1]:t.strides[2],O=k?t.strides[2]:1,N=k?1:t.strides[1],D=0;D<h;++D)for(var P=0;P<p;++P)for(var M=0;M<v;++M)for(var F=M-x,L=Math.max(0,Math.ceil(F/_)),B=Math.min(y,(f+F)/_),j=0;j<m;++j){for(var V=j-C,U=Math.max(0,Math.ceil(V/w)),z=Math.min(b,(d+V)/w),W=0,q=L;q<B;++q)for(var H=q*_-F,G=U;G<z;++G)for(var K=A*D+R*q+O*G,X=u*(f-1-H)+c*(d-1-(G*w-V))+l*P,$=0;$<g;++$)W+=o[K+N*$]*a[X+$];i[E*D+S*M+I*j+T*P]=W}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=N$(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=o[3],l=this.readSync(t.dataId),h=t.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=n.batchSize,C=n.filterDepth,k=n.filterHeight,E=n.filterWidth,S=n.inChannels,I=n.inDepth,T=n.inHeight,A=n.inWidth,R=n.outChannels,O=n.outDepth,N=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=C-1-n.padInfo.front,B=k-1-n.padInfo.top,j=E-1-n.padInfo.left,V=0;V<x;++V)for(var U=0;U<S;++U)for(var z=0;z<I;++z)for(var W=z-L,q=Math.max(0,Math.ceil(W/P)),H=Math.min(O,(C+W)/P),G=0;G<T;++G)for(var K=G-B,X=Math.max(0,Math.ceil(K/M)),$=Math.min(N,(k+K)/M),Y=0;Y<A;++Y){for(var Q=Y-j,J=Math.max(0,Math.ceil(Q/F)),Z=Math.min(D,(E+Q)/F),tt=0,et=q;et<H;++et)for(var nt=et*P-W,rt=X;rt<$;++rt)for(var it=rt*M-K,ot=J;ot<Z;++ot)for(var at=f*V+d*et+p*rt+v*ot,st=y*(C-1-nt)+b*(k-1-it)+_*(E-1-(ot*F-Q))+w*U,ut=0;ut<R;++ut)tt+=l[at+ut]*m[st+ut];i[a*V+s*z+u*G+c*Y+U]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=N$(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<o;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((c-m)/i)),y=Math.min(n.outWidth,(n.inWidth+c-m)/i),b=0;b<n.inChannels;++b)for(var _=0;_<n.outChannels;++_){for(var w=0,x=0;x<n.batchSize;++x)for(var C=p;C<v;++C)for(var k=d+C*r-l,E=g;E<y;++E){var S=m+E*i-c;w+=s?h.get(x,k,S,b)*f.get(x,C,E,_):h.get(x,b,k,S)*f.get(x,_,C,E)}u.set(w,d,m,b,_)}return u.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=N$(n.filterShape,"float32"),l=c.values,h=c.strides,f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=this.readSync(t.dataId),C=t.strides,k=C[0],E=C[1],S=C[2],I=C[3],T=n.padInfo.front,A=n.padInfo.left,R=n.padInfo.top,O=0;O<a;++O)for(var N=Math.max(0,Math.ceil((T-O)/r)),D=Math.min(n.outDepth,(n.inDepth+T-O)/r),P=O*f,M=0;M<s;++M)for(var F=Math.max(0,Math.ceil((R-M)/i)),L=Math.min(n.outHeight,(n.inHeight+R-M)/i),B=M*d+P,j=0;j<u;++j)for(var V=Math.max(0,Math.ceil((A-j)/o)),U=Math.min(n.outWidth,(n.inWidth+A-j)/o),z=j*p+B,W=0;W<n.inChannels;++W)for(var q=W*v+z,H=0;H<n.outChannels;++H){for(var G=0,K=0;K<n.batchSize;++K)for(var X=K*k,$=K*y,Y=N;Y<D;++Y)for(var Q=(O+Y*r-T)*E+X,J=Y*b+$,Z=F;Z<L;++Z)for(var tt=(M+Z*i-R)*S+Q,et=Z*_+J,nt=V;nt<U;++nt)G+=x[(j+nt*o-A)*I+tt+W]*m[nt*w+et+H];l[q+H]=G}return c.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=N$(n.outShape,t.dtype),h=this.readSync(t.dataId),f=this.readSync(e.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*t.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,_=0;_<r;++_){var w=b+_*o;if(!(w<0||w>=n.inHeight))for(var x=_*e.strides[0],C=v+w*t.strides[1],k=0;k<n.outWidth;++k)for(var E=y+k*l.strides[2],S=k*n.strideWidth-u,I=0;I<i;++I){var T=S+I*a;if(!(T<0||T>=n.inWidth))for(var A=C+T*n.inChannels,R=E,O=x+I*e.strides[1],N=0;N<n.inChannels;++N){for(var D=h[A+N],P=0;P<c;++P)d[R+P]+=D*f[O+P];R+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=N$(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],f=l[1],d=l[2],p=this.readSync(e.dataId),v=e.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,_=n.filterHeight,w=n.filterWidth,x=n.inChannels,C=n.inHeight,k=n.inWidth,E=n.outHeight,S=n.outWidth,I=n.strideHeight,T=n.strideWidth,A=_-1-n.padInfo.top,R=w-1-n.padInfo.left,O=n.outChannels/x,N=0;N<b;++N)for(var D=0;D<x;++D)for(var P=0;P<C;++P)for(var M=P-A,F=Math.max(0,Math.ceil(M/I)),L=Math.min(E,(_+M)/I),B=0;B<k;++B){for(var j=B-R,V=Math.max(0,Math.ceil(j/T)),U=Math.min(S,(w+j)/T),z=0,W=F;W<L;++W)for(var q=W*I-M,H=V;H<U;++H)for(var G=h*N+f*W+d*H,K=m*(_-1-q)+g*(w-1-(H*T-j))+y*D,X=0;X<O;++X)z+=c[G+(D*O+X)]*p[K+X];i[a*N+s*P+u*B+D]=z}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=N$(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<o;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((u-m)/i)),y=Math.min(n.outWidth,(n.inWidth+u-m)/i),b=0;b<n.outChannels;++b){for(var _=Math.trunc(b/l),w=b%l,x=0,C=0;C<n.batchSize;++C)for(var k=p;k<v;++k)for(var E=d+k*r-c,S=g;S<y;++S)x+=h.get(C,E,m+S*i-u,_)*f.get(C,k,S,b);s.set(x,d,m,_,w)}return s.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),KY(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),a=N$(r,t.dtype);0!==n&&a.values.fill(n);for(var s=0;s<t.size;s++){var u=o.indexToLoc(s),c=u.map((function(t,e){return t+i[e]}));a.set.apply(a,[o.get.apply(o,u)].concat(c))}return a.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=N$(n,t.dtype),a=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[e[c]];var l=o.locToIndex(u);o.values[l]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=N$(r,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s),c=u.slice();c[n]=i[u[n]];var l=a.locToIndex(c);o.values[s]=a.values[l]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=iY(t.shape,e,r),o=oY(i.length,e.length),a=aY(t.shape,e,r),s=sY(n,e.length),u=uY(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=iY(a.shape,e,r,!1),u=oY(s.length,e.length,!1),c=aY(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=this.readSync(t.dataId),d=N$(e.outShape,t.dtype),p=d.values,v=e.outShape[1]*e.outShape[2]*e.outShape[3],m=e.outShape[2]*e.outShape[3],g=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*v,_=y*t.strides[0],w=0;w<e.inChannels;++w)for(var x=0;x<e.outHeight;++x)for(var C=x*r-c,k=Math.max(0,C),E=Math.min(e.inHeight,s+C),S=b+x*m,I=0;I<e.outWidth;++I){for(var T=I*i-l,A=Math.max(0,T),R=Math.min(e.inWidth,u+T),O=h,N=0,D=0,P=k;P<E;P+=o){for(var M=_+P*t.strides[1],F=A;F<R;F+=a){var L=f[M+F*t.strides[2]+w];"max"===n&&L>O?O=L:"avg"===n&&(N+=L,D++)}if(isNaN(O))break}p[S+I*g+w]="avg"===n?N/D:O}return d.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=N$(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),f=0;f<e.batchSize;++f)for(var d=0;d<e.inChannels;++d)for(var p=0;p<e.outHeight;++p){for(var v=p*r-c,m=v;m<0;)m+=o;for(var g=Math.min(e.inHeight,s+v),y=0;y<e.outWidth;++y){for(var b=y*i-l,_=b;_<0;)_+=a;for(var w=Math.min(e.inWidth,u+b),x=Number.NEGATIVE_INFINITY,C=-1,k=m;k<g;k+=o)for(var E=k-v,S=_;S<w;S+=a){var I=S-b,T=h.get(f,k,S,d);T>x&&(x=T,C=E*u+I)}n.set(C,f,p,y,d)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,f=c-1-r.padInfo.top,d=N$(e.shape,"float32"),p=this.bufferSync(i),v=this.bufferSync(t),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var _=y-f,w=b-h,x=0,C=0;C<c;C+=s){var k=(_+C)/o;if(!(k<0||k>=r.outHeight||Math.floor(k)!==k))for(var E=0;E<l;E+=u){var S=(w+E)/a;if(!(S<0||S>=r.outWidth||Math.floor(S)!==S)){var I=c*l-1-p.get(m,k,S,g)===C*l+E?1:0;0!==I&&(x+=v.get(m,k,S,g)*I)}}}d.set(x,m,y,b,g)}return d.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,f=c-1-n.padInfo.top,d=N$(e.shape,"float32"),p=1/(o*a),v=this.bufferSync(t),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var _=y-f,w=b-h,x=0,C=0;C<c;C+=s){var k=(_+C)/r;if(!(k<0||k>=n.outHeight||Math.floor(k)!==k))for(var E=0;E<l;E+=u){var S=(w+E)/i;S<0||S>=n.outWidth||Math.floor(S)!==S||(x+=v.get(m,k,S,g))}}d.set(x*p,m,y,b,g)}return d.toTensor()},t.prototype.pool3d=function(t,e,n){this.assertNotComplex(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(t.dataId),g=N$(e.outShape,t.dtype),y=g.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],_=e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[3]*e.outShape[4],x=e.outShape[4],C=0;C<e.batchSize;++C)for(var k=C*b,E=C*t.strides[0],S=0;S<e.inChannels;++S)for(var I=0;I<e.outDepth;++I){for(var T=I*r-f,A=T;A<0;)A+=a;for(var R=Math.min(e.inDepth,c+T),O=k+I*_,N=0;N<e.outHeight;++N){for(var D=N*i-d,P=D;P<0;)P+=s;for(var M=Math.min(e.inHeight,l+D),F=O+N*w,L=0;L<e.outWidth;++L){for(var B=L*o-p,j=B;j<0;)j+=u;for(var V=Math.min(e.inWidth,h+B),U=F+L*x,z=v,W=0,q=0,H=A;H<R;H+=a){for(var G=E+H*t.strides[1],K=P;K<M;K+=s){for(var X=G+K*t.strides[2],$=j;$<V;$+=u){var Y=m[X+$*t.strides[3]+S];if("max"===n&&Y>z?z=Y:"avg"===n&&(W+=Y,q++),isNaN(z))break}if(isNaN(z))break}if(isNaN(z))break}y[U+S]="avg"===n?W/q:z}}}return g.toTensor()},t.prototype.avgPool3d=function(t,e){return this.assertNotComplex(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,f=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=f-1-n.padInfo.front,m=p-1-n.padInfo.left,g=d-1-n.padInfo.top,y=N$(e.shape,"float32"),b=1/(a*s*u),_=this.bufferSync(t),w=0;w<n.batchSize;++w)for(var x=0;x<n.inChannels;++x)for(var C=0;C<n.inDepth;++C)for(var k=0;k<n.inHeight;++k)for(var E=0;E<n.inWidth;++E){for(var S=C-v,I=k-g,T=E-m,A=0,R=0;R<f;R+=c){var O=(S+R)/r;if(!(O<0||O>=n.outDepth||Math.floor(O)!==O))for(var N=0;N<d;N+=l){var D=(I+N)/i;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var P=0;P<p;P+=h){var M=(T+P)/o;M<0||M>=n.outWidth||Math.floor(M)!==M||(A+=_.get(w,O,D,M,x))}}}y.set(A*b,w,C,k,E,x)}return y.toTensor()},t.prototype.maxPool3d=function(t,e){return this.assertNotComplex(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},t.prototype.maxPool3dPositions=function(t,e){for(var n=N$(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v=this.bufferSync(t),m=0;m<e.batchSize;++m)for(var g=0;g<e.inChannels;++g)for(var y=0;y<e.outDepth;++y){for(var b=y*r-f,_=b;_<0;)_+=a;for(var w=Math.min(e.inDepth,c+b),x=0;x<e.outHeight;++x){for(var C=x*i-d,k=C;k<0;)k+=s;for(var E=Math.min(e.inHeight,l+C),S=0;S<e.outWidth;++S){for(var I=S*o-p,T=I;T<0;)T+=u;for(var A=Math.min(e.inWidth,h+I),R=Number.NEGATIVE_INFINITY,O=-1,N=_;N<w;N+=a)for(var D=N-b,P=k;P<E;P+=s)for(var M=P-C,F=T;F<A;F+=u){var L=F-I,B=v.get(m,N,P,F,g);B>=R&&(R=B,O=D*l*h+M*l+L)}n.set(O,m,y,x,S,g)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=h-1-r.padInfo.front,v=d-1-r.padInfo.left,m=f-1-r.padInfo.top,g=N$(e.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(t),_=0;_<r.batchSize;++_)for(var w=0;w<r.inChannels;++w)for(var x=0;x<r.inDepth;++x)for(var C=0;C<r.inHeight;++C)for(var k=0;k<r.inWidth;++k){for(var E=x-p,S=C-m,I=k-v,T=0,A=0;A<h;A+=u){var R=(E+A)/o;if(!(R<0||R>=r.outDepth||Math.floor(R)!==R))for(var O=0;O<f;O+=c){var N=(S+O)/a;if(!(N<0||N>=r.outHeight||Math.floor(N)!==N))for(var D=0;D<d;D+=l){var P=(I+D)/s;if(!(P<0||P>=r.outWidth||Math.floor(P)!==P)){var M=h*f*d-1-y.get(_,R,N,P,w)===A*f*d+O*d+D?1:0;0!==M&&(T+=b.get(_,R,N,P,w)*M)}}}}g.set(T,_,x,C,k,w)}return g.toTensor()},t.prototype.cast=function(t,e){return LY(t,e,this)},t.prototype.reshape=function(t,e){return BY(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(SG([o,e,n,u])),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=0,p=h[0]/f[0],v=h[1]/f[1],m=0;m<o;m++)for(var g=0;g<e;g++)for(var y=p*g,b=Math.floor(y),_=y-b,w=Math.min(a-1,Math.ceil(y)),x=m*t.strides[0]+b*t.strides[1],C=m*t.strides[0]+w*t.strides[1],k=0;k<n;k++)for(var E=v*k,S=Math.floor(E),I=E-S,T=Math.min(s-1,Math.ceil(E)),A=x+S*t.strides[2],R=C+S*t.strides[2],O=x+ +T*t.strides[2],N=C+T*t.strides[2],D=0;D<u;D++){var P=c[A+D],M=c[R+D],F=P+(c[O+D]-P)*I;l[d++]=F+(M+(c[N+D]-M)*I-F)*_}return e$(l,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=[n&&c>1?o-1:o,n&&l>1?a-1:a],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=f[0]/d[0],v=f[1]/d[1],m=this.readSync(t.dataId),g=0,y=0;y<i;y++)for(var b=y*e.strides[0],_=0;_<c;_++)for(var w=_*p,x=Math.floor(w),C=Math.min(Math.ceil(w),o-1),k=b+x*e.strides[1],E=b+C*e.strides[1],S=w-x,I=1-S,T=0;T<l;T++)for(var A=T*v,R=Math.floor(A),O=Math.min(Math.ceil(A),a-1),N=A-R,D=1-N,P=k+R*e.strides[2],M=k+O*e.strides[2],F=E+R*e.strides[2],L=E+O*e.strides[2],B=I*D,j=I*N,V=S*D,U=S*N,z=0;z<s;z++){var W=m[g++];h[P+z]+=W*B,h[M+z]+=W*j,h[F+z]+=W*V,h[L+z]+=W*U}return s$(h,[i,a,o,s],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(o*e*n*u),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/f[0],p=h[1]/f[1],v=0,m=0;m<o;m++)for(var g=m*t.strides[0],y=0;y<e;y++)for(var b=d*y,_=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*t.strides[1],w=0;w<n;w++)for(var x=p*w,C=_+Math.min(s-1,r?Math.round(x):Math.floor(x))*t.strides[2],k=0;k<u;k++)l[v++]=c[C+k];return e$(l,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=this.readSync(t.dataId),d=[n&&c>1?o-1:o,n&&l>1?a-1:a],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,_=2*Math.ceil(y)+2,w=0;w<i;w++)for(var x=w*e.strides[0],C=0;C<o;C++)for(var k=x+C*e.strides[1],E=Math.floor(C*g),S=Math.floor(E-b/2),I=0;I<a;I++)for(var T=k+I*e.strides[2],A=Math.floor(I*y),R=Math.floor(A-_/2),O=0;O<s;O++){for(var N=0,D=0;D<b;D++){var P=D+S;if(!(P<0||P>=c)){var M=x+P*t.strides[1],F=P*v;if(C===Math.min(o-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<_;L++){var B=L+R;if(!(B<0||B>=l)){var j=M+B*t.strides[2],V=B*m;I===Math.min(a-1,n?Math.round(V):Math.floor(V))&&(N+=f[j+O])}}}}h[T+O]=N}return s$(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(a.length),f=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,b=0,_=0;_<a.length;++_)h[_]=l[m++]+(a[_]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),m>=f&&(m=0),g>=v&&(g=0),y>=d&&(y=0),b>=p&&(b=0);return s$(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],a=o-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,a),u=0;r<=i;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var f=l(h),d=s[h]*Math.pow(n+r*f,-i);c[h]=d}return s$(c,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){this.assertNotComplex(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),f=t.size,d=0;d<f;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);for(g=o*g+i,y=v;y<m;y++){var b=-2*o*a*c[y]*l[d]/g;d===y&&(b+=Math.pow(g,-a)),h[y]+=b*=u[d]}}return s$(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:bY(t),o=i.shape[0],a=i.shape[1],s=c$([o,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(i.dataId),l=0;l<o;++l){var h=l*a,f=new Float32Array(a-1);f[0]=c[h];for(var d=1;d<f.length;++d)f[d]=f[d-1]+c[h+d];for(var p=T$(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),a=0;a<t.size;++a)o[a]>=0&&o[a]<e&&(i[a*e+o[a]]=n);return o$(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),qY(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=N$(t.shape,"float32"),o=N$(t.shape,"float32"),a=ZX(t).as2D(n,r),s=t$(t).as2D(n,r),u=0;u<n;u++)for(var c=a.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=JX(c,l),f=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var p=UY(f,d);i.values[u*r+d]=p.real,o.values[u*r+d]=p.imag}return JX(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=JX(ZX(i).div(r$(r)),t$(i).div(r$(r)))),i}var o=this.readSync(t.dataId),a=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return JX(a.real,a.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),a=JX(o.real,o.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=JX(s.real,s.imag).as1D();a=this.fftRadix2(a,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),l=JX(c.real,c.imag).mul(u),h=a.add(l),f=a.sub(l),d=ZX(h).concat(ZX(f)),p=t$(h).concat(t$(f));return JX(d,p).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,a=0,s=0;s<e;s++){var u=WY(i*s,e,n),c=UY(t,s);o+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(o/=e,a/=e),zY(r,o,a,i)}return r},t.prototype.depthToSpace=function(t,e,n){xG("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),xG(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],a=t.shape[3],s=i*e,u=o*e,c=a/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*s*u*c),f=0,d=0;d<r;++d)for(var p=0;p<s;++p)for(var v=Math.floor(p/e),m=p%e,g=0;g<u;++g)for(var y=Math.floor(g/e),b=(m*e+g%e)*c,_=0;_<c;++_)h[f++]=l[_+b+a*(y+o*(v+i*d))];return s$(h,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=kY(t.shape,e.shape),o=N$(i,n),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=xY(t.shape,i),c=xY(e.shape,i),l=o.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(a[h%a.length],s[h%s.length]);else{var f=this.bufferSync(t),d=this.bufferSync(e),p=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=f.locToIndex(h),v=i.slice(-e.rank);c.forEach((function(t){return v[t]=0}));var m=d.locToIndex(v);l[n]=r(a[p],s[m])};for(h=0;h<l.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=kY(t.shape,e.shape),i=N$(r,"float32"),o=N$(r,"float32"),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=xY(t.shape,r),c=xY(e.shape,r),l=i.values,h=o.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var d=f%a.length,p=f%s.length,v=n(a[2*d],a[2*d+1],s[2*p],s[2*p+1]);l[f]=v.real,h[f]=v.imag}else{var m=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),f=o.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var d=m.locToIndex(f),p=o.slice(-e.rank);c.forEach((function(t){return p[t]=0}));var v=g.locToIndex(p),y=n(a[2*d],a[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,h[r]=y.imag};for(f=0;f<l.length;f++)y(f)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return GY(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var a=t.shape,s=a[0],u=a[1],c=a[2],l=a[3],h=e.shape[0],f=r[0],d=r[1],p=N$([h,f,d,l],t.dtype),v=this.readSync(e.dataId),m=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,b=p.strides,_=0;_<h;_++){var w=4*_,x=v[w],C=v[w+1],k=v[w+2],E=v[w+3],S=m[_];if(!(S>=s))for(var I=f>1?(k-x)*(u-1)/(f-1):0,T=d>1?(E-C)*(c-1)/(d-1):0,A=0;A<f;A++){var R=f>1?x*(u-1)+A*I:.5*(x+k)*(u-1);if(R<0||R>u-1)for(var O=0;O<d;O++)for(var N=0;N<l;N++){var D=N+O*b[2]+A*b[1]+_*b[0];p.values[D]=o}else if("bilinear"===i){var P=Math.floor(R),M=Math.ceil(R),F=R-P;for(O=0;O<d;O++)if((H=d>1?C*(c-1)+O*T:.5*(C+E)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=o;else{var L=Math.floor(H),B=Math.ceil(H),j=H-L;for(N=0;N<l;N++){var V=g[D=N+L*y[2]+P*y[1]+S*y[0]],U=g[D=N+B*y[2]+P*y[1]+S*y[0]],z=g[D=N+L*y[2]+M*y[1]+S*y[0]],W=V+(U-V)*j,q=z+(g[D=N+B*y[2]+M*y[1]+S*y[0]]-z)*j;p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=W+(q-W)*F}}}else for(O=0;O<d;++O){var H;if((H=d>1?C*(c-1)+O*T:.5*(C+E)*(c-1))<0||H>c-1)for(N=0;N<l;N++)p.values[D=N+O*b[2]+A*b[1]+_*b[0]]=o;else{var G=Math.round(H),K=Math.round(R);for(N=0;N<l;N++)p.values[N+O*b[2]+A*b[1]+_*b[0]]=g[N+G*y[2]+K*y[1]+S*y[0]]}}}}return p.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=hY(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=cY(t,e),o=i[0],a=i[1],s=i[2],u=i[3];if(0===a)return e$([],o,t.dtype);for(var c=new lK([a,s],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),f=0;f<a;f++){for(var d=[],p=0,v=0;v<r;v++){var m=l[f*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=t.size/s)throw new Error("Invalid indices: "+d+" does not index into "+t.shape);for(var g=0;g<s;g++)c.values[f*s+g]=h[p*s+g]}return c.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=hY(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=r$(0);return this.scatter(t,e,n,u,a,o,i,s,c,!0)},t.prototype.fill=function(t,e,n){var r=LG(n=n||KG(e),SG(t));return r.fill(e),pK.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=LG(t.dtype,SG(t.shape));return pK.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return jY(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,a,s,u,c){var l=[r/i,i],h=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return e$([],n,e.dtype);var d=new lK(l,e.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var v=[],m=0,g=0;g<a;g++){var y=h[p*a+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/i)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<i;b++)c?d.values[m*i+b]+=f[p*i+b]:d.values[m*i+b]=0===e.rank?f[0]:f[p*i+b]}return d.toTensor().reshape(n)},t}();RK.registerBackend("cpu",(function(){return new L2}),1);var B2=function(){function t(){this.textEncoder=new TextEncoder}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();mG.get("IS_BROWSER")&&mG.setPlatform("browser",new B2);var j2,V2=function(){function t(){this.util=n(6),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=mG.global.fetch?mG.global.fetch(t,e):(null==j2&&(j2=n(5)),j2(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();mG.get("IS_NODE")&&mG.setPlatform("node",new V2);var U2={float32:4,int32:4,uint16:2,uint8:1,bool:1};function z2(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,a=e.shape,s=SG(a),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=U2[c.dtype],h=t.slice(r,r+s*l),f="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(f,(function(t){return t*c.scale+c.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(f,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===o){var d=SG(e.shape);u=[];for(var p=0;p<d;p++){var v=new Uint32Array(t.slice(r,r+4))[0];r+=4;var m=new Uint8Array(t.slice(r,r+v));u.push(m),r+=v}}else{var g=U2[o];if(h=t.slice(r,r+s*g),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=s*g}n[i]=e$(u,a,o)},o=0,a=e;o<a.length;o++)i(a[o]);return n}function W2(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var q2="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function H2(t){return q2?Buffer.byteLength(t):new Blob([t]).size}function G2(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function K2(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function X2(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:H2(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:H2(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var $2=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),Y2=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){xG(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),xG(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();xG(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function Q2(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Y2.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}function J2(t,e,n){return void 0===n&&(n=!1),fG(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h;return dG(this,(function(f){switch(f.label){case 0:return xG(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),xG((r=$2.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),xG(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],xG((o=$2.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),xG(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),a=o[0],s=Q2(t).scheme,u=Q2(t).path,c=s===Q2(t).scheme,[4,i.load()];case 1:return l=f.sent(),n&&c?[4,Y2.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return h=f.sent(),!n||c?[3,6]:[4,Y2.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}function Z2(){if(!mG.getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function t3(t){var e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}var e3=function(){function t(t){if(this.indexedDB=Z2(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return t3(i)},i.onsuccess=function(){var o=i.result;if(null==e){var a=o.transaction("models_store","readonly"),s=a.objectStore("models_store").get(n.modelPath);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return o.close(),r(s.error)},a.oncomplete=function(){return o.close()}}else{var u,c=X2(e),l=o.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var i=(u=o.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore("model_info_store")).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},f.onerror=function(t){return o.close(),r(f.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),n3=function(t){return mG.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(e3.URL_SCHEME)?(e=t.slice(e3.URL_SCHEME.length),new e3(e)):null;var e};$2.registerSaveRouter(n3),$2.registerLoadRouter(n3);var r3=function(){function t(){this.indexedDB=Z2()}return t.prototype.listModels=function(){return fG(this,void 0,void 0,(function(){var t=this;return dG(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return t3(r)},r.onsuccess=function(){var t=r.result,i=t.transaction("model_info_store","readonly"),o=i.objectStore("model_info_store").getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return fG(this,void 0,void 0,(function(){var e=this;return dG(this,(function(n){var r;return t=(r=t).startsWith(e3.URL_SCHEME)?r.slice(e3.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return t3(i)},i.onsuccess=function(){var e,o=i.result,a=o.transaction("model_info_store","readwrite"),s=a.objectStore("model_info_store"),u=s.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),a=function(){var i=(e=o.transaction("models_store","readwrite")).objectStore("models_store").delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=a,i.onerror=function(t){return a(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},a.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(mG.getBool("IS_BROWSER"))try{Y2.registerManager(e3.URL_SCHEME,new r3)}catch(oF){}var i3="tensorflowjs_models",o3="info",a3="model_topology",s3="weight_specs",u3="weight_data",c3="model_metadata";function l3(t){return{info:[i3,t,o3].join("/"),topology:[i3,t,a3].join("/"),weightSpecs:[i3,t,s3].join("/"),weightData:[i3,t,u3].join("/"),modelMetadata:[i3,t,c3].join("/")}}function h3(t){var e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}var f3=function(){function t(t){if(!mG.getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=l3(this.modelPath)}return t.prototype.save=function(t){return fG(this,void 0,void 0,(function(){var e,n,r;return dG(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=X2(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,q2?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},t.prototype.load=function(){return fG(this,void 0,void 0,(function(){var t,e,n,r,i,o,a;return dG(this,(function(s){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(q2){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(a),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),d3=function(t){return mG.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(f3.URL_SCHEME)?(e=t.slice(f3.URL_SCHEME.length),new f3(e)):null;var e};$2.registerSaveRouter(d3),$2.registerLoadRouter(d3);var p3=function(){function t(){xG(mG.getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),xG(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return fG(this,void 0,void 0,(function(){var t,e,n,r,i,o;return dG(this,(function(a){for(t={},e=i3+"/",n="/"+o3,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=h3(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return fG(this,void 0,void 0,(function(){var e,n;return dG(this,(function(r){var i;if(t=(i=t).startsWith(f3.URL_SCHEME)?i.slice(f3.URL_SCHEME.length):i,e=l3(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(mG.getBool("IS_BROWSER"))try{Y2.registerManager(f3.URL_SCHEME,new p3)}catch(oF){}function v3(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var m3=function(){function t(e){if(!mG.getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return fG(this,void 0,void 0,(function(){var e,n,r,i;return dG(this,(function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,v3((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,v3((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:X2(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),g3=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return fG(this,void 0,void 0,(function(){var t,e,n=this;return dG(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var a=JSON.parse(o.target.result),s=a.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),f.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);f[i]=n,-1===f.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:G2(f)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return K2(t.name)})),i={},o=0,a=t;o<a.length;o++)a[o].paths.forEach((function(t){var o=K2(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function y3(t,e,n,r){!function(t){xG(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){xG(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),xG(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),xG(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var a=n+ ++i/t.length*(r-n);return e(a),o})),o})))}function b3(t,e){return fG(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return dG(this,(function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?mG.platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=h.sent(),[3,4];case 2:return[4,y3(r,e.onProgress,i,o)];case 3:a=h.sent(),h.label=4;case 4:return s=a.map((function(t){return t.arrayBuffer()})),u=.5,c=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=h.sent(),[3,8];case 6:return[4,y3(s,e.onProgress,u,c)];case 7:l=h.sent(),h.label=8;case 8:return[2,l]}}))}))}function _3(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),fG(e,void 0,void 0,(function(){var e,o,a,s,u,c,l,h,f,d;return dG(this,(function(p){switch(p.label){case 0:if(e=n.map((function(){return!1})),o={},a=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u=U2["quantization"in t?t.quantization.dtype:t.dtype]*SG(t.shape),c=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach((function(e,n){e===t.name&&(c(),a[n]=!0)})):c(),s.push(t.name),r+=u}))})),!a.every((function(t){return t})))throw u=i.filter((function(t,e){return!a[e]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),l=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;l.push(e)}))})),[4,t(l)];case 1:return h=p.sent(),f={},d=0,c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[d+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,c=0;c<e;c++){var l=new Uint8Array(h[d+c]);s.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=z2(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)f[n]=e[n]})),d+=e})),[2,f]}}))}))}}$2.registerSaveRouter((function(t){return mG.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(m3.URL_SCHEME)?(void 0===(e=t.slice(m3.URL_SCHEME.length))&&(e="model"),new m3(e)):null;var e}));var w3=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(xG("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=mG.platform.fetch,xG(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&xG(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return fG(this,void 0,void 0,(function(){var e,n;return dG(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:X2(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return fG(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s;return dG(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:s=u.sent(),o=s[0],a=s[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:a}]}}))}))},t.prototype.loadWeights=function(t){return fG(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l;return dG(this,(function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,a=[],s=0,u=t;s<u.length;s++)a.push.apply(a,u[s].weights);return c=[],t.forEach((function(t){t.paths.forEach((function(t){c.push(o+t+i)}))})),[4,b3(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return l=h.sent(),[2,[a,G2(l)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function x3(t){return null!=t.match(w3.URL_SCHEME_REGEX)}var C3=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return x3(t)})):x3(t))?k3(t,{onProgress:e}):null};function k3(t,e){return new w3(t,e)}$2.registerSaveRouter(C3),$2.registerLoadRouter(C3);var E3=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),S3=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),I3=Object.freeze({browserFiles:function(t){return new g3(t)},browserHTTPRequest:function(t,e){return k3(t,e)},concatenateArrayBuffers:G2,decodeWeights:z2,encodeWeights:function(t,e){return fG(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return dG(this,(function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),o=function(o){var a=i[o],u=Array.isArray(t)?t[o].tensor:t[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+u.dtype);var c={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(t){return fG(s,void 0,void 0,(function(){var e,n,r,i,o,a,s;return dG(this,(function(c){switch(c.label){case 0:return[4,u.bytes()];case 1:for(e=c.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),i=0,o=0;o<e.length;o++)a=e[o],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,i),r.set(a,i+=4),i+=a.length;return t(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=e&&(c.group=e),n.push(c)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:W2(u.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new E3(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return $2.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:X2,getSaveHandlers:function(t){return $2.getSaveHandlers(t)},http:k3,isHTTPScheme:x3,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),fG(this,void 0,void 0,(function(){return dG(this,(function(i){return[2,_3((function(t){return b3(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return $2.registerLoadRouter(t)},registerSaveRouter:function(t){return $2.registerSaveRouter(t)},weightsLoaderFactory:_3,withSaveHandler:function(t){return new S3(t)},copyModel:function(t,e){return fG(this,void 0,void 0,(function(){return dG(this,(function(n){return[2,J2(t,e,!1)]}))}))},listModels:function(){return fG(this,void 0,void 0,(function(){var t,e,n,r,i,o,a;return dG(this,(function(s){switch(s.label){case 0:t=Y2.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?[4,Y2.getManager(i=r[n]).listModels()]:[3,4];case 2:for(a in o=s.sent())e[i+"://"+a]=o[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return fG(this,void 0,void 0,(function(){return dG(this,(function(n){return[2,J2(t,e,!0)]}))}))},removeModel:function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){return e=Q2(t),[2,Y2.getManager(e.scheme).removeModel(e.path)]}))}))}}),T3=QX({confusionMatrix_:function(t,e,n){var r=jX(t,"labels","confusionMatrix"),i=jX(e,"predictions","confusionMatrix");xG(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),xG(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),xG(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),xG(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),xG(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=U$(r.asType("int32"),n),a=U$(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}}),A3=(Object.freeze({confusionMatrix:T3}),QX({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&n&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return RK.fromPixels(t,e)}})),R3=Object.freeze({toPixels:function(t,e){return fG(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w,x;return dG(this,(function(C){switch(C.label){case 0:if(n=jX(t,"img","toPixels"),t instanceof pK||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),h=l[0][0],f=l[1][0],u.dispose(),c.dispose(),"float32"===n.dtype){if(h<0||f>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+f+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||f>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+f+"].")}for(d="float32"===n.dtype?255:1,p=new Uint8ClampedArray(o*i*4),v=0;v<i*o;++v)m=void 0,g=void 0,y=void 0,b=void 0,1===a?(m=s[v]*d,g=s[v]*d,y=s[v]*d,b=255):3===a?(m=s[3*v]*d,g=s[3*v+1]*d,y=s[3*v+2]*d,b=255):4===a&&(m=s[4*v]*d,g=s[4*v+1]*d,y=s[4*v+2]*d,b=s[4*v+3]*d),p[0+(_=4*v)]=Math.round(m),p[_+1]=Math.round(g),p[_+2]=Math.round(y),p[_+3]=Math.round(b);return null!=e&&(e.width=o,e.height=i,w=e.getContext("2d"),x=new ImageData(p,o,i),w.putImageData(x,0,0)),n!==t&&n.dispose(),[2,p]}}))}))},fromPixels:A3}),O3=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),N3=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function D3(t){xG(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),xG("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),xG(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),N3.register(t)}function P3(){return 32===RK.backend.floatPrecision()?.001:.1}function M3(t,e,n){var r=!0;if((UG(t)||UG(e))&&(r=!1),UG(t)&&UG(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var a=LX(t),s=LX(e);if(!IG(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=UG(t)?t:EG(t),c=UG(e)?e:EG(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],f=c[l];if(!n(h,f))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+f+".\nActual:   "+u+".\nExpected: "+c+".")}}function F3(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({Serializable:O3,SerializationMap:N3,registerClass:D3}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=P3()),M3(t,e,(function(t,e){return F3(t,e,n)}))},testEpsilon:P3,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return qG(t)||qG(t[0])||qG(e)||qG(e[0])?M3(t,n,(function(t,e){return t==e})):M3(t,e,(function(t,e){return F3(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=P3()),!F3(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Object.freeze({gpgpu_util:pJ,webgl_util:NX,forceHalfFloat:function(){mG.set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:aZ,setWebGLContext:FK,GPGPUContext:vJ});var L3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return hG(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var a=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(a)}else this.applyGradients(o);return MX(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){xG(XG(t),(function(){return"The f passed in variableGrads(f) must be a function"})),xG(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof _K})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],RK.registeredVariables)e.push(RK.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;xG((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var a=RK.gradients(t,e,null,!0),s=a.value,u=a.grads;xG(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),xG(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&MX(this.iterations_)},e.prototype.saveIterations=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:r$(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(O3);Object.defineProperty(L3,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var B3=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=RK.backend.epsilon()),i}return hG(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=RK.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:PX((function(){return d$(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:PX((function(){return d$(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;PX((function(){var t=a.mul(e.rho).add(o.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(a.add(e.epsilon).sqrt()).mul(o),r=s.mul(e.rho).add(n.square().mul(1-e.rho));a.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(MX(this.accumulatedGrads.map((function(t){return t.variable}))),MX(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(L3);D3(B3);var j3=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return hG(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=RK.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:PX((function(){return l$(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable;PX((function(){var t=a.add(o.square());a.assign(t);var n=o.div(t.add(RK.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&MX(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(L3);D3(j3);var V3=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],PX((function(){o.accBeta1=r$(n).variable(),o.accBeta2=r$(r).variable()})),null==i&&(o.epsilon=RK.backend.epsilon()),o}return hG(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);PX((function(){var r=I0(1,e.accBeta1),i=I0(1,e.accBeta2);n.forEach((function(n,o){var a=RK.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:PX((function(){return d$(a).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:PX((function(){return d$(a).variable(!1)}))});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedSecondMoment[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=l.div(r),d=h.div(i);u.assign(l),c.assign(h);var p=f.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(a);a.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&MX(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&MX(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){var e,n=this;return dG(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),PX((function(){n.accBeta1.assign(C0(n.beta1,n.iterations_+1)),n.accBeta2.assign(C0(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(L3);D3(V3);var U3=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],PX((function(){a.iteration=r$(0).variable(),a.accBeta1=r$(n).variable()})),null==i&&(a.epsilon=RK.backend.epsilon()),a}return hG(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);PX((function(){var r=I0(1,e.accBeta1),i=f0(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var a=RK.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:d$(a).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:d$(a).variable(!1)});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedWeightedInfNorm[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2),f=s.abs(),d=h.maximum(f);u.assign(l),c.assign(d);var p=i.div(r).mul(l.div(d.add(e.epsilon))).add(a);a.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&MX(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&MX(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(L3);D3(U3);var z3=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return hG(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=RK.registeredVariables[n];PX((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function(t){return RK.keep(t)}(r$(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(L3);D3(z3);var W3=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=r$(i.momentum),i}return hG(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=RK.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:PX((function(){return d$(i).variable(!1)}))});var o=e.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[n];null!=a&&PX((function(){var t,n=e.m.mul(o).add(a);t=e.useNesterov?e.c.mul(a.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&MX(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){return dG(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){return dG(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(z3);D3(W3);var q3=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var a=t.call(this)||this;return a.learningRate=e,a.decay=n,a.momentum=r,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,null==i&&(a.epsilon=RK.backend.epsilon()),a}return hG(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=RK.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:PX((function(){return d$(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:PX((function(){return d$(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:PX((function(){return d$(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;PX((function(){var t=a.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),c=s.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));a.assign(t),n.assign(u),s.assign(c);var l=i.sub(c);i.assign(l)}else{var h=a.mul(e.decay).add(o.square().mul(1-e.decay));c=s.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),a.assign(h),s.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&MX(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&MX(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&MX(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return fG(this,void 0,void 0,(function(){var t;return dG(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return fG(this,void 0,void 0,(function(){var e;return dG(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(L3);D3(q3),function(){function t(){}t.sgd=function(t){return new z3(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new W3(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new q3(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new V3(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new B3(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new U3(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new j3(t,e)}}(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate,fK=M2;var H3=function(){function t(t,e){if(!e4(t)||!e4(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}(),G3=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}();function K3(t,e){return t instanceof pK&&t.shape.length===e}function X3(t){return K3(t,3)}function $3(t){return K3(t,4)}function Y3(t){return t%2==0}function Q3(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function J3(t){return t&&t.width&&t.height}function Z3(t){return t.reduce((function(t,e){return t.add(e)}),new G3(0,0)).div(new G3(t.length,t.length))}function t4(t,e,n){return Array(t).fill(0).map((function(t,r){return e+r*n}))}function e4(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}var n4,r4=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(e4),o=[r.x,r.y,r.width,r.height].every(e4);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];t.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(e4)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new G3(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new G3(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new G3(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new G3(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.round(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.floor(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.toSquare=function(){var e=this.x,n=this.y,r=this.width,i=this.height,o=Math.abs(r-i);return r<i&&(e-=o/2,r+=o),i<r&&(n-=o/2,i+=o),new t({x:e,y:n,width:r,height:i})},t.prototype.rescale=function(e){var n=J3(e)?e.width:e,r=J3(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(e,n){var r=this.y,i=this.right,o=this.bottom,a=Math.max(this.x,0),s=Math.max(r,0),u=o-s;return new t({x:a,y:s,width:Math.min(i-a,e-a),height:Math.min(u,n-s)}).floor()},t.prototype.shift=function(e,n){return new t({x:this.x+e,y:this.y+n,width:this.width,height:this.height})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,i=n,o=r,a=this.left,s=this.top,u=this.right,c=this.bottom;return u>e&&(i=-u+e+n,u=e),c>t&&(o=-c+t+r,c=t),a<1&&(o=2-a,a=1),s<1&&(o=2-s,s=1),{dy:1,edy:o,dx:1,edx:i,y:s,ey:c,x:a,ex:u,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),i4=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{left:e,top:n,right:r,bottom:i},o)||this}return Object(EP.c)(e,t),e}(r4),o4=function(){function t(t,e,n,r,i){this._imageDims=new H3(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new r4(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new r4(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),a4=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{x:e,y:n,width:r,height:i},o)||this}return Object(EP.c)(e,t),e}(r4);function s4(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function u4(t){var e="";if(!t)try{t=n(7)}catch(r){e=r.toString()}return{readFile:t?function(e){return new Promise((function(n,r){t.readFile(e,(function(t,e){return t?r(t):n(e)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)}}}function c4(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},r=u4();return Object(EP.a)({Canvas:t||function(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){},Image:e||function(){},ImageData:global.ImageData||function(){},Video:global.HTMLVideoElement||function(){},createCanvasElement:function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:n},r)}function l4(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}function h4(){return"object"==typeof global&&void 0!==t&&"undefined"!=typeof process&&!!process.version}function f4(t){n4=t}function d4(){l4()&&f4(s4()),h4()&&f4(c4())}var p4={getEnv:function(){if(!n4)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return n4},setEnv:f4,initialize:d4,createBrowserEnv:s4,createFileSystem:u4,createNodejsEnv:c4,monkeyPatch:function(t){if(n4||d4(),!n4)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?n4.Canvas:e,r=t.Image,i=void 0===r?n4.Image:r;n4.Canvas=n,n4.Image=i,n4.createCanvasElement=t.createCanvasElement||function(){return new n},n4.createImageElement=t.createImageElement||function(){return new i},n4.ImageData=t.ImageData||n4.ImageData,n4.Video=t.Video||n4.Video,n4.fetch=t.fetch||n4.fetch,n4.readFile=t.readFile||n4.readFile},isBrowser:l4,isNodejs:h4};function v4(t){return p4.isNodejs()||"string"!=typeof t?t:document.getElementById(t)}function m4(t){var e=p4.getEnv(),n=e.Canvas;if(t instanceof e.CanvasRenderingContext2D)return t;var r=v4(t);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=r.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}d4();var g4=function(t){return t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT",t}({}),y4=function(t){void 0===t&&(t={});var e=t.backgroundColor,n=t.fontColor,r=t.fontSize,i=t.fontStyle,o=t.padding;this.anchorPosition=t.anchorPosition||g4.TOP_LEFT,this.backgroundColor=e||"rgba(0, 0, 0, 0.5)",this.fontColor=n||"rgba(255, 255, 255, 1)",this.fontSize=r||14,this.fontStyle=i||"Georgia",this.padding=o||4},b4=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"==typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new y4(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map((function(e){return t.measureText(e).width})).reduce((function(t,e){return t<e?e:t}),0)+2*e},t.prototype.measureHeight=function(){var t=this.options;return this.text.length*t.fontSize+2*t.padding},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===g4.BOTTOM_RIGHT||n===g4.TOP_RIGHT,i=n===g4.BOTTOM_LEFT||n===g4.BOTTOM_RIGHT,o=this.measureWidth(t),a=this.measureHeight(),s=r?this.anchor.x-o:this.anchor.x,u=i?this.anchor.y-a:this.anchor.y;if(e){var c=e.height;return{x:Math.max(Math.min(s,e.width-o),0),y:Math.max(Math.min(u,c-a),0)}}return{x:s,y:u}},t.prototype.draw=function(t){var e=v4(t),n=m4(e),r=this.options,i=r.backgroundColor,o=r.fontColor,a=r.fontSize,s=r.padding;n.font=a+"px "+r.fontStyle;var u=this.measureWidth(n),c=this.measureHeight();n.fillStyle=i;var l=this.getUpperLeft(n,e);n.fillRect(l.x,l.y,u,c),n.fillStyle=o,this.text.forEach((function(t,e){n.fillText(t,s+l.x,s+l.y+(e+1)*a)}))},t}(),_4=function(t){void 0===t&&(t={});var e=t.lineWidth,n=t.label,r=t.drawLabelOptions;this.boxColor=t.boxColor||"rgba(0, 0, 255, 1)",this.lineWidth=e||2,this.label=n,this.drawLabelOptions=new y4(Object.assign({},{anchorPosition:g4.BOTTOM_LEFT,backgroundColor:this.boxColor},r))},w4=function(){function t(t,e){void 0===e&&(e={}),this.box=new r4(t),this.options=new _4(e)}return t.prototype.draw=function(t){var e=m4(t),n=this.options,r=n.lineWidth,i=this.box,o=i.x,a=i.y,s=i.width,u=i.height;e.strokeStyle=n.boxColor,e.lineWidth=r,e.strokeRect(o,a,s,u);var c=this.options.label;c&&new b4([c],{x:o-r/2,y:a},this.options.drawLabelOptions).draw(t)},t}();function x4(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),PX((function(){var i=u0(Y0(t,e.filters,[1,1],n),e.bias);return r?j1(i):i}))}function C4(t,e){Object.keys(t).forEach((function(n){e.some((function(t){return t.originalPath===n}))||t[n].dispose()}))}function k4(t,e){return function(n,r,i,o){var a=s$(t(n*r*i*i),[i,i,n,r]),s=i$(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:a,bias:s}}}function E4(t,e){return function(n,r,i){var o=o$(t(n*r),[n,r]),a=i$(t(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:a}}}var S4=function(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n};function I4(t,e){return function(n,r,i){var o=s$(t(9*n),[3,3,n,1]),a=s$(t(n*r),[1,1,n,r]),s=i$(t(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new S4(o,a,s)}}function T4(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),i=t(e+"/bias",1);return new S4(n,r,i)}}function A4(t,e){return function(n,r,i){var o=t[n];if(!K3(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:n,paramPath:i||n}),o}}function R4(t){var e=t;return{extractWeights:function(t){var n=e.slice(0,t);return e=e.slice(t),n},getRemainingWeights:function(){return e}}}function O4(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",i=(t=t.replace(r,"")).split("/").filter((function(t){return t})),o=t.endsWith(".json")?i[i.length-1]:n,a=r+(t.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return{modelBaseUri:a=t.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+o:a+"/"+o}}function N4(t){var e=p4.getEnv();return t instanceof e.Image&&t.complete||t instanceof e.Video&&t.readyState>=3}function D4(t){return new Promise((function(e,n){if(!(t instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if("string"!=typeof r.result)return n("bufferToImage - expected reader.result to be a string, in onload");var t=p4.getEnv().createImageElement();t.onload=function(){return e(t)},t.onerror=n,t.src=r.result},r.onerror=n,r.readAsDataURL(t)}))}function P4(t){var e=p4.getEnv(),n=e.Video;return t instanceof e.Image?new H3(t.naturalWidth,t.naturalHeight):t instanceof n?new H3(t.videoWidth,t.videoHeight):new H3(t.width,t.height)}function M4(t){var e=t.width,n=t.height,r=(0,p4.getEnv().createCanvasElement)();return r.width=e,r.height=n,r}function F4(t,e){var n=p4.getEnv().ImageData;if(!(t instanceof n||N4(t)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=e||P4(t),i=r.width,o=r.height,a=M4({width:i,height:o});return t instanceof n?m4(a).putImageData(t,0,0):m4(a).drawImage(t,0,0,i,o),a}function L4(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,(0,p4.getEnv().fetch)(t,e)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}}))}))}function B4(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return[4,L4(t)];case 1:return[2,e.sent().json()]}}))}))}function j4(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return n=e||p4.getEnv().createCanvasElement(),r=t.shape.slice($3(t)?1:0),i=r[0],o=r[1],a=r[2],s=PX((function(){return t.as3D(i,o,a).toInt()})),[4,R3.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}}))}))}function V4(t){var e=p4.getEnv();return t instanceof e.Image||t instanceof e.Canvas||t instanceof e.Video}function U4(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return n=O4(t,e),r=n.modelBaseUri,[4,B4(n.manifestUri)];case 1:return i=o.sent(),[2,I3.loadWeights(i,r)]}}))}))}var z4=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach((function(t,e){if(X3(t))return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape);if($3(t)){var r=t.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape.slice(1))}var i=t instanceof p4.getEnv().Canvas?t:F4(t);n._canvases[e]=i,n._inputDimensions[e]=[i.height,i.width,3]}))}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return t4(this.batchSize,0,1).map((function(e,n){return t.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return n=(e={width:this.getInputWidth(t),height:this.getInputHeight(t)}).width,r=e.height,i=this.inputSize/Math.max(r,n),new H3(Math.round(n*i),Math.round(r*i));var e,n,r,i},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,PX((function(){var r=t4(n.batchSize,0,1).map((function(r){var i=n.getInput(r);if(i instanceof pK){var o=$3(i)?i:i.expandDims();return(o=function(t,e){return void 0===e&&(e=!1),PX((function(){var n=t.shape.slice(1),r=n[0],i=n[1];if(r===i)return t;var o=Math.abs(r-i),a=Math.round(o*(e?.5:1)),s=r>i?2:1,u=function(e){var n=t.shape.slice();return n[s]=e,l$(n,0)},c=u(a),l=o-c.shape[s],h=[e&&l?u(l):null,t,c].filter((function(t){return!!t})).map((function(t){return t.toFloat()}));return p$(h,s)}))}(o,e)).shape[1]===t&&o.shape[2]===t||(o=O2.resizeBilinear(o,[t,t])),o.as3D(t,t,3)}if(i instanceof p4.getEnv().Canvas)return R3.fromPixels(function(t,e,n){void 0===n&&(n=!1);var r=p4.getEnv(),i=r.Canvas;if(!(t instanceof r.Image||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=P4(t),a=e/Math.max(o.height,o.width),s=a*o.width,u=a*o.height,c=M4({width:e,height:e}),l=t instanceof i?t:F4(t),h=Math.abs(s-u)/2,f=n&&s<u?h:0,d=n&&u<s?h:0;return m4(c).drawImage(l,f,d,s,u),c}(i,t,e));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+i)}));return tY(r.map((function(t){return t.toFloat()}))).as4D(n.batchSize,t,t,3)}))},t}();function W4(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:if(t instanceof z4)return[2,t];if(!(e=Array.isArray(t)?t:[t]).length)throw new Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},(r=e.map(v4)).forEach((function(t,r){if(!V4(t)&&!X3(t)&&!$3(t)){if("string"==typeof e[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if($3(t)){var i=t.shape[0];if(1!==i)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+i+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(t){return V4(t)&&(e=t,new Promise((function(t,n){if(e instanceof p4.getEnv().Canvas||N4(e))return t();function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",i),t(e))}function i(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",i),n(t))}e.addEventListener("load",r),e.addEventListener("error",i)})));var e})))];case 1:return i.sent(),[2,new z4(r,Array.isArray(t))]}}))}))}var q4=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,i=n.objProp;r[i].dispose(),r[i]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map((function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}}))},t.prototype.getTrainableParams=function(){return this.getParamList().filter((function(t){return t.tensor instanceof _K}))},t.prototype.getFrozenParams=function(){return this.getParamList().filter((function(t){return!(t.tensor instanceof _K)}))},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach((function(e){t.reassignParamFromPath(e.path,e.tensor.variable())}))},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach((function(e){var n=e.path,r=e.tensor,i=e$(r.dataSync());r.dispose(),t.reassignParamFromPath(n,i)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach((function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()})),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(t){return Array.from(t.tensor.dataSync())})).reduce((function(t,e){return t.concat(e)})))},t.prototype.load=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.loadFromUri=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromUri - expected model uri");return[4,U4(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}}))}))},t.prototype.loadFromDisk=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c;return Object(EP.d)(this,(function(l){switch(l.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromDisk - expected model file path");return e=p4.getEnv().readFile,n=O4(t,this.getDefaultModelName()),r=n.manifestUri,i=n.modelBaseUri,o=I3.weightsLoaderFactory((function(t){return Promise.all(t.map((function(t){return e(t).then((function(t){return t.buffer}))})))})),u=(s=JSON).parse,[4,e(r)];case 1:return a=u.apply(s,[l.sent().toString()]),[4,o(a,i)];case 2:return c=l.sent(),this.loadFromWeightMap(c),[2]}}))}))},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.params;this._paramMappings=e.paramMappings,this._params=n},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.params;this._paramMappings=e.paramMappings,this._params=n},t.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce((function(e,n){if(!e.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}}),{nextObj:this.params}),n=e.obj,r=e.objProp;if(!(n&&r&&n[r]instanceof pK))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function H4(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return n?r/(t.area+e.area-r):r/Math.min(t.area,e.area)}function G4(t,e,n,r){void 0===r&&(r=!0);for(var i=e.map((function(t,e){return{score:t,boxIndex:e}})).sort((function(t,e){return t.score-e.score})).map((function(t){return t.boxIndex})),o=[],a=function(){var e=i.pop();o.push(e);for(var a=i,s=[],u=0;u<a.length;u++)s.push(H4(t[e],t[a[u]],r));i=i.filter((function(t,e){return s[e]<=n}))};i.length>0;)a();return o}function K4(t,e){return PX((function(){var n=e[0],r=e[1],i=e[2],o=l$(Object(EP.g)(t.shape.slice(0,3),[1]),n),a=l$(Object(EP.g)(t.shape.slice(0,3),[1]),r),s=l$(Object(EP.g)(t.shape.slice(0,3),[1]),i),u=p$([o,a,s],3);return I0(t,u)}))}function X4(t){return 1/(1+Math.exp(-t))}var $4=function(t){return"number"==typeof t};function Y4(t){if(!t)throw new Error("invalid config: "+t);if("boolean"!=typeof t.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!$4(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every((function(t){return"string"==typeof t})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map((function(t){return t||{}})).every((function(t){return $4(t.x)&&$4(t.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every($4)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function Q4(t){return PX((function(){var e=w0(t,r$(.10000000149011612));return u0(j1(I0(t,e)),e)}))}function J4(t,e){return PX((function(){var n=z$(t,[[0,0],[1,1],[1,1],[0,0]]);return n=Y0(n,e.conv.filters,[1,1],"valid"),n=I0(n,e.bn.sub),n=w0(n,e.bn.truediv),Q4(n=u0(n,e.conv.bias))}))}function Z4(t,e){return PX((function(){var n=z$(t,[[0,0],[1,1],[1,1],[0,0]]);return n=e1(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),Q4(n=u0(n,e.bias))}))}var t5=function(t){return t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG",t}({}),e5=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),n5=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return Y4(e),n._config=e,n}return Object(EP.c)(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=J4(t,e.conv0);return n=J4(n=p1(n,[2,2],[2,2],"same"),e.conv1),n=J4(n=p1(n,[2,2],[2,2],"same"),e.conv2),n=J4(n=p1(n,[2,2],[2,2],"same"),e.conv3),n=J4(n=p1(n,[2,2],[2,2],"same"),e.conv4),n=J4(n=p1(n,[2,2],[2,2],"same"),e.conv5),n=J4(n=p1(n,[2,2],[1,1],"same"),e.conv6),x4(n=J4(n,e.conv7),e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?Q4(x4(t,e.conv0,"valid",!1)):Z4(t,e.conv0);return n=Z4(n=p1(n,[2,2],[2,2],"same"),e.conv1),n=Z4(n=p1(n,[2,2],[2,2],"same"),e.conv2),n=Z4(n=p1(n,[2,2],[2,2],"same"),e.conv3),n=Z4(n=p1(n,[2,2],[2,2],"same"),e.conv4),n=Z4(n=p1(n,[2,2],[2,2],"same"),e.conv5),n=p1(n,[2,2],[1,1],"same"),n=e.conv6?Z4(n,e.conv6):n,x4(n=e.conv7?Z4(n,e.conv7):n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return PX((function(){var i=t.toBatchTensor(e,!1).toFloat();return i=(i=n.config.meanRgb?K4(i,n.config.meanRgb):i).div(r$(256)),n.config.withSeparableConvs?n.runMobilenet(i,r):n.runTinyYolov2(i,r)}))},e.prototype.forward=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,W4(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}}))}))},e.prototype.detect=function(t,e){return void 0===e&&(e={}),Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p=this;return Object(EP.d)(this,(function(v){switch(v.label){case 0:return n=new e5(e),r=n.inputSize,i=n.scoreThreshold,[4,W4(t)];case 1:return o=v.sent(),[4,this.forwardInput(o,r)];case 2:return a=v.sent(),s=PX((function(){return rY(a)[0].expandDims()})),u={width:o.getInputWidth(0),height:o.getInputHeight(0)},[4,this.extractBoxes(s,o.getReshapedInputDimensions(0),i)];case 3:return c=v.sent(),a.dispose(),s.dispose(),l=c.map((function(t){return t.box})),h=c.map((function(t){return t.score})),f=c.map((function(t){return t.classScore})),d=c.map((function(t){return p.config.classes[t.label]})),[2,G4(l.map((function(t){return t.rescale(r)})),h,this.config.iouThreshold,!0).map((function(t){return new o4(h[t],f[t],d[t],l[t],u)}))]}}))}))},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r=[],i=function(t,e){var n=A4(t,e);function r(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(t){return{conv:r(t+"/conv"),bn:function(t){return{sub:n(t+"/sub",1),truediv:n(t+"/truediv",1)}}(t+"/bn")}},extractSeparableConvParams:T4(n)}}(t,r),o=i.extractConvParams,a=i.extractConvWithBatchNormParams,s=i.extractSeparableConvParams;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?o("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:o("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:o("conv8")};return C4(t,r),{params:n,paramMappings:r}}(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(t,e,n,r){var i,o=R4(t),a=o.getRemainingWeights,s=[],u=function(t,e){var n=k4(t,e),r=I4(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,i,o){return{conv:n(r,i,3,o+"/conv"),bn:function(n,r){var i=i$(t(n)),o=i$(t(n));return e.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:i,truediv:o}}(i,o+"/bn")}},extractSeparableConvParams:r}}(o.extractWeights,s),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,h=u.extractSeparableConvParams;if(e.withSeparableConvs){var f=r[0],d=r[1],p=r[2],v=r[3],m=r[4],g=r[5],y=r[6],b=r[7],_=r[8];i={conv0:e.isFirstLayerConv2d?c(f,d,3,"conv0"):h(f,d,"conv0"),conv1:h(d,p,"conv1"),conv2:h(p,v,"conv2"),conv3:h(v,m,"conv3"),conv4:h(m,g,"conv4"),conv5:h(g,y,"conv5"),conv6:b?h(y,b,"conv6"):void 0,conv7:_?h(b,_,"conv7"):void 0,conv8:c(_||b||y,5*n,1,"conv8")}}else p=r[2],v=r[3],m=r[4],g=r[5],y=r[6],b=r[7],_=r[8],i={conv0:l(f=r[0],d=r[1],"conv0"),conv1:l(d,p,"conv1"),conv2:l(p,v,"conv2"),conv3:l(v,m,"conv3"),conv4:l(m,g,"conv4"),conv5:l(g,y,"conv5"),conv6:l(y,b,"conv6"),conv7:l(b,_,"conv7"),conv8:c(_,5*n,1,"conv8")};if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:i,paramMappings:s}}(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w,x,C,k,E,S,I,T,A,R,O,N=this;return Object(EP.d)(this,(function(D){switch(D.label){case 0:return r=e.width,i=e.height,o=Math.max(r,i),a=o/r,s=o/i,u=t.shape[1],c=this.config.anchors.length,l=PX((function(){var e=t.reshape([u,u,c,N.boxEncodingSize]);return[e.slice([0,0,0,0],[u,u,c,4]),e.slice([0,0,0,4],[u,u,c,1]),N.withClassScores?bY(e.slice([0,0,0,5],[u,u,c,N.config.classes.length]),3):r$(0)]})),h=l[0],d=l[2],p=[],[4,(f=l[1]).array()];case 1:return v=D.sent(),[4,h.array()];case 2:m=D.sent(),g=0,D.label=3;case 3:if(!(g<u))return[3,12];y=0,D.label=4;case 4:if(!(y<u))return[3,11];b=0,D.label=5;case 5:return b<c?(_=X4(v[g][y][b][0]),!n||_>n?(w=(y+X4(m[g][y][b][0]))/u*a,x=(g+X4(m[g][y][b][1]))/u*s,C=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/u*a,k=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/u*s,E=w-C/2,S=x-k/2,I={row:g,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(d,I)]:[3,7]):[3,9]):[3,10];case 6:return O=D.sent(),[3,8];case 7:O={classScore:1,label:0},D.label=8;case 8:A=(T=O).classScore,R=T.label,p.push(Object(EP.a)({box:new i4(E,S,E+C,S+k),score:_,classScore:_*A,label:R},I)),D.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return g++,[3,3];case 12:return h.dispose(),f.dispose(),d.dispose(),[2,p]}}))}))},e.prototype.extractPredictedClass=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return n=e.row,r=e.col,i=e.anchor,[4,t.array()];case 1:return o=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(t,e){return o[n][r][i][e]})).map((function(t,e){return{classScore:t,label:e}})).reduce((function(t,e){return t.classScore>e.classScore?t:e}))]}}))}))},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(q4);function r5(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach((function(n,r){var i=n.x,o=n.y,a=e[r];t.moveTo(a.x,a.y),t.lineTo(i,o)})),n){var r=e[e.length-1],i=e[0];if(!r||!i)return;t.moveTo(r.x,r.y),t.lineTo(i.x,i.y)}t.stroke()}var i5=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return EP.c(e,t),e.prototype.forSize=function(n,r){var i=t.prototype.forSize.call(this,n,r);return new e(i.score,i.relativeBox,i.imageDims)},e}(o4);function o5(t){return t.detection instanceof i5}function a5(t,e){return Object.assign({},t,{detection:e})}function s5(t,e){(Array.isArray(e)?e:[e]).forEach((function(e){var n=e instanceof i5?e.score:o5(e)?e.detection.score:void 0,i=e instanceof i5?e.box:o5(e)?e.detection.box:new r4(e),o=n?""+Q3(n):void 0;new r.DrawBox(i,{label:o}).draw(t)}))}function u5(t,e,n){return dL((function(){var r=Vz(t,e.depthwise_filter,e.pointwise_filter,n,"same");return RW(r,e.bias)}))}function c5(t,e,n){return void 0===n&&(n=!1),dL((function(){var r=oq(n?RW(Fz(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):u5(t,e.conv0,[2,2])),i=u5(r,e.conv1,[1,1]),o=u5(oq(RW(r,i)),e.conv2,[1,1]);return oq(RW(r,RW(i,o)))}))}function l5(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),dL((function(){var i=oq(n?RW(Fz(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):u5(t,e.conv0,r?[2,2]:[1,1])),o=u5(i,e.conv1,[1,1]),a=u5(oq(RW(i,o)),e.conv2,[1,1]),s=u5(oq(RW(i,RW(o,a))),e.conv3,[1,1]);return oq(RW(i,RW(o,RW(a,s))))}))}function h5(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractSeparableConvParamsFactory(t,e);function o(t,e,i,o){return void 0===o&&(o=!1),{conv0:o?n(t,e,3,i+"/conv0"):r(t,e,i+"/conv0"),conv1:r(e,e,i+"/conv1"),conv2:r(e,e,i+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(t,e,n,i){void 0===i&&(i=!1);var a=o(t,e,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(e,e,n+"/conv3")}}}}function f5(t){return function(e){return{filters:t(e+"/filters",4),bias:t(e+"/bias",1)}}}function d5(t,e){var n=i.extractWeightEntryFactory(t,e),r=f5(n),o=i.loadSeparableConvParamsFactory(n);return{extractDenseBlock3Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2")}},extractDenseBlock4Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2"),conv3:o(t+"/conv3")}}}}var p5=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceFeatureExtractor - load model before inference");return dL((function(){var n=l5(K4(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(FL(255)),e.dense0,!0);return n=l5(n,e.dense1),n=l5(n,e.dense2),n=l5(n,e.dense3),Zz(n,[7,7],[2,2],"valid")}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=d5(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=h5(n.extractWeights,e).extractDenseBlock4Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2"),c=o(128,256,"dense3");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}(t)},e}(q4);function v5(t,e){return dL((function(){return RW(zz(t,e.weights),e.bias)}))}function m5(t){var e={},n={};return Object.keys(t).forEach((function(r){(r.startsWith("fc")?n:e)[r]=t[r]})),{featureExtractorMap:e,classifierMap:n}}var g5=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return EP.c(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return dL((function(){var r=t instanceof z4?e.faceFeatureExtractor.forwardInput(t):t;return v5(r.as2D(r.shape[0],-1),n.fc)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.paramMappings;this._params=e.params,this._paramMappings=n},e.prototype.extractClassifierParams=function(t){return function(t,e,n){var r=[],o=i.extractWeightsFactory(t),a=o.getRemainingWeights,s=i.extractFCParamsFactory(o.extractWeights,r)(e,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e=m5(t),n=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(e.featureExtractorMap),function(t){var e=[],n=i.extractWeightEntryFactory(t,e),r={fc:{weights:n("fc/weights",2),bias:n("fc/bias",1)}};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(n)},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e}(q4),y5=["neutral","happy","sad","angry","fearful","disgusted","surprised"],b5=function(){function t(t){var e=this;if(7!==t.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);y5.forEach((function(n,r){e[n]=t[r]}))}return t.prototype.asSortedArray=function(){var t=this;return y5.map((function(e){return{expression:e,probability:t[e]}})).sort((function(t,e){return e.probability-t.probability}))},t}(),_5=function(t){function e(e){return void 0===e&&(e=new p5),t.call(this,"FaceExpressionNet",e)||this}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this;return dL((function(){return $B(e.runNet(t))}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictExpressions=function(t){return EP.b(this,void 0,void 0,(function(){var e,n,r,i,o=this;return EP.d(this,(function(a){switch(a.label){case 0:return[4,W4(t)];case 1:return e=a.sent(),[4,this.forwardInput(e)];case 2:return n=a.sent(),[4,Promise.all(PB(n).map((function(t){return EP.b(o,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}}))}))})))];case 3:return r=a.sent(),n.dispose(),i=r.map((function(t){return new b5(t)})),[2,e.isBatchInput?i:i[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(g5);function w5(t,e,n,i){void 0===n&&(n=.1),(Array.isArray(e)?e:[e]).forEach((function(e){var o=e instanceof b5?e:e.expressions instanceof b5?e.expressions:void 0;if(!o)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var a=o.asSortedArray().filter((function(t){return t.probability>n})),s=o5(e)?e.detection.box.bottomLeft:i||new G3(0,0);new r.DrawTextField(a.map((function(t){return t.expression+" ("+Q3(t.probability)+")"})),s).draw(t)}))}var x5=function(){function t(t,e,n){void 0===n&&(n=new G3(0,0));var r=e.width,i=e.height;this._imgDims=new H3(r,i),this._shift=n,this._positions=t.map((function(t){return t.mul(new G3(r,i)).add(n)}))}return Object.defineProperty(t.prototype,"shift",{get:function(){return new G3(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map((function(e){return e.sub(t._shift).div(new G3(t.imageWidth,t.imageHeight))}))},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new G3(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof i5?t.box.floor():new r4(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=r.minBoxPadding;return r.useDlibAlignment?this.alignDlib():this.alignMinBbox(i)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[1],n=t[2],r=function(t){return n.sub(t).magnitude()},i=(r(t[0])+r(e))/2,o=Math.floor(i/.45),a=Z3(t),s=Math.floor(Math.max(0,a.x-.5*o)),u=Math.floor(Math.max(0,a.y-.43*o));return new a4(s,u,Math.min(o,this.imageWidth+s),Math.min(o,this.imageHeight+u))},t.prototype.alignMinBbox=function(t){var e,n,r,i,o,a,s,u=(n=(e=this.positions).map((function(t){return t.x})),r=e.map((function(t){return t.y})),i=n.reduce((function(t,e){return e<t?e:t}),1/0),o=r.reduce((function(t,e){return e<t?e:t}),1/0),a=n.reduce((function(t,e){return t<e?e:t}),0),s=r.reduce((function(t,e){return t<e?e:t}),0),new i4(i,o,a,s));return u.pad(u.width*t,u.height*t)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),C5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Z3)},e}(x5);function k5(t){return o5(t)&&t.landmarks instanceof x5&&t.unshiftedLandmarks instanceof x5&&t.alignedRect instanceof i5}function E5(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),i=r.align(),o=t.detection.imageDims,a=new i5(t.detection.score,i.rescale(o.reverse()),o);return Object.assign({},t,{landmarks:r,unshiftedLandmarks:e,alignedRect:a})}var S5=function(t){void 0===t&&(t={});var e=t.drawLines,n=t.drawPoints,r=void 0===n||n,i=t.lineWidth,o=t.lineColor,a=t.pointSize,s=t.pointColor;this.drawLines=void 0===e||e,this.drawPoints=r,this.lineWidth=i||1,this.pointSize=a||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"},I5=function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new S5(e)}return t.prototype.draw=function(t){var e=m4(t),n=this.options,r=n.drawPoints,i=n.lineWidth,o=n.pointSize,a=n.pointColor;n.drawLines&&this.faceLandmarks instanceof C5&&(e.strokeStyle=n.lineColor,e.lineWidth=i,r5(e,this.faceLandmarks.getJawOutline()),r5(e,this.faceLandmarks.getLeftEyeBrow()),r5(e,this.faceLandmarks.getRightEyeBrow()),r5(e,this.faceLandmarks.getNose()),r5(e,this.faceLandmarks.getLeftEye(),!0),r5(e,this.faceLandmarks.getRightEye(),!0),r5(e,this.faceLandmarks.getMouth(),!0)),r&&(e.strokeStyle=a,e.fillStyle=a,this.faceLandmarks.positions.forEach((function(t){e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI),e.fill()})))},t}();function T5(t,e){(Array.isArray(e)?e:[e]).forEach((function(e){var n=e instanceof x5?e:k5(e)?e.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new I5(n).draw(t)}))}function A5(t,e,n){return RW(Fz(t,e.filters,n,"same"),e.bias)}function R5(t,e,n){void 0===n&&(n=!0);var r=n?oq(t):t;return r=u5(r,e.separable_conv0,[1,1]),r=u5(oq(r),e.separable_conv1,[1,1]),r=Jz(r,[3,3],[2,2],"same"),RW(r,A5(t,e.expansion_conv,[2,2]))}var O5=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return dL((function(){var r=K4(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(FL(256)),i=oq(A5(r,n.entry_flow.conv_in,[2,2]));return i=R5(i,n.entry_flow.reduction_block_0,!1),i=R5(i,n.entry_flow.reduction_block_1),t4(e._numMainBlocks,0,1).forEach((function(t){i=function(t,e){var n=u5(oq(t),e.separable_conv0,[1,1]);return n=u5(oq(n),e.separable_conv1,[1,1]),n=u5(oq(n),e.separable_conv2,[1,1]),RW(n,t)}(i,n.middle_flow["main_block_"+t])})),i=R5(i,n.exit_flow.reduction_block),i=oq(u5(i,n.exit_flow.separable_conv,[1,1]))}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n=[],r=function(t,e){var n=i.extractWeightEntryFactory(t,e),r=f5(n),o=i.loadSeparableConvParamsFactory(n);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),expansion_conv:r(t+"/expansion_conv")}},extractMainBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),separable_conv2:o(t+"/separable_conv2")}}}}(t,n),o=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u={conv_in:(0,r.extractConvParams)("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},c={};t4(e,0,1).forEach((function(t){c["main_block_"+t]=s("middle_flow/main_block_"+t)}));var l={reduction_block:a("exit_flow/reduction_block"),separable_conv:o("exit_flow/separable_conv")};return i.disposeUnusedWeightTensors(t,n),{params:{entry_flow:u,middle_flow:c,exit_flow:l},paramMappings:n}}(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return function(t,e){var n=[],r=i.extractWeightsFactory(t),o=r.getRemainingWeights,a=function(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractSeparableConvParamsFactory(t,e);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(t,e,i){return{separable_conv0:r(t,e,i+"/separable_conv0"),separable_conv1:r(e,e,i+"/separable_conv1"),expansion_conv:n(t,e,1,i+"/expansion_conv")}},extractMainBlockParams:function(t,e){return{separable_conv0:r(t,t,e+"/separable_conv0"),separable_conv1:r(t,t,e+"/separable_conv1"),separable_conv2:r(t,t,e+"/separable_conv2")}}}}(r.extractWeights,n),s=a.extractSeparableConvParams,u=a.extractReductionBlockParams,c=a.extractMainBlockParams,l={conv_in:(0,a.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:u(32,64,"entry_flow/reduction_block_0"),reduction_block_1:u(64,128,"entry_flow/reduction_block_1")},h={};t4(e,0,1).forEach((function(t){h["main_block_"+t]=c(128,"middle_flow/main_block_"+t)}));var f={reduction_block:u(128,256,"exit_flow/reduction_block"),separable_conv:s(256,512,"exit_flow/separable_conv")};if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:l,middle_flow:h,exit_flow:f}}}(t,this._numMainBlocks)},e}(q4),N5=function(t){return t.FEMALE="female",t.MALE="male",t}({}),D5=function(t){function e(e){void 0===e&&(e=new O5(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return EP.c(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return dL((function(){var r=t instanceof z4?e.faceFeatureExtractor.forwardInput(t):t,i=Zz(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:v5(i,n.fc.age).as1D(),gender:v5(i,n.fc.gender)}}))},e.prototype.forwardInput=function(t){var e=this;return dL((function(){var n=e.runNet(t);return{age:n.age,gender:$B(n.gender)}}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictAgeAndGender=function(t){return EP.b(this,void 0,void 0,(function(){var e,n,r,i,o,a,s=this;return EP.d(this,(function(u){switch(u.label){case 0:return[4,W4(t)];case 1:return e=u.sent(),[4,this.forwardInput(e)];case 2:return n=u.sent(),r=PB(n.age),i=PB(n.gender),o=r.map((function(t,e){return{ageTensor:t,genderTensor:i[e]}})),[4,Promise.all(o.map((function(t){var e=t.ageTensor,n=t.genderTensor;return EP.b(s,void 0,void 0,(function(){var t,r,i,o,a;return EP.d(this,(function(s){switch(s.label){case 0:return[4,e.data()];case 1:return t=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],o=(i=r>.5)?N5.MALE:N5.FEMALE,a=i?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:o,genderProbability:a}]}}))}))})))];case 3:return a=u.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?a:a[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.paramMappings;this._params=e.params,this._paramMappings=n},e.prototype.extractClassifierParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=i.extractFCParamsFactory(n.extractWeights,e),a=o(512,1,"fc/age"),s=o(512,2,"fc/gender");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=m5(t),n=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(e.featureExtractorMap),function(t){var e=[],n=i.extractWeightEntryFactory(t,e);function r(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return i.disposeUnusedWeightTensors(t,e),{params:o,paramMappings:e}}(n)},e.prototype.extractParams=function(t){var e=t.slice(0,t.length-1539),n=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(e),this.extractClassifierParams(n)},e}(q4),P5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],Z3([t[3],t[4]])]},e}(x5);function M5(t,e){return EP.b(this,void 0,void 0,(function(){var n,r,i,o,a,s;return EP.d(this,(function(u){switch(u.label){case 0:return n=p4.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,W4(t)];case 1:if((i=u.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(o=i.getInput(0))instanceof n?(a=o,[3,4]):[3,2];case 2:return[4,j4(o)];case 3:a=u.sent(),u.label=4;case 4:r=a,u.label=5;case 5:return s=m4(r),[2,e.map((function(t){return t instanceof i5?t.forSize(r.width,r.height).box.floor():t})).map((function(t){return t.clipAtImageBorders(r.width,r.height)})).map((function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=M4({width:r,height:i});return m4(o).putImageData(s.getImageData(e,n,r,i),0,0),o}))]}}))}))}function F5(t,e){return EP.b(this,void 0,void 0,(function(){return EP.d(this,(function(n){if(!X3(t)&&!$3(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if($3(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,dL((function(){var n=t.shape.slice($3(t)?1:0),r=n[0],i=n[1],o=n[2];return e.map((function(t){return t instanceof i5?t.forSize(i,r).box:t})).map((function(t){return t.clipAtImageBorders(i,r)})).map((function(e){var n=e.x,a=e.y,s=e.width,u=e.height;return iW(t.as3D(r,i,o),[a,n,0],[u,s,o])}))}))]}))}))}var L5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map((function(t){var n=t.width,r=t.height,i=e/Math.max(r,n);return{width:n*i,height:r*i}})),i=r.length;return dL((function(){var n=function(t,e){return OB([WL([68],t),WL([68],e)],1).as2D(1,136).as1D()},o=function(t,e){var n=r[t],i=n.width,o=n.height;return e(i,o)?Math.abs(i-o)/2:0};return t.mul(WL([i,136],e)).sub(OB(Array.from(Array(i),(function(t,e){return n(function(t){return o(t,(function(t,e){return t<e}))}(e),function(t){return o(t,(function(t,e){return e<t}))}(e))})))).div(OB(Array.from(Array(i),(function(t,e){return n(r[e].width,r[e].height)}))))}))},e.prototype.forwardInput=function(t){var e=this;return dL((function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map((function(t){return{height:t[0],width:t[1]}})))}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.detectLandmarks=function(t){return EP.b(this,void 0,void 0,(function(){var e,n,r,i=this;return EP.d(this,(function(o){switch(o.label){case 0:return[4,W4(t)];case 1:return e=o.sent(),n=dL((function(){return PB(i.forwardInput(e))})),[4,Promise.all(n.map((function(t,n){return EP.b(i,void 0,void 0,(function(){var r,i,o,a,s;return EP.d(this,(function(u){switch(u.label){case 0:return o=(i=Array).from,[4,t.data()];case 1:return r=o.apply(i,[u.sent()]),a=r.filter((function(t,e){return Y3(e)})),s=r.filter((function(t,e){return!Y3(e)})),[2,new C5(Array(68).fill(0).map((function(t,e){return new G3(a[e],s[e])})),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}}))}))})))];case 2:return r=o.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getClassifierChannelsOut=function(){return 136},e}(g5),B5=function(t){function e(e){return void 0===e&&(e=new p5),t.call(this,"FaceLandmark68Net",e)||this}return EP.c(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(L5),j5=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("TinyFaceFeatureExtractor - load model before inference");return dL((function(){var n=c5(K4(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(FL(255)),e.dense0,!0);return n=c5(n,e.dense1),n=c5(n,e.dense2),Zz(n,[14,14],[2,2],"valid")}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=d5(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return i.disposeUnusedWeightTensors(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.getRemainingWeights,o=h5(n.extractWeights,e).extractDenseBlock3Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2");if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}(t)},e}(q4),V5=function(t){function e(e){return void 0===e&&(e=new j5),t.call(this,"FaceLandmark68TinyNet",e)||this}return EP.c(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(L5);function U5(t,e,n,r,i){void 0===i&&(i="same");var o=e.conv,a=o.bias,s=Fz(t,o.filters,n,i);return s=function(t,e){return RW(WW(t,e.weights),e.biases)}(s=RW(s,a),e.scale),r?oq(s):s}function z5(t,e){return U5(t,e,[1,1],!1)}function W5(t,e){return U5(t,e,[2,2],!0,"valid")}function q5(t,e){var n=function(t,e){return U5(t,e,[1,1],!0)}(t,e.conv1);return n=z5(n,e.conv2),n=RW(n,t),oq(n)}function H5(t,e){var n=W5(t,e.conv1);n=z5(n,e.conv2);var r=Zz(t,2,2,"valid"),i=zL(r.shape),o=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=n.shape.slice();a[1]=1;var s=zL(a),u=(n=KL([n,s],1)).shape.slice();u[2]=1;var c=zL(u);n=KL([n,c],2)}return r=o?KL([r,i],3):r,n=RW(r,n),oq(n)}var G5=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceRecognitionNet - load model before inference");return dL((function(){var n=W5(K4(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(FL(256)),e.conv32_down);n=q5(n=Jz(n,3,2,"valid"),e.conv32_1),n=q5(n,e.conv32_2),n=q5(n,e.conv32_3),n=q5(n=H5(n,e.conv64_down),e.conv64_1),n=q5(n,e.conv64_2),n=q5(n,e.conv64_3),n=q5(n=H5(n,e.conv128_down),e.conv128_1),n=q5(n,e.conv128_2),n=q5(n=H5(n,e.conv256_down),e.conv256_1);var r=(n=H5(n=q5(n,e.conv256_2),e.conv256_down_out)).mean([1,2]);return zz(r,e.fc)}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.computeFaceDescriptor=function(t){return EP.b(this,void 0,void 0,(function(){var e,n,r,i=this;return EP.d(this,(function(o){switch(o.label){case 0:return[4,W4(t)];case 1:return e=o.sent(),n=dL((function(){return PB(i.forwardInput(e))})),[4,Promise.all(n.map((function(t){return t.data()})))];case 2:return r=o.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t){return{conv:{filters:n(t+"/conv/filters",4),bias:n(t+"/conv/bias",1)},scale:function(t){return{weights:n(t+"/scale/weights",1),biases:n(t+"/scale/biases",1)}}(t)}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t){return{conv1:r(t+"/conv1"),conv2:r(t+"/conv2")}}}}(t,e),r=n.extractResidualLayerParams,o=(0,n.extractConvLayerParams)("conv32_down"),a=r("conv32_1"),s=r("conv32_2"),u=r("conv32_3"),c=r("conv64_down"),l=r("conv64_1"),h=r("conv64_2"),f=r("conv64_3"),d=r("conv128_down"),p=r("conv128_1"),v=r("conv128_2"),m=r("conv256_down"),g=r("conv256_1"),y=r("conv256_2"),b=r("conv256_down_out"),_=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!K3(_,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+_);var w={conv32_down:o,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:h,conv64_3:f,conv128_down:d,conv128_1:p,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:_};return i.disposeUnusedWeightTensors(t,e),{params:w,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=i.extractWeightsFactory(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],a=function(t,e){function n(n,r,i,o){var a=function(e,n,r){var i=t(e),o=i.length/(n*r*r);if(o%1!=0)throw new Error("depth has to be an integer: "+o+", weights.length: "+i.length+", numFilters: "+n+", filterSize: "+r);return dL((function(){return sq(VL(i,[n,o,r,r]),[2,3,1,0])}))}(n,r,i),s=LL(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:a,bias:s}}function r(r,i,o,a){return{conv:n(r,i,o,a+"/conv"),scale:function(n,r){var i=LL(t(n)),o=LL(t(n));return e.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:i,biases:o}}(i,a+"/scale")}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t,e,n,i,o){return void 0===o&&(o=!1),{conv1:r((o?.5:1)*t,e,n,i+"/conv1"),conv2:r(t,e,n,i+"/conv2")}}}}(n,o),s=a.extractResidualLayerParams,u=(0,a.extractConvLayerParams)(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),v=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),g=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),_=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),x=s(589824,256,3,"conv256_down_out"),C=dL((function(){return sq(BL(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:h,conv64_down:f,conv64_1:d,conv64_2:p,conv64_3:v,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:b,conv256_1:_,conv256_2:w,conv256_down_out:x,fc:C},paramMappings:o}}(t)},e}(q4),K5=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,i=e.maxNumScales,o=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=a,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(t){return"number"!=typeof t})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(t){return"number"!=typeof t}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function X5(t,e,n){return dL((function(){var r=Fz(t,e.filters,n,"same");return r=RW(r,e.batch_norm_offset),HU(r,0,6)}))}function $5(t,e,n){var r=t.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),f=(a-i)*(s-o),d=(l-u)*(h-c);if(f<=0||d<=0)return 0;var p=Math.max(i,u),v=Math.max(o,c),m=Math.min(a,l),g=Math.min(s,h),y=Math.max(m-p,0)*Math.max(g-v,0);return y/(f+d-y)}function Y5(t,e){return dL((function(){var n=t.shape[0];return{boxPredictionEncoding:TB(i.convLayer(t,e.box_encoding_predictor),[n,-1,1,4]),classPrediction:TB(i.convLayer(t,e.class_predictor),[n,-1,3])}}))}var Q5=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),J5=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return EP.c(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("SsdMobilenetv1 - load model before inference");return dL((function(){var n=t.toBatchTensor(512,!1).toFloat(),r=function(t,e){return dL((function(){var n=null,r=X5(t,e.conv_0,[2,2]);if([e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13].forEach((function(t,e){var i=e+1,o=function(t){return[2,4,6,12].some((function(e){return e===t}))?[2,2]:[1,1]}(i);r=X5(r=function(t,e,n){return dL((function(){var r=jz(t,e.filters,n,"same");return r=Tz(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,.0010000000474974513),HU(r,0,6)}))}(r,t.depthwise_conv,o),t.pointwise_conv,[1,1]),11===i&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}($W(WW(n,FL(.007843137718737125)),FL(1)),e.mobilenetv1),i=function(t,e,n){return dL((function(){var r=X5(t,n.conv_0,[1,1]),i=X5(r,n.conv_1,[2,2]),o=X5(i,n.conv_2,[1,1]),a=X5(o,n.conv_3,[2,2]),s=X5(a,n.conv_4,[1,1]),u=X5(s,n.conv_5,[2,2]),c=X5(u,n.conv_6,[1,1]),l=X5(c,n.conv_7,[2,2]),h=Y5(e,n.box_predictor_0),f=Y5(t,n.box_predictor_1),d=Y5(i,n.box_predictor_2),p=Y5(a,n.box_predictor_3),v=Y5(u,n.box_predictor_4),m=Y5(l,n.box_predictor_5);return{boxPredictions:KL([h.boxPredictionEncoding,f.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding],1),classPredictions:KL([h.classPrediction,f.classPrediction,d.classPrediction,p.classPrediction,v.classPrediction,m.classPrediction],1)}}))}(r.out,r.conv11,e.prediction_layer);return function(t,e,n){return dL((function(){var r=t.shape[0],i=function(t,e){var n=function(t){var e=PB(sq(t,[1,0])),n=[$W(e[2],e[0]),$W(e[3],e[1])];return{sizes:n,centers:[RW(e[0],PW(n[0],FL(2))),RW(e[1],PW(n[1],FL(2)))]}}(t),r=n.sizes,i=n.centers,o=PB(sq(e,[1,0])),a=PW(WW($U(PW(o[2],FL(5))),r[0]),FL(2)),s=RW(WW(PW(o[0],FL(10)),r[0]),i[0]),u=PW(WW($U(PW(o[3],FL(5))),r[1]),FL(2)),c=RW(WW(PW(o[1],FL(10)),r[1]),i[1]);return sq(OB([$W(s,a),$W(c,u),RW(s,a),RW(c,u)]),[1,0])}(TB(NB(n.extra_dim,[r,1,1]),[-1,4]),TB(t,[-1,4]));i=TB(i,[r,i.shape[0]/r,4]);var o=oz(eW(e,[0,0,1],[-1,-1,-1])),a=eW(o,[0,0,0],[-1,-1,1]);return a=TB(a,[r,a.shape[1]]),{boxes:PB(i),scores:PB(a)}}))}(i.boxPredictions,i.classPredictions,e.output_layer)}))},e.prototype.forward=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,W4(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),EP.b(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w;return EP.d(this,(function(x){switch(x.label){case 0:return n=new Q5(e),r=n.maxResults,i=n.minConfidence,[4,W4(t)];case 1:for(o=x.sent(),a=this.forwardInput(o),c=(s=a.boxes)[0],l=(u=a.scores)[0],h=1;h<s.length;h++)s[h].dispose(),u[h].dispose();return p=(d=Array).from,[4,l.data()];case 2:return f=p.apply(d,[x.sent()]),v=function(t,e,n,r,i){var o=Math.min(n,t.shape[0]),a=e.map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),s=[];return a.forEach((function(e){if(!(s.length>=o)){for(var n=e.score,r=s.length-1;r>=0;--r){var a=$5(t,e.boxIndex,s[r]);if(0!==a&&(e.score*=a<=.5?1:0,e.score<=i))break}n===e.score&&s.push(e.boxIndex)}})),s}(c,f,r,0,i),m=o.getReshapedInputDimensions(0),y=(g=o.inputSize)/m.width,b=g/m.height,_=c.arraySync(),w=v.map((function(t){var e=[Math.max(0,_[t][0]),Math.min(1,_[t][2])].map((function(t){return t*b})),n=e[0],r=e[1],i=[Math.max(0,_[t][1]),Math.min(1,_[t][3])].map((function(t){return t*y})),a=i[0];return new i5(f[t],new a4(a,n,i[1]-a,r-n),{height:o.getInputHeight(0),width:o.getInputWidth(0)})})),c.dispose(),l.dispose(),[2,w]}}))}))},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t,e,r){return{filters:n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(t){var e="mobilenetv1/conv_"+t,i="MobilenetV1/Conv2d_"+t+"_depthwise",o=e+"/depthwise_conv",a=e+"/pointwise_conv";return{depthwise_conv:{filters:n(i+"/depthwise_weights",4,o+"/filters"),batch_norm_scale:n(i+"/BatchNorm/gamma",1,o+"/batch_norm_scale"),batch_norm_offset:n(i+"/BatchNorm/beta",1,o+"/batch_norm_offset"),batch_norm_mean:n(i+"/BatchNorm/moving_mean",1,o+"/batch_norm_mean"),batch_norm_variance:n(i+"/BatchNorm/moving_variance",1,o+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",t,a)}}function a(t,e){return{filters:n(t+"/weights",4,e+"/filters"),bias:n(t+"/biases",1,e+"/bias")}}function s(t){return{box_encoding_predictor:a("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),class_predictor:a("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}}}(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,a=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!X3(a))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+a);var s={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:a}};return i.disposeUnusedWeightTensors(t,e),{params:s,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=i.extractWeightsFactory(t),r=n.extractWeights,o=n.getRemainingWeights,a=function(t,e){function n(n,r,i,o,a){var s=VL(t(n*r*i*i),[i,i,n,r]),u=LL(t(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:u}}function r(t,e,r,i){var o=n(t,e,r,i,!0);return{filters:o.filters,batch_norm_offset:o.bias}}function i(n,i,o){return{depthwise_conv:function(n,r){var i=VL(t(9*n),[3,3,n,1]),o=LL(t(n)),a=LL(t(n)),s=LL(t(n)),u=LL(t(n));return e.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:i,batch_norm_scale:o,batch_norm_offset:a,batch_norm_mean:s,batch_norm_variance:u}}(n,o+"/depthwise_conv"),pointwise_conv:r(n,i,1,o+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,e),s=a.extractPredictionLayerParams,u=(0,a.extractMobilenetV1Params)(),c=s(),l={extra_dim:jL(r(20472),[1,5118,4])};if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:l},paramMappings:e}}(t)},e}(q4),Z5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return EP.c(e,t),e}(i.TinyYolov2Options),t6=function(){function t(){}return t.prototype.then=function(t){return EP.b(this,void 0,void 0,(function(){var e;return EP.d(this,(function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}}))}))},t.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){return EP.d(this,(function(t){throw new Error("ComposableTask - run is not implemented")}))}))},t}();function e6(t,e,n,r,i){return void 0===i&&(i=function(t){return t.alignedRect}),EP.b(this,void 0,void 0,(function(){var o,a,s,u,c;return EP.d(this,(function(l){switch(l.label){case 0:return o=t.map((function(t){return k5(t)?i(t):t.detection})),(s=r)?[3,5]:e instanceof ZM?[4,F5(e,o)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,M5(e,o)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return[4,n(a=s)];case 6:return c=l.sent(),a.forEach((function(t){return t instanceof ZM&&t.dispose()})),[2,c]}}))}))}function n6(t,e){var n=e[1];return{height:Math.floor(e[0]*t),width:Math.floor(n*t)}}var r6=function(t){function e(e,n,r,i){return t.call(this,{left:e,top:n,right:r,bottom:i},!0)||this}return EP.c(e,t),e}(r4);function i6(t){return dL((function(){return WW($W(t,FL(127.5)),FL(.0078125))}))}function o6(t,e){return dL((function(){return RW(oq(t),WW(e,ez(oq(ez(t)))))}))}function a6(t,e,n){return void 0===n&&(n=!1),dL((function(){var r=i.convLayer(t,e.conv1,"valid");return r=o6(r,e.prelu1_alpha),r=Jz(r,n?[2,2]:[3,3],[2,2],"same"),r=o6(r=i.convLayer(r,e.conv2,"valid"),e.prelu2_alpha),r=n?r:Jz(r,[3,3],[2,2],"valid"),o6(r=i.convLayer(r,e.conv3,"valid"),e.prelu3_alpha)}))}function s6(t,e,n,r,o){o.stage1=[];var a=e.map((function(e){return dL((function(){var n={scale:e},o=function(t,e){return dL((function(){var n=n6(e,t.shape.slice(1)),r=i6(Zq.resizeBilinear(t,[n.height,n.width]));return sq(r,[0,2,1,3])}))}(t,e),a=Date.now(),s=function(t,e){return dL((function(){var n=a6(t,e,!0),r=i.convLayer(n,e.conv4_1,"valid"),o=mB(fW(r,3),3);return{prob:$B($W(r,o),3),regions:i.convLayer(n,e.conv4_2,"valid")}}))}(o,r),u=s.prob,c=s.regions;return n.pnet=Date.now()-a,{scoresTensor:PB(PB(u,3)[1])[0],regionsTensor:PB(c)[0],scale:e,statsForScale:n}}))})).map((function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.statsForScale,a=function(t,e,n,r){for(var i=[],o=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)o[a][s]>=r&&i.push(new G3(s,a));return i.map((function(t){var r=new i4(Math.round((2*t.y+1)/n),Math.round((2*t.x+1)/n),Math.round((2*t.y+12)/n),Math.round((2*t.x+12)/n)),i=o[t.y][t.x],a=e.arraySync();return{cell:r,score:i,region:new r6(a[t.y][t.x][0],a[t.y][t.x][1],a[t.y][t.x][2],a[t.y][t.x][3])}}))}(e,r,t.scale,n);if(e.dispose(),r.dispose(),!a.length)return o.stage1.push(i),[];var s=Date.now(),u=G4(a.map((function(t){return t.cell})),a.map((function(t){return t.score})),.5);return i.nms=Date.now()-s,i.numBoxes=u.length,o.stage1.push(i),u.map((function(t){return a[t]}))})).reduce((function(t,e){return t.concat(e)}),[]),s=[],u=[];if(a.length>0){var c=Date.now(),l=G4(a.map((function(t){return t.cell})),a.map((function(t){return t.score})),.7);o.stage1_nms=Date.now()-c,u=l.map((function(t){return a[t].score})),s=l.map((function(t){return a[t]})).map((function(t){var e=t.cell,n=t.region;return new i4(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()}))}return{boxes:s,scores:u}}function u6(t,e,n){var r=n.width,i=n.height;return EP.b(this,void 0,void 0,(function(){var n,o,a,s=this;return EP.d(this,(function(u){switch(u.label){case 0:return n=m4(t),[4,Promise.all(e.map((function(e){return EP.b(s,void 0,void 0,(function(){var r,i,o,a;return EP.d(this,(function(s){return r=e.padAtBorders(t.height,t.width),a=n.getImageData(i=r.x-1,o=r.y-1,r.ex-i,r.ey-o),[2,p4.isNodejs()?F4(a):createImageBitmap(a)]}))}))})))];case 1:return o=u.sent(),a=[],o.forEach((function(t){var e=m4(M4({width:r,height:i}));e.drawImage(t,0,0,r,i);for(var n=e.getImageData(0,0,r,i).data,o=[],s=0;s<n.length;s+=4)o.push(n[s+2]),o.push(n[s+1]),o.push(n[s]);a.push(o)})),[2,a.map((function(t){return dL((function(){return i6(sq(VL(t,[1,r,i,3]),[0,2,1,3]).toFloat())}))}))]}}))}))}function c6(t,e,n,r,i){return EP.b(this,void 0,void 0,(function(){var o,a,s,u,c,l,h,f,d,p,v,m,g,y;return EP.d(this,(function(b){switch(b.label){case 0:return o=Date.now(),[4,u6(t,e,{width:24,height:24})];case 1:return a=b.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),s=a.map((function(t){var e=function(t,e){return dL((function(){var n=a6(t,e),r=o6(v5(TB(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu4_alpha),i=v5(r,e.fc2_1),o=mB(fW(i,1),1),a=$B($W(i,o),1),s=v5(r,e.fc2_2);return{scores:PB(a,1)[1],regions:s}}))}(t,r);return t.dispose(),e})),i.stage2_rnet=Date.now()-o,u=s.length>1?KL(s.map((function(t){return t.scores}))):s[0].scores,h=(l=Array).from,[4,u.data()];case 2:return c=h.apply(l,[b.sent()]),u.dispose(),f=c.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),d=f.map((function(t){return e[t]})),p=f.map((function(t){return c[t]})),v=[],m=[],d.length>0&&(o=Date.now(),g=G4(d,p,.7),i.stage2_nms=Date.now()-o,y=g.map((function(t){var e=s[f[t]].regions.arraySync();return new r6(e[0][0],e[0][1],e[0][2],e[0][3])})),m=g.map((function(t){return p[t]})),v=g.map((function(t,e){return d[t].calibrate(y[e])}))),s.forEach((function(t){t.regions.dispose(),t.scores.dispose()})),[2,{boxes:v,scores:m}]}}))}))}function l6(t,e,n,r,o){return EP.b(this,void 0,void 0,(function(){var a,s,u,c,l,h,f,d,p,v,m,g,y,b,_;return EP.d(this,(function(w){switch(w.label){case 0:return a=Date.now(),[4,u6(t,e,{width:48,height:48})];case 1:return s=w.sent(),o.stage3_extractImagePatches=Date.now()-a,a=Date.now(),u=s.map((function(t){var e=function(t,e){return dL((function(){var n=a6(t,e);n=Jz(n,[2,2],[2,2],"same"),n=o6(n=i.convLayer(n,e.conv4,"valid"),e.prelu4_alpha);var r=o6(v5(TB(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu5_alpha),o=v5(r,e.fc2_1),a=mB(fW(o,1),1),s=$B($W(o,a),1),u=v5(r,e.fc2_2),c=v5(r,e.fc2_3);return{scores:PB(s,1)[1],regions:u,points:c}}))}(t,r);return t.dispose(),e})),o.stage3_onet=Date.now()-a,c=u.length>1?KL(u.map((function(t){return t.scores}))):u[0].scores,f=(h=Array).from,[4,c.data()];case 2:return l=f.apply(h,[w.sent()]),c.dispose(),d=l.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),p=d.map((function(t){var e=u[t].regions.arraySync();return new r6(e[0][0],e[0][1],e[0][2],e[0][3])})),v=d.map((function(t,n){return e[t].calibrate(p[n])})),m=d.map((function(t){return l[t]})),g=[],y=[],b=[],v.length>0&&(a=Date.now(),_=G4(v,m,.7,!1),o.stage3_nms=Date.now()-a,g=_.map((function(t){return v[t]})),y=_.map((function(t){return m[t]})),b=_.map((function(t,e){return Array(5).fill(0).map((function(n,r){var i=u[t].points.arraySync();return new G3(i[0][r]*(g[e].width+1)+g[e].left,i[0][r+5]*(g[e].height+1)+g[e].top)}))}))),u.forEach((function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()})),[2,{boxes:g,scores:y,points:b}]}}))}))}var h6=function(t){function e(){return t.call(this,"Mtcnn")||this}return EP.c(e,t),e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),EP.b(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w;return EP.d(this,(function(x){switch(x.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=t.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return i={},o=Date.now(),a=dL((function(){return t=mB($H.fromPixels(r)).toFloat(),dL((function(){return OB(PB(t,3).reverse(),3)}));var t})),s=function(t){return a.dispose(),i.total=Date.now()-o,t},u=a.shape.slice(1),c=u[0],l=u[1],h=new K5(e),f=h.minFaceSize,d=h.scaleFactor,p=h.maxNumScales,v=h.scoreThresholds,m=(h.scaleSteps||function(t,e,n){for(var r=12/t,i=[],o=Math.min(n[0],n[1])*r,a=0;o>=12;)i.push(r*Math.pow(e,a)),o*=e,a+=1;return i}(f,d,[c,l])).filter((function(t){var e=n6(t,[c,l]);return Math.min(e.width,e.height)>12})).slice(0,p),i.scales=m,i.pyramid=m.map((function(t){return n6(t,[c,l])})),g=Date.now(),[4,s6(a,m,v[0],n.pnet,i)];case 1:return y=x.sent(),i.total_stage1=Date.now()-g,y.boxes.length?(i.stage2_numInputBoxes=y.boxes.length,g=Date.now(),[4,c6(r,y.boxes,v[1],n.rnet,i)]):[2,s({results:[],stats:i})];case 2:return b=x.sent(),i.total_stage2=Date.now()-g,b.boxes.length?(i.stage3_numInputBoxes=b.boxes.length,g=Date.now(),[4,l6(r,b.boxes,v[2],n.onet,i)]):[2,s({results:[],stats:i})];case 3:return _=x.sent(),i.total_stage3=Date.now()-g,w=_.boxes.map((function(t,e){return E5(a5({},new i5(_.scores[e],new a4(t.left/l,t.top/c,t.width/l,t.height/c),{height:c,width:l})),new P5(_.points[e].map((function(e){return e.sub(new G3(t.left,t.top)).div(new G3(t.width,t.height))})),{width:t.width,height:t.height}))})),[2,s({results:w,stats:i})]}}))}))},e.prototype.forward=function(t,e){return void 0===e&&(e={}),EP.b(this,void 0,void 0,(function(){var n;return EP.d(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,W4(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}}))}))},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),EP.b(this,void 0,void 0,(function(){var n;return EP.d(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,W4(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}}))}))},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=i.extractWeightEntryFactory(t,e);function r(t){return{filters:n(t+"/weights",4,t+"/filters"),bias:n(t+"/bias",1)}}function o(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}function a(t){return n(t,1)}function s(t){return{conv1:r(t+"/conv1"),prelu1_alpha:a(t+"/prelu1_alpha"),conv2:r(t+"/conv2"),prelu2_alpha:a(t+"/prelu2_alpha"),conv3:r(t+"/conv3"),prelu3_alpha:a(t+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=s("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return EP.a({},t,{conv4_1:e,conv4_2:n})},extractRNetParams:function(){var t=s("rnet"),e=o("rnet/fc1"),n=a("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),i=o("rnet/fc2_2");return EP.a({},t,{fc1:e,prelu4_alpha:n,fc2_1:r,fc2_2:i})},extractONetParams:function(){var t=s("onet"),e=r("onet/conv4"),n=a("onet/prelu4_alpha"),i=o("onet/fc1"),u=a("onet/prelu5_alpha"),c=o("onet/fc2_1"),l=o("onet/fc2_2"),h=o("onet/fc2_3");return EP.a({},t,{conv4:e,prelu4_alpha:n,fc1:i,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:h})}}}(t,e),r=n.extractRNetParams,o=n.extractONetParams,a=(0,n.extractPNetParams)(),s=r(),u=o();return i.disposeUnusedWeightTensors(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=i.extractWeightsFactory(t),n=e.getRemainingWeights,r=[],o=function(t,e){var n=i.extractConvParamsFactory(t,e),r=i.extractFCParamsFactory(t,e);function o(n,r){var i=LL(t(n));return e.push({paramPath:r}),i}function a(t,e,r){return void 0===r&&(r=!1),{conv1:n(t[0],t[1],3,e+"/conv1"),prelu1_alpha:o(t[1],e+"/prelu1_alpha"),conv2:n(t[1],t[2],3,e+"/conv2"),prelu2_alpha:o(t[2],e+"/prelu2_alpha"),conv3:n(t[2],t[3],r?2:3,e+"/conv3"),prelu3_alpha:o(t[3],e+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=a([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return EP.a({},t,{conv4_1:e,conv4_2:r})},extractRNetParams:function(){var t=a([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),i=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return EP.a({},t,{fc1:e,prelu4_alpha:n,fc2_1:i,fc2_2:s})},extractONetParams:function(){var t=a([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),i=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),u=o(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),l=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return EP.a({},t,{conv4:e,prelu4_alpha:i,fc1:s,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:h})}}}(e.extractWeights,r),a=o.extractRNetParams,s=o.extractONetParams,u=(0,o.extractPNetParams)(),c=a(),l=s();if(0!==n().length)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:u,rnet:c,onet:l},paramMappings:r}}(t)},e}(q4),f6=[new G3(1.603231,2.094468),new G3(6.041143,7.080126),new G3(2.882459,3.518061),new G3(4.266906,5.178857),new G3(9.041765,10.66308)],d6=[117.001,114.697,97.404],p6=function(t){function e(){return t.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:f6,meanRgb:d6,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return EP.c(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return EP.b(this,void 0,void 0,(function(){return EP.d(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new i5(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(i.TinyYolov2),v6=[new G3(.738768,.874946),new G3(2.42204,2.65704),new G3(4.30971,7.04493),new G3(10.246,4.59428),new G3(12.6868,11.8741)],m6=[new G3(1.603231,2.094468),new G3(6.041143,7.080126),new G3(2.882459,3.518061),new G3(4.266906,5.178857),new G3(9.041765,10.66308)],g6=[117.001,114.697,97.404],y6=function(t){function e(e){void 0===e&&(e=!0);var n=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:m6,meanRgb:g6}:{anchors:v6,withClassScores:!0});return t.call(this,n)||this}return EP.c(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return EP.b(this,void 0,void 0,(function(){return EP.d(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new i5(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(i.TinyYolov2),b6={ssdMobilenetv1:new J5,tinyFaceDetector:new p6,tinyYolov2:new y6,mtcnn:new h6,faceLandmark68Net:new B5,faceLandmark68TinyNet:new V5,faceRecognitionNet:new G5,faceExpressionNet:new _5,ageGenderNet:new D5},_6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){var t,e,n=this;return EP.d(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,e6(t=r.sent(),this.input,(function(t){return EP.b(n,void 0,void 0,(function(){return EP.d(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return b6.faceExpressionNet.predictExpressions(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){return Object.assign({},t,{expressions:e[n]})}))]}}))}))},e.prototype.withAgeAndGender=function(){return new x6(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return EP.c(e,t),e}(t6)),w6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.withAgeAndGender=function(){return new C6(this,this.input)},e.prototype.withFaceDescriptors=function(){return new k6(this,this.input)},e}(_6),x6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){var t,e,n=this;return EP.d(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,e6(t=r.sent(),this.input,(function(t){return EP.b(n,void 0,void 0,(function(){return EP.d(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return b6.ageGenderNet.predictAgeAndGender(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){var r=e[n],i=r.age;return function(t,e){return Object.assign({},t,{age:e})}(Object.assign({},t,{gender:r.gender,genderProbability:r.genderProbability}),i)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new _6(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return EP.c(e,t),e}(t6)),C6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.withFaceExpressions=function(){return new w6(this,this.input)},e.prototype.withFaceDescriptors=function(){return new k6(this,this.input)},e}(x6),k6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){var t;return EP.d(this,(function(e){switch(e.label){case 0:return[4,this.parentTask];case 1:return[4,e6(t=e.sent(),this.input,(function(t){return Promise.all(t.map((function(t){return b6.faceRecognitionNet.computeFaceDescriptor(t)})))}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return[2,e.sent().map((function(e,n){return function(t,e){return Object.assign({},t,{descriptor:e})}(t[n],e)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new w6(this,this.input)},e.prototype.withAgeAndGender=function(){return new C6(this,this.input)},e}(function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return EP.c(e,t),e}(t6)),E6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){var t,e,n,r,i,o=this;return EP.d(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),e=t.map((function(t){return t.detection})),this.input instanceof ZM?[4,F5(this.input,e)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,M5(this.input,e)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(t){return o.landmarkNet.detectLandmarks(t)})))];case 6:return i=a.sent(),n.forEach((function(t){return t instanceof ZM&&t.dispose()})),[2,t.map((function(t,e){return E5(t,i[e])}))]}}))}))},e.prototype.withFaceExpressions=function(){return new w6(this,this.input)},e.prototype.withAgeAndGender=function(){return new C6(this,this.input)},e.prototype.withFaceDescriptors=function(){return new k6(this,this.input)},e}(function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=r,i}return EP.c(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?b6.faceLandmark68TinyNet:b6.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(t6)),S6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return EP.c(e,t),e.prototype.run=function(){return EP.b(this,void 0,void 0,(function(){var t,e,n,r;return EP.d(this,(function(o){switch(o.label){case 0:return e=(t=this).input,(n=t.options)instanceof K5?[4,b6.mtcnn.forward(e,n)]:[3,2];case 1:return[2,o.sent().map((function(t){return t.detection}))];case 2:if(!(r=n instanceof Z5?function(t){return b6.tinyFaceDetector.locateFaces(t,n)}:n instanceof Q5?function(t){return b6.ssdMobilenetv1.locateFaces(t,n)}:n instanceof i.TinyYolov2Options?function(t){return b6.tinyYolov2.locateFaces(t,n)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}}))}))},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise((function(e){return EP.b(t,void 0,void 0,(function(){var t;return EP.d(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t.map((function(t){return a5({},t)})))]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new E6(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new _6(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new x6(this.runAndExtendWithFaceDetections(),this.input)},e}(function(t){function e(e,n){void 0===n&&(n=new Q5);var r=t.call(this)||this;return r.input=e,r.options=n,r}return EP.c(e,t),e}(t6));function I6(t,e){return void 0===e&&(e=new Q5),new S6(t,e)}function T6(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map((function(t,e){return t-r[e]})).reduce((function(t,e){return t+Math.pow(e,2)}),0))}var A6=EP.a({},r,o),R6=n("zIRd");(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function r(){this.a=null}function o(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var a=n.setTimeout;r.prototype.c=function(t){a(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new r;return e.prototype.o=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(X9){o(X9)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Pa(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=i(t),a=r.next();!a.done;a=r.next())o(a.value).Pa(e,n)}))},e.all=function(t){var n=i(t),r=n.next();return r.done?o([]):new e((function(t,e){function i(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,o(r.value).Pa(i(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var o=o||{},a=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function h(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){return"function"==l(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function p(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++m)}var v="closure_uid_"+(1e9*Math.random()>>>0),m=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:y).apply(null,arguments)}function _(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t,e,n){this.code=S+t,this.message=e||I[t]||"",this.a=n||null}function k(t){var e=t&&t.code;return e?new C(e.substring(S.length),t.message,t.serverResponse):null}x(C,Error),C.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},C.prototype.toJSON=function(){return this.w()};var E,S="auth/",I={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},T={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function A(t){for(var e in T)if(T[e].id===t)return{firebaseEndpoint:(t=T[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function R(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function O(t){if(Error.captureStackTrace)Error.captureStackTrace(this,O);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");O.call(this,n+t[r])}function D(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function P(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}E=A("__EID__")?"__EID__":void 0,x(O,Error),O.prototype.name="CustomError",x(N,O),N.prototype.name="AssertionError",P.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new P((function(){return new j}),(function(t){t.reset()}));function B(){var t=ve,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function j(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},j.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},j.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function H(t,e){return 0<=V(t,e)}function G(t,e){var n;return(n=0<=(e=V(t,e)))&&Array.prototype.splice.call(t,e,1),n}function K(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1)}))}function X(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Y,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},J=/&/g,Z=/</g,tt=/>/g,et=/"/g,nt=/'/g,rt=/\x00/g,it=/[\x00&<>"']/;function ot(t,e){return-1!=t.indexOf(e)}function at(t,e){return t<e?-1:t>e?1:0}t:{var st=a.navigator;if(st){var ut=st.userAgent;if(ut){Y=ut;break t}}Y=""}function ct(t){return ot(Y,t)}function lt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function ht(t){for(var e in t)return!1;return!0}function ft(t){var e,n={};for(e in t)n[e]=t[e];return n}var dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<dt.length;o++)n=dt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function vt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break t}}catch(s){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(d(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function mt(t,e){this.a=t===bt&&e||"",this.b=yt}function gt(t){return t instanceof mt&&t.constructor===mt&&t.b===yt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}mt.prototype.sa=!0,mt.prototype.ra=function(){return this.a},mt.prototype.toString=function(){return"Const{"+this.a+"}"};var yt={},bt={},_t=new mt(bt,"");function wt(t,e){this.a=t===It&&e||"",this.b=St}function xt(t){return t instanceof wt&&t.constructor===wt&&t.b===St?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+l(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=gt(t);if(!Et.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(kt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof mt?gt(t):encodeURIComponent(String(t))})),new wt(It,t)}wt.prototype.sa=!0,wt.prototype.ra=function(){return this.a.toString()},wt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,Et=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,St={},It={};function Tt(t,e){this.a=t===Dt&&e||"",this.b=Nt}function At(t){return t instanceof Tt&&t.constructor===Tt&&t.b===Nt?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+l(t)),"type_error:SafeUrl")}Tt.prototype.sa=!0,Tt.prototype.ra=function(){return this.a.toString()},Tt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ot(t){return t instanceof Tt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Rt.test(t)||(t="about:invalid#zClosurez"),new Tt(Dt,t))}var Nt={},Dt={};function Pt(){this.a="",this.b=Ft}function Mt(t){return t instanceof Pt&&t.constructor===Pt&&t.b===Ft?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+l(t)),"type_error:SafeHtml")}Pt.prototype.sa=!0,Pt.prototype.ra=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ft={};function Lt(t){var e=new Pt;return e.a=t,e}Lt("<!DOCTYPE html>");var Bt=Lt("");function jt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Vt(t){return it.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(J,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Z,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(tt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(et,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(nt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(rt,"&#0;"))),t}function Ut(t){return Ut[" "](t),t}Lt("<br>"),Ut[" "]=c;var zt,Wt,qt=ct("Opera"),Ht=ct("Trident")||ct("MSIE"),Gt=ct("Edge"),Kt=Gt||Ht,Xt=ct("Gecko")&&!(ot(Y.toLowerCase(),"webkit")&&!ct("Edge"))&&!(ct("Trident")||ct("MSIE"))&&!ct("Edge"),$t=ot(Y.toLowerCase(),"webkit")&&!ct("Edge");function Yt(){var t=a.document;return t?t.documentMode:void 0}t:{var Qt="",Jt=(Wt=Y,Xt?/rv:([^\);]+)(\)|;)/.exec(Wt):Gt?/Edge\/([\d\.]+)/.exec(Wt):Ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Wt):$t?/WebKit\/(\S+)/.exec(Wt):qt?/(?:Version)[ \/]?(\S+)/.exec(Wt):void 0);if(Jt&&(Qt=Jt?Jt[1]:""),Ht){var Zt=Yt();if(null!=Zt&&Zt>parseFloat(Qt)){zt=String(Zt);break t}}zt=Qt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=Q(String(zt)).split("."),r=Q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=at(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||at(0==a[2].length,0==s[2].length)||at(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}te=a.document&&Ht?Yt():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Wt){}var re=!Ht||9<=Number(te);function ie(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function oe(t,e){lt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ue.hasOwnProperty(n)?t.setAttribute(ue[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var ae,se,ue={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ce(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!h(o)||d(o)&&0<o.nodeType?r(o):U(he(o)?$(o):o,r)}}function le(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function he(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1}function fe(t){a.setTimeout((function(){throw t}),0)}function de(t,e){se||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);se=function(){t.then(me)}}else se=function(){var t=me;!f(a.setImmediate)||a.Window&&a.Window.prototype&&!ct("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ae||(ae=function(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ct("Presto")&&(t=function(){var t=le(document,"IFRAME");t.style.display="none",function(t){var e=new wt(It,gt(_t));vt(t,"HTMLIFrameElement"),t.src=xt(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Mt(Bt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=b((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ct("Trident")&&!ct("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){r.next={Fb:t},r=r.next,e.port2.postMessage(0)}}return function(t){a.setTimeout(t,0)}}()),ae(t)):a.setImmediate(t)}}(),pe||(se(),pe=!0),ve.add(t,e)}var pe=!1,ve=new F;function me(){for(var t;t=B();){try{t.a.call(t.b)}catch(e){fe(e)}M(L,t)}pe=!1}function ge(t,e){if(this.a=ye,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=c)try{var n=this;t.call(e,(function(t){Re(n,be,t)}),(function(t){if(!(t instanceof Le))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Re(n,_e,t)}))}catch(r){Re(this,_e,r)}}var ye=0,be=2,_e=3;function we(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}we.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var xe=new P((function(){return new we}),(function(t){t.reset()}));function Ce(t,e,n){var r=xe.get();return r.g=t,r.b=e,r.f=n,r}function ke(t){if(t instanceof ge)return t;var e=new ge(c);return Re(e,be,t),e}function Ee(t){return new ge((function(e,n){n(t)}))}function Se(t,e,n){Oe(t,e,n,null)||de(_(e,t))}function Ie(t){return new ge((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Se(t[o],_(i,o,!0),_(i,o,!1));else e(r)}))}function Te(t,e){t.b||t.a!=be&&t.a!=_e||Ne(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ae(t,e,n,r){var i=Ce(null,null,null);return i.a=new ge((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Le?o(e):t(i)}catch(a){o(a)}}:o})),i.a.c=t,Te(t,i),i.a}function Re(t,e,n){t.a==ye&&(t===n&&(e=_e,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Oe(n,t.Zc,t.$c,t)||(t.i=n,t.a=e,t.c=null,Ne(t),e!=_e||n instanceof Le||function(t,e){t.g=!0,de((function(){t.g&&Fe.call(null,e)}))}(t,n)))}function Oe(t,e,n,r){if(t instanceof ge)return Te(t,Ce(e||c,n||null,r)),!0;if(R(t))return t.then(e,n,r),!0;if(d(t))try{var i=t.then;if(f(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Ne(t){t.h||(t.h=!0,de(t.fc,t))}function De(t){var e=null;return t.b&&(t.b=(e=t.b).next,e.next=null),t.b||(t.f=null),e}function Pe(t,e,n,r){if(n==_e&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Me(e,n,r);else try{e.c?e.g.call(e.f):Me(e,n,r)}catch(i){Fe.call(null,i)}M(xe,e)}function Me(t,e,n){e==be?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}ge.prototype.then=function(t,e,n){return Ae(this,f(t)?t:null,f(e)?e:null,n)},ge.prototype.$goog_Thenable=!0,(t=ge.prototype).na=function(t,e){return(t=Ce(t,t,e)).c=!0,Te(this,t),this},t.s=function(t,e){return Ae(this,null,t,e)},t.cancel=function(t){if(this.a==ye){var e=new Le(t);de((function(){!function t(e,n){if(e.a==ye)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==ye&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):De(r),Pe(r,o,_e,n)))}e.c=null}else Re(e,_e,n)}(this,e)}),this)}},t.Zc=function(t){this.a=ye,Re(this,be,t)},t.$c=function(t){this.a=ye,Re(this,_e,t)},t.fc=function(){for(var t;t=De(this);)Pe(this,t,this.a,this.i);this.h=!1};var Fe=fe;function Le(t){O.call(this,t)}function Be(){0!=je&&(Ve[p(this)]=this),this.xa=this.xa,this.oa=this.oa}x(Le,O),Le.prototype.name="cancel";var je=0,Ve={};function Ue(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=je)){var e=p(t);if(0!=je&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ve[e]}}Be.prototype.xa=!1,Be.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var ze=Object.freeze||function(t){return t},We=!Ht||9<=Number(te),qe=Ht&&!ne("9"),He=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",c,e),a.removeEventListener("test",c,e)}catch(n){}return t}();function Ge(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ke(t,e){if(Ge.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{Ut(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Xe[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ge.prototype.preventDefault=function(){this.defaultPrevented=!0},x(Ke,Ge);var Xe=ze({2:"touch",3:"pen",4:"mouse"});Ke.prototype.preventDefault=function(){Ke.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,qe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Ke.prototype.g=function(){return this.a};var $e="closure_listenable_"+(1e6*Math.random()|0),Ye=0;function Qe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Ye,this.va=this.Oa=!1}function Je(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function Ze(t){this.src=t,this.a={},this.b=0}function tn(t,e){var n=e.type;n in t.a&&G(t.a[n],e)&&(Je(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function en(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==r)return i}return-1}Ze.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=en(t,e,r,i);return-1<a?(e=t[a],n||(e.Oa=!1)):((e=new Qe(e,this.src,o,!!r,i)).Oa=n,t.push(e)),e};var nn="closure_lm_"+(1e6*Math.random()|0),rn={};function on(t,e,n,r,i){if(r&&r.once)sn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)on(t,e[o],n,r,i);else n=mn(n),t&&t[$e]?yn(t,e,n,d(r)?!!r.capture:!!r,i):an(t,e,n,!1,r,i)}function an(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i,s=pn(t);if(s||(t[nn]=s=new Ze(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=dn,e=We?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)He||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ln(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function sn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)sn(t,e[o],n,r,i);else n=mn(n),t&&t[$e]?bn(t,e,n,d(r)?!!r.capture:!!r,i):an(t,e,n,!0,r,i)}function un(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=mn(n),t&&t[$e]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=en(o=t.a[e],n,r,i))&&(Je(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=pn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=en(e,n,r,i)),(n=-1<t?e[t]:null)&&cn(n))}function cn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[$e])tn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ln(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=pn(e))?(tn(n,t),0==n.b&&(n.src=null,e[nn]=null)):Je(t)}}}function ln(t){return t in rn?rn[t]:rn[t]="on"+t}function hn(t,e,n,r){var i=!0;if((t=pn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=fn(o,r),i=i&&!1!==o)}return i}function fn(t,e){var n=t.listener,r=t.Ua||t.src;return t.Oa&&cn(t),n.call(r,e)}function dn(t,e){if(t.va)return!0;if(!We){if(!e)t:{e=["window","event"];for(var n=a,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ke(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(s){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=hn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=hn(r[i],t,!1,e),n=n&&o}return n}return fn(t,new Ke(e,this))}function pn(t){return(t=t[nn])instanceof Ze?t:null}var vn="__closure_events_fn_"+(1e9*Math.random()>>>0);function mn(t){return f(t)?t:(t[vn]||(t[vn]=function(e){return t.handleEvent(e)}),t[vn])}function gn(){Be.call(this),this.v=new Ze(this),this.$b=this,this.fb=null}function yn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function bn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function _n(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Ua||a.src;a.Oa&&tn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function wn(t,e,n){if(f(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function xn(t){var e=null;return new ge((function(n,r){-1==(e=wn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw a.clearTimeout(e),t}))}function Cn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function kn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(h(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function En(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof En)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Sn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];In(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)In(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function In(t,e){return Object.prototype.hasOwnProperty.call(t,e)}x(gn,Be),gn.prototype[$e]=!0,gn.prototype.addEventListener=function(t,e,n,r){on(this,t,e,n,r)},gn.prototype.removeEventListener=function(t,e,n,r){un(this,t,e,n,r)},gn.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var r=t.type||t;if("string"==typeof t)t=new Ge(t,n);else if(t instanceof Ge)t.target=t.target||n;else{var i=t;pt(t=new Ge(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=_n(a,r,!0,t)&&i}if(i=_n(a=t.b=n,r,!0,t)&&i,i=_n(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=_n(a=t.b=e[o],r,!1,t)&&i;return i},gn.prototype.Da=function(){if(gn.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Je(n[r]);delete e.a[t],e.b--}}this.fb=null},(t=En.prototype).V=function(){Sn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Sn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return In(this.b,t)?this.b[t]:e},t.set=function(t,e){In(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Tn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function An(t,e){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,t instanceof An?(this.i=void 0!==e?e:t.i,Rn(this,t.f),this.l=t.l,this.a=t.a,On(this,t.g),this.c=t.c,Nn(this,Qn(t.b)),this.h=t.h):t&&(n=String(t).match(Tn))?(this.i=!!e,Rn(this,n[1]||"",!0),this.l=Ln(n[2]||""),this.a=Ln(n[3]||"",!0),On(this,n[4]),this.c=Ln(n[5]||"",!0),Nn(this,n[6]||"",!0),this.h=Ln(n[7]||"")):(this.i=!!e,this.b=new Hn(null,this.i))}function Rn(t,e,n){t.f=n?Ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function On(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Nn(t,e,n){e instanceof Hn?(t.b=e,function(t,e){e&&!t.f&&(Gn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Xn(this,e),Yn(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Bn(e,Wn)),t.b=new Hn(e,t.i))}function Dn(t,e,n){t.b.set(e,n)}function Pn(t,e){return t.b.get(e)}function Mn(t){return t instanceof An?new An(t):new An(t,void 0)}function Fn(t,e,n,r){var i=new An(null,void 0);return t&&Rn(i,t),e&&(i.a=e),n&&On(i,n),r&&(i.c=r),i}function Ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,jn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}An.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Bn(e,Vn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Bn(e,Vn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?zn:Un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Bn(n,qn)),t.join("")},An.prototype.resolve=function(t){var e=new An(this),n=!!t.f;n?Rn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.c;if(n)On(e,t.g);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.a&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ot(i,"./")||ot(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.b.toString(),n?Nn(e,Qn(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Vn=/[#\/\?@]/g,Un=/[#\?:]/g,zn=/[#\?]/g,Wn=/[#\?@]/g,qn=/#/g;function Hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Gn(t){t.a||(t.a=new En,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Kn(t){var e=kn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Hn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?Yn(n,i,o):n.add(i,o)}return n}function Xn(t,e){Gn(t),e=Jn(t,e),In(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,In((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Sn(t)))}function $n(t,e){return Gn(t),e=Jn(t,e),In(t.a.b,e)}function Yn(t,e,n){Xn(t,e),0<n.length&&(t.c=null,t.a.set(Jn(t,e),$(n)),t.b+=n.length)}function Qn(t){var e=new Hn;return e.c=t.c,t.a&&(e.a=new En(t.a),e.b=t.b),e}function Jn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Zn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),rr(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":rr(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new tr,t,e),e.join("")}function tr(){}(t=Hn.prototype).add=function(t,e){Gn(this),this.c=null,t=Jn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Gn(this),this.a.forEach((function(n,r){U(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Gn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.V=function(t){Gn(this);var e=[];if("string"==typeof t)$n(this,t)&&(e=X(e,this.a.get(Jn(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},t.set=function(t,e){return Gn(this),this.c=null,$n(this,t=Jn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var er={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},nr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function rr(t,e){e.push('"',t.replace(nr,(function(t){var e=er[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),er[t]=e),e})),'"')}function ir(){var t=xr();return Ht&&!!te&&11==te||/Edge\/\d+/.test(t)}function or(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function ar(t,e){e=e||a.window;var n="about:blank";t&&(n=At(Ot(t))),e.location.href=n}function sr(t){return!!((t=(t||xr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ur(t){t=t||a.window;try{t.close()}catch(e){}}function cr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=xr().toLowerCase(),r&&(e.target=r,ot(n,"crios/")&&(e.target="_blank")),br(xr())==yr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Tt?n:Ot(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((ct("iPhone")&&!ct("iPod")&&!ct("iPad")||ct("iPad")||ct("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(vt(a=le(document,"A"),"HTMLAnchorElement"),e instanceof Tt||e instanceof Tt||(e="object"==typeof e&&e.sa?e.ra():String(e),Rt.test(e)||(e="about:invalid#zClosurez"),e=new Tt(Dt,e)),a.href=At(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=At(e),a&&(Kt&&ot(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Lt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Vt(t)+'">'),r=a.document)&&(r.write(Mt(t)),r.close())):(a=r.open(At(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var lr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hr=/^[^@]+@[^@]+$/;function fr(){var t=null;return new ge((function(e){"complete"==a.document.readyState?e():(t=function(){e()},sn(window,"load",t))})).s((function(e){throw un(window,"load",t),e}))}function dr(t){return t=t||xr(),!("file:"!==Ir()&&"ionic:"!==Ir()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function pr(){var t=a.window;try{return!(!t||t==t.top)}catch(e){return!1}}function vr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function mr(){return R6.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":R6.a.INTERNAL.hasOwnProperty("node")?"Node":vr()?"Worker":"Browser"}function gr(){var t=mr();return"ReactNative"===t||"Node"===t}var yr="Firefox";function br(t){var e=t.toLowerCase();return ot(e,"opera/")||ot(e,"opr/")||ot(e,"opios/")?"Opera":ot(e,"iemobile")?"IEMobile":ot(e,"msie")||ot(e,"trident/")?"IE":ot(e,"edge/")?"Edge":ot(e,"firefox/")?yr:ot(e,"silk/")?"Silk":ot(e,"blackberry")?"Blackberry":ot(e,"webos")?"Webos":!ot(e,"safari/")||ot(e,"chrome/")||ot(e,"crios/")||ot(e,"android")?!ot(e,"chrome/")&&!ot(e,"crios/")||ot(e,"edge/")?ot(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"}var _r={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function wr(t,e){e=e||[];var n,r=[],i={};for(n in _r)i[_r[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=mr())?r=br(i=xr()):"Worker"===r&&(r=br(i=xr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function xr(){return a.navigator&&a.navigator.userAgent||""}function Cr(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function kr(){try{var t=a.localStorage,e=Nr();if(t)return t.setItem(e,"1"),t.removeItem(e),!ir()||!!a.indexedDB}catch(n){return vr()&&!!a.indexedDB}return!1}function Er(){return(Sr()||"chrome-extension:"===Ir()||dr())&&!gr()&&kr()&&!vr()}function Sr(){return"http:"===Ir()||"https:"===Ir()}function Ir(){return a.location&&a.location.protocol||null}function Tr(t){return!sr(t=t||xr())&&br(t)!=yr}function Ar(t){return void 0===t?null:Zn(t)}function Rr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!=t[e]&&(n[e]=t[e]);return n}function Or(t){if(null!==t)return JSON.parse(t)}function Nr(t){return t||Math.floor(1e9*Math.random()).toString()}function Dr(t){return"Safari"!=br(t=t||xr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Pr(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Mr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=xr(),e=mr(),this.b=sr(t)||"ReactNative"===e}function Fr(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Lr(t){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t)}function Br(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function jr(){return!(!Cr("fireauth.oauthhelper",a)&&!Cr("fireauth.iframe",a))}Mr.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!Sr()&&"chrome-extension:"!==Ir()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Vr,Ur={};function zr(t){Ur[t]||(Ur[t]=!0,Lr(t))}try{var Wr={};Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:2}),Vr=2==Wr.abcd}catch(Wt){Vr=!1}function qr(t,e,n){Vr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Hr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&qr(t,n,e[n])}function Gr(t){var e={};return Hr(e,t),e}function Kr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)qr(e,n,Kr(t[n]));return e}function Xr(t){var e=t&&(t[Zr]?"phone":null);if(!(e&&t&&t[Jr]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");qr(this,"uid",t[Jr]),qr(this,"displayName",t[Yr]||null);var n=null;t[Qr]&&(n=new Date(t[Qr]).toUTCString()),qr(this,"enrollmentTime",n),qr(this,"factorId",e)}function $r(t){try{var e=new ti(t)}catch(n){e=null}return e}Xr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Yr="displayName",Qr="enrolledAt",Jr="mfaEnrollmentId",Zr="phoneInfo";function ti(t){Xr.call(this,t),qr(this,"phoneNumber",t[Zr])}function ei(t){var e={},n=t[oi],r=t[si],i=t[ui];if(t=$r(t[ai]),!i||i!=ri&&i!=ii&&!n||i==ii&&!r||i==ni&&!t)throw Error("Invalid checkActionCode response!");i==ii?(e[li]=n||null,e[fi]=n||null,e[ci]=r):(e[li]=r||null,e[fi]=r||null,e[ci]=n||null),e[hi]=t||null,qr(this,pi,i),qr(this,di,Kr(e))}x(ti,Xr),ti.prototype.w=function(){var t=ti.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var ni="REVERT_SECOND_FACTOR_ADDITION",ri="EMAIL_SIGNIN",ii="VERIFY_AND_CHANGE_EMAIL",oi="email",ai="mfaInfo",si="newEmail",ui="requestType",ci="email",li="fromEmail",hi="multiFactorInfo",fi="previousEmail",di="data",pi="operation";function vi(t){var e=Pn(t=Mn(t),mi)||null,n=Pn(t,gi)||null,r=Pn(t,_i)||null;if(r=r&&xi[r]||null,!e||!n||!r)throw new C("argument-error",mi+", "+gi+"and "+_i+" are required in a valid action code URL.");Hr(this,{apiKey:e,operation:r,code:n,continueUrl:Pn(t,yi)||null,languageCode:Pn(t,bi)||null,tenantId:Pn(t,wi)||null})}var mi="apiKey",gi="oobCode",yi="continueUrl",bi="languageCode",_i="mode",wi="tenantId",xi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ni,signIn:ri,verifyAndChangeEmail:ii,verifyEmail:"VERIFY_EMAIL"};function Ci(t){try{return new vi(t)}catch(e){return null}}function ki(t){var e=t[Ai];if(void 0===e)throw new C("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new C("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Ei];if(n&&"object"==typeof n){e=n[Ni];var r=n[Ri];if(n=n[Oi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",Ri+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",Oi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new C("argument-error",Ni+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",Ei+" property must be a non null object when specified.");if(this.f=null,(e=t[Ti])&&"object"==typeof e){if("string"==typeof(e=e[Di])&&e.length)this.f=e;else if(void 0!==e)throw new C("argument-error",Di+" property must be a non empty string when specified.")}else if(void 0!==e)throw new C("argument-error",Ti+" property must be a non null object when specified.");if(void 0!==(e=t[Ii])&&"boolean"!=typeof e)throw new C("argument-error",Ii+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Si])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new C("argument-error",Si+" property must be a non empty string when specified.");this.i=t||null}var Ei="android",Si="dynamicLinkDomain",Ii="handleCodeInApp",Ti="iOS",Ai="url",Ri="installApp",Oi="minimumVersion",Ni="packageName",Di="bundleId";function Pi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Mi=null;function Fi(t){var e=Bi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,w(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Li(t){try{return new Fi(t)}catch(e){return null}}function Bi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Mi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Mi){Mi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Mi[o]&&(Mi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}(t))}catch(r){}return null}Fi.prototype.S=function(){return this.f},Fi.prototype.i=function(){return this.b},Fi.prototype.toString=function(){return this.g};var ji="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Vi=["client_id","response_type","scope","redirect_uri","state"],Ui={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:Vi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:Vi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:Vi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:ji},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function zi(t){for(var e in Ui)if(Ui[e].fa==t)return Ui[e];return null}function Wi(t){var e={};e["facebook.com"]=Xi,e["google.com"]=Yi,e["github.com"]=$i,e["twitter.com"]=Qi;var n=t&&t[Hi];try{if(n)return e[n]?new e[n](t):new Ki(t);if(void 0!==t[qi])return new Gi(t)}catch(r){}return null}var qi="idToken",Hi="providerId";function Gi(t){var e=t[Hi];if(!e&&t[qi]){var n=Li(t[qi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),qr(this,"providerId",e),qr(this,"isNewUser",n)}function Ki(t){Gi.call(this,t),qr(this,"profile",Kr((t=Or(t.rawUserInfo||"{}"))||{}))}function Xi(t){if(Ki.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function $i(t){if(Ki.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",this.profile&&this.profile.login||null)}function Yi(t){if(Ki.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qi(t){if(Ki.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",t.screenName||null)}function Ji(t){var e=Mn(t),n=Pn(e,"link"),r=Pn(Mn(n),"link");return e=Pn(e,"deep_link_id"),Pn(Mn(e),"link")||e||r||n||t}function Zi(t,e){if(!t&&!e)throw new C("internal-error","Internal assert: no raw session string available");if(t&&e)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?to:eo}x(Ki,Gi),x(Xi,Ki),x($i,Ki),x(Yi,Ki),x(Qi,Ki);var to="enroll",eo="signin";function no(){}function ro(t,e){return t.then((function(t){if(t[Wa]){var n=Li(t[Wa]);if(!n||e!=n.h)throw new C("user-mismatch");return t}throw new C("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==S+"user-not-found"?new C("user-mismatch"):t}))}function io(t,e){if(!e)throw new C("internal-error","failed to construct a credential");this.a=e,qr(this,"providerId",t),qr(this,"signInMethod",t)}function oo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function ao(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new io(t.providerId,t.pendingToken)}catch(e){}return null}function so(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&qr(this,"idToken",e.idToken),e.accessToken&&qr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&qr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");qr(this,"accessToken",e.oauthToken),qr(this,"secret",e.oauthTokenSecret)}qr(this,"providerId",t),qr(this,"signInMethod",n)}function uo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Kn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function co(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new so(t.providerId,e,t.signInMethod)}catch(n){}}return null}function lo(t,e){this.Pc=e||[],Hr(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(zi(t)||{}).Ja||null,this.nb=null}function ho(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');lo.call(this,t,[])}function fo(t){lo.call(this,t,Vi),this.a=[]}function po(){fo.call(this,"facebook.com")}function vo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new po).credential({accessToken:e})}function mo(){fo.call(this,"github.com")}function go(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new mo).credential({accessToken:e})}function yo(){fo.call(this,"google.com"),this.Ca("profile")}function bo(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),(new yo).credential({idToken:n,accessToken:e})}function _o(){lo.call(this,"twitter.com",ji)}function wo(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new so("twitter.com",n,"twitter.com")}function xo(t,e,n){this.a=t,this.f=e,qr(this,"providerId","password"),qr(this,"signInMethod",n===ko.EMAIL_LINK_SIGN_IN_METHOD?ko.EMAIL_LINK_SIGN_IN_METHOD:ko.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Co(t){return t&&t.email&&t.password?new xo(t.email,t.password,t.signInMethod):null}function ko(){Hr(this,{providerId:"password",isOAuthProvider:!1})}function Eo(t,e){if(!(e=So(e)))throw new C("argument-error","Invalid email link!");return new xo(t,e.code,ko.EMAIL_LINK_SIGN_IN_METHOD)}function So(t){return(t=Ci(t=Ji(t)))&&t.operation===ri?t:null}function Io(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new C("internal-error");this.a=t,qr(this,"providerId","phone"),this.fa="phone",qr(this,"signInMethod","phone")}function To(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return U(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Io(e)}return null}function Ao(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Ro(t){try{this.a=t||R6.a.auth()}catch(e){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Hr(this,{providerId:"phone",isOAuthProvider:!1})}function Oo(t,e){if(!t)throw new C("missing-verification-id");if(!e)throw new C("missing-verification-code");return new Io({cb:t,bb:e})}function No(t){if(t.temporaryProof&&t.phoneNumber)return new Io({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return bo(o,n);case"facebook.com":return vo(n);case"github.com":return go(n);case"twitter.com":return wo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new io(e,a):new so(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new fo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Do(t){if(!t.isOAuthProvider)throw new C("invalid-oauth-provider")}function Po(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Mo(t){return(t=t||{}).type?new Po(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&k(t.error),t.postBody,t.tenantId):null}function Fo(){this.b=null,this.a=[]}Zi.prototype.Ha=function(){return ke(this.a?this.a:this.b)},Zi.prototype.w=function(){return this.type==to?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},no.prototype.ja=function(){},no.prototype.b=function(){},no.prototype.c=function(){},no.prototype.w=function(){},io.prototype.ja=function(t){return ls(t,oo(this))},io.prototype.b=function(t,e){var n=oo(this);return n.idToken=e,hs(t,n)},io.prototype.c=function(t,e){return ro(fs(t,oo(this)),e)},io.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},so.prototype.ja=function(t){return ls(t,uo(this))},so.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,hs(t,n)},so.prototype.c=function(t,e){return ro(fs(t,uo(this)),e)},so.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},lo.prototype.Ka=function(t){return this.Hb=ft(t),this},x(ho,lo),x(fo,lo),fo.prototype.Ca=function(t){return H(this.a,t)||this.a.push(t),this},fo.prototype.Pb=function(){return $(this.a)},fo.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new so(this.providerId,n,this.providerId)},x(po,fo),qr(po,"PROVIDER_ID","facebook.com"),qr(po,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),x(mo,fo),qr(mo,"PROVIDER_ID","github.com"),qr(mo,"GITHUB_SIGN_IN_METHOD","github.com"),x(yo,fo),qr(yo,"PROVIDER_ID","google.com"),qr(yo,"GOOGLE_SIGN_IN_METHOD","google.com"),x(_o,lo),qr(_o,"PROVIDER_ID","twitter.com"),qr(_o,"TWITTER_SIGN_IN_METHOD","twitter.com"),xo.prototype.ja=function(t){return this.signInMethod==ko.EMAIL_LINK_SIGN_IN_METHOD?Ks(t,_s,{email:this.a,oobCode:this.f}):Ks(t,zs,{email:this.a,password:this.f})},xo.prototype.b=function(t,e){return this.signInMethod==ko.EMAIL_LINK_SIGN_IN_METHOD?Ks(t,ws,{idToken:e,email:this.a,oobCode:this.f}):Ks(t,Ps,{idToken:e,email:this.a,password:this.f})},xo.prototype.c=function(t,e){return ro(this.ja(t),e)},xo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Hr(ko,{PROVIDER_ID:"password"}),Hr(ko,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Hr(ko,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Io.prototype.ja=function(t){return t.eb(Ao(this))},Io.prototype.b=function(t,e){var n=Ao(this);return n.idToken=e,Ks(t,qs,n)},Io.prototype.c=function(t,e){var n=Ao(this);return n.operation="REAUTH",ro(t=Ks(t,Hs,n),e)},Io.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Ro.prototype.eb=function(t,e){var n=this.a.a;return ke(e.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=d(t)?t.session:null,o=d(t)?t.phoneNumber:t;return(i&&i.type==to?i.Ha().then((function(t){return function(t,e){return Ks(t,Fs,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==eo?i.Ha().then((function(e){return function(t,e){return Ks(t,Ls,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return Ks(t,Ns,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Hr(Ro,{PROVIDER_ID:"phone"}),Hr(Ro,{PHONE_SIGN_IN_METHOD:"phone"}),Po.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Po.prototype.S=function(){return this.h},Po.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Lo,Bo=null;function jo(t){var e="unauthorized-domain",n=void 0,r=Mn(t);t=r.a,"chrome-extension"==(r=r.f)?n=jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",C.call(this,e,n)}function Vo(t,e,n){C.call(this,t,n),(t=e||{}).Ib&&qr(this,"email",t.Ib),t.ea&&qr(this,"phoneNumber",t.ea),t.credential&&qr(this,"credential",t.credential),t.Yb&&qr(this,"tenantId",t.Yb)}function Uo(t){if(t.code){var e=t.code||"";0==e.indexOf(S)&&(e=e.substring(S.length));var n={credential:No(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new C(e,t.message||void 0);return new Vo(e,n,t.message)}return null}function zo(){}function Wo(){}function qo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Ho(){}function Go(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=b(this.pc,this),this.a.onerror=b(this.Rb,this),this.a.onprogress=b(this.qc,this),this.a.ontimeout=b(this.uc,this)}function Ko(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Xo(t,e,n){this.reset(t,e,n,void 0,void 0)}function $o(t){this.f=t,this.b=this.c=this.a=null}function Yo(t,e){this.name=t,this.value=e}x(jo,C),x(Vo,C),Vo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&pt(t,e),t},Vo.prototype.toJSON=function(){return this.w()},zo.prototype.c=null,x(Wo,zo),Wo.prototype.a=function(){var t=qo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Wo.prototype.b=function(){var t={};return qo(this)&&(t[0]=!0,t[1]=!0),t},Lo=new Wo,x(Ho,zo),Ho.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Go;throw Error("Unsupported browser")},Ho.prototype.b=function(){return{}},(t=Go.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Ko(this,4)},t.Rb=function(){this.status=500,this.response=this.responseText="",Ko(this,4)},t.uc=function(){this.Rb()},t.qc=function(){this.status=200,Ko(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Xo.prototype.a=null,Xo.prototype.reset=function(t,e,n,r,i){r||w(),delete this.a},Yo.prototype.toString=function(){return this.name};var Qo=new Yo("SEVERE",1e3),Jo=new Yo("WARNING",900),Zo=new Yo("CONFIG",700),ta=new Yo("FINE",500);$o.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(f(e)&&(e=e()),t=new Xo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ea={},na=null;function ra(t){var e;if(na||(na=new $o(""),ea[""]=na,na.c=Zo),!(e=ea[t])){e=new $o(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=ra(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,ea[t]=e}return e}function ia(t,e){t&&t.log(ta,e,void 0)}function oa(t){this.f=t}function aa(t){gn.call(this),this.o=t,this.readyState=sa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=ra("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}x(oa,zo),oa.prototype.a=function(){return new aa(this.f)},oa.prototype.b=function(t){return function(){return t}}({}),x(aa,gn);var sa=0;function ua(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function ca(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,la(t)}function la(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ha(t){gn.call(this),this.headers=new En,this.O=t||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.o=null,this.m=fa,this.u=this.R=!1}(t=aa.prototype).open=function(t,e){if(this.readyState!=sa)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,la(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.tc.bind(this),this.Ta.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ca(this,!1)),this.readyState=sa},t.tc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,la(this)),this.a&&(this.readyState=3,la(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,ua(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},t.oc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ca(this,!0):la(this),3==this.readyState&&ua(this)}},t.sc=function(t){this.a&&(this.response=this.responseText=t,ca(this,!0))},t.rc=function(t){this.a&&(this.response=t,ca(this,!0))},t.Ta=function(t){var e=this.h;e&&e.log(Jo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&ca(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Jo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Jo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},x(ha,gn);var fa="";ha.prototype.b=ra("goog.net.XhrIo");var da=/^https?$/i,pa=["POST","PUT"];function va(t){return"content-type"==t.toLowerCase()}function ma(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ga(t),ba(t)}function ga(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ya(t){if(t.c&&void 0!==o)if(t.A[1]&&4==wa(t)&&2==xa(t))ia(t.b,Ca(t,"Local request error detected and ignored"));else if(t.i&&4==wa(t))wn(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==wa(t)){ia(t.b,Ca(t,"Request complete")),t.c=!1;try{var e,n=xa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.l).match(Tn)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!da.test(s?s.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<wa(t)?t.a.statusText:""}catch(l){ia(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+xa(t)+"]",ga(t)}}finally{ba(t)}}}function ba(t,e){if(t.a){_a(t);var n=t.a,r=t.A[0]?c:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Qo,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function _a(t){t.a&&t.u&&(t.a.ontimeout=null),t.o&&(a.clearTimeout(t.o),t.o=null)}function wa(t){return t.a?t.a.readyState:0}function xa(t){try{return 2<wa(t)?t.a.status:-1}catch(e){return-1}}function Ca(t,e){return e+" ["+t.P+" "+t.l+" "+xa(t)+"]"}function ka(t){var e=Ma;this.g=[],this.u=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function Ea(t,e,n){t.a=!0,t.c=n,t.f=!e,Aa(t)}function Sa(t){if(t.a){if(!t.m)throw new Ra(t);t.m=!1}}function Ia(t,e,n,r){t.g.push([e,n,r]),t.a&&Aa(t)}function Ta(t){return q(t.g,(function(t){return f(t[1])}))}function Aa(t){if(t.h&&t.a&&Ta(t)){var e=t.h,n=Da[e];n&&(a.clearTimeout(n.a),delete Da[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var u=o.call(i||t.o,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(R(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ta(t)||(n=!0)}}t.c=e,r&&(u=b(t.v,t,!0),r=b(t.v,t,!1),e instanceof ka?(Ia(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new Na(e),Da[e.a]=e,t.h=e.a)}function Ra(){O.call(this)}function Oa(){O.call(this)}function Na(t){this.a=a.setTimeout(b(this.c,this),0),this.b=t}(t=ha.prototype).Ma=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ia(this.b,Ca(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ia(this.b,Ca(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ba(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ba(this,!0)),ha.$a.Da.call(this)},t.Ub=function(){this.xa||(this.N||this.i||this.f?ya(this):this.Ic())},t.Ic=function(){ya(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case fa:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Qo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ia(this.b,"Can not get response: "+e.message),null}},ka.prototype.cancel=function(t){if(this.a)this.c instanceof ka&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.o,this):this.m=!0,this.a||(t=new Oa(this),Sa(this),Ea(this,!1,t))}},ka.prototype.v=function(t,e){this.i=!1,Ea(this,t,e)},ka.prototype.then=function(t,e,n){var r,i,o=new ge((function(t,e){r=t,i=e}));return Ia(this,r,(function(t){t instanceof Oa?o.cancel():i(t)})),o.then(t,e,n)},ka.prototype.$goog_Thenable=!0,x(Ra,O),Ra.prototype.message="Deferred has already fired",Ra.prototype.name="AlreadyCalledError",x(Oa,O),Oa.prototype.message="Deferred was canceled",Oa.prototype.name="CanceledError",Na.prototype.c=function(){throw delete Da[this.a],this.b};var Da={};function Pa(t){var e={},n=e.document||document,r=xt(t).toString(),i=le(document,"SCRIPT"),o={Vb:i,Ma:void 0},c=new ka(o),l=null,h=null!=e.timeout?e.timeout:5e3;return 0<h&&(l=window.setTimeout((function(){Fa(i,!0);var t=new ja(Ba,"Timeout reached for loading script "+r);Sa(c),Ea(c,!1,t)}),h),o.Ma=l),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Fa(i,e.wd||!1,l),Sa(c),Ea(c,!0,null))},i.onerror=function(){Fa(i,!0,l);var t=new ja(La,"Error while loading script "+r);Sa(c),Ea(c,!1,t)},pt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),oe(i,o),function(t,e){vt(t,"HTMLScriptElement"),t.src=xt(e),null===u&&(u=(e=(e=a.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&s.test(e)?e:""),(e=u)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),c}function Ma(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&Fa(t,!0,this.Ma)}}function Fa(t,e,n){null!=n&&a.clearTimeout(n),t.onload=c,t.onerror=c,t.onreadystatechange=c,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var La=0,Ba=1;function ja(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),O.call(this,n),this.code=t}function Va(t){this.f=t}function Ua(t,e,n){if(this.c=t,this.l=(t=e||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||qa,this.g=ft(t.secureTokenHeaders||Ha),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||Ga,this.a=ft(t.firebaseHeaders||Ka),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==mr(),!(n=a.XMLHttpRequest||n&&R6.a.INTERNAL.node&&R6.a.INTERNAL.node.XMLHttpRequest)&&!vr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=vr()?new oa(self):gr()?new Va(n):new Ho,this.b=null}x(ja,O),x(Va,zo),Va.prototype.a=function(){return new this.f},Va.prototype.b=function(){return{}};var za,Wa="idToken",qa=new Mr(3e4,6e4),Ha={"Content-Type":"application/x-www-form-urlencoded"},Ga=new Mr(3e4,6e4),Ka={"Content-Type":"application/json"};function Xa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function $a(t,e){e&&(t.l=Ya("https://securetoken.googleapis.com/v1/token",e),t.h=Ya("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=Ya("https://identitytoolkit.googleapis.com/v2/",e))}function Ya(t,e){return t=Mn(t),e=Mn(e.url),t.c=t.a+t.c,Rn(t,e.f),t.a=e.a,On(t,e.g),t.toString()}function Qa(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Ja(t,e,n,r,i,o,s){(function(){var t=xr();return!((t="Chrome"!=br(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Ht&&te&&!(9<te))})()||vr()?t=b(t.u,t):(za||(za=new ge((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(a[ts]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Ia(t,null,e,void 0)}(Pa(Ct(Za,{onload:ts})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=b(t.o,t)),t(e,n,r,i,o,s)}Ua.prototype.S=function(){return this.b},Ua.prototype.u=function(t,e,n,r,i,o){if(vr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ha(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout((function(){s.dispatchEvent("timeout")}),o)}yn(s,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ia(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),bn(s,"ready",(function(){u&&clearTimeout(u),Ue(this)})),bn(s,"timeout",(function(){u&&clearTimeout(u),Ue(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Lo.a(),t.A=function(t){return t.c||(t.c=t.b())}(t.O?t.O:Lo),t.a.onreadystatechange=b(t.Ub,t);try{ia(t.b,Ca(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(s){return ia(t.b,Ca(t,"Error opening Xhr: "+s.message)),void ma(t,s)}e=r||"";var o=new En(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)U(t,e,void 0);else for(var n=kn(t),r=Cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=va,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=a.FormData&&e instanceof a.FormData,!H(pa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{_a(t),0<t.g&&(t.u=function(t){return Ht&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ia(t.b,Ca(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=b(t.Ma,t)):t.o=wn(t.Ma,t.g,t)),ia(t.b,Ca(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){ia(t.b,Ca(t,"Send error: "+s.message)),ma(t,s)}}(s,t,n,r,i)};var Za=new mt(bt,"https://apis.google.com/js/client.js?onload=%{onload}"),ts="__fcb"+Math.floor(1e6*Math.random()).toString();function es(t){if("string"!=typeof(t=t.email)||!hr.test(t))throw new C("invalid-email")}function ns(t){"email"in t&&es(t)}function rs(t){if(!t[Wa]){if(t.mfaPendingCredential)throw new C("multi-factor-auth-required",null,ft(t));throw new C("internal-error")}}function is(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new C("internal-error")}else{if(!t.sessionInfo)throw new C("missing-verification-id");if(!t.code)throw new C("missing-verification-code")}}Ua.prototype.o=function(t,e,n,r,i){var o=this;za.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Ua.prototype.yb=function(){return Ks(this,Ms,{})},Ua.prototype.Ab=function(t,e){return Ks(this,Ds,{idToken:t,email:e})},Ua.prototype.Bb=function(t,e){return Ks(this,Ps,{idToken:t,password:e})};var os={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function as(t){if(!t.phoneVerificationInfo)throw new C("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new C("missing-verification-code")}function ss(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new C("internal-error")}function us(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&$n(t=new Hn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function cs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Uo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Uo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Uo(t)):t.errorMessage&&(e=Xs(t.errorMessage)),e)throw e;rs(t)}function ls(t,e){return e.returnIdpCredential=!0,Ks(t,Bs,e)}function hs(t,e){return e.returnIdpCredential=!0,Ks(t,Vs,e)}function fs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ks(t,js,e)}function ds(t){if(!t.oobCode)throw new C("invalid-action-code")}(t=Ua.prototype).Cb=function(t,e){var n={idToken:t},r=[];return lt(os,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Ks(this,Ds,n)},t.ub=function(t,e){return pt(t={requestType:"PASSWORD_RESET",email:t},e),Ks(this,Ts,t)},t.vb=function(t,e){return pt(t={requestType:"EMAIL_SIGNIN",email:t},e),Ks(this,Es,t)},t.tb=function(t,e){return pt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Ks(this,Ss,t)},t.Db=function(t,e,n){return pt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Ks(this,Is,t)},t.eb=function(t){return Ks(this,Ws,t)},t.mb=function(t,e){return Ks(this,Os,{oobCode:t,newPassword:e})},t.Qa=function(t){return Ks(this,vs,{oobCode:t})},t.ib=function(t){return Ks(this,ps,{oobCode:t})};var ps={endpoint:"setAccountInfo",B:ds,Z:"email",C:!0},vs={endpoint:"resetPassword",B:ds,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new C("internal-error")},C:!0},ms={endpoint:"signupNewUser",B:function(t){if(es(t),!t.password)throw new C("weak-password")},F:rs,U:!0,C:!0},gs={endpoint:"createAuthUri",C:!0},ys={endpoint:"deleteAccount",M:["idToken"]},bs={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if("array"!=l(t.deleteProvider))throw new C("internal-error")}},_s={endpoint:"emailLinkSignin",M:["email","oobCode"],B:es,F:rs,U:!0,C:!0},ws={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:es,F:rs,U:!0},xs={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:as,F:rs,C:!0,Na:!0},Cs={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:as,F:rs,C:!0,Na:!0},ks={endpoint:"getAccountInfo"},Es={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new C("internal-error");es(t)},Z:"email",C:!0},Ss={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},Is={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},Ts={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new C("internal-error");es(t)},Z:"email",C:!0},As={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Rs={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new C("internal-error")}},Os={endpoint:"resetPassword",B:ds,Z:"email",C:!0},Ns={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},Ds={endpoint:"setAccountInfo",M:["idToken"],B:ns,U:!0},Ps={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(ns(t),!t.password)throw new C("weak-password")},F:rs,U:!0},Ms={endpoint:"signupNewUser",F:rs,U:!0,C:!0},Fs={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new C("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},Ls={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},Bs={endpoint:"verifyAssertion",B:ss,Xa:us,F:cs,U:!0,C:!0},js={endpoint:"verifyAssertion",B:ss,Xa:us,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new C("user-not-found");if(t.errorMessage)throw Xs(t.errorMessage);rs(t)},U:!0,C:!0},Vs={endpoint:"verifyAssertion",B:function(t){if(ss(t),!t.idToken)throw new C("internal-error")},Xa:us,F:cs,U:!0},Us={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new C("invalid-custom-token")},F:rs,U:!0,C:!0},zs={endpoint:"verifyPassword",B:function(t){if(es(t),!t.password)throw new C("wrong-password")},F:rs,U:!0,C:!0},Ws={endpoint:"verifyPhoneNumber",B:is,F:rs,C:!0},qs={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new C("internal-error");is(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Uo(t);rs(t)}},Hs={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:is,F:rs,C:!0},Gs={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Wa]^!!t.refreshToken)throw new C("internal-error")},C:!0,Na:!0};function Ks(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return Ee(new C("internal-error"));var r,i=!!e.Na,o=e.Tb||"POST";return ke(n).then(e.B).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Mn(e+n);Dn(s,"key",t.c),a&&Dn(s,"cb",w().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Dn(s,c,i[c]);return new ge((function(e,n){Ja(t,s.toString(),(function(t){t?t.error?n($s(t,o||{})):e(t):n(new C("network-request-failed"))}),r,u?void 0:Zn(Rr(i)),t.a,t.m.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Gb,e.kb||!1)})).then((function(t){return r=t,e.Xa?e.Xa(n,r):r})).then(e.F).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new C("internal-error");return r[e.Z]}))}function Xs(t){return $s({error:{errors:[{message:t}],code:400,message:t}})}function $s(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",pt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],e);return!e&&t&&(e=Ar(t)),new C("internal-error",e)}function Ys(t){this.b=t,this.a=null,this.qb=function(t){return(tu||(tu=new ge((function(t,e){function n(){Pr(),Cr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Pr(),e(Error("Network Error"))},timeout:Js.get()})}if(Cr("gapi.iframes.Iframe"))t();else if(Cr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){Cr("gapi.load")?n():e(Error("Network Error"))},ke(Pa(r=Ct(Qs,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw tu=null,t})))).then((function(){return new ge((function(e,n){Cr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),Zs.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var Qs=new mt(bt,"https://apis.google.com/js/api.js?onload=%{onload}"),Js=new Mr(3e4,6e4),Zs=new Mr(5e3,15e3),tu=null;function eu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Fn((t=Mn(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):Fn("https",this.l,null,"/__/auth/iframe"),this.a=t,Dn(this.a,"apiKey",this.h),Dn(this.a,"appName",this.i),this.b=null,this.c=[]}function nu(t,e,n,r,i,o){this.u=t,this.o=e,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function ru(t){try{return R6.a.app(t).auth().Ga()}catch(e){return[]}}function iu(t,e,n,r,i,o){this.o=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function ou(t){var e=or();return function(t){return Ks(t,As,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Mn(e),r=n.f;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Mn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:lr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new jo(or())}))}function au(t){return t.v?t.v:(t.v=fr().then((function(){if(!t.u){var e=t.c,n=t.i,r=ru(t.b),i=new eu(t.o,t.g,t.b,t.f);i.f=e,i.b=n,i.c=$(r||[]),t.u=i.toString()}t.m=new Ys(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then((function(){t.a.register("authEvent",e,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.m,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Mo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",ke(n)}return n.status="ERROR",ke(n)}))}(t)})),t.v)}function su(t){return t.l||(t.A=t.c?wr(t.c,ru(t.b)):null,t.l=new Ua(t.g,A(t.i),t.A),t.f&&$a(t.l,t.f)),t.l}function uu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new nu(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=ft(u||null),t.f=c,t.xb(l).toString()}function cu(t){if(this.a=t||R6.a.INTERNAL.reactNative&&R6.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function lu(t){this.b=t,this.a={},this.f=b(this.c,this)}eu.prototype.toString=function(){return this.f?Dn(this.a,"v",this.f):Xn(this.a.b,"v"),this.b?Dn(this.a,"eid",this.b):Xn(this.a.b,"eid"),this.c.length?Dn(this.a,"fw",this.c.join(",")):Xn(this.a.b,"fw"),this.a.toString()},nu.prototype.xb=function(t){return this.h=t,this},nu.prototype.toString=function(){if(this.m){var t=Mn(this.m.url);t=Fn(t.f,t.a,t.g,"/emulator/auth/handler")}else t=Fn("https",this.u,null,"/__/auth/handler");if(Dn(t,"apiKey",this.o),Dn(t,"appName",this.c),Dn(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var n=R6.a.app(this.c).auth().ka()}catch(s){n=null}for(var r in e.nb=n,Dn(t,"providerId",this.a.providerId),e=Rr((n=this.a).Hb))e[r]=e[r].toString();r=n.Pc,e=ft(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.ob&&n.nb&&!e[n.ob]&&(e[n.ob]=n.nb),ht(e)||Dn(t,"customParameters",Ar(e))}if("function"==typeof this.a.Pb&&(n=this.a.Pb()).length&&Dn(t,"scopes",n.join(",")),this.l?Dn(t,"redirectUrl",this.l):Xn(t.b,"redirectUrl"),this.g?Dn(t,"eventId",this.g):Xn(t.b,"eventId"),this.i?Dn(t,"v",this.i):Xn(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Pn(t,a)&&Dn(t,a,this.b[a]);return this.h?Dn(t,"tid",this.h):Xn(t.b,"tid"),this.f?Dn(t,"eid",this.f):Xn(t.b,"eid"),(a=ru(this.c)).length&&Dn(t,"fw",a.join(",")),t.toString()},(t=iu.prototype).Nb=function(t,e,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),o=this,a=!1;return this.la().then((function(){(function(t){var e={type:"webStorageSupport"};return au(t).then((function(){return function(t,e){return t.qb.then((function(){return new ge((function(n){t.a.send(e.type,e,n,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.m,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&ur(t),e(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(t){return new ge((function(e){return function n(){xn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return xn(n).then((function(){e(r)}))}))},t.Wb=function(){var t=xr();return!Tr(t)&&!Dr(t)},t.Sb=function(){return!1},t.Lb=function(t,e,n,r,i,o,a,s){if(!t)return Ee(new C("popup-blocked"));if(a&&!Tr())return this.la().s((function(e){ur(t),i(e)})),r(),ke();this.a||(this.a=ou(su(this)));var u=this;return this.a.then((function(){var e=u.la().s((function(e){throw ur(t),i(e),e}));return r(),e})).then((function(){Do(n),a||ar(uu(u.o,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Mb=function(t,e,n,r){this.a||(this.a=ou(su(this)));var i=this;return this.a.then((function(){Do(e),ar(uu(i.o,i.g,i.b,t,e,or(),n,i.c,void 0,i.i,r,i.f))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.la=function(){var t=this;return au(this).then((function(){return t.m.qb})).s((function(){throw t.a=null,new C("network-request-failed")}))},t.Zb=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ra=function(t){K(this.h,(function(e){return e==t}))},(t=cu.prototype).get=function(t){return ke(this.a.getItem(t)).then((function(t){return t&&Or(t)}))},t.set=function(t,e){return ke(this.a.setItem(t,Ar(e)))},t.T=function(t){return ke(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var hu,fu=[];function du(t,e,n){ht(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function pu(t){this.a=t}function vu(t){this.c=t,this.b=!1,this.a=[]}function mu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Ee(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new ge((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),t.a.push(c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return gu(t,c),e})).s((function(e){throw gu(t,c),e}))}function gu(t,e){if(e){var n=e.messageChannel;n&&(n.port1.removeEventListener("message",e.onMessage),n.port1.close()),K(t.a,(function(t){return t==e}))}}function yu(){if(!_u())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;vr()&&self?(this.l=function(){var t=vr()?self:null;if(U(fu,(function(n){n.b==t&&(e=n)})),!e){var e=new lu(t);fu.push(e)}return e}(),du(this.l,"keyChanged",(function(e,n){return Eu(t).then((function(e){return 0<e.length&&U(t.a,(function(t){t(e)})),{keyProcessed:H(e,n.key)}}))})),du(this.l,"ping",(function(){return ke(["keyChanged"])}))):function(){var t=a.navigator;return t&&t.serviceWorker?ke().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):ke(null)}().then((function(e){(t.h=e)&&(t.g=new vu(new pu(e)),mu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&H(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function bu(t){return t.v||(t.v=function t(e){return new ge((function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){r(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new ge((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(e).then((function(){return t(e)})).then((function(t){n(t)})).s((function(t){r(t)}))}}))}(t)),t.v}function _u(){try{return!!a.indexedDB}catch(Wt){return!1}}function wu(t){return t.objectStore("firebaseLocalStorage")}function xu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Cu(t){return new ge((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function ku(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?mu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):ke()}function Eu(t){return bu(t).then((function(t){var e=wu(xu(t,!1));return e.getAll?Cu(e.getAll()):new ge((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Su(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Iu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=ke().then((function(){if(_u()){var t=Nr(),r="__sak"+t;return hu||(hu=new yu),(n=hu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){U(e.a,(function(e){e(t)}))})),t}))}function Tu(){this.a={},this.type="inMemory"}function Au(){if(!function(){var t="Node"==mr();if(!(t=Ru()||t&&R6.a.INTERNAL.node&&R6.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==mr())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Ru()||R6.a.INTERNAL.node.localStorage,this.type="localStorage"}function Ru(){try{var t=a.localStorage,e=Nr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ou(){this.type="nullStorage"}function Nu(){if(!function(){var t="Node"==mr();if(!(t=Du()||t&&R6.a.INTERNAL.node&&R6.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==mr())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Du()||R6.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Du(){try{var t=a.sessionStorage,e=Nr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Pu(){var t={};t.Browser=Lu,t.Node=Bu,t.ReactNative=ju,t.Worker=Vu,this.a=t[mr()]}lu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];U(r,(function(e){i.push(ke().then((function(){return e(t.origin,t.data.data)})))})),Ie(i).then((function(r){var i=[];U(r,(function(t){i.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})})),U(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},pu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},vu.prototype.close=function(){for(;0<this.a.length;)gu(this,this.a[0]);this.b=!0},(t=yu.prototype).set=function(t,e){var n,r=!1,i=this;return bu(this).then((function(e){return Cu((e=wu(xu(n=e,!0))).get(t))})).then((function(o){var a=wu(xu(n,!0));return o?(o.value=e,Cu(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Cu(a.add(o)))})).then((function(){return i.c[t]=e,ku(i,t)})).na((function(){r&&i.b--}))},t.get=function(t){return bu(this).then((function(e){return Cu(wu(xu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.T=function(t){var e=!1,n=this;return bu(this).then((function(r){return e=!0,n.b++,Cu(wu(xu(r,!0)).delete(t))})).then((function(){return delete n.c[t],ku(n,t)})).na((function(){e&&n.b--}))},t.ca=function(t){0==this.a.length&&function(t){Su(t),function e(){t.f=setTimeout((function(){t.i=Eu(t).then((function(e){0<e.length&&U(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){K(this.a,(function(e){return e==t})),0==this.a.length&&Su(this)},(t=Iu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.T=function(t){return this.b.then((function(e){return e.T(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){K(this.a,(function(e){return e==t}))},(t=Tu.prototype).get=function(t){return ke(this.a[t])},t.set=function(t,e){return this.a[t]=e,ke()},t.T=function(t){return delete this.a[t],ke()},t.ca=function(){},t.ia=function(){},(t=Au.prototype).get=function(t){var e=this;return ke().then((function(){return Or(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return ke().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return ke().then((function(){e.a.removeItem(t)}))},t.ca=function(t){a.window&&on(a.window,"storage",t)},t.ia=function(t){a.window&&un(a.window,"storage",t)},(t=Ou.prototype).get=function(){return ke(null)},t.set=function(){return ke()},t.T=function(){return ke()},t.ca=function(){},t.ia=function(){},(t=Nu.prototype).get=function(t){var e=this;return ke().then((function(){return Or(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return ke().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return ke().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Mu,Fu,Lu={D:Au,ab:Nu},Bu={D:Au,ab:Nu},ju={D:cu,ab:Ou},Vu={D:Au,ab:Ou},Uu={qd:"local",NONE:"none",sd:"session"};function zu(){var t=!(Dr(xr())||!pr()),e=Tr(),n=kr();this.v=t,this.h=e,this.l=n,this.a={},Mu||(Mu=new Pu),t=Mu;try{this.g=!ir()&&jr()||!a.indexedDB?new t.a.D:new Iu(vr()?new Tu:new t.a.D)}catch(r){this.g=new Tu,this.h=!0}try{this.i=new t.a.ab}catch(r){this.i=new Tu}this.m=new Tu,this.f=b(this.Xb,this),this.b={}}function Wu(){return Fu||(Fu=new zu),Fu}function qu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function Hu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Gu(t,e,n){return n=Hu(e,n),"local"==e.D&&(t.b[n]=null),qu(t,e.D).T(n)}function Ku(t){t.c&&(clearInterval(t.c),t.c=null)}function Xu(t){this.a=t,this.b=Wu()}(t=zu.prototype).get=function(t,e){return qu(this,t.D).get(Hu(t,e))},t.set=function(t,e,n){var r=Hu(t,n),i=this,o=qu(this,t.D);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.D&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=Hu(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),ht(this.a)&&(qu(this,"local").ca(this.f),this.h||(ir()||!jr())&&a.indexedDB||!this.l||function(t){Ku(t),t.c=setInterval((function(){for(var e in t.a){var n=a.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ke({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Xb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Hu(t,e),this.a[t]&&(K(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),ht(this.a)&&(qu(this,"local").ia(this.f),Ku(this))},t.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?qu(this,"local").ia(this.f):Ku(this),this.v)if(n=a.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?a.localStorage.setItem(e,r):a.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.lb(e))},Ht&&te&&10==te&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else U(t,b(this.lb,this))},t.lb=function(t){this.a[t]&&U(this.a[t],(function(t){t()}))};var $u,Yu={name:"authEvent",D:"local"};function Qu(){this.a=Wu()}function Ju(t,e){this.b=Zu,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===$u&&($u=a.Int32Array?new Int32Array(ac):ac),this.reset()}x(Ju,(function(){this.b=-1}));for(var Zu=64,tc=Zu-1,ec=[],nc=0;nc<tc;nc++)ec[nc]=0;var rc=X(128,ec);function ic(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){var o=(0|n[e-16])+(((i=0|n[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+(((r=0|n[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|$u[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function oc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(ic(t),i=0);else{if(!h(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(ic(t),i=0)}}t.c=i,t.g+=n}Ju.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):$(this.h)};var ac=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function sc(){Ju.call(this,8,uc)}x(sc,Ju);var uc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function cc(t,e,n,r,i,o){this.m=t,this.i=e,this.l=n,this.v=r||null,this.u=i||null,this.o=o,this.h=e+":"+n,this.A=new Qu,this.g=new Xu(this.h),this.f=null,this.b=[],this.a=this.c=null}function lc(t){return new C("invalid-cordova-configuration",t)}function hc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function fc(t){return t.f||(t.f=t.la().then((function(){return new ge((function(e){t.Ea((function n(r){return e(r),t.Ra(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),dc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Ji(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Or(Pn(o=Mn(i),"firebaseError")||null))?k(o):null)?new Po(r.c,r.b,null,null,o,null,r.S()):new Po(r.c,r.b,i,r.f,null,null,r.S())),i=o||n}hc(t,i)}))}var n=new Po("unknown",null,null,null,new C("no-auth-event")),r=!1,i=xn(500).then((function(){return dc(t).then((function(){r||hc(t,n)}))})),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Cr("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Bo||(Bo=new Fo),function(t){var e=Bo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Cr("universalLinks.subscribe",a))&&t(null,e.b))}(e)}(t)}))}))),t.f}function dc(t){var e=null;return function(t){return t.b.get(Yu,t.a).then((function(t){return Mo(t)}))}(t.g).then((function(n){return e=n,Gu((n=t.g).b,Yu,n.a)})).then((function(){return e}))}function pc(t){this.a=t,this.b=Wu()}(t=cc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(dr(void 0)?fr().then((function(){return new ge((function(t,e){var n=a.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Ee(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Cr("universalLinks.subscribe",a))throw lc("cordova-universal-links-plugin-fix is not installed");if(void 0===Cr("BuildInfo.packageName",a))throw lc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Cr("cordova.plugins.browsertab.openUrl",a))throw lc("cordova-plugin-browsertab is not installed");if("function"!=typeof Cr("cordova.InAppBrowser.open",a))throw lc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},t.Nb=function(t,e){return e(new C("operation-not-supported-in-this-environment")),ke()},t.Lb=function(){return Ee(new C("operation-not-supported-in-this-environment"))},t.Zb=function(){return!1},t.Wb=function(){return!0},t.Sb=function(){return!0},t.Mb=function(t,e,n,r){if(this.c)return Ee(new C("redirect-operation-pending"));var i=this,o=a.document,s=null,u=null,c=null,l=null;return this.c=ke().then((function(){return Do(e),fc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Po(e,r,null,o,new C("no-auth-event"),null,i),u=Cr("BuildInfo.packageName",a);if("string"!=typeof u)throw new C("invalid-cordova-configuration");var c=Cr("BuildInfo.displayName",a),l={};if(xr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!xr().toLowerCase().match(/android/))return Ee(new C("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=function(t){var e=new sc;oc(e,t),t=[];var n=8*e.g;oc(e,rc,56>e.c?56-e.c:e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(ic(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return W(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=uu(t.m,t.i,t.l,e,n,null,r,t.v,l,t.u,i,t.o);return t.la().then((function(){var e=t.h;return t.A.a.set(Yu,s.w(),e)})).then((function(){var e=Cr("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new C("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Cr("cordova.plugins.browsertab.openUrl",a)))throw new C("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Cr("cordova.InAppBrowser.open",a)))throw new C("invalid-cordova-configuration");e=xr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new ge((function(t,e){u=function(){var e=Cr("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),l=function(){Fr()&&c()},o.addEventListener("resume",c=function(){s||(s=xn(2e3).then((function(){e(new C("redirect-cancelled-by-user"))})))},!1),xr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).s((function(t){return dc(i).then((function(){throw t}))}))})).na((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),s&&s.cancel(),u&&i.Ra(u),i.c=null}))},t.Ea=function(t){this.b.push(t),fc(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Po("unknown",null,null,null,new C("no-auth-event")),t(e))}))},t.Ra=function(t){K(this.b,(function(e){return e==t}))};var vc={name:"pendingRedirect",D:"session"};function mc(t){return Gu(t.b,vc,t.a)}function gc(t,e,n,r){this.i={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=b(this.o,this),this.b=new Nc,this.A=new Lc,this.g=new pc(Rc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=yc(this.O,this.m,this.v,E,this.G)}function yc(t,e,n,r,i){var o=R6.a.SDK_VERSION||null;return dr()?new cc(t,e,n,o,r,i):new iu(t,e,n,o,r,i)}function bc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().s((function(n){throw t.a==e&&t.reset(),n}))}function _c(t){t.a.Wb()&&bc(t).s((function(e){var n=new Po("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Sc(e)&&t.o(n)})),t.a.Sb()||Dc(t.b)}function wc(t,e){H(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(vc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?mc(t.g).then((function(){bc(t).s((function(e){var n=new Po("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Sc(e)&&t.o(n)}))})):_c(t)})).s((function(){_c(t)}))}function xc(t,e){K(t.h,(function(t){return t==e}))}gc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=yc(this.O,this.m,this.v,null,this.G),this.i={}},gc.prototype.o=function(t){if(!t)throw new C("invalid-auth-event");if(6e5<=w()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=w())),e=!0;break}}return Dc(this.b),e};var Cc=new Mr(2e3,1e4),kc=new Mr(3e4,6e4);function Ec(t,e,n,r,i,o,a){return t.a.Lb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Sc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Ic(t,e,n,r,i){var o;return function(t){return t.b.set(vc,"pending",t.a)}(t.g).then((function(){return t.a.Mb(e,n,r,i).s((function(e){if(Sc(e))throw new C("operation-not-supported-in-this-environment");return o=e,mc(t.g).then((function(){throw o}))})).then((function(){return t.a.Zb()?new ge((function(){})):mc(t.g).then((function(){return t.qa()})).then((function(){})).s((function(){}))}))}))}function Tc(t,e,n,r,i){return t.a.Nb(r,(function(t){e.ma(n,null,t,i)}),Cc.get())}gc.prototype.qa=function(){return this.b.qa()};var Ac={};function Rc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Oc(t,e,n,r){var i=Rc(e,n,r);return Ac[i]||(Ac[i]=new gc(t,e,n,r)),Ac[i]}function Nc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Dc(t){t.g||(t.g=!0,Fc(t,!1,null,null))}function Pc(t){t.g&&!t.i&&Fc(t,!1,null,null)}function Mc(t,e){if(t.b=function(){return ke(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Fc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Ee(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Mc(t,n):Mc(t,{user:null}),t.f=[],t.c=[]}function Lc(){}function Bc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function jc(t,e){this.a=e,qr(this,"verificationId",t)}function Vc(t,e,n,r){return new Ro(t).eb(e,n).then((function(t){return new jc(t,r)}))}function Uc(t){var e=Bi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Hr(this,{token:t,expirationTime:Br(1e3*e.exp),authTime:Br(1e3*e.auth_time),issuedAtTime:Br(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function zc(t,e,n){var r=e&&e[qc];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=ft(e),this.g=n,this.c=new Zi(null,r),this.b=[];var i=this;U(e[Wc]||[],(function(t){(t=$r(t))&&i.b.push(t)})),qr(this,"auth",this.a),qr(this,"session",this.c),qr(this,"hints",this.b)}Nc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Nc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Fc(this,!0,null,t.a),ke()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Fc(t,s,e,null)})).s((function(e){Fc(t,s,null,e)}))}(this,t,e):Ee(new C("invalid-auth-event")):(Fc(this,!1,null,null),ke())}else Ee(new C("invalid-auth-event"))},Nc.prototype.qa=function(){var t=this;return new ge((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new C("timeout");t.a&&t.a.cancel(),t.a=xn(kc.get()).then((function(){t.b||(t.g=!0,Fc(t,!0,null,e))}))}(t))}))},Lc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ma(t.c,null,t.a,t.b),ke()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.S(),t.i).then((function(t){e.ma(r,t,null,n)})).s((function(t){e.ma(r,null,t,n)}))}(t,e):Ee(new C("invalid-auth-event"))}else Ee(new C("invalid-auth-event"))},jc.prototype.confirm=function(t){return t=Oo(this.verificationId,t),this.a(t)};var Wc="mfaInfo",qc="mfaPendingCredential";function Hc(t,e,n,r){C.call(this,"multi-factor-auth-required",r,e),this.b=new zc(t,e,n),qr(this,"resolver",this.b)}function Gc(t,e,n){if(t&&d(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Hc(e,t.serverResponse,n,t.message)}catch(r){}return null}function Kc(){}function Xc(t){qr(this,"factorId",t.fa),this.a=t}function $c(t){if(Xc.call(this,t),this.a.fa!=Ro.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Yc(t,e){for(var n in Ge.call(this,t),e)this[n]=e[n]}function Qc(t,e){this.a=t,this.b=[],this.c=b(this.xc,this),on(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&U(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[Jr]=t.uid),t.displayName&&(r[Yr]=t.displayName),t.enrollmentTime&&(r[Qr]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[Zr]=t.phoneNumber);try{e=new ti(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),Jc(this,n)}function Jc(t,e){t.b=e,qr(t,"enrolledFactors",e)}function Zc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function tl(t){this.c=t,this.b=this.a=null}function el(t){return t.b&&1e3*t.b.c||0}function nl(t,e){var n=e.refreshToken;t.b=Li(e[Wa]||""),t.a=n}function rl(t,e){this.a=t||null,this.b=e||null,Hr(this,{lastSignInTime:Br(e||null),creationTime:Br(t||null)})}function il(t,e,n,r,i,o){Hr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ol(t,e,n){this.G=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null;var r=R6.a.SDK_VERSION?wr(R6.a.SDK_VERSION):null;this.a=new Ua(this.l,A(E),r),t.emulatorConfig&&$a(this.a,t.emulatorConfig),this.b=new tl(this.a),dl(this,e[Wa]),nl(this.b,e),qr(this,"refreshToken",this.b.a),ml(this,n||{}),gn.call(this),this.P=!1,this.o&&Er()&&(this.i=Oc(this.o,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new Zc((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=el(t.b)-w()-3e5;return 0<e?e:0}))}(this),this.$=b(this.gb,this);var i=this;this.pa=null,this.Ba=function(t){i.wa(t.h)},this.ba=null,this.za=function(t){$a(i.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){ul(i,t.f)},this.aa=null,this.N=new Qc(this,n),qr(this,"multiFactor",this.N)}function al(t,e){t.ba&&un(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&on(e,"languageCodeChanged",t.Ba)}function sl(t,e){t.W&&un(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&on(e,"emulatorConfigChanged",t.za)}function ul(t,e){t.X=e,Qa(t.a,R6.a.SDK_VERSION?wr(R6.a.SDK_VERSION,t.X):null)}function cl(t,e){t.aa&&un(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&on(e,"frameworkChanged",t.Aa)}function ll(t){try{return R6.a.app(t.m).auth()}catch(e){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function hl(t){t.A||t.u.b||(t.u.start(),un(t,"tokenChanged",t.$),on(t,"tokenChanged",t.$))}function fl(t){un(t,"tokenChanged",t.$),t.u.stop()}function dl(t,e){t.ya=e,qr(t,"_lat",e)}function pl(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return Ie(e).then((function(){return t}))}function vl(t){t.i&&!t.P&&(t.P=!0,wc(t.i,t))}function ml(t,e){Hr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new rl(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function gl(){}function yl(t){return ke().then((function(){if(t.A)throw new C("app-deleted")}))}function bl(t){return W(t.providerData,(function(t){return t.providerId}))}function _l(t,e){e&&(wl(t,e.providerId),t.providerData.push(e))}function wl(t,e){K(t.providerData,(function(t){return t.providerId==e}))}function xl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&qr(t,e,n)}function Cl(t,e){t!=e&&(Hr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),qr(t,"metadata",e.metadata?function(t){return new rl(t.a,t.b)}(e.metadata):new rl),U(e.providerData,(function(e){_l(t,e)})),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),qr(t,"refreshToken",t.b.a),Jc(t.N,e.N.b))}function kl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return Ks(t.a,ks,{idToken:e}).then(b(t.Jc,t))}(t,e).then((function(){return n||xl(t,"isAnonymous",!1),e}))}))}function El(t,e){e[Wa]&&t.ya!=e[Wa]&&(nl(t.b,e),t.dispatchEvent(new Yc("tokenChanged")),dl(t,e[Wa]),xl(t,"refreshToken",t.b.a))}function Sl(t,e){return kl(t).then((function(){if(H(bl(t),e))return pl(t).then((function(){throw new C("provider-already-linked")}))}))}function Il(t,e,n){return Gr({user:t,credential:No(e),additionalUserInfo:e=Wi(e),operationType:n})}function Tl(t,e){return El(t,e),t.reload().then((function(){return t}))}function Al(t,e,n,r,i){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));if(t.f&&!i)return Ee(t.f);var o=zi(n.providerId),a=Nr(t.uid+":::"),s=null;(!Tr()||pr())&&t.o&&n.isOAuthProvider&&(s=uu(t.o,t.l,t.m,e,n,null,a,R6.a.SDK_VERSION||null,null,null,t.tenantId));var u=cr(s,o&&o.ua,o&&o.ta);return r=r().then((function(){if(Ol(t),!i)return t.I().then((function(){}))})).then((function(){return Ec(t.i,u,e,n,a,!!s,t.tenantId)})).then((function(){return new ge((function(n,r){t.ma(e,null,new C("cancelled-popup-request"),t.h||null),t.g=n,t.O=r,t.h=a,t.c=Tc(t.i,t,e,u,a)}))})).then((function(t){return u&&ur(u),t?Gr(t):null})).s((function(t){throw u&&ur(u),t})),Nl(t,r,i)}function Rl(t,e,n,r,i){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));if(t.f&&!i)return Ee(t.f);var o=null,a=Nr(t.uid+":::");return r=r().then((function(){if(Ol(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,pl(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Ml,t.w(),e.a)),e})).then((function(){return Ic(t.i,e,n,a,t.tenantId)})).s((function(e){if(o=e,t.ha)return Fl(t.ha);throw o})).then((function(){if(o)throw o})),Nl(t,r,i)}function Ol(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function Nl(t,e,n){var r=function(t,e,n){return t.f&&!n?(e.cancel(),Ee(t.f)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new Yc("userInvalidated")),t.f=e),e}))}(t,e,n);return t.G.push(r),r.na((function(){G(t.G,r)})),r.s((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Gc(e.w(),ll(t),b(t.ic,t))),n||e}))}function Dl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Wa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=new ol(e,n,t);return t.providerData&&U(t.providerData,(function(t){t&&_l(r,Gr(t))})),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Pl(t){this.a=t,this.b=Wu()}zc.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then((function(t){var n=ft(e.f);return delete n[Wc],delete n[qc],pt(n,t),e.g(n)}))},x(Hc,C),Kc.prototype.rb=function(t,e,n){return e.type==to?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),pt(n,{phoneVerificationInfo:Ao(t.a)}),Ks(e,xs,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return pt(n={mfaPendingCredential:n},{phoneVerificationInfo:Ao(t.a)}),Ks(e,Cs,n)}))}(this,t,e)},x(Xc,Kc),x($c,Xc),x(Yc,Ge),(t=Qc.prototype).xc=function(t){Jc(this,function(t){var e=[];return U(t.mfaInfo||[],(function(t){(t=$r(t))&&e.push(t)})),e}(t.gd))},t.Qb=function(){return this.a.I().then((function(t){return new Zi(t,null)}))},t.ec=function(t,e){var n=this,r=this.a.a;return this.Qb().then((function(n){return t.rb(r,n,e)})).then((function(t){return El(n.a,t),n.a.reload()}))},t.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Ks(r,Gs,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return Jc(e,r),El(e.a,t),e.a.reload().s((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:W(this.b,(function(t){return t.w()}))}}},Zc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=xn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=a.document,e=null;return Fr()||!t?ke():new ge((function(n){e=function(){Fr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},Zc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},tl.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:el(this)}},tl.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ee(new C("user-token-expired")):t||!this.b||w()>el(this)-3e4?this.a?function(t,e){return function(t,e){return new ge((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ja(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r($s(t)):t.access_token&&t.refresh_token?n(t):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",Kn(e).toString(),t.g,t.v.get()):r(new C("internal-error"))}))}(t.c,e).then((function(e){return t.b=Li(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):ke(null):ke({accessToken:this.b.toString(),refreshToken:this.a})},rl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},x(ol,gn),ol.prototype.wa=function(t){this.pa=t,Xa(this.a,t)},ol.prototype.ka=function(){return this.pa},ol.prototype.Ga=function(){return $(this.X)},ol.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},qr(ol.prototype,"providerId","firebase"),(t=ol.prototype).reload=function(){var t=this;return Nl(this,yl(this).then((function(){return kl(t).then((function(){return pl(t)})).then(gl)})))},t.nc=function(t){return this.I(t).then((function(t){return new Uc(t)}))},t.I=function(t){var e=this;return Nl(this,yl(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new C("internal-error");return t.accessToken!=e.ya&&(dl(e,t.accessToken),e.dispatchEvent(new Yc("tokenChanged"))),xl(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Jc=function(t){if(!(t=t.users)||!t.length)throw new C("internal-error");ml(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new il(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)_l(this,e[n]);xl(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new Yc("userReloaded",{gd:t}))},t.Kc=function(t){return zr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},t.sb=function(t){var e=this,n=null;return Nl(this,t.c(this.a,this.uid).then((function(t){return El(e,t),n=Il(e,t,"reauthenticate"),e.f=null,e.reload()})).then((function(){return n})),!0)},t.Bc=function(t){return zr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return Nl(this,Sl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Il(e,t,"link"),Tl(e,t)})).then((function(){return n})))},t.Cc=function(t,e){var n=this;return Nl(this,Sl(this,"phone").then((function(){return Vc(ll(n),t,e,b(n.pb,n))})))},t.Lc=function(t,e){var n=this;return Nl(this,ke().then((function(){return Vc(ll(n),t,e,b(n.sb,n))})),!0)},t.Ab=function(t){var e=this;return Nl(this,this.I().then((function(n){return e.a.Ab(n,t)})).then((function(t){return El(e,t),e.reload()})))},t.dd=function(t){var e=this;return Nl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return El(e,t),e.reload()})))},t.Bb=function(t){var e=this;return Nl(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return El(e,t),e.reload()})))},t.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return yl(this);var e=this;return Nl(this,this.I().then((function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return El(e,t),xl(e,"displayName",t.displayName||null),xl(e,"photoURL",t.photoUrl||null),U(e.providerData,(function(t){"password"===t.providerId&&(qr(t,"displayName",e.displayName),qr(t,"photoURL",e.photoURL))})),pl(e)})).then(gl))},t.bd=function(t){var e=this;return Nl(this,kl(this).then((function(n){return H(bl(e),t)?function(t,e,n){return Ks(t,bs,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return U(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),U(bl(e),(function(t){n[t]||wl(e,t)})),n[Ro.PROVIDER_ID]||qr(e,"phoneNumber",null),pl(e)})):pl(e).then((function(){throw new C("no-such-provider")}))})))},t.delete=function(){var t=this;return Nl(this,this.I().then((function(e){return Ks(t.a,ys,{idToken:e})})).then((function(){t.dispatchEvent(new Yc("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");al(t,null),sl(t,null),cl(t,null),t.G=[],t.A=!0,fl(t),qr(t,"refreshToken",null),t.i&&xc(t.i,t)}))},t.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.h||null)==e&&this.g||"reauthViaPopup"==t&&(this.h||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.ma=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.h||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.h||null)?b(this.Jb,this):"reauthViaPopup"==t&&e==(this.h||null)?b(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?b(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?b(this.Kb,this):null},t.Dc=function(t){var e=this;return Al(this,"linkViaPopup",t,(function(){return Sl(e,t.providerId).then((function(){return pl(e)}))}),!1)},t.Mc=function(t){return Al(this,"reauthViaPopup",t,(function(){return ke()}),!0)},t.Ec=function(t){var e=this;return Rl(this,"linkViaRedirect",t,(function(){return Sl(e,t.providerId)}),!1)},t.Nc=function(t){return Rl(this,"reauthViaRedirect",t,(function(){return ke()}),!0)},t.Jb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Nl(this,this.I().then((function(n){return hs(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Il(i,t,"link"),Tl(i,t)})).then((function(){return o})))},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Nl(this,ke().then((function(){return ro(fs(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Il(i,t,"reauthenticate"),El(i,t),i.f=null,i.reload()})).then((function(){return o})),!0)},t.tb=function(t){var e=this,n=null;return Nl(this,this.I().then((function(e){return n=e,void 0===t||ht(t)?{}:Pi(new ki(t))})).then((function(t){return e.a.tb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Db=function(t,e){var n=this,r=null;return Nl(this,this.I().then((function(t){return r=t,void 0===e||ht(e)?{}:Pi(new ki(e))})).then((function(e){return n.a.Db(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.ic=function(t){var e=null,n=this;return Nl(this,t=ro(ke(t),n.uid).then((function(t){return e=Il(n,t,"reauthenticate"),El(n,t),n.f=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&pt(t,this.metadata.w()),U(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),pt(t,this.N.w()),t};var Ml={name:"redirectUser",D:"session"};function Fl(t){return Gu(t.b,Ml,t.a)}function Ll(t){this.a=t,this.b=Wu(),this.c=null,this.f=function(t){var e=Vl("local"),n=Vl("session"),r=Vl("none");return function(t,e,n){var r=Hu(e,n),i=qu(t,e.D);return t.get(e,n).then((function(o){var s=null;try{s=Or(a.localStorage.getItem(r))}catch(u){}if(s&&!o)return a.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(jl,t.a).then((function(t){return t?Vl(t):e}))}))}))})).then((function(e){return t.c=e,Bl(t,e.D)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Vl("local"),this.a,b(this.g,this))}function Bl(t,e){var n,r=[];for(n in Uu)Uu[n]!==e&&r.push(Gu(t.b,Vl(Uu[n]),t.a));return r.push(Gu(t.b,jl,t.a)),function(t){return new ge((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Se(t[s],_(o,s),a);else e(i)}))}(r)}Ll.prototype.g=function(){var t=this,e=Vl("local");ql(this,(function(){return ke().then((function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null})).then((function(n){if(n)return Bl(t,"local").then((function(){t.c=e}))}))}))};var jl={name:"persistence",D:"session"};function Vl(t){return{name:"authUser",D:t}}function Ul(t,e){return ql(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function zl(t){return ql(t,(function(){return Gu(t.b,t.c,t.a)}))}function Wl(t,e,n){return ql(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Dl(t||{})}))}))}function ql(t,e){return t.f=t.f.then(e,e),t.f}function Hl(t){if(this.m=!1,qr(this,"settings",new Bc),qr(this,"app",t),!Zl(this).options||!Zl(this).options.apiKey)throw new C("invalid-api-key");t=R6.a.SDK_VERSION?wr(R6.a.SDK_VERSION):null,this.a=new Ua(Zl(this).options&&Zl(this).options.apiKey,A(E),t),this.R=[],this.u=[],this.P=[],this.ac=R6.a.INTERNAL.createSubscribe(b(this.yc,this)),this.X=void 0,this.bc=R6.a.INTERNAL.createSubscribe(b(this.zc,this)),Ql(this,null),this.l=new Ll(Zl(this).options.apiKey+":"+Zl(this).name),this.G=new Pl(Zl(this).options.apiKey+":"+Zl(this).name),this.$=rh(this,function(t){var e=Zl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Ml,t.a).then((function(t){return t&&e&&(t.authDomain=e),Dl(t||{})}))}(t.G,Zl(t).options.authDomain).then((function(e){return(t.o=e)&&(e.ha=t.G),Fl(t.G)}));return rh(t,e)}(t).then((function(){return Wl(t.l,e,t.f)})).then((function(e){return e?(e.ha=t.G,t.o&&(t.o.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Ul(t.l,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:zl(t.l)}))):null})).then((function(e){Ql(t,e||null)}));return rh(t,n)}(this)),this.i=rh(this,function(t){return t.$.then((function(){return Yl(t)})).s((function(){})).then((function(){if(!t.m)return t.pa()})).s((function(){})).then((function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(Vl("local"),e.a,t.pa)}}))}(this)),this.ba=!1,this.pa=b(this.Yc,this),this.Ba=b(this.da,this),this.ya=b(this.kc,this),this.za=b(this.vc,this),this.Aa=b(this.wc,this),this.b=null,function(t){var e=Zl(t).options.authDomain,n=Zl(t).options.apiKey;e&&Er()&&(t.gb=t.$.then((function(){if(!t.m){if(t.b=Oc(e,n,Zl(t).name,t.f),wc(t.b,t),th(t)&&vl(th(t)),t.o){vl(t.o);var r=t.o;r.wa(t.ka()),al(r,t),ul(r=t.o,t.N),cl(r,t),$a((r=t.o).a,t.f),sl(r,t),t.o=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=b(this.delete,this),this.INTERNAL.logFramework=b(this.Fc,this),this.A=0,gn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function Gl(t){Ge.call(this,"languageCodeChanged"),this.h=t}function Kl(t){Ge.call(this,"emulatorConfigChanged"),this.c=t}function Xl(t){Ge.call(this,"frameworkChanged"),this.f=t}function $l(t){return t.gb||Ee(new C("auth-domain-config-required"))}function Yl(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=$l(t).then((function(){return t.b.qa()})).then((function(t){return t?Gr(t):null}));return rh(t,e)}function Ql(t,e){th(t)&&(function(t,e){K(t.R,(function(t){return t==e}))}(th(t),t.Ba),un(th(t),"tokenChanged",t.ya),un(th(t),"userDeleted",t.za),un(th(t),"userInvalidated",t.Aa),fl(th(t))),e&&(e.R.push(t.Ba),on(e,"tokenChanged",t.ya),on(e,"userDeleted",t.za),on(e,"userInvalidated",t.Aa),0<t.A&&hl(e)),qr(t,"currentUser",e),e&&(e.wa(t.ka()),al(e,t),ul(e,t.N),cl(e,t),$a(e.a,t.f),sl(e,t))}function Jl(t,e){var n=null,r=null;return rh(t,e.then((function(e){return n=No(e),r=Wi(e),function(t,e){var n={};return n.apiKey=Zl(t).options.apiKey,n.authDomain=Zl(t).options.authDomain,n.appName=Zl(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then((function(){return function(t,e,n,r){var i=new ol(t,e);return n&&(i.ha=n),r&&ul(i,r),i.reload().then((function(){return i}))}(n,e,t.G,t.Ga())})).then((function(e){return th(t)&&e.uid==th(t).uid?(Cl(th(t),e),t.da(e)):(Ql(t,e),vl(e),t.da(e))})).then((function(){nh(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Gc(e.w(),t,b(t.jc,t))),n||e})).then((function(){return Gr({user:th(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Zl(t){return t.app}function th(t){return t.currentUser}function eh(t){return th(t)&&th(t)._lat||null}function nh(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](eh(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](eh(t))}}function rh(t,e){return t.R.push(e),e.na((function(){G(t.R,e)})),e}function ih(){}function oh(){this.a={},this.b=1e12}Ll.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");t:{for(r in Uu)if(Uu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(mr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!_u()&&"none"!==t)throw n;break;default:if(!kr()&&"none"!==t)throw n}}(t),ql(this,(function(){return t!=n.c.D?n.b.get(n.c,n.a).then((function(r){return e=r,Bl(n,t)})).then((function(){if(n.c=Vl(t),e)return n.b.set(n.c,e,n.a)})):ke()}))},x(Hl,gn),x(Gl,Ge),x(Kl,Ge),x(Xl,Ge),(t=Hl.prototype).wb=function(t){return rh(this,t=this.l.wb(t))},t.wa=function(t){this.aa===t||this.m||(this.aa=t,Xa(this.a,this.aa),this.dispatchEvent(new Gl(this.ka())))},t.ka=function(){return this.aa},t.ed=function(){var t=a.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.fd=function(t){if(!this.f){if(!/^https?:\/\//.test(t))throw new C("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Lr("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&fr().then((function(){var t=a.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),a.document.body.appendChild(t)})),this.f={url:t},this.settings.hb=!0,$a(this.a,this.f),this.dispatchEvent(new Kl(this.f))}},t.Fc=function(t){this.N.push(t),Qa(this.a,R6.a.SDK_VERSION?wr(R6.a.SDK_VERSION,this.N):null),this.dispatchEvent(new Xl(this.N))},t.Ga=function(){return $(this.N)},t.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},t.S=function(){return this.W},t.toJSON=function(){return{apiKey:Zl(this).options.apiKey,authDomain:Zl(this).options.authDomain,appName:Zl(this).name,currentUser:th(this)&&th(this).w()}},t.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==e&&!!this.g;default:return!1}},t.ma=function(t,e,n,r){"signInViaPopup"==t&&this.h==r&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.h==e&&this.g?b(this.hc,this):null},t.hc=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return Jl(i,ls(i.a,o))}))},t.Wc=function(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=this,n=zi(t.providerId),r=Nr(),i=null;(!Tr()||pr())&&Zl(this).options.authDomain&&t.isOAuthProvider&&(i=uu(Zl(this).options.authDomain,Zl(this).options.apiKey,Zl(this).name,"signInViaPopup",t,null,r,R6.a.SDK_VERSION||null,null,null,this.S(),this.f));var o=cr(i,n&&n.ua,n&&n.ta);return rh(this,n=$l(this).then((function(n){return Ec(n,o,"signInViaPopup",t,r,!!i,e.S())})).then((function(){return new ge((function(t,n){e.ma("signInViaPopup",null,new C("cancelled-popup-request"),e.h),e.g=t,e.O=n,e.h=r,e.c=Tc(e.b,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&ur(o),t?Gr(t):null})).s((function(t){throw o&&ur(o),t})))},t.Xc=function(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=this;return rh(this,$l(this).then((function(){return function(t){return ql(t,(function(){return t.b.set(jl,t.c.D,t.a)}))}(e.l)})).then((function(){return Ic(e.b,"signInViaRedirect",t,void 0,e.S())})))},t.qa=function(){var t=this;return Yl(this).then((function(e){return t.b&&Pc(t.b.b),e})).s((function(e){throw t.b&&Pc(t.b.b),e}))},t.cd=function(t){if(!t)return Ee(new C("null-user"));if(this.W!=t.tenantId)return Ee(new C("tenant-id-mismatch"));var e=this,n={};n.apiKey=Zl(this).options.apiKey,n.authDomain=Zl(this).options.authDomain,n.appName=Zl(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Wa]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ol(e||{apiKey:t.l,authDomain:t.o,appName:t.m},o),n&&(e.ha=n),r&&ul(e,r),Cl(e,t),e}(t,n,e.G,e.Ga());return rh(this,this.i.then((function(){if(Zl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return th(e)&&t.uid==th(e).uid?(Cl(th(e),t),e.da(t)):(Ql(e,r),vl(r),e.da(r))})).then((function(){nh(e)})))},t.zb=function(){var t=this;return rh(this,this.i.then((function(){return t.b&&Pc(t.b.b),th(t)?(Ql(t,null),zl(t.l).then((function(){nh(t)}))):ke()})))},t.Yc=function(){var t=this;return Wl(this.l,Zl(this).options.authDomain).then((function(e){if(!t.m){var n;if(n=th(t)&&e){n=th(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Cl(th(t),e),th(t).I();(th(t)||e)&&(Ql(t,e),e&&(vl(e),e.ha=t.G),t.b&&wc(t.b,t),nh(t))}}))},t.da=function(t){return Ul(this.l,t)},t.kc=function(){nh(this),this.da(th(this))},t.vc=function(){this.zb()},t.wc=function(){this.zb()},t.jc=function(t){var e=this;return this.i.then((function(){return Jl(e,ke(t))}))},t.yc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(th(e))}))},t.zc=function(t){var e=this;!function(t,e){t.P.push(e),rh(t,t.i.then((function(){!t.m&&H(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(eh(t)))})))}(this,(function(){t.next(th(e))}))},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(th(r)):"function"==typeof t.next&&t.next(th(r))})),this.ac(t,e,n)},t.Gc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(th(r)):"function"==typeof t.next&&t.next(th(r))})),this.bc(t,e,n)},t.mc=function(t){var e=this;return rh(this,this.i.then((function(){return th(e)?th(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Sc=function(t){var e=this;return this.i.then((function(){return Jl(e,Ks(e.a,Us,{token:t}))})).then((function(t){var n=t.user;return xl(n,"isAnonymous",!1),e.da(n),t}))},t.Tc=function(t,e){var n=this;return this.i.then((function(){return Jl(n,Ks(n.a,zs,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.i.then((function(){return Jl(n,Ks(n.a,ms,{email:t,password:e}))}))},t.Za=function(t){var e=this;return this.i.then((function(){return Jl(e,t.ja(e.a))}))},t.Rc=function(t){return zr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},t.yb=function(){var t=this;return this.i.then((function(){var e=th(t);if(e&&e.isAnonymous){var n=Gr({providerId:null,isNewUser:!1});return Gr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Jl(t,t.a.yb()).then((function(e){var n=e.user;return xl(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return th(this)&&th(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&th(this)&&hl(th(this))},t.Oc=function(t){var e=this;U(this.u,(function(n){n==t&&e.A--})),0>this.A&&(this.A=0),0==this.A&&th(this)&&fl(th(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.u.push(t),rh(this,this.i.then((function(){e.m||H(e.u,t)&&t(eh(e))})))},t.removeAuthTokenListener=function(t){K(this.u,(function(e){return e==t}))},t.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(Vl("local"),t.a,this.pa),this.b&&(xc(this.b,this),Pc(this.b.b)),Promise.resolve()},t.gc=function(t){return rh(this,function(t,e){return Ks(t,gs,{identifier:e,continueUri:Sr()?or():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Ac=function(t){return!!So(t)},t.vb=function(t,e){var n=this;return rh(this,ke().then((function(){var t=new ki(e);if(!t.c)throw new C("argument-error",Ii+" must be true when sending sign in link to email");return Pi(t)})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.hd=function(t){return this.Qa(t).then((function(t){return t.data.email}))},t.mb=function(t,e){return rh(this,this.a.mb(t,e).then((function(){})))},t.Qa=function(t){return rh(this,this.a.Qa(t).then((function(t){return new ei(t)})))},t.ib=function(t){return rh(this,this.a.ib(t).then((function(){})))},t.ub=function(t,e){var n=this;return rh(this,ke().then((function(){return void 0===e||ht(e)?{}:Pi(new ki(e))})).then((function(e){return n.a.ub(t,e)})).then((function(){})))},t.Vc=function(t,e){return rh(this,Vc(this,t,e,b(this.Za,this)))},t.Uc=function(t,e){var n=this;return rh(this,ke().then((function(){var r=e||or(),i=Eo(t,r);if(!(r=So(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new C("tenant-id-mismatch");return n.Za(i)})))},ih.prototype.render=function(){},ih.prototype.reset=function(){},ih.prototype.getResponse=function(){},ih.prototype.execute=function(){};var ah=null;function sh(t,e){return(e=uh(e))&&t.a[e]||null}function uh(t){return(t=void 0===t?1e12:t)?t.toString():null}function ch(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ie(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():on(this.f,"click",this.i)}function lh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function hh(){}function fh(){}oh.prototype.render=function(t,e){return this.a[this.b.toString()]=new ch(t,e),this.b++},oh.prototype.reset=function(t){var e=sh(this,t);t=uh(t),e&&t&&(e.delete(),delete this.a[t])},oh.prototype.getResponse=function(t){return(t=sh(this,t))?t.getResponse():null},oh.prototype.execute=function(t){(t=sh(this,t))&&t.execute()},ch.prototype.getResponse=function(){return lh(this),this.b},ch.prototype.execute=function(){lh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},ch.prototype.delete=function(){lh(this),this.g=!0,clearTimeout(this.a),this.a=null,un(this.f,"click",this.i)},qr(hh,"FACTOR_ID","phone"),fh.prototype.g=function(){return ah||(ah=new oh),ke(ah)},fh.prototype.c=function(){};var dh=null;function ph(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var vh=new mt(bt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),mh=new Mr(3e4,6e4);ph.prototype.g=function(t){var e=this;return new ge((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),mh.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete a[e.a]},ke(Pa(Ct(vh,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(a.grecaptcha))}))},ph.prototype.c=function(){this.b--};var gh=null;function yh(t,e,n,r,i,o,s){if(qr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,s?(dh||(dh=new fh),s=dh):(gh||(gh=new ph),s=gh),this.v=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[wh])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[xh],!a.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ie(e)||!this.i&&ie(e).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Ua(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[bh];this.a[bh]=function(t){if(Ch(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Cr(c,a);"function"==typeof e&&e(t)}};var l=this.a[_h];this.a[_h]=function(){if(Ch(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=Cr(l,a);"function"==typeof t&&t()}}}var bh="callback",_h="expired-callback",wh="sitekey",xh="size";function Ch(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function kh(t,e){return t.h.push(e),e.na((function(){G(t.h,e)})),e}function Eh(t){if(t.A)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function Sh(t,e,n){var r=!1;try{this.b=n||R6.a.app()}catch(a){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(a){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=R6.a.SDK_VERSION?wr(R6.a.SDK_VERSION,o):null,yh.call(this,n,t,e,(function(){try{var t=i.b.auth().ka()}catch(e){t=null}return t}),o,A(E),r)}function Ih(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!o){if(e=e[i],0>i||i>=Th.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=Th[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new C("argument-error",t+" failed: "+r)}(t=yh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=kh(this,ke().then((function(){if(Sr()&&!vr())return fr();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.v.g(t.u())})).then((function(e){return t.g=e,Ks(t.o,Rs,{})})).then((function(e){t.a[wh]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},t.render=function(){Eh(this);var t=this;return kh(this,this.Ia().then((function(){if(null===t.c){var e=t.m;if(!t.i){var n=ie(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!re&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Vt(a.name),'"'),a.type){o.push(' type="',Vt(a.type),'"');var s={};pt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=le(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):oe(o,a)),2<r.length&&ce(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Eh(this);var t=this;return kh(this,this.render().then((function(e){return new ge((function(n){var r=t.g.getResponse(e);if(r)n(r);else{t.l.push((function e(r){r&&(function(t,e){K(t.l,(function(t){return t==e}))}(t,e),n(r))})),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Eh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Eh(this),this.A=!0,this.v.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ie(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},x(Sh,yh);var Th="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ah(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Rh(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Oh(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:d}}function Nh(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function Dh(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Ph(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){return!!e&&!(!e.ja||t&&e.providerId!==t)}}}function Mh(t,e){return d(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Fh(t){return d(t)&&"string"==typeof t.uid}function Lh(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function Bh(t,e){for(var n in e){var r=e[n].name;t[r]=Uh(r,t[n],e[n].j)}}function jh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:_((function(t){return this[t]}),n),set:_((function(t,e,n,r){Ih(t,[n],[r],!0),this[e]=r}),r,n,e[n].jb),enumerable:!0})}}function Vh(t,e,n,r){t[e]=Uh(e,n,r)}function Uh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Ih(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Bh(Hl.prototype,{ib:{name:"applyActionCode",j:[Ah("code")]},Qa:{name:"checkActionCode",j:[Ah("code")]},mb:{name:"confirmPasswordReset",j:[Ah("code"),Ah("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ah("email"),Ah("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Ah("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Ah("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Lh(Oh(),Nh(),"nextOrObserver"),Nh("opt_error",!0),Nh("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Lh(Oh(),Nh(),"nextOrObserver"),Nh("opt_error",!0),Nh("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Ah("email"),Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Ah("email"),Oh("actionCodeSettings")]},wb:{name:"setPersistence",j:[Ah("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Ph()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Ph()]},Sc:{name:"signInWithCustomToken",j:[Ah("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Ah("email"),Ah("password")]},Uc:{name:"signInWithEmailLink",j:[Ah("email"),Ah("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[Lh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ol)}},Dh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ah(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Ah("url")]},hd:{name:"verifyPasswordResetCode",j:[Ah("code")]}}),jh(Hl.prototype,{lc:{name:"languageCode",jb:Lh(Ah(),Dh(),"languageCode")},ti:{name:"tenantId",jb:Lh(Ah(),Dh(),"tenantId")}}),(Hl.Persistence=Uu).LOCAL="local",Hl.Persistence.SESSION="session",Hl.Persistence.NONE="none",Bh(ol.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Rh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Rh("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Ph()]},pb:{name:"linkWithCredential",j:[Ph()]},Cc:{name:"linkWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Ph()]},sb:{name:"reauthenticateWithCredential",j:[Ph()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Ah("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ah(null,!0)]},bd:{name:"unlink",j:[Ah("provider")]},Ab:{name:"updateEmail",j:[Ah("email")]},Bb:{name:"updatePassword",j:[Ah("password")]},dd:{name:"updatePhoneNumber",j:[Ph("phone")]},Cb:{name:"updateProfile",j:[Oh("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Ah("email"),Lh(Oh("opt_actionCodeSettings",!0),Dh(null,!0),"opt_actionCodeSettings",!0)]}}),Bh(oh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(ih.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(ge.prototype,{na:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),jh(Bc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Rh("appVerificationDisabledForTesting")}}),Bh(jc.prototype,{confirm:{name:"confirm",j:[Ah("verificationCode")]}}),Vh(no,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[co,Co,To,ao],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Lh(Ah(),Oh(),"json")]),Vh(ko,"credential",(function(t,e){return new xo(t,e)}),[Ah("email"),Ah("password")]),Bh(xo.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(po.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(po,"credential",vo,[Lh(Ah(),Oh(),"token")]),Vh(ko,"credentialWithLink",Eo,[Ah("email"),Ah("emailLink")]),Bh(mo.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(mo,"credential",go,[Lh(Ah(),Oh(),"token")]),Bh(yo.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(yo,"credential",bo,[Lh(Ah(),Lh(Oh(),Dh()),"idToken"),Lh(Ah(),Dh(),"accessToken",!0)]),Bh(_o.prototype,{Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Vh(_o,"credential",wo,[Lh(Ah(),Oh(),"token"),Ah("secret",!0)]),Bh(fo.prototype,{Ca:{name:"addScope",j:[Ah("scope")]},credential:{name:"credential",j:[Lh(Ah(),Lh(Oh(),Dh()),"optionsOrIdToken"),Lh(Ah(),Dh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Oh("customOAuthParameters")]}}),Bh(so.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(io.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Vh(Ro,"credential",Oo,[Ah("verificationId"),Ah("verificationCode")]),Bh(Ro.prototype,{eb:{name:"verifyPhoneNumber",j:[Lh(Ah(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Mh(t.session,to)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Mh(t.session,eo)&&Fh(t.multiFactorHint):t.session&&t.multiFactorUid?Mh(t.session,eo)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Bh(Io.prototype,{w:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(C.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(Vo.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(jo.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(Hc.prototype,{toJSON:{name:"toJSON",j:[Ah(null,!0)]}}),Bh(zc.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),Bh(Qc.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Ah("displayName",!0)]},ad:{name:"unenroll",j:[Lh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Fh},Ah(),"multiFactorInfoIdentifier")]}}),Bh(Sh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Vh(vi,"parseLink",Ci,[Ah("link")]),Vh(hh,"assertion",(function(t){return new $c(t)}),[Ph("phone")]),function(){if(void 0===R6.a||!R6.a.INTERNAL||!R6.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ri,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ni,VERIFY_AND_CHANGE_EMAIL:ii,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Hl,AuthCredential:no,Error:C};Vh(t,"EmailAuthProvider",ko,[]),Vh(t,"FacebookAuthProvider",po,[]),Vh(t,"GithubAuthProvider",mo,[]),Vh(t,"GoogleAuthProvider",yo,[]),Vh(t,"TwitterAuthProvider",_o,[]),Vh(t,"OAuthProvider",fo,[Ah("providerId")]),Vh(t,"SAMLAuthProvider",ho,[Ah("providerId")]),Vh(t,"PhoneAuthProvider",Ro,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Hl)}}]),Vh(t,"RecaptchaVerifier",Sh,[Lh(Ah(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Oh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof R6.a.app.App)}}]),Vh(t,"ActionCodeURL",vi,[]),Vh(t,"PhoneMultiFactorGenerator",hh,[]),R6.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Hl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),R6.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:b((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:b(t.mc,t),addAuthTokenListener:b(t.cc,t),removeAuthTokenListener:b(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),R6.a.registerVersion("@firebase/auth","0.15.1"),R6.a.INTERNAL.extendNamespace({User:ol})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n("6Uf2");var O6=n("q/0M"),N6=n("qOnz"),D6=function(t,e){return(D6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function P6(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var M6,F6="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},L6=L6||{},B6=F6||self;function j6(){}function V6(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function U6(t){var e=V6(t);return"array"==e||"object"==e&&"number"==typeof t.length}function z6(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var W6="closure_uid_"+(1e9*Math.random()>>>0),q6=0;function H6(t,e,n){return t.call.apply(t.bind,arguments)}function G6(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function K6(t,e,n){return(K6=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?H6:G6).apply(null,arguments)}function X6(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var $6=Date.now;function Y6(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function Q6(){this.j=this.j,this.i=this.i}Q6.prototype.j=!1,Q6.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,W6)&&t[W6]||(t[W6]=++q6)}(this)},Q6.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var J6=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Z6=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function t8(t){return Array.prototype.concat.apply([],arguments)}function e8(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function n8(t){return/^[\s\xa0]*$/.test(t)}var r8,i8=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function o8(t,e){return-1!=t.indexOf(e)}function a8(t,e){return t<e?-1:t>e?1:0}t:{var s8=B6.navigator;if(s8){var u8=s8.userAgent;if(u8){r8=u8;break t}}r8=""}function c8(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function l8(t){var e={};for(var n in t)e[n]=t[n];return e}var h8="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function f8(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<h8.length;o++)n=h8[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function d8(t){return d8[" "](t),t}d8[" "]=j6;var p8,v8,m8=o8(r8,"Opera"),g8=o8(r8,"Trident")||o8(r8,"MSIE"),y8=o8(r8,"Edge"),b8=y8||g8,_8=o8(r8,"Gecko")&&!(o8(r8.toLowerCase(),"webkit")&&!o8(r8,"Edge"))&&!(o8(r8,"Trident")||o8(r8,"MSIE"))&&!o8(r8,"Edge"),w8=o8(r8.toLowerCase(),"webkit")&&!o8(r8,"Edge");function x8(){var t=B6.document;return t?t.documentMode:void 0}t:{var C8="",k8=(v8=r8,_8?/rv:([^\);]+)(\)|;)/.exec(v8):y8?/Edge\/([\d\.]+)/.exec(v8):g8?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(v8):w8?/WebKit\/(\S+)/.exec(v8):m8?/(?:Version)[ \/]?(\S+)/.exec(v8):void 0);if(k8&&(C8=k8?k8[1]:""),g8){var E8=x8();if(null!=E8&&E8>parseFloat(C8)){p8=String(E8);break t}}p8=C8}var S8={};function I8(t){return function(t,e){var n=S8;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=i8(String(p8)).split("."),r=i8(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=a8(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||a8(0==a[2].length,0==s[2].length)||a8(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var T8=B6.document&&g8&&(x8()||parseInt(p8,10))||void 0,A8=!g8||9<=Number(T8),R8=g8&&!I8("9"),O8=function(){if(!B6.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{B6.addEventListener("test",j6,e),B6.removeEventListener("test",j6,e)}catch(n){}return t}();function N8(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function D8(t,e){if(N8.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(_8){t:{try{d8(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:P8[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}N8.prototype.b=function(){this.defaultPrevented=!0},Y6(D8,N8);var P8={2:"touch",3:"pen",4:"mouse"};D8.prototype.b=function(){D8.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,R8)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var M8="closure_listenable_"+(1e6*Math.random()|0),F8=0;function L8(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++F8,this.Y=this.Z=!1}function B8(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function j8(t){this.src=t,this.a={},this.b=0}function V8(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=J6(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(B8(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function U8(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}j8.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=U8(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new L8(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var z8="closure_lm_"+(1e6*Math.random()|0),W8={};function q8(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=J8(r),e&&e[M8]?e.wa(n,r,z6(i)?!!i.capture:!!i,o):H8(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)q8(t,e[o],n,r,i);return null}return n=J8(n),t&&t[M8]?t.va(e,n,z6(r)?!!r.capture:!!r,i):H8(t,e,n,!1,r,i)}function H8(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=z6(i)?!!i.capture:!!i;if(a&&!A8)return null;var s=Y8(t);if(s||(t[z8]=s=new j8(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=$8,e=A8?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)O8||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(K8(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function G8(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[M8])V8(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(K8(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Y8(e))?(V8(n,t),0==n.b&&(n.src=null,e[z8]=null)):B8(t)}}}function K8(t){return t in W8?W8[t]:W8[t]="on"+t}function X8(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&G8(t),n.call(r,e)}function $8(t,e){if(t.Y)return!0;if(!A8){if(!e)t:{e=["window","event"];for(var n=B6,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return X8(t,e=new D8(e,this))}return X8(t,new D8(e,this))}function Y8(t){return(t=t[z8])instanceof j8?t:null}var Q8="__closure_events_fn_"+(1e9*Math.random()>>>0);function J8(t){return"function"==V6(t)?t:(t[Q8]||(t[Q8]=function(e){return t.handleEvent(e)}),t[Q8])}function Z8(){Q6.call(this),this.c=new j8(this),this.J=this,this.C=null}function t7(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ca||a.src;a.Z&&V8(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}Y6(Z8,Q6),Z8.prototype[M8]=!0,(M6=Z8.prototype).addEventListener=function(t,e,n,r){q8(this,t,e,n,r)},M6.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=z6(i)?!!i.capture:!!i,r=J8(r),e&&e[M8]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=U8(a=e.a[n],r,i,o))&&(B8(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=Y8(e))&&(n=e.a[n.toString()],e=-1,n&&(e=U8(n,r,i,o)),(r=-1<e?n[e]:null)&&G8(r))}(this,t,e,n,r)},M6.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new N8(t,n);else if(t instanceof N8)t.target=t.target||n;else{var i=t;f8(t=new N8(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=t7(a,r,!0,t)&&i}if(i=t7(a=t.a=n,r,!0,t)&&i,i=t7(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=t7(a=t.a=e[o],r,!1,t)&&i;return i},M6.G=function(){if(Z8.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)B8(n[r]);delete e.a[t],e.b--}}this.C=null},M6.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},M6.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var e7=B6.JSON.stringify;function n7(){this.b=this.a=null}var r7,i7=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new a7}),(function(t){t.reset()}),100);function o7(){var t=l7,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function a7(){this.next=this.b=this.a=null}function s7(t){B6.setTimeout((function(){throw t}),0)}function u7(t,e){r7||function(){var t=B6.Promise.resolve(void 0);r7=function(){t.then(h7)}}(),c7||(r7(),c7=!0),l7.add(t,e)}n7.prototype.add=function(t,e){var n=i7.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},a7.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},a7.prototype.reset=function(){this.next=this.b=this.a=null};var c7=!1,l7=new n7;function h7(){for(var t;t=o7();){try{t.a.call(t.b)}catch(n){s7(n)}var e=i7;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}c7=!1}function f7(t,e){Z8.call(this),this.b=t||1,this.a=e||B6,this.f=K6(this.Ya,this),this.g=$6()}function d7(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function p7(t,e,n){if("function"==V6(t))n&&(t=K6(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=K6(t.handleEvent,t)}return 2147483647<Number(e)?-1:B6.setTimeout(t,e||0)}function v7(t){t.a=p7((function(){t.a=null,t.c&&(t.c=!1,v7(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Y6(f7,Z8),(M6=f7.prototype).aa=!1,M6.M=null,M6.Ya=function(){if(this.aa){var t=$6()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(d7(this),this.start()))}},M6.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=$6())},M6.G=function(){f7.S.G.call(this),d7(this),delete this.a};var m7=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}D6(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:v7(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(B6.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(Q6);function g7(t){Q6.call(this),this.b=t,this.a={}}Y6(g7,Q6);var y7=[];function b7(t,e,n,r){Array.isArray(n)||(n&&(y7[0]=n.toString()),n=y7);for(var i=0;i<n.length;i++){var o=q8(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function _7(t){c8(t.a,(function(t,e){this.a.hasOwnProperty(e)&&G8(t)}),t),t.a={}}function w7(){this.a=!0}function x7(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return e7(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}g7.prototype.G=function(){g7.S.G.call(this),_7(this)},g7.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},w7.prototype.info=function(){};var C7=null;function k7(){return C7=C7||new Z8}function E7(t){N8.call(this,"serverreachability",t)}function S7(t){var e=k7();e.dispatchEvent(new E7(e,t))}function I7(t){N8.call(this,"statevent",t)}function T7(t){var e=k7();e.dispatchEvent(new I7(e,t))}function A7(t){N8.call(this,"timingevent",t)}function R7(t,e){if("function"!=V6(t))throw Error("Fn must not be null and must be a function");return B6.setTimeout((function(){t()}),e)}Y6(E7,N8),Y6(I7,N8),Y6(A7,N8);var O7={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},N7={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function D7(){}function P7(){}D7.prototype.a=null;var M7,F7={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function L7(){N8.call(this,"d")}function B7(){N8.call(this,"c")}function j7(){}function V7(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new g7(this),this.P=U7,this.R=new f7(t=b8?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}Y6(L7,N8),Y6(B7,N8),Y6(j7,D7),M7=new j7;var U7=45e3,z7={},W7={};function q7(t,e,n){t.H=1,t.i=f9(a9(e)),t.j=n,t.I=!0,H7(t,null)}function H7(t,e){t.u=$6(),X7(t),t.l=a9(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),E9(n.b,"t",r),t.D=0,t.a=btt(t.g,t.g.C?e:null),0<t.O&&(t.F=new m7(K6(t.Ca,t,t.a),t.O)),b7(t.J,t.a,"readystatechange",t.Wa),e=t.B?l8(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),S7(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.T,t.j)}function G7(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=K7(t,n);if(i==W7){4==e&&(t.h=4,T7(14),r=!1),x7(t.c,t.f,null,"[Incomplete Response]");break}if(i==z7){t.h=4,T7(15),x7(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}x7(t.c,t.f,i,null),Z7(t,i)}4==e&&0==n.length&&(t.h=1,T7(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),htt(e),e.F=!0)):(x7(t.c,t.f,n,"[Invalid Chunked Response]"),J7(t),Q7(t))}function K7(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?W7:(n=Number(e.substring(n,r)),isNaN(n)?z7:(r+=1)+n>e.length?W7:(e=e.substr(r,n),t.D=r+n,e))}function X7(t){t.U=$6()+t.P,$7(t,t.P)}function $7(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=R7(K6(t.Ua,t),e)}function Y7(t){t.o&&(B6.clearTimeout(t.o),t.o=null)}function Q7(t){0==t.g.v||t.A||ptt(t.g,t)}function J7(t){Y7(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,d7(t.R),_7(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Z7(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||N9(n.b,t)))if(n.I=t.N,!t.C&&N9(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(m){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;dtt(n),ntt(n)}ltt(n),T7(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=R7(K6(n.Ra,n),6e3));if(1>=O9(n.b)&&n.ea){try{n.ea()}catch(m){}n.ea=void 0}}else mtt(n,11)}else if((t.C||n.a==t)&&dtt(n),!n8(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(o8(l,"spdy")||o8(l,"quic")||o8(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(D9(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,h9(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=$6()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=ytt(u,u.C?u.ga:null,u.fa),d.C){P9(u.b,d);var p=d,v=u.D;v&&p.setTimeout(v),p.o&&(Y7(p),X7(p)),u.a=d}else ctt(u);0<n.g.length&&ott(n)}else"stop"!=i[0]&&"close"!=i[0]||mtt(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?mtt(n,7):ett(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);S7(4)}catch(m){}}function t9(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(U6(t)||"string"==typeof t)Z6(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(U6(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(U6(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function e9(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof e9)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function n9(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];r9(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r9(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function r9(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(M6=V7.prototype).setTimeout=function(t){this.P=t},M6.Wa=function(t){t=t.target;var e=this.F;e&&3==Q9(t)?e.f():this.Ca(t)},M6.Ca=function(t){try{if(t==this.a)t:{var e=Q9(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!b8&&!this.a.$())){this.A||4!=e||7==n||S7(8==n||0>=r?3:2),Y7(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!n8(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,T7(12),J7(this),Q7(this);break t}x7(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Z7(this,u)}this.I?(G7(this,e,o),b8&&this.b&&3==e&&(b7(this.J,this.R,"tick",this.Va),this.R.start())):(x7(this.c,this.f,o,null),Z7(this,o)),4==e&&J7(this),this.b&&!this.A&&(4==e?ptt(this.g,this):(this.b=!1,X7(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,T7(12)):(this.h=0,T7(13)),J7(this),Q7(this)}}}catch(oF){}},M6.Va=function(){if(this.a){var t=Q9(this.a),e=this.a.$();this.D<e.length&&(Y7(this),G7(this,t,e),this.b&&4!=t&&X7(this))}},M6.cancel=function(){this.A=!0,J7(this)},M6.Ua=function(){this.o=null;var t=$6();0<=t-this.U?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(S7(3),T7(17)),J7(this),this.h=2,Q7(this)):$7(this,this.U-t)},(M6=e9.prototype).K=function(){n9(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},M6.L=function(){return n9(this),this.a.concat()},M6.get=function(t,e){return r9(this.b,t)?this.b[t]:e},M6.set=function(t,e){r9(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},M6.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var i9=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function o9(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof o9){this.a=void 0!==e?e:t.a,s9(this,t.f),this.j=t.j,u9(this,t.c),c9(this,t.h),this.g=t.g,e=t.b;var n=new w9;n.c=e.c,e.a&&(n.a=new e9(e.a),n.b=e.b),l9(this,n),this.i=t.i}else t&&(n=String(t).match(i9))?(this.a=!!e,s9(this,n[1]||"",!0),this.j=d9(n[2]||""),u9(this,n[3]||"",!0),c9(this,n[4]),this.g=d9(n[5]||"",!0),l9(this,n[6]||"",!0),this.i=d9(n[7]||"")):(this.a=!!e,this.b=new w9(null,this.a))}function a9(t){return new o9(t)}function s9(t,e,n){t.f=n?d9(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function u9(t,e,n){t.c=n?d9(e,!0):e}function c9(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function l9(t,e,n){e instanceof w9?(t.b=e,function(t,e){e&&!t.f&&(x9(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(C9(this,e),E9(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=p9(e,b9)),t.b=new w9(e,t.a))}function h9(t,e,n){t.b.set(e,n)}function f9(t){return h9(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^$6()).toString(36)),t}function d9(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function p9(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,v9),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function v9(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}o9.prototype.toString=function(){var t=[],e=this.f;e&&t.push(p9(e,m9,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(p9(e,m9,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(p9(n,"/"==n.charAt(0)?y9:g9,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",p9(n,_9)),t.join("")};var m9=/[#\/\?@]/g,g9=/[#\?:]/g,y9=/[#\?]/g,b9=/[#\?@]/g,_9=/#/g;function w9(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function x9(t){t.a||(t.a=new e9,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function C9(t,e){x9(t),e=S9(t,e),r9(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,r9((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&n9(t)))}function k9(t,e){return x9(t),e=S9(t,e),r9(t.a.b,e)}function E9(t,e,n){C9(t,e),0<n.length&&(t.c=null,t.a.set(S9(t,e),e8(n)),t.b+=n.length)}function S9(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function I9(t,e){this.b=t,this.a=e}function T9(t){this.g=t||A9,t=B6.PerformanceNavigationTiming?0<(t=B6.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(B6.ia&&B6.ia.ya&&B6.ia.ya()&&B6.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(M6=w9.prototype).add=function(t,e){x9(this),this.c=null,t=S9(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},M6.forEach=function(t,e){x9(this),this.a.forEach((function(n,r){Z6(n,(function(n){t.call(e,n,r,this)}),this)}),this)},M6.L=function(){x9(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},M6.K=function(t){x9(this);var e=[];if("string"==typeof t)k9(this,t)&&(e=t8(e,this.a.get(S9(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=t8(e,t[n])}return e},M6.set=function(t,e){return x9(this),this.c=null,k9(this,t=S9(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},M6.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},M6.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var A9=10;function R9(t){return!!t.b||!!t.a&&t.a.size>=t.f}function O9(t){return t.b?1:t.a?t.a.size:0}function N9(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function D9(t,e){t.a?t.a.add(e):t.b=e}function P9(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function M9(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=P6(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return e8(t.c)}function F9(){}function L9(){this.a=new F9}function B9(t,e,n){var r=n||"";try{t9(t,(function(t,n){var i=t;z6(t)&&(i=e7(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function j9(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}T9.prototype.cancel=function(){var t,e;if(this.c=M9(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=P6(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},F9.prototype.stringify=function(t){return B6.JSON.stringify(t,void 0)},F9.prototype.parse=function(t){return B6.JSON.parse(t,void 0)};var V9=B6.JSON.parse;function U9(t){Z8.call(this),this.headers=new e9,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=z9,this.D=this.F=!1}Y6(U9,Z8);var z9="",W9=/^https?$/i,q9=["POST","PUT"];function H9(t){return"content-type"==t.toLowerCase()}function G9(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,K9(t),$9(t)}function K9(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function X9(t){if(t.b&&void 0!==L6&&(!t.s[1]||4!=Q9(t)||2!=t.X()))if(t.l&&4==Q9(t))p7(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Q9(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(i9)[1]||null;if(!o&&B6.self&&B6.self.location){var a=B6.self.location.protocol;o=a.substr(0,a.length-1)}i=!W9.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var s=2<Q9(t)?t.a.statusText:""}catch(u){s=""}t.f=s+" ["+t.X()+"]",K9(t)}}finally{$9(t)}}}function $9(t,e){if(t.a){Y9(t);var n=t.a,r=t.s[0]?j6:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Y9(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(B6.clearTimeout(t.m),t.m=null)}function Q9(t){return t.a?t.a.readyState:0}function J9(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return c8(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):h9(t,e,n))}function Z9(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ttt(t){this.pa=0,this.g=[],this.c=new w7,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Z9("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Z9("baseRetryDelayMs",5e3,t),this.Ma=Z9("retryDelaySeedMs",1e4,t),this.Ja=Z9("forwardChannelMaxRetries",2,t),this.ma=Z9("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new T9(t&&t.concurrentRequestLimit),this.ka=new L9,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function ett(t){if(rtt(t),3==t.v){var e=t.R++,n=a9(t.B);h9(n,"SID",t.J),h9(n,"RID",e),h9(n,"TYPE","terminate"),stt(t,n),(e=new V7(t,t.c,e,void 0)).H=2,e.i=f9(a9(n)),n=!1,B6.navigator&&B6.navigator.sendBeacon&&(n=B6.navigator.sendBeacon(e.i.toString(),"")),!n&&B6.Image&&((new Image).src=e.i,n=!0),n||(e.a=btt(e.g,null),e.a.ba(e.i)),e.u=$6(),X7(e)}gtt(t)}function ntt(t){t.a&&(htt(t),t.a.cancel(),t.a=null)}function rtt(t){ntt(t),t.j&&(B6.clearTimeout(t.j),t.j=null),dtt(t),t.b.cancel(),t.h&&("number"==typeof t.h&&B6.clearTimeout(t.h),t.h=null)}function itt(t,e){t.g.push(new I9(t.La++,e)),3==t.v&&ott(t)}function ott(t){R9(t.b)||t.h||(t.h=!0,u7(t.Ba,t),t.u=0)}function att(t,e){var n;n=e?e.f:t.R++;var r=a9(t.B);h9(r,"SID",t.J),h9(r,"RID",n),h9(r,"AID",t.P),stt(t,r),t.i&&t.l&&J9(r,t.i,t.l),n=new V7(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=utt(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),D9(t.b,n),q7(n,r,e)}function stt(t,e){t.f&&t9({},(function(t,n){h9(e,n,t)}))}function utt(t,e,n){n=Math.min(t.g.length,n);var r=t.f?K6(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?a.push("ofs="+(o=i[0].b)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{B9(l,a,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ctt(t){t.a||t.j||(t.U=1,u7(t.Aa,t),t.o=0)}function ltt(t){return!(t.a||t.j||3<=t.o||(t.U++,t.j=R7(K6(t.Aa,t),vtt(t,t.o)),t.o++,0))}function htt(t){null!=t.s&&(B6.clearTimeout(t.s),t.s=null)}function ftt(t){t.a=new V7(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=a9(t.la);h9(e,"RID","rpc"),h9(e,"SID",t.J),h9(e,"CI",t.H?"0":"1"),h9(e,"AID",t.P),stt(t,e),h9(e,"TYPE","xmlhttp"),t.i&&t.l&&J9(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=f9(a9(e)),n.j=null,n.I=!0,H7(n,t)}function dtt(t){null!=t.m&&(B6.clearTimeout(t.m),t.m=null)}function ptt(t,e){var n=null;if(t.a==e){dtt(t),htt(t),t.a=null;var r=2}else{if(!N9(t.b,e))return;n=e.s,P9(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=$6()-e.u;var i=t.u;(r=k7()).dispatchEvent(new A7(r,n,e,i)),ott(t)}else ctt(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(O9(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=R7(K6(t.Ba,t,e),vtt(t,t.u)),t.u++,0)))}(t,e)||2==r&&ltt(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:mtt(t,5);break;case 4:mtt(t,10);break;case 3:mtt(t,6);break;default:mtt(t,2)}}function vtt(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function mtt(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=K6(t.Xa,t);n||(n=new o9("//www.google.com/images/cleardot.gif"),B6.location&&"http"==B6.location.protocol||s9(n,"https"),f9(n)),function(t,e){var n=new w7;if(B6.Image){var r=new Image;r.onload=X6(j9,n,r,"TestLoadImage: loaded",!0,e),r.onerror=X6(j9,n,r,"TestLoadImage: error",!1,e),r.onabort=X6(j9,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=X6(j9,n,r,"TestLoadImage: timeout",!1,e),B6.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else T7(2);t.v=0,t.f&&t.f.ra(e),gtt(t),rtt(t)}function gtt(t){t.v=0,t.I=-1,t.f&&(0==M9(t.b).length&&0==t.g.length||(t.b.c.length=0,e8(t.g),t.g.length=0),t.f.qa())}function ytt(t,e,n){var r=function(t){return t instanceof o9?a9(t):new o9(t,void 0)}(n);if(""!=r.c)e&&u9(r,e+"."+r.c),c9(r,r.h);else{var i=B6.location;r=function(t,e,n,r){var i=new o9(null,void 0);return t&&s9(i,t),e&&u9(i,e),n&&c9(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&c8(t.W,(function(t,e){h9(r,e,t)})),n=t.na,(e=t.A)&&n&&h9(r,e,n),h9(r,"VER",t.ha),stt(t,r),r}function btt(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new U9(t.Ka)).F=t.C,e}function _tt(){}function wtt(){if(g8&&!(10<=Number(T8)))throw Error("Environmental error: no available transport.")}function xtt(t,e){Z8.call(this),this.a=new ttt(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!n8(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!n8(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Ett(this)}function Ctt(t){L7.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ktt(){B7.call(this),this.status=1}function Ett(t){this.a=t}(M6=U9.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:M7),this.a.onreadystatechange=K6(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void G9(this,o)}t=n||"";var i=new e9(this.headers);r&&t9(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=H9,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=B6.FormData&&t instanceof B6.FormData,!(0<=J6(q9,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Y9(this),0<this.o&&((this.D=function(t){return g8&&I8(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=K6(this.xa,this)):this.m=p7(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){G9(this,o)}},M6.xa=function(){void 0!==L6&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},M6.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),$9(this))},M6.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),$9(this,!0)),U9.S.G.call(this)},M6.za=function(){this.j||(this.A||this.l||this.g?X9(this):this.Ta())},M6.Ta=function(){X9(this)},M6.X=function(){try{return 2<Q9(this)?this.a.status:-1}catch(v8){return-1}},M6.$=function(){try{return this.a?this.a.responseText:""}catch(v8){return""}},M6.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),V9(e)}},M6.ua=function(){return this.h},M6.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(M6=ttt.prototype).ha=8,M6.v=1,M6.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new V7(this,this.c,t,void 0),r=this.l;if(this.O&&(r?f8(r=l8(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=utt(this,n,e),h9(i=a9(this.B),"RID",t),h9(i,"CVER",22),this.A&&h9(i,"X-HTTP-Session-Id",this.A),stt(this,i),this.i&&r&&J9(i,this.i,r),D9(this.b,n),this.Ga&&h9(i,"TYPE","init"),this.da?(h9(i,"$req",e),h9(i,"SID","null"),n.V=!0,q7(n,i,null)):q7(n,i,e),this.v=2}}else 3==this.v&&(t?att(this,t):0==this.g.length||R9(this.b)||att(this))},M6.Aa=function(){if(this.j=null,ftt(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=R7(K6(this.Sa,this),t)}},M6.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ntt(this),ftt(this))},M6.Ra=function(){null!=this.m&&(this.m=null,ntt(this),ltt(this),T7(19))},M6.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),T7(2)):(this.c.info("Failed to ping google.com"),T7(1))},(M6=_tt.prototype).ta=function(){},M6.sa=function(){},M6.ra=function(){},M6.qa=function(){},M6.Ha=function(){},wtt.prototype.a=function(t,e){return new xtt(t,e)},Y6(xtt,Z8),(M6=xtt.prototype).addEventListener=function(t,e,n,r){xtt.S.addEventListener.call(this,t,e,n,r)},M6.removeEventListener=function(t,e,n,r){xtt.S.removeEventListener.call(this,t,e,n,r)},M6.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;T7(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ytt(t,null,t.fa),ott(t)},M6.close=function(){ett(this.a)},M6.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,itt(this.a,e)}else this.g?((e={}).__data__=e7(t),itt(this.a,e)):itt(this.a,t)},M6.G=function(){this.a.f=null,delete this.f,ett(this.a),delete this.a,xtt.S.G.call(this)},Y6(Ctt,L7),Y6(ktt,B7),Y6(Ett,_tt),Ett.prototype.ta=function(){this.a.dispatchEvent("a")},Ett.prototype.sa=function(t){this.a.dispatchEvent(new Ctt(t))},Ett.prototype.ra=function(t){this.a.dispatchEvent(new ktt(t))},Ett.prototype.qa=function(){this.a.dispatchEvent("b")},wtt.prototype.createWebChannel=wtt.prototype.a,xtt.prototype.send=xtt.prototype.Pa,xtt.prototype.open=xtt.prototype.Oa,xtt.prototype.close=xtt.prototype.close,O7.NO_ERROR=0,O7.TIMEOUT=8,O7.HTTP_ERROR=6,N7.COMPLETE="complete",P7.EventType=F7,F7.OPEN="a",F7.CLOSE="b",F7.ERROR="c",F7.MESSAGE="d",Z8.prototype.listen=Z8.prototype.va,U9.prototype.listenOnce=U9.prototype.wa,U9.prototype.getLastError=U9.prototype.Qa,U9.prototype.getLastErrorCode=U9.prototype.ua,U9.prototype.getStatus=U9.prototype.X,U9.prototype.getResponseJson=U9.prototype.Na,U9.prototype.getResponseText=U9.prototype.$,U9.prototype.send=U9.prototype.ba;var Stt=O7,Itt=N7,Ttt=P7,Att=U9,Rtt=n("/6Yf"),Ott={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ntt=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(EP.c)(e,t),e}(Error),Dtt=new O6.b("@firebase/firestore");function Ptt(){return Dtt.logLevel}function Mtt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Dtt.logLevel<=O6.a.DEBUG){var r=e.map(Btt);Dtt.debug.apply(Dtt,Object(EP.g)(["Firestore (8.0.0): "+t],r))}}function Ftt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Dtt.logLevel<=O6.a.ERROR){var r=e.map(Btt);Dtt.error.apply(Dtt,Object(EP.g)(["Firestore (8.0.0): "+t],r))}}function Ltt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Dtt.logLevel<=O6.a.WARN){var r=e.map(Btt);Dtt.warn.apply(Dtt,Object(EP.g)(["Firestore (8.0.0): "+t],r))}}function Btt(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function jtt(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.0) INTERNAL ASSERTION FAILED: "+t;throw Ftt(e),new Error(e)}function Vtt(t,e){t||jtt()}function Utt(t,e){return t}function ztt(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Wtt=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ztt(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function qtt(t,e){return t<e?-1:t>e?1:0}function Htt(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Gtt(t){return t+"\0"}var Ktt=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.h=function(t){return qtt(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Ktt.u=new Ktt("");var Xtt=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Ktt.fromBase64String(e))}catch(e){throw new Ntt(Ott.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ktt.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}();function $tt(){if("undefined"==typeof Uint8Array)throw new Ntt(Ott.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ytt(){if("undefined"==typeof atob)throw new Ntt(Ott.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Qtt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.fromBase64String=function(t){Ytt();try{return new e(Ktt.fromBase64String(t))}catch(t){throw new Ntt(Ott.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){return $tt(),new e(Ktt.fromUint8Array(t))},e.prototype.toBase64=function(){return Ytt(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return $tt(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Xtt),Jtt=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},Ztt=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.h=function(t){return qtt(this.projectId,t.projectId)||qtt(this.database,t.database)},t}();function tet(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function eet(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function net(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ret=function(){function t(t,e){this.m=t,this.A=e,this.R={}}return t.prototype.get=function(t){var e=this.m(t),n=this.R[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[1];if(this.A(o[0],t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){eet(this.R,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.P=function(){return net(this.R)},t}(),iet=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ntt(Ott.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ntt(Ott.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ntt(Ott.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ntt(Ott.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.g=function(t){return this.seconds===t.seconds?qtt(this.nanoseconds,t.nanoseconds):qtt(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),oet=function(){function t(t){this.timestamp=t}return t.V=function(e){return new t(e)},t.min=function(){return new t(new iet(0,0))},t.prototype.h=function(t){return this.timestamp.g(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.v=function(){return this.timestamp},t}(),aet=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&jtt(),void 0===n?n=t.length-e:n>t.length-e&&jtt(),this.segments=t,this.offset=e,this.S=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.D(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.C(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.N=function(t){return this.C(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},t.prototype.k=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.P=function(){return 0===this.length},t.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},t.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),set=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.C=function(t,n,r){return new e(t,n,r)},e.prototype.B=function(){return this.L().join("/")},e.prototype.toString=function(){return this.B()},e.q=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.U=function(){return new e([])},e}(aet),uet=/^[_a-zA-Z][_a-zA-Z0-9]*$/,cet=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.C=function(t,n,r){return new e(t,n,r)},e.K=function(t){return uet.test(t)},e.prototype.B=function(){return this.L().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.K(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.B()},e.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},e.j=function(){return new e(["__name__"])},e.G=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ntt(Ott.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ntt(Ott.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ntt(Ott.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.U=function(){return new e([])},e}(aet),het=function(){function t(t){this.path=t}return t.H=function(e){return new t(set.q(e))},t.J=function(e){return new t(set.q(e).N(5))},t.prototype.Y=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===set.D(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.D=function(t,e){return set.D(t.path,e.path)},t.X=function(t){return t.length%2==0},t.Z=function(e){return new t(new set(e.slice()))},t}();function fet(t){return null==t}function det(t){return 0===t&&1/t==-1/0}function pet(t){return"number"==typeof t&&Number.isInteger(t)&&!det(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var vet=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.tt=null};function met(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new vet(t,e,n,r,i,o,a)}function get(t){var e=Utt(t);if(null===e.tt){var n=e.path.B();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.B()+t.op.toString()+unt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.B()+e.dir;var e})).join(","),fet(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=cit(e.startAt)),e.endAt&&(n+="|ub:",n+=cit(e.endAt)),e.tt=n}return e.tt}function yet(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!pit(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!int(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hit(t.startAt,e.startAt)&&hit(t.endAt,e.endAt)}function bet(t){return het.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}var _et,wet,xet=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=oet.min()),void 0===o&&(o=oet.min()),void 0===a&&(a=Ktt.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),Cet=function(t){this.count=t};function ket(t){switch(t){case Ott.OK:return jtt();case Ott.CANCELLED:case Ott.UNKNOWN:case Ott.DEADLINE_EXCEEDED:case Ott.RESOURCE_EXHAUSTED:case Ott.INTERNAL:case Ott.UNAVAILABLE:case Ott.UNAUTHENTICATED:return!1;case Ott.INVALID_ARGUMENT:case Ott.NOT_FOUND:case Ott.ALREADY_EXISTS:case Ott.PERMISSION_DENIED:case Ott.FAILED_PRECONDITION:case Ott.ABORTED:case Ott.OUT_OF_RANGE:case Ott.UNIMPLEMENTED:case Ott.DATA_LOSS:return!0;default:return jtt()}}function Eet(t){if(void 0===t)return Ftt("GRPC error has no .code"),Ott.UNKNOWN;switch(t){case _et.OK:return Ott.OK;case _et.CANCELLED:return Ott.CANCELLED;case _et.UNKNOWN:return Ott.UNKNOWN;case _et.DEADLINE_EXCEEDED:return Ott.DEADLINE_EXCEEDED;case _et.RESOURCE_EXHAUSTED:return Ott.RESOURCE_EXHAUSTED;case _et.INTERNAL:return Ott.INTERNAL;case _et.UNAVAILABLE:return Ott.UNAVAILABLE;case _et.UNAUTHENTICATED:return Ott.UNAUTHENTICATED;case _et.INVALID_ARGUMENT:return Ott.INVALID_ARGUMENT;case _et.NOT_FOUND:return Ott.NOT_FOUND;case _et.ALREADY_EXISTS:return Ott.ALREADY_EXISTS;case _et.PERMISSION_DENIED:return Ott.PERMISSION_DENIED;case _et.FAILED_PRECONDITION:return Ott.FAILED_PRECONDITION;case _et.ABORTED:return Ott.ABORTED;case _et.OUT_OF_RANGE:return Ott.OUT_OF_RANGE;case _et.UNIMPLEMENTED:return Ott.UNIMPLEMENTED;case _et.DATA_LOSS:return Ott.DATA_LOSS;default:return jtt()}}(wet=_et||(_et={}))[wet.OK=0]="OK",wet[wet.CANCELLED=1]="CANCELLED",wet[wet.UNKNOWN=2]="UNKNOWN",wet[wet.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wet[wet.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wet[wet.NOT_FOUND=5]="NOT_FOUND",wet[wet.ALREADY_EXISTS=6]="ALREADY_EXISTS",wet[wet.PERMISSION_DENIED=7]="PERMISSION_DENIED",wet[wet.UNAUTHENTICATED=16]="UNAUTHENTICATED",wet[wet.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wet[wet.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wet[wet.ABORTED=10]="ABORTED",wet[wet.OUT_OF_RANGE=11]="OUT_OF_RANGE",wet[wet.UNIMPLEMENTED=12]="UNIMPLEMENTED",wet[wet.INTERNAL=13]="INTERNAL",wet[wet.UNAVAILABLE=14]="UNAVAILABLE",wet[wet.DATA_LOSS=15]="DATA_LOSS";var Iet=function(){function t(t,e){this.D=t,this.root=e||Aet.EMPTY}return t.prototype.ot=function(e,n){return new t(this.D,this.root.ot(e,n,this.D).copy(null,null,Aet.at,null,null))},t.prototype.remove=function(e){return new t(this.D,this.root.remove(e,this.D).copy(null,null,Aet.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.P=function(){return this.root.P()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ht=function(){return this.root.ht()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new Tet(this.root,null,this.D,!1)},t.prototype.ft=function(t){return new Tet(this.root,t,this.D,!1)},t.prototype.dt=function(){return new Tet(this.root,null,this.D,!0)},t.prototype.wt=function(t){return new Tet(this.root,t,this.D,!0)},t}(),Tet=function(){function t(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}return t.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},t.prototype.At=function(){return this.Tt.length>0},t.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),Aet=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.P=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.P()?this:this.left.min()},t.prototype.ht=function(){return this.min().key},t.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},t.prototype.gt=function(){if(this.left.P())return t.EMPTY;var e=this;return e.left.Vt()||e.left.left.Vt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.gt(),null)).Pt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.P()||i.left.Vt()||i.left.left.Vt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Vt()&&(i=i.bt()),i.right.P()||i.right.Vt()||i.right.left.Vt()||(i=i.vt()),0===n(e,i.key)){if(i.right.P())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.gt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Pt()},t.prototype.Vt=function(){return this.color},t.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},t.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw jtt();if(this.right.Vt())throw jtt();var t=this.left.Nt();if(t!==this.right.Nt())throw jtt();return t+(this.Vt()?0:1)},t}();Aet.EMPTY=null,Aet.RED=!0,Aet.at=!1,Aet.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw jtt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw jtt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw jtt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw jtt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw jtt()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new Aet(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.P=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ht=function(){return null},t.prototype.ct=function(){return null},t.prototype.Vt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());var Ret=function(){function t(t){this.D=t,this.data=new Iet(this.D)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ht()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.D(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.kt=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new Oet(this.data._t())},t.prototype.ft=function(t){return new Oet(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.P=function(){return this.data.P()},t.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.D(i,o))return!1}return!0},t.prototype.L=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.D);return n.data=e,n},t}(),Oet=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),Net=new Iet(het.D);function Det(){return Net}function Pet(){return Det()}var Met=new Iet(het.D);function Fet(){return Met}var Let=new Iet(het.D),Bet=new Ret(het.D);function jet(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bet,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Vet=new Ret(qtt);function Uet(){return Vet}var zet=function(){function t(t){this.D=t?function(e,n){return t(e,n)||het.D(e.key,n.key)}:function(t,e){return het.D(t.key,e.key)},this.$t=Fet(),this.Lt=new Iet(this.D)}return t.Bt=function(e){return new t(e.D)},t.prototype.has=function(t){return null!=this.$t.get(t)},t.prototype.get=function(t){return this.$t.get(t)},t.prototype.first=function(){return this.Lt.ht()},t.prototype.last=function(){return this.Lt.ct()},t.prototype.P=function(){return this.Lt.P()},t.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.D=this.D,r.$t=e,r.Lt=n,r},t}(),Wet=function(){function t(){this.qt=new Iet(het.D)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):jtt():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ut((function(e,n){t.push(n)})),t},t}(),qet=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=a,this.jt=s}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,zet.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Xrt(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Het=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,Get.Zt(e,n)),new t(oet.min(),r,Uet(),Det(),jet())},t}(),Get=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(Ktt.u,n,jet(),jet(),jet())},t}(),Ket=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Xet=function(t,e){this.targetId=t,this.oe=e},$et=function(t,e,n,r){void 0===n&&(n=Ktt.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Yet=function(){function t(){this.ae=0,this.he=Zet(),this.ce=Ktt.u,this.ue=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.o()>0&&(this.le=!0,this.ce=t)},t.prototype.we=function(){var t=jet(),e=jet(),n=jet();return this.he.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:jtt()}})),new Get(this.ce,this.ue,t,e,n)},t.prototype.Ee=function(){this.le=!1,this.he=Zet()},t.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},t.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},t.prototype.me=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.ue=!0},t}(),Qet=function(){function t(t){this.Pe=t,this.ge=new Map,this.Ve=Det(),this.ye=Jet(),this.pe=new Ret(qtt)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Nrt?this.ve(r,t.re):t.re instanceof Drt&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Se(o[i],t.key,t.re)},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.xe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.Ee(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.xe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.xe(n)&&(e.Fe(n),r.de(t.resumeToken));break;default:jtt()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ge.forEach((function(t,r){n.xe(r)&&e(r)}))},t.prototype.ke=function(t){var e=t.targetId,n=t.oe.count,r=this.Oe(e);if(r){var i=r.target;if(bet(i))if(0===n){var o=new het(i.path);this.Se(e,o,new Drt(o,oet.min()))}else Vtt(1===n);else this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e))}},t.prototype.$e=function(t){var e=this,n=new Map;this.ge.forEach((function(r,i){var o=e.Oe(i);if(o){if(r.te&&bet(o.target)){var a=new het(o.target.path);null!==e.Ve.get(a)||e.Le(i,a)||e.Se(i,a,new Drt(a,t))}r.fe&&(n.set(i,r.we()),r.Ee())}}));var r=jet();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.Oe(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Het(t,n,this.pe,this.Ve,r);return this.Ve=Det(),this.ye=Jet(),this.pe=new Ret(qtt),i},t.prototype.ve=function(t,e){if(this.xe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.xe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n))}},t.prototype.removeTarget=function(t){this.ge.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},t.prototype.me=function(t){this.Ne(t).me()},t.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new Yet,this.ge.set(t,e)),e},t.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Ret(qtt),this.ye=this.ye.ot(t,e)),e},t.prototype.xe=function(t){var e=null!==this.Oe(t);return e||Mtt("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},t.prototype.Fe=function(t){var e=this;this.ge.set(t,new Yet),this.Pe.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},t}();function Jet(){return new Iet(het.D)}function Zet(){return new Iet(het.D)}function tnt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ent(t){var e=cnt(t.mapValue.fields.__local_write_time__.timestampValue);return new iet(e.seconds,e.nanos)}var nnt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rnt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?tnt(t)?4:10:jtt()}function int(t,e){var n=rnt(t);if(n!==rnt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ent(t).isEqual(ent(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=cnt(t.timestampValue),r=cnt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return hnt(t.bytesValue).isEqual(hnt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return lnt(t.geoPointValue.latitude)===lnt(e.geoPointValue.latitude)&&lnt(t.geoPointValue.longitude)===lnt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return lnt(t.integerValue)===lnt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=lnt(t.doubleValue),r=lnt(e.doubleValue);return n===r?det(n)===det(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Htt(t.arrayValue.values||[],e.arrayValue.values||[],int);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(tet(n)!==tet(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!int(n[i],r[i])))return!1;return!0}(t,e);default:return jtt()}}function ont(t,e){return void 0!==(t.values||[]).find((function(t){return int(t,e)}))}function ant(t,e){var n=rnt(t),r=rnt(e);if(n!==r)return qtt(n,r);switch(n){case 0:return 0;case 1:return qtt(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=lnt(t.integerValue||t.doubleValue),r=lnt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return snt(t.timestampValue,e.timestampValue);case 4:return snt(ent(t),ent(e));case 5:return qtt(t.stringValue,e.stringValue);case 6:return function(t,e){var n=hnt(t),r=hnt(e);return n.h(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=qtt(n[i],r[i]);if(0!==o)return o}return qtt(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=qtt(lnt(t.latitude),lnt(e.latitude));return 0!==n?n:qtt(lnt(t.longitude),lnt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ant(n[i],r[i]);if(o)return o}return qtt(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=qtt(r[a],o[a]);if(0!==s)return s;var u=ant(n[r[a]],i[o[a]]);if(0!==u)return u}return qtt(r.length,o.length)}(t.mapValue,e.mapValue);default:throw jtt()}}function snt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qtt(t,e);var n=cnt(t),r=cnt(e),i=qtt(n.seconds,r.seconds);return 0!==i?i:qtt(n.nanos,r.nanos)}function unt(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=cnt(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?hnt(e.bytesValue).toBase64():"referenceValue"in e?het.J(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+t(e.fields[a])}return n+"}"}(e.mapValue):jtt();var n}(t)}function cnt(t){if(Vtt(!!t),"string"==typeof t){var e=0,n=nnt.exec(t);if(Vtt(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:lnt(t.seconds),nanos:lnt(t.nanos)}}function lnt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function hnt(t){return"string"==typeof t?Ktt.fromBase64String(t):Ktt.fromUint8Array(t)}function fnt(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function dnt(t){return!!t&&"integerValue"in t}function pnt(t){return!!t&&"arrayValue"in t}function vnt(t){return!!t&&"nullValue"in t}function mnt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gnt(t){return!!t&&"mapValue"in t}var ynt={asc:"ASCENDING",desc:"DESCENDING"},bnt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_nt=function(t,e){this._=t,this.Ke=e};function wnt(t){return{integerValue:""+t}}function xnt(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:det(e)?"-0":e}}function Cnt(t,e){return pet(e)?wnt(e):xnt(t,e)}function knt(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ent(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Snt(t,e){return knt(t,e.v())}function Int(t){return Vtt(!!t),oet.V(function(t){var e=cnt(t);return new iet(e.seconds,e.nanos)}(t))}function Tnt(t,e){return function(t){return new set(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).B()}function Ant(t){var e=set.q(t);return Vtt(Ynt(e)),e}function Rnt(t,e){return Tnt(t._,e.path)}function Ont(t,e){var n=Ant(e);return Vtt(n.get(1)===t._.projectId),Vtt(!n.get(3)&&!t._.database||n.get(3)===t._.database),new het(Mnt(n))}function Nnt(t,e){return Tnt(t._,e)}function Dnt(t){var e=Ant(t);return 4===e.length?set.U():Mnt(e)}function Pnt(t){return new set(["projects",t._.projectId,"databases",t._.database]).B()}function Mnt(t){return Vtt(t.length>4&&"documents"===t.get(4)),t.N(5)}function Fnt(t,e,n){return{name:Rnt(t,e),fields:n.proto.mapValue.fields}}function Lnt(t,e){var n;if(e instanceof _rt)n={update:Fnt(t,e.key,e.value)};else if(e instanceof Srt)n={delete:Rnt(t,e.key)};else if(e instanceof wrt)n={update:Fnt(t,e.key,e.data),updateMask:$nt(e.Qe)};else if(e instanceof Crt)n={transform:{document:Rnt(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof ert)return{fieldPath:e.field.B(),setToServerValue:"REQUEST_TIME"};if(n instanceof nrt)return{fieldPath:e.field.B(),appendMissingElements:{values:n.elements}};if(n instanceof irt)return{fieldPath:e.field.B(),removeAllFromArray:{values:n.elements}};if(n instanceof art)return{fieldPath:e.field.B(),increment:n.We};throw jtt()}(0,t)}))}};else{if(!(e instanceof Irt))return jtt();n={verify:Rnt(t,e.key)}}return e.Ge.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Snt(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:jtt()}(t,e.Ge)),n}function Bnt(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?frt.updateTime(Int(t.updateTime)):void 0!==t.exists?frt.exists(t.exists):frt.ze()}(e.currentDocument):frt.ze();if(e.update){var r=Ont(t,e.update.name),i=new Trt({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new crt((t.fieldPaths||[]).map((function(t){return cet.G(t)})))}(e.updateMask);return new wrt(r,i,o,n)}return new _rt(r,i,n)}if(e.delete){var a=Ont(t,e.delete);return new Srt(a,n)}if(e.transform){var s=Ont(t,e.transform.document),u=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(Vtt("REQUEST_TIME"===e.setToServerValue),n=new ert):"appendMissingElements"in e?n=new nrt(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new irt(e.removeAllFromArray.values||[]):"increment"in e?n=new art(t,e.increment):jtt();var r=cet.G(e.fieldPath);return new lrt(r,n)}(t,e)}));return Vtt(!0===n.exists),new Crt(s,u)}if(e.verify){var c=Ont(t,e.verify);return new Irt(c,n)}return jtt()}function jnt(t,e){return{documents:[Nnt(t,e.path)]}}function Vnt(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Nnt(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Nnt(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(mnt(t.value))return{unaryFilter:{field:Hnt(t.field),op:"IS_NAN"}};if(vnt(t.value))return{unaryFilter:{field:Hnt(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(mnt(t.value))return{unaryFilter:{field:Hnt(t.field),op:"IS_NOT_NAN"}};if(vnt(t.value))return{unaryFilter:{field:Hnt(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hnt(t.field),op:qnt(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Hnt(t.field),direction:Wnt(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.Ke||fet(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Unt(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Unt(e.endAt)),n}function Unt(t){return{before:t.before,values:t.position}}function znt(t){return new uit(t.values||[],!!t.before)}function Wnt(t){return ynt[t]}function qnt(t){return bnt[t]}function Hnt(t){return{fieldPath:t.B()}}function Gnt(t){return cet.G(t.fieldPath)}function Knt(t){return Zrt.create(Gnt(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return jtt()}}(t.fieldFilter.op),t.fieldFilter.value)}function Xnt(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Gnt(t.unaryFilter.field);return Zrt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Gnt(t.unaryFilter.field);return Zrt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Gnt(t.unaryFilter.field);return Zrt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Gnt(t.unaryFilter.field);return Zrt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return jtt()}}function $nt(t){var e=[];return t.fields.forEach((function(t){return e.push(t.B())})),{fieldPaths:e}}function Ynt(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Qnt=function(){this.He=void 0};function Jnt(t,e,n){return t instanceof ert?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof nrt?rrt(t,e):t instanceof irt?ort(t,e):function(t,e){var n=trt(t,e),r=srt(n)+srt(t.We);return dnt(n)&&dnt(t.We)?wnt(r):xnt(t.serializer,r)}(t,e)}function Znt(t,e,n){return t instanceof nrt?rrt(t,e):t instanceof irt?ort(t,e):n}function trt(t,e){return t instanceof art?dnt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ert=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e}(Qnt),nrt=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(EP.c)(e,t),e}(Qnt);function rrt(t,e){for(var n=urt(e),r=function(t){n.some((function(e){return int(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var irt=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(EP.c)(e,t),e}(Qnt);function ort(t,e){for(var n=urt(e),r=function(t){n=n.filter((function(e){return!int(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var art=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return Object(EP.c)(e,t),e}(Qnt);function srt(t){return lnt(t.integerValue||t.doubleValue)}function urt(t){return pnt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var crt=function(){function t(t){this.fields=t,t.sort(cet.D)}return t.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},t.prototype.isEqual=function(t){return Htt(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),lrt=function(t,e){this.field=t,this.transform=e},hrt=function(t,e){this.version=t,this.transformResults=e},frt=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function drt(t,e){return void 0!==t.updateTime?e instanceof Nrt&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Nrt}var prt=function(){};function vrt(t,e,n){return t instanceof _rt?function(t,e,n){return new Nrt(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof wrt?function(t,e,n){if(!drt(t.Ge,e))return new Prt(t.key,n.version);var r=xrt(t,e);return new Nrt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Crt?function(t,e,n){if(Vtt(null!=n.transformResults),!drt(t.Ge,e))return new Prt(t.key,n.version);var r=krt(0,e),i=function(t,e,n){var r=[];Vtt(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=null;e instanceof Nrt&&(s=e.field(o.field)),r.push(Znt(a,s,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,a=Ert(t,r.data(),i);return new Nrt(t.key,o,a,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Drt(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function mrt(t,e,n,r){return t instanceof _rt?function(t,e){if(!drt(t.Ge,e))return e;var n=brt(e);return new Nrt(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof wrt?function(t,e){if(!drt(t.Ge,e))return e;var n=brt(e),r=xrt(t,e);return new Nrt(t.key,n,r,{Ye:!0})}(t,e):t instanceof Crt?function(t,e,n,r){if(!drt(t.Ge,e))return e;var i=krt(0,e),o=function(t,e,n,r){for(var i=[],o=0,a=t;o<a.length;o++){var s=a[o],u=s.transform,c=null;n instanceof Nrt&&(c=n.field(s.field)),null===c&&r instanceof Nrt&&(c=r.field(s.field)),i.push(Jnt(u,c,e))}return i}(t.fieldTransforms,n,e,r),a=Ert(t,i.data(),o);return new Nrt(t.key,i.version,a,{Ye:!0})}(t,e,r,n):function(t,e){return drt(t.Ge,e)?new Drt(t.key,oet.min()):e}(t,e)}function grt(t,e){return t instanceof Crt?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e instanceof Nrt?e.field(o.field):void 0,s=trt(o.transform,a||null);null!=s&&(n=null==n?(new Art).set(o.field,s):n.set(o.field,s))}return n?n.Xe():null}(t,e):null}function yrt(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Htt(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof nrt&&e instanceof nrt||t instanceof irt&&e instanceof irt?Htt(t.elements,e.elements,int):t instanceof art&&e instanceof art?int(t.We,e.We):t instanceof ert&&e instanceof ert}(t.transform,e.transform)}(t,e)})))}function brt(t){return t instanceof Nrt?t.version:oet.min()}var _rt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return Object(EP.c)(e,t),e}(prt),wrt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ge=i,o.type=1,o}return Object(EP.c)(e,t),e}(prt);function xrt(t,e){return function(t,e){var n=new Art(e);return t.Qe.fields.forEach((function(e){if(!e.P()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Xe()}(t,e instanceof Nrt?e.data():Trt.empty())}var Crt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=frt.exists(!0),r}return Object(EP.c)(e,t),e}(prt);function krt(t,e){return e}function Ert(t,e,n){for(var r=new Art(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Xe()}var Srt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return Object(EP.c)(e,t),e}(prt),Irt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return Object(EP.c)(e,t),e}(prt),Trt=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!gnt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return int(this.proto,t.proto)},t}(),Art=function(){function t(t){void 0===t&&(t=Trt.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===rnt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.O(),e)},t.prototype.Xe=function(){var t=this.nn(cet.U(),this.tn);return null!=t?new Trt(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=gnt(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var a=n.nn(t.child(i),e);null!=a&&(o[i]=a,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Rrt(t){var e=[];return eet(t.fields||{},(function(t,n){var r=new cet([t]);if(gnt(n)){var i=Rrt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++)e.push(r.child(a[o]))}else e.push(r)})),new crt(e)}var Ort=function(t,e){this.key=t,this.version=e},Nrt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(EP.c)(e,t),e.prototype.field=function(t){return this.sn.field(t)},e.prototype.data=function(){return this.sn},e.prototype.rn=function(){return this.sn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ort),Drt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(EP.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ort),Prt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ort),Mrt=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=a,this.endAt=s,this.hn=null,this.cn=null};function Frt(t,e,n,r,i,o,a,s){return new Mrt(t,e,n,r,i,o,a,s)}function Lrt(t){return new Mrt(t)}function Brt(t){return!fet(t.limit)&&"F"===t.an}function jrt(t){return!fet(t.limit)&&"L"===t.an}function Vrt(t){return t.on.length>0?t.on[0].field:null}function Urt(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function zrt(t){return null!==t.collectionGroup}function Wrt(t){var e=Utt(t);if(null===e.hn){e.hn=[];var n=Urt(e),r=Vrt(e);if(null!==n&&null===r)n.W()||e.hn.push(new fit(n)),e.hn.push(new fit(cet.j(),"asc"));else{for(var i=!1,o=0,a=e.on;o<a.length;o++){var s=a[o];e.hn.push(s),s.field.W()&&(i=!0)}if(!i){var u=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.hn.push(new fit(cet.j(),u))}}}return e.hn}function qrt(t){var e=Utt(t);if(!e.cn)if("F"===e.an)e.cn=met(e.path,e.collectionGroup,Wrt(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Wrt(e);r<i.length;r++){var o=i[r];n.push(new fit(o.field,"desc"===o.dir?"asc":"desc"))}var a=e.endAt?new uit(e.endAt.position,!e.endAt.before):null,s=e.startAt?new uit(e.startAt.position,!e.startAt.before):null;e.cn=met(e.path,e.collectionGroup,n,e.filters,e.limit,a,s)}return e.cn}function Hrt(t,e,n){return new Mrt(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Grt(t,e){return new Mrt(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Krt(t,e){return new Mrt(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Xrt(t,e){return yet(qrt(t),qrt(e))&&t.an===e.an}function $rt(t){return get(qrt(t))+"|lt:"+t.an}function Yrt(t){return"Query(target="+function(t){var e=t.path.B();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.B()+" "+e.op+" "+unt(e.value);var e})).join(", ")+"]"),fet(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.B()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+cit(t.startAt)),t.endAt&&(e+=", endAt: "+cit(t.endAt)),"Target("+e+")"}(qrt(t))+"; limitType="+t.an+")"}function Qrt(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.Y(t.collectionGroup)&&t.path.M(n):het.X(t.path)?t.path.isEqual(n):t.path.$(n)}(t,e)&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.W()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!lit(t.startAt,Wrt(t),e)||t.endAt&&lit(t.endAt,Wrt(t),e))}(t,e)}function Jrt(t){return function(e,n){for(var r=!1,i=0,o=Wrt(t);i<o.length;i++){var a=o[i],s=dit(a,e,n);if(0!==s)return s;r=r||a.field.W()}return 0}}var Zrt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(EP.c)(e,t),e.create=function(t,n,r){return t.W()?"in"===n||"not-in"===n?this.ln(t,n,r):new tit(t,n,r):"array-contains"===n?new iit(t,r):"in"===n?new oit(t,r):"not-in"===n?new ait(t,r):"array-contains-any"===n?new sit(t,r):new e(t,n,r)},e.ln=function(t,e,n){return"in"===e?new eit(t,n):new nit(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(ant(e,this.value)):null!==e&&rnt(this.value)===rnt(e)&&this._n(ant(e,this.value))},e.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return jtt()}},e.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),tit=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=het.J(r.referenceValue),i}return Object(EP.c)(e,t),e.prototype.matches=function(t){var e=het.D(t.key,this.key);return this._n(e)},e}(Zrt),eit=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=rit(0,n),r}return Object(EP.c)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Zrt),nit=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=rit(0,n),r}return Object(EP.c)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Zrt);function rit(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return het.J(t.referenceValue)}))}var iit=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(EP.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return pnt(e)&&ont(e.arrayValue,this.value)},e}(Zrt),oit=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(EP.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ont(this.value.arrayValue,e)},e}(Zrt),ait=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(EP.c)(e,t),e.prototype.matches=function(t){if(ont(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ont(this.value.arrayValue,e)},e}(Zrt),sit=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(EP.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!pnt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ont(e.value.arrayValue,t)}))},e}(Zrt),uit=function(t,e){this.position=t,this.before=e};function cit(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return unt(t)})).join(",")}function lit(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.W()?het.D(het.J(a.referenceValue),n.key):ant(a,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function hit(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!int(t.position[n],e.position[n]))return!1;return!0}var fit=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function dit(t,e,n){var r=t.field.W()?het.D(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ant(r,i):jtt()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return jtt()}}function pit(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var vit=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},mit=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.In=0},t.prototype.Rn=function(){this.In=this.Tn},t.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&Mtt("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},t.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},t.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},t.prototype.gn=function(){return(Math.random()-.5)*this.In},t}(),git=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&jtt(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.xn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Nn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.kn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.On=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.kn(r)},t}(),yit=function(){function t(e,n,r){this.name=e,this.version=n,this.Mn=r,12.2===t.$n(Object(N6.p)())&&Ftt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Mtt("SimpleDb","Removing database:",t),kit(window.indexedDB.deleteDatabase(t)).xn()},t.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(t.Bn())return!0;var e=Object(N6.p)(),n=t.$n(e),r=0<n&&n<10,i=t.qn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},t.Kn=function(t,e){return t.store(e)},t.$n=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Qn=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Mtt("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new _it(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Ntt(Ott.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new _it(t,n))},i.onupgradeneeded=function(t){Mtt("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Mn.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){Mtt("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return n.Wn(t)}),this.db)]}}))}))},t.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,l;return Object(EP.d)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.Qn(t)];case 2:return s.db=h.sent(),e=xit.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),git.reject(t)})).xn(),u={},a.catch((function(){})),[4,e.Gn];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return Mtt("SimpleDb","Transaction failed with error:",(c=h.sent()).message,"Retrying:",l="FirebaseError"!==c.name&&o<3),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),bit=function(){function t(t){this.zn=t,this.Hn=!1,this.Jn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Jn=t},t.prototype.delete=function(){return kit(this.zn.delete())},t}(),_it=function(t){function e(e,n){var r=this;return(r=t.call(this,Ott.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(EP.c)(e,t),e}(Ntt);function wit(t){return"IndexedDbTransactionError"===t.name}var xit=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new vit,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new _it(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=Sit(e.target.error);n.Zn.reject(new _it(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new _it(n,e)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Mtt("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Cit(e)},t}(),Cit=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Mtt("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Mtt("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),kit(n)},t.prototype.add=function(t){return Mtt("SimpleDb","ADD",this.store.name,t,t),kit(this.store.add(t))},t.prototype.get=function(t){var e=this;return kit(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Mtt("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Mtt("SimpleDb","DELETE",this.store.name,t),kit(this.store.delete(t))},t.prototype.count=function(){return Mtt("SimpleDb","COUNT",this.store.name),kit(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){Mtt("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new git((function(n,r){e.onerror=function(t){var e=Sit(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new git((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new bit(i),a=e(i.primaryKey,i.value,o);if(a instanceof git){var s=a.catch((function(t){return o.done(),git.reject(t)}));n.push(s)}o.Sn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return git.kn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function kit(t){return new git((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Sit(t.target.error);n(e)}}))}var Eit=!1;function Sit(t){var e=yit.$n(Object(N6.p)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ntt("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Eit||(Eit=!0,setTimeout((function(){throw r}),0)),r}}return t}function Iit(){return"undefined"!=typeof window?window:null}function Tit(){return"undefined"!=typeof document?document:null}var Ait=function(){function t(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new vit,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Ntt(Ott.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.hs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},t}(),Rit=function(){function t(){var t=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new mit(this,"async_queue_retry"),this.ys=function(){var e=Tit();e&&Mtt("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.Vs.yn()};var e=Tit();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=Tit();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Ts.push(t),e.Ns()}))},t.prototype.Ns=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e=this;return Object(EP.d)(this,(function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!wit(t=n.sent()))throw t;return Mtt("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.Vs.Pn((function(){return e.Ns()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Es.then((function(){return e.Ps=!0,t().catch((function(t){throw e.Rs=t,e.Ps=!1,Ftt("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ps=!1,t}))}));return this.Es=n,n},t.prototype.Vn=function(t,e,n){var r=this;this.vs(),this.gs.indexOf(t)>-1&&(e=0);var i=Ait._s(this,t,e,n,(function(t){return r.xs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&jtt()},t.prototype.Fs=function(){},t.prototype.ks=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t;return Object(EP.d)(this,(function(e){switch(e.label){case 0:return[4,t=this.Es];case 1:e.sent(),e.label=2;case 2:if(t!==this.Es)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.ks().then((function(){e.As.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.ks()}))},t.prototype.$s=function(t){this.gs.push(t)},t.prototype.xs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function Oit(t,e){if(Ftt("AsyncQueue",e+": "+t),wit(t))return new Ntt(Ott.UNAVAILABLE,e+": "+t);throw t}var Nit=function(){this.Ls=void 0,this.listeners=[]},Dit=function(){this.Bs=new ret((function(t){return $rt(t)}),Xrt),this.onlineState="Unknown",this.qs=new Set};function Pit(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:if(n=Utt(t),i=!1,(o=n.Bs.get(r=e.query))||(i=!0,o=new Nit),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.Us(r)];case 2:return a.Ls=c.sent(),[3,4];case 3:return s=c.sent(),u=Oit(s,"Initialization of query '"+Yrt(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.Bs.set(r,o),o.listeners.push(e),e.Ks(n.onlineState),o.Ls&&e.Qs(o.Ls)&&Bit(n),[2]}}))}))}function Mit(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){return n=Utt(t),i=!1,(o=n.Bs.get(r=e.query))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.Bs.delete(r),n.Ws(r))]:[2]}))}))}function Fit(t,e){for(var n=Utt(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=n.Bs.get(a.query);if(s){for(var u=0,c=s.listeners;u<c.length;u++)c[u].Qs(a)&&(r=!0);s.Ls=a}}r&&Bit(n)}function Lit(t,e,n){var r=Utt(t),i=r.Bs.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.Bs.delete(e)}function Bit(t){t.qs.forEach((function(t){t.next()}))}var jit=function(){function t(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new qet(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},t.prototype.Js=function(t,e){return!t.fromCache||!(this.options.Xs&&"Offline"!==e||t.docs.P()&&"Offline"!==e)},t.prototype.Hs=function(t){return t.docChanges.length>0||!!(t.Wt||this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=qet.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},t}(),Vit=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Vit.UNAUTHENTICATED=new Vit(null),Vit.ei=new Vit("google-credentials-uid"),Vit.ni=new Vit("first-party-uid");var Uit=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}return t.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},t}();function zit(t,e){return"firestore_clients_"+t+"_"+e}function Wit(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function qit(t,e){return"firestore_targets_"+t+"_"+e}Uit.ai=-1;var Hit=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.hi=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new Ntt(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(Ftt("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Git=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.hi=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ntt(r.error.code,r.error.message)),i?new t(e,r.state,o):(Ftt("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Kit=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.hi=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Uet(),a=0;i&&a<r.activeTargetIds.length;++a)i=pet(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Ftt("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Xit=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.hi=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ftt("SharedClientState","Failed to parse online state: "+e),null)},t}(),$it=function(){function t(){this.activeTargetIds=Uet()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Yit=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new Iet(qtt),this.Ii=!1,this.mi=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=zit(this.persistenceKey,this._i),this.Ri=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ti=this.Ti.ot(this._i,new $it),this.Pi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,l=this;return Object(EP.d)(this,(function(h){switch(h.label){case 0:return[4,this.fi.pi()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(zit(this.persistenceKey,r)))&&(o=Kit.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(a=this.storage.getItem(this.yi))&&(s=this.vi(a))&&this.Si(s),u=0,c=this.mi;u<c.length;u++)this.Ei(c[u]);return this.mi=[],this.window.addEventListener("unload",(function(){return l.Di()})),this.Ii=!0,[2]}}))}))},t.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},t.prototype.Ci=function(){return this.Ni(this.Ti)},t.prototype.xi=function(t){var e=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Fi=function(t){this.ki(t,"pending")},t.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},t.prototype.$i=function(t){var e="not-current";if(this.xi(t)){var n=this.storage.getItem(qit(this.persistenceKey,t));if(n){var r=Git.hi(t,n);r&&(e=r.state)}}return this.Li.ui(t),this.bi(),e},t.prototype.Bi=function(t){this.Li.li(t),this.bi()},t.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},t.prototype.Ui=function(t){this.removeItem(qit(this.persistenceKey,t))},t.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.Mi(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},t.prototype.ji=function(t){this.Gi(t)},t.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Mtt("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Mtt("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Mtt("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ei=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Mtt("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void Ftt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return Object(EP.b)(e,void 0,void 0,(function(){var t,e,r,i,o,a;return Object(EP.d)(this,(function(s){if(this.Ii){if(null!==n.key)if(this.Pi.test(n.key)){if(null==n.newValue)return t=this.zi(n.key),[2,this.Hi(t,null)];if(e=this.Ji(n.key,n.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(r=this.Yi(n.key,n.newValue)))return[2,this.Xi(r)]}else if(this.Vi.test(n.key)){if(null!==n.newValue&&(i=this.Zi(n.key,n.newValue)))return[2,this.tr(i)]}else if(n.key===this.yi){if(null!==n.newValue&&(o=this.vi(n.newValue)))return[2,this.Si(o)]}else n.key===this.Ri&&(a=function(t){var e=Uit.ai;if(null!=t)try{var n=JSON.parse(t);Vtt("number"==typeof n),e=n}catch(t){Ftt("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Uit.ai&&this.si(a)}else this.mi.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),t.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},t.prototype.ki=function(t,e,n){var r=new Hit(this.currentUser,t,e,n),i=Wit(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.Mi=function(t){var e=Wit(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Gi=function(t){this.storage.setItem(this.yi,JSON.stringify({clientId:this._i,onlineState:t}))},t.prototype.Qi=function(t,e,n){var r=qit(this.persistenceKey,t),i=new Git(t,e,n);this.setItem(r,i.ci())},t.prototype.zi=function(t){var e=this.Pi.exec(t);return e?e[1]:null},t.prototype.Ji=function(t,e){var n=this.zi(t);return Kit.hi(n,e)},t.prototype.Yi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return Hit.hi(new Vit(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Zi=function(t,e){var n=this.Vi.exec(t),r=Number(n[1]);return Git.hi(r,e)},t.prototype.vi=function(t){return Xit.hi(t)},t.prototype.Xi=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fi.er(t.batchId,t.state,t.error)]:(Mtt("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},t.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.fi.sr(a,s).then((function(){n.Ti=r}))},t.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},t.prototype.Ni=function(t){var e=Uet();return t.forEach((function(t,n){e=e.Ot(n.activeTargetIds)})),e},t}(),Qit=function(){function t(){this.ir=new $it,this.rr={},this.di=null,this.si=null}return t.prototype.Fi=function(t){},t.prototype.Oi=function(t,e,n){},t.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},t.prototype.Ki=function(t,e,n){this.rr[t]=e},t.prototype.Bi=function(t){this.ir.li(t)},t.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.Ui=function(t){delete this.rr[t]},t.prototype.Ci=function(){return this.ir.activeTargetIds},t.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.start=function(){return this.ir=new $it,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Di=function(){},t.prototype.oi=function(t){},t}(),Jit=function(){function t(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}return t.prototype.hr=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=vrt(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=mrt(i,e,e,this.ar))}for(var o=e,a=0,s=this.mutations;a<s.length;a++){var u=s[a];u.key.isEqual(t)&&(e=mrt(u,e,o,this.ar))}return e},t.prototype.lr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),jet())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Htt(this.mutations,t.mutations,(function(t,e){return yrt(t,e)}))&&Htt(this.baseMutations,t.baseMutations,(function(t,e){return yrt(t,e)}))},t}(),Zit=function(){function t(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}return t.from=function(e,n,r){Vtt(e.mutations.length===r.length);for(var i=Let,o=e.mutations,a=0;a<o.length;a++)i=i.ot(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),tot=function(){function t(){this.wr=new ret((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Er=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),t.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},t.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},t.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?git.resolve(n):this.Pr(t,e)},t.prototype.getEntries=function(t,e){return this.gr(t,e)},t.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},t.prototype.mr=function(){},t}(),eot="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",not=function(){function t(){this.yr=[]}return t.prototype.pr=function(t){this.yr.push(t)},t.prototype.br=function(){this.yr.forEach((function(t){return t()}))},t}(),rot=function(){function t(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}return t.prototype.Cr=function(t,e){var n=this;return this.Sr.Nr(t,e).next((function(r){return n.Fr(t,e,r)}))},t.prototype.Fr=function(t,e,n){return this.vr.Rr(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.kr=function(t,e,n){var r=Pet();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.ot(t,e)})),r},t.prototype.Or=function(t,e){var n=this;return this.vr.getEntries(t,e).next((function(e){return n.Mr(t,e)}))},t.prototype.Mr=function(t,e){var n=this;return this.Sr.$r(t,e).next((function(r){var i=n.kr(t,e,r),o=Det();return i.forEach((function(t,e){e||(e=new Drt(t,oet.min())),o=o.ot(t,e)})),o}))},t.prototype.Lr=function(t,e,n){return function(t){return het.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Br(t,e.path):zrt(e)?this.qr(t,e,n):this.Ur(t,e,n)},t.prototype.Br=function(t,e){return this.Cr(t,new het(e)).next((function(t){var e=Fet();return t instanceof Nrt&&(e=e.ot(t.key,t)),e}))},t.prototype.qr=function(t,e,n){var r=this,i=e.collectionGroup,o=Fet();return this.Dr.Kr(t,i).next((function(a){return git.forEach(a,(function(a){var s=function(t,e){return new Mrt(e,null,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(e,a.child(i));return r.Ur(t,s,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ur=function(t,e,n){var r,i,o=this;return this.vr.Lr(t,e,n).next((function(n){return r=n,o.Sr.Qr(t,e)})).next((function(e){return o.Wr(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c),h=mrt(u,l,l,o.ar);r=h instanceof Nrt?r.ot(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Qrt(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=jet(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof wrt&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.vr.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Nrt&&(c=c.ot(t,e))})),c}))},t}(),iot=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}return t.zr=function(e,n){for(var r=jet(),i=jet(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function oot(t,e){var n=t[1],r=e[1],i=qtt(t[0],e[0]);return 0===i?qtt(n,r):i}var aot=function(){function t(t){this.Hr=t,this.buffer=new Ret(oot),this.Jr=0}return t.prototype.Yr=function(){return++this.Jr},t.prototype.Xr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();oot(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),sot={Zr:!1,eo:0,no:0,so:0},uot=function(){function t(t,e,n){this.io=t,this.ro=e,this.oo=n}return t.ao=function(e){return new t(e,t.ho,t.co)},t}();uot.uo=-1,uot.lo=1048576,uot._o=41943040,uot.ho=10,uot.co=1e3,uot.fo=new uot(uot._o,uot.ho,uot.co),uot.do=new uot(uot.uo,0,0);var cot=function(){function t(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}return t.prototype.start=function(t){this.wo.params.io!==uot.uo&&this.Io(t)},t.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(t.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),t.prototype.Io=function(t){var e=this,n=this.Eo?3e5:6e4;Mtt("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.hs.Vn("lru_garbage_collection",n,(function(){return Object(EP.b)(e,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:this.To=null,this.Eo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mo(this.wo)];case 2:return n.sent(),[3,7];case 3:return wit(e=n.sent())?(Mtt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Tat(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Io(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),lot=function(){function t(t,e){this.Ao=t,this.params=e}return t.prototype.Ro=function(t,e){return this.Ao.Po(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Vo=function(t,e){var n=this;if(0===e)return git.resolve(Uit.ai);var r=new aot(e);return this.Ao.Ce(t,(function(t){return r.Xr(t.sequenceNumber)})).next((function(){return n.Ao.yo(t,(function(t){return r.Xr(t)}))})).next((function(){return r.maxValue}))},t.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},t.prototype.bo=function(t,e){return this.Ao.bo(t,e)},t.prototype.vo=function(t,e){var n=this;return this.params.io===uot.uo?(Mtt("LruGarbageCollector","Garbage collection skipped; disabled"),git.resolve(sot)):this.So(t).next((function(r){return r<n.params.io?(Mtt("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),sot):n.Do(t,e)}))},t.prototype.So=function(t){return this.Ao.So(t)},t.prototype.Do=function(t,e){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.Ro(t,this.params.ro).next((function(e){return e>c.params.oo?(Mtt("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.oo+" from "+e),r=c.params.oo):r=e,o=Date.now(),c.Vo(t,r)})).next((function(r){return n=r,a=Date.now(),c.po(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.bo(t,n)})).next((function(t){return u=Date.now(),Ptt()<=O6.a.DEBUG&&Mtt("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),git.resolve({Zr:!0,eo:r,no:i,so:t})}))},t}();function hot(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=dot(e)),e=fot(t.get(n),e);return dot(e)}function fot(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function dot(t){return t+"\x01\x01"}function pot(t){var e=t.length;if(Vtt(e>=2),2===e)return Vtt("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),set.U();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("\x01",o);switch((a<0||a>n)&&jtt(),t.charAt(a+1)){case"\x01":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(o,a),i+="\0";break;case"\x11":i+=t.substring(o,a+1);break;default:jtt()}o=a+2}return new set(r)}var vot=function(t){this.Co=t};function mot(t,e){if(e.document)return function(t,e,n){var r=Ont(t,e.name),i=Int(e.updateTime),o=new Trt({mapValue:{fields:e.fields}});return new Nrt(r,i,o,{hasCommittedMutations:!!n})}(t.Co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=het.Z(e.noDocument.path),r=wot(e.noDocument.readTime);return new Drt(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=het.Z(e.unknownDocument.path),o=wot(e.unknownDocument.version);return new Prt(i,o)}return jtt()}function got(t,e,n){var r=yot(n),i=e.key.path.F().L();if(e instanceof Nrt){var o=function(t,e){return{name:Rnt(t,e.key),fields:e.rn().mapValue.fields,updateTime:knt(t,e.version.v())}}(t.Co,e);return new Kot(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof Drt){var a=e.key.path.L(),s=_ot(e.version),u=e.hasCommittedMutations;return new Kot(null,new Hot(a,s),null,u,r,i)}if(e instanceof Prt){var c=e.key.path.L(),l=_ot(e.version);return new Kot(new Got(c,l),null,null,!0,r,i)}return jtt()}function yot(t){var e=t.v();return[e.seconds,e.nanoseconds]}function bot(t){var e=new iet(t[0],t[1]);return oet.V(e)}function _ot(t){var e=t.v();return new Vot(e.seconds,e.nanoseconds)}function wot(t){var e=new iet(t.seconds,t.nanoseconds);return oet.V(e)}function xot(t,e){var n=(e.baseMutations||[]).map((function(e){return Bnt(t.Co,e)})),r=e.mutations.map((function(e){return Bnt(t.Co,e)})),i=iet.fromMillis(e.localWriteTimeMs);return new Jit(e.batchId,i,n,r)}function Cot(t){var e,n,r=wot(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?wot(t.lastLimboFreeSnapshotVersion):oet.min();return void 0!==t.query.documents?(Vtt(1===(n=t.query).documents.length),e=qrt(Lrt(Dnt(n.documents[0])))):e=function(t){var e=Dnt(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Vtt(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=function t(e){return e?void 0!==e.unaryFilter?[Xnt(e)]:void 0!==e.fieldFilter?[Knt(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):jtt():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new fit(Gnt(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return fet(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=znt(n.startAt));var l=null;return n.endAt&&(l=znt(n.endAt)),qrt(Frt(e,i,s,a,u,"F",c,l))}(t.query),new xet(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ktt.fromBase64String(t.resumeToken))}function kot(t,e){var n,r=_ot(e.nt),i=_ot(e.lastLimboFreeSnapshotVersion);n=bet(e.target)?jnt(t.Co,e.target):Vnt(t.Co,e.target);var o=e.resumeToken.toBase64();return new $ot(e.targetId,get(e.target),r,o,e.sequenceNumber,i,n)}var Eot=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}return t.Fo=function(e,n,r,i){return Vtt(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.ko=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Tot(t).rs({index:Wot.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Oo=function(t,e,n,r){var i=this,o=Aot(t),a=Tot(t);return a.add({}).next((function(s){Vtt("number"==typeof s);for(var u=new Jit(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Lnt(t.Co,e)})),i=n.mutations.map((function(e){return Lnt(t.Co,e)}));return new Wot(e,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,u),l=[],h=new Ret((function(t,e){return qtt(t.B(),e.B())})),f=0,d=r;f<d.length;f++){var p=d[f],v=qot.key(i.userId,p.key.path,s);h=h.add(p.key.path.F()),l.push(a.put(c)),l.push(o.put(v,qot.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Dr.Mo(t,e))})),t.pr((function(){i.xo[s]=u.keys()})),git.kn(l).next((function(){return u}))}))},t.prototype.$o=function(t,e){var n=this;return Tot(t).get(e).next((function(t){return t?(Vtt(t.userId===n.userId),xot(n.serializer,t)):null}))},t.prototype.Lo=function(t,e){var n=this;return this.xo[e]?git.resolve(this.xo[e]):this.$o(t,e).next((function(t){if(t){var r=t.keys();return n.xo[e]=r,r}return null}))},t.prototype.Bo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Tot(t).rs({index:Wot.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Vtt(e.batchId>=r),o=xot(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Tot(t).rs({index:Wot.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Tot(t).ts(Wot.userMutationsIndex,n).next((function(t){return t.map((function(t){return xot(e.serializer,t)}))}))},t.prototype.Nr=function(t,e){var n=this,r=qot.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Aot(t).rs({range:i},(function(r,i,a){var s=r[0],u=r[2],c=pot(r[1]);if(s===n.userId&&e.path.isEqual(c))return Tot(t).get(u).next((function(t){if(!t)throw jtt();Vtt(t.userId===n.userId),o.push(xot(n.serializer,t))}));a.done()})).next((function(){return o}))},t.prototype.$r=function(t,e){var n=this,r=new Ret(qtt),i=[];return e.forEach((function(e){var o=qot.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Aot(t).rs({range:a},(function(t,i,o){var a=t[0],s=t[2],u=pot(t[1]);a===n.userId&&e.path.isEqual(u)?r=r.add(s):o.done()}));i.push(s)})),git.kn(i).next((function(){return n.Ko(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=qot.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Ret(qtt);return Aot(t).rs({range:a},(function(t,e,o){var a=t[0],u=t[2],c=pot(t[1]);a===n.userId&&r.M(c)?c.length===i&&(s=s.add(u)):o.done()})).next((function(){return n.Ko(t,s)}))},t.prototype.Ko=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Tot(t).get(e).next((function(t){if(null===t)throw jtt();Vtt(t.userId===n.userId),r.push(xot(n.serializer,t))})))})),git.kn(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return Iot(t.Wo,this.userId,e).next((function(r){return t.pr((function(){n.jo(e.batchId)})),git.forEach(r,(function(e){return n.No.Go(t,e)}))}))},t.prototype.jo=function(t){delete this.xo[t]},t.prototype.zo=function(t){var e=this;return this.ko(t).next((function(n){if(!n)return git.resolve();var r=IDBKeyRange.lowerBound(qot.prefixForUser(e.userId)),i=[];return Aot(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=pot(t[1]);i.push(o)}else r.done()})).next((function(){Vtt(0===i.length)}))}))},t.prototype.Ho=function(t,e){return Sot(t,this.userId,e)},t.prototype.Jo=function(t){var e=this;return Rot(t).get(this.userId).next((function(t){return t||new zot(e.userId,-1,"")}))},t}();function Sot(t,e,n){var r=qot.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Aot(t).rs({range:o,ss:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(a=!0),r.done()})).next((function(){return a}))}function Iot(t,e,n){var r=t.store(Wot.store),i=t.store(qot.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.rs({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Vtt(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=qot.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return git.kn(o).next((function(){return c}))}function Tot(t){return hat.Kn(t,Wot.store)}function Aot(t){return hat.Kn(t,qot.store)}function Rot(t){return hat.Kn(t,zot.store)}var Oot=function(){function t(t,e){this.serializer=t,this.Dr=e}return t.prototype.Ir=function(t,e,n){return Pot(t).put(Mot(e),n)},t.prototype.Ar=function(t,e){var n=Pot(t),r=Mot(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Rr=function(t,e){var n=this;return Pot(t).get(Mot(e)).next((function(t){return n.Xo(t)}))},t.prototype.Zo=function(t,e){var n=this;return Pot(t).get(Mot(e)).next((function(t){var e=n.Xo(t);return e?{ta:e,size:Fot(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Pet();return this.ea(t,e,(function(t,e){var i=n.Xo(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype.na=function(t,e){var n=this,r=Pet(),i=new Iet(het.D);return this.ea(t,e,(function(t,e){var o=n.Xo(e);o?(r=r.ot(t,o),i=i.ot(t,Fot(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{sa:r,ia:i}}))},t.prototype.ea=function(t,e,n){if(e.P())return git.resolve();var r=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),i=e._t(),o=i.It();return Pot(t).rs({range:r},(function(t,e,r){for(var a=het.Z(t);o&&het.D(o,a)<0;)n(o,null),o=i.It();o&&o.isEqual(a)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.L()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Lr=function(t,e,n){var r=this,i=Fet(),o=e.path.length+1,a={};if(n.isEqual(oet.min())){var s=e.path.L();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.L(),c=yot(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Kot.collectionReadTimeIndex}return Pot(t).rs(a,(function(t,n,a){if(t.length===o){var s=mot(r.serializer,n);e.path.M(s.key.path)?s instanceof Nrt&&Qrt(e,s)&&(i=i.ot(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.ra=function(t){return new Not(this,!!t&&t.oa)},t.prototype.aa=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Dot(t).get(Xot.key).next((function(t){return Vtt(!!t),t}))},t.prototype.Yo=function(t,e){return Dot(t).put(Xot.key,e)},t.prototype.Xo=function(t){if(t){var e=mot(this.serializer,t);return e instanceof Drt&&e.version.isEqual(oet.min())?null:e}return null},t}(),Not=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ha=e,r.oa=n,r.ca=new ret((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(EP.c)(e,t),e.prototype.Vr=function(t){var e=this,n=[],r=0,i=new Ret((function(t,e){return qtt(t.B(),e.B())}));return this.wr.forEach((function(o,a){var s=e.ca.get(o);if(a){var u=got(e.ha.serializer,a,e.readTime);i=i.add(o.path.F());var c=Fot(u);r+=c-s,n.push(e.ha.Ir(t,o,u))}else if(r-=s,e.oa){var l=got(e.ha.serializer,new Drt(o,oet.min()),e.readTime);n.push(e.ha.Ir(t,o,l))}else n.push(e.ha.Ar(t,o))})),i.forEach((function(r){n.push(e.ha.Dr.Mo(t,r))})),n.push(this.ha.updateMetadata(t,r)),git.kn(n)},e.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next((function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)}))},e.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next((function(t){var e=t.sa;return t.ia.forEach((function(t,e){n.ca.set(t,e)})),e}))},e}(tot);function Dot(t){return hat.Kn(t,Xot.store)}function Pot(t){return hat.Kn(t,Kot.store)}function Mot(t){return t.path.L()}function Fot(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw jtt();e=t.noDocument}return JSON.stringify(e).length}var Lot=function(){function t(){this.ua=new Bot}return t.prototype.Mo=function(t,e){return this.ua.add(e),git.resolve()},t.prototype.Kr=function(t,e){return git.resolve(this.ua.getEntries(e))},t}(),Bot=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Ret(set.D),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.F(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ret(set.D)).L()},t}(),jot=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Vtt(n<r&&n>=0&&r<=10);var o=new xit("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Uot.store)}(t),function(t){t.createObjectStore(zot.store,{keyPath:zot.keyPath}),t.createObjectStore(Wot.store,{keyPath:Wot.keyPath,autoIncrement:!0}).createIndex(Wot.userMutationsIndex,Wot.userMutationsKeyPath,{unique:!0}),t.createObjectStore(qot.store)}(t),Zot(t),function(t){t.createObjectStore(Kot.store)}(t));var a=git.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Yot.store),t.deleteObjectStore($ot.store),t.deleteObjectStore(Qot.store)}(t),Zot(t)),a=a.next((function(){return function(t){var e=t.store(Qot.store),n=new Qot(0,0,oet.min().v(),0);return e.put(Qot.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Wot.store).ts().next((function(n){t.deleteObjectStore(Wot.store),t.createObjectStore(Wot.store,{keyPath:Wot.keyPath,autoIncrement:!0}).createIndex(Wot.userMutationsIndex,Wot.userMutationsKeyPath,{unique:!0});var r=e.store(Wot.store),i=n.map((function(t){return r.put(t)}));return git.kn(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(tat.store,{keyPath:tat.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(Xot.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Kot.store);e.createIndex(Kot.readTimeIndex,Kot.readTimeIndexPath,{unique:!1}),e.createIndex(Kot.collectionReadTimeIndex,Kot.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.rewriteCanonicalIds(o)}))),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Kot.store).rs((function(t,n){e+=Fot(n)})).next((function(){var n=new Xot(e);return t.store(Xot.store).put(Xot.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(zot.store),r=t.store(Wot.store);return n.ts().next((function(n){return git.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(Wot.userMutationsIndex,i).next((function(r){return git.forEach(r,(function(r){Vtt(r.userId===n.userId);var i=xot(e.serializer,r);return Iot(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Yot.store),n=t.store(Kot.store);return t.store(Qot.store).get(Qot.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new set(n),a=function(t){return[0,hot(t)]}(o);r.push(e.get(a).next((function(n){return n?git.resolve():function(n){return e.put(new Yot(0,hot(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return git.kn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Jot.store,{keyPath:Jot.keyPath});var n=e.store(Jot.store),r=new Bot,i=function(t){if(r.add(t)){var e=t.O(),i=t.F();return n.put({collectionId:e,parent:hot(i)})}};return e.store(Kot.store).rs({ss:!0},(function(t,e){var n=new set(t);return i(n.F())})).next((function(){return e.store(qot.store).rs({ss:!0},(function(t,e){var n=pot(t[1]);return i(n.F())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store($ot.store);return n.rs((function(t,r){var i=Cot(r),o=kot(e.serializer,i);return n.put(o)}))},t}(),Vot=function(t,e){this.seconds=t,this.nanoseconds=e},Uot=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Uot.store="owner",Uot.key="owner";var zot=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};zot.store="mutationQueues",zot.keyPath="userId";var Wot=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Wot.store="mutations",Wot.keyPath="batchId",Wot.userMutationsIndex="userMutationsIndex",Wot.userMutationsKeyPath=["userId","batchId"];var qot=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,hot(e)]},t.key=function(t,e,n){return[t,hot(e),n]},t}();qot.store="documentMutations",qot.PLACEHOLDER=new qot;var Hot=function(t,e){this.path=t,this.readTime=e},Got=function(t,e){this.path=t,this.version=e},Kot=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Kot.store="remoteDocuments",Kot.readTimeIndex="readTimeIndex",Kot.readTimeIndexPath="readTime",Kot.collectionReadTimeIndex="collectionReadTimeIndex",Kot.collectionReadTimeIndexPath=["parentPath","readTime"];var Xot=function(t){this.byteSize=t};Xot.store="remoteDocumentGlobal",Xot.key="remoteDocumentGlobalKey";var $ot=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};$ot.store="targets",$ot.keyPath="targetId",$ot.queryTargetsIndexName="queryTargetsIndex",$ot.queryTargetsKeyPath=["canonicalId","targetId"];var Yot=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Yot.store="targetDocuments",Yot.keyPath=["targetId","path"],Yot.documentTargetsIndex="documentTargetsIndex",Yot.documentTargetsKeyPath=["path","targetId"];var Qot=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qot.key="targetGlobalKey",Qot.store="targetGlobal";var Jot=function(t,e){this.collectionId=t,this.parent=e};function Zot(t){t.createObjectStore(Yot.store,{keyPath:Yot.keyPath}).createIndex(Yot.documentTargetsIndex,Yot.documentTargetsKeyPath,{unique:!0}),t.createObjectStore($ot.store,{keyPath:$ot.keyPath}).createIndex($ot.queryTargetsIndexName,$ot.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Qot.store)}Jot.store="collectionParents",Jot.keyPath=["collectionId","parent"];var tat=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};tat.store="clientMetadata",tat.keyPath="clientId";var eat=Object(EP.g)(Object(EP.g)(Object(EP.g)([zot.store,Wot.store,qot.store,Kot.store,$ot.store,Uot.store,Qot.store,Yot.store],[tat.store]),[Xot.store]),[Jot.store]),nat=function(){function t(){this.la=new Bot}return t.prototype.Mo=function(t,e){var n=this;if(!this.la.has(e)){var r=e.O(),i=e.F();t.pr((function(){n.la.add(e)}));var o={collectionId:r,parent:hot(i)};return rat(t).put(o)}return git.resolve()},t.prototype.Kr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Gtt(e),""],!1,!0);return rat(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(pot(o.parent))}return n}))},t}();function rat(t){return hat.Kn(t,Jot.store)}var iat=function(){function t(t){this._a=t}return t.prototype.next=function(){return this._a+=2,this._a},t.fa=function(){return new t(0)},t.da=function(){return new t(-1)},t}(),oat=function(){function t(t,e){this.No=t,this.serializer=e}return t.prototype.wa=function(t){var e=this;return this.Ea(t).next((function(n){var r=new iat(n.highestTargetId);return n.highestTargetId=r.next(),e.Ta(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ia=function(t){return this.Ea(t).next((function(t){return oet.V(new iet(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ma=function(t){return this.Ea(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Aa=function(t,e,n){var r=this;return this.Ea(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.v()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ta(t,i)}))},t.prototype.Ra=function(t,e){var n=this;return this.Pa(t,e).next((function(){return n.Ea(t).next((function(r){return r.targetCount+=1,n.ga(e,r),n.Ta(t,r)}))}))},t.prototype.Va=function(t,e){return this.Pa(t,e)},t.prototype.ya=function(t,e){var n=this;return this.pa(t,e.targetId).next((function(){return aat(t).delete(e.targetId)})).next((function(){return n.Ea(t)})).next((function(e){return Vtt(e.targetCount>0),e.targetCount-=1,n.Ta(t,e)}))},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return aat(t).rs((function(a,s){var u=Cot(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.ya(t,u)))})).next((function(){return git.kn(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return aat(t).rs((function(t,n){var r=Cot(n);e(r)}))},t.prototype.Ea=function(t){return sat(t).get(Qot.key).next((function(t){return Vtt(null!==t),t}))},t.prototype.Ta=function(t,e){return sat(t).put(Qot.key,e)},t.prototype.Pa=function(t,e){return aat(t).put(kot(this.serializer,e))},t.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.ba=function(t){return this.Ea(t).next((function(t){return t.targetCount}))},t.prototype.va=function(t,e){var n=get(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return aat(t).rs({range:r,index:$ot.queryTargetsIndexName},(function(t,n,r){var o=Cot(n);yet(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Sa=function(t,e,n){var r=this,i=[],o=uat(t);return e.forEach((function(e){var a=hot(e.path);i.push(o.put(new Yot(n,a))),i.push(r.No.Da(t,n,e))})),git.kn(i)},t.prototype.Ca=function(t,e,n){var r=this,i=uat(t);return git.forEach(e,(function(e){var o=hot(e.path);return git.kn([i.delete([n,o]),r.No.Na(t,n,e)])}))},t.prototype.pa=function(t,e){var n=uat(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xa=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=uat(t),i=jet();return r.rs({range:n,ss:!0},(function(t,e,n){var r=pot(t[1]),o=new het(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ho=function(t,e){var n=hot(e.path),r=IDBKeyRange.bound([n],[Gtt(n)],!1,!0),i=0;return uat(t).rs({index:Yot.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return aat(t).get(e).next((function(t){return t?Cot(t):null}))},t}();function aat(t){return hat.Kn(t,$ot.store)}function sat(t){return hat.Kn(t,Qot.store)}function uat(t){return hat.Kn(t,Yot.store)}var cat="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lat=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Fa=n,r}return Object(EP.c)(e,t),e}(not),hat=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=a,this.document=s,this.ka=c,this.Oa=l,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.Ln())throw new Ntt(Ott.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new pat(this,i),this.Qa=n+"main",this.serializer=new vot(u),this.Wa=new yit(this.Qa,10,new jot(this.serializer)),this.ja=new oat(this.No,this.serializer),this.Dr=new nat,this.vr=function(t,e){return new Oot(t,e)}(this.serializer,this.Dr),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===l&&Ftt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Kn=function(t,e){if(t instanceof lat)return yit.Kn(t.Wo,e);throw jtt()},t.prototype.start=function(){var t=this;return this.za().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ntt(Ott.FAILED_PRECONDITION,cat);return t.Ha(),t.Ja(),t.Ya(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.ja.ma(e)}))})).then((function(e){t.Ma=new Uit(e,t.ka)})).then((function(){t.$a=!0})).catch((function(e){return t.Wa&&t.Wa.close(),Promise.reject(e)}))},t.prototype.Xa=function(t){var e=this;return this.Ka=function(n){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return this.Ii?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Za=function(t){var e=this;this.Wa.jn((function(n){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.za=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return dat(e).put(new tat(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.eh(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.Ka(!1)})))}))})).next((function(){return t.nh(e)})).next((function(n){return t.isPrimary&&!n?t.sh(e).next((function(){return!1})):!!n&&t.ih(e).next((function(){return!0}))}))})).catch((function(e){if(wit(e))return Mtt("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Mtt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.eh=function(t){var e=this;return fat(t).get(Uot.key).next((function(t){return git.resolve(e.rh(t))}))},t.prototype.oh=function(t){return dat(t).delete(this.clientId)},t.prototype.ah=function(){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i=this;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Kn(e,tat.store);return n.ts().next((function(t){var e=i.uh(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return git.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)this.Ga.removeItem(this.lh(r[n].clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,(function(){return t.za().then((function(){return t.ah()})).then((function(){return t.Ya()}))}))},t.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nh=function(t){var e=this;return this.Oa?git.resolve(!0):fat(t).get(Uot.key).next((function(n){if(null!==n&&e.hh(n.leaseTimestampMs,5e3)&&!e._h(n.ownerId)){if(e.rh(n)&&e.networkEnabled)return!0;if(!e.rh(n)){if(!n.allowTabSynchronization)throw new Ntt(Ott.FAILED_PRECONDITION,cat);return!1}}return!(!e.networkEnabled||!e.inForeground)||dat(t).ts().next((function(t){return void 0===e.uh(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&Mtt("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Di=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t=this;return Object(EP.d)(this,(function(e){switch(e.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[Uot.store,tat.store],(function(e){var n=new lat(e,Uit.ai);return t.sh(n).next((function(){return t.oh(n)}))}))];case 1:return e.sent(),this.Wa.close(),this.Eh(),[2]}}))}))},t.prototype.uh=function(t,e){var n=this;return t.filter((function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)}))},t.prototype.pi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return dat(e).ts().next((function(e){return t.uh(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Th=function(t){return Eot.Fo(t,this.serializer,this.Dr,this.No)},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.Ah=function(){return this.Dr},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Mtt("IndexedDbPersistence","Starting transaction:",t),this.Wa.runTransaction(t,"readonly"===e?"readonly":"readwrite",eat,(function(o){return r=new lat(o,i.Ma?i.Ma.next():Uit.ai),"readwrite-primary"===e?i.eh(r).next((function(t){return!!t||i.nh(r)})).next((function(e){if(!e)throw Ftt("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.fn.Cs((function(){return i.Ka(!1)})),new Ntt(Ott.FAILED_PRECONDITION,eot);return n(r)})).next((function(t){return i.ih(r).next((function(){return t}))})):i.Rh(r).next((function(){return n(r)}))})).then((function(t){return r.br(),t}))},t.prototype.Rh=function(t){var e=this;return fat(t).get(Uot.key).next((function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ntt(Ott.FAILED_PRECONDITION,cat)}))},t.prototype.ih=function(t){var e=new Uot(this.clientId,this.allowTabSynchronization,Date.now());return fat(t).put(Uot.key,e)},t.Ln=function(){return yit.Ln()},t.prototype.sh=function(t){var e=this,n=fat(t);return n.get(Uot.key).next((function(t){return e.rh(t)?(Mtt("IndexedDbPersistence","Releasing primary lease."),n.delete(Uot.key)):git.resolve()}))},t.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ftt("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},t.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},t.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws((function(){return e.Di()}))},this.window.addEventListener("unload",this.La))},t.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},t.prototype._h=function(t){var e;try{var n=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return Mtt("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ftt("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){Ftt("Failed to set zombie client id.",t)}},t.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},t.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function fat(t){return hat.Kn(t,Uot.store)}function dat(t){return hat.Kn(t,tat.store)}var pat=function(){function t(t,e){this.db=t,this.wo=new lot(this,e)}return t.prototype.Po=function(t){var e=this.Ph(t);return this.db.Ih().ba(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Ph=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},t.prototype.yo=function(t,e){return this.gh(t,(function(t,n){return e(n)}))},t.prototype.Da=function(t,e,n){return vat(t,n)},t.prototype.Na=function(t,e,n){return vat(t,n)},t.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},t.prototype.Go=function(t,e){return vat(t,e)},t.prototype.Vh=function(t,e){return function(t,e){var n=!1;return Rot(t).os((function(r){return Sot(t,r,e).next((function(t){return t&&(n=!0),git.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.bo=function(t,e){var n=this,r=this.db.mh().ra(),i=[],o=0;return this.gh(t,(function(a,s){if(s<=e){var u=n.Vh(t,a).next((function(e){if(!e)return o++,r.Rr(t,a).next((function(){return r.Ar(a),uat(t).delete([0,hot(a.path)])}))}));i.push(u)}})).next((function(){return git.kn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.Fa);return this.db.Ih().Va(t,n)},t.prototype.yh=function(t,e){return vat(t,e)},t.prototype.gh=function(t,e){var n,r=uat(t),i=Uit.ai;return r.rs({index:Yot.documentTargetsIndex},(function(t,r){var o=r.path,a=r.sequenceNumber;0===t[0]?(i!==Uit.ai&&e(new het(pot(n)),i),i=a,n=o):i=Uit.ai})).next((function(){i!==Uit.ai&&e(new het(pot(n)),i)}))},t.prototype.So=function(t){return this.db.mh().aa(t)},t}();function vat(t,e){return uat(t).put(function(t,e){return new Yot(0,hot(t.path),e)}(e,t.Fa))}function mat(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var gat=function(){function t(t,e,n){this.persistence=t,this.ph=e,this.bh=new Iet(qtt),this.Sh=new ret((function(t){return get(t)}),yet),this.Dh=oet.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new rot(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}return t.prototype.mo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.vo(n,e.bh)}))},t}();function yat(t,e){var n=Utt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ch.ra({oa:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=git.resolve();return o.forEach((function(t){a=a.next((function(){return r.Rr(e,t)})).next((function(e){var o=e,a=n.dr.get(t);Vtt(null!==a),(!o||o.version.h(a)<0)&&(o=i.hr(t,o,n))&&r.Ir(o,n._r)}))})),a.next((function(){return t.Sr.Qo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Nh.Or(t,r)}))}))}function bat(t){var e=Utt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ja.Ia(t)}))}function _at(t,e){var n=Utt(t),r=e.nt,i=n.bh;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ch.ra({oa:!0});i=n.bh;var a=[];e.zt.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.ja.Ca(t,e.se,o).next((function(){return n.ja.Sa(t,e.ee,o)})));var u=e.resumeToken;if(u.o()>0){var c=s.it(u,r).st(t.Fa);i=i.ot(o,c),function(t,e,n){return Vtt(e.resumeToken.o()>0),0===t.resumeToken.o()||e.nt.p()-t.nt.p()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(s,c,e)&&a.push(n.ja.Va(t,c))}}}));var s=Det(),u=jet();if(e.Jt.forEach((function(t,e){u=u.add(t)})),a.push(o.getEntries(t,u).next((function(i){e.Jt.forEach((function(u,c){var l=i.get(u);c instanceof Drt&&c.version.isEqual(oet.min())?(o.Ar(u,r),s=s.ot(u,c)):null==l||c.version.h(l.version)>0||0===c.version.h(l.version)&&l.hasPendingWrites?(o.Ir(c,r),s=s.ot(u,c)):Mtt("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.Yt.has(u)&&a.push(n.persistence.No.yh(t,u))}))}))),!r.isEqual(oet.min())){var c=n.ja.Ia(t).next((function(e){return n.ja.Aa(t,t.Fa,r)}));a.push(c)}return git.kn(a).next((function(){return o.apply(t)})).next((function(){return n.Nh.Mr(t,s)}))})).then((function(t){return n.bh=i,t}))}function wat(t,e){var n=Utt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Sr.Bo(t,e)}))}function xat(t,e){var n=Utt(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ja.va(t,e).next((function(i){return i?git.resolve(r=i):n.ja.wa(t).next((function(i){return r=new xet(e,i,0,t.Fa),n.ja.Ra(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.bh.get(t.targetId);return(null===r||t.nt.h(r.nt)>0)&&(n.bh=n.bh.ot(t.targetId,t),n.Sh.set(e,t.targetId)),t}))}function Cat(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:r=Utt(t),i=r.bh.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.No.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!wit(a=s.sent()))throw a;return Mtt("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.bh=r.bh.remove(e),r.Sh.delete(i.target),[2]}}))}))}function kat(t,e,n){var r=Utt(t),i=oet.min(),o=jet();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Utt(t),i=r.Sh.get(n);return void 0!==i?git.resolve(r.bh.get(i)):r.ja.va(e,n)}(r,t,qrt(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ja.xa(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.ph.Lr(t,e,n?i:oet.min(),n?o:jet())})).next((function(t){return{documents:t,Fh:o}}))}))}function Eat(t,e){var n=Utt(t),r=Utt(n.ja),i=n.bh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function Sat(t){var e=Utt(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Utt(t),i=Det(),o=yot(n),a=Pot(e),s=IDBKeyRange.lowerBound(o,!0);return a.rs({index:Kot.readTimeIndex,range:s},(function(t,e){var n=mot(r.serializer,e);i=i.ot(n.key,n),o=e.readTime})).next((function(){return{kh:i,readTime:bot(o)}}))}(e.Ch,t,e.Dh)})).then((function(t){var n=t.kh;return e.Dh=t.readTime,n}))}function Iat(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){return[2,(e=Utt(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Pot(t),n=oet.min();return e.rs({index:Kot.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=bot(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Dh=t}))]}))}))}function Tat(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){if(t.code!==Ott.FAILED_PRECONDITION||t.message!==eot)throw t;return Mtt("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Aat=function(){function t(){this.Oh=new Ret(Rat.Mh),this.$h=new Ret(Rat.Lh)}return t.prototype.P=function(){return this.Oh.P()},t.prototype.Da=function(t,e){var n=new Rat(t,e);this.Oh=this.Oh.add(n),this.$h=this.$h.add(n)},t.prototype.Bh=function(t,e){var n=this;t.forEach((function(t){return n.Da(t,e)}))},t.prototype.Na=function(t,e){this.qh(new Rat(t,e))},t.prototype.Uh=function(t,e){var n=this;t.forEach((function(t){return n.Na(t,e)}))},t.prototype.Kh=function(t){var e=this,n=new het(new set([])),r=new Rat(n,t),i=new Rat(n,t+1),o=[];return this.$h.xt([r,i],(function(t){e.qh(t),o.push(t.key)})),o},t.prototype.Qh=function(){var t=this;this.Oh.forEach((function(e){return t.qh(e)}))},t.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},t.prototype.Wh=function(t){var e=new het(new set([])),n=new Rat(e,t),r=new Rat(e,t+1),i=jet();return this.$h.xt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ho=function(t){var e=new Rat(t,0),n=this.Oh.kt(e);return null!==n&&t.isEqual(n.key)},t}(),Rat=function(){function t(t,e){this.key=t,this.jh=e}return t.Mh=function(t,e){return het.D(t.key,e.key)||qtt(t.jh,e.jh)},t.Lh=function(t,e){return qtt(t.jh,e.jh)||het.D(t.key,e.key)},t}(),Oat=function(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t},Nat=function(){function t(){this.zh=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Hh=function(){},t.prototype.Jh=function(t){this.zh=t,t(Vit.UNAUTHENTICATED)},t.prototype.Yh=function(){this.zh=null},t}(),Dat=function(){function t(t){var e=this;this.Xh=null,this.currentUser=Vit.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then((function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.tc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.tc!==e?(Mtt("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Vtt("string"==typeof n.accessToken),new Oat(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Hh=function(){this.forceRefresh=!0},t.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},t.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},t.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return Vtt(null===t||"string"==typeof t),new Vit(t)},t}(),Pat=function(){function t(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=Vit.ni}return Object.defineProperty(t.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Mat=function(){function t(t,e){this.nc=t,this.sc=e}return t.prototype.getToken=function(){return Promise.resolve(new Pat(this.nc,this.sc))},t.prototype.Jh=function(t){t(Vit.ni)},t.prototype.Yh=function(){},t.prototype.Hh=function(){},t}(),Fat=function(){function t(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new mit(t,e)}return t.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.uc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.lc()},t.prototype.stop=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype._c=function(){this.state=0,this.Vs.reset()},t.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,(function(){return t.dc()})))},t.prototype.wc=function(t){this.Ec(),this.stream.send(t)},t.prototype.dc=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){return this.uc()?[2,this.close(0)]:[2]}))}))},t.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},t.prototype.close=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(n){switch(n.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==t?this.Vs.reset():e&&e.code===Ott.RESOURCE_EXHAUSTED?(Ftt(e.toString()),Ftt("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):e&&e.code===Ott.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ic(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Tc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.mc(this.ac),n=this.ac;this.oc.getToken().then((function(e){t.ac===n&&t.Ac(e)}),(function(n){e((function(){var e=new Ntt(Ott.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Rc(e)}))}))},t.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc((function(){n((function(){return e.state=2,e.listener.gc()}))})),this.stream.Ic((function(t){n((function(){return e.Rc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn((function(){return Object(EP.b)(t,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Rc=function(t){return Mtt("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.mc=function(t){var e=this;return function(n){e.fn.ws((function(){return e.ac===t?n():(Mtt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Lat=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,a}return Object(EP.c)(e,t),e.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},e.prototype.onMessage=function(t){this.Vs.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:jtt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ke?(Vtt(void 0===e||"string"==typeof e),Ktt.fromBase64String(e||"")):(Vtt(void 0===e||e instanceof Uint8Array),Ktt.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,s=a&&function(t){var e=void 0===t.code?Ott.UNKNOWN:Eet(t.code);return new Ntt(e,t.message||"")}(a);n=new $et(r,i,o,s||null)}else if("documentChange"in e){var u=e.documentChange,c=Ont(t,u.document.name),l=Int(u.document.updateTime),h=new Trt({mapValue:{fields:u.document.fields}}),f=new Nrt(c,l,h,{});n=new Ket(u.targetIds||[],u.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){var d=e.documentDelete,p=Ont(t,d.document),v=d.readTime?Int(d.readTime):oet.min(),m=new Drt(p,v);n=new Ket([],d.removedTargetIds||[],m.key,m)}else if("documentRemove"in e){var g=e.documentRemove,y=Ont(t,g.document);n=new Ket([],g.removedTargetIds||[],y,null)}else{if(!("filter"in e))return jtt();var b=e.filter,_=new Cet(b.count||0);n=new Xet(b.targetId,_)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return oet.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?oet.min():e.readTime?Int(e.readTime):oet.min()}(t);return this.listener.yc(e,n)},e.prototype.bc=function(t){var e={};e.database=Pnt(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=bet(r)?{documents:jnt(t,r)}:{query:Vnt(t,r)}).targetId=e.targetId,e.resumeToken.o()>0&&(n.resumeToken=Ent(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jtt()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.wc(e)},e.prototype.vc=function(t){var e={};e.database=Pnt(this.serializer),e.removeTarget=t,this.wc(e)},e}(Fat),Bat=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,a.Sc=!1,a}return Object(EP.c)(e,t),Object.defineProperty(e.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Tc=function(){this.Sc&&this.Cc([])},e.prototype.Pc=function(t){return this.rc.Vc("Write",t)},e.prototype.onMessage=function(t){if(Vtt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=function(t,e){return t&&t.length>0?(Vtt(void 0!==e),t.map((function(t){return function(t,e){var n=Int(t.updateTime?t.updateTime:e);n.isEqual(oet.min())&&(n=Int(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new hrt(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Int(t.commitTime);return this.listener.Nc(n,e)}return Vtt(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},e.prototype.Fc=function(){var t={};t.database=Pnt(this.serializer),this.wc(t)},e.prototype.Cc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Lnt(e.serializer,t)}))};this.wc(n)},e}(Fat),jat=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.rc=n,i.serializer=r,i.kc=!1,i}return Object(EP.c)(e,t),e.prototype.Oc=function(){if(this.kc)throw new Ntt(Ott.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mc=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.Mc(t,e,n,i)})).catch((function(t){throw t.code===Ott.UNAUTHENTICATED&&r.credentials.Hh(),t}))},e.prototype.$c=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.$c(t,e,n,i)})).catch((function(t){throw t.code===Ott.UNAUTHENTICATED&&r.credentials.Hh(),t}))},e.prototype.terminate=function(){this.kc=!1},e}((function(){})),Vat=function(){function t(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}return t.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,(function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()})))},t.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,this.Lc>=1&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},t.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},t.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},t.prototype.Qc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qc?(Ftt(e),this.qc=!1):Mtt("OnlineStateTracker",e)},t.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},t}(),Uat=function(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu((function(t){n.ws((function(){return Object(EP.b)(o,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return Qat(this)?(Mtt("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return(e=Utt(t)).Xc.add(4),[4,Wat(e)];case 1:return n.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,zat(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.nu=new Vat(n,r)};function zat(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:if(!Qat(t))return[3,4];e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Wat(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function qat(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return e=Utt(t),Mtt("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,Wat(e)];case 1:return n.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}}))}))}function Hat(t,e){var n=Utt(t);n.Yc.has(e.targetId)||(n.Yc.set(e.targetId,e),Yat(n)?$at(n):fst(n).uc()&&Kat(n,e))}function Gat(t,e){var n=Utt(t),r=fst(n);n.Yc.delete(e),r.uc()&&Xat(n,e),0===n.Yc.size&&(r.uc()?r.fc():Qat(n)&&n.nu.set("Unknown"))}function Kat(t,e){t.su.me(e.targetId),fst(t).bc(e)}function Xat(t,e){t.su.me(e),fst(t).vc(e)}function $at(t){t.su=new Qet({qe:function(e){return t.Hc.qe(e)},Ue:function(e){return t.Yc.get(e)||null}}),fst(t).start(),t.nu.Uc()}function Yat(t){return Qat(t)&&!fst(t).cc()&&t.Yc.size>0}function Qat(t){return 0===Utt(t).Xc.size}function Jat(t){t.su=void 0}function Zat(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return t.Yc.forEach((function(e,n){Kat(t,e)})),[2]}))}))}function tst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(n){return Jat(t),Yat(t)?(t.nu.Wc(e),$at(t)):t.nu.set("Unknown"),[2]}))}))}function est(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:if(t.nu.set("Online"),!(e instanceof $et&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?t.Yc.has(o=i[r])?[4,t.Hc.iu(o,n)]:[3,3]:[3,5];case 2:a.sent(),t.Yc.delete(o),t.su.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),Mtt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,nst(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ket?t.su.be(e):e instanceof Xet?t.su.ke(e):t.su.De(e),n.isEqual(oet.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,bat(t.Gc)];case 8:return i=a.sent(),n.h(i)>=0?[4,function(t,e){var n=t.su.$e(e);return n.zt.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.Yc.get(r);i&&t.Yc.set(r,i.it(n.resumeToken,e))}})),n.Ht.forEach((function(e){var n=t.Yc.get(e);if(n){t.Yc.set(e,n.it(Ktt.u,n.nt)),Xat(t,e);var r=new xet(n.target,e,1,n.sequenceNumber);Kat(t,r)}})),t.Hc.ru(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return Mtt("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,nst(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function nst(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:if(!wit(e))throw e;return t.Xc.add(1),[4,Wat(t)];case 1:return i.sent(),t.nu.set("Offline"),n||(n=function(){return bat(t.Gc)}),t.hs.Cs((function(){return Object(EP.b)(r,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return Mtt("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Xc.delete(1),[4,zat(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function rst(t,e){return e().catch((function(n){return nst(t,n,e)}))}function ist(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:e=Utt(t),n=dst(e),r=e.Jc.length>0?e.Jc[e.Jc.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return Qat(t)&&t.Jc.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,wat(e.Gc,r)];case 3:return null===(i=a.sent())?(0===e.Jc.length&&n.fc(),[3,7]):(r=i.batchId,function(t,e){t.Jc.push(e);var n=dst(t);n.uc()&&n.Dc&&n.Cc(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,nst(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return ost(e)&&ast(e),[2]}}))}))}function ost(t){return Qat(t)&&!dst(t).cc()&&t.Jc.length>0}function ast(t){dst(t).start()}function sst(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return dst(t).Fc(),[2]}))}))}function ust(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){for(e=dst(t),n=0,r=t.Jc;n<r.length;n++)e.Cc(r[n].mutations);return[2]}))}))}function cst(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return r=t.Jc.shift(),i=Zit.from(r,e,n),[4,rst(t,(function(){return t.Hc.ou(i)}))];case 1:return o.sent(),[4,ist(t)];case 2:return o.sent(),[2]}}))}))}function lst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(n){switch(n.label){case 0:return e&&dst(t).Dc?[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return ket(r=e.code)&&r!==Ott.ABORTED?(n=t.Jc.shift(),dst(t)._c(),[4,rst(t,(function(){return t.Hc.au(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,ist(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ost(t)&&ast(t),[2]}}))}))}function hst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return n=Utt(t),e?(n.Xc.delete(2),[4,zat(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Xc.add(2),[4,Wat(n)]);case 3:r.sent(),n.nu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function fst(t){var e=this;return t.hu||(t.hu=function(t,e,n){var r=Utt(t);return r.Oc(),new Lat(e,r.rc,r.credentials,r.serializer,n)}(t.zc,t.hs,{gc:Zat.bind(null,t),Ic:tst.bind(null,t),yc:est.bind(null,t)}),t.Zc.push((function(n){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return n?(t.hu._c(),Yat(t)?$at(t):t.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.hu.stop()];case 2:e.sent(),Jat(t),e.label=3;case 3:return[2]}}))}))}))),t.hu}function dst(t){var e=this;return t.cu||(t.cu=function(t,e,n){var r=Utt(t);return r.Oc(),new Bat(e,r.rc,r.credentials,r.serializer,n)}(t.zc,t.hs,{gc:sst.bind(null,t),Ic:lst.bind(null,t),xc:ust.bind(null,t),Nc:cst.bind(null,t)}),t.Zc.push((function(n){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return n?(t.cu._c(),[4,ist(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.cu.stop()];case 3:e.sent(),t.Jc.length>0&&(Mtt("RemoteStore","Stopping write stream with "+t.Jc.length+" pending writes"),t.Jc=[]),e.label=4;case 4:return[2]}}))}))}))),t.cu}var pst=function(t){this.key=t},vst=function(t){this.key=t},mst=function(){function t(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=jet(),this.Qt=jet(),this.fu=Jrt(t),this.du=new zet(this.fu)}return Object.defineProperty(t.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),t.prototype.Eu=function(t,e){var n=this,r=e?e.Tu:new Wet,i=e?e.du:this.du,o=e?e.Qt:this.Qt,a=i,s=!1,u=Brt(this.query)&&i.size===this.query.limit?i.last():null,c=jrt(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var l=i.get(t),h=e instanceof Nrt?e:null;h&&(h=Qrt(n.query,h)?h:null);var f=!!l&&n.Qt.has(l.key),d=!!h&&(h.Ye||n.Qt.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data().isEqual(h.data())?f!==d&&(r.track({type:3,doc:h}),p=!0):n.Iu(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.fu(h,u)>0||c&&n.fu(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Brt(this.query)||jrt(this.query))for(;a.size>this.query.limit;){var l=Brt(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{du:a,Tu:r,mu:s,Qt:o}},t.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.Vr=function(t,e,n){var r=this,i=this.du;this.du=t.du,this.Qt=t.Qt;var o=t.Tu.Ut();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jtt()}};return n(t)-n(e)}(t.type,e.type)||r.fu(t.doc,e.doc)})),this.Au(n);var a=e?this.Ru():[],s=0===this._u.size&&this.te?1:0,u=s!==this.lu;return this.lu=s,0!==o.length||u?{snapshot:new qet(this.query,t.du,i,o,t.Qt,0===s,u,!1),Pu:a}:{Pu:a}},t.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new Wet,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},t.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},t.prototype.Au=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uu=e.uu.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uu=e.uu.delete(t)})),this.te=t.te)},t.prototype.Ru=function(){var t=this;if(!this.te)return[];var e=this._u;this._u=jet(),this.du.forEach((function(e){t.gu(e.key)&&(t._u=t._u.add(e.key))}));var n=[];return e.forEach((function(e){t._u.has(e)||n.push(new vst(e))})),this._u.forEach((function(t){e.has(t)||n.push(new pst(t))})),n},t.prototype.Vu=function(t){this.uu=t.Fh,this._u=jet();var e=this.Eu(t.documents);return this.Vr(e,!0)},t.prototype.yu=function(){return qet.Gt(this.query,this.du,this.Qt,0===this.lu)},t}(),gst=function(t,e,n){this.query=t,this.targetId=e,this.view=n},yst=function(t){this.key=t,this.pu=!1},bst=function(){function t(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new ret((function(t){return $rt(t)}),Xrt),this.xu=new Map,this.Fu=[],this.ku=new Iet(het.D),this.Ou=new Map,this.Mu=new Aat,this.$u={},this.Lu=new Map,this.Bu=iat.da(),this.onlineState="Unknown",this.qu=void 0}return Object.defineProperty(t.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),t}();function _st(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return n=Gst(t),(i=n.Nu.get(e))?(n.Su.$i(i.targetId),r=i.view.yu(),[3,4]):[3,1];case 1:return[4,xat(n.Gc,qrt(e))];case 2:return o=s.sent(),a=n.Su.$i(o.targetId),[4,wst(n,e,o.targetId,"current"===a)];case 3:r=s.sent(),n.Uu&&Hat(n.bu,o),s.label=4;case 4:return[2,r]}}))}))}function wst(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a,s,u,c;return Object(EP.d)(this,(function(l){switch(l.label){case 0:return t.Ku=function(e,n,r){return function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return(i=e.view.Eu(n)).mu?[4,kat(t.Gc,e.query,!1).then((function(t){return e.view.Eu(t.documents,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.zt.get(e.targetId),a=e.view.Vr(i,t.Uu,o),[2,(Nst(t,e.targetId,a.Pu),a.snapshot)]}}))}))}(t,e,n,r)},[4,kat(t.Gc,e,!0)];case 1:return i=l.sent(),o=new mst(e,i.Fh),a=o.Eu(i.documents),s=Get.Zt(n,r&&"Offline"!==t.onlineState),u=o.Vr(a,t.Uu,s),Nst(t,n,u.Pu),c=new gst(e,n,o),[2,(t.Nu.set(e,c),t.xu.has(n)?t.xu.get(n).push(e):t.xu.set(n,[e]),u.snapshot)]}}))}))}function xst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return n=Utt(t),r=n.Nu.get(e),(i=n.xu.get(r.targetId)).length>1?[2,(n.xu.set(r.targetId,i.filter((function(t){return!Xrt(t,e)}))),void n.Nu.delete(e))]:n.Uu?(n.Su.Bi(r.targetId),n.Su.xi(r.targetId)?[3,2]:[4,Cat(n.Gc,r.targetId,!1).then((function(){n.Su.Ui(r.targetId),Gat(n.bu,r.targetId),Rst(n,r.targetId)})).catch(Tat)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Rst(n,r.targetId),[4,Cat(n.Gc,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Cst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:n=Utt(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,_at(n.Gc,e)];case 2:return r=i.sent(),e.zt.forEach((function(t,e){var r=n.Ou.get(e);r&&(Vtt(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?r.pu=!0:t.ne.size>0?Vtt(r.pu):t.se.size>0&&(Vtt(r.pu),r.pu=!1))})),[4,Mst(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Tat(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function kst(t,e,n){var r=Utt(t);if(r.Uu&&0===n||!r.Uu&&1===n){var i=[];r.Nu.forEach((function(t,n){var r=n.view.Ks(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Utt(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Ks(e)&&(r=!0)})),r&&Bit(n)}(r.vu,e),i.length&&r.Cu.yc(i),r.onlineState=e,r.Uu&&r.Su.ji(e)}}function Est(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:return(r=Utt(t)).Su.Ki(e,"rejected",n),i=r.Ou.get(e),(o=i&&i.key)?(a=(a=new Iet(het.D)).ot(o,new Drt(o,oet.min())),s=jet().add(o),u=new Het(oet.min(),new Map,new Ret(qtt),a,s),[4,Cst(r,u)]):[3,2];case 1:return c.sent(),r.ku=r.ku.remove(o),r.Ou.delete(e),Pst(r),[3,4];case 2:return[4,Cat(r.Gc,e,!1).then((function(){return Rst(r,e,n)})).catch(Tat)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Sst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:n=Utt(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,yat(n.Gc,e)];case 2:return i=o.sent(),Ast(n,r,null),Tst(n,r),n.Su.Oi(r,"acknowledged"),[4,Mst(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Tat(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ist(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:r=Utt(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Utt(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Sr.$o(t,e).next((function(e){return Vtt(null!==e),r=e.keys(),n.Sr.Qo(t,e)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Nh.Or(t,r)}))}))}(r.Gc,e)];case 2:return i=o.sent(),Ast(r,e,n),Tst(r,e),r.Su.Oi(e,"rejected",n),[4,Mst(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Tat(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Tst(t,e){(t.Lu.get(e)||[]).forEach((function(t){t.resolve()})),t.Lu.delete(e)}function Ast(t,e,n){var r=Utt(t),i=r.$u[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i}}function Rst(t,e,n){void 0===n&&(n=null),t.Su.Bi(e);for(var r=0,i=t.xu.get(e);r<i.length;r++){var o=i[r];t.Nu.delete(o),n&&t.Cu.Qu(o,n)}t.xu.delete(e),t.Uu&&t.Mu.Kh(e).forEach((function(e){t.Mu.Ho(e)||Ost(t,e)}))}function Ost(t,e){var n=t.ku.get(e);null!==n&&(Gat(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),Pst(t))}function Nst(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof pst?(t.Mu.Da(o.key,e),Dst(t,o)):o instanceof vst?(Mtt("SyncEngine","Document no longer in limbo: "+o.key),t.Mu.Na(o.key,e),t.Mu.Ho(o.key)||Ost(t,o.key)):jtt()}}function Dst(t,e){var n=e.key;t.ku.get(n)||(Mtt("SyncEngine","New document in limbo: "+n),t.Fu.push(n),Pst(t))}function Pst(t){for(;t.Fu.length>0&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new yst(e)),t.ku=t.ku.ot(e,n),Hat(t.bu,new xet(qrt(Lrt(e.path)),n,2,Uit.ai))}}function Mst(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return r=Utt(t),i=[],o=[],a=[],r.Nu.P()?[3,3]:(r.Nu.forEach((function(t,s){a.push(r.Ku(s,e,n).then((function(t){if(t){r.Uu&&r.Su.Ki(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=iot.zr(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.Cu.yc(i),[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return Object(EP.d)(this,(function(l){switch(l.label){case 0:n=Utt(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return git.forEach(e,(function(e){return git.forEach(e.jr,(function(r){return n.persistence.No.Da(t,e.targetId,r)})).next((function(){return git.forEach(e.Gr,(function(r){return n.persistence.No.Na(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!wit(r=l.sent()))throw r;return Mtt("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=(a=o[i]).targetId,a.fromCache||(u=n.bh.get(s),c=u.rt(u.nt),n.bh=n.bh.ot(s,c));return[2]}}))}))}(r.Gc,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function Fst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return(n=Utt(t)).currentUser.isEqual(e)?[3,3]:(Mtt("SyncEngine","User change. New user:",e.ti()),[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return n=Utt(t),r=n.Sr,i=n.Nh,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Sr.Uo(t).next((function(a){return o=a,r=n.persistence.Th(e),i=new rot(n.Ch,r,n.persistence.Ah()),r.Uo(t)})).next((function(e){for(var n=[],r=[],a=jet(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++)a=a.add(h[l].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var v=0,m=p.mutations;v<m.length;v++)a=a.add(m[v].key)}return i.Or(t,a).next((function(t){return{Wu:t,ju:n,Gu:r}}))}))}))];case 1:return o=a.sent(),[2,(n.Sr=r,n.Nh=i,n.ph.xh(n.Nh),o)]}}))}))}(n.Gc,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Lu.forEach((function(t){t.forEach((function(t){t.reject(new Ntt(Ott.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Lu.clear()}(n),n.Su.Wi(e,r.ju,r.Gu),[4,Mst(n,r.Wu)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Lst(t,e){var n=Utt(t),r=n.Ou.get(e);if(r&&r.pu)return jet().add(r.key);var i=jet(),o=n.xu.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=n.Nu.get(s[a]);i=i.Ot(u.view.wu)}return i}function Bst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return[4,kat((n=Utt(t)).Gc,e.query,!0)];case 1:return r=o.sent(),i=e.view.Vu(r),[2,(n.Uu&&Nst(n,e.targetId,i.Pu),i)]}}))}))}function jst(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=Utt(t),r=Utt(n.Sr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Lo(t,e).next((function(e){return e?n.Nh.Or(t,e):git.resolve(null)}))}))}((i=Utt(t)).Gc,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,ist(i.bu)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ast(i,e,r||null),Tst(i,e),function(t,e){Utt(Utt(t).Sr).jo(e)}(i.Gc,e)):jtt(),a.label=4;case 4:return[4,Mst(i,o)];case 5:return a.sent(),[3,7];case 6:Mtt("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function Vst(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:return Gst(n=Utt(t)),Kst(n),!0!==e||!0===n.qu?[3,3]:(r=n.Su.Ci(),[4,Ust(n,r.L())]);case 1:return i=c.sent(),n.qu=!0,[4,hst(n.bu,!0)];case 2:for(c.sent(),o=0,a=i;o<a.length;o++)Hat(n.bu,a[o]);return[3,7];case 3:return!1!==e||!1===n.qu?[3,7]:(s=[],u=Promise.resolve(),n.xu.forEach((function(t,e){n.Su.qi(e)?s.push(e):u=u.then((function(){return Rst(n,e),Cat(n.Gc,e,!0)})),Gat(n.bu,e)})),[4,u]);case 4:return c.sent(),[4,Ust(n,s)];case 5:return c.sent(),function(t){var e=Utt(t);e.Ou.forEach((function(t,n){Gat(e.bu,n)})),e.Mu.Qh(),e.Ou=new Map,e.ku=new Iet(het.D)}(n),n.qu=!1,[4,hst(n.bu,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function Ust(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p;return Object(EP.d)(this,(function(v){switch(v.label){case 0:n=Utt(t),r=[],i=[],o=0,a=e,v.label=1;case 1:return o<a.length?(u=void 0,(c=n.xu.get(s=a[o]))&&0!==c.length?[4,xat(n.Gc,qrt(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),l=0,h=c,v.label=3;case 3:return l<h.length?(f=n.Nu.get(h[l]),[4,Bst(n,f)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Eat(n.Gc,s)];case 8:return p=v.sent(),[4,xat(n.Gc,p)];case 9:return u=v.sent(),[4,wst(n,zst(p),s,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Cu.yc(i),r)]}}))}))}function zst(t){return Frt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Wst(t){var e=Utt(t);return Utt(Utt(e.Gc).persistence).pi()}function qst(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return(i=Utt(t)).qu?(Mtt("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.xu.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Sat(i.Gc)];case 3:return o=s.sent(),a=Het.Xt(e,"current"===n),[4,Mst(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,Cat(i.Gc,e,!0)];case 6:return s.sent(),Rst(i,e,r),[3,8];case 7:jtt(),s.label=8;case 8:return[2]}}))}))}function Hst(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h;return Object(EP.d)(this,(function(f){switch(f.label){case 0:if(!(r=Gst(t)).qu)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.xu.has(a=o[i])?(Mtt("SyncEngine","Adding an already active target "+a),[3,5]):[4,Eat(r.Gc,a)]:[3,6];case 2:return s=f.sent(),[4,xat(r.Gc,s)];case 3:return u=f.sent(),[4,wst(r,zst(s),u.targetId,!1)];case 4:f.sent(),Hat(r.bu,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return r.xu.has(t)?[4,Cat(r.Gc,t,!1).then((function(){Gat(r.bu,t),Rst(r,t)})).catch(Tat)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,f.label=7;case 7:return l<h.length?[5,c(h[l])]:[3,10];case 8:f.sent(),f.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Gst(t){var e=Utt(t);return e.bu.Hc.ru=Cst.bind(null,e),e.bu.Hc.qe=Lst.bind(null,e),e.bu.Hc.iu=Est.bind(null,e),e.Cu.yc=Fit.bind(null,e.vu),e.Cu.Qu=Lit.bind(null,e.vu),e}function Kst(t){var e=Utt(t);return e.bu.Hc.ou=Sst.bind(null,e),e.bu.Hc.au=Ist.bind(null,e),e}var Xst=function(){function t(){}return t.prototype.xh=function(t){this.zu=t},t.prototype.Lr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.on.length||1===t.on.length&&t.on[0].field.W())}(e)||n.isEqual(oet.min())?this.Hu(t,e):this.zu.Or(t,r).next((function(o){var a=i.Ju(e,o);return(Brt(e)||jrt(e))&&i.mu(e.an,a,r,n)?i.Hu(t,e):(Ptt()<=O6.a.DEBUG&&Mtt("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Yrt(e)),i.zu.Lr(t,e,n).next((function(t){return a.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Ju=function(t,e){var n=new Ret(Jrt(t));return e.forEach((function(e,r){r instanceof Nrt&&Qrt(t,r)&&(n=n.add(r))})),n},t.prototype.mu=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.h(r)>0)},t.prototype.Hu=function(t,e){return Ptt()<=O6.a.DEBUG&&Mtt("IndexFreeQueryEngine","Using full collection scan to execute query:",Yrt(e)),this.zu.Lr(t,e,oet.min())},t}(),$st=function(){function t(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Ret(Rat.Mh)}return t.prototype.ko=function(t){return git.resolve(0===this.Sr.length)},t.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++;var o=new Jit(i,e,n,r);this.Sr.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.Xu=this.Xu.add(new Rat(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return git.resolve(o)},t.prototype.$o=function(t,e){return git.resolve(this.Zu(e))},t.prototype.Bo=function(t,e){var n=this.tl(e+1),r=n<0?0:n;return git.resolve(this.Sr.length>r?this.Sr[r]:null)},t.prototype.qo=function(){return git.resolve(0===this.Sr.length?-1:this.Yu-1)},t.prototype.Uo=function(t){return git.resolve(this.Sr.slice())},t.prototype.Nr=function(t,e){var n=this,r=new Rat(e,0),i=new Rat(e,Number.POSITIVE_INFINITY),o=[];return this.Xu.xt([r,i],(function(t){var e=n.Zu(t.jh);o.push(e)})),git.resolve(o)},t.prototype.$r=function(t,e){var n=this,r=new Ret(qtt);return e.forEach((function(t){var e=new Rat(t,0),i=new Rat(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,i],(function(t){r=r.add(t.jh)}))})),git.resolve(this.el(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;het.X(i)||(i=i.child(""));var o=new Rat(new het(i),0),a=new Ret(qtt);return this.Xu.Ft((function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(a=a.add(t.jh)),!0)}),o),git.resolve(this.el(a))},t.prototype.el=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Zu(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;Vtt(0===this.nl(e.batchId,"removed")),this.Sr.shift();var r=this.Xu;return git.forEach(e.mutations,(function(i){var o=new Rat(i.key,e.batchId);return r=r.delete(o),n.No.Go(t,i.key)})).next((function(){n.Xu=r}))},t.prototype.jo=function(t){},t.prototype.Ho=function(t,e){var n=new Rat(e,0),r=this.Xu.kt(n);return git.resolve(e.isEqual(r&&r.key))},t.prototype.zo=function(t){return git.resolve()},t.prototype.nl=function(t,e){return this.tl(t)},t.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},t.prototype.Zu=function(t){var e=this.tl(t);return e<0||e>=this.Sr.length?null:this.Sr[e]},t}(),Yst=function(){function t(t,e){this.Dr=t,this.sl=e,this.docs=new Iet(het.D),this.size=0}return t.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:a,readTime:n}),this.size+=a-o,this.Dr.Mo(t,r.path.F())},t.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Rr=function(t,e){var n=this.docs.get(e);return git.resolve(n?n.ta:null)},t.prototype.getEntries=function(t,e){var n=this,r=Pet();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)})),git.resolve(r)},t.prototype.Lr=function(t,e,n){for(var r=Fet(),i=new het(e.path.child("")),o=this.docs.ft(i);o.At();){var a=o.It(),s=a.value,u=s.ta,c=s.readTime;if(!e.path.M(a.key.path))break;c.h(n)<=0||u instanceof Nrt&&Qrt(e,u)&&(r=r.ot(u.key,u))}return git.resolve(r)},t.prototype.il=function(t,e){return git.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ra=function(t){return new Qst(this)},t.prototype.aa=function(t){return git.resolve(this.size)},t}(),Qst=function(t){function e(e){var n=this;return(n=t.call(this)||this).ha=e,n}return Object(EP.c)(e,t),e.prototype.Vr=function(t){var e=this,n=[];return this.wr.forEach((function(r,i){i?n.push(e.ha.Ir(t,i,e.readTime)):e.ha.Ar(r)})),git.kn(n)},e.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},e.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},e}(tot),Jst=function(){function t(t){this.persistence=t,this.rl=new ret((function(t){return get(t)}),yet),this.lastRemoteSnapshotVersion=oet.min(),this.highestTargetId=0,this.ol=0,this.al=new Aat,this.targetCount=0,this.hl=iat.fa()}return t.prototype.Ce=function(t,e){return this.rl.forEach((function(t,n){return e(n)})),git.resolve()},t.prototype.Ia=function(t){return git.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ma=function(t){return git.resolve(this.ol)},t.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),git.resolve(this.highestTargetId)},t.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),git.resolve()},t.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new iat(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},t.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,git.resolve()},t.prototype.Va=function(t,e){return this.Pa(e),git.resolve()},t.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),this.targetCount-=1,git.resolve()},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return this.rl.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.rl.delete(a),o.push(r.pa(t,s.targetId)),i++)})),git.kn(o).next((function(){return i}))},t.prototype.ba=function(t){return git.resolve(this.targetCount)},t.prototype.va=function(t,e){var n=this.rl.get(e)||null;return git.resolve(n)},t.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),git.resolve()},t.prototype.Ca=function(t,e,n){this.al.Uh(e,n);var r=this.persistence.No,i=[];return r&&e.forEach((function(e){i.push(r.Go(t,e))})),git.kn(i)},t.prototype.pa=function(t,e){return this.al.Kh(e),git.resolve()},t.prototype.xa=function(t,e){var n=this.al.Wh(e);return git.resolve(n)},t.prototype.Ho=function(t,e){return git.resolve(this.al.Ho(e))},t}(),Zst=function(){function t(t){var e=this;this.cl={},this.Ma=new Uit(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new Jst(this),this.Dr=new Lot,this.vr=function(t,n){return new Yst(t,(function(t){return e.No.ul(t)}))}(this.Dr)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Za=function(){},t.prototype.th=function(){},t.prototype.Ah=function(){return this.Dr},t.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new $st(this.Dr,this.No),this.cl[t.ti()]=e),e},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.runTransaction=function(t,e,n){var r=this;Mtt("MemoryPersistence","Starting transaction:",t);var i=new tut(this.Ma.next());return this.No.ll(),n(i).next((function(t){return r.No._l(i).next((function(){return t}))})).xn().then((function(t){return i.br(),t}))},t.prototype.fl=function(t,e){return git.On(Object.values(this.cl).map((function(n){return function(){return n.Ho(t,e)}})))},t}(),tut=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fa=e,n}return Object(EP.c)(e,t),e}(not),eut=function(){function t(t){this.persistence=t,this.dl=new Aat,this.wl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw jtt()},enumerable:!1,configurable:!0}),t.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),git.resolve()},t.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),git.resolve()},t.prototype.Go=function(t,e){return this.Tl.add(e.toString()),git.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach((function(t){return n.Tl.add(t.toString())}));var r=this.persistence.Ih();return r.xa(t,e.targetId).next((function(t){t.forEach((function(t){return n.Tl.add(t.toString())}))})).next((function(){return r.ya(t,e)}))},t.prototype.ll=function(){this.wl=new Set},t.prototype._l=function(t){var e=this,n=this.persistence.mh().ra();return git.forEach(this.Tl,(function(r){var i=het.H(r);return e.Il(t,i).next((function(t){t||n.Ar(i)}))})).next((function(){return e.wl=null,n.apply(t)}))},t.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next((function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())}))},t.prototype.ul=function(t){return 0},t.prototype.Il=function(t,e){var n=this;return git.On([function(){return git.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},t}(),nut=function(){function t(t){this.ml=t.ml,this.Al=t.Al}return t.prototype.gc=function(t){this.Rl=t},t.prototype.Ic=function(t){this.Pl=t},t.prototype.onMessage=function(t){this.gl=t},t.prototype.close=function(){this.Al()},t.prototype.send=function(t){this.ml(t)},t.prototype.Vl=function(){this.Rl()},t.prototype.yl=function(t){this.Pl(t)},t.prototype.pl=function(t){this.gl(t)},t}(),rut={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},iut=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.T=e.T,n}return Object(EP.c)(e,t),e.prototype.Nl=function(t,e,n,r){return new Promise((function(i,o){var a=new Att;a.listenOnce(Itt.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case Stt.NO_ERROR:var e=a.getResponseJson();Mtt("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Stt.TIMEOUT:Mtt("Connection",'RPC "'+t+'" timed out'),o(new Ntt(Ott.DEADLINE_EXCEEDED,"Request time out"));break;case Stt.HTTP_ERROR:var n=a.getStatus();if(Mtt("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(Ott).indexOf(e)>=0?e:Ott.UNKNOWN}(r.status);o(new Ntt(s,r.message))}else o(new Ntt(Ott.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ntt(Ott.UNAVAILABLE,"Connection failed."));break;default:jtt()}}finally{Mtt("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Vc=function(t,e){var n=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new wtt,i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(i.initMessageHeaders,e),Object(N6.x)()||Object(N6.A)()||Object(N6.t)()||Object(N6.v)()||Object(N6.B)()||Object(N6.s)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");Mtt("Connection","Creating WebChannel: "+o,i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new nut({ml:function(t){u?Mtt("Connection","Not sending because WebChannel is closed:",t):(s||(Mtt("Connection","Opening WebChannel transport."),a.open(),s=!0),Mtt("Connection","WebChannel sending:",t),a.send(t))},Al:function(){return a.close()}}),l=function(t,e){a.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(Ttt.EventType.OPEN,(function(){u||Mtt("Connection","WebChannel transport opened.")})),l(Ttt.EventType.CLOSE,(function(){u||(u=!0,Mtt("Connection","WebChannel transport closed"),c.yl())})),l(Ttt.EventType.ERROR,(function(t){u||(u=!0,Ltt("Connection","WebChannel transport errored:",t),c.yl(new Ntt(Ott.UNAVAILABLE,"The operation could not be completed")))})),l(Ttt.EventType.MESSAGE,(function(t){var e;if(!u){var n=t.data[0];Vtt(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Mtt("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=_et[t];if(void 0!==e)return Eet(e)}(i),s=r.message;void 0===o&&(o=Ott.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),u=!0,c.yl(new Ntt(o,s)),a.close()}else Mtt("Connection","WebChannel received:",n),c.pl(n)}})),setTimeout((function(){c.Vl()}),0),c},e}(function(){function t(t){this.bl=t,this._=t._,this.vl=(t.ssl?"https":"http")+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}return t.prototype.Mc=function(t,e,n,r){var i=this.Dl(t,e);Mtt("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(t,i,o,n).then((function(t){return Mtt("RestConnection","Received: ",t),t}),(function(e){throw Ltt("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},t.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},t.prototype.Dl=function(t,e){return this.vl+"/v1/"+e+":"+rut[t]},t}()),out=function(){function t(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}return t.prototype.eu=function(t){this.Ml.push(t)},t.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},t.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},t.prototype.Fl=function(){Mtt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){Mtt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),aut=function(){function t(){}return t.prototype.eu=function(t){},t.prototype.Di=function(){},t}();function sut(t){return new _nt(t,!0)}var uut=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return this.Su=this.Ll(t),this.persistence=this.Bl(t),[4,this.persistence.start()];case 1:return e.sent(),this.ql=this.Ul(t),this.Gc=this.Kl(t),[2]}}))}))},t.prototype.Ul=function(t){return null},t.prototype.Kl=function(t){return e=this.persistence,n=new Xst,new gat(e,n,t.Ql);var e,n},t.prototype.Bl=function(t){return new Zst(eut.El)},t.prototype.Ll=function(t){return new Qit},t.prototype.terminate=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}}))}))},t}(),cut=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(EP.c)(e,t),e.prototype.initialize=function(e){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Iat(this.Gc)];case 2:return n.sent(),[4,this.Wl.initialize(this,e)];case 3:return n.sent(),[4,Kst(this.Wl.fi)];case 4:return n.sent(),[4,ist(this.Wl.bu)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ul=function(t){return new cot(this.persistence.No.wo,t.hs)},e.prototype.Bl=function(t){var e=mat(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?uot.ao(this.cacheSizeBytes):uot.fo,r=sut(t.bl._);return new hat(this.synchronizeTabs,e,t.clientId,n,t.hs,Iit(),Tit(),r,this.Su,!!this.forceOwnership)},e.prototype.Ll=function(t){return new Qit},e}(uut),lut=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Wl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(EP.c)(e,t),e.prototype.initialize=function(e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Wl.fi,this.Su instanceof Yit?(this.Su.fi={er:jst.bind(null,n),nr:qst.bind(null,n),sr:Hst.bind(null,n),pi:Wst.bind(null,n)},[4,this.Su.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Xa((function(t){return Object(EP.b)(r,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return[4,Vst(this.Wl.fi,t)];case 1:return e.sent(),this.ql&&(t&&!this.ql.Ii?this.ql.start(this.Gc):t||this.ql.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Ll=function(t){var e=Iit();if(!Yit.Ln(e))throw new Ntt(Ott.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=mat(t.bl._,t.bl.persistenceKey);return new Yit(e,t.hs,n,t.clientId,t.Ql)},e}(cut),hut=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return this.Gc?[3,2]:(this.Gc=t.Gc,this.Su=t.Su,this.zc=this.jl(e),this.bu=this.Gl(e),this.vu=this.zl(e),this.fi=this.Hl(e,!t.synchronizeTabs),this.Su.di=function(t){return kst(n.fi,t,1)},this.bu.Hc.Jl=Fst.bind(null,this.fi),[4,hst(this.bu,this.fi.Uu)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.zl=function(t){return new Dit},t.prototype.jl=function(t){var e=sut(t.bl._),n=new iut(t.bl);return function(t,e,n){return new jat(t,e,n)}(t.credentials,n,e)},t.prototype.Gl=function(t){var e,n,r,i,o,a=this;return e=this.Gc,n=this.zc,r=t.hs,i=function(t){return kst(a.fi,t,0)},o=out.Ln()?new out:new aut,new Uat(e,n,r,i,o)},t.prototype.Hl=function(t,e){return function(t,e,n,r,i,o,a){var s=new bst(t,e,n,r,i,o);return a&&(s.qu=!0),s}(this.Gc,this.bu,this.vu,this.Su,t.Ql,t.Du,e)},t.prototype.terminate=function(){return qat(this.bu)},t}(),fut=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Xl=function(){this.muted=!0},t.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function dut(t,e,n){if(!n)throw new Ntt(Ott.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function put(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function vut(t,e,n,r){if(!0===e&&!0===r)throw new Ntt(Ott.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function mut(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":jtt()}function gut(t,e){if(e<=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var yut=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new cet(t)},but=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return Object(EP.c)(e,t),e.documentId=function(){return new e(cet.j().B())},e.prototype.isEqual=function(t){return t instanceof e&&this.Zl.isEqual(t.Zl)},e}(yut),_ut=new RegExp("[~\\*/\\[\\]]"),wut=function(t){this.t_=t},xut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.e_=function(t){if(2!==t.n_)throw t.s_(1===t.n_?this.t_+"() can only appear at the top level of your update data":this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(wut);function Cut(t,e,n){return new Mut({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var kut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.e_=function(t){return new lrt(t.path,new ert)},e.prototype.isEqual=function(t){return t instanceof e},e}(wut),Eut=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return Object(EP.c)(e,t),e.prototype.e_=function(t){var e=Cut(this,t,!0),n=this.o_.map((function(t){return Uut(t,e)})),r=new nrt(n);return new lrt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wut),Sut=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return Object(EP.c)(e,t),e.prototype.e_=function(t){var e=Cut(this,t,!0),n=this.o_.map((function(t){return Uut(t,e)})),r=new irt(n);return new lrt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wut),Iut=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return Object(EP.c)(e,t),e.prototype.e_=function(t){var e=new art(t.serializer,Cnt(t.serializer,this.a_));return new lrt(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(wut),Tut=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ntt(Ott.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ntt(Ott.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},t.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},t.prototype.g=function(t){return qtt(this.h_,t.h_)||qtt(this.c_,t.c_)},t}(),Aut=function(t){this.u_=t},Rut=/^__.*__$/,Out=function(t,e,n){this.l_=t,this.__=e,this.f_=n},Nut=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[];return n.push(null!==this.Qe?new wrt(t,this.data,this.Qe,e):new _rt(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Crt(t,this.fieldTransforms)),n},t}(),Dut=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[new wrt(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new Crt(t,this.fieldTransforms)),n},t}();function Put(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jtt()}}var Mut=function(){function t(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),t.prototype.E_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.T_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.I_(t),r},t.prototype.m_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.w_(),r},t.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},t.prototype.s_=function(t){return Kut(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.M(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.M(e.field)}))},t.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},t.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Put(this.n_)&&Rut.test(t))throw this.s_('Document fields cannot begin and end with "__"')},t}(),Fut=function(){function t(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||sut(t)}return t.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Mut({n_:t,methodName:e,i_:n,path:cet.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},t}();function Lut(t,e,n,r,i,o){void 0===o&&(o={});var a=t.P_(o.merge||o.mergeFields?2:0,e,n,i);qut("Data must be an object, but it was:",a,r);var s,u,c=zut(r,a);if(o.merge)s=new crt(a.Qe),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=f[h],p=void 0;if(d instanceof yut)p=d.Zl;else{if("string"!=typeof d)throw jtt();p=Gut(e,d,n)}if(!a.contains(p))throw new Ntt(Ott.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Xut(l,p)||l.push(p)}s=new crt(l),u=a.fieldTransforms.filter((function(t){return s.Je(t.field)}))}else s=null,u=a.fieldTransforms;return new Nut(new Trt(c),s,u)}function But(t,e,n,r){var i=t.P_(1,e,n);qut("Data must be an object, but it was:",i,r);var o=[],a=new Art;eet(r,(function(t,r){var s=Gut(e,t,n),u=i.m_(s);if(r instanceof xut||r instanceof Aut&&r.u_ instanceof xut)o.push(s);else{var c=Uut(r,u);null!=c&&(o.push(s),a.set(s,c))}}));var s=new crt(o);return new Dut(a.Xe(),s,i.fieldTransforms)}function jut(t,e,n,r,i,o){var a=t.P_(1,e,n),s=[Hut(e,r,n)],u=[i];if(o.length%2!=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(Hut(e,o[c])),u.push(o[c+1]);for(var l=[],h=new Art,f=s.length-1;f>=0;--f)if(!Xut(l,s[f])){var d=s[f],p=u[f],v=a.m_(d);if(p instanceof xut||p instanceof Aut&&p.u_ instanceof xut)l.push(d);else{var m=Uut(p,v);null!=m&&(l.push(d),h.set(d,m))}}var g=new crt(l);return new Dut(h.Xe(),g,a.fieldTransforms)}function Vut(t,e,n,r){return void 0===r&&(r=!1),Uut(n,t.P_(r?4:3,e))}function Uut(t,e){if(t instanceof Aut&&(t=t.u_),Wut(t))return qut("Unsupported field value:",e,t),zut(t,e);if(t instanceof wut)return function(t,e){if(!Put(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");var n=t.e_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.r_&&4!==e.n_)throw e.s_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Uut(o[i],e.A_(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Cnt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=iet.fromDate(t);return{timestampValue:knt(e.serializer,n)}}if(t instanceof iet){var r=new iet(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:knt(e.serializer,r)}}if(t instanceof Tut)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xtt)return{bytesValue:Ent(e.serializer,t.l)};if(t instanceof Out){var i=e._,o=t.l_;if(!o.isEqual(i))throw e.s_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Tnt(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+mut(t))}(t,e)}function zut(t,e){var n={};return net(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):eet(t,(function(t,r){var i=Uut(r,e.T_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Wut(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof iet||t instanceof Tut||t instanceof Xtt||t instanceof Out||t instanceof wut)}function qut(t,e,n){if(!Wut(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=mut(n);throw e.s_("an object"===r?t+" a custom object":t+" "+r)}}function Hut(t,e,n){if(e instanceof yut)return e.Zl;if("string"==typeof e)return Gut(t,e);throw Kut("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Gut(t,e,n){try{return function(t){if(t.search(_ut)>=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(but.bind.apply(but,Object(EP.g)([void 0],t.split("."))))}catch(e){throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw Kut((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Kut(t,e,n,r,i){var o=r&&!r.P(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Ntt(Ott.INVALID_ARGUMENT,(s+=". ")+t+u)}function Xut(t,e){return t.some((function(t){return t.isEqual(e)}))}var $ut=function(){function t(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}return t.prototype.b_=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:if(this.v_(),this.mutations.length>0)throw new Ntt(Ott.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return n=Utt(t),r=Pnt(n.serializer)+"/documents",i={documents:e.map((function(t){return Rnt(n.serializer,t)}))},[4,n.$c("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Vtt(!!e.found);var n=Ont(t,e.found.name),r=Int(e.found.updateTime),i=new Trt({mapValue:{fields:e.found.fields}});return new Nrt(n,r,i,{})}(t,e):"missing"in e?function(t,e){Vtt(!!e.missing),Vtt(!!e.readTime);var n=Ont(t,e.missing),r=Int(e.readTime);return new Drt(n,r)}(t,e):jtt()}(n.serializer,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Vtt(!!e),s.push(e)})),s)]}}))}))}(this.zc,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Drt||t instanceof Nrt?n.S_(t):jtt()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},t.prototype.delete=function(t){this.write([new Srt(t,this.Ge(t))]),this.p_.add(t.toString())},t.prototype.commit=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e=this;return Object(EP.d)(this,(function(n){switch(n.label){case 0:if(this.v_(),this.y_)throw this.y_;return t=this.g_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=het.H(n);e.mutations.push(new Irt(r,e.Ge(r)))})),[4,function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return n=Utt(t),r=Pnt(n.serializer)+"/documents",i={writes:e.map((function(t){return Lnt(n.serializer,t)}))},[4,n.Mc("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.zc,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},t.prototype.S_=function(t){var e;if(t instanceof Nrt)e=t.version;else{if(!(t instanceof Drt))throw jtt();e=oet.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ntt(Ott.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?frt.updateTime(e):frt.ze()},t.prototype.D_=function(t){var e=this.g_.get(t.toString());if(!this.p_.has(t.toString())&&e){if(e.isEqual(oet.min()))throw new Ntt(Ott.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return frt.updateTime(e)}return frt.exists(!0)},t.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},t.prototype.v_=function(){},t}(),Yut=function(){function t(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new mit(this.hs,"transaction_retry")}return t.prototype.run=function(){this.N_()},t.prototype.N_=function(){var t=this;this.Vs.Pn((function(){return Object(EP.b)(t,void 0,void 0,(function(){var t,e,n=this;return Object(EP.d)(this,(function(r){return t=new $ut(this.zc),(e=this.x_(t))&&e.then((function(e){n.hs.ws((function(){return t.commit().then((function(){n.ls.resolve(e)})).catch((function(t){n.F_(t)}))}))})).catch((function(t){n.F_(t)})),[2]}))}))}))},t.prototype.x_=function(t){try{var e=this.updateFunction(t);return!fet(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},t.prototype.F_=function(t){var e=this;this.C_>0&&this.k_(t)?(this.C_-=1,this.hs.ws((function(){return e.N_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.k_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ket(e)}return!1},t}(),Qut=function(){function t(t,e){this.credentials=t,this.hs=e,this.clientId=Wtt.t(),this.O_=new vit}return t.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new vit,o=!1;return this.credentials.Jh((function(t){if(!o)return o=!0,Mtt("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject);r.hs.Cs((function(){return function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return(n=Utt(t)).hs.Fs(),Mtt("RemoteStore","RemoteStore received new credentials"),r=Qat(n),n.Xc.add(3),[4,Wat(n)];case 1:return i.sent(),r&&n.nu.set("Unknown"),[4,n.Hc.Jl(e)];case 2:return i.sent(),n.Xc.delete(3),[4,zat(n)];case 3:return i.sent(),[2]}}))}))}(r.bu,t)}))})),this.hs.ws((function(){return r.O_.promise})),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!0),function(t){var e=Utt(t);return e.Xc.delete(0),zat(e)}(t.bu)}))},t.prototype.L_=function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a=this;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,t.initialize(i={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:n,Du:100})];case 1:return s.sent(),[4,e.initialize(t,i)];case 2:return s.sent(),this.persistence=t.persistence,this.Su=t.Su,this.Gc=t.Gc,this.ql=t.ql,this.zc=e.zc,this.bu=e.bu,this.fi=e.fi,this.B_=e.vu,this.B_.Us=_st.bind(null,this.fi),this.B_.Ws=xst.bind(null,this.fi),this.persistence.Za((function(){return Object(EP.b)(a,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,4];case 3:if(o=s.sent(),r.reject(o),!function(t){return"FirebaseError"===t.name?t.code===Ott.FAILED_PRECONDITION||t.code===Ott.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.L_(new uut,new hut,n,r))];case 4:return[2]}}))}))},t.prototype.M_=function(){if(this.hs.ps)throw new Ntt(Ott.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!1),function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return(e=Utt(t)).Xc.add(0),[4,Wat(e)];case 1:return n.sent(),e.nu.set("Offline"),[2]}}))}))}(t.bu)}))},t.prototype.terminate=function(){var t=this;this.hs.Ds();var e=new vit;return this.hs.bs((function(){return Object(EP.b)(t,void 0,void 0,(function(){var t,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,qat(this.bu)];case 1:return r.sent(),[4,this.Su.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yh(),e.resolve(),[3,5];case 4:return t=r.sent(),n=Oit(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new vit;return this.hs.ws((function(){return function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:Qat((n=Utt(t)).bu)||Mtt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Utt(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Sr.qo(t)}))}(n.Gc)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Lu.get(r)||[]).push(e),n.Lu.set(r,i),[3,4]);case 3:return o=s.sent(),a=Oit(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}(t.fi,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new fut(n),o=new jit(t,i,e);return this.hs.ws((function(){return Pit(r.B_,o)})),function(){i.Xl(),r.hs.ws((function(){return Mit(r.B_,o)}))}},t.prototype.q_=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return r.sent(),e=new vit,[2,(this.hs.ws((function(){return function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,function(t,e){var n=Utt(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Nh.Cr(t,e)}))}(t,e)];case 1:return(r=a.sent())instanceof Nrt?n.resolve(r):r instanceof Drt?n.resolve(null):n.reject(new Ntt(Ott.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=a.sent(),o=Oit(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.U_=function(t,e){return void 0===e&&(e={}),Object(EP.b)(this,void 0,void 0,(function(){var n,r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new vit,[2,(this.hs.ws((function(){return function(t,e,n,r,i){var o=new fut({next:function(o){e.ws((function(){return Mit(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Ntt(Ott.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Ntt(Ott.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new jit(Lrt(n.path),o,{includeMetadataChanges:!0,Xs:!0});return Pit(t,a)}(r.B_,r.hs,t,e,n)})),n.promise)]}}))}))},t.prototype.K_=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return r.sent(),e=new vit,[2,(this.hs.ws((function(){return function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,kat(t,e,!0)];case 1:return r=c.sent(),i=new mst(e,r.Fh),o=i.Eu(r.documents),a=i.Vr(o,!1),n.resolve(a.snapshot),[3,3];case 2:return s=c.sent(),u=Oit(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.Q_=function(t,e){return void 0===e&&(e={}),Object(EP.b)(this,void 0,void 0,(function(){var n,r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new vit,[2,(this.hs.ws((function(){return function(t,e,n,r,i){var o=new fut({next:function(n){e.ws((function(){return Mit(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Ntt(Ott.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new jit(n,o,{includeMetadataChanges:!0,Xs:!0});return Pit(t,a)}(r.B_,r.hs,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.M_();var n=new vit;return this.hs.ws((function(){return function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:r=Kst(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Utt(t),i=iet.now(),o=e.reduce((function(t,e){return t.add(e.key)}),jet());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Nh.Or(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=grt(c,n.get(c.key));null!=l&&a.push(new wrt(c.key,l,Rrt(l.proto.mapValue),frt.exists(!0)))}return r.Sr.Oo(t,i,a,e)}))})).then((function(t){var e=t.lr(n);return{batchId:t.batchId,wr:e}}))}(r.Gc,e)];case 2:return i=s.sent(),r.Su.Fi(i.batchId),function(t,e,n){var r=t.$u[t.currentUser.ti()];r||(r=new Iet(qtt)),r=r.ot(e,n),t.$u[t.currentUser.ti()]=r}(r,i.batchId,n),[4,Mst(r,i.wr)];case 3:return s.sent(),[4,ist(r.bu)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=Oit(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}(e.fi,t,n)})),n.promise},t.prototype._=function(){return this.bl._},t.prototype.W_=function(t){var e=this;this.M_();var n=new fut(t);return this.hs.ws((function(){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){return[2,function(t,e){Utt(t).qs.add(e),e.next()}(this.B_,n)]}))}))})),function(){n.Xl(),e.hs.ws((function(){return Object(EP.b)(e,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){return[2,function(t,e){Utt(t).qs.delete(e)}(this.B_,n)]}))}))}))}},Object.defineProperty(t.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.M_();var n=new vit;return this.hs.ws((function(){return new Yut(e.hs,e.zc,t,n).run(),Promise.resolve()})),n.promise},t}();function Jut(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Zut=function(){function t(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}return t.prototype.J_=function(t){switch(rnt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return lnt(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(hnt(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw jtt()}},t.prototype.nf=function(t){var e=this,n={};return eet(t.fields||{},(function(t,r){n[t]=e.J_(r)})),n},t.prototype.tf=function(t){return new Tut(lnt(t.latitude),lnt(t.longitude))},t.prototype.ef=function(t){var e=this;return(t.values||[]).map((function(t){return e.J_(t)}))},t.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return tnt(n)?t(n):n}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(ent(t));default:return null}},t.prototype.Y_=function(t){var e=cnt(t);return new iet(e.seconds,e.nanos)},t.prototype.Z_=function(t){var e=set.q(t);Vtt(Ynt(e));var n=new Ztt(e.get(1),e.get(3)),r=new het(e.N(5));return n.isEqual(this._)||Ftt("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(r)},t}(),tct=uot.uo,ect=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ntt(Ott.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=uot._o;else{if(t.cacheSizeBytes!==tct&&t.cacheSizeBytes<uot.lo)throw new Ntt(Ott.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+uot.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,vut("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),nct="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",rct=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){throw new Ntt(Ott.FAILED_PRECONDITION,nct)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Ntt(Ott.FAILED_PRECONDITION,nct)},t.prototype.clearIndexedDbPersistence=function(t){throw new Ntt(Ott.FAILED_PRECONDITION,nct)},t}(),ict=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){var n=new hut,r=new cut(n,t.sf().cacheSizeBytes,e);return t.if(r,n)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new hut,n=new lut(e,t.sf().cacheSizeBytes);return t.if(n,e)},t.prototype.clearIndexedDbPersistence=function(t){var e=this,n=new vit;return t.rf.bs((function(){return Object(EP.b)(e,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return yit.Ln()?[4,yit.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(mat(t.l_,t.af))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},t}(),oct=function(){function t(e,n,r){var i=this;if(void 0===r&&(r=new rct),this.hf=r,this.cf=null,this.rf=new Rit,this.INTERNAL={delete:function(){return Object(EP.b)(i,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var o=e;this.cf=o,this.l_=t._f(o),this.af=o.name,this.ff=new Dat(n)}else{var a=e;if(!a.projectId)throw new Ntt(Ott.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Ztt(a.projectId,a.database),this.af="[DEFAULT]",this.ff=new Nat}this.df=new ect({})}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new Fut(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;var e=new ect(t);if(this.lf&&!this.df.isEqual(e))throw new Ntt(Ott.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.df=e,void 0!==e.credentials&&(this.ff=function(t){if(!t)return new Nat;switch(t.type){case"gapi":var e=t.client;return Vtt(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mat(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ntt(Ott.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&Ltt("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},t.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},t.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},t.prototype.enablePersistence=function(t){if(this.lf)throw new Ntt(Ott.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&vut("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){if(void 0!==this.lf&&!this.lf.j_)throw new Ntt(Ott.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){return this.uf(),Jut(t)?this.lf.W_(t):this.lf.W_({next:t})},t.prototype.uf=function(){return this.lf||this.if(new uut,new hut),this.lf},t.prototype.If=function(){return new Jtt(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},t.prototype.if=function(t,e){var n=this.If();return this.lf=new Qut(this.ff,this.rf),this.lf.start(n,t,e)},t._f=function(t){if(!Object.prototype.hasOwnProperty.call(t.options,"projectId"))throw new Ntt(Ott.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e=t.options.projectId;if(!e||"string"!=typeof e)throw new Ntt(Ott.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ztt(e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.cf)throw new Ntt(Ott.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return dut("Firestore.collection","path",t),this.uf(),new yct(set.q(t),this,null)},t.prototype.doc=function(t){return dut("Firestore.doc","path",t),this.uf(),uct.mf(set.q(t),this,null)},t.prototype.collectionGroup=function(t){if(dut("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new mct(function(t){return new Mrt(set.U(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return this.uf().transaction((function(n){return t(new act(e,n))}))},t.prototype.batch=function(){return this.uf(),new sct(this)},t.prototype.sf=function(){return this.df},t}(),act=function(){function t(t,e){this.Af=t,this.Rf=e}return t.prototype.get=function(t){var e=this,n=bct(0,t,this.Af);return this.Rf.b_([n.__]).then((function(t){if(!t||1!==t.length)return jtt();var r=t[0];if(r instanceof Drt)return new lct(e.Af,n.__,null,!1,!1,n.f_);if(r instanceof Nrt)return new lct(e.Af,n.__,r,!1,!1,n.f_);throw jtt()}))},t.prototype.set=function(t,e,n){var r=bct(0,t,this.Af);n=put("Transaction.set",n);var i=wct(r.f_,e,n),o=Lut(this.Af.wf,"Transaction.set",r.__,i,null!==r.f_,n);return this.Rf.set(r.__,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof e||e instanceof but?(r=bct(0,t,this.Af),i=jut(this.Af.wf,"Transaction.update",r.__,e,n,o)):(r=bct(0,t,this.Af),i=But(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,i),this},t.prototype.delete=function(t){var e=bct(0,t,this.Af);return this.Rf.delete(e.__),this},t}(),sct=function(){function t(t){this.Af=t,this.Pf=[],this.gf=!1}return t.prototype.set=function(t,e,n){this.Vf();var r=bct(0,t,this.Af);n=put("WriteBatch.set",n);var i=wct(r.f_,e,n),o=Lut(this.Af.wf,"WriteBatch.set",r.__,i,null!==r.f_,n);return this.Pf=this.Pf.concat(o.d_(r.__,frt.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.Vf(),"string"==typeof e||e instanceof but?(r=bct(0,t,this.Af),i=jut(this.Af.wf,"WriteBatch.update",r.__,e,n,o)):(r=bct(0,t,this.Af),i=But(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(i.d_(r.__,frt.exists(!0))),this},t.prototype.delete=function(t){this.Vf();var e=bct(0,t,this.Af);return this.Pf=this.Pf.concat(new Srt(e.__,frt.ze())),this},t.prototype.commit=function(){return this.Vf(),this.gf=!0,this.Pf.length>0?this.Af.uf().write(this.Pf):Promise.resolve()},t.prototype.Vf=function(){if(this.gf)throw new Ntt(Ott.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),uct=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.l_,e,r)||this).__=e,i.firestore=n,i.f_=r,i.lf=i.firestore.uf(),i}return Object(EP.c)(e,t),e.mf=function(t,n,r){if(t.length%2!=0)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new e(new het(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new yct(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(dut("DocumentReference.collection","path",t),!t)throw new Ntt(Ott.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=set.q(t);return new yct(this.__.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){return t instanceof e&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},e.prototype.set=function(t,e){e=put("DocumentReference.set",e);var n=wct(this.f_,t,e),r=Lut(this.firestore.wf,"DocumentReference.set",this.__,n,null!==this.f_,e);return this.lf.write(r.d_(this.__,frt.ze()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof but?jut(this.firestore.wf,"DocumentReference.update",this.__,t,e,r):But(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(n.d_(this.__,frt.exists(!0)))},e.prototype.delete=function(){return this.lf.write([new Srt(this.__,frt.ze())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Jut(i[s])||(a=i[s],s++);var u={includeMetadataChanges:a.includeMetadataChanges};if(Jut(i[s])){var c=i[s];i[s]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[s+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[s+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}var l={next:function(t){i[s]&&i[s](r.yf(t))},error:i[s+1],complete:i[s+2]};return this.lf.listen(Lrt(this.__.path),u,l)},e.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then((function(t){return new lct(e.firestore,e.__,t,!0,t instanceof Nrt&&t.Ye,e.f_)})):n.U_(this.__,t).then((function(t){return e.yf(t)}))},e.prototype.withConverter=function(t){return new e(this.__,this.firestore,t)},e.prototype.yf=function(t){var e=t.docs.get(this.__);return new lct(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},e}(Out),cct=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),lct=function(){function t(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}return t.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new hct(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new Zut(this.Af.l_,t.serverTimestamps||"none",(function(t){return new uct(t,e.Af,null)}),(function(t){return new Qtt(t)})).J_(this.pf.rn())}},t.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf){var r=this.pf.data().field(Hut("DocumentSnapshot.get",t,this.__));if(null!==r)return new Zut(this.Af.l_,e.serverTimestamps||"none",(function(t){return new uct(t,n.Af,n.f_)}),(function(t){return new Qtt(t)})).J_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new uct(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new cct(this.vf,this.bf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&this.bf===e.bf&&this.__.isEqual(e.__)&&(null===this.pf?null===e.pf:this.pf.isEqual(e.pf))&&this.f_===e.f_},t}(),hct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(lct);function fct(t,e,n){if("string"==typeof n){if(""===n)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!zrt(e)&&-1!==n.indexOf("/"))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(set.q(n));if(!het.X(r))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return fnt(t,new het(r))}if(n instanceof Out)return fnt(t,n.__);throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+mut(n)+".")}function dct(t,e){if(!Array.isArray(t)||0===t.length)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pct(t,e,n){if(!n.isEqual(e))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function vct(t){if(jrt(t)&&0===t.on.length)throw new Ntt(Ott.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var mct=function(){function t(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}return t.prototype.where=function(e,n,r){var i=Hut("Query.where",e),o=function(t,e,n,r,i,o,a){var s;if(i.W()){if("array-contains"===o||"array-contains-any"===o)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){dct(a,o);for(var u=[],c=0,l=a;c<l.length;c++)u.push(fct(r,t,l[c]));s={arrayValue:{values:u}}}else s=fct(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||dct(a,o),s=Vut(n,"Query.where",a,"in"===o||"not-in"===o);var h=Zrt.create(i,o,s);return function(t,e){if(e.un()){var n=Urt(t);if(null!==n&&!n.isEqual(e.field))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Vrt(t);null!==r&&pct(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Ntt(Ott.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,h),h}(this.Sf,0,this.firestore.wf,this.firestore.l_,i,n,r);return new t(function(t,e){var n=t.filters.concat([e]);return new Mrt(t.path,t.collectionGroup,t.on.slice(),n,t.limit,t.an,t.startAt,t.endAt)}(this.Sf,o),this.firestore,this.f_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new Ntt(Ott.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Hut("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new fit(e,n);return function(t,e){if(null===Vrt(t)){var n=Urt(t);null!==n&&pct(0,n,e.field)}}(t,r),r}(this.Sf,i,r);return new t(function(t,e){var n=t.on.concat([e]);return new Mrt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(this.Sf,o),this.firestore,this.f_)},t.prototype.limit=function(e){return gut("Query.limit",e),new t(Hrt(this.Sf,e,"F"),this.firestore,this.f_)},t.prototype.limitToLast=function(e){return gut("Query.limitToLast",e),new t(Hrt(this.Sf,e,"L"),this.firestore,this.f_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAt",e,n,!0);return new t(Grt(this.Sf,i),this.firestore,this.f_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAfter",e,n,!1);return new t(Grt(this.Sf,i),this.firestore,this.f_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endBefore",e,n,!0);return new t(Krt(this.Sf,i),this.firestore,this.f_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endAt",e,n,!1);return new t(Krt(this.Sf,i),this.firestore,this.f_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&Xrt(this.Sf,e.Sf)&&this.f_===e.f_},t.prototype.withConverter=function(e){return new t(this.Sf,this.firestore,e)},t.prototype.Df=function(t,e,n,r){if(e instanceof lct)return function(t,e,n,r,i){if(!r)throw new Ntt(Ott.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Wrt(t);a<s.length;a++){var u=s[a];if(u.field.W())o.push(fnt(e,r.key));else{var c=r.field(u.field);if(tnt(c))throw new Ntt(Ott.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.B();throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new uit(o,i)}(this.Sf,this.firestore.l_,t,e.pf,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var a=t.on;if(i.length>a.length)throw new Ntt(Ott.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.W()){if("string"!=typeof c)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!zrt(t)&&-1!==c.indexOf("/"))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(set.q(c));if(!het.X(l))throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new het(l);s.push(fnt(e,h))}else{var f=Vut(n,r,c);s.push(f)}}return new uit(s,o)}(this.Sf,this.firestore.l_,this.firestore.wf,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a={},s=0;if("object"!=typeof i[s]||Jut(i[s])||(a=i[s],s++),Jut(i[s])){var u=i[s];i[s]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[s+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[s+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)}var c={next:function(t){i[s]&&i[s](new gct(r.firestore,r.Sf,t,r.f_))},error:i[s+1],complete:i[s+2]};return vct(this.Sf),this.firestore.uf().listen(this.Sf,a,c)},t.prototype.get=function(t){var e=this;vct(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then((function(t){return new gct(e.firestore,e.Sf,t,e.f_)}))},t}(),gct=function(){function t(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new cct(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Nf.docs.forEach((function(r){t.call(e,n.kf(r,n.metadata.fromCache,n.Nf.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new mct(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=!(!t||!t.includeMetadataChanges);if(e&&this.Nf.jt)throw new Ntt(Ott.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===e||(this.xf=function(t,e,n){if(t.Kt.P()){var r=0;return t.docChanges.map((function(e){return{type:"added",doc:n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),oldIndex:-1,newIndex:r++}}))}var i=t.Kt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,a=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(a=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:_ct(e.type),doc:r,oldIndex:o,newIndex:a}}))}(this.Nf,e,this.kf.bind(this)),this.Ff=e),this.xf},t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&Xrt(this.Cf,e.Cf)&&this.Nf.isEqual(e.Nf)&&this.f_===e.f_},t.prototype.kf=function(t,e,n){return new hct(this.Af,t.key,t,e,n,this.f_)},t}(),yct=function(t){function e(e,n,r){var i=this;if((i=t.call(this,Lrt(e),n,r)||this).Of=e,e.length%2!=1)throw new Ntt(Ott.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.B()+" has "+e.length);return i}return Object(EP.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new uct(new het(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){0===arguments.length&&(t=Wtt.t()),dut("CollectionReference.doc","path",t);var e=set.q(t);return uct.mf(this.Sf.path.child(e),this.firestore,this.f_)},e.prototype.add=function(t){var e=this.f_?this.f_.toFirestore(t):t,n=this.doc();return new uct(n.__,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Of,this.firestore,t)},e}(mct);function bct(t,e,n){var r=function(t,e){if(!(t instanceof e)){if(e.name===t.constructor.name)throw new Ntt(Ott.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=mut(t);throw new Ntt(Ott.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}(e,uct);if(r.firestore!==n)throw new Ntt(Ott.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function _ct(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jtt()}}function wct(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var xct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(EP.c)(e,t),e.serverTimestamp=function(){var t=new kut("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new xut("deleteField");return t.t_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Eut("arrayUnion",t)}).apply(void 0,t);return r.t_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sut("arrayRemove",t)}).apply(void 0,t);return r.t_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Iut("increment",t)}(t);return n.t_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},e}(Aut),Cct={Firestore:oct,GeoPoint:Tut,Timestamp:iet,Blob:Qtt,Transaction:act,WriteBatch:sct,DocumentReference:uct,DocumentSnapshot:lct,Query:mct,QueryDocumentSnapshot:hct,QuerySnapshot:gct,CollectionReference:yct,FieldPath:but,FieldValue:xct,setLogLevel:function(t){Dtt.setLogLevel(t)},CACHE_SIZE_UNLIMITED:tct};!function(t){!function(t,e){t.INTERNAL.registerComponent(new Rtt.a("firestore",(function(t){return function(t,e){return new oct(t,e,new ict)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Cct)))}(t),t.registerVersion("@firebase/firestore","2.0.0")}(R6.a);var kct={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ect=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Object(EP.c)(e,t),e}(Error),Sct=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t;return Object(EP.d)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(e){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Ict(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Tct,Act,Rct,Oct=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Ict(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Ict(t,(function(t){return e.decode(t)})):t},t}(),Nct=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new Oct,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new Sct(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var a=new URL(r);this.customDomain=a.origin,this.region="us-central1"}catch(s){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f;return Object(EP.d)(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=d.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Ect("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(n.timeout||7e4),u=s.timer,c=s.promise,[4,Promise.race([Dct(u,this.postJSON(r,i,o)),c,Dct(u,this.cancelAllRequests)])];case 2:if(!(l=d.sent()))throw new Ect("cancelled","Firebase Functions instance was deleted.");if(h=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!kct[s])return new Ect("internal","internal");r=kct[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(c){}return"ok"===r?null:new Ect(r,i,o)}(l.status,l.json,this.serializer))throw h;if(!l.json)throw new Ect("internal","Response is not valid JSON object.");if(void 0===(f=l.json.data)&&(f=l.json.result),void 0===f)throw new Ect("internal","Response is missing data field.");return[2,{data:this.serializer.decode(f)}]}}))}))},t}();function Dct(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}Tct=R6.a,Act=fetch.bind(self),Rct={Functions:Nct},Tct.INTERNAL.registerComponent(new Rtt.a("functions",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new Nct(n,r,i,e,Act)}),"PUBLIC").setServiceProps(Rct).setMultipleInstances(!0)),R6.a.registerVersion("@firebase/functions","0.6.0");var Pct,Mct=n("nbvr"),Fct=((Pct={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Pct["not-registered"]="Firebase Installation is not registered.",Pct["installation-not-found"]="Firebase Installation not found.",Pct["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Pct["app-offline"]="Could not process request. Application offline.",Pct["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Pct),Lct=new N6.b("installations","Installations",Fct);function Bct(t){return t instanceof N6.c&&t.code.includes("request-failed")}function jct(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function Vct(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function Uct(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),[2,Lct.create("request-failed",{requestName:t,serverCode:(r=n.error).code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function zct(t){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey})}function Wct(t,e){var n=e.refreshToken,r=zct(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function qct(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Hct(t,e){var n=e.fid;return Object(EP.b)(this,void 0,void 0,(function(){var e,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return e=jct(t),r=zct(t),i={method:"POST",headers:r,body:JSON.stringify({fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:"w:0.4.18"})},[4,qct((function(){return fetch(e,i)}))];case 1:return(o=s.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,{fid:(a=s.sent()).fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:Vct(a.authToken)}];case 3:return[4,Uct("Create Installation",o)];case 4:throw s.sent()}}))}))}function Gct(t){return new Promise((function(e){setTimeout(e,t)}))}var Kct=/^[cdef][\w-]{21}$/;function Xct(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,Object(EP.f)(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Kct.test(e)?e:""}catch(Svt){return""}}function $ct(t){return t.appName+"!"+t.appId}var Yct=new Map;function Qct(t,e){var n=$ct(t);Jct(n,e),function(t,e){var n=tlt();n&&n.postMessage({key:t,fid:e}),elt()}(n,e)}function Jct(t,e){var n,r,i=Yct.get(t);if(i)try{for(var o=Object(EP.h)(i),a=o.next();!a.done;a=o.next())(0,a.value)(e)}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var Zct=null;function tlt(){return!Zct&&"BroadcastChannel"in self&&((Zct=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Jct(t.data.key,t.data.fid)}),Zct}function elt(){0===Yct.size&&Zct&&(Zct.close(),Zct=null)}var nlt,rlt="firebase-installations-store",ilt=null;function olt(){return ilt||(ilt=Object(Mct.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(rlt)}}))),ilt}function alt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return n=$ct(t),[4,olt()];case 1:return r=s.sent(),i=r.transaction(rlt,"readwrite"),[4,(o=i.objectStore(rlt)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||Qct(t,e.fid),[2,e]}}))}))}function slt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return e=$ct(t),[4,olt()];case 1:return n=i.sent(),[4,(r=n.transaction(rlt,"readwrite")).objectStore(rlt).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function ult(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return n=$ct(t),[4,olt()];case 1:return r=u.sent(),i=r.transaction(rlt,"readwrite"),[4,(o=i.objectStore(rlt)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||Qct(t,s.fid),[2,s]}}))}))}function clt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,ult(t,(function(n){var r=function(t){return flt(t||{fid:Xct(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Lct.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Hct(t,e)];case 1:return n=i.sent(),[2,alt(t,n)];case 2:return Bct(r=i.sent())&&409===r.customData.serverCode?[4,slt(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,alt(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:llt(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function llt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return[4,hlt(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Gct(100)];case 3:return o.sent(),[4,hlt(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,clt(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function hlt(t){return ult(t,(function(t){if(!t)throw Lct.create("installation-not-found");return flt(t)}))}function flt(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function dlt(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Object(EP.b)(this,void 0,void 0,(function(){var t,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return t=function(t,e){var n=e.fid;return jct(t)+"/"+n+"/authTokens:generate"}(n,e),i=Wct(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:"w:0.4.18"}})},[4,qct((function(){return fetch(t,a)}))];case 1:return(s=u.sent()).ok?[4,s.json()]:[3,3];case 2:return[2,Vct(u.sent())];case 3:return[4,Uct("Generate Auth Token",s)];case 4:throw u.sent()}}))}))}function plt(t,e){return void 0===e&&(e=!1),Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return[4,ult(t.appConfig,(function(r){if(!mlt(r))throw Lct.create("not-registered");var i,o=r.authToken;if(!e&&2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i))return r;if(1===o.requestStatus)return n=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,vlt(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Gct(100)];case 3:return i.sent(),[4,vlt(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,plt(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw Lct.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return Object(EP.a)(Object(EP.a)({},t),{authToken:e})}(r);return n=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,dlt(t,e)];case 1:return n=o.sent(),i=Object(EP.a)(Object(EP.a)({},e),{authToken:n}),[4,alt(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!Bct(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,slt(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=Object(EP.a)(Object(EP.a)({},e),{authToken:{requestStatus:0}}),[4,alt(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function vlt(t){return ult(t,(function(t){if(!mlt(t))throw Lct.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object(EP.a)(Object(EP.a)({},t),{authToken:{requestStatus:0}}):t}))}function mlt(t){return void 0!==t&&2===t.registrationStatus}function glt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,clt(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function ylt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return jct(t)+"/"+n}(t,e),r=Wct(t,e),i={method:"DELETE",headers:r},[4,qct((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,Uct("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function blt(t){return Lct.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new Rtt.a("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw blt("App Configuration");if(!t.name)throw blt("App Name");try{for(var r=Object(EP.h)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw blt(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,clt(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):plt(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,glt(t.appConfig)];case 1:return n.sent(),[4,plt(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,ult(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw Lct.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw Lct.create("app-offline");case 3:return[4,ylt(e,n)];case 4:return r.sent(),[4,slt(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){tlt();var n=$ct(t),r=Yct.get(n);r||(r=new Set,Yct.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=$ct(t),r=Yct.get(n);r&&(r.delete(e),0===r.size&&Yct.delete(n),elt())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.18")}(R6.a);var _lt=((nlt={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',nlt["only-available-in-window"]="This method is available in a Window context.",nlt["only-available-in-sw"]="This method is available in a service worker context.",nlt["permission-default"]="The notification permission was not granted and dismissed instead.",nlt["permission-blocked"]="The notification permission was not granted and blocked instead.",nlt["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",nlt["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",nlt["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",nlt["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",nlt["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",nlt["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",nlt["token-update-no-token"]="FCM returned no token when updating the user to push.",nlt["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",nlt["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",nlt["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",nlt["invalid-vapid-key"]="The public VAPID key must be a string.",nlt["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",nlt),wlt=new N6.b("messaging","Messaging",_lt),xlt="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Clt=function(t){return t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",t}({});function klt(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Object(EP.f)(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Elt(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function Slt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes("fcm_token_details_db"))return[2,null];r.label=2;case 2:return e=null,[4,Object(Mct.openDb)("fcm_token_details_db",5,(function(r){return Object(EP.b)(n,void 0,void 0,(function(){var n,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains("fcm_token_object_Store")?[4,(n=r.transaction.objectStore("fcm_token_object_Store")).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,n.clear()];case 2:if(s.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:klt(o.vapidKey)}}}else 3===r.oldVersion?e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:klt(o.auth),p256dh:klt(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:klt(o.vapidKey)}}:4===r.oldVersion&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:klt(o.auth),p256dh:klt(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:klt(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,Object(Mct.deleteDb)("fcm_token_details_db")];case 4:return r.sent(),[4,Object(Mct.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,Object(Mct.deleteDb)("undefined")];case 6:return r.sent(),[2,Ilt(e)?e:null]}}))}))}function Ilt(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var Tlt=null;function Alt(){return Tlt||(Tlt=Object(Mct.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore("firebase-messaging-store")}}))),Tlt}function Rlt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return e=Dlt(t),[4,Alt()];case 1:return[4,i.sent().transaction("firebase-messaging-store").objectStore("firebase-messaging-store").get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,Slt(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,Olt(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function Olt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return n=Dlt(t),[4,Alt()];case 1:return r=o.sent(),[4,(i=r.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Nlt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return e=Dlt(t),[4,Alt()];case 1:return n=i.sent(),[4,(r=n.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Dlt(t){return t.appConfig.appId}function Plt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return[4,Blt(t)];case 1:n=s.sent(),r=jlt(e),i={method:"POST",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Llt(t.appConfig),i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),wlt.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw wlt.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw wlt.create("token-subscribe-no-token");return[2,o.token]}}))}))}function Mlt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return[4,Blt(t)];case 1:n=s.sent(),r=jlt(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Llt(t.appConfig)+"/"+e.token,i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),wlt.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw wlt.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw wlt.create("token-update-no-token");return[2,o.token]}}))}))}function Flt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return[4,Blt(t)];case 1:n=a.sent(),r={method:"DELETE",headers:n},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(Llt(t.appConfig)+"/"+e,r)];case 3:return[4,a.sent().json()];case 4:if((i=a.sent()).error)throw wlt.create("token-unsubscribe-failed",{errorInfo:i.error.message});return[3,6];case 5:throw o=a.sent(),wlt.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}}))}))}function Llt(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function Blt(t){var e=t.appConfig,n=t.installations;return Object(EP.b)(this,void 0,void 0,(function(){var t;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function jlt(t){var e=t.vapidKey,n={web:{endpoint:t.endpoint,auth:t.auth,p256dh:t.p256dh}};return e!==xlt&&(n.web.applicationPubKey=e),n}function Vlt(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw wlt.create("permission-blocked");return[4,qlt(e,n)];case 1:return r=s.sent(),[4,Rlt(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:klt(r.getKey("auth")),p256dh:klt(r.getKey("p256dh"))},i?[3,3]:[2,Wlt(t,o)];case 3:if(l=(c=o).endpoint===(u=i.subscriptionOptions).endpoint,c.vapidKey===u.vapidKey&&l&&c.auth===u.auth&&c.p256dh===u.p256dh)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Flt(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Wlt(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,zlt({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l}))}))}function Ult(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,Rlt(t)];case 1:return(n=i.sent())?[4,Flt(t,n.token)]:[3,4];case 2:return i.sent(),[4,Nlt(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function zlt(t,e,n){return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,Mlt(e,t)];case 1:return r=a.sent(),i=Object(EP.a)(Object(EP.a)({},t),{token:r,createTime:Date.now()}),[4,Olt(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,Ult(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Wlt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,Plt(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,Olt(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function qlt(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Elt(e)})]}}))}))}function Hlt(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Glt(t){return new Promise((function(e){setTimeout(e,t)}))}var Klt=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw wlt.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,Rlt(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:xlt,r.label=2;case 2:return[2,Vlt(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return Ult(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw wlt.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw wlt.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw wlt.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw wlt.create("only-available-in-window")},t.prototype.onMessage=function(){throw wlt.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw wlt.create("only-available-in-window")},t.prototype.onPush=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t))?[4,Qlt()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Ylt(n,e)]:(r=!1,e.notification?[4,Jlt(Xlt(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[2])}}))}))},t.prototype.onSubChange=function(t){var e,n;return Object(EP.b)(this,void 0,void 0,(function(){var r;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Ult(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,Rlt(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Ult(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Vlt(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:xlt)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return Object(EP.b)(this,void 0,void 0,(function(){var r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r;return(null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action)||(Hlt(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,$lt(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,Glt(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Clt.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function Xlt(t){var e,n=Object(EP.a)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function $lt(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return[4,Qlt()];case 1:e=u.sent();try{for(n=Object(EP.h)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(c){a={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Ylt(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Clt.PUSH_RECEIVED;try{for(var i=Object(EP.h)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Qlt(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Jlt(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Zlt=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Clt.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),Hlt(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw wlt.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,Vlt(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=xlt),[2]}))}))},t.prototype.updateSwReg=function(t){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw wlt.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),wlt.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Ult(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t;return Object(EP.d)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw wlt.create("denied"===t?"permission-blocked":"permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw wlt.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw wlt.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw wlt.create("invalid-sw-registration");if(this.swRegistration)throw wlt.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw wlt.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw wlt.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Clt.NOTIFICATION_CLICKED:return"notification_open";case Clt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function tht(t){return wlt.create("missing-app-config-values",{valueName:t})}var eht={isSupported:nht};function nht(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}R6.a.INTERNAL.registerComponent(new Rtt.a("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw tht("App Configuration Object");if(!t.name)throw tht("App Name");var r=t.options;try{for(var i=Object(EP.h)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw tht(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!nht())throw wlt.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Klt(n):new Zlt(n)}),"PUBLIC").setServiceProps(eht));var rht=function(t){function e(n,r){var i=t.call(this,iht(n),"Firebase Storage: "+r)||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return Object(EP.c)(e,t),e.prototype.codeEquals=function(t){return iht(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(N6.c);function iht(t){return"storage/"+t}function oht(){return new rht("unknown","An unknown error occurred, please check the error payload for server response.")}function aht(){return new rht("canceled","User canceled the upload/download.")}function sht(){return new rht("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function uht(){return new rht("app-deleted","The Firebase app was deleted.")}function cht(t,e){return new rht("invalid-format","String does not match format '"+t+"': "+e)}function lht(t){throw new rht("internal-error","Internal error: "+t)}var hht={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},fht=function(t,e){this.data=t,this.contentType=e||null};function dht(t,e){switch(t){case hht.RAW:return new fht(pht(e));case hht.BASE64:case hht.BASE64URL:return new fht(vht(t,e));case hht.DATA_URL:return new fht((n=new mht(e)).base64?vht(hht.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(n){throw cht(hht.DATA_URL,"Malformed data URL.")}return pht(e)}(n.rest),new mht(e).contentType)}var n;throw oht()}function pht(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1))){var i=r,o=t.charCodeAt(++n);e.push(240|(r=65536|(1023&i)<<10|1023&o)>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function vht(t,e){switch(t){case hht.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw cht(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case hht.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw cht(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(c){throw cht(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var mht=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw cht(hht.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r=e[1]||null;null!=r&&(this.base64=(n=r).length>=";base64".length&&";base64"===n.substring(n.length-";base64".length),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)},ght={STATE_CHANGED:"state_changed"},yht={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function bht(t){switch(t){case"running":case"pausing":case"canceling":return yht.RUNNING;case"paused":return yht.PAUSED;case"success":return yht.SUCCESS;case"canceled":return yht.CANCELED;case"error":default:return yht.ERROR}}function _ht(t){return null!=t}function wht(t){return"string"==typeof t||t instanceof String}function xht(t){return Cht()&&t instanceof Blob}function Cht(){return"undefined"!=typeof Blob}function kht(t,e,n,r){if(r<e)throw new rht("invalid-argument","Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw new rht("invalid-argument","Invalid value for '"+t+"'. Expected "+n+" or less.")}var Eht=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}({}),Sht=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Eht.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=Eht.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=Eht.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw lht("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),_ht(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return _ht(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw lht("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw lht("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw lht("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){_ht(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){_ht(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Iht=function(){function t(){}return t.prototype.createXhrIo=function(){return new Sht},t}();function Tht(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Aht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Tht();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Cht())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}var Rht=function(){function t(t,e){var n=0,r="";xht(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(xht(this.data_)){var r=(o=e,a=n,(i=this.data_).webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Cht()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Aht.apply(null,r))}var i=e.map((function(t){return wht(t)?dht(hht.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Oht=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(r){return new t(e,"")}if(""===n.path)return n;throw new rht("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function i(t){t.path_=decodeURIComponent(t.path)}for(var o="firebasestorage.googleapis.com".replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:i}],s=0;s<a.length;s++){var u=a[s],c=u.regex.exec(e);if(c){var l=c[u.indices.path];l||(l=""),n=new t(c[u.indices.bucket],l),u.postModify(n);break}}if(null==n)throw function(t){return new rht("invalid-url","Invalid URL '"+t+"'.")}(e);return n},t}();function Nht(t){var e,n;try{e=JSON.parse(t)}catch(r){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function Dht(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Pht(t){return"https://firebasestorage.googleapis.com/v0"+t}function Mht(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}function Fht(t,e){return e}var Lht=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Fht},Bht=null;function jht(t,e,n){var r=Nht(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=new Oht(t.bucket,t.fullPath);return e.makeStorageReference(n)}})}(r,t),r}(t,r,n)}function Vht(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var Uht=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function zht(t){if(!t)throw oht()}function Wht(t,e){return function(n,r){var i=jht(t,r,e);return zht(null!==i),i}}function qht(t){return function(e,n){var r;return(r=401===e.getStatus()?new rht("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?new rht("quota-exceeded","Quota for bucket '"+t.bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/."):403===e.getStatus()?new rht("unauthorized","User does not have permission to access '"+t.path+"'."):n).serverResponse=n.serverResponse,r}}function Hht(t){var e=qht(t);return function(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=new rht("object-not-found","Object '"+t.path+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Ght(t,e,n){var r=Pht(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Uht(r,"GET",Wht(t,n),i);return o.errorHandler=Hht(e),o}function Kht(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var Xht=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function $ht(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(r){zht(!1)}return zht(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Yht=function(t,e,n){if("function"==typeof t||_ht(e)||_ht(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},Qht=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function Jht(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Zht=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.service_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_="running",this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals("canceled")?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_("error"))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals("canceled")?a.completeTransitions_():(a.error_=t,a.transition_("error"))},this.promise_=new Promise((function(t,e){a.resolve_=t,a.reject_=e,a.start_()})),this.promise_.then(null,(function(){}))}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){"running"===this.state_&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.service_.getAuthToken().then((function(n){switch(e.state_){case"running":t(n);break;case"canceling":e.transition_("canceled");break;case"pausing":e.transition_("paused")}}))},t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Kht(e,r,i),s={name:a.fullPath},u=Pht(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=Vht(a,n),h=new Uht(u,"POST",(function(t){var e;$ht(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){zht(!1)}return zht(wht(e)),e}),t.maxUploadRetryTime);return h.urlParams=s,h.headers=c,h.body=l,h.errorHandler=qht(e),h}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_((function(n){var r=function(t,e,n,r){var i=new Uht(n,"POST",(function(t){var e=$ht(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){zht(!1)}n||zht(!1);var i=Number(n);return zht(!isNaN(i)),new Xht(i,r.size(),"final"===e)}),t.maxUploadRetryTime);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=qht(e),i}(t.service_,t.location_,e,t.blob_),i=t.service_.makeRequest(r,n);t.request_=i,i.getPromise().then((function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new Xht(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=function(t,e,n,r,i,o,a,s){var u=new Xht(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new rht("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,h+l);if(null===d)throw sht();var p=new Uht(n,"POST",(function(t,n){var i,a=$ht(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?Wht(e,o)(t,n):null,new Xht(s,c,"final"===a,i)}),e.maxUploadRetryTime);return p.headers=f,p.body=d.uploadData(),p.progressCallback=s||null,p.errorHandler=qht(t),p}(t.location_,t.service_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(s){return t.error_=s,void t.transition_("error")}var a=t.service_.makeRequest(o,i);t.request_=a,a.getPromise().then((function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_("success")):t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=Ght(t.service_,t.location_,t.mappings_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.transition_("success")}),t.metadataErrorHandler_)}))},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Kht(e,r,i),c=Vht(u,n),l=Rht.getBlob("--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",r,"\r\n--"+s+"--");if(null===l)throw sht();var h={name:u.fullPath},f=Pht(o),d=t.maxUploadRetryTime,p=new Uht(f,"POST",Wht(t,n),d);return p.urlParams=h,p.headers=a,p.body=l.uploadData(),p.errorHandler=qht(e),p}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_("success")}),t.errorHandler_)}))},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case"canceling":case"pausing":this.state_=t,null!==this.request_&&this.request_.cancel();break;case"running":var e="paused"===this.state_;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case"paused":this.state_=t,this.notifyObservers_();break;case"canceled":this.error_=aht(),this.state_=t,this.notifyObservers_();break;case"error":case"success":this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case"pausing":this.transition_("paused");break;case"canceling":this.transition_("canceled");break;case"running":this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=bht(this.state_);return new Qht(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Yht(e,n,r);return this.addObserver_(o),function(){i.removeObserver_(o)}},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach((function(e){t.notifyObserver_(e)}))},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(bht(this.state_)){case yht.SUCCESS:Jht(this.resolve_.bind(null,this.snapshot))();break;case yht.CANCELED:case yht.ERROR:Jht(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(bht(this.state_)){case yht.RUNNING:case yht.PAUSED:t.next&&Jht(t.next.bind(t,this.snapshot))();break;case yht.SUCCESS:t.complete&&Jht(t.complete.bind(t))();break;case yht.CANCELED:case yht.ERROR:t.error&&Jht(t.error.bind(t,this.error_))();break;default:t.error&&Jht(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){var t="paused"===this.state_||"pausing"===this.state_;return t&&this.transition_("running"),t},t.prototype.pause=function(){var t="running"===this.state_;return t&&this.transition_("pausing"),t},t.prototype.cancel=function(){var t="running"===this.state_||"pausing"===this.state_;return t&&this.transition_("canceling"),t},t}(),tft=function(){function t(t,e){this.service=t,this.location=e instanceof Oht?e:Oht.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return function(){if(Bht)return Bht;var t=[];t.push(new Lht("bucket")),t.push(new Lht("generation")),t.push(new Lht("metageneration")),t.push(new Lht("name","fullPath",!0));var e=new Lht("name");e.xform=function(t,e){return function(t){return!wht(t)||t.length<2?t:Dht(t)}(e)},t.push(e);var n=new Lht("size");return n.xform=function(t,e){return _ht(e)?Number(e):e},t.push(n),t.push(new Lht("timeCreated")),t.push(new Lht("updated")),t.push(new Lht("md5Hash",null,!0)),t.push(new Lht("cacheControl",null,!0)),t.push(new Lht("contentDisposition",null,!0)),t.push(new Lht("contentEncoding",null,!0)),t.push(new Lht("contentLanguage",null,!0)),t.push(new Lht("contentType",null,!0)),t.push(new Lht("metadata","customMetadata",!0)),Bht=t}()},t.prototype.child=function(t){var e=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new Oht(this.location.bucket,e);return this.newRef(this.service,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new Oht(this.location.bucket,t);return this.newRef(this.service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new Oht(this.location.bucket,"");return this.newRef(this.service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Dht(this.location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.service},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),this.throwIfRoot_("put"),new Zht(this,this.service,this.location,this.mappings(),new Rht(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=hht.RAW),this.throwIfRoot_("putString");var r=dht(e,t),i=Object.assign({},n);return!_ht(i.contentType)&&_ht(r.contentType)&&(i.contentType=r.contentType),new Zht(this,this.service,this.location,this.mappings(),new Rht(r.data,!0),i)},t.prototype.delete=function(){var t=this;return this.throwIfRoot_("delete"),this.service.getAuthToken().then((function(e){var n=function(t,e){var n=Pht(e.fullServerUrl()),r=new Uht(n,"DELETE",(function(t,e){}),t.maxOperationRetryTime);return r.successCodes=[200,204],r.errorHandler=Hht(e),r}(t.service,t.location);return t.service.makeRequest(n,e).getPromise()}))},t.prototype.listAll=function(){var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))},t.prototype.listAllHelper=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return[4,this.list({pageToken:e})];case 1:return n=o.sent(),(r=t.prefixes).push.apply(r,n.prefixes),(i=t.items).push.apply(i,n.items),null==n.nextPageToken?[3,3]:[4,this.listAllHelper(t,n.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.prototype.list=function(t){var e=this,n=t||{};return"number"==typeof n.maxResults&&kht("options.maxResults",1,1e3,n.maxResults),this.service.getAuthToken().then((function(t){var r=function(t,e,n,r,i){var o={};o.prefix=e.isRoot?"":e.path+"/","/".length>0&&(o.delimiter="/"),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Pht(e.bucketOnlyServerUrl()),s=t.maxOperationRetryTime,u=new Uht(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=Nht(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t.makeStorageReference(new Oht(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++)s=t.makeStorageReference(new Oht(e,c[u].name)),r.items.push(s);return r}(t,e,r)}(t,e,r);return zht(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=qht(e),u}(e.service,e.location,0,n.pageToken,n.maxResults);return e.service.makeRequest(r,t).getPromise()}))},t.prototype.getMetadata=function(){var t=this;return this.throwIfRoot_("getMetadata"),this.service.getAuthToken().then((function(e){var n=Ght(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise()}))},t.prototype.updateMetadata=function(t){var e=this;return this.throwIfRoot_("updateMetadata"),this.service.getAuthToken().then((function(n){var r=function(t,e,n,r){var i=Pht(e.fullServerUrl()),o=Vht(n,r),a=t.maxOperationRetryTime,s=new Uht(i,"PATCH",Wht(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Hht(e),s}(e.service,e.location,t,e.mappings());return e.service.makeRequest(r,n).getPromise()}))},t.prototype.getDownloadURL=function(){var t=this;return this.throwIfRoot_("getDownloadURL"),this.service.getAuthToken().then((function(e){var n=function(t,e,n){var r=Pht(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Uht(r,"GET",function(t,e){return function(n,r){var i=jht(t,r,e);return zht(null!==i),function(t,e){var n=Nht(e);if(null===n)return null;if(!wht(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.fullPath;return Pht("/b/"+i(t.bucket)+"/o/"+i(n))+Mht({alt:"media",token:e})}))[0]}(i,r)}}(t,n),i);return o.errorHandler=Hht(e),o}(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new rht("no-download-url","The given file does not have any download URLs.");return t}))}))},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new rht("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),eft=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),nft=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());void 0!==s?i(s):i()}catch(u){o(u)}else null!==a?((r=oht()).serverResponse=a.getResponseText(),o(t.errorCallback_?t.errorCallback_(a,r):r)):o(r=n.canceled?t.appDelete_?uht():aht():new rht("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new rft(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new rft(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===Eht.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new rft(a,n))}else{var s=n.getErrorCode()===Eht.ABORT;e(!1,new rft(!1,null,s))}}))}function i(e){null!==t.progressCallback_&&t.progressCallback_(e.loaded,e.lengthComputable?e.total:-1)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)l.call.apply(l,Object(EP.g)([null,t],e));else{var r,o=u()||a;o?l.call.apply(l,Object(EP.g)([null,t],e)):(i<64&&(i*=2),1===s?(s=2,r=0):r=1e3*(i+Math.random()),h(r))}}var d=!1;function p(t){d||(d=!0,c||(null!==o?(t||(s=2),clearTimeout(o),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,p(!0)}),r),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),rft=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n},ift=function(){function t(e,n,r,i){var o;this.bucket_=null,this.appId_=null,this.deleted_=!1,this.app_=e,this.authProvider_=n,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e5,this.requests_=new Set,this.pool_=r,this.bucket_=null!=i?Oht.makeFromBucketSpec(i):t.extractBucket_(null===(o=this.app_)||void 0===o?void 0:o.options),this.internals_=new oft(this)}return t.extractBucket_=function(t){var e=null==t?void 0:t.storageBucket;return null==e?null:Oht.makeFromBucketSpec(e)},t.prototype.getAuthToken=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return(t=this.authProvider_.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requests_.forEach((function(t){return t.cancel()})),this.requests_.clear()},t.prototype.makeStorageReference=function(t){return new tft(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this.deleted_)return new eft(uht());var r=function(t,e,n,r){var i=Mht(t.urlParams),o=t.url+i,a=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(a,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(a,n),function(t){t["X-Firebase-Storage-Version"]="webjs/"+(void 0!==R6.a?R6.a.SDK_VERSION:"AppManager")}(a),new nft(o,t.method,a,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this.appId_,e,this.pool_);return this.requests_.add(r),r.getPromise().then((function(){return n.requests_.delete(r)}),(function(){return n.requests_.delete(r)})),r},t.prototype.ref=function(t){if(/^[A-Za-z]+:\/\//.test(t))throw new rht("invalid-argument","Expected child path but got a URL, use refFromURL instead.");if(null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new tft(this,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){if(!/^[A-Za-z]+:\/\//.test(t))throw new rht("invalid-argument","Expected full URL but got a child path, use ref instead.");try{Oht.makeFromUrl(t)}catch(e){throw new rht("invalid-argument","Expected valid full URL but got an invalid one.")}return new tft(this,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.maxUploadRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){kht("time",0,Number.POSITIVE_INFINITY,t),this.maxUploadRetryTime_=t},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.maxOperationRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){kht("time",0,Number.POSITIVE_INFINITY,t),this.maxOperationRetryTime_=t},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!1,configurable:!0}),t}(),oft=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.deleteApp(),Promise.resolve()},t}();function aft(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new ift(n,r,new Iht,e)}function sft(t){var e={TaskState:yht,TaskEvent:ght,StringFormat:hht,Storage:ift,Reference:tft};t.INTERNAL.registerComponent(new Rtt.a("storage",aft,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.4.0")}sft(R6.a);var uft,cft,lft,hft=((uft={})["trace started"]="Trace {$traceName} was started before.",uft["trace stopped"]="Trace {$traceName} is not running.",uft["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",uft["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",uft["no window"]="Window is not available.",uft["no app id"]="App id is not available.",uft["no project id"]="Project id is not available.",uft["no api key"]="Api key is not available.",uft["invalid cc log"]="Attempted to queue invalid cc event",uft["FB not default"]="Performance can only start when Firebase app instance is the default one.",uft["RC response not ok"]="RC response is not ok",uft["invalid attribute name"]="Attribute name {$attributeName} is invalid.",uft["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",uft["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",uft["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",uft),fft=new N6.b("performance","Performance",hft),dft=new O6.b("Performance");dft.logLevel=O6.a.INFO;var pft,vft=function(){function t(t){if(this.window=t,!t)throw fft.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Object(N6.w)()||(dft.info("IndexedDB is not supported by current browswer"),!1):(dft.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++)e(r[n])})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===cft&&(cft=new t(lft)),cft},t}();function mft(t,e){var n=t.length-e.length;if(n<0||n>1)throw fft.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var gft,yft=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=mft("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=mft("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw fft.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw fft.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw fft.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===pft&&(pft=new t),pft},t}();function bft(){return gft}var _ft=function(t){return t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN",t}({}),wft=["firebase_","google_","ga_"],xft=new RegExp("^[a-zA-Z]\\w*$");function Cft(){var t=vft.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function kft(){switch(vft.getInstance().document.visibilityState){case"visible":return _ft.VISIBLE;case"hidden":return _ft.HIDDEN;default:return _ft.UNKNOWN}}function Eft(){var t=vft.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Sft(t){if(!t)return t;var e=yft.getInstance(),n=t.entries||{};return e.loggingEnabled=void 0===n.fpr_enabled||"true"===String(n.fpr_enabled),n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Ift(e.tracesSamplingRate),e.logNetworkAfterSampling=Ift(e.networkRequestsSamplingRate),t}function Ift(t){return Math.random()<=t}var Tft,Aft=1;function Rft(){return Aft=2,Tft=Tft||function(){var t=vft.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){t.addEventListener("readystatechange",(function n(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())}))}else e()}))}().then((function(){return(t=yft.getInstance().installationsService.getId()).then((function(t){gft=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=vft.getInstance().localStorage;if(t){var e=t.getItem("@firebase/performance/configexpire");if(e&&Number(e)>Date.now()){var n=t.getItem("@firebase/performance/config");if(n)try{return JSON.parse(n)}catch(Svt){return}}}}();return e?(Sft(e),Promise.resolve()):function(t){return(e=yft.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+yft.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+yft.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:yft.getInstance().getAppId(),app_version:"0.4.3",sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw fft.create("RC response not ok")}))})).catch((function(){dft.info("Could not fetch config, will use default configs")}));var e}(t).then(Sft).then((function(t){return function(t){var e=vft.getInstance().localStorage;t&&e&&(e.setItem("@firebase/performance/config",JSON.stringify(t)),e.setItem("@firebase/performance/configexpire",String(Date.now()+60*yft.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return Oft()}),(function(){return Oft()}))}function Oft(){Aft=3}var Nft,Dft=3,Pft=[],Mft=!1;function Fft(t){if(!t.eventTime||!t.message)throw fft.create("invalid cc log");Pft=Object(EP.g)(Pft,[t])}function Lft(t,e){var n;Nft||(n=Vft,Nft=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=n.apply(void 0,t);Fft({message:r,eventTime:Date.now()})}),Nft(t,e)}function Bft(t){var e=yft.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&vft.getInstance().requiredApisAvailable()&&(t.isAuto&&kft()!==_ft.VISIBLE||(3===Aft?jft(t):Rft().then((function(){return jft(t)}),(function(){return jft(t)}))))}function jft(t){if(bft()){var e=yft.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return Lft(t,1)}),0)}}function Vft(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Uft(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Uft(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Uft(){return{google_app_id:yft.getInstance().getAppId(),app_instance_id:bft(),web_app_info:{sdk_version:"0.4.3",page_url:vft.getInstance().getUrl(),service_worker_status:Cft(),visibility_state:kft(),effective_connection_type:Eft()},application_process_state:0}}var zft=["_fp","_fcp","_fid"],Wft=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=vft.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw fft.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw fft.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Bft(this)},t.prototype.record=function(t,e,n){if(t<=0)throw fft.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw fft.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object(EP.a)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Bft(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),this.putMetric(t,void 0===this.counters[t]?e:this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||t.length>100)&&(e&&e.startsWith("_wt_")&&zft.indexOf(t)>-1||!t.startsWith("_"))}(t,this.name))throw fft.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=(n=e,(r=Math.floor(n))<n&&dft.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=function(t){return!(0===t.length||t.length>40||wft.some((function(e){return t.startsWith(e)}))||!t.match(xft))}(t),r=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw fft.create("invalid attribute name",{attributeName:t});if(!r)throw fft.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Object(EP.a)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=vft.getInstance().getUrl();if(i){var o=new t("_wt_"+i,!0),a=Math.floor(1e3*vft.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))}Bft(o)}},t.createUserTimingTrace=function(e){Bft(new t(e,!1,e))},t}();function qft(t){var e=t;if(e&&void 0!==e.responseStart){var n=vft.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=yft.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return Lft(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Hft(){bft()&&(setTimeout((function(){return function(){var t=vft.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){Wft.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),Wft.createOobTrace(e,n,t))}))}else Wft.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=vft.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)qft(n[e]);t.setupObserver("resource",qft)}()}),0),setTimeout((function(){return function(){for(var t=vft.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)Gft(n[e]);t.setupObserver("measure",Gft)}()}),0))}function Gft(t){var e=t.name;"FB-PERF-TRACE-MEASURE"!==e.substring(0,"FB-PERF-TRACE-MEASURE".length)&&Wft.createUserTimingTrace(e)}var Kft=function(){function t(t){this.app=t,vft.getInstance().requiredApisAvailable()&&Object(N6.N)().then((function(t){t&&(Mft||(function t(e){setTimeout((function(){if(0!==Dft)return Pft.length?void function(){var e=Object(EP.g)(Pft);Pft=[];var n=e.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}));(function(e,n){return function(t){var e=yft.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(e).then((function(t){return t.ok||dft.info("Call to Firebase backend failed."),t.json()})).then((function(e){var r=Number(e.nextRequestWaitMillis),i=1e4;isNaN(r)||(i=Math.max(r,i));var o=e.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(Pft=Object(EP.g)(n,Pft),dft.info("Retry transport request later.")),Dft=3,t(i)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:yft.getInstance().logSource,log_event:n},e).catch((function(){Pft=Object(EP.g)(e,Pft),Dft--,dft.info("Tries left: "+Dft+"."),t(1e4)}))}():t(1e4)}),e)}(5500),Mft=!0),Rft().then(Hft,Hft))})).catch((function(t){dft.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new Wft(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return yft.getInstance().instrumentationEnabled},set:function(t){yft.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return yft.getInstance().dataCollectionEnabled},set:function(t){yft.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new Rtt.a("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw fft.create("FB not default");if("undefined"==typeof window)throw fft.create("no window");return function(t){lft=t}(window),yft.getInstance().firebaseAppInstance=t,yft.getInstance().installationsService=e,new Kft(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance","0.4.3")}(R6.a);var Xft,$ft="https://www.googletagmanager.com/gtag/js",Yft=function(t){return t.EVENT="event",t.SET="set",t.CONFIG="config",t}({}),Qft=function(t){return t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results",t}({}),Jft=new O6.b("@firebase/analytics");function Zft(t,e,n,r,i,o){return Object(EP.b)(this,void 0,void 0,(function(){var a,s,u,c;return Object(EP.d)(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),Jft.error(c),[3,8];case 8:return t(Yft.CONFIG,i,o),[2]}}))}))}function tdt(t,e,n,r,i){return Object(EP.b)(this,void 0,void 0,(function(){var o,a,s,u,c,l,h;return Object(EP.d)(this,(function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=f.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&"break"!==u(l[c]);c++);f.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return f.sent(),t(Yft.EVENT,r,i||{}),[3,5];case 4:return h=f.sent(),Jft.error(h),[3,5];case 5:return[2]}}))}))}var edt=((Xft={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Xft["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Xft["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Xft["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Xft["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Xft["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Xft["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Xft["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Xft["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Xft),ndt=new N6.b("analytics","Analytics",edt),rdt=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function idt(t){var e;return Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return n=t.appId,r={method:"GET",headers:(c=t.apiKey,new Headers({Accept:"application/json","x-goog-api-key":c}))},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(i,r)];case 1:if(200===(o=u.sent()).status||304===o.status)return[3,6];a="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return s=u.sent(),(null===(e=s.error)||void 0===e?void 0:e.message)&&(a=s.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw ndt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a});case 6:return[2,o.json()]}var c}))}))}function odt(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=rdt),Object(EP.b)(this,void 0,void 0,(function(){var e,a,s,u,c,l,h;return Object(EP.d)(this,(function(f){switch(f.label){case 0:e=t.appId,a=t.measurementId,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,adt(n,i)];case 2:return f.sent(),[3,4];case 3:if(s=f.sent(),a)return Jft.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+s.message+"]"),[2,{appId:e,measurementId:a}];throw s;case 4:return f.trys.push([4,6,,7]),[4,idt(t)];case 5:return u=f.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof N6.c&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=f.sent())){if(r.deleteThrottleMetadata(e),a)return Jft.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:a}];throw c}return l=503===Number(c.customData.httpStatus)?Object(N6.j)(o,r.intervalMillis,30):Object(N6.j)(o,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:o+1},r.setThrottleMetadata(e,h),Jft.debug("Calling attemptFetch again in "+l+" millis"),[2,odt(t,h,n,r)];case 7:return[2]}}))}))}function adt(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(ndt.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var sdt,udt,cdt=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),ldt={},hdt=[],fdt={},ddt="dataLayer",pdt="gtag",vdt=!1;function mdt(t){if(vdt)throw ndt.create("already-initialized");t.dataLayerName&&(ddt=t.dataLayerName),t.gtagName&&(pdt=t.gtagName)}function gdt(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:if(Object(N6.s)())return[2,!1];if(!Object(N6.e)())return[2,!1];if(!Object(N6.w)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(N6.N)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Rtt.a("analytics",(function(t){return function(t,e){!function(){var t=[];if(Object(N6.s)()&&t.push("This is a browser extension environment."),Object(N6.e)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=ndt.create("invalid-analytics-context",{errorInfo:e});Jft.warn(n.message)}}();var n=t.options.appId;if(!n)throw ndt.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw ndt.create("no-api-key");Jft.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=ldt[n])throw ndt.create("already-exists",{id:n});if(!vdt){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes($ft))return r}return null})()||function(t){var e=document.createElement("script");e.src=$ft+"?l="+t,e.async=!0,document.head.appendChild(e)}(ddt),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ddt);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return Object(EP.b)(this,void 0,void 0,(function(){var s;return Object(EP.d)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Yft.EVENT?[3,2]:[4,tdt(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==Yft.CONFIG?[3,4]:[4,Zft(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(Yft.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),Jft.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(ldt,hdt,fdt,ddt,pdt);udt=r.wrappedGtag,sdt=r.gtagCore,vdt=!0}return ldt[n]=function(t,e,n,r,i){return Object(EP.b)(this,void 0,void 0,(function(){var o,a,s,u,c,l,h;return Object(EP.d)(this,(function(f){switch(f.label){case 0:return(o=function(t,e,n){return void 0===e&&(e=rdt),Object(EP.b)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return Object(EP.d)(this,(function(c){if(i=(n=t.options).apiKey,o=n.measurementId,!(r=n.appId))throw ndt.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw ndt.create("no-api-key")}return a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new cdt,setTimeout((function(){return Object(EP.b)(u,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){return s.abort(),[2]}))}))}),6e4),[2,odt({appId:r,apiKey:i,measurementId:o},a,s,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Jft.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Jft.error(t)})),e.push(o),a=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t;return Object(EP.d)(this,(function(e){switch(e.label){case 0:return Object(N6.w)()?[3,1]:(Jft.warn(ndt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,Object(N6.N)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Jft.warn(ndt.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([o,a])];case 1:return s=f.sent(),u=s[0],c=s[1],i("js",new Date),(h={}).origin="firebase",h.update=!0,l=h,null!=c&&(l.firebase_id=c),i(Yft.CONFIG,u.measurementId,l),[2,u.measurementId]}}))}))}(t,hdt,fdt,e,sdt),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return Object(EP.b)(this,void 0,void 0,(function(){var o,a;return Object(EP.d)(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(Yft.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=Object(EP.a)(Object(EP.a)({},r),{send_to:o}),t(Yft.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(udt,ldt[n],t,e,r).catch((function(t){return Jft.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Yft.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Yft.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(udt,ldt[n],t,e).catch((function(t){return Jft.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i;return Object(EP.d)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Yft.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Yft.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(udt,ldt[n],t,e).catch((function(t){return Jft.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return Object(EP.b)(this,void 0,void 0,(function(){var i,o,a,s,u;return Object(EP.d)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)i["user_properties."+(s=a[o])]=n[s];return t(Yft.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Yft.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(udt,ldt[n],t,e).catch((function(t){return Jft.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(ldt[n],t).catch((function(t){return Jft.error(t)}))},INTERNAL:{delete:function(){return delete ldt[n],Promise.resolve()}}}}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:mdt,EventName:Qft,isSupported:gdt})),t.INTERNAL.registerComponent(new Rtt.a("analytics-internal",(function(t){try{return{logEvent:t.getProvider("analytics").getImmediate().logEvent}}catch(e){throw ndt.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.1")}(R6.a);var ydt,bdt=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),_dt=((ydt={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",ydt["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",ydt["registration-api-key"]="Undefined API key. Check Firebase app initialization.",ydt["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",ydt["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",ydt["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",ydt["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",ydt["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",ydt["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",ydt["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',ydt["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',ydt["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",ydt["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",ydt),wdt=new N6.b("remoteconfig","Remote Config",_dt),xdt=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v,m;return Object(EP.d)(this,(function(g){switch(g.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=g.sent(),n=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",r=n+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,i={sdk_version:this.sdkVersion,app_instance_id:e[0],app_instance_id_token:e[1],app_id:this.appId,language_code:(void 0===y&&(y=navigator),y.languages&&y.languages[0]||y.language)},o={method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},body:JSON.stringify(i)},a=fetch(r,o),s=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),g.label=2;case 2:return g.trys.push([2,5,,6]),[4,Promise.race([a,s])];case 3:return g.sent(),[4,a];case 4:return u=g.sent(),[3,6];case 5:throw c=g.sent(),l="fetch-client-network","AbortError"===c.name&&(l="fetch-timeout"),wdt.create(l,{originalErrorMessage:c.message});case 6:if(h=u.status,f=u.headers.get("ETag")||void 0,200!==u.status)return[3,11];v=void 0,g.label=7;case 7:return g.trys.push([7,9,,10]),[4,u.json()];case 8:return v=g.sent(),[3,10];case 9:throw m=g.sent(),wdt.create("fetch-client-parse",{originalErrorMessage:m.message});case 10:d=v.entries,p=v.state,g.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===p?h=500:"NO_CHANGE"===p?h=304:"NO_TEMPLATE"!==p&&"EMPTY_CONFIG"!==p||(d={}),304!==h&&200!==h)throw wdt.create("fetch-status",{httpStatus:h});return[2,{status:h,eTag:f,config:d}]}var y}))}))},t}(),Cdt=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),kdt=["1","true","t","yes","y","on"],Edt=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&kdt.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Sdt=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=O6.a.DEBUG;break;case"silent":this._logger.logLevel=O6.a.SILENT;break;default:this._logger.logLevel=O6.a.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e,n;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),n=t[1],(e=t[0])&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e,n,r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:t=new Cdt,setTimeout((function(){return Object(EP.b)(r,void 0,void 0,(function(){return Object(EP.d)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=(o=e)instanceof N6.c&&-1!==o.code.indexOf("fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}var o}))}))},t.prototype.fetchAndActivate=function(){return Object(EP.b)(this,void 0,void 0,(function(){return Object(EP.d)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(Object(EP.a)(Object(EP.a)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Edt("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Edt("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Edt("static"))},t}();function Idt(t,e){var n=t.target.error||void 0;return wdt.create(e,{originalErrorMessage:n&&n.message})}var Tdt=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Idt(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore("app_namespace_store",{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readonly").objectStore("app_namespace_store"),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Idt(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(u){i(wdt.create("storage-get",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Object(EP.b)(this,void 0,void 0,(function(){var n,r=this;return Object(EP.d)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Idt(t,"storage-set"))},u.onsuccess=function(){i()}}catch(c){o(wdt.create("storage-set",{originalErrorMessage:c&&c.message}))}}))]}}))}))},t.prototype.delete=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e,n=this;return Object(EP.d)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Idt(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(u){i(wdt.create("storage-delete",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Adt=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Object(EP.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Rdt(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(wdt.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Odt,Ndt=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Object(EP.b)(this,void 0,void 0,(function(){var e;return Object(EP.d)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return Object(EP.b)(this,void 0,void 0,(function(){var e,i,o;return Object(EP.d)(this,(function(a){switch(a.label){case 0:return[4,Rdt(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof N6.c&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=a.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+Object(N6.j)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}();(Odt=R6.a).INTERNAL.registerComponent(new Rtt.a("remoteConfig",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw wdt.create("registration-window");var i=n.options,o=i.projectId,a=i.apiKey,s=i.appId;if(!o)throw wdt.create("registration-project-id");if(!a)throw wdt.create("registration-api-key");if(!s)throw wdt.create("registration-app-id");var u=new Tdt(s,n.name,e=e||"firebase"),c=new Adt(u),l=new O6.b("@firebase/remote-config");l.logLevel=O6.a.ERROR;var h=new xdt(r,Odt.SDK_VERSION,e,o,a,s),f=new Ndt(h,u),d=new bdt(f,u,c,l),p=new Sdt(n,d,c,u,l);return p.ensureInitialized(),p}),"PUBLIC").setMultipleInstances(!0)),Odt.registerVersion("@firebase/remote-config","0.1.29"),R6.a.registerVersion("firebase","8.0.0","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),R6.a.registerVersion("firebase","8.0.0");var Ddt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xC;return _classCallCheck(this,n),(r=e.call(this)).source=t,r.delayTime=i,r.scheduler=o,(!TC(i)||i<0)&&(r.delayTime=0),o&&"function"==typeof o.schedule||(r.scheduler=xC),r}return _createClass(n,[{key:"_subscribe",value:function(t){return this.scheduler.schedule(n.dispatch,this.delayTime,{source:this.source,subscriber:t})}}],[{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xC;return new n(t,e,r)}},{key:"dispatch",value:function(t){var e=t.source,n=t.subscriber;return this.add(e.subscribe(n))}}]),n}(E),Pdt=function(){function t(e,n){_classCallCheck(this,t),this.scheduler=e,this.delay=n}return _createClass(t,[{key:"call",value:function(t,e){return new Ddt(e,this.delay,this.scheduler).subscribe(t)}}]),t}();function Mdt(){}R6.a.registerVersion("firebase","8.0.0","app");var Fdt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC;_classCallCheck(this,t),this.zone=e,this.delegate=n}return _createClass(t,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(t,e,n){var r=this.zone;return this.delegate.schedule((function(e){var n=this;r.runGuarded((function(){t.apply(n,[e])}))}),e,n)}}]),t}(),Ldt=function(){function t(e){_classCallCheck(this,t),this.zone=e,this.task=null}return _createClass(t,[{key:"call",value:function(t,e){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run((function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",Mdt,{},Mdt,Mdt)})),e.pipe(Up({next:n,complete:n,error:n})).subscribe(t).add(n)}},{key:"unscheduleTask",value:function(){var t=this;setTimeout((function(){null!=t.task&&"scheduled"===t.task.state&&(t.task.invoke(),t.task=null)}),10)}}]),t}(),Bdt=function t(e){_classCallCheck(this,t),this.ngZone=e,this.outsideAngular=e.runOutsideAngular((function(){return new Fdt(Zone.current)})),this.insideAngular=e.run((function(){return new Fdt(Zone.current,m_)}))},jdt=new Ht("angularfire2.app.options"),Vdt=new Ht("angularfire2.app.nameOrConfig"),Udt=new Xs("6.0.4");function zdt(t,e,n){var r="object"==typeof n&&n||{};return r.name=r.name||"string"==typeof n&&n||"[DEFAULT]",R6.a.apps.filter((function(t){return t&&t.name===r.name}))[0]||e.runOutsideAngular((function(){return R6.a.initializeApp(t,r)}))}var Wdt,qdt={provide:function t(){_classCallCheck(this,t)},useFactory:zdt,deps:[jdt,xc,[new lt,Vdt]]},Hdt=((Wdt=function(){function t(e){_classCallCheck(this,t),R6.a.registerVersion("angularfire",Udt.full,e.toString()),R6.a.registerVersion("angular",$s.full)}return _createClass(t,null,[{key:"initializeApp",value:function(e,n){return{ngModule:t,providers:[{provide:jdt,useValue:e},{provide:Vdt,useValue:n}]}}}]),t}()).\u0275mod=Ce({type:Wdt}),Wdt.\u0275inj=gt({factory:function(t){return new(t||Wdt)(te(ac))},providers:[qdt]}),Wdt);function Gdt(t){var e=function(t){return new E((function(e){var n=function(t){return e.next(t)};return t.on("state_changed",n,(function(t){return e.error(t)}),(function(){n(t.snapshot),e.complete()})),function(){return t.cancel()}}))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:function(){return e},percentageChanges:function(){return e.pipe(z((function(t){return t.bytesTransferred/t.totalBytes*100})))}}}function Kdt(t,e,n){return{getDownloadURL:function(){return Yd(void 0).pipe(jC(e.outsideAngular),Op((function(){return t.getDownloadURL()})),n)},getMetadata:function(){return Yd(void 0).pipe(jC(e.outsideAngular),Op((function(){return t.getMetadata()})),n)},delete:function(){return G(t.delete())},child:function(r){return Kdt(t.child(r),e,n)},updateMetadata:function(e){return G(t.updateMetadata(e))},put:function(e,n){return Gdt(t.put(e,n))},putString:function(e,n,r){return Gdt(t.putString(e,n,r))},listAll:function(){return G(t.listAll())}}}var Xdt,$dt,Ydt,Qdt=new Ht("angularfire2.storageBucket"),Jdt=((Ydt=function(){function t(e,n,r,i,o){var a;_classCallCheck(this,t),this.schedulers=new Bdt(o),this.keepUnstableUntilFirst=(a=this.schedulers,function(t){return(t=t.lift(new Ldt(a.ngZone))).pipe(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){return n.lift(new Pdt(t,e))}}(a.outsideAngular),jC(a.insideAngular))}),this.storage=o.runOutsideAngular((function(){var t=zdt(e,o,n);return sft&&sft(R6.a),t.storage(r||void 0)}))}return _createClass(t,[{key:"ref",value:function(t){return Kdt(this.storage.ref(t),this.schedulers,this.keepUnstableUntilFirst)}},{key:"upload",value:function(t,e,n){return Kdt(this.storage.ref(t),this.schedulers,this.keepUnstableUntilFirst).put(e,n)}}]),t}()).\u0275fac=function(t){return new(t||Ydt)(te(jdt),te(Vdt,8),te(Qdt,8),te(ac),te(xc))},Ydt.\u0275prov=mt({factory:function(){return new Ydt(te(jdt),te(Vdt,8),te(Qdt,8),te(ac),te(xc))},token:Ydt,providedIn:"any"}),Ydt),Zdt=(($dt=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:$dt}),$dt.\u0275inj=gt({factory:function(t){return new(t||$dt)},providers:[Jdt]}),$dt),tpt=((Xdt=function(){function t(e){_classCallCheck(this,t),this.storage=e}return _createClass(t,[{key:"nuevo",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players",{method:"POST",headers:{"Content-Type":"application/json",Authorization:r,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({name:t.name,surname:t.surname,team_id:t.team_id,photo:t.photo})}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}},{key:"tareaCloudStorage",value:function(t,e){return this.storage.upload(t,e)}},{key:"referenciaCloudStorage",value:function(t){return this.storage.ref(t)}},{key:"downloadCloudStorage",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R6.a.storage().ref().child(t).getDownloadURL();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}},{key:"downloadCloudStorageDatos",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R6.a.storage().ref().child(t).getMetadata();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}},{key:"expulsar",value:function(t,e){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return r=n.sent,n.next=5,r.json();case 5:return i=n.sent,o=fetch("https://liga-futbol.herokuapp.com/api/v1.0/bans",{method:"POST",headers:{"Content-Type":"application/json",Authorization:i,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({date:new Date,matches:e,player_id:t.id})}),n.next=9,o;case 9:return n.next=11,n.sent.json();case 11:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))}},{key:"get",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return e=t.sent,t.next=5,e.json();case 5:return n=t.sent,r=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players",{method:"GET",headers:{Authorization:n,"Access-Control-Allow-Origin":"*"}}),t.next=9,r;case 9:return t.next=11,t.sent.json();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})))}},{key:"getPorEquipo",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/teams/"+t,{method:"GET",headers:{Authorization:r,"Access-Control-Allow-Origin":"*"}}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}},{key:"eliminar",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://liga-futbol.herokuapp.com/api/v1.0/auth/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:"santidalmassoj@gmail.com",password:"santi123"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=fetch("https://liga-futbol.herokuapp.com/api/v1.0/players/"+t,{method:"DELETE",headers:{Authorization:r,"Access-Control-Allow-Origin":"*"}}),e.next=9,i;case 9:return e.next=11,e.sent.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}}]),t}()).\u0275fac=function(t){return new(t||Xdt)(te(Jdt))},Xdt.\u0275prov=mt({token:Xdt,factory:Xdt.\u0275fac,providedIn:"root"}),Xdt);function ept(t,e){1&t&&(Ta(0,"div",2),Ra(1,"mat-spinner"),Aa())}function npt(t,e){if(1&t){var n=Pa();Ta(0,"div",10),Ta(1,"button",14),La("click",(function(){return tn(n),za(),xa(5).click()})),ps(2,"Subir foto del equipo"),Aa(),Aa()}}function rpt(t,e){if(1&t){var n=Pa();Ta(0,"div",10),Ta(1,"button",15),La("click",(function(){return tn(n),za(),xa(5).click()})),ps(2,"Subir foto del equipo"),Aa(),Aa()}}function ipt(t,e){if(1&t&&(Ta(0,"mat-option",16),ps(1),Aa()),2&t){var n=e.$implicit;Sa("value",n),di(1),vs(n.name)}}function opt(t,e){if(1&t){var n=Pa();Ta(0,"div"),Ta(1,"div",5),Ta(2,"h2"),ps(3,"Comprobar jugadores sancionados"),Aa(),Ta(4,"input",6,7),La("change",(function(t){return tn(n),za(2).leerFoto(t.target.files[0])})),Aa(),Aa(),Ta(6,"div",8),wa(7,npt,3,0,"div",9),wa(8,rpt,3,0,"div",9),Ta(9,"div",10),Ta(10,"mat-form-field",11),Ta(11,"mat-select",12),La("ngModelChange",(function(t){return tn(n),za(2).equipoSeleccionado=t})),wa(12,ipt,2,2,"mat-option",13),Aa(),Aa(),Aa(),Aa(),Aa()}if(2&t){var r=za(2);di(7),Sa("ngIf",null!=r.equipoSeleccionado),di(1),Sa("ngIf",null==r.equipoSeleccionado),di(3),Sa("ngModel",r.equipoSeleccionado),di(1),Sa("ngForOf",r.listaEquipos)}}function apt(t,e){1&t&&(Ta(0,"div",23),ps(1," Ajustando tama\xf1o de imagen seleccionada. "),Aa())}function spt(t,e){if(1&t&&(Ta(0,"div",23),ps(1),Aa()),2&t){var n=za(3);di(1),gs(" Descargando jugadores de base de datos ",n.jugadoresDescargados," / ",n.totalJugadoresADescargar," ")}}function upt(t,e){1&t&&(Ta(0,"div",23),ps(1," Cargando imagen seleccionada "),Aa())}function cpt(t,e){if(1&t&&(Ta(0,"div",23),ps(1),Aa()),2&t){var n=za(3);di(1),gs(" Comparando caras con base de datos ",n.carasProcesadas," / ",n.cantidadCarasDetectadas," ")}}function lpt(t,e){1&t&&(Ta(0,"div",23),ps(1," Proceso terminado "),Aa())}function hpt(t,e){if(1&t&&(Ta(0,"div"),Ta(1,"div",17),wa(2,apt,2,0,"div",18),wa(3,spt,2,2,"div",18),wa(4,upt,2,0,"div",18),wa(5,cpt,2,2,"div",18),wa(6,lpt,2,0,"div",18),Ta(7,"div"),Ra(8,"mat-progress-spinner",19),Aa(),Ta(9,"div",20),Ra(10,"div",21),Aa(),Ta(11,"div",22),Ta(12,"mat-card"),ps(13,"Recuadro verde: Jugador habilitado - Recuadro rojo: Jugador no habilitado - Recuadro azul: Jugador no registrado en base de datos. "),Aa(),Aa(),Aa(),Aa()),2&t){var n=za(2);di(2),Sa("ngIf",0==n.progreso),di(1),Sa("ngIf",n.progreso>0&&n.progreso<39),di(1),Sa("ngIf",39==n.progreso),di(1),Sa("ngIf",n.progreso>=40&&n.progreso<100),di(1),Sa("ngIf",100===n.progreso),di(2),Sa("value",n.progreso)}}function fpt(t,e){if(1&t&&(Ta(0,"div",3),wa(1,opt,13,4,"div",4),wa(2,hpt,14,6,"div",4),Aa()),2&t){var n=za();di(1),Sa("ngIf",!n.loader),di(1),Sa("ngIf",n.loader)}}var dpt,ppt=((dpt=function(){function t(e,n){_classCallCheck(this,t),this.equiposService=e,this.jugadorService=n,this.listaEquipos=[],this.cargaPendientes=!0,this.jugadoresDetectados=[],this.loader=!1,this.cantidadCarasDetectadas=0,this.carasProcesadas=0,this.progreso=0,this.listaPintados=[],this.listaFotosBaseDatos=[],this.jugadoresDescargados=0,this.totalJugadoresADescargar=0}return _createClass(t,[{key:"leerFoto",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.progreso=0,window.matchMedia("(min-width: 600px)").matches?(n=900,r=600):(n=600,r=300),this.loader=!0,this.resizeImage(t,n,r).then((function(t){return Object(EP.b)(i,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,o,a,s,u,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jugadorService.getPorEquipo(this.equipoSeleccionado.id);case 2:n=e.sent,this.progreso=1,this.totalJugadoresADescargar=n.length,r=38/this.totalJugadoresADescargar,i=0;case 6:if(!(i<n.length)){e.next=22;break}if(void 0===(o=n[i]).photo){e.next=19;break}return e.next=11,this.jugadorService.downloadCloudStorage(o.photo);case 11:return a=e.sent,e.next=14,fetch(a);case 14:return s=e.sent,e.next=17,s.blob();case 17:u=e.sent,this.listaFotosBaseDatos.push({jugador:o,foto:u}),this.jugadoresDescargados=this.jugadoresDescargados+1,this.progreso=this.progreso+r;case 19:i++,e.next=6;break;case 22:Promise.all([b6.ssdMobilenetv1.loadFromUri("assets/weights"),b6.faceRecognitionNet.loadFromUri("assets/weights"),b6.faceLandmark68Net.loadFromUri("assets/weights")]).then((function(e){return Object(EP.b)(c,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.progreso=39,(n=document.getElementById("imagenpintada")).style.position="relative",e.next=5,D4(t);case 5:return r=e.sent,n.append(r),i=F4(r),document.getElementById("caras").append(i),o={width:r.width,height:r.height},function(t,e,n){void 0===n&&(n=!1);var r=n?P4(e):e,i=r.height;t.width=r.width,t.height=i}(i,o),e.next=13,I6(r).withFaceLandmarks().withFaceDescriptors();case 13:a=e.sent,this.cantidadCarasDetectadas=a.length,this.carasProcesadas=0,this.progreso=40,s=60/this.cantidadCarasDetectadas,u=function t(e,n){var r=new H3(n.width,n.height),i=r.width,o=r.height;if(i<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:i,height:o}));if(Array.isArray(e))return e.map((function(e){return t(e,{width:i,height:o})}));if(k5(e)){var a=e.detection.forSize(i,o),s=e.unshiftedLandmarks.forSize(a.box.width,a.box.height);return E5(a5(e,a),s)}return o5(e)?a5(e,e.detection.forSize(i,o)):e instanceof x5||e instanceof i5?e.forSize(i,o):e}(a,o),c=0;case 17:if(!(c<a.length)){e.next=48;break}l=a[c],h=0;case 20:if(!(h<this.listaFotosBaseDatos.length)){e.next=44;break}return f=this.listaFotosBaseDatos[h],e.next=24,D4(f.foto);case 24:return d=e.sent,e.next=27,I6(d).withFaceLandmarks().withFaceDescriptors();case 27:if(p=e.sent,!((v=T6(l.descriptor,p[0].descriptor))<.5)){e.next=40;break}this.jugadoresDetectados.push(f),console.log("Es la misma persona"),m=0;case 32:if(!(m<u.length)){e.next=40;break}if(g=u[m],l.descriptor!==g.descriptor){e.next=37;break}return this.listaPintados.push(g.descriptor),null===f.jugador.ban?new A6.DrawBox(g.detection.box,{label:f.jugador.name+" "+f.jugador.surname,boxColor:"green"}).draw(i):new A6.DrawBox(g.detection.box,{label:f.jugador.name+" "+f.jugador.surname,boxColor:"red"}).draw(i),e.abrupt("break",40);case 37:m++,e.next=32;break;case 40:v>=.5&&console.log("No es la misma persona");case 41:h++,e.next=20;break;case 44:this.progreso=this.progreso+s,this.carasProcesadas=this.carasProcesadas+1;case 45:c++,e.next=17;break;case 48:for(y=0;y<u.length;y++){for(b=u[y],_=!1,w=0;w<this.listaPintados.length;w++)this.listaPintados[w]===b.descriptor&&(_=!0);_||new A6.DrawBox(b.detection.box,{label:"Jugador no registrado",boxColor:"blue"}).draw(i)}this.progreso=100,console.log(this.jugadoresDetectados);case 50:case"end":return e.stop()}}),e,this)})))}));case 23:case"end":return e.stop()}}),e,this)})))}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"resizeImage",value:function(t,e,n){return new Promise((function(r,i){var o=new Image;o.src=URL.createObjectURL(t),o.onload=function(){var i,a,s=o.width,u=o.height;s<=e&&u<=n&&r(t),s>u?(a=u*(e/s),i=e):(i=s*(n/u),a=n);var c=document.createElement("canvas");c.width=i,c.height=a,c.getContext("2d").drawImage(o,0,0,i,a),c.toBlob(r,t.type)},o.onerror=i}))}},{key:"cargarTabla",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.equiposService.get();case 2:this.listaEquipos=t.sent,console.log(this.listaEquipos),this.cargaPendientes=!1;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){this.cargarTabla()}}]),t}()).\u0275fac=function(t){return new(t||dpt)(Ca(FP),Ca(tpt))},dpt.\u0275cmp=be({type:dpt,selectors:[["app-comprobar-sancionados"]],decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenedor",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenedor"],[4,"ngIf"],[1,"titulo"],["type","file","id","file","accept",".jpg, .jpeg",1,"invisible",3,"change"],["fileInput",""],[1,"inner-container"],["class","container-item",4,"ngIf"],[1,"container-item"],["appearance","fill",1,"select"],["placeholder","Seleccionar equipo",3,"ngModel","ngModelChange"],["value","null",3,"value",4,"ngFor","ngForOf"],["type","button","color","primary","mat-raised-button","",3,"click"],["type","button","color","primary","disabled","","mat-raised-button","",3,"click"],["value","null",3,"value"],["fxLayoutAlign","center center","fxFill","","fxLayout","column","fxLayoutGap","20px"],["class","descripcionProgreso",4,"ngIf"],["mode","determinate",3,"value"],["id","imagenpintada",1,"imagen"],["id","caras",1,"canvas"],[1,"aviso"],[1,"descripcionProgreso"]],template:function(t,e){1&t&&(wa(0,ept,2,0,"div",0),wa(1,fpt,3,2,"div",1)),2&t&&(Sa("ngIf",e.cargaPendientes),di(1),Sa("ngIf",!e.cargaPendientes))},directives:[Ll,hP,oP,uR,VE,lS,ff,Ad,Ml,hC,Px,RD,LD,sR,YA],styles:[".canvas[_ngcontent-%COMP%]{z-index:100;color:red}.canvas[_ngcontent-%COMP%], canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.contenedor[_ngcontent-%COMP%]{padding-top:100px}.inner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.container-item[_ngcontent-%COMP%]{padding:0 30px}.select[_ngcontent-%COMP%]{margin-top:1.34375em}.titulo[_ngcontent-%COMP%]{align-content:center;font-family:Roboto,sans-serif}.importar[_ngcontent-%COMP%], .titulo[_ngcontent-%COMP%]{text-align:center}.descripcionProgreso[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.invisible[_ngcontent-%COMP%]{opacity:0}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:50px}.titulosfilas[_ngcontent-%COMP%]{text-align:center;font-size:14px}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.button-row[_ngcontent-%COMP%]{text-align:center;padding-top:50px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important}.botonModelo[_ngcontent-%COMP%]{text-align:center;margin-top:5%}@media only screen and (min-width:600px){.aviso[_ngcontent-%COMP%]{bottom:20px;position:absolute;left:28%;font-weight:500;font-size:16px;width:50%}}@media only screen and (max-width:600px){.aviso[_ngcontent-%COMP%]{bottom:20px;position:absolute;font-weight:500;font-size:14px;width:90%}}"]}),dpt);function vpt(t,e){1&t&&(Ta(0,"th",18),ps(1," Nombre "),Aa())}function mpt(t,e){if(1&t&&(Ta(0,"td",19),ps(1),Aa()),2&t){var n=e.$implicit;di(1),gs(" ",n.name," ",n.surname," ")}}function gpt(t,e){1&t&&(Ta(0,"th",18),ps(1," Fecha de sanci\xf3n "),Aa())}function ypt(t,e){if(1&t&&(Ta(0,"td",19),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.ban.date," ")}}function bpt(t,e){1&t&&(Ta(0,"th",18),ps(1," Partidos restantes "),Aa())}function _pt(t,e){if(1&t&&(Ta(0,"td",19),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.ban.matches," ")}}function wpt(t,e){1&t&&(Ta(0,"th",20),ps(1,"Acciones"),Aa())}function xpt(t,e){if(1&t){var n=Pa();Ta(0,"td",21),Ta(1,"button",22),La("click",(function(){tn(n);var t=e.$implicit;return za().verJugadores(t)})),Ta(2,"mat-icon"),ps(3," info "),Aa(),Aa(),Aa()}}function Cpt(t,e){1&t&&Ra(0,"tr",23)}function kpt(t,e){1&t&&Ra(0,"tr",24)}var Ept,Spt,Ipt,Tpt=function(){return[10,20,50]},Apt=((Ipt=function(){function t(e,n,r){_classCallCheck(this,t),this.dialog=e,this.router=n,this.jugadoresService=r,this.cargaPendientes=!0,this.displayedColumns=["nombre","fecha-sancion","partidosRestantes","acciones"],this.dataSource=new LO,this.verificarAcceso=!0,this.enBlanco=!1}return _createClass(t,[{key:"setDataSourceAttributes",value:function(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}},{key:"applyFilter",value:function(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}},{key:"determinarCantidadItem",value:function(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}},{key:"verJugadores",value:function(t){}},{key:"eliminar",value:function(t){}},{key:"nuevo",value:function(){}},{key:"cargarTabla",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.jugadoresService.get();case 2:e=t.sent,this.dataSource.data=e.filter((function(t,e,n){return null!==t.ban})),console.log(e),this.cargaPendientes=!1;case 4:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){this.cargarTabla()}},{key:"matSort",set:function(t){this.sort=t,this.setDataSourceAttributes()}},{key:"matPaginator",set:function(t){this.paginator=t,this.setDataSourceAttributes()}}]),t}()).\u0275fac=function(t){return new(t||Ipt)(Ca(zT),Ca(fg),Ca(tpt))},Ipt.\u0275cmp=be({type:Ipt,selectors:[["app-sancionados-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(mT,!0),Hu(GS,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:28,vars:6,consts:[[1,"contenido"],[1,"titulo"],[1,"filtro"],["matInput","",3,"keyup"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","fecha-sancion"],["matColumnDef","partidosRestantes"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Informe",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(Ta(0,"div",0),Ra(1,"br"),Ta(2,"div",1),Ta(3,"h2"),ps(4,"Jugadores sancionados"),Aa(),Aa(),Ta(5,"div",2),Ta(6,"mat-form-field"),Ta(7,"mat-label"),ps(8,"Filtro"),Aa(),Ta(9,"input",3),La("keyup",(function(t){return e.applyFilter(t)})),Aa(),Aa(),Aa(),Ta(10,"div",4),Ta(11,"table",5,6),Oa(13,7),wa(14,vpt,2,0,"th",8),wa(15,mpt,2,2,"td",9),Na(),Oa(16,10),wa(17,gpt,2,0,"th",8),wa(18,ypt,2,1,"td",9),Na(),Oa(19,11),wa(20,bpt,2,0,"th",8),wa(21,_pt,2,1,"td",9),Na(),Oa(22,12),wa(23,wpt,2,0,"th",13),wa(24,xpt,4,0,"td",14),Na(),wa(25,Cpt,1,0,"tr",15),wa(26,kpt,1,0,"tr",16),Aa(),Ra(27,"mat-paginator",17),Aa(),Aa()),2&t&&(di(11),Sa("dataSource",e.dataSource),di(14),Sa("matHeaderRowDef",e.displayedColumns),di(1),Sa("matRowDefColumns",e.displayedColumns),di(1),Sa("pageSizeOptions",Au(5,Tpt))("pageSize",e.itemPorPagina))},directives:[VE,NE,vA,yO,mT,kO,xO,_O,TO,RO,GS,SO,CT,IO,hC,AS,eT,NO,PO],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),Ipt),Rpt=((Spt=function(){function t(e,n){_classCallCheck(this,t),this.data=e,this.jugadorService=n,this.cargandoDatos=!0,this.jugador=JSON.parse(e)}return _createClass(t,[{key:"descargarImagen",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.jugador.photo,t.next=3,this.jugadorService.downloadCloudStorage(e);case 3:this.rutaDescarga=t.sent,this.cargandoDatos=!1;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){this.descargarImagen()}}]),t}()).\u0275fac=function(t){return new(t||Spt)(Ca(BT),Ca(tpt))},Spt.\u0275cmp=be({type:Spt,selectors:[["app-ver-imagen"]],decls:2,vars:1,consts:[["alt","","width","600","height","600",3,"src"]],template:function(t,e){1&t&&(Ta(0,"div"),Ra(1,"img",0),Aa()),2&t&&(di(1),Ga("src",e.rutaDescarga,Qr))},styles:[""]}),Spt),Opt=((Ept=function(){function t(){_classCallCheck(this,t),this.fechas=0}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Ept)},Ept.\u0275cmp=be({type:Ept,selectors:[["app-expulsar-jugador"]],decls:12,vars:4,consts:[["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["type","number","matInput","","placeholder","Cantidad de fechas",1,"texto",3,"ngModel","ngModelChange"],["nombre",""],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","mat-dialog-close"],["mat-raised-button","","color","warn",3,"mat-dialog-close"]],template:function(t,e){1&t&&(Ta(0,"div",0),Ta(1,"mat-form-field",1),Ta(2,"input",2,3),La("ngModelChange",(function(t){return e.fechas=t})),Aa(),Aa(),Aa(),Ta(4,"div",4),Ta(5,"button",5),Ta(6,"mat-icon"),ps(7,"save"),Aa(),Aa(),ps(8," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),Ta(9,"a",6),Ta(10,"mat-icon"),ps(11,"cancel"),Aa(),Aa(),Aa()),2&t&&(di(2),Sa("ngModel",e.fechas),di(3),Sa("disabled",e.fechas-0<=0)("mat-dialog-close",e.fechas),di(4),Sa("mat-dialog-close",-5))},directives:[RD,LD,VE,Of,vA,nf,ff,Ad,hC,qT,eT,fC],styles:[""]}),Ept);function Npt(t,e){1&t&&(Ta(0,"div",2),Ra(1,"mat-spinner"),Aa())}function Dpt(t,e){1&t&&(Ta(0,"th",25),ps(1," Nombre "),Aa())}function Ppt(t,e){if(1&t&&(Ta(0,"td",26),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.name," ")}}function Mpt(t,e){1&t&&(Ta(0,"th",25),ps(1," Apellido "),Aa())}function Fpt(t,e){if(1&t&&(Ta(0,"td",26),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.surname," ")}}function Lpt(t,e){1&t&&(Ta(0,"th",25),ps(1," Foto "),Aa())}function Bpt(t,e){if(1&t){var n=Pa();Ta(0,"td",26),Ta(1,"button",27),La("click",(function(){tn(n);var t=e.$implicit;return za(2).verFoto(t)})),Ta(2,"mat-icon"),ps(3,"account_box "),Aa(),Aa(),Aa()}}function jpt(t,e){1&t&&(Ta(0,"th",25),ps(1," Inhabilitado "),Aa())}function Vpt(t,e){if(1&t&&(Ta(0,"td",26),ps(1),Aa()),2&t){var n=e.$implicit,r=za(2);di(1),ms(" ",r.comprobarHabilitacion(n)," ")}}function Upt(t,e){1&t&&(Ta(0,"th",25),ps(1," Desde "),Aa())}function zpt(t,e){if(1&t&&(Ta(0,"td",26),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.desde," ")}}function Wpt(t,e){1&t&&(Ta(0,"th",25),ps(1," Partidos por cumplir "),Aa())}function qpt(t,e){if(1&t&&(Ta(0,"td",26),ps(1),Aa()),2&t){var n=e.$implicit;di(1),ms(" ",n.partidosCumplir," ")}}function Hpt(t,e){1&t&&(Ta(0,"th",28),ps(1,"Acciones"),Aa())}function Gpt(t,e){if(1&t){var n=Pa();Ta(0,"button",33),La("click",(function(){tn(n);var t=za().$implicit;return za(2).expulsar(t)})),Ta(1,"mat-icon"),ps(2,"clear"),Aa(),Aa()}}function Kpt(t,e){if(1&t){var n=Pa();Ta(0,"td",29),Ta(1,"button",30),La("click",(function(){tn(n);var t=e.$implicit;return za(2).editar(t)})),Ta(2,"mat-icon"),ps(3,"create"),Aa(),Aa(),wa(4,Gpt,3,0,"button",31),Ta(5,"button",32),La("click",(function(){tn(n);var t=e.$implicit;return za(2).eliminar(t)})),Ta(6,"mat-icon"),ps(7,"delete_forever"),Aa(),Aa(),Aa()}if(2&t){var r=e.$implicit;di(4),Sa("ngIf",null===r.ban)}}function Xpt(t,e){1&t&&Ra(0,"tr",34)}function $pt(t,e){1&t&&Ra(0,"tr",35)}var Ypt=function(){return[10,20,50]};function Qpt(t,e){if(1&t){var n=Pa();Ta(0,"div",3),Ra(1,"br"),Ta(2,"div",4),Ta(3,"h2"),ps(4),Aa(),Aa(),Ta(5,"mat-grid-list",5),Ta(6,"mat-grid-tile"),Ta(7,"mat-form-field"),Ta(8,"mat-label"),ps(9,"Filtro"),Aa(),Ta(10,"input",6),La("keyup",(function(t){return tn(n),za().applyFilter(t)})),Aa(),Aa(),Aa(),Ta(11,"mat-grid-tile"),Ta(12,"button",7),La("click",(function(){return tn(n),za().nuevo()})),ps(13," Agregar nuevo jugador "),Aa(),Aa(),Aa(),Ta(14,"div",8),Ta(15,"table",9,10),Oa(17,11),wa(18,Dpt,2,0,"th",12),wa(19,Ppt,2,1,"td",13),Na(),Oa(20,14),wa(21,Mpt,2,0,"th",12),wa(22,Fpt,2,1,"td",13),Na(),Oa(23,15),wa(24,Lpt,2,0,"th",12),wa(25,Bpt,4,0,"td",13),Na(),Oa(26,16),wa(27,jpt,2,0,"th",12),wa(28,Vpt,2,1,"td",13),Na(),Oa(29,17),wa(30,Upt,2,0,"th",12),wa(31,zpt,2,1,"td",13),Na(),Oa(32,18),wa(33,Wpt,2,0,"th",12),wa(34,qpt,2,1,"td",13),Na(),Oa(35,19),wa(36,Hpt,2,0,"th",20),wa(37,Kpt,8,1,"td",21),Na(),wa(38,Xpt,1,0,"tr",22),wa(39,$pt,1,0,"tr",23),Aa(),Ra(40,"mat-paginator",24),Aa(),Aa()}if(2&t){var r=za();di(4),ms("Jugadores de ",r.nombreEquipo,""),di(11),Sa("dataSource",r.dataSource),di(23),Sa("matHeaderRowDef",r.displayedColumns),di(1),Sa("matRowDefColumns",r.displayedColumns),di(1),Sa("pageSizeOptions",Au(6,Ypt))("pageSize",r.itemPorPagina)}}var Jpt,Zpt=((Jpt=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.dialog=e,this.router=n,this.route=r,this.equiposService=i,this.jugadoresServices=o,this.cargaPendientes=!0,this.displayedColumns=["nombre","apellido","foto","inhabilitado","desde","partidosCumplir","acciones"],this.dataSource=new LO,this.tablaEquipos=[{nombre:"Lucas Pratto",inhabilitado:!1,desde:"-",partidosCumplir:"-"},{nombre:"Juan Fernando Quintero",inhabilitado:!0,desde:"18/08/2020",partidosCumplir:"2"},{nombre:"Gonzalo Martinez",inhabilitado:!1,desde:"-",partidosCumplir:"-"}],this.verificarAcceso=!0,this.enBlanco=!1}return _createClass(t,[{key:"setDataSourceAttributes",value:function(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}},{key:"applyFilter",value:function(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}},{key:"comprobarHabilitacion",value:function(t){return null!==t.ban?(t.desde=t.ban.date,t.partidosCumplir=t.ban.matches,"Si"):(t.desde="-",t.partidosCumplir="-","No")}},{key:"determinarCantidadItem",value:function(t){localStorage.setItem("paginador",JSON.stringify(t.pageSize))}},{key:"eliminar",value:function(t){var e=this;this.dialog.open(PP).afterClosed().subscribe((function(n){return Object(EP.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=5;break}return e.next=4,this.jugadoresServices.eliminar(t.id);case 4:location.reload();case 5:case"end":return e.stop()}}),e,this)})))}))}},{key:"editar",value:function(t){}},{key:"nuevo",value:function(){this.router.navigate(["main/jugadores-crear/"+this.nombreEquipo])}},{key:"cargarTabla",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.jugadoresServices.getPorEquipo(+this.idEquipo);case 2:this.dataSource.data=t.sent,console.log(this.dataSource.data),this.cargaPendientes=!1;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"expulsar",value:function(t){var e=this;this.dialog.open(Opt).afterClosed().subscribe((function(n){return Object(EP.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n>0,!e.t0){e.next=6;break}return this.cargaPendientes=!0,e.next=5,this.jugadoresServices.expulsar(t,n);case 5:this.cargarTabla();case 6:case"end":return e.stop()}}),e,this)})))}))}},{key:"verFoto",value:function(t){this.dialog.open(Rpt,{data:JSON.stringify(t)})}},{key:"traerNombreEquipo",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.equiposService.get();case 2:for(e=t.sent,n=0;n<e.length;n++)(r=e[n]).id===+this.idEquipo&&(this.nombreEquipo=r.name);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){var t=this;this.route.params.forEach((function(e){t.idEquipo=e.equipo})),this.traerNombreEquipo(),this.cargarTabla()}},{key:"matSort",set:function(t){this.sort=t,this.setDataSourceAttributes()}},{key:"matPaginator",set:function(t){this.paginator=t,this.setDataSourceAttributes()}}]),t}()).\u0275fac=function(t){return new(t||Jpt)(Ca(zT),Ca(fg),Ca(em),Ca(FP),Ca(tpt))},Jpt.\u0275cmp=be({type:Jpt,selectors:[["app-jugadores-tabla"]],viewQuery:function(t,e){var n;1&t&&(Hu(mT,!0),Hu(GS,!0)),2&t&&(Wu(n=Yu())&&(e.matSort=n.first),Wu(n=Yu())&&(e.matPaginator=n.first))},decls:2,vars:2,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["cols","2","rowHeight","100px"],["matInput","",3,"keyup"],["mat-raised-button","","color","primary",3,"click"],[1,"example-container","mat-elevation-z8"],["mat-table","","matSort","",1,"tabla",3,"dataSource"],["table",""],["matColumnDef","nombre"],["mat-header-cell","","class","titulosfilas","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","title-col",4,"matCellDef"],["matColumnDef","apellido"],["matColumnDef","foto"],["matColumnDef","inhabilitado"],["matColumnDef","desde"],["matColumnDef","partidosCumplir"],["matColumnDef","acciones",1,"columnaboton"],["mat-header-cell","","class","titulosfilas-ce",4,"matHeaderCellDef"],["mat-cell","","class","title-col-ce",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header","",1,"titulosfilas"],["mat-cell","",1,"title-col"],["mat-button","","color","accent","matTooltip","Foto jugador",3,"click"],["mat-header-cell","",1,"titulosfilas-ce"],["mat-cell","",1,"title-col-ce"],["mat-button","","color","accent","matTooltip","Editar",3,"click"],["mat-button","","color","warn","matTooltip","Expulsar",3,"click",4,"ngIf"],["mat-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-button","","color","warn","matTooltip","Expulsar",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(wa(0,Npt,2,0,"div",0),wa(1,Qpt,41,7,"div",1)),2&t&&(Sa("ngIf",e.cargaPendientes),di(1),Sa("ngIf",!e.cargaPendientes))},directives:[Ll,hP,oP,uR,iC,zx,VE,NE,vA,hC,yO,mT,kO,xO,_O,TO,RO,GS,SO,CT,IO,AS,eT,NO,PO],styles:[".contenido[_ngcontent-%COMP%]{padding-top:65px}.tabla[_ngcontent-%COMP%]{width:100%}.filtro[_ngcontent-%COMP%]{margin-left:12%}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:87%;margin-left:8%;margin-right:9%;overflow:auto;text-align:center;position:relative;margin-bottom:86px}.titulosfilas[_ngcontent-%COMP%]{text-align:left;font-size:14px}.title-col[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:left}.titulosfilas-ce[_ngcontent-%COMP%]{text-align:center;font-size:14px}.title-col-ce[_ngcontent-%COMP%]{flex:0 0 100px!important;white-space:unset!important;text-align:center}.button-row[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem}@media(min-width:1024px){.button-row[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem}}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}"]}),Jpt);function tvt(t,e){1&t&&(Ta(0,"span"),ps(1,"Por favor ingrese un nombre"),Aa())}var evt,nvt=((evt=function(){function t(e,n,r,i){_classCallCheck(this,t),this.router=e,this.formBuilder=n,this.equiposService=r,this.dialog=i}return _createClass(t,[{key:"cancel",value:function(){this.router.navigate(["main/equipos-tabla"])}},{key:"nuevo",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.equiposService.nuevo(t);case 2:this.router.navigate(["main/equipos-tabla"]);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.equiposForm=this.formBuilder.group({nombre:[null,yf.required]});case 1:case"end":return t.stop()}}),t,this)})))}}]),t}()).\u0275fac=function(t){return new(t||evt)(Ca(fg),Ca(Kd),Ca(FP),Ca(zT))},evt.\u0275cmp=be({type:evt,selectors:[["app-equipos-crear"]],decls:19,vars:3,consts:[[3,"formGroup"],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto"],["nombre",""],[4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){if(1&t){var n=Pa();Ta(0,"form",0),Ta(1,"div",1),Ta(2,"div",2),Ta(3,"h2"),ps(4,"Crear equipo"),Aa(),Aa(),Ta(5,"div",3),Ta(6,"mat-form-field",4),Ra(7,"input",5,6),Ta(9,"mat-error"),wa(10,tvt,2,0,"span",7),Aa(),Aa(),Aa(),Ta(11,"div",8),Ta(12,"button",9),La("click",(function(){tn(n);var t=xa(8);return e.nuevo(t.value)})),Ta(13,"mat-icon"),ps(14,"save"),Aa(),Aa(),ps(15," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),Ta(16,"a",10),La("click",(function(){return e.cancel()})),Ta(17,"mat-icon"),ps(18,"cancel"),Aa(),Aa(),Aa(),Aa(),Aa()}2&t&&(Sa("formGroup",e.equiposForm),di(10),Sa("ngIf",!e.equiposForm.get("nombre").valid&&e.equiposForm.get("nombre").touched),di(2),Sa("disabled",!e.equiposForm.valid))},directives:[Rd,df,Dd,RD,LD,VE,vA,nf,ff,Hd,bE,Ll,hC,eT,fC],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.button-row[_ngcontent-%COMP%]{margin:10px 0}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),evt);function rvt(t,e){1&t&&(Ta(0,"div",3),Ra(1,"mat-spinner"),Aa())}function ivt(t,e){1&t&&(Ta(0,"span"),ps(1,"Por favor ingrese un nombre"),Aa())}function ovt(t,e){1&t&&(Ta(0,"span"),ps(1,"Por favor ingrese un apellido"),Aa())}function avt(t,e){if(1&t){var n=Pa();Ta(0,"div",17),Ta(1,"input",18,19),La("change",(function(t){return tn(n),za(2).subirFoto(t)})),Aa(),Ta(3,"div",20),Ta(4,"div"),Ta(5,"button",21),La("click",(function(){tn(n);var t=xa(2);return za(2).abrirExplorador(t)})),ps(6,"Seleccionar imagen"),Aa(),Aa(),Aa(),Aa()}}function svt(t,e){1&t&&(Ta(0,"div",17),ps(1," Foto subida con \xe9xito. "),Aa())}function uvt(t,e){if(1&t){var n=Pa();Ta(0,"div",4),Ta(1,"div",5),Ta(2,"h2"),ps(3),Aa(),Aa(),Ta(4,"div",6),Ta(5,"mat-form-field",7),Ra(6,"input",8,9),Ta(8,"mat-error"),wa(9,ivt,2,0,"span",10),Aa(),Aa(),Ta(10,"mat-form-field",7),Ra(11,"input",11,12),Ta(13,"mat-error"),wa(14,ovt,2,0,"span",10),Aa(),Aa(),wa(15,avt,7,0,"div",13),wa(16,svt,2,0,"div",13),Aa(),Ta(17,"div",14),Ta(18,"button",15),La("click",(function(){tn(n);var t=xa(7),e=xa(12);return za().nuevo(t.value,e.value)})),Ta(19,"mat-icon"),ps(20,"save"),Aa(),Aa(),ps(21," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),Ta(22,"a",16),La("click",(function(){return tn(n),za().cancel()})),Ta(23,"mat-icon"),ps(24,"cancel"),Aa(),Aa(),Aa(),Aa()}if(2&t){var r=za();di(3),ms("Crear jugador de ",r.nombreEquipo,""),di(6),Sa("ngIf",!r.jugadoresForm.get("nombre").valid&&r.jugadoresForm.get("nombre").touched),di(5),Sa("ngIf",!r.jugadoresForm.get("apellido").valid&&r.jugadoresForm.get("apellido").touched),di(1),Sa("ngIf",!r.fotoSubida),di(1),Sa("ngIf",r.fotoSubida),di(2),Sa("disabled",!r.jugadoresForm.valid||!r.fotoSubida)}}var cvt,lvt=((cvt=function(){function t(e,n,r,i,o,a){_classCallCheck(this,t),this.router=e,this.formBuilder=n,this.jugadoresService=r,this.dialog=i,this.route=o,this.equiposService=a,this.cantidad=0,this.fechaDesde=new Date,this.sancionado="2",this.cargaPendientes=!0,this.fotoSubida=!1}return _createClass(t,[{key:"cancel",value:function(){this.router.navigate(["main/jugadores-tabla/"+this.nombreEquipo])}},{key:"nuevo",value:function(t,e){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r={}).name=t,r.surname=e,r.status="unbanned",r.team_id=this.idEquipo,r.photo=this.rutaArchivo,n.next=8,this.jugadoresService.nuevo(r);case 8:this.router.navigate(["main/jugadores-tabla/"+this.idEquipo]);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"cargarIdEquipo",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.equiposService.get();case 2:for(e=t.sent,n=0;n<e.length;n++)(r=e[n]).name===this.nombreEquipo&&(this.idEquipo=r.id);this.cargaPendientes=!1,console.log(this.idEquipo);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"abrirExplorador",value:function(t){t.click()}},{key:"subirFoto",value:function(t){for(var e=0;e<t.target.files.length;e++){var n=new FormData;this.nombreArchivo=t.target.files[e].name,n.delete("archivo"),n.append("archivo",t.target.files[e],t.target.files[e].name);var r=n.get("archivo");this.rutaArchivo="imagenes/"+this.idEquipo+"/"+this.nombreArchivo,this.jugadoresService.referenciaCloudStorage(this.rutaArchivo),this.jugadoresService.tareaCloudStorage(this.rutaArchivo,r).percentageChanges().subscribe((function(t){Math.round(t)})),this.fotoSubida=!0}}},{key:"ngOnInit",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.jugadoresForm=this.formBuilder.group({nombre:[null,yf.required],apellido:[null,yf.required]}),this.route.params.forEach((function(t){e.nombreEquipo=t.equipo})),this.cargarIdEquipo();case 1:case"end":return t.stop()}}),t,this)})))}}]),t}()).\u0275fac=function(t){return new(t||cvt)(Ca(fg),Ca(Kd),Ca(tpt),Ca(zT),Ca(em),Ca(FP))},cvt.\u0275cmp=be({type:cvt,selectors:[["app-jugadores-crear"]],decls:3,vars:3,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],[3,"formGroup"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto"],["nombre",""],[4,"ngIf"],["matInput","","placeholder","Apellido","formControlName","apellido",1,"texto"],["apellido",""],["class","botonFoto",4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"],[1,"botonFoto"],["type","file","id","file",1,"invisible",3,"change"],["fileInput",""],["fxLayoutGap","20px",1,"importar"],["type","button","color","primary","mat-raised-button","",3,"click"]],template:function(t,e){1&t&&(wa(0,rvt,2,0,"div",0),Ta(1,"form",1),wa(2,uvt,25,6,"div",2),Aa()),2&t&&(Sa("ngIf",e.cargaPendientes),di(1),Sa("formGroup",e.jugadoresForm),di(1),Sa("ngIf",!e.cargaPendientes))},directives:[Ll,Rd,df,Dd,hP,oP,uR,RD,LD,VE,vA,nf,ff,Hd,bE,hC,eT,fC],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.botonFoto[_ngcontent-%COMP%]{text-align:center}.button-row[_ngcontent-%COMP%]{margin:10px 0}.invisible[_ngcontent-%COMP%]{opacity:0;top:2px;position:absolute}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),cvt);function hvt(t,e){1&t&&(Ta(0,"div",3),Ra(1,"mat-spinner"),Aa())}function fvt(t,e){1&t&&(Ta(0,"span"),ps(1,"Por favor ingrese un nombre"),Aa())}function dvt(t,e){if(1&t){var n=Pa();Ta(0,"div",4),Ta(1,"div",5),Ta(2,"h2"),ps(3,"Editar equipo"),Aa(),Aa(),Ta(4,"div",6),Ta(5,"mat-form-field",7),Ta(6,"input",8,9),La("ngModelChange",(function(t){return tn(n),za().nombreEquipo=t})),Aa(),Ta(8,"mat-error"),wa(9,fvt,2,0,"span",10),Aa(),Aa(),Aa(),Ta(10,"div",11),Ta(11,"button",12),La("click",(function(){tn(n);var t=xa(7);return za().editar(t.value)})),Ta(12,"mat-icon"),ps(13,"save"),Aa(),Aa(),ps(14," \xa0 \xa0 \xa0 \xa0 \xa0\xa0\xa0 "),Ta(15,"a",13),La("click",(function(){return tn(n),za().cancel()})),Ta(16,"mat-icon"),ps(17,"cancel"),Aa(),Aa(),Aa(),Aa()}if(2&t){var r=za();di(6),Sa("ngModel",r.nombreEquipo),di(3),Sa("ngIf",!r.equiposForm.get("nombre").valid&&r.equiposForm.get("nombre").touched),di(2),Sa("disabled",!r.equiposForm.valid)}}var pvt,vvt,mvt,gvt,yvt,bvt=[{path:"login",component:DP,pathMatch:"full",data:{title:"Loguear usuario"}},{path:"",component:DP,pathMatch:"full",data:{title:"Loguear usuario"}},{path:"main",component:xP,data:{title:"main"},canActivate:[kP],children:[{path:"home",component:CP,data:{title:"home"},canActivate:[kP]},{path:"equipos-tabla",component:KP,data:{title:"home"},canActivate:[kP]},{path:"sancionados-tabla",component:Apt,data:{title:"home"},canActivate:[kP]},{path:"comprobar-sancionados",component:ppt,data:{title:"home"},canActivate:[kP]},{path:"jugadores-tabla/:equipo",component:Zpt,data:{title:"home"},canActivate:[kP]},{path:"equipos-crear",component:nvt,data:{title:"home"},canActivate:[kP]},{path:"equipos-editar/:id",component:(pvt=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.router=e,this.formBuilder=n,this.equiposService=r,this.dialog=i,this.route=o,this.cargaPendientes=!0}return _createClass(t,[{key:"cancel",value:function(){this.router.navigate(["main/equipos-tabla"])}},{key:"editar",value:function(t){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:+this.idEquipo,name:this.nombreEquipo},t.next=3,this.equiposService.editar(e);case 3:this.router.navigate(["main/equipos-tabla"]);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"cargarNombreEquipo",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.equiposService.get();case 2:for(e=t.sent,n=0;n<e.length;n++)(r=e[n]).id===+this.idEquipo&&(this.nombreEquipo=r.name);this.cargaPendientes=!1;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){return Object(EP.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.equiposForm=this.formBuilder.group({nombre:[null,yf.required]}),this.route.params.forEach((function(t){e.idEquipo=t.id})),this.cargarNombreEquipo();case 1:case"end":return t.stop()}}),t,this)})))}}]),t}(),pvt.\u0275fac=function(t){return new(t||pvt)(Ca(fg),Ca(Kd),Ca(FP),Ca(zT),Ca(em))},pvt.\u0275cmp=be({type:pvt,selectors:[["app-equipos-editar"]],decls:3,vars:3,consts:[["fxLayoutAlign","center center","fxFill","",4,"ngIf"],[3,"formGroup"],["class","contenido",4,"ngIf"],["fxLayoutAlign","center center","fxFill",""],[1,"contenido"],[1,"titulo"],["fxLayout","column","fxLayoutGap","20px"],[1,"example-full-width"],["matInput","","placeholder","Nombre","formControlName","nombre",1,"texto",3,"ngModel","ngModelChange"],["nombre",""],[4,"ngIf"],[1,"button-row2"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(wa(0,hvt,2,0,"div",0),Ta(1,"form",1),wa(2,dvt,18,3,"div",2),Aa()),2&t&&(Sa("ngIf",e.cargaPendientes),di(1),Sa("formGroup",e.equiposForm),di(1),Sa("ngIf",!e.cargaPendientes))},directives:[Ll,Rd,df,Dd,hP,oP,uR,RD,LD,VE,vA,nf,ff,Hd,bE,hC,eT,fC],styles:[".contenido[_ngcontent-%COMP%]{padding-top:15%}.formato[_ngcontent-%COMP%]{line-height:85px}.texto[_ngcontent-%COMP%]{text-align:left}.botonGuardar[_ngcontent-%COMP%]{background:#607d8b}.titulo[_ngcontent-%COMP%]{align-content:center;text-align:center;font-family:Roboto,sans-serif}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:60%;margin-left:6%;margin-right:6%}.alineacion[_ngcontent-%COMP%]{text-align:center}.example-full-width[_ngcontent-%COMP%]{width:30%;margin-left:35%;margin-right:6%;text-align:left}.example-full-width[_ngcontent-%COMP%]:nth-last-child(){margin-bottom:10px;text-align:left;margin-left:auto;margin-right:auto}.button-row[_ngcontent-%COMP%]{margin:10px 0}.button-row2[_ngcontent-%COMP%]{margin:65px 0;text-align:center}.example-h2[_ngcontent-%COMP%]{margin:10px}.example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}.colorTextoDesabilitado[_ngcontent-%COMP%]{color:#666}"]}),pvt),data:{title:"home"},canActivate:[kP]},{path:"jugadores-crear/:equipo",component:lvt,data:{title:"home"},canActivate:[kP]}]}],_vt=((yvt=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:yvt}),yvt.\u0275inj=gt({factory:function(t){return new(t||yvt)},imports:[[Sg.forRoot(bvt)],Sg]}),yvt),wvt=((gvt=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:gvt}),gvt.\u0275inj=gt({factory:function(t){return new(t||gvt)},imports:[[RN]]}),gvt),xvt=((mvt=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:mvt}),mvt.\u0275inj=gt({factory:function(t){return new(t||mvt)},imports:[[RN]]}),mvt),Cvt=((vvt=function(){function t(e,n){_classCallCheck(this,t),nh(n)&&!e&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}return _createClass(t,null,[{key:"withConfig",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{ngModule:t,providers:e.serverLoaded?[{provide:PN,useValue:Object.assign(Object.assign({},DN),e)},{provide:FN,useValue:n,multi:!0},{provide:MN,useValue:!0}]:[{provide:PN,useValue:Object.assign(Object.assign({},DN),e)},{provide:FN,useValue:n,multi:!0}]}}}]),t}()).\u0275mod=Ce({type:vvt}),vvt.\u0275inj=gt({factory:function(t){return new(t||vvt)(te(MN),te(ac))},imports:[[wP,wvt,xvt],wP,wvt,xvt]}),vvt);R6.a.initializeApp(Jc);var kvt,Evt=((kvt=function t(){_classCallCheck(this,t)}).\u0275mod=Ce({type:kvt,bootstrap:[Lg]}),kvt.\u0275inj=gt({factory:function(t){return new(t||kvt)},providers:[MP],imports:[[qh,_vt,h_,Hdt.initializeApp(Jc),IN,Cvt,$d,Xd,MI,Zdt]]}),kvt);(function(){if(Er)throw new Error("Cannot enable prod mode after platform setup.");kr=!1})(),zh().bootstrapModule(Evt).catch((function(t){return console.error(t)}))},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);